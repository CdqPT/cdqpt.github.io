<!DOCTYPE HTML>
<html lang="zh-CN">






<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <meta name="keywords" content="设计模式, 陈德强 ALaDing 内蒙古工业大学 机器人 东软 东软集团 嵌入式 自动驾驶 ADASIS">
    <meta name="description" content="面向对象编程的核心思想–高内聚低耦合。设计模式的大部分作用就是解耦，解耦的基本方式是将功能和逻辑分离。
设计模式（Design pattern）代表了最佳的实践，通常被有经验的面向对象的软件开发人员所采用。设计模式是软件开发人员在软件开发过">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>设计模式 | ALaDing</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">
    <style type="text/css">
        
        code[class*="language-"], pre[class*="language-"] {
            white-space: pre !important;
        }
        
    </style>

    <script src="/libs/jquery/jquery-2.2.0.min.js"></script>



  <link rel="amphtml" href="https://purethought.cn/54575.html/amp/index.html">

    
<link rel="stylesheet" href="/css/prism-xonokai.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>






<body style="overflow-x:hidden">
    <header id="navControl" class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">ALaDing</span>
                </a>
            </div>
            



<!-- <a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fa fa-navicon"></i></a>
<ul class="right">
    
    <li class="hide-on-med-and-down">
        <a href="/" class="waves-effect waves-light">
            
            <i class="fa fa-home"></i>
            
            <span>首页</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/dictionary" class="waves-effect waves-light">
            
            <i class="fa fa-book"></i>
            
            <span>字典</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/categories" class="waves-effect waves-light">
            
            <i class="fa fa-bookmark"></i>
            
            <span>分类</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/" class="waves-effect waves-light">
            
            <i class="fa fa-heart"></i>
            
            <span>豆瓣</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/" class="waves-effect waves-light">
            
            <i class="fa fa-leaf"></i>
            
            <span>关于</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/contact" class="waves-effect waves-light">
            
            <i class="fa fa-commenting"></i>
            
            <span>留言</span>
        </a>
    </li>
    
    <li>
        <a href="#searchModal" class="modal-trigger waves-effect waves-light">
            <i id="searchIcon" class="fa fa-search" title="搜索"></i>
        </a>
    </li>
</ul> -->

<!-- 支持二级菜单特性  -->
<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse">
  <i class="fa fa-navicon" >
     <b>导航 </b>
  </i>
</a>

<ul class="right nav-menu">
    
      <li class="hide-on-med-and-down nav-item" >

        
            <a href="/" class="waves-effect waves-light">
              
                <i class="fa fa-home"></i>
              
              <span>首页</span>
            </a>

            
      </li>
    
      <li class="hide-on-med-and-down nav-item" >

        
            <a href="/dictionary" class="waves-effect waves-light">
              
                <i class="fa fa-book"></i>
              
              <span>字典</span>
            </a>

            
      </li>
    
      <li class="hide-on-med-and-down nav-item" >

        
              <a href="/categories" class="waves-effect waves-light">
                
                  <i class="fa fa-bookmark"></i>
                
                <span>分类</span>
                <i class="fa fa-chevron-down" aria-hidden="true"></i>
              </a>

            <ul class="sub-nav menus_item_child ">
              
                <li> 
                  <a href="https://purethought.cn/categories/%E7%AC%94%E8%AE%B0/" >
                    
                      <i class="fa fa-bookmark" style="margin-top: -20px;"></i>
                    
                    <span>编程笔记</span>
                  </a>
                </li>
              
                <li> 
                  <a href="https://purethought.cn/categories/%E6%96%87%E5%8F%B2%E5%93%B2/" >
                    
                      <i class="fa fa-bookmark" style="margin-top: -20px;"></i>
                    
                    <span>文史哲理</span>
                  </a>
                </li>
              
                <li> 
                  <a href="https://purethought.cn/categories/%E9%9A%8F%E7%AC%94/" >
                    
                      <i class="fa fa-bookmark" style="margin-top: -20px;"></i>
                    
                    <span>过程随笔</span>
                  </a>
                </li>
              
                <li> 
                  <a href="https://purethought.cn/categories/%E4%BC%98%E5%8C%96/" >
                    
                      <i class="fa fa-bookmark" style="margin-top: -20px;"></i>
                    
                    <span>既有优化</span>
                  </a>
                </li>
              
                <li> 
                  <a href="https://purethought.cn/categories/%E6%95%99%E7%A8%8B/" >
                    
                      <i class="fa fa-bookmark" style="margin-top: -20px;"></i>
                    
                    <span>安装教程</span>
                  </a>
                </li>
               
            </ul>
          
      </li>
    
      <li class="hide-on-med-and-down nav-item" >

        
              <a href="/" class="waves-effect waves-light">
                
                  <i class="fa fa-heart"></i>
                
                <span>豆瓣</span>
                <i class="fa fa-chevron-down" aria-hidden="true"></i>
              </a>

            <ul class="sub-nav menus_item_child ">
              
                <li> 
                  <a href="/books" >
                    
                      <i class="fa fa-book" style="margin-top: -20px;"></i>
                    
                    <span>书单</span>
                  </a>
                </li>
              
                <li> 
                  <a href="/movies" >
                    
                      <i class="fa fa-film" style="margin-top: -20px;"></i>
                    
                    <span>电影</span>
                  </a>
                </li>
              
                <li> 
                  <a href="/games" >
                    
                      <i class="fa fa-gamepad" style="margin-top: -20px;"></i>
                    
                    <span>游戏</span>
                  </a>
                </li>
               
            </ul>
          
      </li>
    
      <li class="hide-on-med-and-down nav-item" >

        
              <a href="/" class="waves-effect waves-light">
                
                  <i class="fa fa-leaf"></i>
                
                <span>关于</span>
                <i class="fa fa-chevron-down" aria-hidden="true"></i>
              </a>

            <ul class="sub-nav menus_item_child ">
              
                <li> 
                  <a href="/about" >
                    
                      <i class="fa fa-user" style="margin-top: -20px;"></i>
                    
                    <span>简介</span>
                  </a>
                </li>
              
                <li> 
                  <a href="/galleries" >
                    
                      <i class="fa fa-camera" style="margin-top: -20px;"></i>
                    
                    <span>相册</span>
                  </a>
                </li>
              
                <li> 
                  <a href="/friends" >
                    
                      <i class="fa fa-handshake-o" style="margin-top: -20px;"></i>
                    
                    <span>友链</span>
                  </a>
                </li>
              
                <li> 
                  <a href="/log" >
                    
                      <i class="fa fa-pencil-square-o" style="margin-top: -20px;"></i>
                    
                    <span>日志</span>
                  </a>
                </li>
              
                <li> 
                  <a href="/tags" >
                    
                      <i class="fa fa-tags" style="margin-top: -20px;"></i>
                    
                    <span>标签</span>
                  </a>
                </li>
              
                <li> 
                  <a href="/archives" >
                    
                      <i class="fa fa-archive" style="margin-top: -20px;"></i>
                    
                    <span>归档</span>
                  </a>
                </li>
               
            </ul>
          
      </li>
    
      <li class="hide-on-med-and-down nav-item" >

        
            <a href="/contact" class="waves-effect waves-light">
              
                <i class="fa fa-commenting"></i>
              
              <span>留言</span>
            </a>

            
      </li>
    

    <li>
        <a href="#searchModal" class="modal-trigger waves-effect waves-light">

            <i id="searchIcon" class="fa fa-search" title="搜索" >
              <b>搜索 </b>
            </i>

        </a>
    </li>

</ul>

<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">ALaDing</div>
        <div class="logo-desc">
            
            东软集团 | 内蒙古工业大学 | 嵌入式工程师 | ADAS
            
        </div>
    </div>

    


 <ul class="menu-list mobile-menu-list">  <li class="m-nav-item">  <a href="/" class="waves-effect waves-light">  <i class="fa fa-fw fa-home"></i>  首页 </a>  </li>  <li class="m-nav-item">  <a href="/dictionary" class="waves-effect waves-light">  <i class="fa fa-fw fa-book"></i>  字典 </a>  </li>  <li class="m-nav-item">  <a href="javascript:;">  <i class="fa fa-fw fa-bookmark"></i>  分类 <span class="m-icon"><i class="fa fa-chevron-right"></i></span> </a> <ul>  <li> <a href="https://purethought.cn/categories/%E7%AC%94%E8%AE%B0/" >  <i class="fa fa-bookmark" style="left: 25px; position: absolute;"></i>  <span>编程笔记</span> </a> </li>  <li> <a href="https://purethought.cn/categories/%E6%96%87%E5%8F%B2%E5%93%B2/" >  <i class="fa fa-bookmark" style="left: 25px; position: absolute;"></i>  <span>文史哲理</span> </a> </li>  <li> <a href="https://purethought.cn/categories/%E9%9A%8F%E7%AC%94/" >  <i class="fa fa-bookmark" style="left: 25px; position: absolute;"></i>  <span>过程随笔</span> </a> </li>  <li> <a href="https://purethought.cn/categories/%E4%BC%98%E5%8C%96/" >  <i class="fa fa-bookmark" style="left: 25px; position: absolute;"></i>  <span>既有优化</span> </a> </li>  <li> <a href="https://purethought.cn/categories/%E6%95%99%E7%A8%8B/" >  <i class="fa fa-bookmark" style="left: 25px; position: absolute;"></i>  <span>安装教程</span> </a> </li>  </ul>  </li>  <li class="m-nav-item">  <a href="javascript:;">  <i class="fa fa-fw fa-heart"></i>  豆瓣 <span class="m-icon"><i class="fa fa-chevron-right"></i></span> </a> <ul>  <li> <a href="/books" >  <i class="fa fa-book" style="left: 25px; position: absolute;"></i>  <span>书单</span> </a> </li>  <li> <a href="/movies" >  <i class="fa fa-film" style="left: 25px; position: absolute;"></i>  <span>电影</span> </a> </li>  <li> <a href="/games" >  <i class="fa fa-gamepad" style="left: 25px; position: absolute;"></i>  <span>游戏</span> </a> </li>  </ul>  </li>  <li class="m-nav-item">  <a href="javascript:;">  <i class="fa fa-fw fa-leaf"></i>  关于 <span class="m-icon"><i class="fa fa-chevron-right"></i></span> </a> <ul>  <li> <a href="/about" >  <i class="fa fa-user" style="left: 25px; position: absolute;"></i>  <span>简介</span> </a> </li>  <li> <a href="/galleries" >  <i class="fa fa-camera" style="left: 25px; position: absolute;"></i>  <span>相册</span> </a> </li>  <li> <a href="/friends" >  <i class="fa fa-handshake-o" style="left: 25px; position: absolute;"></i>  <span>友链</span> </a> </li>  <li> <a href="/log" >  <i class="fa fa-pencil-square-o" style="left: 25px; position: absolute;"></i>  <span>日志</span> </a> </li>  <li> <a href="/tags" >  <i class="fa fa-tags" style="left: 25px; position: absolute;"></i>  <span>标签</span> </a> </li>  <li> <a href="/archives" >  <i class="fa fa-archive" style="left: 25px; position: absolute;"></i>  <span>归档</span> </a> </li>  </ul>  </li>  <li class="m-nav-item">  <a href="/contact" class="waves-effect waves-light">  <i class="fa fa-fw fa-commenting"></i>  留言 </a>  </li>   <li><div class="divider"></div></li> <li> <a href="https://github.com/CdqPT" class="waves-effect waves-light" target="_blank"> <i class="fa fa-github-square fa-fw"></i>Fork Me </a> </li>  </ul>








</div>



        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #000;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/CdqPT" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>
</header>


    
<script src="/libs/cryptojs/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('请输入访问本文章的密码')).toString(CryptoJS.enc.Hex)) {
                alert('密码错误，将返回主页！');
                location.href = '/';
            }
        }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('https://blogcdq.oss-cn-beijing.aliyuncs.com/image/other/star.jpg')">
    <div class="container">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <div class="description center-align post-title">
                        设计模式
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before  /*,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before */{
        display: block;
        content: "🍭";
        position: absolute;
        left: 50px;
        /*color: #EE7942;*/
        /*color: red;*/
    }
        @media only screen and (max-width: 992px) {
    #articleContent h1::before{
        display: block;
        content: " ";
    }
}

    /*修改滚动条样式为隐藏*/
    #toc-content {
        height: calc(105vh - 250px);
        overflow-x: hidden;
        overflow-y: scroll;
        width: 320px;
        height: 600px;
    }
    #hidden{
        overflow: hidden;
        width: 300px;    
    }  

    #articleContent :focus {
        outline: none;
    }
    .toc-fixed {
        position: fixed;
        top: 64px;
    }
    .toc-widget {
        padding-left: 20px;
    }
    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 40px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }
    .toc-widget ol {
        padding: 0;
        list-style: none;
    }
    #toc-content ol {
        padding-left: 10px;
    }
    #toc-content ol li {
        padding-left: 30px;
    }
    #toc-content .toc-link:hover {
        color: black;
        font-weight: 700;
        text-decoration: underline;
    }
    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;
    }
    #toc-content .is-active-link {
        color: red;
    }
    #toc-content .is-active-link::before {
        background-color: red;
    }
    #floating-toc-btn {
        position: fixed;
        right: 0.6rem;
        bottom: 6rem;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
        opacity: 0.5;
    }
    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }
    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/其他/" target="_blank">
                                <span class="chip bg-color">其他</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fa fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/字典/" class="post-category" target="_blank">
                                字典
                            </a>
                        
                    </div>
                    
                </div>
            </div>




               <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="fa fa-pencil fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2019-12-21
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="fa fa-refresh fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2020-03-02
                </div>
                

                

                
                
                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="fa fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
                
            </div>
            
        </div>

        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <p>面向对象编程的核心思想–高内聚低耦合。<br>设计模式的大部分作用就是解耦，解耦的基本方式是将功能和逻辑分离。</p>
<p>设计模式（Design pattern）代表了最佳的实践，通常被有经验的面向对象的软件开发人员所采用。设计模式是软件开发人员在软件开发过程中面临的一般问题的解决方案。这些解决方案是众多软件开发人员经过相当长的一段时间的试验和错误总结出来的。<br>设计模式是一套被反复使用的、多数人知晓的、经过分类编目的、代码设计经验的总结。使用设计模式是为了重用代码、让代码更容易被他人理解、保证代码可靠性。 毫无疑问，设计模式于己于他人于系统都是多赢的，设计模式使代码编制真正工程化，设计模式是软件工程的基石，如同大厦的一块块砖石一样。项目中合理地运用设计模式可以完美地解决很多问题，每种模式在现实中都有相应的原理来与之对应，每种模式都描述了一个在我们周围不断重复发生的问题，以及该问题的核心解决方案，这也是设计模式能被广泛应用的原因。</p>
<h1 id="6种设计原则"><a href="#6种设计原则" class="headerlink" title="6种设计原则"></a>6种设计原则</h1><h2 id="单一职责原则"><a href="#单一职责原则" class="headerlink" title="单一职责原则"></a>单一职责原则</h2><p>单一职责原则的英文名称是Single Responsibility Principle，简称是SRP。这个原则存在争议之处在于对职责的定义，什么是类的职责，以及怎么划分类的职责。</p>
<p>单一职责原则的好处：<br>1.类的复杂性降低，实现什么职责都有清晰明确的定义；<br>2.可读性提高，复杂性降低，那当然可读性提高了；<br>3.可维护性提高，可读性提高，那当然更容易维护了；<br>4.变更引起的风险降低，变更是必不可少的，如果接口的单一职责做得好，一个接口修改只对相应的实现类有影响，对其他的接口无影响，这对系统的扩展性、维护性都有非常大的帮助。</p>
<p>注意　单一职责原则提出了一个编写程序的标准，用“职责”或“变化原因”来衡量接口或类设计得是否优良，但是“职责”和“变化原因”都是不可度量的，因项目而异，因环境而异。</p>
<p>对于单一职责原则，我的建议是接口一定要做到单一职责，类的设计尽量做到只有一个原因引起变化。</p>
<h2 id="里氏替换原则"><a href="#里氏替换原则" class="headerlink" title="里氏替换原则"></a>里氏替换原则</h2><p>里氏替换原则(Liskov Substitution Principle，LSP)有两个定义。</p>
<blockquote>
<p>第一种定义，也是最正宗的定义：<br>If for each object o1 of type S there is an object o2 of type T such that for all programs P defined in terms of T,the behavior of P is unchanged when o1 is substituted for &gt;o2 then S is a subtype of T.<br><br>如果对每一个类型为S的对象o1，都有类型为T的对象o2，使得以T定义的所有程序P在所有的对象o1都代换成o2时，程序P的行为没有发生变化，那么类型S是类型T的子类型。<br><br><br>第二种定义：<br>Functions that use pointers or references to base classes must be able to use objects of derived classes without knowing it.<br><br>所有引用基类的地方必须能透明地使用其子类的对象。</p>
</blockquote>
<p>第二个定义是最清晰明确的，通俗点讲，只要父类能出现的地方子类就可以出现，而且替换为子类也不会产生任何错误或异常，使用者可能根本就不需要知道是父类还是子类。但是，反过来就不行了，有子类出现的地方，父类未必就能适应。</p>
<p>注意　如果子类不能完整地实现父类的方法，或者父类的某些方法在子类中已经发生“畸变”，则建议断开父子继承关系，采用依赖、聚集、组合等关系代替继承。</p>
<h2 id="依赖倒置原则"><a href="#依赖倒置原则" class="headerlink" title="依赖倒置原则"></a>依赖倒置原则</h2><p><strong>概念</strong><br>依赖倒置原则（Dependence Inversion Principle,DIP）</p>
<blockquote>
<p>High level modules should not depend upon low level modules.Both should depend upon abstractions.Abstractions should not depend upon details.Details should depend upon abstractions.<br><br>翻译过来，包含三层含义：<br>1.高层模块不应该依赖低层模块，两者都应该依赖其抽象；<br>2.抽象不应该依赖细节；<br>3.细节应该依赖抽象。</p>
</blockquote>
<p>依赖倒置原则在Java语言中的表现就是：<br>● 模块间的依赖通过抽象发生，实现类之间不发生直接的依赖关系，其依赖关系是通过接口或抽象类产生的；<br>● 接口或抽象类不依赖于实现类；<br>● 实现类依赖接口或抽象类。</p>
<p>更加精简的定义就是“面向接口编程”——OOD（Object-Oriented Design，面向对象设计）的精髓之一。</p>
<p>依赖倒置原则的优点：<br>依赖倒置原则可以减少类间的耦合性，提高系统的稳定性，降低并行开发引起的风险，提高代码的可读性和可维护性。<br>减少并行开发引起的风险。</p>
<p><strong>依赖的三种写法</strong><br>1.构造函数传递依赖对象；<br>2.Setter方法传递依赖对象；<br>3.接口声明依赖对象。</p>
<p><strong>规则</strong><br>1.每个类尽量都有接口或抽象类，或者抽象类和接口两者都具备。<br>2.变量的表面类型尽量是接口或者是抽象类。<br>3.任何类都不应该从具体类派生。<br>4.尽量不要覆写基类的方法。<br>5.结合里氏替换原则使用。</p>
<h2 id="接口隔离原则"><a href="#接口隔离原则" class="headerlink" title="接口隔离原则"></a>接口隔离原则</h2><blockquote>
<p>接口：<br>实例接口（Object Interface）和类接口（Class Interface）。<br>隔离：<br>Clients should not be forced to depend upon interfaces that they don’t use.<br>客户端不应该依赖它不需要的接口。<br>The dependency of one class to another one should depend on the smallest possible interface.<br>类间的依赖关系应该建立在最小的接口上。</p>
</blockquote>
<p>在实践中可以根据以下几个规则来衡量：<br>● 一个接口只服务于一个子模块或业务逻辑；<br>● 通过业务逻辑压缩接口中的public方法，接口时常去回顾，尽量让接口达到“满身筋骨肉”，而不是“肥嘟嘟”的一大堆方法；<br>● 已经被污染了的接口，尽量去修改，若变更的风险较大，则采用适配器模式进行转化处理；<br>● 了解环境，拒绝盲从。每个项目或产品都有特定的环境因素，别看到大师是这样做的你就照抄。千万别，环境不同，接口拆分的标准就不同。深入了解业务逻辑，最好的接口设计就出自你的手中！</p>
<h2 id="迪米特法则"><a href="#迪米特法则" class="headerlink" title="迪米特法则"></a>迪米特法则</h2><p>迪米特法则（Law of Demeter，LoD）也称为最少知识原则（Least Knowledge Principle，LKP），虽然名字不同，但描述的是同一个规则：一个对象应该对其他对象有最少的了解。通俗地讲，一个类应该对自己需要耦合或调用的类知道得最少，你（被耦合或调用的类）的内部是如何复杂都和我没关系，那是你的事情，我就知道你提供的这么多public方法，我就调用这么多，其他的我一概不关心。</p>
<p>迪米特法则要求类“羞涩”一点，尽量不要对外公布太多的public方法和非静态的public变量，尽量内敛，多使用private、package-private、protected等访问权限。</p>
<p>一个类公开的public属性或方法越多，修改时涉及的面也就越大，变更引起的风险扩散也就越大。因此，为了保持朋友类间的距离，在设计时需要反复衡量：是否还可以再减少public方法和属性，是否可以修改为private、package-private（包类型，在类、方法、变量前不加访问权限，则默认为包类型）、protected等访问权限，是否可以加上final关键字等。</p>
<p>总之，高内聚低耦合，一个类应该减少对外公开的接口，做到即使改变也不会影响其他类。</p>
<h2 id="开闭原则"><a href="#开闭原则" class="headerlink" title="开闭原则"></a>开闭原则</h2><blockquote>
<p>Software entities like classes,modules and functions should be open for extension but closed for modifications.<br><br>一个软件实体如类、模块和函数应该对扩展开放，对修改关闭。</p>
</blockquote>
<p>开闭原则对扩展开放，对修改关闭，并不意味着不做任何修改，低层模块的变更，必然要有高层模块进行耦合，否则就是一个孤立无意义的代码片段。<br>cdq:通过覆写来实现新功能，而不是修改。<br>通过扩展来实现业务逻辑的变化，而不是修改。</p>
<h1 id="23种设计模式归类"><a href="#23种设计模式归类" class="headerlink" title="23种设计模式归类"></a>23种设计模式归类</h1><h2 id="创建型模式"><a href="#创建型模式" class="headerlink" title="创建型模式"></a>创建型模式</h2><p>这些设计模式提供了一种在创建对象的同时隐藏创建逻辑的方式，而不是使用 new 运算符直接实例化对象。这使得程序在判断针对某个给定实例需要创建哪些对象时更加灵活。     </p>
<p>-工厂方法模式（Factory Method Pattern）★★★★★<br>-抽象工厂模式（Abstract Factory Pattern）★★★★★<br>-单例模式（Singleton Pattern）★★★★☆<br>-建造者模式（Builder Pattern）★★☆☆☆<br>-原型模式（Prototype Pattern）★★★☆☆</p>
<h2 id="结构型模式"><a href="#结构型模式" class="headerlink" title="结构型模式"></a>结构型模式</h2><p>这些设计模式关注类和对象的组合。继承的概念被用来组合接口和定义组合对象获得新功能的方式。     </p>
<p>-适配器模式（Adapter Pattern）★★★★☆<br>-桥接模式（Bridge Pattern）★★★☆☆<br>-过滤器模式（Filter、Criteria Pattern）<br>-组合模式（Composite Pattern）★★★★☆<br>-装饰器模式（Decorator Pattern）★★★☆☆<br>-外观模式（Facade Pattern）★★★★★<br>-享元模式（Flyweight Pattern）★☆☆☆☆<br>-代理模式（Proxy Pattern）★★★★☆</p>
<h2 id="行为型模式"><a href="#行为型模式" class="headerlink" title="行为型模式"></a>行为型模式</h2><p>这些设计模式特别关注对象之间的通信。     </p>
<p>-责任链模式（Chain of Responsibility Pattern）★★☆☆☆<br>-命令模式（Command Pattern）★★★★☆<br>-解释器模式（Interpreter Pattern）★☆☆☆☆<br>-迭代器模式（Iterator Pattern）★★★★★<br>-中介者模式（Mediator Pattern）★★☆☆☆<br>-备忘录模式（Memento Pattern）★★☆☆☆<br>-观察者模式（Observer Pattern）★★★★★<br>-状态模式（State Pattern）★★★☆☆<br>-空对象模式（Null Object Pattern）<br>-策略模式（Strategy Pattern）★★★★☆<br>-模板模式（Template Pattern）★★★☆☆<br>-访问者模式（Visitor Pattern）★☆☆☆☆</p>
<h2 id="J2EE-模式"><a href="#J2EE-模式" class="headerlink" title="J2EE 模式"></a>J2EE 模式</h2><p>这些设计模式特别关注表示层。这些模式是由 Sun Java Center 鉴定的。     </p>
<p>-MVC 模式（MVC Pattern）<br>-业务代表模式（Business Delegate Pattern）<br>-组合实体模式（Composite Entity Pattern）<br>-数据访问对象模式（Data Access Object Pattern）<br>-前端控制器模式（Front Controller Pattern）<br>-拦截过滤器模式（Intercepting Filter Pattern）<br>-服务定位器模式（Service Locator Pattern）<br>-传输对象模式（Transfer Object Pattern）</p>
<h1 id="23种设计模式解析"><a href="#23种设计模式解析" class="headerlink" title="23种设计模式解析"></a>23种设计模式解析</h1><h2 id="单例模式"><a href="#单例模式" class="headerlink" title="单例模式"></a>单例模式</h2><blockquote>
<p>Ensure a class has only one instance, and provide a global point of access to it.<br><br>确保某一个类只有一个实例，而且自行实例化并向整个系统提供这个实例。</p>
</blockquote>
<p>Singleton类称为单例类，通过使用private的构造函数确保了在一个应用中只产生一个实例，并且是自行实例化的。</p>
<p>应用案例：总线模式。</p>
<hr>
```cpp
#include <iostream>

<p>class Singleton<br>{<br>public:<br>    ~Singleton(){<br>        std::cout&lt;&lt;”destructor called!”&lt;&lt;std::endl;<br>    }<br>    Singleton(const Singleton&amp;)=delete;<br>    Singleton&amp; operator=(const Singleton&amp;)=delete;<br>    static Singleton&amp; get_instance(){<br>        static Singleton instance;<br>        return instance;</p>
<pre><code>}</code></pre><p>private:<br>    Singleton(){<br>        std::cout&lt;&lt;”constructor called!”&lt;&lt;std::endl;<br>    }<br>};</p>
<p>int main(int argc, char *argv[])<br>{<br>    Singleton&amp; instance_1 = Singleton::get_instance();<br>    Singleton&amp; instance_2 = Singleton::get_instance();<br>    return 0;<br>}</p>
<pre><code></code></pre><p>constructor called!<br>destructor called!</p>
<pre><code>
## 为什么要用工厂模式？
想想我们为什么要用工厂模式？下面我就简单举例子：
文件IO的操作我们会经常用得到吧，所以BufferedReader对象经常要创建的：
```cpp
// 创建一个BufferedReader对象
File file = new File(&quot;aa.txt&quot;);
FileReader fileReader = new FileReader(file);
BufferedReader bufferedReader = new BufferedReader(fileReader);</code></pre><p>可以看出来，创建一个BufferReader对象里面需要一个FileReader对象，而FileReader对象又要File对象。那创建这个BufferReader对象还是比较麻烦的(代码上看不麻烦，从构造上看还是挺麻烦的)！</p>
<p>虽然比较麻烦，但我们还能用，能用就行！于是乎，我们就去写代码了，现在有三个类都要进行文件的读写操作，于是他们就有这样的代码：</p>
<pre class="line-numbers language-c"><code class="language-c">public class FileOperateA <span class="token punctuation">{</span>

    public <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> throws FileNotFoundException <span class="token punctuation">{</span>
        File file <span class="token operator">=</span> new <span class="token function">File</span><span class="token punctuation">(</span><span class="token string">"aa.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        FileReader fileReader <span class="token operator">=</span> new <span class="token function">FileReader</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
        BufferedReader bufferedReader <span class="token operator">=</span> new <span class="token function">BufferedReader</span><span class="token punctuation">(</span>fileReader<span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token comment" spellcheck="true">// 读写文件....</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>此时：上头说，我要换成LineNumberReader来读写，有这个需求！那我们作为一个写代码的，能怎么办？很绝望也需要去完成呀。</p>
<ul>
<li>不熟悉IDE的小伙子就一个一个将BufferedReader改成LineNumberReader，现在就3个类用到了BufferedReader，也就改6次而已。(ps:那如果很多地方都用到了呢？)</li>
<li>熟悉IDE的小伙子就全局替换重构，妥妥的！</li>
</ul>
<p>那有没有一种方法能够让创建对象变得简单而且修改对象时能很方便呢？<br>工厂模式就行了。</p>
<p>再说从面向对象的角度来看：我一个操作文件的类还要我会创建BufferReader是不是有点过分了？(职责没有分工好)<br>交给工厂来创建对象这就很面向对象了！</p>
<p>首先我们创建一个工厂类，它可以生产Reader对象！</p>
<pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">// 创建Reader对象的工厂</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ReaderFactory</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> Reader <span class="token function">getReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span> throws FileNotFoundException <span class="token punctuation">{</span>
        File file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">File</span><span class="token punctuation">(</span><span class="token string">"aa.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        FileReader fileReader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">FileReader</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
        BufferedReader reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">BufferedReader</span><span class="token punctuation">(</span>fileReader<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> reader<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>那么我们要得到BufferReader对象就贼简单了：</p>
<pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FileOperateA</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> throws FileNotFoundException <span class="token punctuation">{</span>


        <span class="token comment" spellcheck="true">//-------我有工厂了，还用自己搞吗？不用了！</span>
        <span class="token comment" spellcheck="true">//File file = new File("aa.txt");</span>
        <span class="token comment" spellcheck="true">//FileReader fileReader = new FileReader(file);</span>
        <span class="token comment" spellcheck="true">//BufferedReader bufferedReader = new BufferedReader(fileReader);</span>
        <span class="token comment" spellcheck="true">//-------我有工厂了，还用自己搞吗？不用了！</span>

        <span class="token comment" spellcheck="true">// 用工厂来创建出对象</span>
        Reader reader <span class="token operator">=</span> ReaderFactory<span class="token punctuation">.</span><span class="token function">getReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">// 读写文件....</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>工厂将我们创建的对象过程给屏蔽了！</p>
<p>此时我要改成LineNumberReader怎么玩？在工厂上改一下就好了.</p>
<h2 id="工厂方法模式"><a href="#工厂方法模式" class="headerlink" title="工厂方法模式"></a>工厂方法模式</h2><blockquote>
<p>Define an interface for creating an object,but let subclasses decide which class to instantiate.Factory Method lets a class defer instantiation to subclasses.<br><br>定义一个用于创建对象的接口，让子类决定实例化哪一个类。工厂方法使一个类的实例化延迟到其子类。</p>
</blockquote>
<hr>

<p>main()，女娲</p>
<p>IHuman，产品接口</p>
<p>CYellowHuman，产品之一</p>
<p>CWhiteHuman，产品之二</p>
<p>CBlackHuman，产品之三</p>
<p>IHumanFactory，工厂接口</p>
<p>CYellowHumanFactory，工厂之一</p>
<p>CWhiteHumanFactory，工厂之二</p>
<p>CBlackHumanFactory，工厂之三</p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1573293086866.png?x-oss-process=image/resize,m_lfit,h_450" alt="女娲造人图"></p>
<p>IHuman.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
class IHuman
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">IHuman</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    virtual <span class="token operator">~</span><span class="token function">IHuman</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    virtual <span class="token keyword">void</span> <span class="token function">Laugh</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">Cry</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">Talk</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>YellowHuman.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ihuman.h"</span></span>
class CYellowHuman <span class="token punctuation">:</span>
    public IHuman
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CYellowHuman</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CYellowHuman</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Laugh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Cry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Talk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>YellowHuman.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"YellowHuman.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
CYellowHuman<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CYellowHuman</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
CYellowHuman<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CYellowHuman</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CYellowHuman<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Cry</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"黄色人种会哭"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CYellowHuman<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Laugh</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"黄色人种会大笑，幸福呀！"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CYellowHuman<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Talk</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"黄色人种会说话，一般说的都是双字节"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>//WhiteHuman.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ihuman.h"</span></span>
class CWhiteHuman <span class="token punctuation">:</span>
    public IHuman
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CWhiteHuman</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CWhiteHuman</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Laugh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Cry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Talk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>//WhiteHuman.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"WhiteHuman.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
CWhiteHuman<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CWhiteHuman</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
CWhiteHuman<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CWhiteHuman</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CWhiteHuman<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Cry</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"白色人种会哭"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CWhiteHuman<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Laugh</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"白色人种会大笑，侵略的笑声"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CWhiteHuman<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Talk</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"白色人种会说话，一般都是单字节"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>BlackHuman.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ihuman.h"</span></span>
class CBlackHuman <span class="token punctuation">:</span>
    public IHuman
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CBlackHuman</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CBlackHuman</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Laugh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Cry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Talk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>BlackHuman.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"BlackHuman.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
CBlackHuman<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CBlackHuman</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
CBlackHuman<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CBlackHuman</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CBlackHuman<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Cry</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"黑人会哭"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CBlackHuman<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Laugh</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"黑人会笑"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CBlackHuman<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Talk</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"黑人可以说话，一般人听不懂"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>IHumanFactory.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"IHuman.h"</span></span>
class IHumanFactory
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">IHumanFactory</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    virtual <span class="token operator">~</span><span class="token function">IHumanFactory</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    virtual IHuman <span class="token operator">*</span> <span class="token function">CreateHuman</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>YellowHumanFactory.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ihumanfactory.h"</span></span>
class CYellowHumanFactory <span class="token punctuation">:</span>
    public IHumanFactory
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CYellowHumanFactory</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CYellowHumanFactory</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    virtual IHuman <span class="token operator">*</span> <span class="token function">CreateHuman</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>YellowHumanFactory.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"YellowHumanFactory.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"YellowHuman.h"</span></span>
CYellowHumanFactory<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CYellowHumanFactory</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
CYellowHumanFactory<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CYellowHumanFactory</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
IHuman <span class="token operator">*</span> CYellowHumanFactory<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CreateHuman</span><span class="token punctuation">(</span> <span class="token keyword">void</span> <span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> new <span class="token function">CYellowHuman</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>//WhiteHumanFactory.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ihumanfactory.h"</span></span>
class CWhiteHumanFactory <span class="token punctuation">:</span>
    public IHumanFactory
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CWhiteHumanFactory</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CWhiteHumanFactory</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    virtual IHuman <span class="token operator">*</span> <span class="token function">CreateHuman</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>//WhiteHumanFactory.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"WhiteHumanFactory.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"WhiteHuman.h"</span></span>
CWhiteHumanFactory<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CWhiteHumanFactory</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
CWhiteHumanFactory<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CWhiteHumanFactory</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
IHuman <span class="token operator">*</span> CWhiteHumanFactory<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CreateHuman</span><span class="token punctuation">(</span> <span class="token keyword">void</span> <span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> new <span class="token function">CWhiteHuman</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>BlackHumanFactory.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ihumanfactory.h"</span></span>
class CBlackHumanFactory <span class="token punctuation">:</span>
    public IHumanFactory
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CBlackHumanFactory</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CBlackHumanFactory</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    virtual IHuman <span class="token operator">*</span> <span class="token function">CreateHuman</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>BlackHumanFactory.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"BlackHumanFactory.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"BlackHuman.h"</span></span>
CBlackHumanFactory<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CBlackHumanFactory</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
CBlackHumanFactory<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CBlackHumanFactory</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
IHuman <span class="token operator">*</span> CBlackHumanFactory<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CreateHuman</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> new <span class="token function">CBlackHuman</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>NvWa.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"IHuman.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"YellowHuman.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"WhiteHuman.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"BlackHuman.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"IHumanFactory.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"YellowHumanFactory.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"WhiteHumanFactory.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"BlackHumanFactory.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">DoFactoryMethod1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"----------第一批人是这样的：黄种人工厂来生产黄种人"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    IHumanFactory <span class="token operator">*</span>pHumanFactory <span class="token operator">=</span> new <span class="token function">CYellowHumanFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    IHuman <span class="token operator">*</span>pHuman <span class="token operator">=</span> pHumanFactory<span class="token operator">-></span><span class="token function">CreateHuman</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pHuman<span class="token operator">-></span><span class="token function">Cry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pHuman<span class="token operator">-></span><span class="token function">Laugh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pHuman<span class="token operator">-></span><span class="token function">Talk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    delete pHuman<span class="token punctuation">;</span>
    delete pHumanFactory<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">DoFactoryMethod2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"----------第二批人是这样的：白种人工厂来生产白种人"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    IHumanFactory <span class="token operator">*</span>pHumanFactory <span class="token operator">=</span> new <span class="token function">CWhiteHumanFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    IHuman <span class="token operator">*</span>pHuman <span class="token operator">=</span> pHumanFactory<span class="token operator">-></span><span class="token function">CreateHuman</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pHuman<span class="token operator">-></span><span class="token function">Cry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pHuman<span class="token operator">-></span><span class="token function">Laugh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pHuman<span class="token operator">-></span><span class="token function">Talk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    delete pHuman<span class="token punctuation">;</span>
    delete pHumanFactory<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">DoFactoryMethod3</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"----------第三批人是这样的：黑种人工厂来生产黑种人"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    IHumanFactory <span class="token operator">*</span>pHumanFactory <span class="token operator">=</span> new <span class="token function">CBlackHumanFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    IHuman <span class="token operator">*</span>pHuman <span class="token operator">=</span> pHumanFactory<span class="token operator">-></span><span class="token function">CreateHuman</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pHuman<span class="token operator">-></span><span class="token function">Cry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pHuman<span class="token operator">-></span><span class="token function">Laugh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pHuman<span class="token operator">-></span><span class="token function">Talk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    delete pHuman<span class="token punctuation">;</span>
    delete pHumanFactory<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//工厂方法</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"----------工厂方法："</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token function">DoFactoryMethod1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">DoFactoryMethod2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">DoFactoryMethod3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">_CrtSetDbgFlag</span><span class="token punctuation">(</span>_CRTDBG_LEAK_CHECK_DF <span class="token operator">|</span> _CRTDBG_ALLOC_MEM_DF<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">_CrtDumpMemoryLeaks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>----------工厂方法：
----------第一批人是这样的：黄种人工厂来生产黄种人
黄色人种会哭
黄色人种会大笑，幸福呀！
黄色人种会说话，一般说的都是双字节
----------第二批人是这样的：白种人工厂来生产白种人
白色人种会哭
白色人种会大笑，侵略的笑声
白色人种会说话，一般都是单字节
----------第三批人是这样的：黑种人工厂来生产黑种人
黑人会哭
黑人会笑
黑人可以说话，一般人听不懂 </code></pre><h2 id="抽象工厂模式"><a href="#抽象工厂模式" class="headerlink" title="抽象工厂模式"></a>抽象工厂模式</h2><blockquote>
<p>Provide an interface for creating families of related or dependent objects without specifying their concrete classes.<br><br>为创建一组相关或相互依赖的对象提供一个接口，而且无须指定它们的具体类。</p>
</blockquote>
<p>抽象工厂，提供一个创建一系列相关或相互依赖对象的接口，而无需指定它们具体的类。对于工厂方法来说，抽象工厂可实现一系列产品的生产，抽象工厂更注重产品的组合。</p>
<hr>

<p>main()，女娲</p>
<p>IHuman，产品接口</p>
<p>CYellowHuman，抽象产品之一</p>
<p>CYellowFemaleHuman，具体产品之一</p>
<p>CYellowMaleHuman，具体产品之二</p>
<p>CWhiteHuman，抽象产品之二</p>
<p>CWhiteFemaleHuman，具体产品之三</p>
<p>CWhiteMaleHuman，具体产品之四</p>
<p>CBlackHuman，抽象产品之三</p>
<p>CBlackFemaleHuman，具体产品之五</p>
<p>CBlackMaleHuman，具体产品之六</p>
<p>IHumanFactory，抽象工厂</p>
<p>CStandardHumanFactory，抽象工厂基类（此类可有可无）</p>
<p>CFemaleHumanFactory，工厂之一</p>
<p>CMaleHumanFactory，工厂之二</p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1573295669309.png?x-oss-process=image/resize,m_lfit,h_450" alt="女娲造人新图"></p>
<p>IHuman.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
class IHuman
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>

    <span class="token function">IHuman</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    virtual <span class="token operator">~</span><span class="token function">IHuman</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    virtual <span class="token keyword">void</span> <span class="token function">Laugh</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">Cry</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">Talk</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">Sex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>YellowHuman.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ihuman.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
class CYellowHuman <span class="token punctuation">:</span>
    public IHuman
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CYellowHuman</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token operator">~</span><span class="token function">CYellowHuman</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">Laugh</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"黄色人种会大笑，幸福呀！"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">Cry</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"黄色人种会哭"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">Talk</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"黄色人种会说话，一般说的都是双字节"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    virtual <span class="token keyword">void</span> <span class="token function">Sex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>YellowFemaleHuman.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"yellowhuman.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
class CYellowFemaleHuman <span class="token punctuation">:</span>
    public CYellowHuman
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CYellowFemaleHuman</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token operator">~</span><span class="token function">CYellowFemaleHuman</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">Sex</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"该黄种人的性别为女..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>YellowMaleHuman.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"yellowhuman.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
class CYellowMaleHuman <span class="token punctuation">:</span>
    public CYellowHuman
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CYellowMaleHuman</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token operator">~</span><span class="token function">CYellowMaleHuman</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">Sex</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"该黄种人的性别为男..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>//WhiteHuman.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ihuman.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
class CWhiteHuman <span class="token punctuation">:</span>
    public IHuman
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CWhiteHuman</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token operator">~</span><span class="token function">CWhiteHuman</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">Laugh</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"白色人种会大笑，侵略的笑声"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">Cry</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"白色人种会哭"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">Talk</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"白色人种会说话，一般都是单字节"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    virtual <span class="token keyword">void</span> <span class="token function">Sex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>//WhiteFemaleHuman.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"whitehuman.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
class CWhiteFemaleHuman <span class="token punctuation">:</span>
    public CWhiteHuman
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CWhiteFemaleHuman</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token operator">~</span><span class="token function">CWhiteFemaleHuman</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">Sex</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"该白种人的性别为女..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>//WhiteMaleHuman.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"whitehuman.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
class CWhiteMaleHuman <span class="token punctuation">:</span>
    public CWhiteHuman
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CWhiteMaleHuman</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token operator">~</span><span class="token function">CWhiteMaleHuman</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">Sex</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"该白种人的性别为男..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>BlackHuman.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ihuman.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
class CBlackHuman <span class="token punctuation">:</span>
    public IHuman
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CBlackHuman</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token operator">~</span><span class="token function">CBlackHuman</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">Laugh</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"黑人会笑"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">Cry</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"黑人会哭"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">Talk</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"黑人可以说话，一般人听不懂"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    virtual <span class="token keyword">void</span> <span class="token function">Sex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>BlackFemaleHuman.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"blackhuman.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
class CBlackFemaleHuman <span class="token punctuation">:</span>
    public CBlackHuman
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CBlackFemaleHuman</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token operator">~</span><span class="token function">CBlackFemaleHuman</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">Sex</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"该黑种人的性别为女..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>BlackMaleHuman.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"blackhuman.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
class CBlackMaleHuman <span class="token punctuation">:</span>
    public CBlackHuman
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CBlackMaleHuman</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token operator">~</span><span class="token function">CBlackMaleHuman</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">Sex</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"该黑种人的性别为男..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>IHumanFactory.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"IHuman.h"</span></span>
class IHumanFactory
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">IHumanFactory</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    virtual <span class="token operator">~</span><span class="token function">IHumanFactory</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    virtual IHuman <span class="token operator">*</span> <span class="token function">CreateYellowHuman</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual IHuman <span class="token operator">*</span> <span class="token function">CreateWhiteHuman</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual IHuman <span class="token operator">*</span> <span class="token function">CreateBlackHuman</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>MaleHumanFactory.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>

<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"StandardHumanFactory.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"IHumanFactory.h"</span></span>
template<span class="token operator">&lt;</span>class T<span class="token operator">></span>
class CMaleHumanFactory <span class="token punctuation">:</span>
   public IHumanFactory
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
   <span class="token function">CMaleHumanFactory</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
   <span class="token punctuation">}</span>
   <span class="token operator">~</span><span class="token function">CMaleHumanFactory</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
   <span class="token punctuation">}</span>
   IHuman<span class="token operator">*</span> <span class="token function">CreateYellowHuman</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
      <span class="token keyword">return</span> new T<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   IHuman<span class="token operator">*</span> <span class="token function">CreateWhiteHuman</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
      <span class="token keyword">return</span> new T<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   IHuman<span class="token operator">*</span> <span class="token function">CreateBlackHuman</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
      <span class="token keyword">return</span> new T<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>FemaleHumanFactory.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"standardhumanfactory.h"</span></span>
template<span class="token operator">&lt;</span>class T<span class="token operator">></span>
class CFemaleHumanFactory <span class="token punctuation">:</span>
   public IHumanFactory
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
   <span class="token function">CFemaleHumanFactory</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
   <span class="token punctuation">}</span>
   <span class="token operator">~</span><span class="token function">CFemaleHumanFactory</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
   <span class="token punctuation">}</span>
   IHuman<span class="token operator">*</span> <span class="token function">CreateYellowHuman</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
      <span class="token keyword">return</span> new T<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   IHuman<span class="token operator">*</span> <span class="token function">CreateWhiteHuman</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
      <span class="token keyword">return</span> new T<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   IHuman<span class="token operator">*</span> <span class="token function">CreateBlackHuman</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
      <span class="token keyword">return</span> new T<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>AbstractFactory.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"IHuman.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"IHumanFactory.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"FemaleHumanFactory.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"MaleHumanFactory.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"yellowhuman.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"YellowFemaleHuman.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"YellowMaleHuman.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"whitehuman.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"WhiteFemaleHuman.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"WhiteMaleHuman.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"blackhuman.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"BlackFemaleHuman.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"BlackMaleHuman.h"</span></span>

<span class="token keyword">void</span> <span class="token function">DoIt</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   IHumanFactory<span class="token operator">*</span> pFemaleHumanFactory <span class="token operator">=</span> new CFemaleHumanFactory<span class="token operator">&lt;</span>CYellowFemaleHuman<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   IHuman<span class="token operator">*</span> pYellowFemaleHuman <span class="token operator">=</span> pFemaleHumanFactory<span class="token operator">-></span><span class="token function">CreateYellowHuman</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   pYellowFemaleHuman<span class="token operator">-></span><span class="token function">Cry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   pYellowFemaleHuman<span class="token operator">-></span><span class="token function">Laugh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   pYellowFemaleHuman<span class="token operator">-></span><span class="token function">Talk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   pYellowFemaleHuman<span class="token operator">-></span><span class="token function">Sex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   delete pYellowFemaleHuman<span class="token punctuation">;</span>
   delete pFemaleHumanFactory<span class="token punctuation">;</span>

   IHumanFactory<span class="token operator">*</span> pMaleHumanFactory <span class="token operator">=</span> new CMaleHumanFactory<span class="token operator">&lt;</span>CYellowMaleHuman<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   IHuman<span class="token operator">*</span> pYellowMaleHuman <span class="token operator">=</span> pMaleHumanFactory<span class="token operator">-></span><span class="token function">CreateYellowHuman</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   pYellowMaleHuman<span class="token operator">-></span><span class="token function">Cry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   pYellowMaleHuman<span class="token operator">-></span><span class="token function">Laugh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   pYellowMaleHuman<span class="token operator">-></span><span class="token function">Talk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   pYellowMaleHuman<span class="token operator">-></span><span class="token function">Sex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   delete pYellowMaleHuman<span class="token punctuation">;</span>
   delete pMaleHumanFactory<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   <span class="token function">DoIt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">_CrtSetDbgFlag</span><span class="token punctuation">(</span>_CRTDBG_LEAK_CHECK_DF <span class="token operator">|</span> _CRTDBG_ALLOC_MEM_DF<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">_CrtDumpMemoryLeaks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>黄色人种会哭
黄色人种会大笑，幸福呀！
黄色人种会说话，一般说的都是双字节
该黄种人的性别为女...
黄色人种会哭
黄色人种会大笑，幸福呀！
黄色人种会说话，一般说的都是双字节
该黄种人的性别为男... </code></pre><h2 id="模板方法模式"><a href="#模板方法模式" class="headerlink" title="模板方法模式"></a>模板方法模式</h2><blockquote>
<p>Define the skeleton of an algorithm in an operation,deferring some steps to subclasses.Template Method lets subclasses redefine certain steps of an algorithm without changing the algorithm’s structure.<br><br>定义一个操作中的算法的框架，而将一些步骤延迟到子类中。使得子类可以不改变一个算法的结构即可重定义该算法的某些特定步骤。</p>
</blockquote>
<p>main()，客户</p>
<p>CHummerModel，悍马模型</p>
<p>CHummerH1Model，悍马模型型号1</p>
<p>CHummerH2Model，悍马模型型号2</p>
<p>说明：在CHummerModel声明Start、Engineboom、Alarm、Stop虚函数，由派生类实现。基类的Run负责组织逻辑，分别调用这几个派生类实现的函数。</p>
<p>注意：基类中的Run应该禁止派生类覆盖。<br><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1573313617677.png?x-oss-process=image/resize,m_lfit,h_450" alt="悍马车模类图"></p>
<p>HummerModel.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
class CHummerModel
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CHummerModel</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    virtual <span class="token operator">~</span><span class="token function">CHummerModel</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
protected<span class="token punctuation">:</span>
    virtual <span class="token keyword">void</span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">Alarm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">EngineBoom</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual bool <span class="token function">IsAlarm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>HummerModel.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"HummerModel.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
CHummerModel<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CHummerModel</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
CHummerModel<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CHummerModel</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CHummerModel<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//先发动汽车</span>
    <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//引擎开始轰鸣</span>
    <span class="token function">EngineBoom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//然后就开始跑了，跑的过程中遇到一条狗挡路，就按喇叭</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">IsAlarm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token function">Alarm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">//到达目的地就停车</span>
    <span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
bool CHummerModel<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">IsAlarm</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//钩子方法，默认喇叭是会响的</span>
    <span class="token keyword">return</span> true<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>HummerH1Model.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"hummermodel.h"</span></span>
class CHummerH1Model <span class="token punctuation">:</span>
    public CHummerModel
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CHummerH1Model</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CHummerH1Model</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">SetAlarm</span><span class="token punctuation">(</span>bool tag<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Alarm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">EngineBoom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    bool <span class="token function">IsAlarm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
private<span class="token punctuation">:</span>
    bool m_isAlarm<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>HummerH1Model.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"HummerH1Model.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
CHummerH1Model<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CHummerH1Model</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    m_isAlarm <span class="token operator">=</span> true<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
CHummerH1Model<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CHummerH1Model</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CHummerH1Model<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"悍马H1发动..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CHummerH1Model<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"悍马H1停车..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CHummerH1Model<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Alarm</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"悍马H1鸣笛"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CHummerH1Model<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">EngineBoom</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"悍马H1引擎声音是这样...."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
bool CHummerH1Model<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">IsAlarm</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> this<span class="token operator">-></span>m_isAlarm<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CHummerH1Model<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">SetAlarm</span><span class="token punctuation">(</span> bool tag <span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    this<span class="token operator">-></span>m_isAlarm <span class="token operator">=</span> tag<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>HummerH2Model.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"hummermodel.h"</span></span>
class CHummerH2Model <span class="token punctuation">:</span>
    public CHummerModel
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CHummerH2Model</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CHummerH2Model</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Alarm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">EngineBoom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    bool <span class="token function">IsAlarm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>HummerH2Model.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"HummerH2Model.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
CHummerH2Model<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CHummerH2Model</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
CHummerH2Model<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CHummerH2Model</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CHummerH2Model<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"悍马H2发动..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CHummerH2Model<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"悍马H2停车..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CHummerH2Model<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Alarm</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"悍马H2鸣笛"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CHummerH2Model<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">EngineBoom</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"悍马H2引擎声音是这样...."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
bool CHummerH2Model<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">IsAlarm</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> false<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>TemplateMethod.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"HummerModel.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"HummerH1Model.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"HummerH2Model.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;crtdbg.h></span></span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//客户开着H1型号，出去遛弯了</span>
    CHummerModel <span class="token operator">*</span>ph1 <span class="token operator">=</span> new <span class="token function">CHummerH1Model</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ph1<span class="token operator">-></span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    delete ph1<span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">//客户开H2型号，出去玩耍了</span>
    CHummerModel <span class="token operator">*</span>ph2 <span class="token operator">=</span> new <span class="token function">CHummerH2Model</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ph2<span class="token operator">-></span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    delete ph2<span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">//客户开着H1型号，出去遛弯了，并且不让喇叭响</span>
    CHummerH1Model <span class="token operator">*</span>ph11 <span class="token operator">=</span> new <span class="token function">CHummerH1Model</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ph11<span class="token operator">-></span><span class="token function">SetAlarm</span><span class="token punctuation">(</span>false<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ph11<span class="token operator">-></span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    delete ph11<span class="token punctuation">;</span>

    <span class="token function">_CrtSetDbgFlag</span><span class="token punctuation">(</span>_CRTDBG_LEAK_CHECK_DF <span class="token operator">|</span> _CRTDBG_ALLOC_MEM_DF<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">_CrtDumpMemoryLeaks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>悍马H1发动...
悍马H1引擎声音是这样....
悍马H1鸣笛
悍马H1停车...悍马H2发动...悍马H2引擎声音是这样....
悍马H2停车...悍马H1发动...悍马H1引擎声音是这样....
悍马H1停车...</code></pre><h2 id="建造者模式"><a href="#建造者模式" class="headerlink" title="建造者模式"></a>建造者模式</h2><blockquote>
<p>Separate the construction of a complex object from its representation so that the same construction process can create different representations.<br><br>将一个复杂对象的构建与它的表示分离，使得同样的构建过程可以创建不同的表示。</p>
</blockquote>
<hr>

<p>main()，客户</p>
<p>CCarModel，产品模型</p>
<p>CBenzModel，奔驰模型</p>
<p>CBMWModel，宝马模型</p>
<p>ICarBuilder，建造者接口</p>
<p>CBenzBuilder，奔驰建造者</p>
<p>CBMWBuilder，宝马建造者</p>
<p>CDirector，导演</p>
<p>说明：CCarModel实现模板方法，Builder负责开始建造产品。建造产品时，构建的顺序由Director或main决定。</p>
<p>注意：建造者模式和抽象工厂非常类似。建造者更重视产品建造时的逻辑顺序，而抽象工厂更重视生产出不同型号的产品，抽象工厂不关心顺序。</p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1573314518993.png?x-oss-process=image/resize,m_lfit,h_450" alt="汽车模型类图"></p>
<p>// Builder.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"CarModel.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"BenzModel.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"BMWModel.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"BenzBuilder.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"BMWBuilder.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Director.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>vector<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>


<span class="token keyword">void</span> <span class="token function">DoBenzRun</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   cout <span class="token operator">&lt;&lt;</span> <span class="token string">"----------生成奔驰模型----------"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
   CBenzModel<span class="token operator">*</span> pBenz <span class="token operator">=</span> new <span class="token function">CBenzModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span>string<span class="token operator">></span> seq<span class="token punctuation">;</span>
   seq<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token string">"engine boom"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//客户要求run的时候先发动引擎</span>
   seq<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token string">"start"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//启动起来</span>
   seq<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token string">"stop"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//开了一段就停下来</span>

   pBenz<span class="token operator">-></span><span class="token function">SetSequence</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>seq<span class="token punctuation">)</span><span class="token punctuation">;</span>
   pBenz<span class="token operator">-></span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   delete pBenz<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//使用模式后，由benzBuilder和bmwBuilder来生成，并且使用同样的创建顺序。</span>
<span class="token keyword">void</span> <span class="token function">DoBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   cout <span class="token operator">&lt;&lt;</span> <span class="token string">"----------用同一个顺序，生成模型----------"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span>string<span class="token operator">></span> seq<span class="token punctuation">;</span>
   seq<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token string">"engine boom"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   seq<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token string">"start"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   seq<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token string">"stop"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   CBenzBuilder benzBuilder<span class="token punctuation">;</span>
   benzBuilder<span class="token punctuation">.</span><span class="token function">SetSequence</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>seq<span class="token punctuation">)</span><span class="token punctuation">;</span>
   CBenzModel<span class="token operator">*</span> pBenz <span class="token operator">=</span> dynamic_cast<span class="token operator">&lt;</span>CBenzModel<span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">(</span>benzBuilder<span class="token punctuation">.</span><span class="token function">GetCarModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   pBenz<span class="token operator">-></span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   CBMWBuilder bmwBuilder<span class="token punctuation">;</span>
   bmwBuilder<span class="token punctuation">.</span><span class="token function">SetSequence</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>seq<span class="token punctuation">)</span><span class="token punctuation">;</span>
   CBMWModel<span class="token operator">*</span> pBmw <span class="token operator">=</span> dynamic_cast<span class="token operator">&lt;</span>CBMWModel<span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">(</span>bmwBuilder<span class="token punctuation">.</span><span class="token function">GetCarModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   pBenz<span class="token operator">-></span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">//使用指导者来封装创建的逻辑，把创建的顺序内聚在指导者类里面。</span>
<span class="token keyword">void</span> <span class="token function">DoDirector</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   cout <span class="token operator">&lt;&lt;</span> <span class="token string">"----------批量生成模型----------"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
   CDirector director<span class="token punctuation">;</span>

   <span class="token comment" spellcheck="true">//1W辆A类型的奔驰车</span>
   <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
      director<span class="token punctuation">.</span><span class="token function">GetABenzModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token comment" spellcheck="true">//100W辆B类型的奔驰车</span>
   <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
      director<span class="token punctuation">.</span><span class="token function">GetBBenzModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token comment" spellcheck="true">//1000W辆C类型的宝马车</span>
   <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
      director<span class="token punctuation">.</span><span class="token function">GetCBMWModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   <span class="token function">DoBenzRun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token function">DoBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token function">DoDirector</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token function">_CrtSetDbgFlag</span><span class="token punctuation">(</span>_CRTDBG_LEAK_CHECK_DF <span class="token operator">|</span> _CRTDBG_ALLOC_MEM_DF<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">_CrtDumpMemoryLeaks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>CarModel.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>vector<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>
class CCarModel
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CCarModel</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    virtual <span class="token operator">~</span><span class="token function">CCarModel</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">SetSequence</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>string<span class="token operator">></span> <span class="token operator">*</span>pSeq<span class="token punctuation">)</span><span class="token punctuation">;</span>
protected<span class="token punctuation">:</span>
    virtual <span class="token keyword">void</span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">Alarm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">EngineBoom</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
private<span class="token punctuation">:</span>
    vector<span class="token operator">&lt;</span>string<span class="token operator">></span> <span class="token operator">*</span> m_pSequence<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>CarModel.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"CarModel.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>vector<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>
CCarModel<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CCarModel</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
CCarModel<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CCarModel</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CCarModel<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">SetSequence</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>string<span class="token operator">></span> <span class="token operator">*</span>pSeq<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    m_pSequence <span class="token operator">=</span> pSeq<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CCarModel<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    vector<span class="token operator">&lt;</span>string<span class="token operator">></span><span class="token punctuation">:</span><span class="token punctuation">:</span>const_iterator it <span class="token operator">=</span> m_pSequence<span class="token operator">-></span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> it <span class="token operator">&lt;</span> m_pSequence<span class="token operator">-></span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>it<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        string actionName <span class="token operator">=</span> <span class="token operator">*</span>it<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>actionName<span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span><span class="token string">"start"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>actionName<span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span><span class="token string">"stop"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>actionName<span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span><span class="token string">"alarm"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token function">Alarm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>actionName<span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span><span class="token string">"engine boom"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token function">EngineBoom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>BenzModel.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"carmodel.h"</span></span>
class CBenzModel <span class="token punctuation">:</span>
    public CCarModel
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CBenzModel</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CBenzModel</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
protected<span class="token punctuation">:</span>
    <span class="token keyword">void</span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Alarm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">EngineBoom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>BenzModel.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"BenzModel.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
CBenzModel<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CBenzModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
CBenzModel<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CBenzModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CBenzModel<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   cout <span class="token operator">&lt;&lt;</span> <span class="token string">"奔驰发动..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CBenzModel<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   cout <span class="token operator">&lt;&lt;</span> <span class="token string">"奔驰停车..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CBenzModel<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Alarm</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   cout <span class="token operator">&lt;&lt;</span> <span class="token string">"奔驰鸣笛"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CBenzModel<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">EngineBoom</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   cout <span class="token operator">&lt;&lt;</span> <span class="token string">"奔驰引擎声音是这样...."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>BMWModel.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"carmodel.h"</span></span>
class CBMWModel <span class="token punctuation">:</span>
    public CCarModel
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CBMWModel</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CBMWModel</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
protected<span class="token punctuation">:</span>
    <span class="token keyword">void</span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Alarm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">EngineBoom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>BMWModel.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"BMWModel.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
CBMWModel<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CBMWModel</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
CBMWModel<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CBMWModel</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CBMWModel<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"宝马发动..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CBMWModel<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"宝马停车..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CBMWModel<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Alarm</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"宝马鸣笛"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CBMWModel<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">EngineBoom</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"宝马引擎声音是这样...."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ICarBuilder.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"CarModel.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>vector<span class="token punctuation">;</span>
class ICarBuilder
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">ICarBuilder</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    virtual <span class="token operator">~</span><span class="token function">ICarBuilder</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    virtual <span class="token keyword">void</span> <span class="token function">SetSequence</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>string<span class="token operator">></span> <span class="token operator">*</span>pseq<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual CCarModel <span class="token operator">*</span> <span class="token function">GetCarModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>BenzBuilder.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"icarbuilder.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"CarModel.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>vector<span class="token punctuation">;</span>
class CBenzBuilder <span class="token punctuation">:</span>
    public ICarBuilder
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CBenzBuilder</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CBenzBuilder</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">SetSequence</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>string<span class="token operator">></span> <span class="token operator">*</span>pSeq<span class="token punctuation">)</span><span class="token punctuation">;</span>
    CCarModel <span class="token operator">*</span> <span class="token function">GetCarModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
private<span class="token punctuation">:</span>
    CCarModel <span class="token operator">*</span>m_pBenz<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>BenzBuilder.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"BenzBuilder.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"BenzModel.h"</span></span>
CBenzBuilder<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CBenzBuilder</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    m_pBenz <span class="token operator">=</span> new <span class="token function">CBenzModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
CBenzBuilder<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CBenzBuilder</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    delete m_pBenz<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CBenzBuilder<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">SetSequence</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>string<span class="token operator">></span> <span class="token operator">*</span>pSeq<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    m_pBenz<span class="token operator">-></span><span class="token function">SetSequence</span><span class="token punctuation">(</span>pSeq<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
CCarModel <span class="token operator">*</span> CBenzBuilder<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetCarModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> m_pBenz<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>BMWBuilder.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"icarbuilder.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"CarModel.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>vector<span class="token punctuation">;</span>
class CBMWBuilder <span class="token punctuation">:</span>
    public ICarBuilder
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CBMWBuilder</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CBMWBuilder</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">SetSequence</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>string<span class="token operator">></span> <span class="token operator">*</span>pSeq<span class="token punctuation">)</span><span class="token punctuation">;</span>
    CCarModel <span class="token operator">*</span> <span class="token function">GetCarModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
private<span class="token punctuation">:</span>
    CCarModel <span class="token operator">*</span>m_pBMW<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>BMWBuilder.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"BMWBuilder.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"BMWModel.h"</span></span>
CBMWBuilder<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CBMWBuilder</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    m_pBMW <span class="token operator">=</span> new <span class="token function">CBMWModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
CBMWBuilder<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CBMWBuilder</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    delete m_pBMW<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CBMWBuilder<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">SetSequence</span><span class="token punctuation">(</span> vector<span class="token operator">&lt;</span>string<span class="token operator">></span> <span class="token operator">*</span>pSeq <span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    m_pBMW<span class="token operator">-></span><span class="token function">SetSequence</span><span class="token punctuation">(</span>pSeq<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
CCarModel <span class="token operator">*</span> CBMWBuilder<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetCarModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> m_pBMW<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Director.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"BenzModel.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"BMWModel.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"BenzBuilder.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"BMWBuilder.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>vector<span class="token punctuation">;</span>
class CDirector
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CDirector</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CDirector</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    CBenzModel <span class="token operator">*</span> <span class="token function">GetABenzModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    CBenzModel <span class="token operator">*</span> <span class="token function">GetBBenzModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    CBMWModel <span class="token operator">*</span> <span class="token function">GetCBMWModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    CBMWModel <span class="token operator">*</span> <span class="token function">GetDBMWModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
private<span class="token punctuation">:</span>
    vector<span class="token operator">&lt;</span>string<span class="token operator">></span> <span class="token operator">*</span> m_pSeqence<span class="token punctuation">;</span>
    CBenzBuilder <span class="token operator">*</span> m_pBenzBuilder<span class="token punctuation">;</span>
    CBMWBuilder <span class="token operator">*</span> m_pBMWBuilder<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Director.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Director.h"</span></span>
CDirector<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CDirector</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    m_pBenzBuilder <span class="token operator">=</span> new <span class="token function">CBenzBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    m_pBMWBuilder <span class="token operator">=</span> new <span class="token function">CBMWBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    m_pSeqence <span class="token operator">=</span> new vector<span class="token operator">&lt;</span>string<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
CDirector<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CDirector</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    delete m_pBenzBuilder<span class="token punctuation">;</span>
    delete m_pBMWBuilder<span class="token punctuation">;</span>
    delete m_pSeqence<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
CBenzModel <span class="token operator">*</span> CDirector<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetABenzModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    m_pSeqence<span class="token operator">-></span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    m_pSeqence<span class="token operator">-></span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token string">"start"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    m_pSeqence<span class="token operator">-></span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token string">"stop"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    m_pBenzBuilder<span class="token operator">-></span><span class="token function">SetSequence</span><span class="token punctuation">(</span>m_pSeqence<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> dynamic_cast<span class="token operator">&lt;</span>CBenzModel<span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">(</span>m_pBenzBuilder<span class="token operator">-></span><span class="token function">GetCarModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
CBenzModel <span class="token operator">*</span> CDirector<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetBBenzModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    m_pSeqence<span class="token operator">-></span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    m_pSeqence<span class="token operator">-></span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token string">"engine boom"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    m_pSeqence<span class="token operator">-></span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token string">"start"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    m_pSeqence<span class="token operator">-></span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token string">"stop"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    m_pBenzBuilder<span class="token operator">-></span><span class="token function">SetSequence</span><span class="token punctuation">(</span>m_pSeqence<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> dynamic_cast<span class="token operator">&lt;</span>CBenzModel<span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">(</span>m_pBenzBuilder<span class="token operator">-></span><span class="token function">GetCarModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
CBMWModel <span class="token operator">*</span> CDirector<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetCBMWModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    m_pSeqence<span class="token operator">-></span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    m_pSeqence<span class="token operator">-></span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token string">"alarm"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    m_pSeqence<span class="token operator">-></span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token string">"start"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    m_pSeqence<span class="token operator">-></span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token string">"stop"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    m_pBMWBuilder<span class="token operator">-></span><span class="token function">SetSequence</span><span class="token punctuation">(</span>m_pSeqence<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> static_cast<span class="token operator">&lt;</span>CBMWModel<span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">(</span>m_pBMWBuilder<span class="token operator">-></span><span class="token function">GetCarModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
CBMWModel <span class="token operator">*</span> CDirector<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetDBMWModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    m_pSeqence<span class="token operator">-></span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    m_pSeqence<span class="token operator">-></span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token string">"start"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    m_pBenzBuilder<span class="token operator">-></span><span class="token function">SetSequence</span><span class="token punctuation">(</span>m_pSeqence<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> dynamic_cast<span class="token operator">&lt;</span>CBMWModel<span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">(</span>m_pBMWBuilder<span class="token operator">-></span><span class="token function">GetCarModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>----------用同一个顺序，生成模型----------
奔驰引擎声音是这样....
奔驰发动...
奔驰停车...
奔驰引擎声音是这样....
奔驰发动...
奔驰停车...
----------批量生成模型----------
奔驰发动...
奔驰停车...
奔驰发动...
奔驰停车...
奔驰引擎声音是这样....
奔驰发动...
奔驰停车...
奔驰引擎声音是这样....
奔驰发动...
奔驰停车...
宝马鸣笛
宝马发动...
宝马停车...
宝马鸣笛
宝马发动...
宝马停车... </code></pre><h2 id="代理模式"><a href="#代理模式" class="headerlink" title="代理模式"></a>代理模式</h2><blockquote>
<p>Provide a surrogate or placeholder for another object to control access to it.<br><br>为其他对象提供一种代理以控制对这个对象的访问。</p>
</blockquote>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1576996638986.png?x-oss-process=image/resize,m_lfit,h_450" alt="代理模式"></p>
<p>代理模式也叫做委托模式，它是一项基本设计技巧。许多其他的模式，如状态模式、策略模式、访问者模式本质上是在更特殊的场合采用了委托模式，而且在日常的应用中，代理模式可以提供非常好的访问控制。</p>
<p>● Subject抽象主题角色<br>抽象主题类可以是抽象类也可以是接口，是一个最普通的业务类型定义，无特殊要求。</p>
<p>● RealSubject具体主题角色<br>也叫做被委托角色、被代理角色，是业务逻辑的具体执行者。</p>
<p>● Proxy代理主题角色<br>也叫做委托类、代理类。它负责对真实角色的应用，把所有抽象主题类定义的方法限制委托给真实主题角色实现，并且在真实主题角色处理完毕前后做预处理和善后处理工作。</p>
<p><code>代理模式的优点：</code><br>● 职责清晰<br>真实的角色就是实现实际的业务逻辑，不用关心其他非本职责的事务，通过后期的代理完成一件事务，附带的结果就是编程简洁清晰。</p>
<p>● 高扩展性<br>具体主题角色是随时都会发生变化的，只要它实现了接口，甭管它如何变化，都逃不脱如来佛的手掌（接口），那我们的代理类完全就可以在不做任何修改的情况下使用。</p>
<p>● 智能化<br>这在我们以上的讲解中还没有体现出来，不过在我们以下的动态代理章节中你就会看到代理的智能化有兴趣的读者也可以看看Struts是如何把表单元素映射到对象上的。</p>
<p>我相信第一次接触到代理模式的读者肯定很郁闷，为什么要用代理呀？想想现实世界吧，打官司为什么要找个律师？因为你不想参与中间过程的是是非非，只要完成自己的答辩就成，其他的比如事前调查、事后追查都由律师来搞定，这就是为了减轻你的负担。</p>
<p><strong>个人理解：</strong><br>代理模式应该是给传入的对象统一附加其他功能（函数）。</p>
<hr>

<pre class="line-numbers language-c"><code class="language-c"><span class="token comment" spellcheck="true">//主题类</span>
class Subject
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
　　virtual <span class="token function">Subject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
　　virtual <span class="token operator">~</span><span class="token function">Subject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
　　virtual <span class="token keyword">void</span> <span class="token function">Request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//具体代理的任务</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//真实主题类</span>
class ConcreteSubject<span class="token punctuation">:</span>public Subject
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
　　<span class="token function">ConcreteSubject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
　　<span class="token operator">~</span><span class="token function">ConcreteSubject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
　　<span class="token keyword">void</span> <span class="token function">Request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//代理类</span>
class Proxy<span class="token punctuation">:</span>public Subject
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
　　<span class="token function">Proxy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
　　<span class="token function">Proxy</span><span class="token punctuation">(</span>Subject<span class="token operator">*</span> _sub<span class="token punctuation">)</span><span class="token punctuation">;</span>
　　<span class="token operator">~</span><span class="token function">Proxy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

　　<span class="token keyword">void</span> <span class="token function">Request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">//实现对委托者的委托任务执行与补偿</span>
　　<span class="token punctuation">{</span>
　　　　<span class="token function">bef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
　　　　this<span class="token operator">-></span>_sub<span class="token operator">-></span><span class="token function">Request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
　　　　<span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
　　<span class="token punctuation">}</span>

　　<span class="token keyword">void</span> <span class="token function">bef</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
　　<span class="token punctuation">{</span><span class="token punctuation">}</span>

　　<span class="token keyword">void</span> <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
　　<span class="token punctuation">{</span><span class="token punctuation">}</span>

private<span class="token punctuation">:</span>
　　Subject<span class="token operator">*</span> _sub<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="原型模式"><a href="#原型模式" class="headerlink" title="原型模式"></a>原型模式</h2><blockquote>
<p>Specify the kinds of objects to create using a prototypical instance,and create new objects by copying this prototype.<br><br>用原型实例指定创建对象的种类，并且通过拷贝这些原型创建新的对象。</p>
</blockquote>
<h2 id="中介者模式"><a href="#中介者模式" class="headerlink" title="中介者模式"></a>中介者模式</h2><blockquote>
<p>Define an object that encapsulates how a set of objects interact.Mediator promotes loose coupling by keeping objects from referring to each other explicitly,and it lets you vary their interaction independently.<br><br>用一个中介对象封装一系列的对象交互，中介者使各对象不需要显示地相互作用，从而使其耦合松散，而且可以独立地改变它们之间的交互。</p>
</blockquote>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://pagepig.oss-cn-hangzhou.aliyuncs.com/dfg.jpg?x-oss-process=image/resize,m_lfit,h_450" alt="中介者模式"><br>从类图中看，中介者模式由以下几部分组成：<br>● Mediator 抽象中介者角色<br>抽象中介者角色定义统一的接口，用于各同事角色之间的通信。<br>● Concrete Mediator 具体中介者角色<br>具体中介者角色通过协调各同事角色实现协作行为，因此它必须依赖于各个同事角色。<br>● Colleague 同事角色<br>每一个同事角色都知道中介者角色，而且与其他的同事角色通信的时候，一定要通过中介者角色协作。每个同事类的行为分为两种：一种是同事本身的行为，比如改变对象本身的状态，处理自己的行为等，这种行为叫做自发行为（Self-Method），与其他的同事类或中介者没有任何的依赖；第二种是必须依赖中介者才能完成的行为，叫做依赖方法（Dep-Method）。</p>
<p><strong>中介者模式的优点</strong><br>中介者模式的优点就是减少类间的依赖，把原有的一对多的依赖变成了一对一的依赖，同事类只依赖中介者，减少了依赖，当然同时也降低了类间的耦合。</p>
<p><strong>中介者模式的缺点</strong><br>中介者模式的缺点就是中介者会膨胀得很大，而且逻辑复杂，原本N个对象直接的相互依赖关系转换为中介者和同事类的依赖关系，同事类越多，中介者的逻辑就越复杂。</p>
<p><strong>MVC框架</strong><br>大家都应该使用过Struts，MVC框架，其中的C（Controller）就是一个中介者，叫做前端控制器(Front Controller)，它的作用就是把M(Model，业务逻辑)和V（View，视图）隔离开，协调M和V协同工作，把M运行的结果和V代表的视图融合成一个前端可以展示的页面，减少M和V的依赖关系。MVC框架已经成为一个非常流行、成熟的开发框架，这也是中介者模式的优点的一个体现。</p>
<hr>

<p>main.cpp</p>
<pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Colleague</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Mediator</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">Send</span><span class="token punctuation">(</span>string message<span class="token punctuation">,</span> Colleague<span class="token operator">*</span> colleague<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">virtual</span> <span class="token operator">~</span><span class="token function">Mediator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Colleague</span> <span class="token punctuation">{</span>
<span class="token keyword">protected</span><span class="token operator">:</span>
    Mediator<span class="token operator">*</span> mediator<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Colleague</span><span class="token punctuation">(</span>Mediator<span class="token operator">*</span> m<span class="token punctuation">)</span> <span class="token punctuation">{</span> mediator <span class="token operator">=</span> m<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">ConcreteColleague1</span> <span class="token operator">:</span> <span class="token keyword">public</span> Colleague <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">ConcreteColleague1</span><span class="token punctuation">(</span>Mediator<span class="token operator">*</span> m<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">Colleague</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">Send</span><span class="token punctuation">(</span>string message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        mediator<span class="token operator">-</span><span class="token operator">></span><span class="token function">Send</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">Notify</span><span class="token punctuation">(</span>string message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"ConcreteColleague1 received: "</span> <span class="token operator">&lt;&lt;</span> message <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">ConcreteColleague2</span> <span class="token operator">:</span> <span class="token keyword">public</span> Colleague <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">ConcreteColleague2</span><span class="token punctuation">(</span>Mediator<span class="token operator">*</span> m<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">Colleague</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">Send</span><span class="token punctuation">(</span>string message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        mediator<span class="token operator">-</span><span class="token operator">></span><span class="token function">Send</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">Notify</span><span class="token punctuation">(</span>string message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"ConcreteColleague2 received: "</span> <span class="token operator">&lt;&lt;</span> message <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">ConcreteMediator</span> <span class="token operator">:</span> <span class="token keyword">public</span> Mediator <span class="token punctuation">{</span>
<span class="token keyword">private</span><span class="token operator">:</span>
    ConcreteColleague1<span class="token operator">*</span> c1<span class="token punctuation">;</span>
    ConcreteColleague2<span class="token operator">*</span> c2<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span>ConcreteColleague1<span class="token operator">*</span> c<span class="token punctuation">)</span> <span class="token punctuation">{</span> c1 <span class="token operator">=</span> c<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span>ConcreteColleague2<span class="token operator">*</span> c<span class="token punctuation">)</span> <span class="token punctuation">{</span> c2 <span class="token operator">=</span> c<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token comment" spellcheck="true">//通过colleague传入对象进行判断，然后选择行为。</span>
    <span class="token keyword">void</span> <span class="token function">Send</span><span class="token punctuation">(</span>string message<span class="token punctuation">,</span> Colleague<span class="token operator">*</span> colleague<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>colleague <span class="token operator">==</span> c1<span class="token punctuation">)</span> c2<span class="token operator">-</span><span class="token operator">></span><span class="token function">Notify</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> c1<span class="token operator">-</span><span class="token operator">></span><span class="token function">Notify</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ConcreteMediator<span class="token operator">*</span> m <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ConcreteMediator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//让同事认识中介</span>
    ConcreteColleague1<span class="token operator">*</span> c1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ConcreteColleague1</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ConcreteColleague2<span class="token operator">*</span> c2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ConcreteColleague2</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//让中介认识同事</span>
    m<span class="token operator">-</span><span class="token operator">></span><span class="token function">set</span><span class="token punctuation">(</span>c1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    m<span class="token operator">-</span><span class="token operator">></span><span class="token function">set</span><span class="token punctuation">(</span>c2<span class="token punctuation">)</span><span class="token punctuation">;</span>

    c1<span class="token operator">-</span><span class="token operator">></span><span class="token function">Send</span><span class="token punctuation">(</span><span class="token string">"Hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">// ConcreteColleague2 received: Hello</span>
    c2<span class="token operator">-</span><span class="token operator">></span><span class="token function">Send</span><span class="token punctuation">(</span><span class="token string">"World"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// ConcreteColleague1 received: World</span>

    <span class="token keyword">delete</span> m<span class="token punctuation">;</span>
    <span class="token keyword">delete</span> c1<span class="token punctuation">;</span>
    <span class="token keyword">delete</span> c2<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-bash"><code class="language-bash">g++ main.cpp
./a.out<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<pre><code>ConcreteColleague2 received: Hello
ConcreteColleague1 received: World</code></pre><p>为什么同事类要使用构造函数注入中介者，而中介者使用getter/setter方式注入同事类呢？这是因为同事类必须有中介者，而中介者却可以只有部分同事类。</p>
<h2 id="命令模式"><a href="#命令模式" class="headerlink" title="命令模式"></a>命令模式</h2><blockquote>
<p>Encapsulate a request as an object,thereby letting you parameterize clients with different requests,queue or log requests,and support undoable operations.<br><br>将一个请求封装成一个对象，从而让你使用不同的请求把客户端参数化，对请求排队或者记录请求日志，可以提供命令的撤销和恢复功能。</p>
</blockquote>
<hr>

<p>main()，客户 </p>
<p>CInvoker，命令接收者，如项目经理 </p>
<p>IGroup，执行者接口 </p>
<p>CRequirementGroup，实际执行者之一</p>
<p>CPageGroup，实际执行者之二</p>
<p>CCodePage，实际执行者之三</p>
<p>ICommand，命令接口</p>
<p>CAddRequirementCommand，Execute函数，将调用CRequirementGroup的多个命令。来组合执行用户发出的命令。</p>
<p>CDeletePageCommand，同上</p>
<p>… … 其它命令。</p>
<p>说明：客户只需要知道向Invoker发出命令（多个命令），而不是将命令直接传达给具体的执行者。当然，客户是需要知道都有什么命令的。 </p>
<p>注意：客户只发命令，不需要知道由谁来执行和怎么执行，体现出高内聚的特点。用户在发出命令后，是允许撤回的，所以可以增加一个命令“Undo ”，Undo是状态的变更。</p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1573316999566.png?x-oss-process=image/resize,m_lfit,h_450" alt="旅行社项目开发过程类图"></p>
<p>Invoker.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ICommand.h"</span></span>
class CInvoker
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CInvoker</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CInvoker</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">SetCommand</span><span class="token punctuation">(</span>ICommand <span class="token operator">*</span>pcommand<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Action</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
private<span class="token punctuation">:</span>
    ICommand <span class="token operator">*</span>m_pCommand<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Invoker.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Invoker.h"</span></span>
CInvoker<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CInvoker</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
CInvoker<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CInvoker</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CInvoker<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">SetCommand</span><span class="token punctuation">(</span> ICommand <span class="token operator">*</span>pcommand <span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    this<span class="token operator">-></span>m_pCommand <span class="token operator">=</span> pcommand<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CInvoker<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Action</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    this<span class="token operator">-></span>m_pCommand<span class="token operator">-></span><span class="token function">Execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>IGroup.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
class IGroup
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">IGroup</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    virtual <span class="token operator">~</span><span class="token function">IGroup</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    virtual <span class="token keyword">void</span> <span class="token function">Find</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">Add</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">Delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">Change</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">Plan</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>RequirementGroup.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"igroup.h"</span></span>
class CRequirementGroup <span class="token punctuation">:</span>
    public IGroup
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CRequirementGroup</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CRequirementGroup</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Add</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Change</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Plan</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>RequirementGroup.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"RequirementGroup.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
CRequirementGroup<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CRequirementGroup</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
CRequirementGroup<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CRequirementGroup</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CRequirementGroup<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"找到需求组..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CRequirementGroup<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"客户要求增加一项需求..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CRequirementGroup<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"要求删除一项需求..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CRequirementGroup<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Change</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"客户要求修改一项需求..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CRequirementGroup<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Plan</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"客户要求需求变更计划..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>PageGroup.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"igroup.h"</span></span>
class CPageGroup <span class="token punctuation">:</span>
    public IGroup
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CPageGroup</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CPageGroup</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Add</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Change</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Plan</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>PageGroup.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"PageGroup.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
CPageGroup<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CPageGroup</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
CPageGroup<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CPageGroup</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CPageGroup<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"找到美工组..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CPageGroup<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"客户要求增加一个页面..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CPageGroup<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"客户要求删除一个页面..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CPageGroup<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Change</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"客户要求修改一个页面..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CPageGroup<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Plan</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"客户要求页面变更计划..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>CodeGroup.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"igroup.h"</span></span>
class CCodeGroup <span class="token punctuation">:</span>
    public IGroup
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CCodeGroup</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CCodeGroup</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Add</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Change</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Plan</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>CodeGroup.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"CodeGroup.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
CCodeGroup<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CCodeGroup</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
CCodeGroup<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CCodeGroup</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CCodeGroup<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"找到代码组..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CCodeGroup<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"客户要求增加一项功能..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CCodeGroup<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"客户要求删除一项功能..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CCodeGroup<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Change</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"客户要求修改一项功能..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CCodeGroup<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Plan</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"客户要求代码变更计划..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ICommand.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"RequirementGroup.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"PageGroup.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"CodeGroup.h"</span></span>
class ICommand
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">ICommand</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        m_prg <span class="token operator">=</span> new <span class="token function">CRequirementGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        m_ppg <span class="token operator">=</span> new <span class="token function">CPageGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        m_pcg <span class="token operator">=</span> new <span class="token function">CCodeGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    virtual <span class="token operator">~</span><span class="token function">ICommand</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        delete m_prg<span class="token punctuation">;</span>
        delete m_ppg<span class="token punctuation">;</span>
        delete m_pcg<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    virtual <span class="token keyword">void</span> <span class="token function">Execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
protected<span class="token punctuation">:</span>
    CRequirementGroup <span class="token operator">*</span>m_prg<span class="token punctuation">;</span>
    CPageGroup <span class="token operator">*</span>m_ppg<span class="token punctuation">;</span>
    CCodeGroup <span class="token operator">*</span>m_pcg<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>AddRequirementCommand.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"icommand.h"</span></span>
class CAddRequirementCommand <span class="token punctuation">:</span>
    public ICommand
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CAddRequirementCommand</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CAddRequirementCommand</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>AddRequirementCommand.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"AddRequirementCommand.h"</span></span>
CAddRequirementCommand<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CAddRequirementCommand</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
CAddRequirementCommand<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CAddRequirementCommand</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CAddRequirementCommand<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//执行增另一项需求的命令</span>
    this<span class="token operator">-></span>ICommand<span class="token punctuation">:</span><span class="token punctuation">:</span>m_prg<span class="token operator">-></span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">//增加一份需求</span>
    this<span class="token operator">-></span>ICommand<span class="token punctuation">:</span><span class="token punctuation">:</span>m_prg<span class="token operator">-></span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">//给出计划</span>
    this<span class="token operator">-></span>ICommand<span class="token punctuation">:</span><span class="token punctuation">:</span>m_prg<span class="token operator">-></span><span class="token function">Plan</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>DeletePageCommand.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"icommand.h"</span></span>
class CDeletePageCommand <span class="token punctuation">:</span>
    public ICommand
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CDeletePageCommand</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CDeletePageCommand</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>DeletePageCommand.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"DeletePageCommand.h"</span></span>
CDeletePageCommand<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CDeletePageCommand</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
CDeletePageCommand<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CDeletePageCommand</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CDeletePageCommand<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//执行增另一项需求的命令</span>
    this<span class="token operator">-></span>ICommand<span class="token punctuation">:</span><span class="token punctuation">:</span>m_ppg<span class="token operator">-></span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">//增加一份需求</span>
    this<span class="token operator">-></span>ICommand<span class="token punctuation">:</span><span class="token punctuation">:</span>m_ppg<span class="token operator">-></span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">//给出计划</span>
    this<span class="token operator">-></span>ICommand<span class="token punctuation">:</span><span class="token punctuation">:</span>m_ppg<span class="token operator">-></span><span class="token function">Plan</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Command.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"IGroup.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"CodeGroup.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"PageGroup.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"RequirementGroup.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Invoker.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"AddRequirementCommand.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"DeletePageCommand.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">DoIt</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"----------客户想增加一个需求----------"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    IGroup <span class="token operator">*</span>rg <span class="token operator">=</span> new <span class="token function">CRequirementGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    rg<span class="token operator">-></span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    rg<span class="token operator">-></span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    rg<span class="token operator">-></span><span class="token function">Plan</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    delete rg<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"----------客户又想修改一个页面----------"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    IGroup <span class="token operator">*</span>pg <span class="token operator">=</span> new <span class="token function">CPageGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pg<span class="token operator">-></span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pg<span class="token operator">-></span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pg<span class="token operator">-></span><span class="token function">Plan</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    delete pg<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"----------客户又想删除一个功能----------"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    IGroup <span class="token operator">*</span>cg <span class="token operator">=</span> new <span class="token function">CCodeGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cg<span class="token operator">-></span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cg<span class="token operator">-></span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cg<span class="token operator">-></span><span class="token function">Plan</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    delete cg<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">DoNew</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"----------客户觉得烦了，希望只找一个人，并告诉他要做什么----------"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"----------客户要求增加一项需求----------"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    CInvoker gary<span class="token punctuation">;</span>
    ICommand <span class="token operator">*</span>pcommand <span class="token operator">=</span> new <span class="token function">CAddRequirementCommand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    gary<span class="token punctuation">.</span><span class="token function">SetCommand</span><span class="token punctuation">(</span>pcommand<span class="token punctuation">)</span><span class="token punctuation">;</span>
    gary<span class="token punctuation">.</span><span class="token function">Action</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    delete pcommand<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">//客户想要改动只需要找CInvoker就可以了。</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"----------客户要求删除一个页面----------"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    CInvoker ricky<span class="token punctuation">;</span>
    ICommand <span class="token operator">*</span>pcommand2 <span class="token operator">=</span> new <span class="token function">CDeletePageCommand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ricky<span class="token punctuation">.</span><span class="token function">SetCommand</span><span class="token punctuation">(</span>pcommand2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ricky<span class="token punctuation">.</span><span class="token function">Action</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    delete pcommand2<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//客户原来的运行流程</span>
    <span class="token function">DoIt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">//客户觉得麻烦了，每次改动都要找不同的组，谈不同的事</span>
    <span class="token comment" spellcheck="true">//客户只想找一个人，告诉他要做什么就可以，不想关心由哪几个组来做和怎么做</span>
    <span class="token function">DoNew</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">_CrtSetDbgFlag</span><span class="token punctuation">(</span>_CRTDBG_LEAK_CHECK_DF <span class="token operator">|</span> _CRTDBG_ALLOC_MEM_DF<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">_CrtDumpMemoryLeaks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>----------客户想增加一个需求----------
找到需求组...
客户要求增加一项需求...
客户要求需求变更计划...
----------客户又想修改一个页面---------
找到美工组...
客户要求增加一个页面...
客户要求页面变更计划...
----------客户又想删除一个功能----------
找到代码组...
客户要求增加一项功能...
客户要求代码变更计划...
----------客户觉得烦了，希望只找一个人，并告诉他要做什么----------
----------客户要求增加一项需求----------
找到需求组...
客户要求增加一项需求...
客户要求需求变更计划...
----------客户要求删除一个页面----------
找到美工组...
客户要求删除一个页面...
客户要求页面变更计划...  </code></pre><h2 id="责任链模式"><a href="#责任链模式" class="headerlink" title="责任链模式"></a>责任链模式</h2><blockquote>
<p>Avoid coupling the sender of a request to its receiver by giving more than one object a chance to handle the request.Chain the receiving objects and pass the request along the chain until an object handles it.<br><br>使多个对象都有机会处理请求，从而避免了请求的发送者和接受者之间的耦合关系。将这些对象连成一条链，并沿着这条链传递该请求，直到有对象处理它为止。</p>
</blockquote>
<hr>

<p>main()，客户</p>
<p>IWomen，发出请求者接口</p>
<p>CWomen，请求者实现类</p>
<p>CHandler，处理请求抽象类</p>
<p>CFather，处理请求实现类，责任链之一</p>
<p>CHusband，处理请求实现类，责任链之二</p>
<p>CSon，处理请求实现类，责任链之三</p>
<p>说明：CHandler抽象类负责聚合责任链之中的其它处理对象，用SetNext来建立这个责任链。HandleMessage在处理请求时，会判断是否是自己要处理的请求，如果是则直接处理。如果不是，则查找下一个责任链上的处理对象，找到了则由下一个处理。</p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1573345715766.png?x-oss-process=image/resize,m_lfit,h_450" alt="妇女“三从”类图"></p>
<p>IWomen.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>
class IWomen
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">IWomen</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    virtual <span class="token operator">~</span><span class="token function">IWomen</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    virtual <span class="token keyword">int</span> <span class="token function">GetType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual string <span class="token function">GetRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>//Women.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"iwomen.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>
class CWomen <span class="token punctuation">:</span>
    public IWomen
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CWomen</span><span class="token punctuation">(</span><span class="token keyword">int</span> _type<span class="token punctuation">,</span> string _request<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CWomen</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> <span class="token function">GetType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    string <span class="token function">GetRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
private<span class="token punctuation">:</span>
    <span class="token keyword">int</span> m_type<span class="token punctuation">;</span>
    string m_request<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>//Women.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Women.h"</span></span>
CWomen<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CWomen</span><span class="token punctuation">(</span> <span class="token keyword">int</span> _type<span class="token punctuation">,</span> string _request <span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    this<span class="token operator">-></span>m_type <span class="token operator">=</span> _type<span class="token punctuation">;</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>this<span class="token operator">-></span>m_type<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token number">1</span><span class="token punctuation">:</span>
        this<span class="token operator">-></span>m_request<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"女儿的请求是："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        this<span class="token operator">-></span>m_request<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>_request<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">2</span><span class="token punctuation">:</span>
        this<span class="token operator">-></span>m_request<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"妻子的请求是："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        this<span class="token operator">-></span>m_request<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>_request<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">3</span><span class="token punctuation">:</span>
        this<span class="token operator">-></span>m_request<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"母亲的请求是："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        this<span class="token operator">-></span>m_request<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>_request<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
CWomen<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CWomen</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> CWomen<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetType</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> m_type<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
string CWomen<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> m_request<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Handler.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"IWomen.h"</span></span>
class CHandler
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CHandler</span><span class="token punctuation">(</span><span class="token keyword">int</span> _level<span class="token punctuation">)</span><span class="token punctuation">;</span>
    virtual <span class="token operator">~</span><span class="token function">CHandler</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">HandleMessage</span><span class="token punctuation">(</span>IWomen <span class="token operator">*</span>pwomen<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">SetNext</span><span class="token punctuation">(</span>CHandler <span class="token operator">*</span>phandler<span class="token punctuation">)</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">Response</span><span class="token punctuation">(</span>IWomen <span class="token operator">*</span>pwomen<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
private<span class="token punctuation">:</span>
    <span class="token keyword">int</span> m_level<span class="token punctuation">;</span>
    CHandler <span class="token operator">*</span>m_pNextHandler<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Handler.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Handler.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
CHandler<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CHandler</span><span class="token punctuation">(</span><span class="token keyword">int</span> _level <span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token function">m_level</span><span class="token punctuation">(</span>_level<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    m_pNextHandler <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
CHandler<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CHandler</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CHandler<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">HandleMessage</span><span class="token punctuation">(</span> IWomen <span class="token operator">*</span>pwomen <span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>pwomen<span class="token operator">-></span><span class="token function">GetType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> this<span class="token operator">-></span>m_level<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        this<span class="token operator">-></span><span class="token function">Response</span><span class="token punctuation">(</span>pwomen<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>this<span class="token operator">-></span>m_pNextHandler <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
            this<span class="token operator">-></span>m_pNextHandler<span class="token operator">-></span><span class="token function">HandleMessage</span><span class="token punctuation">(</span>pwomen<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span>
            cout <span class="token operator">&lt;&lt;</span> <span class="token string">"----------没地方请示了，不做处理！----------"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CHandler<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">SetNext</span><span class="token punctuation">(</span> CHandler <span class="token operator">*</span>phandler <span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    m_pNextHandler <span class="token operator">=</span> phandler<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Father.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"handler.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"IWomen.h"</span></span>
class CFather <span class="token punctuation">:</span>
    public CHandler
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CFather</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CFather</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Response</span><span class="token punctuation">(</span>IWomen <span class="token operator">*</span>pwomen<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Father.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Father.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
CFather<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CFather</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token function">CHandler</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
CFather<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CFather</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CFather<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Response</span><span class="token punctuation">(</span> IWomen <span class="token operator">*</span>pwomen <span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"女儿向父亲请示："</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> pwomen<span class="token operator">-></span><span class="token function">GetRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"父亲的答复是：同意"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Husband.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"handler.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"IWomen.h"</span></span>
class CHusband <span class="token punctuation">:</span>
    public CHandler
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CHusband</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CHusband</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Response</span><span class="token punctuation">(</span>IWomen <span class="token operator">*</span>pwomen<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Husband.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Husband.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
CHusband<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CHusband</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token function">CHandler</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
CHusband<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CHusband</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CHusband<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Response</span><span class="token punctuation">(</span> IWomen <span class="token operator">*</span>pwomen <span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"妻子向丈夫请示："</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> pwomen<span class="token operator">-></span><span class="token function">GetRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"丈夫的答复是：同意"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Son.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"handler.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"IWomen.h"</span></span>
class CSon <span class="token punctuation">:</span>
    public CHandler
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CSon</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CSon</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Response</span><span class="token punctuation">(</span>IWomen <span class="token operator">*</span>pwomen<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Son.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Son.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
CSon<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CSon</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token function">CHandler</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
CSon<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CSon</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CSon<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Response</span><span class="token punctuation">(</span> IWomen <span class="token operator">*</span>pwomen <span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"母亲向儿子请示："</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> pwomen<span class="token operator">-></span><span class="token function">GetRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"儿子的答复是：同意"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>// ChainofResponsibility.cpp </p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"IWomen.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Women.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Handler.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Father.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Husband.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Son.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">DoIt</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   <span class="token comment" spellcheck="true">//cout &lt;&lt; "----------原来的处理方式----------" &lt;&lt; endl;</span>
   INormalWomen<span class="token operator">*</span> pwomen <span class="token operator">=</span> new <span class="token function">CNormalWomen</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"我要出去逛街"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   INormalHandler<span class="token operator">*</span> pfather <span class="token operator">=</span> new <span class="token function">CNormalFather</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   INormalHandler<span class="token operator">*</span> phusband <span class="token operator">=</span> new <span class="token function">CNormalHusband</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   INormalHandler<span class="token operator">*</span> pson <span class="token operator">=</span> new <span class="token function">CNormalSon</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">If</span> <span class="token punctuation">(</span>pwomen<span class="token operator">-></span><span class="token function">GetType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
   <span class="token comment" spellcheck="true">//{</span>
   <span class="token comment" spellcheck="true">//   cout &lt;&lt; "女儿向父亲请示：" &lt;&lt; endl;</span>
   <span class="token comment" spellcheck="true">//   pfather->HandleMessage(pwomen);</span>
   <span class="token comment" spellcheck="true">//}</span>
   <span class="token comment" spellcheck="true">//else if (pwomen->GetType() == 2)</span>
   <span class="token comment" spellcheck="true">//{</span>
   <span class="token comment" spellcheck="true">//   cout &lt;&lt; "妻子向丈夫请示：" &lt;&lt; endl;</span>
   <span class="token comment" spellcheck="true">//   phusband->HandleMessage(pwomen);</span>
   <span class="token comment" spellcheck="true">//}</span>
   <span class="token comment" spellcheck="true">//else if (pwomen->GetType() == 3)</span>
   <span class="token comment" spellcheck="true">//{</span>
   <span class="token comment" spellcheck="true">//   cout &lt;&lt; "母亲向儿子请示：" &lt;&lt; endl;</span>
   <span class="token comment" spellcheck="true">//   pson->HandleMessage(pwomen);</span>
   <span class="token comment" spellcheck="true">//}</span>
   <span class="token comment" spellcheck="true">//else</span>
   <span class="token comment" spellcheck="true">//{</span>
   <span class="token comment" spellcheck="true">//   //什么也不做</span>
   <span class="token comment" spellcheck="true">//}</span>
   <span class="token comment" spellcheck="true">//delete pwomen;</span>
   <span class="token comment" spellcheck="true">//delete pfather;</span>
   <span class="token comment" spellcheck="true">//delete phusband;</span>
   <span class="token comment" spellcheck="true">//delete pson;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">DoNew</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   cout <span class="token operator">&lt;&lt;</span> <span class="token string">"----------使用模式后的处理方式----------"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
   Handler<span class="token punctuation">.</span>h<span class="token punctuation">,</span> Handler<span class="token punctuation">.</span>cpp<span class="token punctuation">,</span> IWomen<span class="token punctuation">.</span>h<span class="token punctuation">,</span> Women<span class="token punctuation">.</span>h<span class="token punctuation">,</span> Women<span class="token punctuation">.</span>cpp<span class="token punctuation">,</span> Father<span class="token punctuation">.</span>h<span class="token punctuation">,</span> Father<span class="token punctuation">,</span>cpp<span class="token punctuation">,</span> Husband<span class="token punctuation">.</span>h<span class="token punctuation">,</span> Husband<span class="token punctuation">.</span>cpp<span class="token punctuation">,</span> Son<span class="token punctuation">.</span>h<span class="token punctuation">,</span> Son<span class="token punctuation">.</span>cpp
   IWomen<span class="token operator">*</span> pwomen1 <span class="token operator">=</span> new <span class="token function">CWomen</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"我要出去逛街"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   IWomen<span class="token operator">*</span> pwomen2 <span class="token operator">=</span> new <span class="token function">CWomen</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"我要出去吃饭"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   IWomen<span class="token operator">*</span> pwomen3 <span class="token operator">=</span> new <span class="token function">CWomen</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">"我也要出去吃饭"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   IWomen<span class="token operator">*</span> pwomen4 <span class="token operator">=</span> new <span class="token function">CWomen</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">"我也要出去逛街"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   CHandler<span class="token operator">*</span> pfather <span class="token operator">=</span> new <span class="token function">CFather</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   CHandler<span class="token operator">*</span> phusband <span class="token operator">=</span> new <span class="token function">CHusband</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   CHandler<span class="token operator">*</span> pson <span class="token operator">=</span> new <span class="token function">CSon</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   pfather<span class="token operator">-></span><span class="token function">SetNext</span><span class="token punctuation">(</span>phusband<span class="token punctuation">)</span><span class="token punctuation">;</span>
   phusband<span class="token operator">-></span><span class="token function">SetNext</span><span class="token punctuation">(</span>pson<span class="token punctuation">)</span><span class="token punctuation">;</span>

   pfather<span class="token operator">-></span><span class="token function">HandleMessage</span><span class="token punctuation">(</span>pwomen1<span class="token punctuation">)</span><span class="token punctuation">;</span>
   pfather<span class="token operator">-></span><span class="token function">HandleMessage</span><span class="token punctuation">(</span>pwomen2<span class="token punctuation">)</span><span class="token punctuation">;</span>
   pfather<span class="token operator">-></span><span class="token function">HandleMessage</span><span class="token punctuation">(</span>pwomen3<span class="token punctuation">)</span><span class="token punctuation">;</span>
   pfather<span class="token operator">-></span><span class="token function">HandleMessage</span><span class="token punctuation">(</span>pwomen4<span class="token punctuation">)</span><span class="token punctuation">;</span>

   delete pfather<span class="token punctuation">;</span>
   delete phusband<span class="token punctuation">;</span>
   delete pson<span class="token punctuation">;</span>
   delete pwomen1<span class="token punctuation">;</span>
   delete pwomen2<span class="token punctuation">;</span>
   delete pwomen3<span class="token punctuation">;</span>
   delete pwomen4<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   <span class="token comment" spellcheck="true">//反面</span>
   <span class="token function">DoIt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token comment" spellcheck="true">//要实现逻辑判断，即女性的请求先发送到父亲类，父亲类一看是自己要处理的，就回应进行处理。如果女儿已经出嫁了，那就把这个请求转发到女婿类来处理。依此类推，形成了一个责任链。</span>
   <span class="token function">DoNew</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>----------使用模式后的处理方式----------
女儿向父亲请示：
女儿的请求是：我要出去逛街
父亲的答复是：同意
妻子向丈夫请示：
妻子的请求是：我要出去吃饭
丈夫的答复是：同意
母亲向儿子请示：
母亲的请求是：我也要出去吃饭
儿子的答复是：同意
----------没地方请示了，不做处理！----------    </code></pre><h2 id="装饰模式"><a href="#装饰模式" class="headerlink" title="装饰模式"></a>装饰模式</h2><blockquote>
<p>Attach additional responsibilities to an object dynamically keeping the same interface.Decorators provide a flexible alternative to subclassing for extending functionality.<br><br>动态地给一个对象添加一些额外的职责。就增加功能来说，装饰模式相比生成子类更为灵活。</p>
</blockquote>
<hr>

<p>main()，老爸</p>
<p>ISchoolReport，成绩单接口</p>
<p>CFourthGradeSchoolReport，四年级成绩单</p>
<p>ReportDecorator，成绩单装饰器基类</p>
<p>HighScoreDecorator，最高分装饰器</p>
<p>SortDecorator，班级排名装饰器</p>
<p>说明：对“四年级成绩单”进行装饰，ReportDecorator必然有一个private变量指向ISchoolReport。</p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1573318043354.png?x-oss-process=image/resize,m_lfit,h_450" alt="成绩单类图"></p>
<p>// Decorator.cpp<br>//主程序</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ISchoolReport.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"FouthGradeSchoolReport.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"FouthGradeSchoolReport.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"HighScoreDecorator.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"SortDecorator.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">DoIt</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   ISchoolReport<span class="token operator">*</span> psr <span class="token operator">=</span> new <span class="token function">CFouthGradeSchoolReport</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   psr<span class="token operator">-></span><span class="token function">Report</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//看成绩单</span>
   psr<span class="token operator">-></span><span class="token function">Sign</span><span class="token punctuation">(</span><span class="token string">"老三"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//很开心，就签字了</span>
   delete psr<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">DoNew</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   cout <span class="token operator">&lt;&lt;</span> <span class="token string">"----------分部分进行装饰----------"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
   ISchoolReport<span class="token operator">*</span> psr <span class="token operator">=</span> new <span class="token function">CFouthGradeSchoolReport</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//原装成绩单</span>
   <span class="token comment" spellcheck="true">//</span>
   ISchoolReport<span class="token operator">*</span> pssr <span class="token operator">=</span> new <span class="token function">CSortDecorator</span><span class="token punctuation">(</span>psr<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//又加了成绩排名的说明</span>
   ISchoolReport<span class="token operator">*</span> phsr <span class="token operator">=</span> new <span class="token function">CHighScoreDecorator</span><span class="token punctuation">(</span>pssr<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//加了最高分说明的成绩单</span>
   phsr<span class="token operator">-></span><span class="token function">Report</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//看成绩单</span>
   phsr<span class="token operator">-></span><span class="token function">Sign</span><span class="token punctuation">(</span><span class="token string">"老三"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//很开心，就签字了</span>

   <span class="token comment" spellcheck="true">//先装饰哪个不重要，顺序已经在装饰内部确定好，但一定要调用最后一个装饰器的接口。</span>
   ISchoolReport <span class="token operator">*</span>phsr <span class="token operator">=</span> new <span class="token function">CHighScoreDecorator</span><span class="token punctuation">(</span>psr<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//加了最高分说明的成绩单</span>
   ISchoolReport <span class="token operator">*</span>pssr <span class="token operator">=</span> new <span class="token function">CSortDecorator</span><span class="token punctuation">(</span>phsr<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//又加了成绩排名的说明</span>
   <span class="token comment" spellcheck="true">//pssr->Report();//看成绩单</span>
   <span class="token comment" spellcheck="true">//pssr->Sign("老三");//很开心，就签字了</span>

   delete pssr<span class="token punctuation">;</span>
   delete phsr<span class="token punctuation">;</span>
   delete psr<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   <span class="token comment" spellcheck="true">//在装饰之前，可以用继承的办法，来进行简单的修饰</span>
   <span class="token function">DoIt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token comment" spellcheck="true">//但如果需要修饰的项目太多呢？或者装饰的项目不是固定的，继承显然会变得更复杂</span>
   <span class="token function">DoNew</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token function">_CrtSetDbgFlag</span><span class="token punctuation">(</span>_CRTDBG_LEAK_CHECK_DF <span class="token operator">|</span> _CRTDBG_ALLOC_MEM_DF<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">_CrtDumpMemoryLeaks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ISchoolReport.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>
class ISchoolReport
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">ISchoolReport</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    virtual <span class="token operator">~</span><span class="token function">ISchoolReport</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    virtual <span class="token keyword">void</span> <span class="token function">Report</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">Sign</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>FouthGradeSchoolReport.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ischoolreport.h"</span></span>
class CFouthGradeSchoolReport <span class="token punctuation">:</span>
    public ISchoolReport
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CFouthGradeSchoolReport</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CFouthGradeSchoolReport</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Report</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Sign</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>FouthGradeSchoolReport.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"FouthGradeSchoolReport.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>
CFouthGradeSchoolReport<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CFouthGradeSchoolReport</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
CFouthGradeSchoolReport<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CFouthGradeSchoolReport</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CFouthGradeSchoolReport<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Report</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"尊敬的XXX家长："</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"......"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"语文62  数学65  体育98  自然63"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"......"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"                家长签名："</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CFouthGradeSchoolReport<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Sign</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"家长签名为："</span> <span class="token operator">&lt;&lt;</span> name<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ReportDecorator.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ischoolreport.h"</span></span>
class CReportDecorator <span class="token punctuation">:</span>
    public ISchoolReport
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CReportDecorator</span><span class="token punctuation">(</span>ISchoolReport <span class="token operator">*</span>psr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    virtual <span class="token operator">~</span><span class="token function">CReportDecorator</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Report</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Sign</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span><span class="token punctuation">;</span>
private<span class="token punctuation">:</span>
    ISchoolReport <span class="token operator">*</span>m_pSchoolReport<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ReportDecorator.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ReportDecorator.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>
CReportDecorator<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CReportDecorator</span><span class="token punctuation">(</span>ISchoolReport <span class="token operator">*</span>psr<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    this<span class="token operator">-></span>m_pSchoolReport <span class="token operator">=</span> psr<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
CReportDecorator<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CReportDecorator</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CReportDecorator<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Report</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    this<span class="token operator">-></span>m_pSchoolReport<span class="token operator">-></span><span class="token function">Report</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CReportDecorator<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Sign</span><span class="token punctuation">(</span> string name <span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    this<span class="token operator">-></span>m_pSchoolReport<span class="token operator">-></span><span class="token function">Sign</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>HighScoreDecorator.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"reportdecorator.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ISchoolReport.h"</span></span>
class CHighScoreDecorator <span class="token punctuation">:</span>
    public CReportDecorator
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CHighScoreDecorator</span><span class="token punctuation">(</span>ISchoolReport <span class="token operator">*</span>psr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CHighScoreDecorator</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Report</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
private<span class="token punctuation">:</span>
    <span class="token keyword">void</span> <span class="token function">ReportHighScore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>HighScoreDecorator.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"HighScoreDecorator.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
CHighScoreDecorator<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CHighScoreDecorator</span><span class="token punctuation">(</span> ISchoolReport <span class="token operator">*</span>psr <span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token function">CReportDecorator</span><span class="token punctuation">(</span>psr<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
CHighScoreDecorator<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CHighScoreDecorator</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CHighScoreDecorator<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Report</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    this<span class="token operator">-></span><span class="token function">ReportHighScore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    this<span class="token operator">-></span>CReportDecorator<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Report</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CHighScoreDecorator<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">ReportHighScore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"这次考试语文最高是75， 数学是78， 自然是80"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>SortDecorator.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"reportdecorator.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ISchoolReport.h"</span></span>
class CSortDecorator <span class="token punctuation">:</span>
    public CReportDecorator
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CSortDecorator</span><span class="token punctuation">(</span>ISchoolReport <span class="token operator">*</span>psr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CSortDecorator</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Report</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
private<span class="token punctuation">:</span>
    <span class="token keyword">void</span> <span class="token function">ReportSort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>SortDecorator.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"SortDecorator.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
CSortDecorator<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CSortDecorator</span><span class="token punctuation">(</span> ISchoolReport <span class="token operator">*</span>psr <span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token function">CReportDecorator</span><span class="token punctuation">(</span>psr<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
CSortDecorator<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CSortDecorator</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CSortDecorator<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">ReportSort</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"我是排名第38名..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CSortDecorator<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Report</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    this<span class="token operator">-></span>CReportDecorator<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Report</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    this<span class="token operator">-></span><span class="token function">ReportSort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>尊敬的XXX家长：
......
语文62  数学65  体育98  自然63
......
家长签名：
家长签名为：老三
----------分部分进行装饰----------
这次考试语文最高是75， 数学是78， 自然是80
尊敬的XXX家长：
......
语文62  数学65  体育98  自然63
......
家长签名：
我是排名第38名...
家长签名为：老三   </code></pre><h2 id="策略模式"><a href="#策略模式" class="headerlink" title="策略模式"></a>策略模式</h2><blockquote>
<p>Define a family of algorithms,encapsulate each one,and make them interchangeable.<br><br>定义一组算法，将每个算法都封装起来，并且使它们之间可以互换。</p>
</blockquote>
<p>这个定义是非常明确、清晰的，“定义一组算法”，看看我们的三个计谋是不是三个算法？“将每个算法都封装起来”，封装类Context不就是这个作用吗？“使它们可以互换”当然可以互换了，都实现是相同的接口，那当然可以相互转化了。</p>
<hr>

<p>main()，赵云</p>
<p>CContext，锦囊</p>
<p>IStrategy，策略接口</p>
<p>CBackDoor，策略之一</p>
<p>CGivenGreenLight，策略之二</p>
<p>CBlockEnemy，策略之三</p>
<p>说明：一个策略放到一个锦囊里。当用的时候，找到这个锦囊，从锦囊里拿出策略来使用。</p>
<p>注意：锦囊只是简单的装载和调用策略，锦囊里没有逻辑。策略会有更大的自主权，运行更多的逻辑。<br>注意：没有<code>#include &quot;IStrategy.h&quot;</code>可以自建一个IStrategy.h，包含<code>#include &quot;stdio.h</code>即可。</p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1573288235394.png?x-oss-process=image/resize,m_lfit,h_450" alt="策略模式"></p>
<p>IStrategy.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>

class IStrategy
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">IStrategy</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    virtual <span class="token operator">~</span><span class="token function">IStrategy</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">Operate</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Context.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"IStrategy.h"</span></span>
class CContext
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CContext</span><span class="token punctuation">(</span>IStrategy <span class="token operator">*</span>pStrategy<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CContext</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Operate</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
private<span class="token punctuation">:</span>
    IStrategy <span class="token operator">*</span>m_pStrategy<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Context.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Context.h"</span></span>
CContext<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CContext</span><span class="token punctuation">(</span>IStrategy <span class="token operator">*</span>pStrategy<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    this<span class="token operator">-></span>m_pStrategy <span class="token operator">=</span> pStrategy<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
CContext<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CContext</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    delete this<span class="token operator">-></span>m_pStrategy<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CContext<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Operate</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    this<span class="token operator">-></span>m_pStrategy<span class="token operator">-></span><span class="token function">Operate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>BackDoor.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"istrategy.h"</span></span>
class CBackDoor <span class="token punctuation">:</span>
    public IStrategy
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CBackDoor</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CBackDoor</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Operate</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>BackDoor.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"BackDoor.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
CBackDoor<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CBackDoor</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
CBackDoor<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CBackDoor</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CBackDoor<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Operate</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"找乔国老帮忙，让吴国太给孙权施加压力"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>GivenGreenLight.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"istrategy.h"</span></span>
class CGivenGreenLight <span class="token punctuation">:</span>
    public IStrategy
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CGivenGreenLight</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CGivenGreenLight</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Operate</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>GivenGreenList.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"GivenGreenLight.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
CGivenGreenLight<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CGivenGreenLight</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
CGivenGreenLight<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CGivenGreenLight</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CGivenGreenLight<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Operate</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"求吴国太开个绿灯，放行！"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>BlockEnemy.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"istrategy.h"</span></span>
class CBlockEnemy <span class="token punctuation">:</span>
    public IStrategy
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CBlockEnemy</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CBlockEnemy</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Operate</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>BlockEnemy.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"BlockEnemy.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
CBlockEnemy<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CBlockEnemy</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
CBlockEnemy<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CBlockEnemy</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CBlockEnemy<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Operate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"孙夫人断后，挡住追兵"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Strategy.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Context.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"BackDoor.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"GivenGreenLight.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"BlockEnemy.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    CContext <span class="token operator">*</span>pContext<span class="token punctuation">;</span>

    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"\14\n\n\n\n\17"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"----------刚刚到吴国的时候拆第一个----------"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    pContext <span class="token operator">=</span> new <span class="token function">CContext</span><span class="token punctuation">(</span>new <span class="token function">CBackDoor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pContext<span class="token operator">-></span><span class="token function">Operate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    delete pContext<span class="token punctuation">;</span>

    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"\14\n\n\n\n\17"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"----------刘备乐不思蜀了，拆第二个了----------"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    pContext <span class="token operator">=</span> new <span class="token function">CContext</span><span class="token punctuation">(</span>new <span class="token function">CGivenGreenLight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pContext<span class="token operator">-></span><span class="token function">Operate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    delete pContext<span class="token punctuation">;</span>

    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"\14\n\n\n\n\17"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"----------孙权的小兵追了，咋办？拆第三个----------"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    pContext <span class="token operator">=</span> new <span class="token function">CContext</span><span class="token punctuation">(</span>new <span class="token function">CBlockEnemy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pContext<span class="token operator">-></span><span class="token function">Operate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    delete pContext<span class="token punctuation">;</span>

    <span class="token function">_CrtSetDbgFlag</span><span class="token punctuation">(</span>_CRTDBG_LEAK_CHECK_DF <span class="token operator">|</span> _CRTDBG_ALLOC_MEM_DF<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">_CrtDumpMemoryLeaks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>                
----------刚刚到吴国的时候拆第一个---------- 
找乔国老帮忙，让吴国太给孙权施加压力 
       
----------刘备乐不思蜀了，拆第二个了----------
求吴国太开个绿灯，放行！ 
                  
----------孙权的小兵追了，咋办？拆第三个---------- 
孙夫人断后，挡住追兵</code></pre><h2 id="适配器模式"><a href="#适配器模式" class="headerlink" title="适配器模式"></a>适配器模式</h2><blockquote>
<p>Convert the interface of a class into another interface clients expect.Adapter lets classes work together that couldn’t otherwise because of incompatible interfaces.<br><br>将一个类的接口变换成客户端所期待的另一种接口，从而使原本因接口不匹配而无法在一起工作的两个类能够在一起工作。</p>
</blockquote>
<p>适配器相当于转换接头，如投影仪的接口是DB9，电脑的接口是HDMI，因此使用DB9转HDMI转换器就可以使投影仪和电脑一起工作了！<br>适配器起到了解析作用，将一种形式的数据结构解析为另一种形式的数据结构。</p>
<hr>

<p>main()，主程序</p>
<p>IUserInfo，本系统内接口</p>
<p>CUserInfo，本系统内实现类</p>
<p>IOuterUser，外系统接口</p>
<p>COuterUser，外系统实现类</p>
<p>COuterUserInfo，本系统内适配类</p>
<p>说明：COuterUserInfo实现IUserInfo接口，将外部系统实现类COuterUser转换成本系统内的接口IUserInfo。使用外部数据跟使用本系统内部数据一样。</p>
<p>注意：COuterUserInfo继承了IUserInfo，如果同时继承了COuterUser则是类适配器。如果COuterUserInfo只是使用了COuterUser则是对象适配器。</p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1573304754219.png?x-oss-process=image/resize,m_lfit,h_450" alt="外调人员中转处理"></p>
<p>IUserInfo.h<br>//系统内部的实体接口</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>
class IUserInfo
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
   <span class="token function">IUserInfo</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
   <span class="token punctuation">}</span>
   virtual <span class="token operator">~</span><span class="token function">IUserInfo</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
   <span class="token punctuation">}</span>
   virtual string <span class="token function">GetUserName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
   virtual string <span class="token function">GetHomeAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
   virtual string <span class="token function">GetMobileNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
   virtual string <span class="token function">GetOfficeTelNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
   virtual string <span class="token function">GetJobPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
   virtual string <span class="token function">GetHomeTelNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>UserInfo.h<br>//系统内部实体类</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"iuserinfo.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>
class CUserInfo <span class="token punctuation">:</span>
   public IUserInfo
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
   <span class="token function">CUserInfo</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token operator">~</span><span class="token function">CUserInfo</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   string <span class="token function">GetUserName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   string <span class="token function">GetHomeAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   string <span class="token function">GetMobileNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   string <span class="token function">GetOfficeTelNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   string <span class="token function">GetJobPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   string <span class="token function">GetHomeTelNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>UserInfo.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"UserInfo.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>
CUserInfo<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CUserInfo</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
CUserInfo<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CUserInfo</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
string CUserInfo<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetUserName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   cout <span class="token operator">&lt;&lt;</span> <span class="token string">"姓名叫做..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
   <span class="token keyword">return</span> <span class="token string">"0"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
string CUserInfo<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetHomeAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   cout <span class="token operator">&lt;&lt;</span> <span class="token string">"这里是员工的家庭地址..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
   <span class="token keyword">return</span> <span class="token string">"0"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
string CUserInfo<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetMobileNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   cout <span class="token operator">&lt;&lt;</span> <span class="token string">"这个人的手机号码是0000..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
   <span class="token keyword">return</span> <span class="token string">"0"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
string CUserInfo<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetOfficeTelNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   cout <span class="token operator">&lt;&lt;</span> <span class="token string">"办公室电话是..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
   <span class="token keyword">return</span> <span class="token string">"0"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
string CUserInfo<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetJobPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   cout <span class="token operator">&lt;&lt;</span> <span class="token string">"这个人的职位是BOSS..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
   <span class="token keyword">return</span> <span class="token string">"0"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
string CUserInfo<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetHomeTelNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   cout <span class="token operator">&lt;&lt;</span> <span class="token string">"员工的家庭电话是..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
   <span class="token keyword">return</span> <span class="token string">"0"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>IOuterUser.h<br>//外部系统实体接口</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"OuterUserBaseInfo.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"OuterUserHomeInfo.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"OuterUserOfficeInfo.h"</span></span>
class IOuterUser
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
   <span class="token function">IOuterUser</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
   <span class="token punctuation">}</span>
   <span class="token operator">~</span><span class="token function">IOuterUser</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
   <span class="token punctuation">}</span>
   COuterUserBaseInfo<span class="token operator">*</span> <span class="token function">GetUserBaseInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   COuterUserHomeInfo<span class="token operator">*</span> <span class="token function">GetUserHomeInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   COuterUserOfficeInfo<span class="token operator">*</span> <span class="token function">GetUserOfficeInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>COuterUser.h<br>//外部系统实体类</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"OuterUserBaseInfo.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"OuterUserHomeInfo.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"OuterUserOfficeInfo.h"</span></span>
class COuterUser
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
   <span class="token function">COuterUser</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token operator">~</span><span class="token function">COuterUser</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   COuterUserBaseInfo<span class="token operator">*</span> <span class="token function">GetUserBaseInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   COuterUserHomeInfo<span class="token operator">*</span> <span class="token function">GetUserHomeInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   COuterUserOfficeInfo<span class="token operator">*</span> <span class="token function">GetUserOfficeInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>COuterUser.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"COuterUser.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"OuterUserBaseInfo.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"OuterUserHomeInfo.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"OuterUserOfficeInfo.h"</span></span>
COuterUser<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">COuterUser</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
COuterUser<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">COuterUser</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
COuterUserBaseInfo<span class="token operator">*</span> COuterUser<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetUserBaseInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   <span class="token keyword">return</span> new <span class="token function">COuterUserBaseInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
COuterUserHomeInfo<span class="token operator">*</span> COuterUser<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetUserHomeInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   <span class="token keyword">return</span> new <span class="token function">COuterUserHomeInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
COuterUserOfficeInfo<span class="token operator">*</span> COuterUser<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetUserOfficeInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   <span class="token keyword">return</span> new <span class="token function">COuterUserOfficeInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>OuterUserBaseInfo.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>
class COuterUserBaseInfo
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
   <span class="token function">COuterUserBaseInfo</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
   <span class="token punctuation">}</span>
   <span class="token operator">~</span><span class="token function">COuterUserBaseInfo</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
   <span class="token punctuation">}</span>
   string <span class="token function">GetUserName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
      cout <span class="token operator">&lt;&lt;</span> <span class="token string">"姓名叫做..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token string">"0"</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   string <span class="token function">GetMobileNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
      cout <span class="token operator">&lt;&lt;</span> <span class="token string">"这个人的手机号码是0001..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token string">"0"</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>OuterUserHomeInfo.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>
class COuterUserHomeInfo
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
   <span class="token function">COuterUserHomeInfo</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
   <span class="token punctuation">}</span>
   <span class="token operator">~</span><span class="token function">COuterUserHomeInfo</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
   <span class="token punctuation">}</span>
   string <span class="token function">GetHomeAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
      cout <span class="token operator">&lt;&lt;</span> <span class="token string">"这里是员工的家庭地址..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token string">"0"</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   string <span class="token function">GetHomeTelNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
      cout <span class="token operator">&lt;&lt;</span> <span class="token string">"员工的家庭电话是..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token string">"0"</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>OuterUserOfficeInfo.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>
class COuterUserOfficeInfo
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
   <span class="token function">COuterUserOfficeInfo</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
   <span class="token punctuation">}</span>
   <span class="token operator">~</span><span class="token function">COuterUserOfficeInfo</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
   <span class="token punctuation">}</span>
   string <span class="token function">GetOfficeTelNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
      cout <span class="token operator">&lt;&lt;</span> <span class="token string">"办公室电话是..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token string">"0"</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   string <span class="token function">GetJobPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
      cout <span class="token operator">&lt;&lt;</span> <span class="token string">"这个人的职位是BOSS..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token string">"0"</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>OuterUserInfo.h<br>//由IUserInfo接口派生的实体类，并引入外部系统实体的实例</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"iuserinfo.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"COuterUser.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>
class COuterUserInfo <span class="token punctuation">:</span>
    public IUserInfo
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">COuterUserInfo</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">COuterUserInfo</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    string <span class="token function">GetUserName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    string <span class="token function">GetHomeAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    string <span class="token function">GetMobileNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    string <span class="token function">GetOfficeTelNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    string <span class="token function">GetJobPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    string <span class="token function">GetHomeTelNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
private<span class="token punctuation">:</span>
    COuterUser <span class="token operator">*</span>m_pOuterUser<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>OuterUserInfo.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"OuterUserInfo.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"OuterUserBaseInfo.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"OuterUserHomeInfo.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"OuterUserOfficeInfo.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>
COuterUserInfo<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">COuterUserInfo</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   m_pOuterUser <span class="token operator">=</span> new <span class="token function">COuterUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
COuterUserInfo<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">COuterUserInfo</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   delete m_pOuterUser<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
string COuterUserInfo<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetUserName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   COuterUserBaseInfo<span class="token operator">*</span> pBaseInfo <span class="token operator">=</span> m_pOuterUser<span class="token operator">-></span><span class="token function">GetUserBaseInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   pBaseInfo<span class="token operator">-></span><span class="token function">GetUserName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   delete pBaseInfo<span class="token punctuation">;</span>
   pBaseInfo <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> <span class="token string">"0"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
string COuterUserInfo<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetHomeAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   COuterUserHomeInfo<span class="token operator">*</span> pHomeInfo <span class="token operator">=</span> m_pOuterUser<span class="token operator">-></span><span class="token function">GetUserHomeInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   pHomeInfo<span class="token operator">-></span><span class="token function">GetHomeAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   delete pHomeInfo<span class="token punctuation">;</span>
   pHomeInfo <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> <span class="token string">"0"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
string COuterUserInfo<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetMobileNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   COuterUserBaseInfo<span class="token operator">*</span> pBaseInfo <span class="token operator">=</span> m_pOuterUser<span class="token operator">-></span><span class="token function">GetUserBaseInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   pBaseInfo<span class="token operator">-></span><span class="token function">GetMobileNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   delete pBaseInfo<span class="token punctuation">;</span>
   pBaseInfo <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> <span class="token string">"0"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
string COuterUserInfo<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetOfficeTelNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   COuterUserOfficeInfo<span class="token operator">*</span> pOfficeInfo <span class="token operator">=</span> m_pOuterUser<span class="token operator">-></span><span class="token function">GetUserOfficeInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   pOfficeInfo<span class="token operator">-></span><span class="token function">GetOfficeTelNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   delete pOfficeInfo<span class="token punctuation">;</span>
   pOfficeInfo <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> <span class="token string">"0"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
string COuterUserInfo<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetJobPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   COuterUserOfficeInfo<span class="token operator">*</span> pOfficeInfo <span class="token operator">=</span> m_pOuterUser<span class="token operator">-></span><span class="token function">GetUserOfficeInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   pOfficeInfo<span class="token operator">-></span><span class="token function">GetJobPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   delete pOfficeInfo<span class="token punctuation">;</span>
   pOfficeInfo <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> <span class="token string">"0"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
string COuterUserInfo<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetHomeTelNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   COuterUserHomeInfo<span class="token operator">*</span> pHomeInfo <span class="token operator">=</span> m_pOuterUser<span class="token operator">-></span><span class="token function">GetUserHomeInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   pHomeInfo<span class="token operator">-></span><span class="token function">GetHomeTelNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   delete pHomeInfo<span class="token punctuation">;</span>
   pHomeInfo <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> <span class="token string">"0"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Adapter.cpp<br>//使用方法</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"IOuterUser.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"IUserInfo.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"UserInfo.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"OuterUserInfo.h"</span></span>
<span class="token keyword">void</span> <span class="token function">DoIt</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   IUserInfo<span class="token operator">*</span> pYourGirl <span class="token operator">=</span> new <span class="token function">CUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">101</span><span class="token punctuation">;</span> i <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
      pYourGirl<span class="token operator">-></span><span class="token function">GetMobileNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   delete pYourGirl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">NowDoIt</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   IUserInfo<span class="token operator">*</span> pYourGirl <span class="token operator">=</span> new <span class="token function">COuterUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">101</span><span class="token punctuation">;</span> i <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
      pYourGirl<span class="token operator">-></span><span class="token function">GetMobileNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   delete pYourGirl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   <span class="token function">DoIt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token function">NowDoIt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>这个人的手机号码是0000...
这个人的手机号码是0000...
这个人的手机号码是0000...
这个人的手机号码是0000...
这个人的手机号码是0000...
这个人的手机号码是0000...
这个人的手机号码是0001...
这个人的手机号码是0001...
这个人的手机号码是0001...
这个人的手机号码是0001...
这个人的手机号码是0001...
这个人的手机号码是0001... </code></pre><h2 id="迭代器模式"><a href="#迭代器模式" class="headerlink" title="迭代器模式"></a>迭代器模式</h2><blockquote>
<p>Provide a way to access the elements of an aggregate object sequentially without exposing its underlying representation.<br><br>它提供一种方法访问一个容器对象中各个元素，而又不需暴露该对象的内部细节。</p>
</blockquote>
<hr>

<p>main()，客户</p>
<p>IProject，产品接口</p>
<p>CProject，产品类</p>
<p>IIterator，迭代器接口</p>
<p>IProjectIterator，产品迭代器接口</p>
<p>CProjectIterator，产品迭代器实现类</p>
<p>说明：CProject实现产品类，能够返回一个迭代器的指针。这个迭代器将封装产品类里的一个数组。所以迭代器在运行Next函数时，可以遍历这个数组的所有元素。</p>
<p>简单来说，就是用代码实现vector<int>::iterator或vector<int>::const_iterator。<br><strong>注意：</strong><br>如果你是做Java开发，尽量不要自己写迭代器模式！省省吧，使用Java提供的Iterator一般就能满足你的要求了!</int></int></p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1573319086122.png?x-oss-process=image/resize,m_lfit,h_450" alt="项目信息类图"></p>
<p>IProject.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"IProjectIterator.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>
class IProject
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">IProject</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    virtual <span class="token operator">~</span><span class="token function">IProject</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    virtual <span class="token keyword">void</span> <span class="token function">Add</span><span class="token punctuation">(</span>string name<span class="token punctuation">,</span> <span class="token keyword">int</span> num<span class="token punctuation">,</span> <span class="token keyword">int</span> cost<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual string <span class="token function">GetProjectInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual IProjectIterator<span class="token operator">*</span> <span class="token function">GetIterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">Erase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Project.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"iproject.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"IProjectIterator.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>vector<span class="token punctuation">;</span>
class CProject <span class="token punctuation">:</span>
    public IProject
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CProject</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">CProject</span><span class="token punctuation">(</span>string name<span class="token punctuation">,</span> <span class="token keyword">int</span> num<span class="token punctuation">,</span> <span class="token keyword">int</span> cost<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CProject</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    string <span class="token function">GetProjectInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Add</span><span class="token punctuation">(</span>string name<span class="token punctuation">,</span> <span class="token keyword">int</span> num<span class="token punctuation">,</span> <span class="token keyword">int</span> cost<span class="token punctuation">)</span><span class="token punctuation">;</span>
    IProjectIterator <span class="token operator">*</span> <span class="token function">GetIterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Erase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
private<span class="token punctuation">:</span>
    string m_name<span class="token punctuation">;</span>
    <span class="token keyword">int</span> m_num<span class="token punctuation">;</span>
    <span class="token keyword">int</span> m_cost<span class="token punctuation">;</span>
    vector<span class="token operator">&lt;</span>IProject<span class="token operator">*</span><span class="token operator">></span> m_projectList<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Project.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Project.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ProjectIterator.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;sstream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>vector<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>ostringstream<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>to_string<span class="token punctuation">;</span>
CProject<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CProject</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   m_name <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
   m_num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
   m_cost <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
CProject<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CProject</span><span class="token punctuation">(</span>string name<span class="token punctuation">,</span> <span class="token keyword">int</span> num<span class="token punctuation">,</span> <span class="token keyword">int</span> cost<span class="token punctuation">)</span> <span class="token punctuation">:</span><span class="token function">m_name</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_num</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_cost</span><span class="token punctuation">(</span>cost<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
CProject<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CProject</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
string CProject<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetProjectInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   string info <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
   info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"项目名称是："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>this<span class="token operator">-></span>m_name<span class="token punctuation">)</span><span class="token punctuation">;</span>
   info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"\t项目人数："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token function">to_string</span><span class="token punctuation">(</span>m_num<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"\t项目费用："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token function">to_string</span><span class="token punctuation">(</span>m_cost<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> info<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CProject<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Add</span><span class="token punctuation">(</span>string name<span class="token punctuation">,</span> <span class="token keyword">int</span> num<span class="token punctuation">,</span> <span class="token keyword">int</span> cost<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   this<span class="token operator">-></span>m_projectList<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>new <span class="token function">CProject</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> num<span class="token punctuation">,</span> cost<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
IProjectIterator<span class="token operator">*</span> CProject<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetIterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   <span class="token keyword">return</span> new <span class="token function">CProjectIterator</span><span class="token punctuation">(</span>this<span class="token operator">-></span>m_projectList<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CProject<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Erase</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   vector<span class="token operator">&lt;</span>IProject<span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">:</span><span class="token punctuation">:</span>reverse_iterator projectDelIt <span class="token operator">=</span> m_projectList<span class="token punctuation">.</span><span class="token function">rbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> projectDelIt <span class="token operator">!=</span> m_projectList<span class="token punctuation">.</span><span class="token function">rend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> projectDelIt<span class="token operator">++</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
      <span class="token function">delete</span> <span class="token punctuation">(</span><span class="token operator">*</span>projectDelIt<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">(</span><span class="token operator">*</span>projectDelIt<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   m_projectList<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>IIterator.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
class IProject<span class="token punctuation">;</span>
class IIterator
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">IIterator</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    virtual <span class="token operator">~</span><span class="token function">IIterator</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    virtual bool <span class="token function">HasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual IProject <span class="token operator">*</span> <span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>IProjectIterator.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"iiterator.h"</span></span>
class IProject<span class="token punctuation">;</span>
class IProjectIterator <span class="token punctuation">:</span>
    public IIterator
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">IProjectIterator</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    virtual <span class="token operator">~</span><span class="token function">IProjectIterator</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    virtual bool <span class="token function">HasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual IProject <span class="token operator">*</span> <span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ProjectIterator.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"iprojectiterator.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"IProject.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>vector<span class="token punctuation">;</span>
class CProjectIterator <span class="token punctuation">:</span>
    public IProjectIterator
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CProjectIterator</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>IProject <span class="token operator">*</span><span class="token operator">></span> pl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CProjectIterator</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    bool <span class="token function">HasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    IProject <span class="token operator">*</span> <span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
private<span class="token punctuation">:</span>
    vector<span class="token operator">&lt;</span>IProject <span class="token operator">*</span><span class="token operator">></span> m_projectList<span class="token punctuation">;</span>
    size_t m_currentItem<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ProjectIterator.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ProjectIterator.h"</span></span>
CProjectIterator<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CProjectIterator</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>IProject<span class="token operator">*</span><span class="token operator">></span> pl<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token function">m_projectList</span><span class="token punctuation">(</span>pl<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   m_currentItem <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
CProjectIterator<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CProjectIterator</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
bool CProjectIterator<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">HasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   bool b <span class="token operator">=</span> true<span class="token punctuation">;</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span>m_currentItem <span class="token operator">>=</span> m_projectList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      b <span class="token operator">=</span> false<span class="token punctuation">;</span>
   <span class="token keyword">return</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
IProject<span class="token operator">*</span> CProjectIterator<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   IProject<span class="token operator">*</span> pp <span class="token operator">=</span> m_projectList<span class="token punctuation">.</span><span class="token function">at</span><span class="token punctuation">(</span>m_currentItem<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> pp<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Iterator.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"IProject.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Project.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ProjectIterator.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;string></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>vector<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>to_string<span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">DoIt</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   cout <span class="token operator">&lt;&lt;</span> <span class="token string">"----------未使用迭代模式----------"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
   vector<span class="token operator">&lt;</span>IProject<span class="token operator">*</span><span class="token operator">></span> projectList<span class="token punctuation">;</span>

   projectList<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>new <span class="token function">CProject</span><span class="token punctuation">(</span><span class="token string">"星球大战项目"</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">100000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   projectList<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>new <span class="token function">CProject</span><span class="token punctuation">(</span><span class="token string">"扭转时空项目"</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">10000000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   projectList<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>new <span class="token function">CProject</span><span class="token punctuation">(</span><span class="token string">"超人改造项目"</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">,</span> <span class="token number">1000000000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
      string name <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
      name<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"第"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      name<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token function">to_string</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      name<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"个项目"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      projectList<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>new <span class="token function">CProject</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> i <span class="token operator">*</span> <span class="token number">5</span><span class="token punctuation">,</span> i <span class="token operator">*</span> <span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   vector<span class="token operator">&lt;</span>IProject<span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">:</span><span class="token punctuation">:</span>const_iterator projectIt <span class="token operator">=</span> projectList<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> projectIt <span class="token operator">!=</span> projectList<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> projectIt<span class="token operator">++</span><span class="token punctuation">)</span>
      cout <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token operator">*</span>projectIt<span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">GetProjectInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

   vector<span class="token operator">&lt;</span>IProject<span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">:</span><span class="token punctuation">:</span>reverse_iterator projectDelIt <span class="token operator">=</span> projectList<span class="token punctuation">.</span><span class="token function">rbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> projectDelIt <span class="token operator">!=</span> projectList<span class="token punctuation">.</span><span class="token function">rend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> projectDelIt<span class="token operator">++</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
      <span class="token function">delete</span> <span class="token punctuation">(</span><span class="token operator">*</span>projectDelIt<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">(</span><span class="token operator">*</span>projectDelIt<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   projectList<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">DoNew</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   cout <span class="token operator">&lt;&lt;</span> <span class="token string">"----------使用迭代模式----------"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
   IProject<span class="token operator">*</span> pproject <span class="token operator">=</span> new <span class="token function">CProject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   pproject<span class="token operator">-></span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">"星球大战项目"</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">100000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   pproject<span class="token operator">-></span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">"扭转时空项目"</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">10000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   pproject<span class="token operator">-></span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">"超人改造项目"</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">,</span> <span class="token number">1000000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
      string name <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
      name<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"第"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      name<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token function">to_string</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      name<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"个项目"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      pproject<span class="token operator">-></span><span class="token function">Add</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> i <span class="token operator">*</span> <span class="token number">5</span><span class="token punctuation">,</span> i <span class="token operator">*</span> <span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   IProjectIterator<span class="token operator">*</span> pprojectIt <span class="token operator">=</span> pproject<span class="token operator">-></span><span class="token function">GetIterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">while</span> <span class="token punctuation">(</span>pprojectIt<span class="token operator">-></span><span class="token function">HasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
      IProject<span class="token operator">*</span> p <span class="token operator">=</span> dynamic_cast<span class="token operator">&lt;</span>IProject<span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">(</span>pprojectIt<span class="token operator">-></span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      cout <span class="token operator">&lt;&lt;</span> p<span class="token operator">-></span><span class="token function">GetProjectInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   delete pprojectIt<span class="token punctuation">;</span>
   pprojectIt <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
   pproject<span class="token operator">-></span><span class="token function">Erase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   delete pproject<span class="token punctuation">;</span>
   pproject <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   <span class="token comment" spellcheck="true">//使用Iterator模式之前</span>
   <span class="token function">DoIt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token comment" spellcheck="true">//使用Iterator</span>
   <span class="token function">DoNew</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token function">_CrtSetDbgFlag</span><span class="token punctuation">(</span>_CRTDBG_LEAK_CHECK_DF <span class="token operator">|</span> _CRTDBG_ALLOC_MEM_DF<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">_CrtDumpMemoryLeaks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>----------未使用迭代模式----------
项目名称是：星球大战项目        项目人数：10    项目费用：100000
项目名称是：扭转时空项目        项目人数：100   项目费用：10000000
项目名称是：超人改造项目        项目人数：10000 项目费用：1000000000
项目名称是：第4个项目   项目人数：20    项目费用：4000000
项目名称是：第5个项目   项目人数：25    项目费用：5000000
----------使用迭代模式----------
项目名称是：星球大战项目        项目人数：10    项目费用：100000
项目名称是：扭转时空项目        项目人数：100   项目费用：10000000
项目名称是：超人改造项目        项目人数：10000 项目费用：1000000000
项目名称是：第4个项目   项目人数：20    项目费用：4000000
项目名称是：第5个项目   项目人数：25    项目费用：5000000   </code></pre><h2 id="组合模式"><a href="#组合模式" class="headerlink" title="组合模式"></a>组合模式</h2><blockquote>
<p>Compose objects into tree structures to represent part-whole hierarchies.Composite lets clients treat individual objects and compositions of objects uniformly.<br><br>将对象组合成树形结构以表示“部分-整体”的层次结构，使得用户对单个对象和组合对象的使用具有一致性。</p>
</blockquote>
<hr>

<p>main()，客户</p>
<p>CCorpNode，抽象基类，实现基本信息</p>
<p>CBranchNode，树枝节点，实现Addordinate()函数和GetSubordinate()函数</p>
<p>CLeafNode，叶子节点，IsLeaf属性总是“true”</p>
<p>说明：组合模式主要是实现在CBranchNode对象里增加对其它对象的数组，如vector&lt;CCorpNode*&gt;，数组里可以存放CBranchNode和CLeafNode对象。这样方便进行遍历操作。</p>
<p>注意：组合模式有透明组合模式和安全组合模式。透明组合模式是将Addordinate和GetSubordinate这两个函数也抽象到CCorpNode基类里，这增加了操作叶子节点的难度，更易出现逻辑问题。所以尽量使用安全模式。</p>
<p>这个简单了，可以想像一下TreeView和TreeNode基本上是这个意思了，将很多数据组织在一块。</p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1573343814177.png?x-oss-process=image/resize,m_lfit,h_450" alt="组织架构"></p>
<p>Branch.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ibranch.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ICorp.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>vector<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>
class CBranch <span class="token punctuation">:</span>
    public IBranch<span class="token punctuation">,</span> ICorp
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CBranch</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">CBranch</span><span class="token punctuation">(</span>string name<span class="token punctuation">,</span> string pos<span class="token punctuation">,</span> <span class="token keyword">int</span> salary<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CBranch</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Add</span><span class="token punctuation">(</span>ICorp <span class="token operator">*</span>pcorp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    vector<span class="token operator">&lt;</span>ICorp<span class="token operator">*</span><span class="token operator">></span> <span class="token function">GetSubordinateInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    string <span class="token function">GetInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
private<span class="token punctuation">:</span>
    string m_name<span class="token punctuation">;</span>
    string m_position<span class="token punctuation">;</span>
    <span class="token keyword">int</span> m_salary<span class="token punctuation">;</span>
    vector<span class="token operator">&lt;</span>ICorp<span class="token operator">*</span><span class="token operator">></span> m_subordinateList<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>BranchNode.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"corpnode.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"CorpNode.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>vector<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>
class CBranchNode <span class="token punctuation">:</span>
    public CCorpNode
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CBranchNode</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">CBranchNode</span><span class="token punctuation">(</span>string name<span class="token punctuation">,</span> string pos<span class="token punctuation">,</span> <span class="token keyword">int</span> salary<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CBranchNode</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Add</span><span class="token punctuation">(</span>CCorpNode <span class="token operator">*</span>pcorpNode<span class="token punctuation">)</span><span class="token punctuation">;</span>
    vector<span class="token operator">&lt;</span>CCorpNode<span class="token operator">*</span><span class="token operator">></span> <span class="token function">GetSubordinateInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    bool <span class="token function">IsLeaf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
private<span class="token punctuation">:</span>
    vector<span class="token operator">&lt;</span>CCorpNode<span class="token operator">*</span><span class="token operator">></span> m_subordinateList<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>CorpNode.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>
class CCorpNode
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CCorpNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">CCorpNode</span><span class="token punctuation">(</span>string _name<span class="token punctuation">,</span> string _pos<span class="token punctuation">,</span> <span class="token keyword">int</span> _salary<span class="token punctuation">)</span><span class="token punctuation">;</span>
    virtual <span class="token operator">~</span><span class="token function">CCorpNode</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    virtual string <span class="token function">GetInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">SetParent</span><span class="token punctuation">(</span>CCorpNode <span class="token operator">*</span>_pParent<span class="token punctuation">)</span><span class="token punctuation">;</span>
    CCorpNode <span class="token operator">*</span> <span class="token function">GetParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    virtual bool <span class="token function">IsLeaf</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
private<span class="token punctuation">:</span>
    string m_name<span class="token punctuation">;</span>
    string m_position<span class="token punctuation">;</span>
    <span class="token keyword">int</span> m_salary<span class="token punctuation">;</span>
protected<span class="token punctuation">:</span>
    bool m_isLeaf<span class="token punctuation">;</span>
    CCorpNode <span class="token operator">*</span>m_pParent<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>IBranch.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ICorp.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>vector<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>
class IBranch
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>

    <span class="token function">IBranch</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    virtual <span class="token operator">~</span><span class="token function">IBranch</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    virtual <span class="token keyword">void</span> <span class="token function">Add</span><span class="token punctuation">(</span>ICorp <span class="token operator">*</span>pcorp<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual vector<span class="token operator">&lt;</span>ICorp<span class="token operator">*</span><span class="token operator">></span> <span class="token function">GetSubordinateInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ICorp.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>
class ICorp
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>

    <span class="token function">ICorp</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    virtual <span class="token operator">~</span><span class="token function">ICorp</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    virtual string <span class="token function">GetInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Leaf.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"icorp.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>
class CLeaf <span class="token punctuation">:</span>
    public ICorp
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CLeaf</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">CLeaf</span><span class="token punctuation">(</span>string name<span class="token punctuation">,</span> string pos<span class="token punctuation">,</span> <span class="token keyword">int</span> salary<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CLeaf</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    string <span class="token function">GetInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
private<span class="token punctuation">:</span>
    string m_name<span class="token punctuation">;</span>
    string m_position<span class="token punctuation">;</span>
    <span class="token keyword">int</span> m_salary<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>LeafNode.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"corpnode.h"</span></span>
class CLeafNode <span class="token punctuation">:</span>
    public CCorpNode
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CLeafNode</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">CLeafNode</span><span class="token punctuation">(</span>string name<span class="token punctuation">,</span> string pos<span class="token punctuation">,</span> <span class="token keyword">int</span> salary<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CLeafNode</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    bool <span class="token function">IsLeaf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Branch.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Branch.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"..\CommonDeclare\Convert.h"</span></span>


CBranch<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CBranch</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>

CBranch<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CBranch</span><span class="token punctuation">(</span> string name<span class="token punctuation">,</span> string pos<span class="token punctuation">,</span> <span class="token keyword">int</span> salary <span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token function">m_name</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_position</span><span class="token punctuation">(</span>pos<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_salary</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
<span class="token punctuation">{</span>

<span class="token punctuation">}</span>


CBranch<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CBranch</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CBranch<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Add</span><span class="token punctuation">(</span> ICorp <span class="token operator">*</span>pcorp <span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    m_subordinateList<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>pcorp<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

vector<span class="token operator">&lt;</span>ICorp<span class="token operator">*</span><span class="token operator">></span> CBranch<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetSubordinateInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> this<span class="token operator">-></span>m_subordinateList<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

string CBranch<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    string info <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
    info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"姓名："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>this<span class="token operator">-></span>m_name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"\t职位："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>this<span class="token operator">-></span>m_position<span class="token punctuation">)</span><span class="token punctuation">;</span>
    info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"\t薪水："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>CConvert<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">ToString</span><span class="token punctuation">(</span>this<span class="token operator">-></span>m_salary<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> info<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>BranchNode.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"BranchNode.h"</span></span>


CBranchNode<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CBranchNode</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    m_isLeaf <span class="token operator">=</span> false<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


CBranchNode<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CBranchNode</span><span class="token punctuation">(</span> string name<span class="token punctuation">,</span> string pos<span class="token punctuation">,</span> <span class="token keyword">int</span> salary <span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token function">CCorpNode</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> pos<span class="token punctuation">,</span> salary<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    m_isLeaf <span class="token operator">=</span> false<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


CBranchNode<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CBranchNode</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CBranchNode<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Add</span><span class="token punctuation">(</span> CCorpNode <span class="token operator">*</span>pcorpNode <span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    pcorpNode<span class="token operator">-></span><span class="token function">SetParent</span><span class="token punctuation">(</span>this<span class="token punctuation">)</span><span class="token punctuation">;</span>
    m_subordinateList<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>pcorpNode<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

vector<span class="token operator">&lt;</span>CCorpNode<span class="token operator">*</span><span class="token operator">></span> CBranchNode<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetSubordinateInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> this<span class="token operator">-></span>m_subordinateList<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

bool CBranchNode<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">IsLeaf</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> m_isLeaf<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Composite.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token comment" spellcheck="true">// Composite.cpp : 定义控制台应用程序的入口点。</span>
<span class="token comment" spellcheck="true">//</span>

<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"BranchNode.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"LeafNode.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>vector<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>


<span class="token keyword">void</span> <span class="token function">DoIt</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//注未使用模式调用ICorp、CLeaf、CBranch这三个类来组织。</span>
<span class="token punctuation">}</span>

string <span class="token function">GetTreeInfo</span><span class="token punctuation">(</span>CBranchNode <span class="token operator">*</span> proot<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    vector<span class="token operator">&lt;</span>CCorpNode<span class="token operator">*</span><span class="token operator">></span> subordinateList <span class="token operator">=</span> proot<span class="token operator">-></span><span class="token function">GetSubordinateInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    string info <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>

    vector<span class="token operator">&lt;</span>CCorpNode<span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">:</span><span class="token punctuation">:</span>const_iterator it <span class="token operator">=</span> subordinateList<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> it <span class="token operator">!=</span> subordinateList<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>it<span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">IsLeaf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>it<span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">GetInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">{</span>
            info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>it<span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">GetInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token function">GetTreeInfo</span><span class="token punctuation">(</span>dynamic_cast<span class="token operator">&lt;</span>CBranchNode<span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token operator">*</span>it<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> info<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">void</span> <span class="token function">DoNew</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    CBranchNode <span class="token function">root</span><span class="token punctuation">(</span><span class="token string">"赵大"</span><span class="token punctuation">,</span> <span class="token string">"总经理"</span><span class="token punctuation">,</span> <span class="token number">100000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    CBranchNode <span class="token function">devDep</span><span class="token punctuation">(</span><span class="token string">"钱大"</span><span class="token punctuation">,</span> <span class="token string">"研发部门经理"</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    CBranchNode <span class="token function">saleDep</span><span class="token punctuation">(</span><span class="token string">"孙大"</span><span class="token punctuation">,</span> <span class="token string">"销售部门经理"</span><span class="token punctuation">,</span> <span class="token number">20000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    CBranchNode <span class="token function">financeDep</span><span class="token punctuation">(</span><span class="token string">"李大"</span><span class="token punctuation">,</span> <span class="token string">"财务部门经理"</span><span class="token punctuation">,</span> <span class="token number">30000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    CBranchNode <span class="token function">firstDevGroup</span><span class="token punctuation">(</span><span class="token string">"周三也斜"</span><span class="token punctuation">,</span> <span class="token string">"开发一组组长"</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    CBranchNode <span class="token function">secondDevGroup</span><span class="token punctuation">(</span><span class="token string">"吴大棒槌"</span><span class="token punctuation">,</span> <span class="token string">"开发二组组长"</span><span class="token punctuation">,</span> <span class="token number">6000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    CLeafNode <span class="token function">a</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token string">"开发人员"</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    CLeafNode <span class="token function">b</span><span class="token punctuation">(</span><span class="token string">"b"</span><span class="token punctuation">,</span> <span class="token string">"开发人员"</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    CLeafNode <span class="token function">c</span><span class="token punctuation">(</span><span class="token string">"c"</span><span class="token punctuation">,</span> <span class="token string">"开发人员"</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    CLeafNode <span class="token function">d</span><span class="token punctuation">(</span><span class="token string">"d"</span><span class="token punctuation">,</span> <span class="token string">"开发人员"</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    CLeafNode <span class="token function">e</span><span class="token punctuation">(</span><span class="token string">"e"</span><span class="token punctuation">,</span> <span class="token string">"开发人员"</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    CLeafNode <span class="token function">f</span><span class="token punctuation">(</span><span class="token string">"f"</span><span class="token punctuation">,</span> <span class="token string">"开发人员"</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    CLeafNode <span class="token function">g</span><span class="token punctuation">(</span><span class="token string">"g"</span><span class="token punctuation">,</span> <span class="token string">"开发人员"</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    CLeafNode <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">"h"</span><span class="token punctuation">,</span> <span class="token string">"开发人员"</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    CLeafNode <span class="token function">i</span><span class="token punctuation">(</span><span class="token string">"i"</span><span class="token punctuation">,</span> <span class="token string">"开发人员"</span><span class="token punctuation">,</span> <span class="token number">4000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    CLeafNode <span class="token function">j</span><span class="token punctuation">(</span><span class="token string">"j"</span><span class="token punctuation">,</span> <span class="token string">"开发人员"</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    CLeafNode <span class="token function">k</span><span class="token punctuation">(</span><span class="token string">"k"</span><span class="token punctuation">,</span> <span class="token string">"CEO秘书"</span><span class="token punctuation">,</span> <span class="token number">8000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    CLeafNode <span class="token function">zheng</span><span class="token punctuation">(</span><span class="token string">"郑老六"</span><span class="token punctuation">,</span> <span class="token string">"研发部副经理"</span><span class="token punctuation">,</span> <span class="token number">20000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    root<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>CEO有三个部门经理和一个秘书
    root<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>devDep<span class="token punctuation">)</span><span class="token punctuation">;</span>
    root<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>saleDep<span class="token punctuation">)</span><span class="token punctuation">;</span>
    root<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>financeDep<span class="token punctuation">)</span><span class="token punctuation">;</span>

    devDep<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>zheng<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//开发部有一个副经理和两个小组</span>
    devDep<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>firstDevGroup<span class="token punctuation">)</span><span class="token punctuation">;</span>
    devDep<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>secondDevGroup<span class="token punctuation">)</span><span class="token punctuation">;</span>

    firstDevGroup<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    firstDevGroup<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
    firstDevGroup<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
    secondDevGroup<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>
    secondDevGroup<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    secondDevGroup<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>f<span class="token punctuation">)</span><span class="token punctuation">;</span>

    saleDep<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>g<span class="token punctuation">)</span><span class="token punctuation">;</span>
    saleDep<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>h<span class="token punctuation">)</span><span class="token punctuation">;</span>

    financeDep<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    financeDep<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>

    cout <span class="token operator">&lt;&lt;</span> root<span class="token punctuation">.</span><span class="token function">GetInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token function">GetTreeInfo</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>root<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//未使用模式的调用。</span>
    <span class="token function">DoIt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">//使用组合模式后的调用。</span>
    <span class="token function">DoNew</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>CorpNode.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"CorpNode.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"..\CommonDeclare\Convert.h"</span></span>


CCorpNode<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CCorpNode</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    m_name <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
    m_position <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
    m_salary <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


CCorpNode<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CCorpNode</span><span class="token punctuation">(</span>string _name<span class="token punctuation">,</span> string _pos<span class="token punctuation">,</span> <span class="token keyword">int</span> _salary<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token function">m_name</span><span class="token punctuation">(</span>_name<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_position</span><span class="token punctuation">(</span>_pos<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_salary</span><span class="token punctuation">(</span>_salary<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>


CCorpNode<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CCorpNode</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>

string CCorpNode<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    string info <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
    info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"姓名："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>this<span class="token operator">-></span>m_name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"\t职位："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>this<span class="token operator">-></span>m_position<span class="token punctuation">)</span><span class="token punctuation">;</span>
    info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"\t薪水："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>CConvert<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">ToString</span><span class="token punctuation">(</span>this<span class="token operator">-></span>m_salary<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> info<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CCorpNode<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">SetParent</span><span class="token punctuation">(</span> CCorpNode <span class="token operator">*</span>_parent <span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    this<span class="token operator">-></span>m_pParent <span class="token operator">=</span> _parent<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

CCorpNode <span class="token operator">*</span> CCorpNode<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> this<span class="token operator">-></span>m_pParent<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Leaf.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Leaf.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"..\CommonDeclare\Convert.h"</span></span>


CLeaf<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CLeaf</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    m_name <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
    m_position <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
    m_salary <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


CLeaf<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CLeaf</span><span class="token punctuation">(</span> string name<span class="token punctuation">,</span> string pos<span class="token punctuation">,</span> <span class="token keyword">int</span> salary <span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token function">m_name</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_position</span><span class="token punctuation">(</span>pos<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_salary</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>


CLeaf<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CLeaf</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>


string CLeaf<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    string info <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
    info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"姓名："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>this<span class="token operator">-></span>m_name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"\t职位："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>this<span class="token operator">-></span>m_position<span class="token punctuation">)</span><span class="token punctuation">;</span>
    info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"\t薪水："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>CConvert<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">ToString</span><span class="token punctuation">(</span>this<span class="token operator">-></span>m_salary<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> info<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>LeafNode.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"LeafNode.h"</span></span>


CLeafNode<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CLeafNode</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    m_isLeaf <span class="token operator">=</span> true<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


CLeafNode<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CLeafNode</span><span class="token punctuation">(</span> string name<span class="token punctuation">,</span> string pos<span class="token punctuation">,</span> <span class="token keyword">int</span> salary <span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token function">CCorpNode</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> pos<span class="token punctuation">,</span> salary<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    m_isLeaf <span class="token operator">=</span> true<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


CLeafNode<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CLeafNode</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>


bool CLeafNode<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">IsLeaf</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> m_isLeaf<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>姓名：赵大      职位：总经理    薪水：100000
姓名：k 职位：CEO秘书   薪水：8000
姓名：钱大      职位：研发部门经理      薪水：10000
姓名：郑老六    职位：研发部副经理      薪水：20000
姓名：周三也斜  职位：开发一组组长      薪水：5000
姓名：a 职位：开发人员  薪水：2000
姓名：b 职位：开发人员  薪水：2000
姓名：c 职位：开发人员  薪水：2000
姓名：吴大棒槌  职位：开发二组组长      薪水：6000
姓名：d 职位：开发人员  薪水：2000
姓名：e 职位：开发人员  薪水：2000
姓名：f 职位：开发人员  薪水：2000
姓名：孙大      职位：销售部门经理      薪水：20000
姓名：g 职位：开发人员  薪水：2000
姓名：h 职位：开发人员  薪水：5000
姓名：李大      职位：财务部门经理      薪水：30000
姓名：i 职位：开发人员  薪水：4000
姓名：j 职位：开发人员  薪水：5000  </code></pre><h2 id="观察者模式"><a href="#观察者模式" class="headerlink" title="观察者模式"></a>观察者模式</h2><blockquote>
<p>Define a one-to-many dependency between objects so that when one object changes state,all its dependents are notified and updated automatically.<br><br>定义对象间一种一对多的依赖关系，使得每当一个对象改变状态，则所有依赖于它的对象都会得到通知并被自动更新。</p>
</blockquote>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1576921446447.png?x-oss-process=image/resize,m_lfit,h_450" alt="观察者模式"></p>
<p>● Subject被观察者<br>定义被观察者必须实现的职责，它必须能够动态地增加、取消观察者。它一般是抽象类或者是实现类，仅仅完成作为被观察者必须实现的职责：管理观察者并通知观察者。<br>● Observer观察者<br>观察者接收到消息后，即进行update（更新方法）操作，对接收到的信息进行处理。<br>● ConcreteSubject具体的被观察者<br>定义被观察者自己的业务逻辑，同时定义对哪些事件进行通知。<br>● ConcreteObserver具体的观察者<br>每个观察在接收到消息后的处理反应是不同，各个观察者有自己的处理逻辑。</p>
<p>传统方式用多线程技术实现监听，而线程和死循环会极大的增加开销，为了避免这种开销，可以使用观察者模式。</p>
<p>这种模式有多种叫法,现整理如下,每一行都是相同的东西:<br>主题,被观察者,调用者<br>订阅者,观察者,被调用者<br>注册,订阅</p>
<hr>

<p>主题用于管理订阅者,当发布者发生变化时,主题广播给所有订阅者,然后所有订阅者做统一动作.</p>
<p><code>主题</code><br>Subject.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">ifndef</span> __SUBJECT__H__</span>
<span class="token macro property">#<span class="token directive keyword">define</span> __SUBJECT__H__</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Observer.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;list></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span>
using namespace std<span class="token punctuation">;</span>
class Observer<span class="token punctuation">;</span>
class Subject
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">Subject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    virtual <span class="token operator">~</span><span class="token function">Subject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">attach</span><span class="token punctuation">(</span>Observer<span class="token operator">*</span> obs<span class="token punctuation">)</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">detach</span><span class="token punctuation">(</span>Observer<span class="token operator">*</span> obs<span class="token punctuation">)</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">Notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">setState</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> str<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual string <span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

private<span class="token punctuation">:</span>
    list<span class="token operator">&lt;</span>Observer<span class="token operator">*</span><span class="token operator">></span><span class="token operator">*</span> _observers<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


class ConcreteSubject <span class="token punctuation">:</span> public Subject <span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">ConcreteSubject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">ConcreteSubject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">setState</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
    string <span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
private<span class="token punctuation">:</span>
    string state<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Subject.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Subject.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;list></span></span>
using namespace std<span class="token punctuation">;</span>

Subject<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Subject</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    _observers <span class="token operator">=</span> new list<span class="token operator">&lt;</span>Observer<span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
Subject<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">Subject</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>

<span class="token keyword">void</span> Subject<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">attach</span><span class="token punctuation">(</span>Observer<span class="token operator">*</span> obs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>obs <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        _observers<span class="token operator">-></span><span class="token function">push_front</span><span class="token punctuation">(</span>obs<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> Subject<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">detach</span><span class="token punctuation">(</span>Observer<span class="token operator">*</span> obs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>obs <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        _observers<span class="token operator">-></span><span class="token function">remove</span><span class="token punctuation">(</span>obs<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> Subject<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    list<span class="token operator">&lt;</span>Observer<span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">:</span><span class="token punctuation">:</span>iterator iter<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//遍历更新</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>iter <span class="token operator">=</span> _observers<span class="token operator">-></span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> iter <span class="token operator">!=</span> _observers<span class="token operator">-></span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> iter<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">(</span><span class="token operator">*</span>iter<span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">update</span><span class="token punctuation">(</span>this<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

ConcreteSubject<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">ConcreteSubject</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    this<span class="token operator">-></span>state <span class="token operator">=</span> <span class="token string">'\0'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

ConcreteSubject<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">ConcreteSubject</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>

string ConcreteSubject<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> this<span class="token operator">-></span>state<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> ConcreteSubject<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> str<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    this<span class="token operator">-></span>state <span class="token operator">=</span> str<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>观察者</code></p>
<p>Observer.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">ifndef</span> __OBSERVER__H__</span>
<span class="token macro property">#<span class="token directive keyword">define</span> __OBSERVER__H__</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Subject.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span>
using namespace std<span class="token punctuation">;</span>
class Subject<span class="token punctuation">;</span>
class Observer <span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">Observer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    virtual <span class="token operator">~</span><span class="token function">Observer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span>Subject<span class="token operator">*</span> subject<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">printInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
public<span class="token punctuation">:</span>
    std<span class="token punctuation">:</span><span class="token punctuation">:</span>string state<span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">;</span>

class ConcreteObserver<span class="token punctuation">:</span>public Observer 
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">ConcreteObserver</span><span class="token punctuation">(</span>Subject<span class="token operator">*</span> sub<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">ConcreteObserver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span>Subject<span class="token operator">*</span> sub<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">printInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
private<span class="token punctuation">:</span>
    Subject<span class="token operator">*</span> _sub<span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Observer.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Observer.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;list></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>

using namespace std<span class="token punctuation">;</span>

Observer<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Observer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    state <span class="token operator">=</span> <span class="token string">'\0'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

Observer<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">Observer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>

ConcreteObserver<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">ConcreteObserver</span><span class="token punctuation">(</span>Subject<span class="token operator">*</span> sub<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    _sub <span class="token operator">=</span> sub<span class="token punctuation">;</span>
    _sub<span class="token operator">-></span><span class="token function">attach</span><span class="token punctuation">(</span>this<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


ConcreteObserver<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">ConcreteObserver</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    _sub<span class="token operator">-></span><span class="token function">detach</span><span class="token punctuation">(</span>this<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>_sub <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        delete _sub<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>



<span class="token keyword">void</span> ConcreteObserver<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">update</span><span class="token punctuation">(</span>Subject<span class="token operator">*</span> subject<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    state <span class="token operator">=</span> subject<span class="token operator">-></span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    this<span class="token operator">-></span><span class="token function">printInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">void</span> ConcreteObserver<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">printInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment" spellcheck="true">// string str = _sub->getState();</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"ConcreteObserver observer.... "</span> <span class="token operator">&lt;&lt;</span> _sub<span class="token operator">-></span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>主函数</code><br>main.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Observer.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Subject.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using namespace std<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//新建一个被监听对象sub（主题）</span>
    Subject<span class="token operator">*</span> sub <span class="token operator">=</span> new <span class="token function">ConcreteSubject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">//新建一个监听者obA ，并初始化为监听sub</span>
    ConcreteObserver<span class="token operator">*</span> obA <span class="token operator">=</span> new <span class="token function">ConcreteObserver</span><span class="token punctuation">(</span>sub<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ConcreteObserver<span class="token operator">*</span> obB <span class="token operator">=</span> new <span class="token function">ConcreteObserver</span><span class="token punctuation">(</span>sub<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">//验证此时消息为空</span>
    obA<span class="token operator">-></span><span class="token function">printInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    obB<span class="token operator">-></span><span class="token function">printInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">//被监听者开始改变</span>
    sub<span class="token operator">-></span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token string">"大家好，我现在已经发布了最新消息"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//被监听者发布广播</span>
    sub<span class="token operator">-></span><span class="token function">Notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-bash"><code class="language-bash">g++ main.cpp Subject.cpp Observer.cpp 
./a.out<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<pre><code>ConcreteObserver observer.... 
ConcreteObserver observer.... 
ConcreteObserver observer.... 大家好，我现在已经发布了最新消息
ConcreteObserver observer.... 大家好，我现在已经发布了最新消息</code></pre><p>这是被监听者和监听者直接对接的模型，还有一种是增加了第三方通信平台，监听者向平台注册，被监听者将更新信息发送给消息平台，然后平台进行发放广播。我怀疑这是不是代理模式？</p>
<h2 id="门面模式"><a href="#门面模式" class="headerlink" title="门面模式"></a>门面模式</h2><blockquote>
<p>Provide a unified interface to a set of interfaces in a subsystem.Facade defines a higher-level interface that makes the subsystem easier to use.<br><br>要求一个子系统的外部与其内部的通信必须通过一个统一的对象进行。门面模式提供一个高层次的接口，使得子系统更易于使用。</p>
</blockquote>
<p>门面模式注重“统一的对象”，也就是提供一个访问子系统的接口，除了这个接口不允许有任何访问子系统的行为发生。<br>简单说，就是将复杂的逻辑封装起来，对外公开简单的接口，由客户程序调用。</p>
<hr>

<p>main()，客户</p>
<p>ILetterProcess，接口</p>
<p>CLetterProcessImpl，信件处理的4个函数</p>
<p>CLetterPolice，警察</p>
<p>CModenPostOffice，邮局</p>
<p>说明：邮局对外只有一个窗口，接收信件内容和邮件地址。对内调用邮件处理的4个函数。将复杂逻辑封装在邮局的里面，当需要增加警察来检查信件时，只需在邮局内增加警察检查信件的方法。</p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1573294669601.png?x-oss-process=image/resize,m_lfit,h_450" alt="写信过程类图"></p>
<p>ILetterProcess.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>
class ILetterProcess
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">ILetterProcess</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    virtual <span class="token operator">~</span><span class="token function">ILetterProcess</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">WriteContext</span><span class="token punctuation">(</span>string context<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">FillEnvelope</span><span class="token punctuation">(</span>string address<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">LetterIntoEnvelope</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">SendLetter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ILetterProcess.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ILetterProcess.h"</span></span>
ILetterProcess<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">ILetterProcess</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
ILetterProcess<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">ILetterProcess</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>LetterprocessImpl.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"iletterprocess.h"</span></span>
class CLetterProcessImpl <span class="token punctuation">:</span>
    public ILetterProcess
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CLetterProcessImpl</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CLetterProcessImpl</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">void</span> <span class="token function">WriteContext</span><span class="token punctuation">(</span>string context<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">FillEnvelope</span><span class="token punctuation">(</span>string address<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">LetterIntoEnvelope</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">SendLetter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>LetterProcessImpl.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"LetterProcessImpl.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
CLetterProcessImpl<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CLetterProcessImpl</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
CLetterProcessImpl<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CLetterProcessImpl</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CLetterProcessImpl<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">WriteContext</span><span class="token punctuation">(</span>string context<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"填写信的内容... ..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CLetterProcessImpl<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">FillEnvelope</span><span class="token punctuation">(</span>string address<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"填写收件人地址及姓名... ..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CLetterProcessImpl<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">LetterIntoEnvelope</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"把信放到信封中..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CLetterProcessImpl<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">SendLetter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"邮递信件..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ModenPostOffice.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ILetterProcess.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"LetterProcessImpl.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"LetterPolice.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>
class CModenPostOffice
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CModenPostOffice</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CModenPostOffice</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">SendLetter</span><span class="token punctuation">(</span>string context<span class="token punctuation">,</span> string address<span class="token punctuation">)</span><span class="token punctuation">;</span>
private<span class="token punctuation">:</span>
    ILetterProcess <span class="token operator">*</span>m_pLetterProcess<span class="token punctuation">;</span>
    CLetterPolice <span class="token operator">*</span>m_pLetterPolice<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ModenPostOffice.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ModenPostOffice.h"</span></span>
CModenPostOffice<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CModenPostOffice</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    this<span class="token operator">-></span>m_pLetterProcess <span class="token operator">=</span> new <span class="token function">CLetterProcessImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    this<span class="token operator">-></span>m_pLetterPolice <span class="token operator">=</span> new <span class="token function">CLetterPolice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
CModenPostOffice<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CModenPostOffice</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    delete m_pLetterProcess<span class="token punctuation">;</span>
    delete m_pLetterPolice<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CModenPostOffice<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">SendLetter</span><span class="token punctuation">(</span> string context<span class="token punctuation">,</span> string address <span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//帮忙写信</span>
    m_pLetterProcess<span class="token operator">-></span><span class="token function">WriteContext</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//写好信封</span>
    m_pLetterProcess<span class="token operator">-></span><span class="token function">FillEnvelope</span><span class="token punctuation">(</span>address<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//警察要检查信件了</span>
    m_pLetterPolice<span class="token operator">-></span><span class="token function">CheckLetter</span><span class="token punctuation">(</span>m_pLetterProcess<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//把信放到信封中</span>
    m_pLetterProcess<span class="token operator">-></span><span class="token function">LetterIntoEnvelope</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//邮递信件</span>
    m_pLetterProcess<span class="token operator">-></span><span class="token function">SendLetter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>LetterPolice.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ILetterProcess.h"</span></span>
class CLetterPolice
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
   <span class="token function">CLetterPolice</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token operator">~</span><span class="token function">CLetterPolice</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
   <span class="token keyword">void</span> <span class="token function">CheckLetter</span><span class="token punctuation">(</span>ILetterProcess<span class="token operator">*</span> pLetterProcess<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>LetterPolice.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"LetterPolice.h"</span></span>
CLetterPolice<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CLetterPolice</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
CLetterPolice<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CLetterPolice</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CLetterPolice<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CheckLetter</span><span class="token punctuation">(</span> ILetterProcess <span class="token operator">*</span>pLetterProcess <span class="token punctuation">)</span>
<span class="token punctuation">{</span>

    <span class="token comment" spellcheck="true">//检查信件，此处省略一万字。</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Facade.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ILetterProcess.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"LetterProcessImpl.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ModenPostOffice.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">DoItByPostOffice</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    CModenPostOffice modenPostOffice<span class="token punctuation">;</span>
    string context <span class="token operator">=</span> <span class="token string">"Hello, It's me, do you know who I am? I'm your old lover. I'd like to ... ..."</span><span class="token punctuation">;</span>
    string address <span class="token operator">=</span> <span class="token string">"Happy Road No. 666, Beijing City, China"</span><span class="token punctuation">;</span>
    modenPostOffice<span class="token punctuation">.</span><span class="token function">SendLetter</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> address<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">DoItYourself</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    ILetterProcess <span class="token operator">*</span>pLetterProcess <span class="token operator">=</span> new <span class="token function">CLetterProcessImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pLetterProcess<span class="token operator">-></span><span class="token function">WriteContext</span><span class="token punctuation">(</span><span class="token string">"Hello, It's me, do you know who I am? I'm your old lover. I'd like to ... ..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pLetterProcess<span class="token operator">-></span><span class="token function">FillEnvelope</span><span class="token punctuation">(</span><span class="token string">"Happy Road No. 666, Beijing City, China"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pLetterProcess<span class="token operator">-></span><span class="token function">LetterIntoEnvelope</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pLetterProcess<span class="token operator">-></span><span class="token function">SendLetter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    delete pLetterProcess<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//现在的调用方式。对于客户来说确实简单多了。</span>
    <span class="token comment" spellcheck="true">//如需要增加逻辑，例如让警察来检查邮件。可以在邮局里完成这项工作。</span>
    <span class="token function">DoItByPostOffice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">//原来的调用方式。</span>
    <span class="token function">DoItYourself</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">_CrtSetDbgFlag</span><span class="token punctuation">(</span>_CRTDBG_LEAK_CHECK_DF <span class="token operator">|</span> _CRTDBG_ALLOC_MEM_DF<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">_CrtDumpMemoryLeaks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>填写信的内容... ...
填写收件人地址及姓名... ...
把信放到信封中...
邮递信件...
填写信的内容... ...
填写收件人地址及姓名... ...
把信放到信封中...
邮递信件...   </code></pre><h2 id="备忘录模式"><a href="#备忘录模式" class="headerlink" title="备忘录模式"></a>备忘录模式</h2><blockquote>
<p>Without violating encapsulation,capture and externalize an object’s internal state so that the object can be restored to this state later.<br><br>在不破坏封装性的前提下，捕获一个对象的内部状态，并在该对象之外保存这个状态。这样以后就可将该对象恢复到原先保存的状态。</p>
</blockquote>
<h2 id="访问者模式"><a href="#访问者模式" class="headerlink" title="访问者模式"></a>访问者模式</h2><blockquote>
<p>Represent an operation to be performed on the elements of an object structure. Visitor lets you define a new operation without changing the classes of the elements on which it operates. <br><br>封装一些作用于某种数据结构中的各元素的操作，它可以在不改变数据结构的前提下定义作用于这些元素的新的操作。</p>
</blockquote>
<p>BaseVisitor.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ivisitor.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"CommonEmployee.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Manager.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>
class CBaseVisitor <span class="token punctuation">:</span>
    public IVisitor
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CBaseVisitor</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CBaseVisitor</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Visit</span><span class="token punctuation">(</span>CCommonEmployee commonEmployee<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Visit</span><span class="token punctuation">(</span>CManager manager<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> <span class="token function">GetTotalSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
private<span class="token punctuation">:</span>
    string <span class="token function">GetBasicInfo</span><span class="token punctuation">(</span>CEmployee <span class="token operator">*</span>pemployee<span class="token punctuation">)</span><span class="token punctuation">;</span>
    string <span class="token function">GetManagerInfo</span><span class="token punctuation">(</span>CManager manager<span class="token punctuation">)</span><span class="token punctuation">;</span>
    string <span class="token function">GetCommonEmployee</span><span class="token punctuation">(</span>CCommonEmployee employee<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">int</span> MANAGER_COEFFICENT <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">int</span> COMMONEMPLOYEE_COEFFICENT <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> m_commonTotal<span class="token punctuation">;</span>
    <span class="token keyword">int</span> m_managerTotal<span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">CalCommonSalary</span><span class="token punctuation">(</span><span class="token keyword">int</span> salary<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">CalManagerSalary</span><span class="token punctuation">(</span><span class="token keyword">int</span> salary<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>CommonEmployee.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"employee.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"IVisitor.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>
class CCommonEmployee <span class="token punctuation">:</span>
    public CEmployee
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CCommonEmployee</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CCommonEmployee</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    string <span class="token function">GetJob</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">SetJob</span><span class="token punctuation">(</span>string job<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Accept</span><span class="token punctuation">(</span>IVisitor <span class="token operator">*</span>pVisitor<span class="token punctuation">)</span><span class="token punctuation">;</span>
protected<span class="token punctuation">:</span>
    string <span class="token function">GetOtherInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
private<span class="token punctuation">:</span>
    string m_job<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Employee.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"IVisitor.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>
class CEmployee
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token keyword">static</span> <span class="token keyword">int</span> MALE<span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token keyword">int</span> FEMALE<span class="token punctuation">;</span>
    <span class="token function">CEmployee</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    virtual <span class="token operator">~</span><span class="token function">CEmployee</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    string <span class="token function">GetName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">SetName</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> <span class="token function">GetSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">SetSalary</span><span class="token punctuation">(</span><span class="token keyword">int</span> v<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> <span class="token function">GetSex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">SetSex</span><span class="token punctuation">(</span><span class="token keyword">int</span> v<span class="token punctuation">)</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">Accept</span><span class="token punctuation">(</span>IVisitor <span class="token operator">*</span>pVisitor<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
private<span class="token punctuation">:</span>
    string m_name<span class="token punctuation">;</span>
    <span class="token keyword">int</span> m_salary<span class="token punctuation">;</span>
    <span class="token keyword">int</span> m_sex<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>IVisitor.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>

class CCommonEmployee<span class="token punctuation">;</span>
class CManager<span class="token punctuation">;</span>
class IVisitor
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>

    <span class="token function">IVisitor</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    virtual <span class="token operator">~</span><span class="token function">IVisitor</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    virtual <span class="token keyword">void</span> <span class="token function">Visit</span><span class="token punctuation">(</span>CCommonEmployee commonEmployee<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">Visit</span><span class="token punctuation">(</span>CManager manager<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">int</span> <span class="token function">GetTotalSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Manager.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"employee.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"IVisitor.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>
class CManager <span class="token punctuation">:</span>
    public CEmployee
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CManager</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CManager</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    string <span class="token function">GetPerformance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">SetPerformance</span><span class="token punctuation">(</span>string per<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Accept</span><span class="token punctuation">(</span>IVisitor <span class="token operator">*</span>pVisitor<span class="token punctuation">)</span><span class="token punctuation">;</span>
protected<span class="token punctuation">:</span>
    string <span class="token function">GetOtherInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
private<span class="token punctuation">:</span>
    string m_performance<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>BaseVisitor.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"..\CommonDeclare\Convert.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"BaseVisitor.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>


CBaseVisitor<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CBaseVisitor</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    m_commonTotal <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    m_managerTotal <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


CBaseVisitor<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CBaseVisitor</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CBaseVisitor<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Visit</span><span class="token punctuation">(</span>CCommonEmployee commonEmployee<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> this<span class="token operator">-></span><span class="token function">GetCommonEmployee</span><span class="token punctuation">(</span>commonEmployee<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    this<span class="token operator">-></span><span class="token function">CalCommonSalary</span><span class="token punctuation">(</span>commonEmployee<span class="token punctuation">.</span><span class="token function">GetSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CBaseVisitor<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Visit</span><span class="token punctuation">(</span>CManager manager<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> this<span class="token operator">-></span><span class="token function">GetManagerInfo</span><span class="token punctuation">(</span>manager<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    this<span class="token operator">-></span><span class="token function">CalManagerSalary</span><span class="token punctuation">(</span>manager<span class="token punctuation">.</span><span class="token function">GetSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

string CBaseVisitor<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetBasicInfo</span><span class="token punctuation">(</span>CEmployee <span class="token operator">*</span>pemployee<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    string info <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
    info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"姓名："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>pemployee<span class="token operator">-></span><span class="token function">GetName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"\t"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"性别："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>CConvert<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">ToString</span><span class="token punctuation">(</span>pemployee<span class="token operator">-></span><span class="token function">GetSex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"\t"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"薪水："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>CConvert<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">ToString</span><span class="token punctuation">(</span>pemployee<span class="token operator">-></span><span class="token function">GetSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"\t"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> info<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

string CBaseVisitor<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetManagerInfo</span><span class="token punctuation">(</span>CManager manager<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    string basicInfo <span class="token operator">=</span> this<span class="token operator">-></span><span class="token function">GetBasicInfo</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>manager<span class="token punctuation">)</span><span class="token punctuation">;</span>
    string otherInfo <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
    otherInfo<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"业绩："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    otherInfo<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>manager<span class="token punctuation">.</span><span class="token function">GetPerformance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    otherInfo<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"\t"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    basicInfo<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>otherInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> basicInfo<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

string CBaseVisitor<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetCommonEmployee</span><span class="token punctuation">(</span>CCommonEmployee employee<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    string basicInfo <span class="token operator">=</span> this<span class="token operator">-></span><span class="token function">GetBasicInfo</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>employee<span class="token punctuation">)</span><span class="token punctuation">;</span>
    string otherInfo <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
    otherInfo<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"工作："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    otherInfo<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>employee<span class="token punctuation">.</span><span class="token function">GetJob</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    otherInfo<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"\t"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    basicInfo<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>otherInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> basicInfo<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> CBaseVisitor<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetTotalSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> this<span class="token operator">-></span>m_commonTotal <span class="token operator">+</span> this<span class="token operator">-></span>m_managerTotal<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CBaseVisitor<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CalCommonSalary</span><span class="token punctuation">(</span><span class="token keyword">int</span> salary<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    this<span class="token operator">-></span>m_commonTotal <span class="token operator">+</span><span class="token operator">=</span> salary<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CBaseVisitor<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CalManagerSalary</span><span class="token punctuation">(</span><span class="token keyword">int</span> salary<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    this<span class="token operator">-></span>m_managerTotal <span class="token operator">+</span><span class="token operator">=</span> salary<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>CommonEmployee.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"CommonEmployee.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>


CCommonEmployee<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CCommonEmployee</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    this<span class="token operator">-></span>m_job <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


CCommonEmployee<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CCommonEmployee</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>

string CCommonEmployee<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetJob</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> this<span class="token operator">-></span>m_job<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CCommonEmployee<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">SetJob</span><span class="token punctuation">(</span>string job<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    this<span class="token operator">-></span>m_job <span class="token operator">=</span> job<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

string CCommonEmployee<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetOtherInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    string job <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
    job<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"工作："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    job<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>this<span class="token operator">-></span>m_job<span class="token punctuation">)</span><span class="token punctuation">;</span>
    job<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"\t"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> job<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CCommonEmployee<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Accept</span><span class="token punctuation">(</span>IVisitor <span class="token operator">*</span>pVisitor<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    pVisitor<span class="token operator">-></span><span class="token function">Visit</span><span class="token punctuation">(</span><span class="token operator">*</span>this<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Employee.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Employee.h"</span></span>
<span class="token keyword">int</span> CEmployee<span class="token punctuation">:</span><span class="token punctuation">:</span>MALE <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> CEmployee<span class="token punctuation">:</span><span class="token punctuation">:</span>FEMALE <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

CEmployee<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CEmployee</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>


CEmployee<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CEmployee</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>

string CEmployee<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> m_name<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CEmployee<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">SetName</span><span class="token punctuation">(</span> string name <span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    m_name <span class="token operator">=</span> name<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> CEmployee<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> m_salary<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CEmployee<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">SetSalary</span><span class="token punctuation">(</span> <span class="token keyword">int</span> v <span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    m_salary <span class="token operator">=</span> v<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> CEmployee<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetSex</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> m_sex<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CEmployee<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">SetSex</span><span class="token punctuation">(</span> <span class="token keyword">int</span> v <span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    m_sex <span class="token operator">=</span> v<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Manager.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Manager.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>string<span class="token punctuation">;</span>


CManager<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CManager</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    this<span class="token operator">-></span>m_performance <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


CManager<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CManager</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>

string CManager<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetPerformance</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> m_performance<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CManager<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">SetPerformance</span><span class="token punctuation">(</span>string per<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    this<span class="token operator">-></span>m_performance <span class="token operator">=</span> per<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

string CManager<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetOtherInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    string info <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
    info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"业绩："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>this<span class="token operator">-></span>m_performance<span class="token punctuation">)</span><span class="token punctuation">;</span>
    info<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"\t"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> info<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CManager<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Accept</span><span class="token punctuation">(</span>IVisitor <span class="token operator">*</span>pVisitor<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    pVisitor<span class="token operator">-></span><span class="token function">Visit</span><span class="token punctuation">(</span><span class="token operator">*</span>this<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Visitor.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token comment" spellcheck="true">// Visitor.cpp : 定义控制台应用程序的入口点。</span>
<span class="token comment" spellcheck="true">//</span>

<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Employee.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"CommonEmployee.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Manager.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"BaseVisitor.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"..\CommonDeclare\Convert.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>vector<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>


<span class="token keyword">void</span> <span class="token function">MockEmployee</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>CEmployee<span class="token operator">*</span><span class="token operator">></span> <span class="token operator">*</span>pvce<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    CCommonEmployee <span class="token operator">*</span>pZhangSan <span class="token operator">=</span> new <span class="token function">CCommonEmployee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pZhangSan<span class="token operator">-></span><span class="token function">SetJob</span><span class="token punctuation">(</span><span class="token string">"编写Java程序，绝对的蓝领、苦工加搬运工"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pZhangSan<span class="token operator">-></span><span class="token function">SetName</span><span class="token punctuation">(</span><span class="token string">"张三"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pZhangSan<span class="token operator">-></span><span class="token function">SetSalary</span><span class="token punctuation">(</span><span class="token number">1800</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pZhangSan<span class="token operator">-></span><span class="token function">SetSex</span><span class="token punctuation">(</span>CEmployee<span class="token punctuation">:</span><span class="token punctuation">:</span>MALE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    pvce<span class="token operator">-></span><span class="token function">push_back</span><span class="token punctuation">(</span>pZhangSan<span class="token punctuation">)</span><span class="token punctuation">;</span>

    CCommonEmployee <span class="token operator">*</span>pLiSi <span class="token operator">=</span> new <span class="token function">CCommonEmployee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pLiSi<span class="token operator">-></span><span class="token function">SetJob</span><span class="token punctuation">(</span><span class="token string">"页面美工，审美素质太不流行了！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pLiSi<span class="token operator">-></span><span class="token function">SetName</span><span class="token punctuation">(</span><span class="token string">"李四"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pLiSi<span class="token operator">-></span><span class="token function">SetSalary</span><span class="token punctuation">(</span><span class="token number">1900</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pLiSi<span class="token operator">-></span><span class="token function">SetSex</span><span class="token punctuation">(</span>CEmployee<span class="token punctuation">:</span><span class="token punctuation">:</span>FEMALE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    pvce<span class="token operator">-></span><span class="token function">push_back</span><span class="token punctuation">(</span>pLiSi<span class="token punctuation">)</span><span class="token punctuation">;</span>

    CManager <span class="token operator">*</span>pWangWu <span class="token operator">=</span> new <span class="token function">CManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pWangWu<span class="token operator">-></span><span class="token function">SetPerformance</span><span class="token punctuation">(</span><span class="token string">"基本上是负值，但是我会拍马屁呀"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pWangWu<span class="token operator">-></span><span class="token function">SetName</span><span class="token punctuation">(</span><span class="token string">"王五"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pWangWu<span class="token operator">-></span><span class="token function">SetSalary</span><span class="token punctuation">(</span><span class="token number">1900</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pWangWu<span class="token operator">-></span><span class="token function">SetSex</span><span class="token punctuation">(</span>CEmployee<span class="token punctuation">:</span><span class="token punctuation">:</span>FEMALE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    pvce<span class="token operator">-></span><span class="token function">push_back</span><span class="token punctuation">(</span>pWangWu<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">void</span> <span class="token function">DoIt</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    vector<span class="token operator">&lt;</span>CEmployee<span class="token operator">*</span><span class="token operator">></span> vce<span class="token punctuation">;</span>
    <span class="token function">MockEmployee</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>vce<span class="token punctuation">)</span><span class="token punctuation">;</span>
    vector<span class="token operator">&lt;</span>CEmployee<span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">:</span><span class="token punctuation">:</span>const_iterator readIt <span class="token operator">=</span> vce<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    CBaseVisitor visitor<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> readIt <span class="token operator">!=</span> vce<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> readIt <span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token punctuation">(</span><span class="token operator">*</span>readIt<span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">Accept</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>visitor<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"本公司的月工资总额是："</span> <span class="token operator">&lt;&lt;</span> CConvert<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">ToString</span><span class="token punctuation">(</span>visitor<span class="token punctuation">.</span><span class="token function">GetTotalSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

    vector<span class="token operator">&lt;</span>CEmployee<span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">:</span><span class="token punctuation">:</span>reverse_iterator delIt <span class="token operator">=</span> vce<span class="token punctuation">.</span><span class="token function">rbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> delIt <span class="token operator">!=</span> vce<span class="token punctuation">.</span><span class="token function">rend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> delIt<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">delete</span> <span class="token punctuation">(</span><span class="token operator">*</span>delIt<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">(</span><span class="token operator">*</span>delIt<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    vce<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">DoIt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>姓名：张三      性别：0 薪水：1800      工作：编写Java程序，绝对的蓝领、苦工加搬运工
姓名：李四      性别：1 薪水：1900      工作：页面美工，审美素质太不流行了！
姓名：王五      性别：1 薪水：1900      业绩：基本上是负值，但是我会拍马屁呀
本公司的月工资总额是：5600    </code></pre><h2 id="状态模式"><a href="#状态模式" class="headerlink" title="状态模式"></a>状态模式</h2><blockquote>
<p>Allow an object to alter its behavior when its internal state changes.The object will appear to change its class.<br><br>当一个对象内在状态改变时允许其改变行为，这个对象看起来像改变了其类。</p>
</blockquote>
<p>main()，客户</p>
<p>CLiftState，电梯状态抽象类</p>
<p>CCloseingState，电梯门关闭</p>
<p>COpenningState，电梯门打开</p>
<p>CRunningState，电梯运行</p>
<p>CStoppingState，电梯停止</p>
<p>CContext，电梯的控制面板</p>
<p>说明：CContext保持电梯的状态，并提供操作的接口函数。当函数被调用时，CContext直接调用当前状态的相应函数。由状态的接口函数来确定是否可以执行这个动作，以及修改状态为执行这个动作后的状态。</p>
<p>看代码：第一块是不使用模式的做法，第二块是使用模式的做法，在main()函数里会有调用的方式。</p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1573351107501.png?x-oss-process=image/resize,m_lfit,h_450" alt="电梯的类图"></p>
<p>ILift.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
class ILift
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>

    <span class="token function">ILift</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    virtual <span class="token operator">~</span><span class="token function">ILift</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">int</span> OPENING_STATE <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">int</span> CLOSING_STATE <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">int</span> RUNNING_STATE <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">int</span> STOPPING_STATE <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">SetState</span><span class="token punctuation">(</span><span class="token keyword">int</span> state<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Lift.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ilift.h"</span></span>
class CLift <span class="token punctuation">:</span>
    public ILift
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CLift</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CLift</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">SetState</span><span class="token punctuation">(</span><span class="token keyword">int</span> state<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
private<span class="token punctuation">:</span>
    <span class="token keyword">int</span> m_state<span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">OpenWithoutLogic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">CloseWithoutLogic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">RunWithoutLogic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">StopWithoutLogic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Lift.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Lift.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>

CLift<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CLift</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    this<span class="token operator">-></span>m_state <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

CLift<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CLift</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CLift<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">SetState</span><span class="token punctuation">(</span><span class="token keyword">int</span> state<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    this<span class="token operator">-></span>m_state <span class="token operator">=</span> state<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CLift<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">switch</span><span class="token punctuation">(</span>this<span class="token operator">-></span>m_state<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token keyword">case</span> OPENING_STATE<span class="token punctuation">:</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> CLOSING_STATE<span class="token punctuation">:</span>
        this<span class="token operator">-></span><span class="token function">OpenWithoutLogic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        this<span class="token operator">-></span><span class="token function">SetState</span><span class="token punctuation">(</span>OPENING_STATE<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> RUNNING_STATE<span class="token punctuation">:</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> STOPPING_STATE<span class="token punctuation">:</span>
        this<span class="token operator">-></span><span class="token function">OpenWithoutLogic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        this<span class="token operator">-></span><span class="token function">SetState</span><span class="token punctuation">(</span>OPENING_STATE<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CLift<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">switch</span><span class="token punctuation">(</span>this<span class="token operator">-></span>m_state<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token keyword">case</span> OPENING_STATE<span class="token punctuation">:</span>
        this<span class="token operator">-></span><span class="token function">CloseWithoutLogic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        this<span class="token operator">-></span><span class="token function">SetState</span><span class="token punctuation">(</span>CLOSING_STATE<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> CLOSING_STATE<span class="token punctuation">:</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> RUNNING_STATE<span class="token punctuation">:</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> STOPPING_STATE<span class="token punctuation">:</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CLift<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">switch</span><span class="token punctuation">(</span>this<span class="token operator">-></span>m_state<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token keyword">case</span> OPENING_STATE<span class="token punctuation">:</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> CLOSING_STATE<span class="token punctuation">:</span>
        this<span class="token operator">-></span><span class="token function">RunWithoutLogic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        this<span class="token operator">-></span><span class="token function">SetState</span><span class="token punctuation">(</span>RUNNING_STATE<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> RUNNING_STATE<span class="token punctuation">:</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> STOPPING_STATE<span class="token punctuation">:</span>
        this<span class="token operator">-></span><span class="token function">RunWithoutLogic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        this<span class="token operator">-></span><span class="token function">SetState</span><span class="token punctuation">(</span>RUNNING_STATE<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CLift<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">switch</span><span class="token punctuation">(</span>this<span class="token operator">-></span>m_state<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token keyword">case</span> OPENING_STATE<span class="token punctuation">:</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> CLOSING_STATE<span class="token punctuation">:</span>
        this<span class="token operator">-></span><span class="token function">StopWithoutLogic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        this<span class="token operator">-></span><span class="token function">SetState</span><span class="token punctuation">(</span>CLOSING_STATE<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> RUNNING_STATE<span class="token punctuation">:</span>
        this<span class="token operator">-></span><span class="token function">StopWithoutLogic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        this<span class="token operator">-></span><span class="token function">SetState</span><span class="token punctuation">(</span>CLOSING_STATE<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> STOPPING_STATE<span class="token punctuation">:</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CLift<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">OpenWithoutLogic</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"电梯门开启..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CLift<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CloseWithoutLogic</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"电梯门关闭..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CLift<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">RunWithoutLogic</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"电梯上下跑起来..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CLift<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">StopWithoutLogic</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"电梯停止了..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>LiftState.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
class CContext<span class="token punctuation">;</span>
class CLiftState
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CLiftState</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    virtual <span class="token operator">~</span><span class="token function">CLiftState</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">SetContext</span><span class="token punctuation">(</span>CContext <span class="token operator">*</span>pContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
protected<span class="token punctuation">:</span>
    CContext <span class="token operator">*</span>m_pContext<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>LiftState.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"LiftState.h"</span></span>

CLiftState<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CLiftState</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>

CLiftState<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CLiftState</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CLiftState<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">SetContext</span><span class="token punctuation">(</span> CContext <span class="token operator">*</span>pContext <span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    m_pContext <span class="token operator">=</span> pContext<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>CloseingState.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"liftstate.h"</span></span>
class CCloseingState <span class="token punctuation">:</span>
    public CLiftState
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CCloseingState</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CCloseingState</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>CloseingState.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"CloseingState.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Context.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>

CCloseingState<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CCloseingState</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>

CCloseingState<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CCloseingState</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CCloseingState<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    this<span class="token operator">-></span>CLiftState<span class="token punctuation">:</span><span class="token punctuation">:</span>m_pContext<span class="token operator">-></span><span class="token function">SetLiftState</span><span class="token punctuation">(</span>CContext<span class="token punctuation">:</span><span class="token punctuation">:</span>pOpenningState<span class="token punctuation">)</span><span class="token punctuation">;</span>
    this<span class="token operator">-></span>CLiftState<span class="token punctuation">:</span><span class="token punctuation">:</span>m_pContext<span class="token operator">-></span><span class="token function">GetLiftState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CCloseingState<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"电梯门关闭..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CCloseingState<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    this<span class="token operator">-></span>CLiftState<span class="token punctuation">:</span><span class="token punctuation">:</span>m_pContext<span class="token operator">-></span><span class="token function">SetLiftState</span><span class="token punctuation">(</span>CContext<span class="token punctuation">:</span><span class="token punctuation">:</span>pRunningState<span class="token punctuation">)</span><span class="token punctuation">;</span>
    this<span class="token operator">-></span>CLiftState<span class="token punctuation">:</span><span class="token punctuation">:</span>m_pContext<span class="token operator">-></span><span class="token function">GetLiftState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CCloseingState<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    this<span class="token operator">-></span>CLiftState<span class="token punctuation">:</span><span class="token punctuation">:</span>m_pContext<span class="token operator">-></span><span class="token function">SetLiftState</span><span class="token punctuation">(</span>CContext<span class="token punctuation">:</span><span class="token punctuation">:</span>pStoppingState<span class="token punctuation">)</span><span class="token punctuation">;</span>
    this<span class="token operator">-></span>CLiftState<span class="token punctuation">:</span><span class="token punctuation">:</span>m_pContext<span class="token operator">-></span><span class="token function">GetLiftState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>OpenningState.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"liftstate.h"</span></span>
class COpenningState <span class="token punctuation">:</span>
    public CLiftState
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">COpenningState</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">COpenningState</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>OpenningState.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"OpenningState.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Context.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>

COpenningState<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">COpenningState</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>

COpenningState<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">COpenningState</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> COpenningState<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"电梯门开启..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> COpenningState<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    this<span class="token operator">-></span>CLiftState<span class="token punctuation">:</span><span class="token punctuation">:</span>m_pContext<span class="token operator">-></span><span class="token function">SetLiftState</span><span class="token punctuation">(</span>CContext<span class="token punctuation">:</span><span class="token punctuation">:</span>pCloseingState<span class="token punctuation">)</span><span class="token punctuation">;</span>
    this<span class="token operator">-></span>CLiftState<span class="token punctuation">:</span><span class="token punctuation">:</span>m_pContext<span class="token operator">-></span><span class="token function">GetLiftState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> COpenningState<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//do nothing</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> COpenningState<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//do nothing</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>RunningState.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"liftstate.h"</span></span>
class CRunningState <span class="token punctuation">:</span>
    public CLiftState
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CRunningState</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CRunningState</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>RunningState.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"RunningState.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Context.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>

CRunningState<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CRunningState</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>

CRunningState<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CRunningState</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CRunningState<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//do nothing</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CRunningState<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//do nothing</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CRunningState<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"电梯上下跑..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CRunningState<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    this<span class="token operator">-></span>CLiftState<span class="token punctuation">:</span><span class="token punctuation">:</span>m_pContext<span class="token operator">-></span><span class="token function">SetLiftState</span><span class="token punctuation">(</span>CContext<span class="token punctuation">:</span><span class="token punctuation">:</span>pStoppingState<span class="token punctuation">)</span><span class="token punctuation">;</span>
    this<span class="token operator">-></span>CLiftState<span class="token punctuation">:</span><span class="token punctuation">:</span>m_pContext<span class="token operator">-></span><span class="token function">GetLiftState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>StoppingState.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"liftstate.h"</span></span>
class CStoppingState <span class="token punctuation">:</span>
    public CLiftState
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CStoppingState</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CStoppingState</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>StoppingState.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"StoppingState.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Context.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>

CStoppingState<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CStoppingState</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>

CStoppingState<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CStoppingState</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CStoppingState<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    this<span class="token operator">-></span>CLiftState<span class="token punctuation">:</span><span class="token punctuation">:</span>m_pContext<span class="token operator">-></span><span class="token function">SetLiftState</span><span class="token punctuation">(</span>CContext<span class="token punctuation">:</span><span class="token punctuation">:</span>pOpenningState<span class="token punctuation">)</span><span class="token punctuation">;</span>
    this<span class="token operator">-></span>CLiftState<span class="token punctuation">:</span><span class="token punctuation">:</span>m_pContext<span class="token operator">-></span><span class="token function">GetLiftState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CStoppingState<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//do nothing</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CStoppingState<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    this<span class="token operator">-></span>CLiftState<span class="token punctuation">:</span><span class="token punctuation">:</span>m_pContext<span class="token operator">-></span><span class="token function">SetLiftState</span><span class="token punctuation">(</span>CContext<span class="token punctuation">:</span><span class="token punctuation">:</span>pRunningState<span class="token punctuation">)</span><span class="token punctuation">;</span>
    this<span class="token operator">-></span>CLiftState<span class="token punctuation">:</span><span class="token punctuation">:</span>m_pContext<span class="token operator">-></span><span class="token function">GetLiftState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CStoppingState<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"电梯停止了..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Context.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"LiftState.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"OpenningState.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"CloseingState.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"RunningState.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"StoppingState.h"</span></span>
class CContext
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CContext</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CContext</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">static</span> COpenningState <span class="token operator">*</span>pOpenningState<span class="token punctuation">;</span>
    <span class="token keyword">static</span> CCloseingState <span class="token operator">*</span>pCloseingState<span class="token punctuation">;</span>
    <span class="token keyword">static</span> CRunningState <span class="token operator">*</span>pRunningState<span class="token punctuation">;</span>
    <span class="token keyword">static</span> CStoppingState <span class="token operator">*</span>pStoppingState<span class="token punctuation">;</span>
    CLiftState <span class="token operator">*</span> <span class="token function">GetLiftState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">SetLiftState</span><span class="token punctuation">(</span>CLiftState <span class="token operator">*</span>pLiftState<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
private<span class="token punctuation">:</span>
    CLiftState <span class="token operator">*</span>m_pLiftState<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Context.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Context.h"</span></span>
COpenningState<span class="token operator">*</span> CContext<span class="token punctuation">:</span><span class="token punctuation">:</span>pOpenningState <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
CCloseingState<span class="token operator">*</span> CContext<span class="token punctuation">:</span><span class="token punctuation">:</span>pCloseingState <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
CRunningState<span class="token operator">*</span> CContext<span class="token punctuation">:</span><span class="token punctuation">:</span>pRunningState <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
CStoppingState<span class="token operator">*</span> CContext<span class="token punctuation">:</span><span class="token punctuation">:</span>pStoppingState <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

CContext<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CContext</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    m_pLiftState <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    pOpenningState <span class="token operator">=</span> new <span class="token function">COpenningState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pCloseingState <span class="token operator">=</span> new <span class="token function">CCloseingState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pRunningState <span class="token operator">=</span> new <span class="token function">CRunningState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pStoppingState <span class="token operator">=</span> new <span class="token function">CStoppingState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

CContext<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CContext</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    delete pOpenningState<span class="token punctuation">;</span>
    pOpenningState <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    delete pCloseingState<span class="token punctuation">;</span>
    pCloseingState <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    delete pRunningState<span class="token punctuation">;</span>
    pRunningState <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    delete pStoppingState<span class="token punctuation">;</span>
    pStoppingState <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

CLiftState <span class="token operator">*</span> CContext<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">GetLiftState</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> m_pLiftState<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CContext<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">SetLiftState</span><span class="token punctuation">(</span>CLiftState <span class="token operator">*</span>pLiftState<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    this<span class="token operator">-></span>m_pLiftState <span class="token operator">=</span> pLiftState<span class="token punctuation">;</span>
    this<span class="token operator">-></span>m_pLiftState<span class="token operator">-></span><span class="token function">SetContext</span><span class="token punctuation">(</span>this<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CContext<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    this<span class="token operator">-></span>m_pLiftState<span class="token operator">-></span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CContext<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    this<span class="token operator">-></span>m_pLiftState<span class="token operator">-></span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CContext<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    this<span class="token operator">-></span>m_pLiftState<span class="token operator">-></span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> CContext<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    this<span class="token operator">-></span>m_pLiftState<span class="token operator">-></span><span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>// State.cpp : 定义控制台应用程序的入口点。</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ILift.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Lift.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Context.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"OpenningState.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"CloseingState.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"RunningState.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"StoppingState.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">DoIt</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    ILift<span class="token punctuation">.</span>h<span class="token punctuation">,</span> Lift<span class="token punctuation">.</span>h<span class="token punctuation">,</span> Lift<span class="token punctuation">.</span>cpp
    ILift <span class="token operator">*</span>pLift <span class="token operator">=</span> new <span class="token function">CLift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pLift<span class="token operator">-></span><span class="token function">SetState</span><span class="token punctuation">(</span>ILift<span class="token punctuation">:</span><span class="token punctuation">:</span>STOPPING_STATE<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//电梯的初始条件是停止状态。</span>
    pLift<span class="token operator">-></span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//首先是电梯门开启，人进去</span>
    pLift<span class="token operator">-></span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//然后电梯门关闭</span>
    pLift<span class="token operator">-></span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//再然后，电梯跑起来，向上或者向下</span>
    pLift<span class="token operator">-></span><span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//最后到达目的地，电梯停下来</span>
    delete pLift<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">void</span> <span class="token function">DoNew</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    LiftState<span class="token punctuation">.</span>h<span class="token punctuation">,</span> LiftState<span class="token punctuation">.</span>cpp<span class="token punctuation">,</span> OpenningState<span class="token punctuation">.</span>h<span class="token punctuation">,</span> CloseingState<span class="token punctuation">.</span>h<span class="token punctuation">,</span> RunningState<span class="token punctuation">.</span>h<span class="token punctuation">,</span> StoppingState<span class="token punctuation">.</span>h
    Context<span class="token punctuation">.</span>h<span class="token punctuation">,</span> Context<span class="token punctuation">.</span>cpp
    CContext context<span class="token punctuation">;</span>
    CCloseingState closeingState<span class="token punctuation">;</span>
    context<span class="token punctuation">.</span><span class="token function">SetLiftState</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>closeingState<span class="token punctuation">)</span><span class="token punctuation">;</span>
    context<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    context<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    context<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    context<span class="token punctuation">.</span><span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"----------使用模式之前----------"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token function">DoIt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"----------使用模式之后----------"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token function">DoNew</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">_CrtSetDbgFlag</span><span class="token punctuation">(</span>_CRTDBG_LEAK_CHECK_DF <span class="token operator">|</span> _CRTDBG_ALLOC_MEM_DF<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">_CrtDumpMemoryLeaks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>----------使用模式之前----------
电梯门开启...
电梯门关闭...
电梯上下跑起来...
电梯停止了...
----------使用模式之后----------
电梯门关闭...
电梯门开启...     </code></pre><h2 id="解释器模式"><a href="#解释器模式" class="headerlink" title="解释器模式"></a>解释器模式</h2><blockquote>
<p>Given a language, define a representation for its grammar along with an interpreter that uses the representation to interpret sentences in the language.<br><br>给定一门语言，定义它的文法的一种表示，并定义一个解释器，该解释器使用该表示来解释语言中的句子。</p>
</blockquote>
<h2 id="享元模式"><a href="#享元模式" class="headerlink" title="享元模式"></a>享元模式</h2><blockquote>
<p>Use sharing to support large numbers of fine-grained objects efficiently.<br><br>使用共享对象可有效地支持大量的细粒度的对象。</p>
</blockquote>
<h2 id="桥梁模式"><a href="#桥梁模式" class="headerlink" title="桥梁模式"></a>桥梁模式</h2><blockquote>
<p>Decouple an abstraction from its implementation so that the two can vary independently.<br><br>将抽象和实现解耦，使得两者可以独立地变化。</p>
</blockquote>
<hr>

<p>main()，客户</p>
<p>IProduct，产品接口</p>
<p>CHouse，房子</p>
<p>CIPod，ipod</p>
<p>CClothes，服装</p>
<p>CNewCorp，桥梁类，MakeMoney()是桥梁方法</p>
<p>CNewHouseCorp，只能生产房子，所以构造函数是CHouse*</p>
<p>CShanZhaiCorp，什么赚钱就生产什么，所以构造函数是IProduct*</p>
<p>说明：客户直接使用CNewHouseCorp和CShanZhaiCorp类，在main()函数里构造产品，然后传到这两个类里。这两个类的MakeMoney()函数，先调用基类的MakeMoney()，然后分别执行各自的逻辑。</p>
<p>注意：CNewCorp起到了桥梁的作用。可以分别增加产品和公司。</p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1573316097217.png?x-oss-process=image/resize,m_lfit,h_450" alt="使用快速变化的类图"></p>
<p>NewCorp.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"IProduct.h"</span></span>
class CNewCorp
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CNewCorp</span><span class="token punctuation">(</span>IProduct <span class="token operator">*</span>pproduct<span class="token punctuation">)</span><span class="token punctuation">;</span>
    virtual <span class="token operator">~</span><span class="token function">CNewCorp</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">MakeMoney</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
private<span class="token punctuation">:</span>
    IProduct <span class="token operator">*</span>m_pProduct<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>NewCorp.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"NewCorp.h"</span></span>
CNewCorp<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CNewCorp</span><span class="token punctuation">(</span> IProduct <span class="token operator">*</span>pproduct <span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    this<span class="token operator">-></span>m_pProduct <span class="token operator">=</span> pproduct<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
CNewCorp<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CNewCorp</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CNewCorp<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">MakeMoney</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//每个公司都是一样，先生产</span>
    this<span class="token operator">-></span>m_pProduct<span class="token operator">-></span><span class="token function">BeProducted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">//然后销售</span>
    this<span class="token operator">-></span>m_pProduct<span class="token operator">-></span><span class="token function">BeSelled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>NewHouseCorp.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"newcorp.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"House.h"</span></span>
class CNewHouseCorp <span class="token punctuation">:</span>
    public CNewCorp
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CNewHouseCorp</span><span class="token punctuation">(</span>CHouse <span class="token operator">*</span>pHouse<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CNewHouseCorp</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">MakeMoney</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>NewHouseCorp.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"NewHouseCorp.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
CNewHouseCorp<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CNewHouseCorp</span><span class="token punctuation">(</span>CHouse <span class="token operator">*</span>pHouse<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token function">CNewCorp</span><span class="token punctuation">(</span>pHouse<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
CNewHouseCorp<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CNewHouseCorp</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CNewHouseCorp<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">MakeMoney</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    this<span class="token operator">-></span>CNewCorp<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">MakeMoney</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"房地产公司赚大钱了..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ShanZhaiCorp.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"newcorp.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"IProduct.h"</span></span>
class CShanZhaiCorp <span class="token punctuation">:</span>
    public CNewCorp
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CShanZhaiCorp</span><span class="token punctuation">(</span>IProduct <span class="token operator">*</span>pproduct<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CShanZhaiCorp</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">MakeMoney</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ShanZhaiCorp.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ShanZhaiCorp.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
CShanZhaiCorp<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CShanZhaiCorp</span><span class="token punctuation">(</span>IProduct <span class="token operator">*</span>pproduct<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token function">CNewCorp</span><span class="token punctuation">(</span>pproduct<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
CShanZhaiCorp<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CShanZhaiCorp</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CShanZhaiCorp<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">MakeMoney</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    this<span class="token operator">-></span>CNewCorp<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">MakeMoney</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"我赚钱呀..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>IProduct.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
class IProduct
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">IProduct</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    virtual <span class="token operator">~</span><span class="token function">IProduct</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    virtual <span class="token keyword">void</span> <span class="token function">BeProducted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    virtual <span class="token keyword">void</span> <span class="token function">BeSelled</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>House.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"iproduct.h"</span></span>
class CHouse <span class="token punctuation">:</span>
    public IProduct
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CHouse</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CHouse</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">BeProducted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">BeSelled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>House.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"House.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
CHouse<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CHouse</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
CHouse<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CHouse</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CHouse<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">BeProducted</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"生产出的房子是这个样子的..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CHouse<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">BeSelled</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"生产出的房子卖出去了..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Clothes.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"iproduct.h"</span></span>
class CClothes <span class="token punctuation">:</span>
    public IProduct
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CClothes</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CClothes</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">BeProducted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">BeSelled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Clothes.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Clothes.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
CClothes<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CClothes</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
CClothes<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CClothes</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CClothes<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">BeProducted</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"生产出的衣服是这个样子的..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CClothes<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">BeSelled</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"生产出的衣服卖出去了..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>IPod.h</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">pragma</span> once</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"iproduct.h"</span></span>
class CIPod <span class="token punctuation">:</span>
    public IProduct
<span class="token punctuation">{</span>
public<span class="token punctuation">:</span>
    <span class="token function">CIPod</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CIPod</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">BeProducted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">BeSelled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>IPod.cpp</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"IPod.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>
CIPod<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">CIPod</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
CIPod<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">~</span><span class="token function">CIPod</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CIPod<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">BeProducted</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"生产出的ipod是这个样子的..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> CIPod<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">BeSelled</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"生产出的ipod卖出去了..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>// Bridge.cpp : 定义控制台应用程序的入口点。</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"NewHouseCorp.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Clothes.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"IPod.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ShanZhaiCorp.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>cout<span class="token punctuation">;</span>
using std<span class="token punctuation">:</span><span class="token punctuation">:</span>endl<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">DoNewRun1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"----------房地产公司是这样运行的----------"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    CHouse house<span class="token punctuation">;</span>
    CNewHouseCorp <span class="token function">newHouseCorp</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>house<span class="token punctuation">)</span><span class="token punctuation">;</span>
    newHouseCorp<span class="token punctuation">.</span><span class="token function">MakeMoney</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"----------山寨公司是这样运行的----------"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    CClothes clothes<span class="token punctuation">;</span>
    CShanZhaiCorp <span class="token function">shanZhaiCorp</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>clothes<span class="token punctuation">)</span><span class="token punctuation">;</span>
    shanZhaiCorp<span class="token punctuation">.</span><span class="token function">MakeMoney</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">DoNewRun2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"----------房地产公司是这样运行的----------"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    CHouse house<span class="token punctuation">;</span>
    CNewHouseCorp <span class="token function">newHouseCorp</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>house<span class="token punctuation">)</span><span class="token punctuation">;</span>
    newHouseCorp<span class="token punctuation">.</span><span class="token function">MakeMoney</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"----------山寨公司是这样运行的----------"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    CIPod ipod<span class="token punctuation">;</span>
    CShanZhaiCorp <span class="token function">shanZhaiCorp</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>ipod<span class="token punctuation">)</span><span class="token punctuation">;</span>
    shanZhaiCorp<span class="token punctuation">.</span><span class="token function">MakeMoney</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//只有两家公司，一家是房地产公司，另一家公司是衣服赚钱就生产衣服</span>
    <span class="token function">DoNewRun1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">//只有两家公司，一家是房地产公司，另一家公司是ipod赚钱就生产ipod</span>
    <span class="token function">DoNewRun2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">_CrtSetDbgFlag</span><span class="token punctuation">(</span>_CRTDBG_LEAK_CHECK_DF <span class="token operator">|</span> _CRTDBG_ALLOC_MEM_DF<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">_CrtDumpMemoryLeaks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>----------房地产公司是这样运行的----------
生产出的房子是这个样子的...
生产出的房子卖出去了...
房地产公司赚大钱了...
----------山寨公司是这样运行的----------
生产出的衣服是这个样子的...
生产出的衣服卖出去了...
我赚钱呀...
----------房地产公司是这样运行的----------
生产出的房子是这个样子的...
生产出的房子卖出去了...
房地产公司赚大钱了...
----------山寨公司是这样运行的----------
生产出的ipod是这个样子的...
生产出的ipod卖出去了...
我赚钱呀...  </code></pre><h1 id="消息总线"><a href="#消息总线" class="headerlink" title="消息总线"></a>消息总线</h1><h2 id="什么是消息总线？"><a href="#什么是消息总线？" class="headerlink" title="什么是消息总线？"></a>什么是消息总线？</h2><p>对象的关系之间一般有：依赖、关联、聚合、组合和继承，他们的耦合程度也是依次加强！大规模开发过程中，对象很多，关联关系很复杂，没有统一、简介的方法去管理对象的关系将会导致对象关系和蜘蛛网一样，或者循环依赖问题。<br>基于消息总线技术可以有效解决这些问题，对象通过消息联系而不是直接依赖或者关联。</p>
<h2 id="消息总线的关键技术"><a href="#消息总线的关键技术" class="headerlink" title="消息总线的关键技术"></a>消息总线的关键技术</h2><ul>
<li>通用的消息类型</li>
<li>消息注册</li>
<li>消息分发</li>
</ul>
<h2 id="通用的消息定义"><a href="#通用的消息定义" class="headerlink" title="通用的消息定义"></a>通用的消息定义</h2><p>我们需要一种泛型的函数签名来定义成一个通用的消息格式。同时需要我们可以还需要定义一个主题类型，让订阅该主题的接受者接收此消息。<br>我们可以使用：std::function&lt;Ret(Args…)&gt;作为通用的函数签名。</p>
<h2 id="消息的注册"><a href="#消息的注册" class="headerlink" title="消息的注册"></a>消息的注册</h2><p>总线内部维护了一个消息列表，当需要发送消息时，会遍历消息列表，从中查找是否有合适的消息和消息接收者，找到合适的接受者之后再次广播。<br>消息由：消息主题+泛型函数组成。topic + std::function&lt;Ret(Args…)&gt;这个泛型函数可能是所有的可调用对象，例如：普通函数、成员函数、函数对象、std::function和lambda表达式。消息的统一格式为std::function&lt;Ret(Args…)&gt;所以首先应该讲各种调用类型转换成该类型，格式统一后就可以将消息保存起来，以便后续分发（保存消息的方法见后面章节）。<br>接下来我们实现一个函数类型萃取的对下。</p>
<h2 id="普通函数转换为std-function"><a href="#普通函数转换为std-function" class="headerlink" title="普通函数转换为std::function"></a>普通函数转换为std::function</h2><pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">//前置声明</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> T<span class="token operator">></span>
<span class="token keyword">struct</span> function_traits<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//普通函数</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> Ret<span class="token punctuation">,</span> <span class="token keyword">typename</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>Args<span class="token operator">></span>
<span class="token keyword">struct</span> function_traits<span class="token operator">&lt;</span><span class="token function">Ret</span><span class="token punctuation">(</span>Args<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token operator">></span>
<span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">enum</span> <span class="token punctuation">{</span>arity <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">(</span>Args<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//获取参数数量</span>
    <span class="token keyword">typedef</span> Ret <span class="token function">function_type</span><span class="token punctuation">(</span>Args<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//定义函数类型</span>
    <span class="token keyword">typedef</span> Ret return_type<span class="token punctuation">;</span>            
    <span class="token keyword">using</span> stl_function_type <span class="token operator">=</span> std<span class="token operator">::</span>function<span class="token operator">&lt;</span>function_type<span class="token operator">></span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//stl function类型  lambda可转换成stl function</span>
    <span class="token keyword">typedef</span> <span class="token function">Ret</span><span class="token punctuation">(</span><span class="token operator">*</span>pointer<span class="token punctuation">)</span><span class="token punctuation">(</span>Args<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">template</span><span class="token operator">&lt;</span>size_t I<span class="token operator">></span>
    <span class="token keyword">struct</span> args
    <span class="token punctuation">{</span>
        <span class="token keyword">static_assert</span><span class="token punctuation">(</span>I <span class="token operator">&lt;</span> arity<span class="token punctuation">,</span> <span class="token string">"index is out of range"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">//类似bind(_Binder) 源码实现,保存参数并且随时可用.</span>
        <span class="token keyword">using</span> type <span class="token operator">=</span> <span class="token keyword">typename</span> std<span class="token operator">::</span>tuple_element<span class="token operator">&lt;</span>I<span class="token punctuation">,</span> std<span class="token operator">::</span>tuple<span class="token operator">&lt;</span>Args<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">>></span><span class="token operator">::</span>type<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="函数指针转换为std-function"><a href="#函数指针转换为std-function" class="headerlink" title="函数指针转换为std::function"></a>函数指针转换为std::function</h2><p>函数指针，通常在C语言中经常使用，他的声明方式通常如下：</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">void</span><span class="token punctuation">(</span><span class="token operator">*</span>PFUNC<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>所以为了我们的函数类型萃取支持函数指针，我们需要将其返回值和入参提取出来。<br>具体实现如下：</p>
<pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">//函数指针</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> Ret<span class="token punctuation">,</span> <span class="token keyword">typename</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>Args<span class="token operator">></span>
<span class="token keyword">struct</span> function_traits<span class="token operator">&lt;</span><span class="token function">Ret</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>Args<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token operator">></span>
    <span class="token operator">:</span> <span class="token keyword">public</span> function_traits<span class="token operator">&lt;</span><span class="token function">Ret</span><span class="token punctuation">(</span>Args<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token operator">></span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="提取std-function类"><a href="#提取std-function类" class="headerlink" title="提取std::function类"></a>提取std::function类</h2><p>这个就比较容易了，入参和返回值直接提取即可。</p>
<pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">//std functional</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> Ret<span class="token punctuation">,</span> <span class="token keyword">typename</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>Args<span class="token operator">></span>
<span class="token keyword">struct</span> function_traits<span class="token operator">&lt;</span>std<span class="token operator">::</span>function<span class="token operator">&lt;</span><span class="token function">Ret</span><span class="token punctuation">(</span>Args<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token operator">>></span>
    <span class="token operator">:</span> <span class="token keyword">public</span> function_traits<span class="token operator">&lt;</span><span class="token function">Ret</span><span class="token punctuation">(</span>Args<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token operator">></span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="成员函数转换为std-function"><a href="#成员函数转换为std-function" class="headerlink" title="成员函数转换为std::function"></a>成员函数转换为std::function</h2><p>这里需要特别注意的是，成员函数的调用一定是要有具体对象调用的。除非这个函数是静态函数（这个和普通函数类似）。所以我们需要函数类型和具体的调用对象。</p>
<pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">//直接根据参数调用</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> ReturnType<span class="token punctuation">,</span> <span class="token keyword">typename</span> ClassType<span class="token punctuation">,</span> <span class="token keyword">typename</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>Args<span class="token operator">></span>
<span class="token keyword">void</span>  <span class="token function">help1</span><span class="token punctuation">(</span><span class="token function">ReturnType</span><span class="token punctuation">(</span>ClassType<span class="token operator">::</span><span class="token operator">*</span>f<span class="token punctuation">)</span><span class="token punctuation">(</span>Args<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ClassType<span class="token operator">&amp;</span> obj<span class="token punctuation">,</span> Args<span class="token operator">&amp;&amp;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>args<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    std<span class="token operator">::</span>function<span class="token operator">&lt;</span><span class="token function">ReturnType</span><span class="token punctuation">(</span>Args<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token operator">></span> func <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">&amp;</span>obj<span class="token punctuation">,</span> f<span class="token punctuation">,</span> <span class="token operator">&amp;</span>args<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">(</span>Args<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token operator">*</span>f<span class="token punctuation">)</span><span class="token punctuation">(</span>std<span class="token operator">::</span>forward<span class="token operator">&lt;</span>Args<span class="token operator">></span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token function">func</span><span class="token punctuation">(</span>std<span class="token operator">::</span>forward<span class="token operator">&lt;</span>Args<span class="token operator">></span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//返回可调用实体  此时Args可由具体调用时传入</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> ReturnType<span class="token punctuation">,</span> <span class="token keyword">typename</span> ClassType<span class="token punctuation">,</span> <span class="token keyword">typename</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>Args<span class="token operator">></span>
std<span class="token operator">::</span>function<span class="token operator">&lt;</span><span class="token function">ReturnType</span><span class="token punctuation">(</span>Args<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token operator">></span>  <span class="token function">help2</span><span class="token punctuation">(</span><span class="token function">ReturnType</span><span class="token punctuation">(</span>ClassType<span class="token operator">::</span><span class="token operator">*</span>f<span class="token punctuation">)</span><span class="token punctuation">(</span>Args<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ClassType<span class="token operator">&amp;</span> obj<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    std<span class="token operator">::</span>function<span class="token operator">&lt;</span><span class="token function">ReturnType</span><span class="token punctuation">(</span>Args<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token operator">></span> func <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">&amp;</span>obj<span class="token punctuation">,</span> f<span class="token punctuation">]</span><span class="token punctuation">(</span>Args<span class="token operator">&amp;&amp;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token operator">*</span>f<span class="token punctuation">)</span><span class="token punctuation">(</span>std<span class="token operator">::</span>forward<span class="token operator">&lt;</span>Args<span class="token operator">></span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//func(std::forward&lt;Args>(args)...);</span>
    <span class="token keyword">return</span> func<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="成员函数转换为std-function的更多细节"><a href="#成员函数转换为std-function的更多细节" class="headerlink" title="成员函数转换为std::function的更多细节"></a>成员函数转换为std::function的更多细节</h2><p>刚刚我们事先的成员函数虽然支持不同入参和返回类型，但是函数类型例如const类型的函数，并没有支持。接下里需要实现包含不同限定类型的函数。我们可使用宏定义的方式（此方法在标准库、STL库中多次被使用）实现。</p>
<pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">//member functional</span>
<span class="token macro property">#<span class="token directive keyword">define</span> FUNCTION_TRAITS(...) \
template&lt;typename ReturnType, typename ClassType, typename...Args> \
struct function_traits&lt;ReturnType(ClassType::*)(Args...) __VA_ARGS__> : \
function_traits&lt;ReturnType(Args...)>{}; \
</span>
<span class="token function">FUNCTION_TRAITS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">FUNCTION_TRAITS</span><span class="token punctuation">(</span><span class="token keyword">const</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">FUNCTION_TRAITS</span><span class="token punctuation">(</span><span class="token keyword">volatile</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">FUNCTION_TRAITS</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">volatile</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>可以看到将const等类型扩展到函数限定符位置。</p>
<h2 id="可调用对象转换为std-function"><a href="#可调用对象转换为std-function" class="headerlink" title="可调用对象转换为std::function"></a>可调用对象转换为std::function</h2><pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token keyword">struct</span> CallObject
<span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token keyword">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"CallObject"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//函数对象 模板实现时需要具体对象类型</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> Callable<span class="token operator">></span>
<span class="token keyword">struct</span> function_traits <span class="token operator">:</span> function_traits<span class="token operator">&lt;</span><span class="token keyword">decltype</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Callable<span class="token operator">::</span><span class="token keyword">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">></span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">testFunctionObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">auto</span> f <span class="token operator">=</span> <span class="token function">to_function</span><span class="token punctuation">(</span><span class="token function">CallObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//转换为std::function</span>
    <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="将各类可调用对象转换为std-function函数实现"><a href="#将各类可调用对象转换为std-function函数实现" class="headerlink" title="将各类可调用对象转换为std::function函数实现"></a>将各类可调用对象转换为std::function函数实现</h2><pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token comment" spellcheck="true">//转换成stl的function</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> Function<span class="token operator">></span>
<span class="token keyword">typename</span> function_traits<span class="token operator">&lt;</span>Function<span class="token operator">></span><span class="token operator">::</span>stl_function_type <span class="token function">to_function</span><span class="token punctuation">(</span><span class="token keyword">const</span> Function<span class="token operator">&amp;</span> lambda<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">static_cast</span><span class="token operator">&lt;</span>function_traits<span class="token operator">&lt;</span>Function<span class="token operator">></span><span class="token operator">::</span>stl_function_type<span class="token operator">></span><span class="token punctuation">(</span>lambda<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> Function<span class="token operator">></span>
<span class="token keyword">typename</span> function_traits<span class="token operator">&lt;</span>Function<span class="token operator">></span><span class="token operator">::</span>stl_function_type <span class="token function">to_function</span><span class="token punctuation">(</span>Function<span class="token operator">&amp;&amp;</span> lambda<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">static_cast</span><span class="token operator">&lt;</span>function_traits<span class="token operator">&lt;</span>Function<span class="token operator">></span><span class="token operator">::</span>stl_function_type<span class="token operator">></span><span class="token punctuation">(</span>std<span class="token operator">::</span>forward<span class="token operator">&lt;</span>Function<span class="token operator">></span><span class="token punctuation">(</span>lambda<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//转换成仿函数指针</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> Function<span class="token operator">></span>
<span class="token keyword">typename</span> function_traits<span class="token operator">&lt;</span>Function<span class="token operator">></span><span class="token operator">::</span>pointer <span class="token function">to_function_pointer</span><span class="token punctuation">(</span><span class="token keyword">const</span> Function<span class="token operator">&amp;</span> lambda<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">static_cast</span><span class="token operator">&lt;</span>function_traits<span class="token operator">&lt;</span>Function<span class="token operator">></span><span class="token operator">::</span>pointer<span class="token operator">></span><span class="token punctuation">(</span>lambda<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>通过以上方式我们可以实现一个接受泛型类型的消息，接下里我们需要将各类消息保存起来，以便分发调用。<br>下面介绍消息保存和分发。</p>
<p>消息保存：由于消息类型有不同的返回值以及入参，这里可以使用之前介绍的Any作为消息载体<br>消息分发：这个就比较容易了，取出合适的函数对象（消息）直接调用即可</p>
<h2 id="消息总线设计思想"><a href="#消息总线设计思想" class="headerlink" title="消息总线设计思想"></a>消息总线设计思想</h2><p>消息总线融和了观察者和中介者模式，通过类型擦除擦除具体消息类型（Any）。观察者模式用来维护主题和适当的时候向观察者广播消息。中介者模式主要用来降低观察者模式互相依赖产生的耦合性。<br>消息总线维护的消息体是所有类型的可调用对象，没有对象之间的直接调用，更没有接口继承，主题和观察者仅仅是通过某种类型的消息联系起来，这个消息就是简单的返回值类型和入参。</p>
<p>下图是消息总线时序图，很好的说明的消息总线工作原理（来自原书）<br><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://pagepig.oss-cn-hangzhou.aliyuncs.com/20180918221836424.png?x-oss-process=image/resize,m_lfit,h_450" alt="消息总线时序图"></p>
<p>其中主要的几个点就是：<br>1.观察者注册消息体<br>2.消息总线保存消息体<br>3.主题对象发送消息<br>4.消息总线调用合适主题的消息体<br>5.观察者收到消息并处理</p>
<h2 id="完整的消息总线"><a href="#完整的消息总线" class="headerlink" title="完整的消息总线"></a>完整的消息总线</h2><pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">MessageBus</span>
<span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token comment" spellcheck="true">//注册消息</span>
    <span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> F<span class="token operator">></span>
    <span class="token keyword">void</span> <span class="token function">attach</span><span class="token punctuation">(</span>F<span class="token operator">&amp;&amp;</span> f<span class="token punctuation">,</span> <span class="token keyword">const</span> string<span class="token operator">&amp;</span> topic <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">auto</span> func <span class="token operator">=</span> <span class="token function">to_function</span><span class="token punctuation">(</span>std<span class="token operator">::</span>forward<span class="token operator">&lt;</span>F<span class="token operator">></span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">add</span><span class="token punctuation">(</span>topic<span class="token punctuation">,</span> std<span class="token operator">::</span><span class="token function">move</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">//发送消息 没有参数</span>
    <span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> R<span class="token operator">></span>
    <span class="token keyword">void</span> <span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> topic <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">using</span> function_type <span class="token operator">=</span> std<span class="token operator">::</span>function<span class="token operator">&lt;</span><span class="token function">R</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token punctuation">;</span>
        string strMsg <span class="token operator">=</span> topic <span class="token operator">+</span> <span class="token keyword">typeid</span><span class="token punctuation">(</span>function_type<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">auto</span> range <span class="token operator">=</span> m_map<span class="token punctuation">.</span><span class="token function">equal_range</span><span class="token punctuation">(</span>strMsg<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> iter <span class="token operator">=</span> range<span class="token punctuation">.</span>first<span class="token punctuation">;</span> iter <span class="token operator">!=</span> range<span class="token punctuation">.</span>second<span class="token punctuation">;</span> <span class="token operator">++</span>iter<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">auto</span> f <span class="token operator">=</span> iter<span class="token operator">-</span><span class="token operator">></span>second<span class="token punctuation">.</span>cast<span class="token operator">&lt;</span>function_type<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment" spellcheck="true">//发送消息 有参数</span>
    <span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> R<span class="token punctuation">,</span> <span class="token keyword">typename</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> Args<span class="token operator">></span>
    <span class="token keyword">void</span> <span class="token function">send</span><span class="token punctuation">(</span>Args<span class="token operator">&amp;&amp;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>args<span class="token punctuation">,</span> <span class="token keyword">const</span> string<span class="token operator">&amp;</span> topic <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">using</span> function_type <span class="token operator">=</span> std<span class="token operator">::</span>function<span class="token operator">&lt;</span><span class="token function">R</span><span class="token punctuation">(</span>Args<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token punctuation">;</span>
        string strMsg <span class="token operator">=</span> topic <span class="token operator">+</span> <span class="token keyword">typeid</span><span class="token punctuation">(</span>function_type<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">auto</span> range <span class="token operator">=</span> m_map<span class="token punctuation">.</span><span class="token function">equal_range</span><span class="token punctuation">(</span>strMsg<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> iter <span class="token operator">=</span> range<span class="token punctuation">.</span>first<span class="token punctuation">;</span> iter <span class="token operator">!=</span> range<span class="token punctuation">.</span>second<span class="token punctuation">;</span> <span class="token operator">++</span>iter<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">auto</span> f <span class="token operator">=</span> iter<span class="token operator">-</span><span class="token operator">></span>second<span class="token punctuation">.</span>cast<span class="token operator">&lt;</span>function_type<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">f</span><span class="token punctuation">(</span>std<span class="token operator">::</span>forward<span class="token operator">&lt;</span>Args<span class="token operator">></span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment" spellcheck="true">//移除某个主题 需要主题和消息类型</span>
    <span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> R<span class="token punctuation">,</span> <span class="token keyword">typename</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> Args<span class="token operator">></span>
    <span class="token keyword">void</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> topic <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">using</span> function_type <span class="token operator">=</span> std<span class="token operator">::</span>function<span class="token operator">&lt;</span><span class="token function">R</span><span class="token punctuation">(</span>Args<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token punctuation">;</span>
        string strMsg <span class="token operator">=</span> topic <span class="token operator">+</span> <span class="token keyword">typeid</span><span class="token punctuation">(</span>function_type<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">auto</span> range <span class="token operator">=</span> m_map<span class="token punctuation">.</span><span class="token function">equal_range</span><span class="token punctuation">(</span>strMsg<span class="token punctuation">)</span><span class="token punctuation">;</span>
        m_map<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span>range<span class="token punctuation">.</span>first<span class="token punctuation">,</span> range<span class="token punctuation">.</span>second<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    <span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> F<span class="token operator">></span>
    <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> topic<span class="token punctuation">,</span> F<span class="token operator">&amp;&amp;</span> f<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        string strMsg <span class="token operator">=</span> topic <span class="token operator">+</span> <span class="token keyword">typeid</span><span class="token punctuation">(</span>F<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        m_map<span class="token punctuation">.</span><span class="token function">emplace</span><span class="token punctuation">(</span>std<span class="token operator">::</span><span class="token function">move</span><span class="token punctuation">(</span>strMsg<span class="token punctuation">)</span><span class="token punctuation">,</span> std<span class="token operator">::</span>forward<span class="token operator">&lt;</span>F<span class="token operator">></span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    std<span class="token operator">::</span>multimap<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> Any<span class="token operator">></span> m_map<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>测试代码如下：</p>
<pre class="line-numbers language-cpp"><code class="language-cpp">MessageBus g_bus<span class="token punctuation">;</span>
string g_topic <span class="token operator">=</span> <span class="token string">"drive"</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//主题类型</span>
<span class="token keyword">struct</span> Subject
<span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//主题对象发送某种消息,</span>
    <span class="token keyword">void</span> <span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> topic<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        g_bus<span class="token punctuation">.</span>send<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> topic<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> Car
<span class="token punctuation">{</span>
    <span class="token function">Car</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">//注册到消息总线</span>
        g_bus<span class="token punctuation">.</span><span class="token function">attach</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> speed<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token function">drive</span><span class="token punctuation">(</span>speed<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> g_topic<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">drive</span><span class="token punctuation">(</span><span class="token keyword">int</span> speed<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">//观察者对象接收到某种消息的响应体(lambda封装)</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"car drive:"</span> <span class="token operator">&lt;&lt;</span> speed <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> Bus
<span class="token punctuation">{</span>
    <span class="token function">Bus</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">//注册到消息总线</span>
        g_bus<span class="token punctuation">.</span><span class="token function">attach</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> speed<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token function">drive</span><span class="token punctuation">(</span>speed<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> g_topic<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">drive</span><span class="token punctuation">(</span><span class="token keyword">int</span> speed<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">//观察者对象接收到某种消息的响应体(lambda封装)</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"bus drive:"</span> <span class="token operator">&lt;&lt;</span> speed <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">testBus</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Subject subject<span class="token punctuation">;</span>
    Car car<span class="token punctuation">;</span>
    Bus bus<span class="token punctuation">;</span>
    subject<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>g_topic<span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"---------------"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    subject<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>不出所料，观察者Car和Bus接收到主题”drive”消息，由消息体触发drive函数调用。</p>
<p>复杂的对象关系梳理<br>我们上面实现的仅仅是简单的发送主题，然后响应。如果我们希望，观察者受到消息后，可以进行“回复”，这时候消息总线的优势就更一步体现了，我们只需重新注册一种主题即可。</p>
<pre class="line-numbers language-cpp"><code class="language-cpp">MessageBus g_bus<span class="token punctuation">;</span>
string g_topic <span class="token operator">=</span> <span class="token string">"drive"</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//主题类型</span>
string g_callbacktopic <span class="token operator">=</span> <span class="token string">"driveok"</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> Subject
<span class="token punctuation">{</span>
    <span class="token function">Subject</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        g_bus<span class="token punctuation">.</span><span class="token function">attach</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token function">driveok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> g_callbacktopic<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> topic<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        g_bus<span class="token punctuation">.</span>send<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> topic<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">driveok</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"driveok"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> Car
<span class="token punctuation">{</span>
    <span class="token function">Car</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">//注册到消息总线</span>
        g_bus<span class="token punctuation">.</span><span class="token function">attach</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> speed<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token function">drive</span><span class="token punctuation">(</span>speed<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> g_topic<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">drive</span><span class="token punctuation">(</span><span class="token keyword">int</span> speed<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"car drive:"</span> <span class="token operator">&lt;&lt;</span> speed <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">//额外增加处理函数</span>
        g_bus<span class="token punctuation">.</span>send<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span><span class="token punctuation">(</span>g_callbacktopic<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> Bus
<span class="token punctuation">{</span>
    <span class="token function">Bus</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">//注册到消息总线</span>
        g_bus<span class="token punctuation">.</span><span class="token function">attach</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> speed<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token function">drive</span><span class="token punctuation">(</span>speed<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> g_topic<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">drive</span><span class="token punctuation">(</span><span class="token keyword">int</span> speed<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"bus drive:"</span> <span class="token operator">&lt;&lt;</span> speed <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">testBus</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Subject subject<span class="token punctuation">;</span>
    Car car<span class="token punctuation">;</span>
    Bus bus<span class="token punctuation">;</span>
    subject<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>g_topic<span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"---------------"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    subject<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>可以看到，Car注册了回复主题，在执行完成后，通知消息总线即可实现“回复”功能。</p>
<p>思考:<br>其实我们可将消息总线和状态机结合一下，当处于某种状态执行某些操作，然后此操作完成后可以选择继续执行某些操作，这些操作可以是不同的主题类型。<br>消息总线将复杂对象关系简化了，降低了对象关系的复杂度和耦合度，但是也要注意消息总线的使用场景，对象关系很简单的时候使用，反而将系统变的很复杂，在对象关系多且复杂的场景，消息总线才能更好的发挥作用。</p>
<p>个人总结:<br>消息总线的思想是总线接管所有消息处理逻辑,因此总线需要将所有函数格式化为统一接口,格式化时需要传入被调用函数的地址,被调用函数的参数类型,被调用函数的参数(数据).</p>
<p>注意：<br>消息总线案例不完美,需要增加多个发布者,同时解耦总线和发布者，而不是搞成一个。</p>
<h1 id="回调模式"><a href="#回调模式" class="headerlink" title="回调模式"></a>回调模式</h1><p>回调函数的简单代码实现如下：</p>
<pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConcretSubject</span> <span class="token punctuation">{</span>
   <span class="token keyword">private</span> Callback callback<span class="token punctuation">;</span>

   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">register</span><span class="token punctuation">(</span>Callback callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">this</span><span class="token punctuation">.</span>callback <span class="token operator">=</span> callback<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       callback<span class="token punctuation">.</span><span class="token function">onCall</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Callback</span> <span class="token punctuation">{</span>
   <span class="token keyword">void</span> <span class="token function">onCall</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>

   <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       ConcretSubject subject <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConcretSubject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       Callback callback <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
           <span class="token annotation punctuation">@Override</span>
           <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onCall</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
               System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"call"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           <span class="token punctuation">}</span>
       <span class="token punctuation">}</span><span class="token punctuation">;</span>
       subject<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
       subject<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>通过对比，我们发现，观察者模式和回调函数模式及其相似，差别仅在于在观察者模式中，被观察者维护这一个观察者列表，而在回调模式中，“被观察者”只是保存了一个“观察者”。这就是形式上的终极区别。</p>
<p>也就是说，回调函数是一种特殊的观察者模式，是一种一对一的观察者模式。</p>
<p>参考链接：<br><a href="https://www.cnblogs.com/cbf4life/" target="_blank" rel="noopener">https://www.cnblogs.com/cbf4life/</a><br><a href="https://www.cnblogs.com/wanggary/archive/2011/04/07/2008796.html" target="_blank" rel="noopener">https://www.cnblogs.com/wanggary/archive/2011/04/07/2008796.html</a><br><a href="https://www.cnblogs.com/cbf4life/" target="_blank" rel="noopener">https://www.cnblogs.com/cbf4life/</a><br><a href="https://www.cnblogs.com/wanggary/archive/2011/04/07/2008796.html" target="_blank" rel="noopener">https://www.cnblogs.com/wanggary/archive/2011/04/07/2008796.html</a><br><a href="https://blog.csdn.net/xufeng0991/article/details/50267675" target="_blank" rel="noopener">https://blog.csdn.net/xufeng0991/article/details/50267675</a></p>
</iostream><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>
                 
                 <hr/>
                 

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fa fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://purethought.cn" rel="external nofollow noreferrer">陈德强</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fa fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://purethought.cn/54575.html">https://purethought.cn/54575.html</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fa fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="https://purethought.cn" target="_blank">陈德强</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>


            </div>         
        </div>
    </div>
    
    <!-- 代码块功能依赖 -->
    <script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>    
    <!-- 代码语言 -->   
    <!-- <script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script> -->          
    <!-- 代码块复制 -->   
    <script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>
    <script type="text/javascript" src="/libs/codeBlock/clipboard.min.js"></script>      
    <!-- 代码块收缩 -->   
    <script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge ">                  
                <a href="/ad4f1e09.html" target="_blank">                 
                    <font color="#0e263f">
                        <i class="fa  fa-hand-o-left"></i>
                        C++学习笔记
                    </font>                    
                </a>          
            </div>
        </div>
        


        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge " >
                <a href="/35127.html" target="_blank">
                    <font color="#0e263f">
                        TCP-IP总线与CAN总线优缺点对比
                        <i class="fa  fa-hand-o-right"></i>
                    </font>
                 </a>  
            </div>
        </div>
        
    </div>
</article>

    
        <style>
    #reward {
        /*margin: 40px 0;*/
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.6rem;
      
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
   <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red" >¥</a> 
  

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fa fa-times"></i></a>
            <h4 class="reward-title">您的赞赏就是我的动力^</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

    

    
        <div class="livere-card card" data-aos="fade-up">
    <!-- 来必力City版安装代码 -->
    <div id="lv-container" class="card-content" data-id="city" data-uid="MTAyMC80Njk3Mi8yMzQ3Mw==">
        <script type="text/javascript">
            (function (d, s) {
                let j, e = d.getElementsByTagName(s)[0];
                if (typeof LivereTower === 'function') {
                    return;
                }

                j = d.createElement(s);
                j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
                j.async = true;

                e.parentNode.insertBefore(j, e);
            })(document, 'script');
        </script>
        <noscript>为正常使用来必力评论功能请激活JavaScript。</noscript>
    </div>
    <!-- City版安装代码已完成 -->
</div>
    
    
   <!-- 
        <link rel="stylesheet" href="/libs/gitalk/gitalk.css">
<link rel="stylesheet" href="/css/my-gitalk.css">

<div class="card gitalk-card" data-aos="fade-up">
    <div id="gitalk-container" class="card-content"></div>
</div>

<script src="/libs/gitalk/gitalk.min.js"></script>
<script>
    let gitalk = new Gitalk({
        clientID: '6190f09c0ffe658707b5',
        clientSecret: '2798e16eeba573f49ce06d2da0595188699aac41',
        repo: 'cdqpt.github.io',
        owner: 'CdqPT',
        admin: "CdqPT",
        id: '2019-12-21T18-17-00',
        distractionFreeMode: false  // Facebook-like distraction free mode
    });

    gitalk.render('gitalk-container');
</script>
     -->

    

    

    

   <!-- <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">

<div id="article-share">
    
    <div class="social-share" data-disabled="qzone" data-wechat-qrcode-helper="<p>微信里点“发现”->“扫一扫”二维码便可查看分享。</p>"></div>
    
</div>

<script src="/libs/share/js/social-share.min.js"></script> -->

</div>




    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
    
        <div class="toc-widget">
        
            <div class="toc-title" ><i class="fa fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="hidden">
                <div id="toc-content"></div>
            </div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. --><!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large ">    
        <i class="fa fa-th-large"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            // headingsOffset: -205,
            headingSelector: 'h1, h2'
        });
        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            i++;
            $(this).attr('href', '#' + tocHeading + (i));
            $(this).attr('navTo',  tocHeading + (i));    
        });
        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h1, h2').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });
        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });
        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }
            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };
        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).slideUp(0);
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).slideDown(100);
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>
    
</main>


    <footer class="page-footer bg-color">
    <div class="container row center-align">
       <div class="col s12 m8 l8 copy-right">
             
               &copy;2018-2020 ALaDing
               &nbsp;
             Author:  <a href="https://purethought.cn/">陈德强 &nbsp  Email: 928277452@qq.com</a>

            
            
			
                <br>
                
                <span id="busuanzi_container_site_pv">
                    <i class="fa fa-heart-o"></i>
                    本站总访问量 <span id="busuanzi_value_site_pv" class="white-color"></span>
                </span>
                
                
                <span id="busuanzi_container_site_uv">
                    <i class="fa fa-users"></i>
                    次,&nbsp;访客数 <span id="busuanzi_value_site_uv" class="white-color"></span> 人.
                </span>
                       
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?147475454185ebcf440a27cc35e793ef";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>










                
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/CdqPT" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fa fa-github"></i>
    </a>



    <a href="mailto:928277452@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fa fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=928277452" class="tooltipped" data-tooltip="QQ联系我: 928277452" data-position="top" data-delay="50">
        <i class="fa fa-qq"></i>
    </a>







</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fa fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("/" + "search.xml", 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fa fa-angle-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    
    <!-- Global site tag (gtag.js) - Google Analytics -->


 
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

   

    

    
    <script type="text/javascript" src="/libs/background/ribbon-dynamic.js" async="async"></script>
    
    
<script>!function(e){var c=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function i(){for(var r=0;r<c.length;r++)t=c[r],0<=(n=t.getBoundingClientRect()).bottom&&0<=n.left&&n.top<=(e.innerHeight||document.documentElement.clientHeight)&&function(){var t,n,e,i,o=c[r];t=o,n=function(){c=c.filter(function(t){return o!==t})},e=new Image,i=t.getAttribute("data-original"),e.onload=function(){t.src=i,n&&n()},e.src=i}();var t,n}i(),e.addEventListener("scroll",function(){var t,n;t=i,n=e,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(n)},500)})}(this);</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script></body>

</html>
