<!DOCTYPE html>
<html ⚡>
  <head>
    <meta charset="utf-8">
    <link rel="canonical" href="https://purethought.cn/10070.html" >
    <title>Linux系统编程 - ALaDing</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    
    <meta property="og:title" content="Linux系统编程">
	<meta property="og:type" content="article">
	<meta property="og:url" content="https://purethought.cn/10070.html">
	
		<meta property="og:image" content="/amp-dist/sample/sample-substituteTitleImage.png">
	
	<meta property="og:site_name" content="ALaDing">
	
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:site" content="ALaDing">
	<meta name="twitter:url" content="https://purethought.cn/10070.html">
	<meta name="twitter:title" content="Linux系统编程 - ALaDing">
	
    
    	<meta name="twitter:image" content="/amp-dist/sample/sample-substituteTitleImage.png">
	
	
	
    
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style>
    <noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <script async custom-element="amp-sidebar" src="https://cdn.ampproject.org/v0/amp-sidebar-0.1.js"></script>
    <!--
  	<script async custom-element="amp-social-share" src="https://cdn.ampproject.org/v0/amp-social-share-0.1.js"></script>
    -->
    
    
    
    
    
    
    
    
      <script async custom-element="amp-mathml" src="https://cdn.ampproject.org/v0/amp-mathml-0.1.js"></script>
    
    
    
    <script async src="https://cdn.ampproject.org/v0.js"></script>
    <script type="application/ld+json">
		{
			"@context": "http://schema.org",
			"@type": "BlogPosting",
			"headline": "Linux系统编程",
			
			"mainEntityOfPage":{
			    "@type":"WebPage",
			    "@id":"https://purethought.cn/10070.html"
			},
			"datePublished": "2019-12-02T12:54:00.000Z",
			"dateModified": "2020-03-02T10:40:41.057Z",
			
			"image": {
				"@type": "ImageObject",
				"url": "/amp-dist/sample/sample-substituteTitleImage.png",
				"width" : "1024",
				"height" : "800"
			},
			
			"author": {
			    "@type": "Person",
			    "name": "陈德强"
			},
			"publisher": {
			    "@type": "Organization",
			    "name": "ALaDing"
			    
			    ,
			    "logo": {
			      "@type": "ImageObject",
			      "url": "https://purethought.cn/amp-dist/sample/sample-logo.png",
			      "width": 600,
			      "height": 60
			    }
			    
			}
		}
	</script>
	<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
	
	<style amp-custom>
		
abbr,
acronym,
address,
applet,
big,
blockquote,
body,
caption,
cite,
code,
dd,
del,
dfn,
div,
dl,
dt,
em,
fieldset,
form,
h1,
h2,
h3,
h4,
h5,
h6,
html,
iframe,
img,
ins,
kbd,
label,
legend,
li,
object,
ol,
p,
pre,
q,
s,
samp,
small,
span,
strike,
strong,
sub,
sup,
table,
tbody,
td,
tfoot,
th,
thead,
tr,
tt,
ul,
var {
  border: 0;
  font-family: inherit;
  font-size: 1rem;
  font-style: inherit;
  font-weight: inherit;
  margin: 0;
  outline: 0;
  padding: 0;
  vertical-align: baseline;
}
abbr {
  cursor: help;
  border-bottom: 1px dotted;
  font-variant: normal;
}
acronym {
  border-bottom: 1px dotted;
  font-variant: normal;
}
body {
  -moz-osx-font-smoothing: grayscale;
  -webkit-font-smoothing: antialiased;
  -webkit-text-size-adjust: 100%;
  background: #fff;
  color: #2d3d40;
  font-family: sans-serif;
  font-size: 1rem;
  font-weight: 500;
  line-height: 2rem;
  text-rendering: optimizelegibility;
}
button::-moz-focus-inner,
input::-moz-focus-inner,
figure.highlight td,
.post .entry-content figure.highlight th {
  border: 0;
  padding: 0;
}
caption,
table,
td,
th {
  vertical-align: middle;
}
caption,
td,
th,
.table-align-left {
  text-align: left;
}
del {
  text-decoration: line-through;
}
html {
  font-size: 14px;
}
:root sub,
:root sup {
  vertical-align: baseline;
}
table {
  border-collapse: separate;
  border-spacing: 0;
}
a {
  color: #e91e63;
  text-decoration: none;
  -webkit-transition: 0.7s;
  -ms-transition: 0.7s;
  -moz-transition: 0.7s;
  -o-transition: 0.7s;
  -webkit-transition: 0.7s;
  -moz-transition: 0.7s;
  -o-transition: 0.7s;
  -ms-transition: 0.7s;
  transition: 0.7s;
  border: 0;
  font-family: inherit;
  font-size: 1rem;
  font-style: inherit;
  font-weight: inherit;
  margin: 0;
  outline: 0;
  padding: 0;
  vertical-align: baseline;
}
a img {
  border: none;
}
a:hover {
  -webkit-transition: 0.2s;
  -ms-transition: 0.2s;
  -moz-transition: 0.2s;
  -o-transition: 0.2s;
  -webkit-transition: 0.2s;
  -moz-transition: 0.2s;
  -o-transition: 0.2s;
  -ms-transition: 0.2s;
  transition: 0.2s;
  color: #930e3b;
}
@media (min-width: 481px) {
  html {
    font-size: 16px;
  }
}
@media (min-width: 0px) and (max-width: 480px) {
  html {
    font-size: 14px;
  }
}
.clearfix:after {
  clear: both;
  visibility: hidden;
  content: ".";
  display: block;
  height: 0;
}
.left {
  float: left;
}
.right {
  float: right;
}
.circle {
  -webkit-border-radius: 50%;
  border-radius: 50%;
}
.thumbImg-w {
  width: 100px;
  height: 100px;
  display: inline-block;
  position: relative;
  overflow: hidden;
}
.thumbImg {
  top: 50%;
  left: 50%;
  position: absolute;
  -webkit-transform: translate(-50%, -50%);
  -ms-transform: translate(-50%, -50%);
  -webkit-transform: translate(-50%, -50%);
  -moz-transform: translate(-50%, -50%);
  -o-transform: translate(-50%, -50%);
  -ms-transform: translate(-50%, -50%);
  transform: translate(-50%, -50%);
}
.__web-inspector-hide-shortcut__ {
  visibility: hidden ;
}
button {
  -webkit-box-align: start;
  -moz-box-align: start;
  -o-box-align: start;
  -ms-flex-align: start;
  -webkit-align-items: flex-start;
  align-items: flex-start;
  text-align: center;
  cursor: default;
  color: buttontext;
  background-color: buttonface;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
  padding: 2px 6px 3px;
  border-width: 2px;
  border-style: outset;
  border-color: buttonface;
  -webkit-border-image: initial;
  -moz-border-image: initial;
  -o-border-image: initial;
  border-image: initial;
  text-rendering: auto;
  color: initial;
  letter-spacing: normal;
  word-spacing: normal;
  text-transform: none;
  text-indent: 0px;
  text-shadow: none;
  display: inline-block;
  text-align: start;
  margin: 0em 0em 0em 0em;
  font: 11px system-ui;
  -webkit-writing-mode: horizontal-tb;
  -webkit-appearance: button;
}
.hamburger {
  display: inline-block;
  background-color: transparent;
  background-image: url("data:image/svg+xmlutf8,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"-3 -6 24 24\"><path fill=\"#4A4A4A\" d=\"M0 12h18v-2H0v2M0 7h18V5H0v2M0 0v2h18V0H0\"/></svg>");
  background-repeat: no-repeat;
  -webkit-background-size: 30px 24px;
  -moz-background-size: 30px 24px;
  background-size: 30px 24px;
  background-position: center center;
  border: none;
  margin: 0;
  padding: 0;
  width: 60px;
  height: 60px;
  cursor: pointer;
  -ms-flex-item-align: center;
  -ms-grid-row-align: center;
  -webkit-align-self: center;
  align-self: center;
  -ms-flex-item-align: center;
}
.nav ul:after {
  clear: both;
  visibility: hidden;
}
.nav,
.nav-icon {
  position: relative;
}
.nav ul {
  display: block;
}
.nav ul li {
  display: block;
}
.nav ul li a {
  display: block;
}
.tab {
  position: relative;
  color: #424242;
  padding: 6px;
  margin: 0 4px;
  text-decoration: none;
  text-transform: uppercase;
  font-weight: 400;
  -webkit-transition: 0.1s ease color;
  -webkit-transition: 0.1s ease color;
  -moz-transition: 0.1s ease color;
  -o-transition: 0.1s ease color;
  -ms-transition: 0.1s ease color;
  transition: 0.1s ease color;
}
amp-sidebar {
  width: 200px;
}
amp-sidebar ul {
  padding: 10px 0;
}
amp-sidebar li a {
  display: block;
  padding: 10px 20px;
}
header {
  height: 60px;
  background-color: #222f31;
  -webkit-box-shadow: 0 -1px 0 #3c5155 inset, 0 -3px 0 #1e292b inset;
  box-shadow: 0 -1px 0 #3c5155 inset, 0 -3px 0 #1e292b inset;
  -webkit-box-shadow: 0 -1px 0 #3c5155 inset, 0 -3px 0 #1e292b inset;
}
header .header-title a {
  padding: 0 0 0 20px;
  height: 60px;
  line-height: 60px;
  font-size: 20px;
  color: #fff;
  letter-spacing: 0.2em;
}
header .nav-container {
  display: -webkit-box;
  display: -ms-flexbox;
  display: -webkit-box;
  display: -moz-box;
  display: -webkit-flex;
  display: -ms-flexbox;
  display: box;
  display: flex;
  -webkit-box-pack: justify;
  -ms-flex-pack: justify;
  -webkit-box-pack: justify;
  -moz-box-pack: justify;
  -o-box-pack: justify;
  -ms-flex-pack: justify;
  -webkit-justify-content: space-between;
  justify-content: space-between;
}
header .left-nav {
  display: -webkit-box;
  display: -ms-flexbox;
  display: -webkit-box;
  display: -moz-box;
  display: -webkit-flex;
  display: -ms-flexbox;
  display: box;
  display: flex;
  -webkit-box-align: center;
  -ms-flex-align: center;
  -webkit-box-align: center;
  -moz-box-align: center;
  -o-box-align: center;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center;
  -webkit-box-pack: start;
  -ms-flex-pack: start;
  -webkit-box-pack: start;
  -moz-box-pack: start;
  -o-box-pack: start;
  -ms-flex-pack: start;
  -webkit-justify-content: flex-start;
  justify-content: flex-start;
  font-size: 20px;
  margin-left: 0;
  font-weight: 300;
  -webkit-box-pack: start;
  -ms-flex-pack: start;
  -webkit-box-pack: start;
  -moz-box-pack: start;
  -o-box-pack: start;
  -ms-flex-pack: start;
  -webkit-justify-content: flex-start;
  justify-content: flex-start;
  -webkit-box-flex: 1;
  -ms-flex: 1 1 auto;
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  -o-box-flex: 1;
  box-flex: 1;
  -webkit-flex: 1 1 auto;
  -ms-flex: 1 1 auto;
  flex: 1 1 auto;
  text-align: left;
  width: auto;
  font-size: 15px;
}
header .right {
  font-size: 15px;
}
header .alt {
  padding: 0;
  text-align: right;
  display: -webkit-box;
  display: -ms-flexbox;
  display: -webkit-box;
  display: -moz-box;
  display: -webkit-flex;
  display: -ms-flexbox;
  display: box;
  display: flex;
  -webkit-box-align: stretch;
  -ms-flex-align: stretch;
  -webkit-box-align: stretch;
  -moz-box-align: stretch;
  -o-box-align: stretch;
  -ms-flex-align: stretch;
  -webkit-align-items: stretch;
  align-items: stretch;
  -webkit-box-pack: center;
  -ms-flex-pack: center;
  -webkit-box-pack: center;
  -moz-box-pack: center;
  -o-box-pack: center;
  -ms-flex-pack: center;
  -webkit-justify-content: center;
  justify-content: center;
}
.blog-title a {
  position: relative;
}
button {
  -webkit-box-align: start;
  -moz-box-align: start;
  -o-box-align: start;
  -ms-flex-align: start;
  -webkit-align-items: flex-start;
  align-items: flex-start;
  text-align: center;
  cursor: default;
  color: buttontext;
  background-color: buttonface;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
  padding: 2px 6px 3px;
  border-width: 2px;
  border-style: outset;
  border-color: buttonface;
  -webkit-border-image: initial;
  -moz-border-image: initial;
  -o-border-image: initial;
  border-image: initial;
  text-rendering: auto;
  color: initial;
  letter-spacing: normal;
  word-spacing: normal;
  text-transform: none;
  text-indent: 0px;
  text-shadow: none;
  display: inline-block;
  text-align: start;
  margin: 0em 0em 0em 0em;
  font: 11px system-ui;
  -webkit-writing-mode: horizontal-tb;
  -webkit-appearance: button;
}
.__web-inspector-hide-shortcut__ {
  visibility: hidden ;
}
.hamburger {
  display: inline-block;
  background-color: transparent;
  background-image: url("data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"-3 -6 24 24\"><path fill=\"#FFF\" d=\"M0 12h18v-2H0v2M0 7h18V5H0v2M0 0v2h18V0H0\"/></svg>");
  background-repeat: no-repeat;
  -webkit-background-size: 30px 24px;
  -moz-background-size: 30px 24px;
  background-size: 30px 24px;
  background-position: center center;
  border: none;
  margin: 0;
  padding: 0;
  width: 60px;
  height: 60px;
  cursor: pointer;
  -ms-flex-item-align: center;
  -ms-grid-row-align: center;
  -webkit-align-self: center;
  align-self: center;
  -ms-flex-item-align: center;
}
.tab {
  position: relative;
  color: #2d3d40;
  padding: 6px;
  margin: 0 4px;
  text-decoration: none;
  text-transform: uppercase;
  font-weight: 400;
  -webkit-transition: 0.1s ease color;
  -webkit-transition: 0.1s ease color;
  -moz-transition: 0.1s ease color;
  -o-transition: 0.1s ease color;
  -ms-transition: 0.1s ease color;
  transition: 0.1s ease color;
}
amp-sidebar {
  width: 250px;
  background-color: #182022;
}
amp-sidebar ul {
  padding: 10px 0;
}
amp-sidebar li {
  border-top: 1px solid #2f4043;
}
amp-sidebar li:last-child {
  border-bottom: 1px solid #2f4043;
}
amp-sidebar li a {
  color: #fff;
  font-weight: bold;
  display: block;
  padding: 10px 20px;
}
amp-sidebar li a:hover {
  color: #ccc;
  background-color: #030404;
}
.categories-header {
  background-color: #2d3d40;
  padding: 0rem 0.8rem;
}
.categories-header a {
  color: #fff;
}
.categories-header a:hover {
  color: #fff;
}
.categories-header .breadcrumb ol li {
  list-style: none;
  display: inline-block;
  margin: 0;
}
.categories-header .breadcrumb ol li span {
  font-size: 0.8rem;
  font-weight: bold;
}
.categories-header .breadcrumb ol li:after {
  content: "/";
  color: #fff;
  display: inline-block;
  margin: 0 0.4rem;
}
.categories-header .breadcrumb ol li:last-child:after {
  content: "";
  margin: 0;
}
.entry-header {
  display: -webkit-box;
  display: -moz-box;
  display: -webkit-flex;
  display: -ms-flexbox;
  display: box;
  display: flex;
  -webkit-box-pack: center;
  -moz-box-pack: center;
  -o-box-pack: center;
  -ms-flex-pack: center;
  -webkit-justify-content: center;
  justify-content: center;
  -webkit-align-items: center;
  -webkit-box-align: center;
  -moz-box-align: center;
  -o-box-align: center;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center;
}
.entry-header .flx:first-child {
  margin: 0 1rem 0 0;
}
.header-cap {
  -webkit-flex-grow: 3;
  -webkit-box-flex: 3;
  -moz-box-flex: 3;
  -o-box-flex: 3;
  -ms-box-flex: 3;
  box-flex: 3;
  -webkit-flex-grow: 3;
  flex-grow: 3;
}
.title-cover {
  background-color: #fff;
  color: #2d3d40;
  padding: 1.5rem 0.8rem 0 0.8rem;
}
.title-cover a {
  font-size: 1.2rem;
  color: #2d3d40;
  text-align: left;
  font-weight: bold;
}
.entry-title {
  margin: 0;
}
.entry-meta-header {
  font-size: 0.85rem;
  text-align: center;
}
.entry-meta-header .date {
  font-family: sans-serif;
}
h1 a,
h2 a,
h3 a,
h4 a,
h5 a,
h6 a {
  color: #2d3d40;
  text-decoration: none;
}
h1 a:hover,
h2 a:hover,
h3 a:hover,
h4 a:hover,
h5 a:hover,
h6 a:hover {
  color: #e91e63;
}
#container {
  margin-left: auto;
  margin-right: auto;
}
#main {
  margin-bottom: 3em;
  padding-left: 0;
}
.post {
  margin-bottom: 3rem;
  position: relative;
}
.entry-content {
  margin: 0 0.6rem;
  font-size: 1rem;
}
.entry-content h1 {
  font-size: 1.7rem;
  line-height: 1.5;
  margin: 1em 0 0.8em;
}
.entry-content h2,
.entry-content h3,
.entry-content h4,
.entry-content h5,
.entry-content h6,
.entry-content h2 span,
.entry-content h3 span,
.entry-content h4 span,
.entry-content h5 span,
.entry-content h6 span {
  color: #98b8be;
  font-weight: bold;
}
.entry-content h2,
.entry-content h2 span {
  font-size: 1.8rem;
  line-height: 2.6rem;
  text-align: center;
}
.entry-content h2 {
  border-bottom: 2px solid #cce4e8;
  margin: 4.5rem 0 0.5em;
  padding: 0.8em 0;
}
.entry-content h3,
.entry-content h3 span {
  font-size: 1.6rem;
  line-height: 2.2rem;
  text-align: center;
}
.entry-content h3 {
  margin: 3.6rem 0.8rem 3rem 0.8rem;
  padding: 0;
}
.entry-content h4,
.entry-content h4 span {
  font-size: 1.4rem;
  line-height: 2rem;
  text-align: center;
}
.entry-content h4 {
  margin: 3.6rem 0.8rem 3rem 0.8rem;
  padding: 0;
}
.entry-content h5,
.entry-content h5 span {
  font-size: 1.2rem;
  line-height: 1.8rem;
  text-align: center;
}
.entry-content h5 {
  margin: 3.6rem 0.8rem 3rem 0.8rem;
  padding: 0;
}
.entry-content h6,
.entry-content h6 span {
  font-size: 1.1rem;
  line-height: 1.6rem;
  text-align: center;
}
.entry-content h6 {
  margin: 3.6rem 0.8rem 3rem 0.8rem;
  padding: 0;
}
.entry-content p {
  font-size: 1rem;
  letter-spacing: 0.05rem;
  line-height: 2.2rem;
  margin: 3rem 0.8rem;
}
.entry-content p a {
  word-wrap: break-word;
  overflow-wrap: break-word;
  display: inline;
  border-bottom: 1px dashed #f1729d;
  padding-bottom: 0.3rem;
}
.entry-content p a:hover {
  border-bottom: 1px dashed #9c0f3f;
  padding-bottom: 0.4rem;
}
.entry-content em {
  background-color: #f9f5d1;
  color: #886d00;
  font-style: normal;
  margin: 0 2px;
  padding: 0.4em;
}
.entry-content strong {
  color: #871c1c;
  font-style: normal;
  margin: 0 2px;
  padding: 0.4em;
  background-color: #fadcdc;
}
.entry-content hr {
  border: 0;
  border-top: 3px solid #cce4e8;
  margin: 3rem auto;
  width: 20%;
}
.entry-content img,
.entry-content video {
  display: block;
  height: auto;
  margin: auto;
  max-width: 100%;
}
.entry-content iframe {
  width: 100% ;
}
.entry-content blockquote {
  margin: 3rem 0.8rem;
  padding: 1rem 1.8rem;
  position: relative;
  background-color: none;
  border-left: 3px solid #98b8be;
  font-style: italic;
}
.entry-content blockquote p {
  margin: 0.5rem 0;
}
.entry-content blockquote blockquote {
  border-left: none;
}
.entry-content .table-wrapper {
  margin: 3rem 0.8rem;
}
.entry-content table {
  border-collapse: collapse;
  border-spacing: 0;
  overflow: auto;
  display: block;
  font-size: 0.85rem;
  margin: 0 auto;
  width: auto;
}
.entry-content td,
.entry-content th {
  line-height: 1.8em;
  padding: 0.8rem 0.8rem;
  font-size: 0.85rem;
}
.entry-content td em,
.entry-content th em,
.entry-content td strong,
.entry-content th strong,
.entry-content td a,
.entry-content th a {
  font-size: 0.85rem;
}
.entry-content td {
  border: 1px solid #c4c4c4;
}
.entry-content th {
  background-color: #ecf5f7;
  border: 1px solid #c4c4c4;
}
.entry-content .table-align-center {
  text-align: center;
}
.entry-content .table-align-right {
  text-align: right;
}
.entry-content ul,
.entry-content ol,
.entry-content dl {
  margin: 3rem 0 3rem 1.6rem;
  padding: 0;
  list-style: none;
  font-size: 1rem;
}
.entry-content ul li,
.entry-content ol li,
.entry-content dl li {
  line-height: 2rem;
  position: relative;
  padding: 0;
}
.entry-content ul li p,
.entry-content ol li p,
.entry-content dl li p {
  line-height: 2rem;
  margin: 0;
}
.entry-content ul li p:not(:first-child),
.entry-content ol li p:not(:first-child),
.entry-content dl li p:not(:first-child) {
  color: #57767c;
  margin: 0.5rem;
}
.entry-content ul li ul,
.entry-content ol li ul,
.entry-content dl li ul,
.entry-content ul li ol,
.entry-content ol li ol,
.entry-content dl li ol,
.entry-content ul li dl,
.entry-content ol li dl,
.entry-content dl li dl {
  margin: 1rem;
}
.entry-content ul li {
  margin: 0.4rem 0 0.4rem 0.8rem;
}
.entry-content ul li::after {
  position: absolute;
  display: block;
  content: '';
  top: 0.75rem;
  left: -1rem;
  width: 0.5rem;
  height: 0.5rem;
  background-color: #cce4e8;
  border-radius: 100%;
}
.entry-content ol {
  counter-reset: number;
}
.entry-content ol li {
  margin: 0.4rem 0 0.4rem 2rem;
}
.entry-content ol li p:first-child {
  display: inline-block;
  line-height: 1.6rem;
  height: 1.6rem;
}
.entry-content ol li:before {
  position: absolute;
  display: inline-block;
  float: left;
  margin: 0 0.2rem 0 0;
  padding: 0;
  counter-increment: number;
  content: counter(number);
  left: -2.2rem;
  top: 0.2rem;
  background-color: #98b8be;
  width: 1.6rem;
  height: 1.6rem;
  border-radius: 50%;
  color: #fff;
  text-align: center;
  font-weight: bold;
  font-size: 0.8rem;
  line-height: 1.6rem;
}
kbd {
  font-family: sans-serif;
  text-align: center;
  display: inline-block;
  color: #425a5e;
  -moz-osx-font-smoothing: grayscale;
  -webkit-border-radius: 3px;
  -webkit-box-shadow: 0 0 10px #e8e8e8 inset, 0 1px 0 #c3c3c3, 0 2px 0 #c9c9c9, 0 3px 3px #333;
  box-shadow: 0 0 10px #e8e8e8 inset, 0 1px 0 #c3c3c3, 0 2px 0 #c9c9c9, 0 3px 3px #333;
  -webkit-box-shadow: 0 0 10px #e2e2e2 inset, 0 1px 0 #c3c3c3, 0 2px 0 #c9c9c9, 0 3px 3px #333;
  -webkit-font-smoothing: subpixel-antialiased;
  background: #fff;
  border-left: 1px solid #fff;
  border-radius: 3px;
  border-right: 1px solid #e6e6e6;
  border-top: 1px solid #fff;
  font-size: 0.85rem;
  line-height: 1rem;
  margin: 5px;
  padding: 6px 8px 3px;
  text-shadow: 0 1px 0 #fff;
  vertical-align: baseline;
  
}
img.responsive-img {
  height: auto;
  max-width: 100%;
}
video.responsive-video {
  height: auto;
  max-width: 100%;
}
amp-instagram,
amp-vimeo,
amp-video,
amp-youtube,
amp-twitter,
.soundcloud-wrapper,
.amp-img-wrapper,
.googleAdPost,
.ad-footer {
  margin: 3rem 0.8rem;
}
code,
figure.highlight .code,
pre {
  -moz-osx-font-smoothing: grayscale;
  -webkit-font-smoothing: subpixel-antialiased;
}
code,
pre,
samp {
  font-family: Menlo, Consolas, Monaco, Consolas, monospace;
}
p code {
  font-size: 1rem;
}
code,
pre {
  font-size: 0.85rem;
  letter-spacing: 0.05rem;
  background-color: #ecf5f7;
  color: #007e96;
}
code {
  margin: 0 3px;
  padding: 0.4em;
}
samp {
  font-size: 0.85rem;
  letter-spacing: 0.05rem;
}
sub,
sup {
  font-size: 0.75rem;
  line-height: 0;
  position: relative;
}
sub {
  bottom: -0.2em;
}
sup {
  top: -0.5em;
}
pre {
  font-size: 1rem;
  letter-spacing: 0.05rem;
  margin: 0 3px;
  padding: 15px;
  -webkit-background-clip: padding;
  -moz-background-clip: padding;
  background-clip: padding-box;
  border: 0;
  line-height: 1.3rem;
  overflow-x: auto;
}
pre .addition,
pre .css .tag,
pre .keyword,
pre .method,
pre .nginx .title,
pre .request,
pre .status,
pre .winutils {
  color: #66d9ef;
}
pre .attr_selector,
pre .cdata,
pre .clojure .title,
pre .diff .change,
pre .important {
  color: #9882eb;
}
pre .preprocessor {
  color: #9882eb;
}
pre .preprocessor .keyword {
  color: #9882eb;
}
pre .shebang,
pre .special,
pre .subst {
  color: #9882eb;
}
pre .symbol {
  color: #9882eb;
}
pre .symbol .string {
  color: #9882eb;
}
pre .attribute,
pre .class .title,
pre .constant,
pre .haskell .type,
pre .lisp .body,
pre .parent,
pre .smalltalk .number,
pre .variable {
  color: #a6e22e;
}
pre .built_in,
pre .chunk,
pre .decorator,
pre .id,
pre .identifier,
pre .literal,
pre .localvars,
pre .title,
pre .vhdl,
pre .deletion {
  color: #f92672;
}
pre .command,
pre .hexcolor,
pre .number,
pre .phpdoc,
pre .regexp,
pre .string,
pre .tag .value,
pre .tex .formula {
  color: #e6db74;
}
pre .comment,
pre .diff .header,
pre .doctype,
pre .javadoc,
pre .lisp .string,
pre .pi,
pre .template_comment {
  color: #75715e;
  font-weight: normal;
}
.line {
  font-size: 0.85rem;
  letter-spacing: 0.05rem;
  line-height: 2rem;
  color: #f8f8f2;
}
.line span {
  font-size: 0.85rem;
  letter-spacing: 0.05rem;
}
.gist {
  background: #fff;
  border: 1px solid color-gutter;
  color: #f8f8f2;
  line-height: 1.6rem;
  margin-top: 15px;
  overflow: auto;
  padding: 7px 15px;
}
.gist .gist-file {
  border: none;
  font-family: inherit;
  font-size: 1rem;
  letter-spacing: 0;
  margin: 0;
}
.gist .gist-file .gist-data {
  background: 0 0;
  border-bottom: none;
}
.gist .gist-file .gist-data pre {
  font-family: Menlo, Consolas, Monaco, Consolas, monospace;
  padding: 0 ;
}
.gist .gist-file .gist-meta {
  background: 0 0;
  color: #f8f8f2;
  font-size: 1rem;
  margin-top: 5px;
  padding: 0;
}
.gist .gist-file .gist-meta a {
  color: #f8f8f2;
}
.gist .gist-file .gist-meta a:visited {
  color: #f8f8f2;
}
figure.highlight {
  font-size: 0.95rem;
  margin: 3rem 0.8rem;
  background: #263338;
  border: 1px solid color-gutter;
  line-height: 2rem;
  overflow: auto;
  position: relative;
}
figure.highlight .code {
  padding: 0 1em 1em 1em;
  color: #f8f8f2;
}
figure.highlight .gutter {
  display: none;
}
figure.highlight figcaption {
  font-size: 1rem;
  font-weight: bold;
  color: #e9e9d6;
  background-color: #1e282c;
  padding: 0.6em 1em;
}
figure.highlight figcaption a {
  position: absolute;
  right: 1rem;
}
figure.highlight figcaption:before {
  content: "\f121";
  font-family: "fontawesome";
  text-align: center;
  display: inline-block;
  margin-right: 0.6em;
}
figure.highlight pre {
  background: 0 0;
  border: none;
  margin: 0;
  padding: 0.5rem;
}
figure.highlight table {
  border-spacing: 0;
  margin: 0;
}
figure.highlight th {
  border: 0;
  font-weight: 400;
  padding: 0;
}
figure.highlight td {
  border: 0;
  font-size: 1.1rem;
  padding: 0;
}
.entry-content .toc {
  background: #fff;
  padding: 0.5rem;
  margin: 3rem 0;
  border: 1px solid #cce4e8;
  border-radius: 2px;
}
.entry-content .toc ul {
  margin-bottom: 0;
  padding: 0;
  margin: 0;
  border-top: 1px solid #5d8b93;
  border-radius: 2px;
}
.entry-content .toc ul:first-child {
  border-top: none;
}
.entry-content .toc ul ul,
.entry-content .toc ul ol {
  margin-bottom: 0;
  padding: 0;
  margin: 0;
}
.entry-content .toc ul li {
  padding: 0;
  margin: 0;
  border-top: 1px solid #5d8b93;
}
.entry-content .toc ul li:first-child {
  border-top: none;
}
.entry-content .toc ul li::after,
.entry-content .toc ul li::before {
  content: normal;
}
.entry-content .toc ul li a {
  font-size: 1.2rem;
  font-weight: bold;
  display: block;
  padding: 1rem;
  background-color: #3d5b61;
  color: #fff;
  -webkit-transition: 0.3s;
  -ms-transition: 0.3s;
  -moz-transition: 0.3s;
  -o-transition: 0.3s;
  -webkit-transition: 0.3s;
  -moz-transition: 0.3s;
  -o-transition: 0.3s;
  -ms-transition: 0.3s;
  transition: 0.3s;
}
.entry-content .toc ul li a:hover {
  color: #fff;
  background-color: #2c4145;
}
.entry-content .toc ul li a:before {
  content: "\f02d";
  font-family: "fontawesome";
  display: inline-block;
  padding: 0;
  margin: 0;
  margin-right: 0.8rem;
}
.entry-content .toc ul li ul,
.entry-content .toc ul li ol {
  margin-bottom: 0;
  padding: 0;
  margin: 0;
}
.entry-content .toc ul li ul li a,
.entry-content .toc ul li ol li a {
  padding: 0.5rem 0.75rem 0.5rem 2rem;
  font-size: 0.9rem;
  background-color: #416167;
}
.entry-content .toc ul li ul li a:before,
.entry-content .toc ul li ol li a:before {
  content: "\f0da";
  font-family: "fontawesome";
  display: inline-block;
  padding: 0;
  margin: 0;
  margin-right: 0.6rem;
}
.entry-content .toc ul li ul li ul li a,
.entry-content .toc ul li ol li ul li a {
  padding: 0.5rem 0.75rem 0.5rem 4rem;
}
.entry-content .toc ul li ul li ul li a:before,
.entry-content .toc ul li ol li ul li a:before {
  content: none;
}
.meta-content {
  background-color: #fff;
  margin: 1.5rem 0.8rem;
  padding: 0;
  border-top: 1px dotted #cce4e8;
  letter-spacing: 0.05rem;
}
.meta-wrapper {
  margin: 3rem 0.8rem;
  padding: 0;
  background-color: #fff;
}
h6.tag,
h6.categories {
  color: #2d3d40;
  font-size: 0.9rem;
  font-weight: bold;
}
.article-tag-list {
  padding: 0;
}
.article-tag,
.article-tag-list,
.article-categories,
.article-categories-list {
  padding: 0;
  margin: 0;
}
.article-categories {
  margin-bottom: 1.6em;
}
.article-tag-list li,
.article-categories-list li {
  list-style: none;
  display: inline-block;
  padding: 0;
  margin: 0.2rem 0.1rem;
}
.article-tag-list li a,
.article-categories-list li a {
  font-size: 0.8rem;
  font-weight: bold;
  padding: 0.4rem 0.8rem;
  margin: 0;
  background-color: #ecf5f7;
  color: #2d3d40;
  border-radius: 2px;
  display: block;
}
.article-tag-list li a:before,
.article-categories-list li a:before {
  content: "#";
}
.article-tag-list li a:hover,
.article-categories-list li a:hover {
  color: #fff;
  background-color: #2d3d40;
}
.widget {
  margin: 1.5rem 0.8rem;
  padding: 0;
}
.widget-h {
  text-align: center;
  margin: 1.6rem 0;
}
.widget-h h6 {
  color: #fff;
  background-color: #2d3d40;
  display: inline-block;
  padding: 0.4rem 1rem;
  font-size: 0.9rem;
  font-weight: bold;
}
.posts-list li {
  list-style: none;
  margin: 0.8rem 0;
  display: -webkit-box;
  display: -moz-box;
  display: -webkit-flex;
  display: -ms-flexbox;
  display: box;
  display: flex;
  -webkit-box-pack: center;
  -moz-box-pack: center;
  -o-box-pack: center;
  -ms-flex-pack: center;
  -webkit-justify-content: center;
  justify-content: center;
  -webkit-align-items: center;
  -webkit-box-align: center;
  -moz-box-align: center;
  -o-box-align: center;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center;
}
.posts-list li .posts-list-link {
  -webkit-flex-grow: 3;
  -webkit-box-flex: 3;
  -moz-box-flex: 3;
  -o-box-flex: 3;
  -ms-box-flex: 3;
  box-flex: 3;
  -webkit-flex-grow: 3;
  flex-grow: 3;
}
.posts-list li .posts-list-link a {
  color: #2d3d40;
  font-size: 1.1rem;
  font-weight: bold;
}
.posts-list li .posts-list-link a:hover {
  color: #e91e63;
}
.posts-list li .posts-list-meta {
  font-size: 0.7rem;
}
.posts-list li .flx:first-child {
  margin: 0 1rem 0 0;
}
.posts-list li amp-img {
  border-radius: 2px;
}
#footer {
  background-color: #2d3d40;
  color: #fff;
  display: block;
  font-size: 1rem;
  letter-spacing: 0.05rem;
  line-height: 2rem;
  margin: 3rem 0 0 0;
  padding: 0;
}
.site-author-info {
  margin: 0;
  padding: 3rem 1.6rem;
}
.site-author-info h6 {
  font-size: 1rem;
  color: #fff;
  font-weight: bold;
  display: inline-block;
  background-color: #222f31;
  padding: 0.4rem 0.8rem;
}
.site-author-info-wrapper {
  display: -webkit-box;
  display: -moz-box;
  display: -webkit-flex;
  display: -ms-flexbox;
  display: box;
  display: flex;
  -webkit-box-pack: center;
  -moz-box-pack: center;
  -o-box-pack: center;
  -ms-flex-pack: center;
  -webkit-justify-content: center;
  justify-content: center;
  -webkit-align-items: center;
  -webkit-box-align: center;
  -moz-box-align: center;
  -o-box-align: center;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center;
}
.site-author-info-wrapper .flx:first-child {
  margin: 0 1rem 0 0;
}
.authorCap-wrapper {
  -webkit-flex-grow: 3;
  -webkit-box-flex: 3;
  -moz-box-flex: 3;
  -o-box-flex: 3;
  -ms-box-flex: 3;
  box-flex: 3;
  -webkit-flex-grow: 3;
  flex-grow: 3;
}
.authorCap {
  font-size: 1.4rem;
  font-weight: bold;
}
.authorReading {
  font-size: 0.7rem;
}
.site-author-desc {
  font-size: 0.8rem;
  line-height: 1.6rem;
  margin: 1.4rem 0;
}
.copyright-tool {
  margin: 0;
  padding: 1.5rem 1.6rem;
  border-top: 1px solid #384b4f;
}
.copyright-notice p {
  font-size: 0.6rem;
  letter-spacing: 0.05rem;
  line-height: 1.2rem;
  color: #8ba8ae;
}
.copyright-title {
  font-size: 1rem;
  text-align: center;
  margin: 0.8rem 0 0.4rem 0;
}
.copyright-license {
  margin: 0.4rem 0 0.8rem 0;
  font-size: 0.7rem;
  text-align: center;
}
.copyright-license a {
  color: #e6e6e6;
  font-size: 0.7rem;
}
.copyright-license a:hover {
  color: #b3b3b3;
}
.sns-link {
  margin: 0;
  text-align: center;
}
.sns-link a {
  display: inline-block;
  font-size: 1.6rem;
  text-align: center;
  width: 2rem;
  height: 2rem;
  line-height: 2rem;
  padding: 0.6rem;
  margin: 0 0.1rem;
  background-color: #222f31;
  color: #fff;
  border-radius: 4px;
}
.sns-link a:hover {
  color: #ccc;
  background-color: #030404;
}
.footer-menu {
  padding: 1.5rem 0.8rem;
  border-top: 1px solid #384b4f;
}
.footer-menu ul li {
  list-style: none;
  margin: 0;
  padding: 0;
}
.footer-menu ul li a {
  display: block;
  padding: 0.6rem;
  margin: 0.2rem 1.6rem;
  font-size: 1rem;
  color: #fff;
  background-color: #222f31;
  border-radius: 4px;
  text-align: center;
  font-weight: bold;
}
.footer-menu ul li a:hover {
  color: #ccc;
  background-color: #030404;
}
.social-share {
  margin: 1.5rem 0.8rem;
  display: -webkit-box;
  display: -moz-box;
  display: -webkit-flex;
  display: -ms-flexbox;
  display: box;
  display: flex;
  -webkit-box-pack: center;
  -moz-box-pack: center;
  -o-box-pack: center;
  -ms-flex-pack: center;
  -webkit-justify-content: center;
  justify-content: center;
}
.social-share amp-social-share,
.social-share .sbtn {
  margin: 5px;
}
.sbtn {
  padding: 0;
  width: 4rem;
  height: 3rem;
  line-height: 3rem;
  color: #fff;
  font-size: 1.2rem;
  text-align: center;
  border-radius: 4px;
}
.sbtn:hover {
  color: #fff;
}
.tw {
  background-color: #1cafe8;
}
.tw:hover {
  background-color: #0f6b8f;
}
.fb {
  background-color: #4f677f;
}
.fb:hover {
  background-color: #283440;
}
.ht {
  background-color: #35acda;
}
.ht:hover {
  background-color: #1a6e8f;
}
.gp {
  background-color: #d56153;
}
.gp:hover {
  background-color: #9c3326;
}
.tb {
  background-color: #465f79;
}
.tb:hover {
  background-color: #212c38;
}
.icon-hatena:before {
  content: "B";
  font-weight: bold;
  font-size: 1.2rem;
}
#totop {
  position: fixed;
  bottom: 2rem;
  right: 1.6rem;
  font-size: 1.2rem;
  z-index: 995;
}
#totop a {
  background: rgba(152,184,190,0.6);
  text-decoration: none;
  color: #fff;
  padding: 0.8rem;
  border-radius: 50%;
}
#totop a:before {
  content: "\f062";
  font-family: "fontawesome";
  font-size: 1.2rem;
}
#totop a:hover {
  text-decoration: none;
  background: #5d8b93;
  color: #fff;
  line-height: 2.3em;
}
@media (min-width: 800px) {
  .title-cover,
  .entry-content,
  .categories,
  .meta-content,
  .site-author-info {
    width: 780px;
    margin: 0 auto;
  }
  .nav-container {
    width: 800px;
    margin: 0 auto;
  }
}
@media (min-width: 0px) and (max-width: 480px) {
  .site-author-info-wrapper {
    display: block;
  }
  .gravatar-area {
    text-align: center;
  }
  .gravatar-area amp-img {
    display: inline-block;
  }
  .entry-content td,
  .entry-content th {
    line-height: 1.8em;
    padding: 0.6rem 0.6rem;
    font-size: 0.5rem;
  }
  .entry-content td em,
  .entry-content th em,
  .entry-content td strong,
  .entry-content th strong,
  .entry-content td a,
  .entry-content th a {
    font-size: 0.5rem;
  }
}

	</style>
	
  </head>
  <body>
  	
  	
  	<!-- google analytics -->
  	
  	
  	
  	<!-- menu -->
  	<header>
  		<div class="nav-container">
	  		<div class="left-nav">
	  			<div class="header-title">
	  				<a href="/">ALaDing</a>
	  			</div>
	  		</div>
	  		
	  	</div>
    </header>
  	
  	
  	<!-- sidebar -->
  	
  	
  	<!-- container -->
  	<div id="container">
	  	<div id="main">
		    <article id="post-字典/Linux系统编程" class="post">
		    
		   		<!-- categories and bread crumb -->
		    	
				<div class="categories-header">
					<div class="categories">
						<div class="breadcrumb inline-icon">
							<ol itemscope itemtype="http://schema.org/BreadcrumbList">
							  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
							    <a itemprop="item" href="/">
							    	<span class="sns-icon home-icon"></span>
							        <span itemprop="name"><span class="fa fa-fw fa-home"></span></span>
							    </a>
							    <meta itemprop="position" content="1" />
							  </li>

								
						    		<li itemprop="itemListElement" itemscope
									      itemtype="http://schema.org/ListItem">
									    <a itemprop="item" href="/categories/字典/">
									      
									      	<span class="sns-icon folder-icon"></span>
									      
									      <span itemprop="name">字典</span>
									    </a>
									    <meta itemprop="position" content="2" />
									</li>
								
							</ol>
						</div>
					</div>
				</div>
				
		    
		    	<!-- entry title -->
				<div class="title-cover">
					<div class="entry-header">
						
						
						
			          	<div class="header-thumb flx">
			          		<div class="thumbImg-w circle">
			          			<amp-img class="thumbImg" layout="fixed" width="128" height="100" src="/amp-dist/sample/sample-substituteTitleImage.png">
			          			</amp-img>
			          		</div>
			          	</div>
			            
			            
			            <div class="header-cap flx">
							
							  <h1 class="article-title entry-title" itemprop="name">
							    <a href="https://purethought.cn/10070.html" target="_blank" itemprop="url">Linux系统编程</a>
							  </h1>
							
						</div>
					</div>
					
					<!-- datePublished -->
					<div class="entry-meta-header">
						<span class="meta-elements date">
							<span class="fa fa-fw fa-clock-o"></span>
							<time datetime="2019-12-02" itemprop="datePublished">2019.12.02</time>
						</span>
					</div>
				</div>
				
				
				
				<!-- entry content -->
			    <div class="entry-content ecp">
			    	<!-- social share button -->
			    	
			    	
			    	
                    <!-- google Adsense Matched content -->
                    
                    
			    	<!-- content -->
			  		<h1 id="SUSv3&#x548C;POSIX-1-2001"><a href="#SUSv3&#x548C;POSIX-1-2001" class="headerlink" title="SUSv3&#x548C;POSIX.1-2001"></a>SUSv3&#x548C;POSIX.1-2001</h1><p>&#x59CB;&#x4E8E;1999&#x5E74;&#xFF0C;&#x51FA;&#x4E8E;&#x4FEE;&#x8BA2;&#x5E76;&#x52A0;&#x5F3A;POSIX&#x6807;&#x51C6;&#x548C;SUS&#x89C4;&#x8303;&#x7684;&#x76EE;&#x7684;&#xFF0C;IEEE&#x3001;Open&#x96C6;&#x56E2;&#x4EE5;&#x53CA;ISO/ IEC&#x8054;&#x5408;&#x6280;&#x672F;&#x59D4;&#x5458;&#x4F1A;&#x5171;&#x540C;&#x6210;&#x7ACB;&#x4E86;&#x5965;&#x65AF;&#x4E01;&#x516C;&#x5171;&#x6807;&#x51C6;&#x4FEE;&#x8BA2;&#x5DE5;&#x4F5C;&#x7EC4;&#xFF08;CSRG&#xFF0C;<a href="https://www.opengroup.org/austin/" target="_blank" rel="noopener">https://www.opengroup.org/austin/</a> &#xFF09;&#x3002;&#xFF08;&#x8BE5;&#x5DE5;&#x4F5C;&#x7EC4;&#x7684;&#x9996;&#x6B21;&#x4F1A;&#x8BAE;&#x4E8E;1998&#x5E74;9&#x6708;&#x5728;&#x5FB7;&#x5DDE;&#x5965;&#x65AF;&#x4E01;&#x53EC;&#x5F00;&#xFF0C;&#x8FD9;&#x4E5F;&#x662F;&#x5965;&#x65AF;&#x4E01;&#x5DE5;&#x4F5C;&#x7EC4;&#x540D;&#x79F0;&#x7684;&#x7531;&#x6765;&#x3002;&#xFF09;2001&#x5E74;12&#x6708;&#xFF0C;&#x8BE5;&#x5DE5;&#x4F5C;&#x7EC4;&#x6B63;&#x5F0F;&#x6279;&#x51C6;&#x4E86;POSIX 1003.1-2001&#xFF0C;&#x6709;&#x65F6;&#x7B80;&#x79F0;&#x4E3A;POSIX.1-2001&#xFF08;&#x968F;&#x540E;&#xFF0C;&#x53C8;&#x83B7;&#x6279;&#x4E3A;ISO&#x6807;&#x51C6;&#xFF1A;ISO/IEC 9945:2002&#xFF09;&#x3002;</p>
<p>POSIX 1003.1-2001&#x53D6;&#x4EE3;&#x4E86;SUSv2&#x3001;POSIX.1&#x3001;POSIX.2&#x4EE5;&#x53CA;&#x5927;&#x6279;&#x7684;&#x65E9;&#x671F;POSIX&#x6807;&#x51C6;&#x3002;&#x6709;&#x65F6;&#xFF0C;&#x4EBA;&#x4EEC;&#x4E5F;&#x5C06;&#x8BE5;&#x6807;&#x51C6;&#x79F0;&#x4E3A;Single Unix Specification&#x7248;&#x672C;3&#xFF0C;&#x672C;&#x4E66;&#x5728;&#x540E;&#x7EED;&#x5185;&#x5BB9;&#x4E2D;&#x5C06;&#x79F0;&#x5176;&#x4E3A;SUSv3&#x3002;</p>
<p>SUSv3&#x57FA;&#x672C;&#x89C4;&#x8303;&#x7EA6;&#x6709;3700&#x9875;&#xFF0C;&#x5206;&#x4E3A;&#x4EE5;&#x4E0B;4&#x90E8;&#x5206;&#x3002;</p>
<ul>
<li>&#x57FA;&#x672C;&#x5B9A;&#x4E49;&#xFF08;XBD&#xFF09;&#xFF0C;&#x5305;&#x542B;&#x4E86;&#x5B9A;&#x4E49;&#x3001;&#x672F;&#x8BED;&#x3001;&#x6982;&#x5FF5;&#x4EE5;&#x53CA;&#x5BF9;&#x5934;&#x6587;&#x4EF6;&#x5185;&#x5BB9;&#x7684;&#x89C4;&#x8303;&#x3002;&#x603B;&#x8BA1;&#x63D0;&#x4F9B;&#x4E86;84&#x4E2A;&#x5934;&#x6587;&#x4EF6;&#x7684;&#x89C4;&#x8303;&#x3002;</li>
<li>&#x7CFB;&#x7EDF;&#x63A5;&#x53E3;&#xFF08;XSH&#xFF09;&#xFF0C;&#x9996;&#x5148;&#x4ECB;&#x7ECD;&#x4E86;&#x5404;&#x79CD;&#x6709;&#x7528;&#x7684;&#x80CC;&#x666F;&#x4FE1;&#x606F;&#x3002;&#x4E3B;&#x8981;&#x5185;&#x5BB9;&#x5305;&#x542B;&#x5BF9;&#x5404;&#x79CD;&#x51FD;&#x6570;&#xFF08;&#x5728;&#x7279;&#x5B9A;&#x7684;UNIX&#x5B9E;&#x73B0;&#x4E2D;&#xFF0C;&#x8FD9;&#x4E9B;&#x51FD;&#x6570;&#x8981;&#x4E48;&#x662F;&#x4F5C;&#x4E3A;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF0C;&#x8981;&#x4E48;&#x662F;&#x4F5C;&#x4E3A;&#x5E93;&#x51FD;&#x6570;&#x6765;&#x5B9E;&#x73B0;&#x7684;&#xFF09;&#x7684;&#x5B9A;&#x4E49;&#x3002;&#x603B;&#x8BA1;&#x5305;&#x62EC;&#x4E86;1123&#x4E2A;&#x7CFB;&#x7EDF;&#x63A5;&#x53E3;&#x3002;</li>
<li>Shell&#x548C;&#x5B9E;&#x7528;&#x5DE5;&#x5177;&#xFF08;XCU&#xFF09;&#xFF0C;&#x660E;&#x786E;&#x5B9A;&#x4E49;&#x4E86;shell&#x548C;&#x5404;&#x79CD;UNIX&#x547D;&#x4EE4;&#x7684;&#x884C;&#x4E3A;&#x3002;&#x603B;&#x5171;&#x5B9A;&#x4E49;&#x4E86;160&#x4E2A;&#x5B9E;&#x7528;&#x5DE5;&#x5177;&#x7684;&#x884C;&#x4E3A;&#x3002;</li>
<li>&#x57FA;&#x672C;&#x539F;&#x7406;&#xFF08;XRAT&#xFF09;&#xFF0C;&#x5305;&#x62EC;&#x4E86;&#x4E0E;&#x524D;&#x4E09;&#x90E8;&#x5206;&#x6709;&#x5173;&#x7684;&#x63CF;&#x8FF0;&#x6027;&#x6587;&#x5B57;&#x548C;&#x539F;&#x7406;&#x8BF4;&#x660E;&#x3002;</li>
</ul>
<h1 id="&#x7CFB;&#x7EDF;&#x8C03;&#x7528;"><a href="#&#x7CFB;&#x7EDF;&#x8C03;&#x7528;" class="headerlink" title="&#x7CFB;&#x7EDF;&#x8C03;&#x7528;"></a>&#x7CFB;&#x7EDF;&#x8C03;&#x7528;</h1><p>&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x662F;&#x53D7;&#x63A7;&#x7684;&#x5185;&#x6838;&#x5165;&#x53E3;&#xFF0C;&#x501F;&#x52A9;&#x4E8E;&#x8FD9;&#x4E00;&#x673A;&#x5236;&#xFF0C;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x8BF7;&#x6C42;&#x5185;&#x6838;&#x4EE5;&#x81EA;&#x5DF1;&#x7684;&#x540D;&#x4E49;&#x53BB;&#x6267;&#x884C;&#x67D0;&#x4E9B;&#x52A8;&#x4F5C;&#x3002;&#x4EE5;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7F16;&#x7A0B;&#x63A5;&#x53E3;&#xFF08;API&#xFF09;&#x7684;&#x5F62;&#x5F0F;&#xFF0C;&#x5185;&#x6838;&#x63D0;&#x4F9B;&#x6709;&#x4E00;&#x7CFB;&#x5217;&#x670D;&#x52A1;&#x4F9B;&#x7A0B;&#x5E8F;&#x8BBF;&#x95EE;&#x3002;&#x8FD9;&#x5305;&#x62EC;&#x521B;&#x5EFA;&#x65B0;&#x8FDB;&#x7A0B;&#x3001;&#x6267;&#x884C;I/O&#xFF0C;&#x4EE5;&#x53CA;&#x4E3A;&#x8FDB;&#x7A0B;&#x95F4;&#x901A;&#x4FE1;&#x521B;&#x5EFA;&#x7BA1;&#x9053;&#x7B49;&#x3002;<br>&#x5728;Linux&#x4E0A;&#xFF0C;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x670D;&#x52A1;&#x4F8B;&#x7A0B;&#x9075;&#x5FAA;&#x7684;&#x60EF;&#x4F8B;&#x662F;&#x8C03;&#x7528;&#x6210;&#x529F;&#x5219;&#x8FD4;&#x56DE;&#x975E;&#x8D1F;&#x503C;&#x3002;<br></p><div class="amp-img-wrapper"><amp-img src="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1580987189206.png?x-oss-process=image/resize,m_lfit,h_450" width="454" height="450" layout="responsive"></amp-img></div><br>&#x53EF;&#x4EE5;&#x4EE5;getppid()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x4E3A;&#x4F8B;&#xFF0C;&#x7814;&#x5224;&#x4E00;&#x4E0B;&#x53D1;&#x8D77;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x7684;&#x5F00;&#x9500;&#x2014;&#x2014;&#x8BE5;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x53EA;&#x662F;&#x7B80;&#x5355;&#x5730;&#x8FD4;&#x56DE;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x7684;&#x7236;&#x8FDB;&#x7A0B;ID&#x3002;&#x5728;&#x4F5C;&#x8005;&#x7684;&#x4E00;&#x53F0;&#x8FD0;&#x884C;Linux 2.6.25&#x7684;x86-32&#x7CFB;&#x7EDF;&#x4E0A;&#xFF0C;&#x8C03;&#x7528;getppid()&#x4E00;&#x5343;&#x4E07;&#x6B21;&#x5927;&#x7EA6;&#x9700;&#x8981;2.2&#x79D2;&#x949F;&#xFF0C;&#x6BCF;&#x6B21;&#x8C03;&#x7528;&#x5927;&#x81F4;&#x9700;&#x8981;0.3&#x5FAE;&#x79D2;&#x3002;&#x76F8;&#x5F62;&#x4E4B;&#x4E0B;&#xFF0C;&#x5728;&#x540C;&#x4E00;&#x7CFB;&#x7EDF;&#x4E0A;&#xFF0C;&#x8C03;&#x7528;&#x67D0;&#x4E2A;&#x53EA;&#x8FD4;&#x56DE;&#x6574;&#x6570;&#x7684;C&#x8BED;&#x8A00;&#x51FD;&#x6570;&#x4E00;&#x5343;&#x4E07;&#x6B21;&#xFF0C;&#x4EC5;&#x9700;0.11&#x79D2;&#xFF0C;&#x7EA6;&#x4E3A;&#x8C03;&#x7528;getppid()&#x8017;&#x8D39;&#x65F6;&#x95F4;&#x7684;1/20&#x3002;&#x5F53;&#x7136;&#xFF0C;&#x5927;&#x591A;&#x6570;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x7684;&#x5F00;&#x9500;&#x90FD;&#x660E;&#x663E;&#x9AD8;&#x4E8E;getppid()&#x3002;
<h1 id="&#x5E93;&#x51FD;&#x6570;"><a href="#&#x5E93;&#x51FD;&#x6570;" class="headerlink" title="&#x5E93;&#x51FD;&#x6570;"></a>&#x5E93;&#x51FD;&#x6570;</h1><h2 id="GNUC"><a href="#GNUC" class="headerlink" title="GNUC"></a>GNUC</h2><p>&#x4E00;&#x4E2A;&#x5E93;&#x51FD;&#x6570;&#x662F;&#x6784;&#x6210;&#x6807;&#x51C6;C&#x8BED;&#x8A00;&#x51FD;&#x6570;&#x5E93;&#x7684;&#x4F17;&#x591A;&#x5E93;&#x51FD;&#x6570;&#x4E4B;&#x4E00;&#x3002;&#xFF08;&#x51FA;&#x4E8E;&#x7B80;&#x5316;&#xFF0C;&#x672C;&#x4E66;&#x540E;&#x6587;&#x63D0;&#x5230;&#x67D0;&#x5177;&#x4F53;&#x51FD;&#x6570;&#x65F6;&#xFF0C;&#x901A;&#x5E38;&#x5C06;&#x5176;&#x79F0;&#x4E3A;&#x201C;&#x51FD;&#x6570;&#x201D;&#x800C;&#x975E;&#x201C;&#x5E93;&#x51FD;&#x6570;&#x201D;&#x3002;&#xFF09;&#x5E93;&#x51FD;&#x6570;&#x7684;&#x7528;&#x9014;&#x591A;&#x79CD;&#x591A;&#x6837;&#xFF0C;&#x53EF;&#x7528;&#x6765;&#x6267;&#x884C;&#x4EE5;&#x4E0B;&#x4EFB;&#x52A1;&#xFF1A;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x3001;&#x5C06;&#x65F6;&#x95F4;&#x8F6C;&#x6362;&#x4E3A;&#x53EF;&#x8BFB;&#x683C;&#x5F0F;&#xFF0C;&#x4EE5;&#x53CA;&#x8FDB;&#x884C;&#x5B57;&#x7B26;&#x4E32;&#x6BD4;&#x8F83;&#x7B49;&#x3002;</p>
<p>&#x8BB8;&#x591A;&#x5E93;&#x51FD;&#x6570;&#xFF08;&#x6BD4;&#x5982;&#xFF0C;&#x5B57;&#x7B26;&#x4E32;&#x64CD;&#x4F5C;&#x51FD;&#x6570;&#xFF09;&#x4E0D;&#x4F1A;&#x4F7F;&#x7528;&#x4EFB;&#x4F55;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x3002;&#x53E6;&#x4E00;&#x65B9;&#x9762;&#xFF0C;&#x8FD8;&#x6709;&#x4E9B;&#x5E93;&#x51FD;&#x6570;&#x6784;&#x5EFA;&#x4E8E;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5C42;&#x4E4B;&#x4E0A;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x5E93;&#x51FD;&#x6570;fopen()&#x5C31;&#x5229;&#x7528;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;open()&#x6765;&#x6267;&#x884C;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x7684;&#x5B9E;&#x9645;&#x64CD;&#x4F5C;&#x3002;&#x5F80;&#x5F80;&#xFF0C;&#x8BBE;&#x8BA1;&#x5E93;&#x51FD;&#x6570;&#x662F;&#x4E3A;&#x4E86;&#x63D0;&#x4F9B;&#x6BD4;&#x5E95;&#x5C42;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x66F4;&#x4E3A;&#x65B9;&#x4FBF;&#x7684;&#x8C03;&#x7528;&#x63A5;&#x53E3;&#x3002;&#x4F8B;&#x5982;&#xFF0C;printf()&#x51FD;&#x6570;&#x53EF;&#x63D0;&#x4F9B;&#x683C;&#x5F0F;&#x5316;&#x8F93;&#x51FA;&#x548C;&#x6570;&#x636E;&#x7F13;&#x5B58;&#x529F;&#x80FD;&#xFF0C;&#x800C;write()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x53EA;&#x80FD;&#x8F93;&#x51FA;&#x5B57;&#x8282;&#x5757;&#x3002;&#x540C;&#x7406;&#xFF0C;&#x4E0E;&#x5E95;&#x5C42;&#x7684;brk()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x76F8;&#x6BD4;&#xFF0C;malloc()&#x548C;free()&#x51FD;&#x6570;&#x8FD8;&#x6267;&#x884C;&#x4E86;&#x5404;&#x79CD;&#x767B;&#x8BB0;&#x7BA1;&#x7406;&#x5DE5;&#x4F5C;&#xFF0C;&#x5185;&#x5B58;&#x7684;&#x91CA;&#x653E;&#x548C;&#x5206;&#x914D;&#x4E5F;&#x56E0;&#x6B64;&#x800C;&#x5BB9;&#x6613;&#x8BB8;&#x591A;&#x3002;</p>
<p>&#x6807;&#x51C6;C&#x8BED;&#x8A00;&#x51FD;&#x6570;&#x5E93;&#x7684;&#x5B9E;&#x73B0;&#x968F;UNIX&#x7684;&#x5B9E;&#x73B0;&#x800C;&#x5F02;&#x3002;GNU C&#x8BED;&#x8A00;&#x51FD;&#x6570;&#x5E93;&#xFF08;glibc, <a href="https://www.gnu.org" target="_blank" rel="noopener">https://www.gnu.org</a> /software/libc/ &#xFF09;&#x662F;Linux&#x4E0A;&#x6700;&#x5E38;&#x7528;&#x7684;&#x5B9E;&#x73B0;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token comment" spellcheck="true">//&#x67E5;&#x770B;linux&#x4E0A;gnuc&#x7684;&#x7248;&#x672C;</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;gnu/libc-version.h&gt;</span></span>
<span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">gnu_get_libc_version</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h1 id="POSIX&#x6807;&#x51C6;"><a href="#POSIX&#x6807;&#x51C6;" class="headerlink" title="POSIX&#x6807;&#x51C6;"></a>POSIX&#x6807;&#x51C6;</h1><p>&#x672F;&#x8BED;&#x201C;POSIX&#xFF08;&#x53EF;&#x79FB;&#x690D;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;Portable Operating System Interface&#x7684;&#x7F29;&#x5199;&#xFF09;&#x201D;&#x662F;&#x6307;&#x5728;IEEE&#xFF08;&#x7535;&#x5668;&#x53CA;&#x7535;&#x5B50;&#x5DE5;&#x7A0B;&#x5E08;&#x534F;&#x4F1A;&#xFF09;&#xFF0C;&#x786E;&#x5207;&#x5730;&#x8BF4;&#x662F;&#x5176;&#x4E0B;&#x5C5E;&#x7684;&#x53EF;&#x79FB;&#x690D;&#x5E94;&#x7528;&#x6807;&#x51C6;&#x59D4;&#x5458;&#x4F1A;&#xFF08;PASC, <a href="https://www.pasc.org/" target="_blank" rel="noopener">https://www.pasc.org/</a> &#xFF09;&#x8D5E;&#x52A9;&#x4E0B;&#x6240;&#x5F00;&#x53D1;&#x7684;&#x4E00;&#x7CFB;&#x5217;&#x6807;&#x51C6;&#x3002;PASC&#x6807;&#x51C6;&#x7684;&#x76EE;&#x6807;&#x662F;&#x63D0;&#x5347;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5728;&#x6E90;&#x7801;&#x7EA7;&#x522B;&#x7684;&#x53EF;&#x79FB;&#x690D;&#x6027;&#x3002;<br>&#x7B26;&#x5408;POSIX.1&#x6807;&#x51C6;&#x7684;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x5E94;&#x5411;&#x7A0B;&#x5E8F;&#x63D0;&#x4F9B;&#x8C03;&#x7528;&#x5404;&#x9879;&#x670D;&#x52A1;&#x7684;API&#xFF0C;POSIX.1&#x6587;&#x6863;&#x5BF9;&#x6B64;&#x4F5C;&#x4E86;&#x89C4;&#x8303;&#x3002;&#x51E1;&#x662F;&#x63D0;&#x4F9B;&#x4E86;&#x4E0A;&#x8FF0;API&#x7684;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x90FD;&#x53EF;&#x88AB;&#x8BA4;&#x5B9A;&#x4E3A;&#x7B26;&#x5408;POSIX.1&#x6807;&#x51C6;&#x3002;</p>
<p>POSIX.1&#x57FA;&#x4E8E;UNIX&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x548C;C&#x8BED;&#x8A00;&#x5E93;&#x51FD;&#x6570;&#xFF0C;&#x4F46;&#x65E0;&#x9700;&#x4E0E;&#x4EFB;&#x4F55;&#x7279;&#x6B8A;&#x5B9E;&#x73B0;&#x76F8;&#x5173;&#x3002;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x4EFB;&#x4F55;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x90FD;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x8BE5;&#x63A5;&#x53E3;&#xFF0C;&#x800C;&#x4E0D;&#x4E00;&#x5B9A;&#x8981;&#x662F;UNIX&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x3002;&#x5B9E;&#x9645;&#x4E0A;&#xFF0C;&#x5728;&#x4E0D;&#x5BF9;&#x5E95;&#x5C42;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x5927;&#x52A0;&#x6539;&#x52A8;&#x7684;&#x540C;&#x65F6;&#xFF0C;&#x4E00;&#x4E9B;&#x5382;&#x5546;&#x901A;&#x8FC7;&#x6DFB;&#x52A0; API &#x5DF2;&#x7ECF;&#x4F7F;&#x81EA;&#x5DF1;&#x7684;&#x4E13;&#x6709;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x7B26;&#x5408;&#x4E86; POSIX.1&#x6807;&#x51C6;&#x3002;</p>
<p>POSIX.2&#xFF08;1992&#xFF0C;ISO/IEC 9945-2:1993&#xFF09;&#x8FD9;&#x4E00;&#x4E0E;POSIX.1&#x76F8;&#x5173;&#x7684;&#x6807;&#x51C6;&#xFF0C;&#x5BF9;shell&#x548C;&#x5305;&#x62EC;C&#x7F16;&#x8BD1;&#x5668;&#x547D;&#x4EE4;&#x884C;&#x63A5;&#x53E3;&#x5728;&#x5185;&#x7684;&#x5404;&#x79CD;UNIX&#x5DE5;&#x5177;&#x8FDB;&#x884C;&#x4E86;&#x6807;&#x51C6;&#x5316;&#x3002;</p>
<h1 id="&#x5185;&#x6838;&#x7684;&#x804C;&#x8D23;"><a href="#&#x5185;&#x6838;&#x7684;&#x804C;&#x8D23;" class="headerlink" title="&#x5185;&#x6838;&#x7684;&#x804C;&#x8D23;"></a>&#x5185;&#x6838;&#x7684;&#x804C;&#x8D23;</h1><p><strong>&#x8FDB;&#x7A0B;&#x8C03;&#x5EA6;&#xFF1A;</strong>&#x8BA1;&#x7B97;&#x673A;&#x5185;&#x5747;&#x914D;&#x5907;&#x6709;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;CPU&#xFF08;&#x4E2D;&#x592E;&#x5904;&#x7406;&#x5355;&#x5143;&#xFF09;&#xFF0C;&#x4EE5;&#x6267;&#x884C;&#x7A0B;&#x5E8F;&#x6307;&#x4EE4;&#x3002;&#x4E0E;&#x5176;&#x4ED6;UNIX&#x7CFB;&#x7EDF;&#x4E00;&#x6837;&#xFF0C;Linux&#x5C5E;&#x4E8E;&#x62A2;&#x5360;&#x5F0F;&#x591A;&#x4EFB;&#x52A1;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x3002;&#x201C;&#x591A;&#x4EFB;&#x52A1;&#x201D;&#x610F;&#x6307;&#x591A;&#x4E2A;&#x8FDB;&#x7A0B;&#xFF08;&#x5373;&#x8FD0;&#x884C;&#x4E2D;&#x7684;&#x7A0B;&#x5E8F;&#xFF09;&#x53EF;&#x540C;&#x65F6;&#x9A7B;&#x7559;&#x4E8E;&#x5185;&#x5B58;&#xFF0C;&#x4E14;&#x6BCF;&#x4E2A;&#x8FDB;&#x7A0B;&#x90FD;&#x80FD;&#x83B7;&#x5F97;&#x5BF9;CPU&#x7684;&#x4F7F;&#x7528;&#x6743;&#x3002;&#x201C;&#x62A2;&#x5360;&#x201D;&#x5219;&#x662F;&#x6307;&#x4E00;&#x7EC4;&#x89C4;&#x5219;&#x3002;&#x8FD9;&#x7EC4;&#x89C4;&#x5219;&#x63A7;&#x5236;&#x7740;&#x54EA;&#x4E9B;&#x8FDB;&#x7A0B;&#x83B7;&#x5F97;&#x5BF9;CPU&#x7684;&#x4F7F;&#x7528;&#xFF0C;&#x4EE5;&#x53CA;&#x6BCF;&#x4E2A;&#x8FDB;&#x7A0B;&#x80FD;&#x4F7F;&#x7528;&#x591A;&#x957F;&#x65F6;&#x95F4;&#xFF0C;&#x8FD9;&#x4E24;&#x8005;&#x90FD;&#x7531;&#x5185;&#x6838;&#x8FDB;&#x7A0B;&#x8C03;&#x5EA6;&#x7A0B;&#x5E8F;&#xFF08;&#x800C;&#x975E;&#x8FDB;&#x7A0B;&#x672C;&#x8EAB;&#xFF09;&#x51B3;&#x5B9A;&#x3002;</p>
<p><strong>&#x5185;&#x5B58;&#x7BA1;&#x7406;&#xFF1A;</strong>&#x4EE5;&#x4E00;&#x4E8C;&#x5341;&#x5E74;&#x524D;&#x7684;&#x6807;&#x51C6;&#x6765;&#x770B;&#xFF0C;&#x5982;&#x4ECA;&#x8BA1;&#x7B97;&#x673A;&#x7684;&#x5185;&#x5B58;&#x5BB9;&#x91CF;&#x53EF;&#x8C13;&#x76F8;&#x5F53;&#x53EF;&#x89C2;&#xFF0C;&#x4F46;&#x8F6F;&#x4EF6;&#x7684;&#x89C4;&#x6A21;&#x4E5F;&#x4FDD;&#x6301;&#x4E86;&#x76F8;&#x5E94;&#x5730;&#x589E;&#x957F;&#xFF0C;&#x6545;&#x800C;&#x7269;&#x7406;&#x5185;&#x5B58;&#xFF08;RAM&#xFF09;&#x4ECD;&#x7136;&#x5C5E;&#x4E8E;&#x6709;&#x9650;&#x8D44;&#x6E90;&#xFF0C;&#x5185;&#x6838;&#x5FC5;&#x987B;&#x4EE5;&#x516C;&#x5E73;&#x3001;&#x9AD8;&#x6548;&#x5730;&#x65B9;&#x5F0F;&#x5728;&#x8FDB;&#x7A0B;&#x95F4;&#x5171;&#x4EAB;&#x8FD9;&#x4E00;&#x8D44;&#x6E90;&#x3002;&#x4E0E;&#x5927;&#x591A;&#x6570;&#x73B0;&#x4EE3;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x4E00;&#x6837;&#xFF0C;Linux&#x4E5F;&#x91C7;&#x7528;&#x4E86;&#x865A;&#x62DF;&#x5185;&#x5B58;&#x7BA1;&#x7406;&#x673A;&#x5236;&#xFF08;6.4&#x8282;&#xFF09;&#xFF0C;&#x8FD9;&#x9879;&#x6280;&#x672F;&#x4E3B;&#x8981;&#x5177;&#x6709;&#x4EE5;&#x4E0B;&#x4E24;&#x65B9;&#x9762;&#x7684;&#x4F18;&#x52BF;&#x3002;</p>
<ul>
<li>&#x8FDB;&#x7A0B;&#x4E0E;&#x8FDB;&#x7A0B;&#x4E4B;&#x95F4;&#x3001;&#x8FDB;&#x7A0B;&#x4E0E;&#x5185;&#x6838;&#x4E4B;&#x95F4;&#x5F7C;&#x6B64;&#x9694;&#x79BB;&#xFF0C;&#x56E0;&#x6B64;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x65E0;&#x6CD5;&#x8BFB;&#x53D6;&#x6216;&#x4FEE;&#x6539;&#x5185;&#x6838;&#x6216;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x7684;&#x5185;&#x5B58;&#x5185;&#x5BB9;&#x3002;</li>
<li>&#x53EA;&#x9700;&#x5C06;&#x8FDB;&#x7A0B;&#x7684;&#x4E00;&#x90E8;&#x5206;&#x4FDD;&#x6301;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#xFF0C;&#x8FD9;&#x4E0D;&#x4F46;&#x964D;&#x4F4E;&#x4E86;&#x6BCF;&#x4E2A;&#x8FDB;&#x7A0B;&#x5BF9;&#x5185;&#x5B58;&#x7684;&#x9700;&#x6C42;&#x91CF;&#xFF0C;&#x800C;&#x4E14;&#x8FD8;&#x80FD;&#x5728;RAM&#x4E2D;&#x540C;&#x65F6;&#x52A0;&#x8F7D;&#x66F4;&#x591A;&#x7684;&#x8FDB;&#x7A0B;&#x3002;&#x8FD9;&#x4E5F;&#x5927;&#x5E45;&#x63D0;&#x5347;&#x4E86;&#x5982;&#x4E0B;&#x4E8B;&#x4EF6;&#x7684;&#x53D1;&#x751F;&#x6982;&#x7387;&#xFF0C;&#x5728;&#x4EFB;&#x4E00;&#x65F6;&#x523B;&#xFF0C;CPU&#x90FD;&#x6709;&#x81F3;&#x5C11;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x6267;&#x884C;&#xFF0C;&#x4ECE;&#x800C;&#x4F7F;&#x5F97;&#x5BF9;CPU&#x8D44;&#x6E90;&#x7684;&#x5229;&#x7528;&#x66F4;&#x52A0;&#x5145;&#x5206;&#x3002;</li>
</ul>
<p><strong>&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#xFF1A;</strong>&#x5185;&#x6838;&#x5728;&#x78C1;&#x76D8;&#x4E4B;&#x4E0A;&#x63D0;&#x4F9B;&#x6709;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#xFF0C;&#x5141;&#x8BB8;&#x5BF9;&#x6587;&#x4EF6;&#x6267;&#x884C;&#x521B;&#x5EFA;&#x3001;&#x83B7;&#x53D6;&#x3001;&#x66F4;&#x65B0;&#x4EE5;&#x53CA;&#x5220;&#x9664;&#x7B49;&#x64CD;&#x4F5C;&#x3002;</p>
<p>&#x521B;&#x5EFA;&#x548C;&#x7EC8;&#x6B62;&#x8FDB;&#x7A0B;&#xFF1A;&#x5185;&#x6838;&#x53EF;&#x5C06;&#x65B0;&#x7A0B;&#x5E8F;&#x8F7D;&#x5165;&#x5185;&#x5B58;&#xFF0C;&#x4E3A;&#x5176;&#x63D0;&#x4F9B;&#x8FD0;&#x884C;&#x6240;&#x9700;&#x7684;&#x8D44;&#x6E90;&#xFF08;&#x6BD4;&#x5982;&#xFF0C;CPU&#x3001;&#x5185;&#x5B58;&#x4EE5;&#x53CA;&#x5BF9;&#x6587;&#x4EF6;&#x7684;&#x8BBF;&#x95EE;&#x7B49;&#xFF09;&#x3002;&#x8FD9;&#x6837;&#x4E00;&#x4E2A;&#x8FD0;&#x884C;&#x4E2D;&#x7684;&#x7A0B;&#x5E8F;&#x6211;&#x4EEC;&#x79F0;&#x4E4B;&#x4E3A;&#x201C;&#x8FDB;&#x7A0B;&#x201D;&#x3002;&#x4E00;&#x65E6;&#x8FDB;&#x7A0B;&#x6267;&#x884C;&#x5B8C;&#x6BD5;&#xFF0C;&#x5185;&#x6838;&#x8FD8;&#x8981;&#x786E;&#x4FDD;&#x91CA;&#x653E;&#x5176;&#x5360;&#x7528;&#x8D44;&#x6E90;&#xFF0C;&#x4EE5;&#x4F9B;&#x540E;&#x7EED;&#x7A0B;&#x5E8F;&#x91CD;&#x65B0;&#x4F7F;&#x7528;&#x3002;</p>
<p><strong>&#x8BBE;&#x5907;&#x8BBF;&#x95EE;&#xFF1A;</strong>&#x8BA1;&#x7B97;&#x673A;&#x5916;&#x63A5;&#x8BBE;&#x5907;&#xFF08;&#x9F20;&#x6807;&#x3001;&#x952E;&#x76D8;&#x3001;&#x78C1;&#x76D8;&#x548C;&#x78C1;&#x5E26;&#x9A71;&#x52A8;&#x5668;&#x7B49;&#xFF09;&#x53EF;&#x5B9E;&#x73B0;&#x8BA1;&#x7B97;&#x673A;&#x4E0E;&#x5916;&#x90E8;&#x4E16;&#x754C;&#x7684;&#x901A;&#x4FE1;&#xFF0C;&#x8FD9;&#x4E00;&#x901A;&#x4FE1;&#x673A;&#x5236;&#x5305;&#x62EC;&#x8F93;&#x5165;&#x3001;&#x8F93;&#x51FA;&#x6216;&#x662F;&#x4E24;&#x8005;&#x517C;&#x800C;&#x6709;&#x4E4B;&#x3002;&#x5185;&#x6838;&#x65E2;&#x4E3A;&#x7A0B;&#x5E8F;&#x8BBF;&#x95EE;&#x8BBE;&#x5907;&#x63D0;&#x4F9B;&#x4E86;&#x7B80;&#x5316;&#x7248;&#x7684;&#x6807;&#x51C6;&#x63A5;&#x53E3;&#xFF0C;&#x540C;&#x65F6;&#x8FD8;&#x8981;&#x4EF2;&#x88C1;&#x591A;&#x4E2A;&#x8FDB;&#x7A0B;&#x5BF9;&#x6BCF;&#x4E00;&#x4E2A;&#x8BBE;&#x5907;&#x7684;&#x8BBF;&#x95EE;&#x3002;</p>
<p><strong>&#x8054;&#x7F51;&#xFF1A;</strong>&#x5185;&#x6838;&#x4EE5;&#x7528;&#x6237;&#x8FDB;&#x7A0B;&#x7684;&#x540D;&#x4E49;&#x6536;&#x53D1;&#x7F51;&#x7EDC;&#x6D88;&#x606F;&#xFF08;&#x6570;&#x636E;&#x5305;&#xFF09;&#x3002;&#x8BE5;&#x4EFB;&#x52A1;&#x5305;&#x62EC;&#x5C06;&#x7F51;&#x7EDC;&#x6570;&#x636E;&#x5305;&#x8DEF;&#x7531;&#x81F3;&#x76EE;&#x6807;&#x7CFB;&#x7EDF;&#x3002;</p>
<p><strong>&#x63D0;&#x4F9B;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5E94;&#x7528;&#x7F16;&#x7A0B;&#x63A5;&#x53E3;&#xFF08;API&#xFF09;&#xFF1A;</strong>&#x8FDB;&#x7A0B;&#x53EF;&#x5229;&#x7528;&#x5185;&#x6838;&#x5165;&#x53E3;&#x70B9;&#xFF08;&#x4E5F;&#x79F0;&#x4E3A;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF09;&#x8BF7;&#x6C42;&#x5185;&#x6838;&#x53BB;&#x6267;&#x884C;&#x5404;&#x79CD;&#x4EFB;&#x52A1;&#x3002;</p>
<p>&#x9664;&#x4E86;&#x4E0A;&#x8FF0;&#x7279;&#x6027;&#x5916;&#xFF0C;&#x4E00;&#x822C;&#x800C;&#x8A00;&#xFF0C;&#x8BF8;&#x5982;Linux&#x4E4B;&#x7C7B;&#x7684;&#x591A;&#x7528;&#x6237;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x4F1A;&#x4E3A;&#x6BCF;&#x4E2A;&#x7528;&#x6237;&#x8425;&#x9020;&#x4E00;&#x79CD;&#x62BD;&#x8C61;&#xFF1A;&#x865A;&#x62DF;&#x79C1;&#x6709;&#x8BA1;&#x7B97;&#x673A;&#xFF08;virtual private computer&#xFF09;&#x3002;&#x8FD9;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x6BCF;&#x4E2A;&#x7528;&#x6237;&#x90FD;&#x53EF;&#x4EE5;&#x767B;&#x5F55;&#x8FDB;&#x5165;&#x7CFB;&#x7EDF;&#xFF0C;&#x72EC;&#x7ACB;&#x64CD;&#x4F5C;&#xFF0C;&#x800C;&#x4E0E;&#x5176;&#x4ED6;&#x7528;&#x6237;&#x5927;&#x81F4;&#x65E0;&#x5E72;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x6BCF;&#x4E2A;&#x7528;&#x6237;&#x90FD;&#x6709;&#x5C5E;&#x4E8E;&#x81EA;&#x5DF1;&#x7684;&#x78C1;&#x76D8;&#x5B58;&#x50A8;&#x7A7A;&#x95F4;&#xFF08;&#x4E3B;&#x76EE;&#x5F55;&#xFF09;&#x3002;&#x518D;&#x8005;&#xFF0C;&#x7528;&#x6237;&#x80FD;&#x591F;&#x8FD0;&#x884C;&#x7A0B;&#x5E8F;&#xFF0C;&#x800C;&#x6BCF;&#x4E00;&#x7A0B;&#x5E8F;&#x90FD;&#x80FD;&#x4ECE;CPU&#x8D44;&#x6E90;&#x4E2D;&#x201C;&#x5206;&#x5F97;&#x4E00;&#x676F;&#x7FB9;&#x201D;&#xFF0C;&#x8FD0;&#x8F6C;&#x4E8E;&#x81EA;&#x6709;&#x7684;&#x865A;&#x62DF;&#x5730;&#x5740;&#x7A7A;&#x95F4;&#x4E2D;&#x3002;&#x800C;&#x4E14;&#x8FD9;&#x4E9B;&#x7A0B;&#x5E8F;&#x8FD8;&#x80FD;&#x72EC;&#x7ACB;&#x8BBF;&#x95EE;&#x8BBE;&#x5907;&#xFF0C;&#x5E76;&#x901A;&#x8FC7;&#x7F51;&#x7EDC;&#x4F20;&#x9012;&#x4FE1;&#x606F;&#x3002;&#x5185;&#x6838;&#x8D1F;&#x8D23;&#x89E3;&#x51B3;&#xFF08;&#x591A;&#x8FDB;&#x7A0B;&#xFF09;&#x8BBF;&#x95EE;&#x786C;&#x4EF6;&#x8D44;&#x6E90;&#x65F6;&#x53EF;&#x80FD;&#x5F15;&#x53D1;&#x7684;&#x51B2;&#x7A81;&#xFF0C;&#x7528;&#x6237;&#x548C;&#x8FDB;&#x7A0B;&#x5BF9;&#x6B64;&#x5219;&#x5F80;&#x5F80;&#x4E00;&#x65E0;&#x6240;&#x77E5;&#x3002;</p>
<h1 id="&#x5185;&#x6838;&#x6001;&#x548C;&#x7528;&#x6237;&#x6001;"><a href="#&#x5185;&#x6838;&#x6001;&#x548C;&#x7528;&#x6237;&#x6001;" class="headerlink" title="&#x5185;&#x6838;&#x6001;&#x548C;&#x7528;&#x6237;&#x6001;"></a>&#x5185;&#x6838;&#x6001;&#x548C;&#x7528;&#x6237;&#x6001;</h1><p>&#x73B0;&#x4EE3;&#x5904;&#x7406;&#x5668;&#x67B6;&#x6784;&#x4E00;&#x822C;&#x5141;&#x8BB8;CPU&#x81F3;&#x5C11;&#x5728;&#x4E24;&#x79CD;&#x4E0D;&#x540C;&#x72B6;&#x6001;&#x4E0B;&#x8FD0;&#x884C;&#xFF0C;&#x5373;&#xFF1A;&#x7528;&#x6237;&#x6001;&#x548C;&#x6838;&#x5FC3;&#x6001;&#xFF08;&#x6709;&#x65F6;&#x4E5F;&#x79F0;&#x4E4B;&#x4E3A;&#x76D1;&#x7BA1;&#x6001;supervisor mode&#xFF09;&#x3002;&#x6267;&#x884C;&#x786C;&#x4EF6;&#x6307;&#x4EE4;&#x53EF;&#x4F7F;CPU&#x5728;&#x4E24;&#x79CD;&#x72B6;&#x6001;&#x95F4;&#x6765;&#x56DE;&#x5207;&#x6362;&#x3002;&#x4E0E;&#x4E4B;&#x5BF9;&#x5E94;&#xFF0C;&#x53EF;&#x5C06;&#x865A;&#x62DF;&#x5185;&#x5B58;&#x533A;&#x57DF;&#x5212;&#x5206;&#xFF08;&#x6807;&#x8BB0;&#xFF09;&#x4E3A;&#x7528;&#x6237;&#x7A7A;&#x95F4;&#x90E8;&#x5206;&#x6216;&#x5185;&#x6838;&#x7A7A;&#x95F4;&#x90E8;&#x5206;&#x3002;&#x5728;&#x7528;&#x6237;&#x6001;&#x4E0B;&#x8FD0;&#x884C;&#x65F6;&#xFF0C;CPU&#x53EA;&#x80FD;&#x8BBF;&#x95EE;&#x88AB;&#x6807;&#x8BB0;&#x4E3A;&#x7528;&#x6237;&#x7A7A;&#x95F4;&#x7684;&#x5185;&#x5B58;&#xFF0C;&#x8BD5;&#x56FE;&#x8BBF;&#x95EE;&#x5C5E;&#x4E8E;&#x5185;&#x6838;&#x7A7A;&#x95F4;&#x7684;&#x5185;&#x5B58;&#x4F1A;&#x5F15;&#x53D1;&#x786C;&#x4EF6;&#x5F02;&#x5E38;&#x3002;&#x5F53;&#x8FD0;&#x884C;&#x4E8E;&#x6838;&#x5FC3;&#x6001;&#x65F6;&#xFF0C;CPU&#x65E2;&#x80FD;&#x8BBF;&#x95EE;&#x7528;&#x6237;&#x7A7A;&#x95F4;&#x5185;&#x5B58;&#xFF0C;&#x4E5F;&#x80FD;&#x8BBF;&#x95EE;&#x5185;&#x6838;&#x7A7A;&#x95F4;&#x5185;&#x5B58;&#x3002;</p>
<p>&#x4EC5;&#x5F53;&#x5904;&#x7406;&#x5668;&#x5728;&#x6838;&#x5FC3;&#x6001;&#x8FD0;&#x884C;&#x65F6;&#xFF0C;&#x624D;&#x80FD;&#x6267;&#x884C;&#x67D0;&#x4E9B;&#x7279;&#x5B9A;&#x64CD;&#x4F5C;&#x3002;&#x8FD9;&#x6837;&#x7684;&#x4F8B;&#x5B50;&#x5305;&#x62EC;&#xFF1A;&#x6267;&#x884C;&#x5B95;&#x673A;&#xFF08;halt&#xFF09;&#x6307;&#x4EE4;&#x53BB;&#x5173;&#x95ED;&#x7CFB;&#x7EDF;&#xFF0C;&#x8BBF;&#x95EE;&#x5185;&#x5B58;&#x7BA1;&#x7406;&#x786C;&#x4EF6;&#xFF0C;&#x4EE5;&#x53CA;&#x8BBE;&#x5907;I/O&#x64CD;&#x4F5C;&#x7684;&#x521D;&#x59CB;&#x5316;&#x7B49;&#x3002;&#x5B9E;&#x73B0;&#x8005;&#x4EEC;&#x5229;&#x7528;&#x8FD9;&#x4E00;&#x786C;&#x4EF6;&#x8BBE;&#x8BA1;&#xFF0C;&#x5C06;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x7F6E;&#x4E8E;&#x5185;&#x6838;&#x7A7A;&#x95F4;&#x3002;&#x8FD9;&#x786E;&#x4FDD;&#x4E86;&#x7528;&#x6237;&#x8FDB;&#x7A0B;&#x65E2;&#x4E0D;&#x80FD;&#x8BBF;&#x95EE;&#x5185;&#x6838;&#x6307;&#x4EE4;&#x548C;&#x6570;&#x636E;&#x7ED3;&#x6784;&#xFF0C;&#x4E5F;&#x65E0;&#x6CD5;&#x6267;&#x884C;&#x4E0D;&#x5229;&#x4E8E;&#x7CFB;&#x7EDF;&#x8FD0;&#x884C;&#x7684;&#x64CD;&#x4F5C;&#x3002;</p>
<h1 id="&#x6587;&#x4EF6;I-O"><a href="#&#x6587;&#x4EF6;I-O" class="headerlink" title="&#x6587;&#x4EF6;I/O"></a>&#x6587;&#x4EF6;I/O</h1><h2 id="&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;"><a href="#&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;" class="headerlink" title="&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;"></a>&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;</h2><p>&#x6240;&#x6709;&#x6267;&#x884C;I/O &#x64CD;&#x4F5C;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x90FD;&#x4EE5;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#xFF0C;&#x4E00;&#x4E2A;&#x975E;&#x8D1F;&#x6574;&#x6570;&#xFF08;&#x901A;&#x5E38;&#x662F;&#x5C0F;&#x6574;&#x6570;&#xFF09;&#xFF0C;&#x6765;&#x6307;&#x4EE3;&#x6253;&#x5F00;&#x7684;&#x6587;&#x4EF6;&#x3002;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x7528;&#x4EE5;&#x8868;&#x793A;&#x6240;&#x6709;&#x7C7B;&#x578B;&#x7684;&#x5DF2;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#xFF0C;&#x5305;&#x62EC;&#x7BA1;&#x9053;&#xFF08;pipe&#xFF09;&#x3001;FIFO&#x3001;socket&#x3001;&#x7EC8;&#x7AEF;&#x3001;&#x8BBE;&#x5907;&#x548C;&#x666E;&#x901A;&#x6587;&#x4EF6;&#x3002;&#x9488;&#x5BF9;&#x6BCF;&#x4E2A;&#x8FDB;&#x7A0B;&#xFF0C;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x90FD;&#x81EA;&#x6210;&#x4E00;&#x5957;&#x3002;</p>
<p>&#x5728;Linux&#x7CFB;&#x7EDF;&#x4E2D;&#x4E00;&#x5207;&#x7686;&#x53EF;&#x4EE5;&#x770B;&#x6210;&#x662F;&#x6587;&#x4EF6;&#xFF0C;&#x6587;&#x4EF6;&#x53C8;&#x53EF;&#x5206;&#x4E3A;&#xFF1A;&#x666E;&#x901A;&#x6587;&#x4EF6;&#x3001;&#x76EE;&#x5F55;&#x6587;&#x4EF6;&#x3001;&#x94FE;&#x63A5;&#x6587;&#x4EF6;&#x548C;&#x8BBE;&#x5907;&#x6587;&#x4EF6;&#x3002;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#xFF08;file descriptor&#xFF09;&#x662F;&#x5185;&#x6838;&#x4E3A;&#x4E86;&#x9AD8;&#x6548;&#x7BA1;&#x7406;&#x5DF2;&#x88AB;&#x6253;&#x5F00;&#x7684;&#x6587;&#x4EF6;&#x6240;&#x521B;&#x5EFA;&#x7684;&#x7D22;&#x5F15;&#xFF0C;&#x5176;&#x662F;&#x4E00;&#x4E2A;&#x975E;&#x8D1F;&#x6574;&#x6570;&#xFF08;&#x901A;&#x5E38;&#x662F;&#x5C0F;&#x6574;&#x6570;&#xFF09;&#xFF0C;&#x7528;&#x4E8E;&#x6307;&#x4EE3;&#x88AB;&#x6253;&#x5F00;&#x7684;&#x6587;&#x4EF6;&#xFF0C;&#x6240;&#x6709;&#x6267;&#x884C;I/O&#x64CD;&#x4F5C;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x90FD;&#x901A;&#x8FC7;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x3002;&#x7A0B;&#x5E8F;&#x521A;&#x521A;&#x542F;&#x52A8;&#x7684;&#x65F6;&#x5019;&#xFF0C;0&#x662F;&#x6807;&#x51C6;&#x8F93;&#x5165;&#xFF0C;1&#x662F;&#x6807;&#x51C6;&#x8F93;&#x51FA;&#xFF0C;2&#x662F;&#x6807;&#x51C6;&#x9519;&#x8BEF;&#x3002;&#x5982;&#x679C;&#x6B64;&#x65F6;&#x53BB;&#x6253;&#x5F00;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x6587;&#x4EF6;&#xFF0C;&#x5B83;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x4F1A;&#x662F;3&#x3002;</p>
<p>UNIX I/O &#x6A21;&#x578B;&#x7684;&#x663E;&#x8457;&#x7279;&#x70B9;&#x4E4B;&#x4E00;&#x662F;&#x5176;&#x8F93;&#x5165;/&#x8F93;&#x51FA;&#x7684;&#x901A;&#x7528;&#x6027;&#x6982;&#x5FF5;&#x3002;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x4F7F;&#x7528;4&#x4E2A;&#x540C;&#x6837;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;open()&#x3001;read()&#x3001;write()&#x548C;close()&#x53EF;&#x4EE5;&#x5BF9;&#x6240;&#x6709;&#x7C7B;&#x578B;&#x7684;&#x6587;&#x4EF6;&#x6267;&#x884C;I/O &#x64CD;&#x4F5C;&#xFF0C;&#x5305;&#x62EC;&#x7EC8;&#x7AEF;&#x4E4B;&#x7C7B;&#x7684;&#x8BBE;&#x5907;&#x3002;</p>
<p>UNIX I/O&#x6A21;&#x578B;&#x7684;&#x663E;&#x8457;&#x7279;&#x70B9;&#x4E4B;&#x4E00;&#x662F;&#x5176;&#x8F93;&#x5165;/&#x8F93;&#x51FA;&#x7684;&#x901A;&#x7528;&#x6027;&#x6982;&#x5FF5;&#x3002;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x4F7F;&#x7528;4&#x4E2A;&#x540C;&#x6837;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;open()&#x3001;read()&#x3001;write()&#x548C;close()&#x53EF;&#x4EE5;&#x5BF9;&#x6240;&#x6709;&#x7C7B;&#x578B;&#x7684;&#x6587;&#x4EF6;&#x6267;&#x884C;I/O&#x64CD;&#x4F5C;&#xFF0C;&#x5305;&#x62EC;&#x7EC8;&#x7AEF;&#x4E4B;&#x7C7B;&#x7684;&#x8BBE;&#x5907;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x4EC5;&#x4F7F;&#x7528;&#x8FD9;&#x4E9B;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x7F16;&#x5199;&#x7684;&#x7A0B;&#x5E8F;&#xFF0C;&#x5C06;&#x5BF9;&#x4EFB;&#x4F55;&#x7C7B;&#x578B;&#x7684;&#x6587;&#x4EF6;&#x6709;&#x6548;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x9488;&#x5BF9;&#x7A0B;&#x5E8F;&#x6E05;&#x5355;4-1&#x4E2D;&#x7684;&#x7A0B;&#x5E8F;&#xFF0C;&#x5982;&#x4E0B;&#x64CD;&#x4F5C;&#x90FD;&#x662F;&#x6709;&#x6548;&#x7684;&#xFF1A;</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">cp</span> <span class="token function">test</span> test.old <span class="token comment" spellcheck="true">#&#x590D;&#x5236;&#x6807;&#x51C6;&#x6587;&#x4EF6;</span>
<span class="token function">cp</span> a.txt /dev/tty <span class="token comment" spellcheck="true">#&#x590D;&#x5236;&#x6807;&#x51C6;&#x6587;&#x4EF6;&#x5230;&#x7EC8;&#x7AEF;</span>
<span class="token function">cp</span> /dev/tty b.txt <span class="token comment" spellcheck="true">#&#x590D;&#x5236;&#x7EC8;&#x7AEF;&#x7684;&#x8F93;&#x5165;&#x5185;&#x5BB9;&#x5230;&#x6807;&#x51C6;&#x6587;&#x4EF6;</span>
<span class="token function">cp</span> /dev/pts/16 /dev/tty <span class="token comment" spellcheck="true">#&#x4ECE;&#x4E00;&#x4E2A;&#x7EC8;&#x7AEF;&#x590D;&#x5236;&#x5230;&#x53E6;&#x4E00;&#x4E2A;&#x7EC8;&#x7AEF;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="open"><a href="#open" class="headerlink" title="open()"></a>open()</h2><p>open()&#x8C03;&#x7528;&#x65E2;&#x80FD;&#x6253;&#x5F00;&#x4E00;&#x4E2A;&#x4E1A;&#x5DF2;&#x5B58;&#x5728;&#x7684;&#x6587;&#x4EF6;&#xFF0C;&#x4E5F;&#x80FD;&#x521B;&#x5EFA;&#x5E76;&#x6253;&#x5F00;&#x4E00;&#x4E2A;&#x65B0;&#x6587;&#x4EF6;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property"># <span class="token directive keyword">include</span> <span class="token string">&lt;sys/stat.h&gt;</span></span>
<span class="token macro property"># <span class="token directive keyword">include</span> <span class="token string">&lt;fcntl.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>pathname<span class="token punctuation">,</span> <span class="token keyword">int</span> flags<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token comment" spellcheck="true">/* mod_t mode */</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>pathname&#xFF0C;&#x6587;&#x4EF6;&#x76EE;&#x5F55;.<br>flags&#xFF0C;&#x6253;&#x5F00;&#x5F62;&#x5F0F;,&#x7528;&#x4E8E;&#x6307;&#x5B9A;&#x6587;&#x4EF6;&#x7684;&#x8BBF;&#x95EE;&#x6A21;&#x5F0F;.<br>&#x5982;&#x679C;&#x8C03;&#x7528;&#x6210;&#x529F;&#xFF0C;open()&#x5C06;&#x8FD4;&#x56DE;&#x4E00;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#xFF0C;&#x7528;&#x4E8E;&#x5728;&#x540E;&#x7EED;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x4E2D;&#x6307;&#x4EE3;&#x8BE5;&#x6587;&#x4EF6;&#x3002;<br>&#x82E5;&#x53D1;&#x751F;&#x9519;&#x8BEF;&#xFF0C;&#x5219;&#x8FD4;&#x56DE;&#x2212;1&#xFF0C;&#x5E76;&#x5C06; errno &#x7F6E;&#x4E3A;&#x76F8;&#x5E94;&#x7684;&#x9519;&#x8BEF;&#x6807;&#x5FD7;&#x3002;&#x5982;&#x679C;&#x8C03;&#x7528; open()&#x6210;&#x529F;&#xFF0C;&#x5FC5;&#x987B;&#x4FDD;&#x8BC1;&#x5176;&#x8FD4;&#x56DE;&#x503C;&#x4E3A;&#x8FDB;&#x7A0B;&#x672A;&#x7528;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x4E2D;&#x6570;&#x503C;&#x6700;&#x5C0F;&#x8005;&#x3002;</p>
<p><strong>flags:</strong></p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>flags</th>
<th>&#x7528;&#x9014;</th>
<th>&#x7EDF;&#x4E00;UNIX&#x89C4;&#x8303;&#x7248;&#x672C;</th>
</tr>
</thead>
<tbody><tr>
<td>O_RDONLY</td>
<td>&#x4EE5;&#x53EA;&#x8BFB;&#x5F62;&#x5F0F;&#x6253;&#x5F00;</td>
<td>v3</td>
</tr>
<tr>
<td>O_WRONLY</td>
<td>&#x4EE5;&#x53EA;&#x5199;&#x65B9;&#x5F0F;&#x6253;&#x5F00;</td>
<td>v3</td>
</tr>
<tr>
<td>O_RDWR</td>
<td>&#x4EE5;&#x8BFB;&#x5199;&#x65B9;&#x5F0F;&#x6253;&#x5F00;</td>
<td>v3</td>
</tr>
<tr>
<td>O_CLOEXEC</td>
<td>&#x8BBE;&#x7F6E;close-on-exec&#x6807;&#x5FD7;</td>
<td>v4</td>
</tr>
<tr>
<td>O_CREAT</td>
<td>&#x82E5;&#x6587;&#x4EF6;&#x4E0D;&#x5B58;&#x5728;&#xFF0C;&#x5219;&#x521B;&#x5EFA;&#x6587;&#x4EF6;</td>
<td>v3</td>
</tr>
<tr>
<td>O_DIRECT</td>
<td>&#x65E0;&#x7F13;&#x51B2;&#x7684;&#x8F93;&#x5165;/&#x8F93;&#x51FA;</td>
<td></td>
</tr>
<tr>
<td>O_DIRECTORY</td>
<td>&#x5982;&#x679C;pathname&#x4E0D;&#x662F;&#x76EE;&#x5F55;&#xFF0C;&#x5219;&#x5931;&#x8D25;</td>
<td>v4</td>
</tr>
<tr>
<td>O_EXCL</td>
<td>&#x7ED3;&#x5408;O_CREAT&#x53C2;&#x6570;&#x4F7F;&#x7528;&#xFF0C;&#x4E13;&#x95E8;&#x7528;&#x4E8E;&#x521B;&#x5EFA;&#x6587;&#x4EF6;</td>
<td>v3</td>
</tr>
<tr>
<td>O_LARGEFILE</td>
<td>&#x5728;32&#x4F4D;&#x7CFB;&#x7EDF;&#x4E2D;&#x6253;&#x5F00;&#x5927;&#x6587;&#x4EF6;</td>
<td></td>
</tr>
<tr>
<td>O_NOATIME</td>
<td>&#x8C03;&#x7528;read()&#x65F6;&#xFF0C;&#x4E0D;&#x4FEE;&#x6539;&#x6587;&#x4EF6;&#x6700;&#x8FD1;&#x8BBF;&#x95EE;&#x65F6;&#x95F4;&#xFF08;Linux2.6.8&#x5F00;&#x59CB;&#xFF09;</td>
<td></td>
</tr>
<tr>
<td>O_NOCTTY</td>
<td>&#x4E0D;&#x8981;&#x8BA9;pathname&#x6210;&#x4E3A;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;</td>
<td>v3</td>
</tr>
<tr>
<td>O_NOFOLLOW</td>
<td>&#x5BF9;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#x4E0D;&#x4E88;&#x89E3;&#x5F15;&#x7528;</td>
<td>v4</td>
</tr>
<tr>
<td>O_TRUNC</td>
<td>&#x622A;&#x65AD;&#x5DF2;&#x6709;&#x6587;&#x4EF6;&#xFF0C;&#x4F7F;&#x5176;&#x957F;&#x5EA6;&#x4E3A;0</td>
<td>v3</td>
</tr>
<tr>
<td>O_APPEND</td>
<td>&#x5728;&#x6587;&#x4EF6;&#x5C3E;&#x90E8;&#x8FFD;&#x52A0;&#x6570;&#x636E;</td>
<td>v3</td>
</tr>
<tr>
<td>O_ASYNC</td>
<td>&#x5F53;I/O&#x64CD;&#x4F5C;&#x53EF;&#x884C;&#x65F6;&#xFF0C;&#x4EA7;&#x751F;&#x4FE1;&#x53F7;&#x901A;&#x77E5;&#x8FDB;&#x7A0B;</td>
<td></td>
</tr>
<tr>
<td>O_DSYNC</td>
<td>&#x63D0;&#x4F9B;&#x540C;&#x6B65;&#x7684;I/O&#x6570;&#x636E;&#x5B8C;&#x6574;&#x6027;&#xFF08;&#x81EA;Linux2.6.33&#x7248;&#x672C;&#x5F00;&#x59CB;&#xFF09;</td>
<td>v3</td>
</tr>
<tr>
<td>O_NONBLOCK</td>
<td>&#x4EE5;&#x975E;&#x963B;&#x585E;&#x65B9;&#x5F0F;&#x6253;&#x5F00;</td>
<td>v3</td>
</tr>
<tr>
<td>O_SYNC</td>
<td>&#x4EE5;&#x540C;&#x6B65;&#x65B9;&#x5F0F;&#x5199;&#x5165;&#x6587;&#x4EF6;</td>
<td>v3</td>
</tr>
</tbody></table></div>
<p><strong>mode_t&#x8BE6;&#x89E3;:</strong></p>
<pre class="line-numbers language-c"><code class="language-c">S_IRWXU  <span class="token number">00700</span> &#x5C5E;&#x4E3B;&#x8BFB;&#x3001;&#x5199;&#x3001;&#x6267;&#x884C;
S_IRUSR  <span class="token number">00400</span> &#x5C5E;&#x4E3B;&#x8BFB;
S_IWUSR  <span class="token number">00200</span> &#x5C5E;&#x4E3B;&#x5199;
S_IXUSR  <span class="token number">00100</span> &#x5C5E;&#x4E3B;&#x6267;&#x884C;
S_IRWXG  <span class="token number">00070</span> &#x5C5E;&#x7EC4;&#x8BFB;&#x3001;&#x5199;&#x3001;&#x6267;&#x884C;
S_IRGRP  <span class="token number">00040</span> &#x5C5E;&#x7EC4;&#x8BFB;
S_IWGRP  <span class="token number">00020</span> &#x5C5E;&#x7EC4;&#x5199;
S_IXGRP  <span class="token number">00010</span> &#x5C5E;&#x7EC4;&#x6267;&#x884C;
S_IRWXO  <span class="token number">00007</span> &#x5176;&#x4ED6;&#x8BFB;&#x3001;&#x5199;&#x3001;&#x6267;&#x884C;
S_IROTH  <span class="token number">00004</span> &#x5176;&#x4ED6;&#x8BFB;
S_IWOTH  <span class="token number">00002</span> &#x5176;&#x4ED6;&#x5199;
S_IXOTH  <span class="token number">00001</span> &#x5176;&#x4ED6;&#x6267;&#x884C;
S_ISUID  <span class="token number">0004000</span> &#x628A;&#x8FDB;&#x7A0B;&#x7684;&#x6709;&#x6548;&#x7528;&#x6237;&#x8BBE;&#x7F6E;&#x4E3A;&#x6587;&#x4EF6;&#x7684;&#x6240;&#x6709;&#x8005;
S_ISGID  <span class="token number">0002000</span> &#x628A;&#x8FDB;&#x7A0B;&#x7684;&#x6709;&#x6548;&#x7EC4;&#x8BBE;&#x7F6E;&#x4E3A;&#x6587;&#x4EF6;&#x7684;&#x7EC4;
S_ISVTX  <span class="token number">0001000</span> &#x7C98;&#x7740;&#x4F4D;&#xFF0C;&#x4F5C;&#x7528;<span class="token number">1</span>&#xFF1A;&#x53EF;&#x6267;&#x884C;&#x7A0B;&#x5E8F;&#x6267;&#x884C;&#x7ED3;&#x675F;&#x540E;&#xFF0C;&#x4F1A;&#x7F13;&#x5B58;&#x5230;&#x4EA4;&#x6362;&#x7A7A;&#x95F4;&#xFF0C;&#x7531;&#x4E8E;&#x4EA4;&#x6362;&#x7A7A;&#x95F4;&#x7684;&#x78C1;&#x76D8;&#x662F;&#x8FDE;&#x7EED;&#x7684;&#xFF0C;&#x4E0D;&#x9700;&#x8981;&#x627E;block&#xFF0C;&#x6240;&#x4EE5;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x5FEB;&#x901F;&#x52A0;&#x8F7D;&#x7A0B;&#x5E8F;&#x7684;&#x6548;&#x679C;&#x3002;&#x4F5C;&#x7528;<span class="token number">2</span>&#xFF1A;&#x7528;&#x6765;&#x6807;&#x8BB0;&#x76EE;&#x5F55;&#xFF0C;&#x6807;&#x8BB0;&#x540E;&#x7684;&#x76EE;&#x5F55;&#x53EA;&#x6709;&#x5C5E;&#x4E3B;&#x53EF;&#x4EE5;&#x5BF9;&#x5176;&#x6709;&#x5199;&#x6743;&#x9650;&#xFF0C;&#x5176;&#x4ED6;&#x4EBA;&#x53EA;&#x80FD;&#x8BFB;&#x3002;&#x53C2;&#x8003;<span class="token operator">/</span>tmp&#x76EE;&#x5F55;&#xFF0C;&#x6240;&#x6709;&#x4EBA;&#x53EF;&#x8BFB;&#xFF0C;&#x5C5E;&#x4E3B;&#x53EF;&#x5199;&#x3002;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="&#x5E38;&#x7528;&#x9519;&#x8BEF;&#x7801;"><a href="#&#x5E38;&#x7528;&#x9519;&#x8BEF;&#x7801;" class="headerlink" title="&#x5E38;&#x7528;&#x9519;&#x8BEF;&#x7801;"></a>&#x5E38;&#x7528;&#x9519;&#x8BEF;&#x7801;</h2><h3 id="open-&#x51FD;&#x6570;&#x7684;&#x9519;&#x8BEF;"><a href="#open-&#x51FD;&#x6570;&#x7684;&#x9519;&#x8BEF;" class="headerlink" title="open()&#x51FD;&#x6570;&#x7684;&#x9519;&#x8BEF;"></a>open()&#x51FD;&#x6570;&#x7684;&#x9519;&#x8BEF;</h3><p>&#x82E5;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x65F6;&#x53D1;&#x751F;&#x9519;&#x8BEF;&#xFF0C;open()&#x5C06;&#x8FD4;&#x56DE;&#x2212;1&#xFF0C;&#x9519;&#x8BEF;&#x53F7;errno&#x6807;&#x8BC6;&#x9519;&#x8BEF;&#x539F;&#x56E0;&#x3002;&#x4EE5;&#x4E0B;&#x662F;&#x4E00;&#x4E9B;&#x53EF;&#x80FD;&#x53D1;&#x751F;&#x7684;&#x9519;&#x8BEF;.</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th align="left">&#x9519;&#x8BEF;&#x7801;</th>
<th align="center">&#x89E3;&#x91CA;</th>
</tr>
</thead>
<tbody><tr>
<td align="left">EACCES</td>
<td align="center">&#x6587;&#x4EF6;&#x6743;&#x9650;&#x4E0D;&#x5141;&#x8BB8;&#x4EE5;flags&#x53C2;&#x6570;&#x6307;&#x5B9A;&#x7684;&#x65B9;&#x5F0F;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x3002;</td>
</tr>
<tr>
<td align="left">EISDIR</td>
<td align="center">&#x8981;&#x6253;&#x5F00;&#x7684;&#x6587;&#x4EF6;&#x662F;&#x4E00;&#x4E2A;&#x76EE;&#x5F55;&#xFF0C;&#x901A;&#x5E38;&#x60C5;&#x51B5;&#x4E0B;&#x4E0D;&#x5141;&#x8BB8;&#x5BF9;&#x76EE;&#x5F55;&#x8FDB;&#x884C;&#x5199;&#x64CD;&#x4F5C;&#x3002;</td>
</tr>
<tr>
<td align="left">ENFILE</td>
<td align="center">&#x6587;&#x4EF6;&#x6253;&#x5F00;&#x6570;&#x91CF;&#x5DF2;&#x7ECF;&#x8FBE;&#x5230;&#x7CFB;&#x7EDF;&#x5141;&#x8BB8;&#x7684;&#x4E0A;&#x9650;&#x3002;</td>
</tr>
<tr>
<td align="left">ENOENT</td>
<td align="center">&#x6587;&#x4EF6;&#x4E0D;&#x5B58;&#x5728;&#xFF0C;&#x5E76;&#x4E14;&#x672A;&#x6307;&#x5B9A;O_CREAT&#x6807;&#x5FD7;&#x3002;</td>
</tr>
<tr>
<td align="left">EROFS</td>
<td align="center">&#x6587;&#x4EF6;&#x662F;&#x53EA;&#x8BFB;&#x7684;&#xFF0C;&#x8C03;&#x7528;&#x8005;&#x4F01;&#x56FE;&#x7528;&#x5199;&#x7684;&#x65B9;&#x5F0F;&#x6253;&#x5F00;&#x3002;</td>
</tr>
<tr>
<td align="left">ETXTBSY</td>
<td align="center">&#x8981;&#x6253;&#x5F00;&#x7684;&#x6587;&#x4EF6;&#x662F;&#x6B63;&#x5728;&#x8FD0;&#x884C;&#x7684;&#x7A0B;&#x5E8F;&#x6587;&#x4EF6;&#x3002;&#x7CFB;&#x7EDF;&#x4E0D;&#x5141;&#x8BB8;&#x4FEE;&#x6539;&#x6B63;&#x5728;&#x8FD0;&#x884C;&#x7684;&#x7A0B;&#x5E8F;&#x3002;</td>
</tr>
</tbody></table></div>
<h3 id="errno&#x5168;&#x90E8;&#x9519;&#x8BEF;&#x7801;"><a href="#errno&#x5168;&#x90E8;&#x9519;&#x8BEF;&#x7801;" class="headerlink" title="errno&#x5168;&#x90E8;&#x9519;&#x8BEF;&#x7801;"></a>errno&#x5168;&#x90E8;&#x9519;&#x8BEF;&#x7801;</h3><pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">define</span> EPERM 1 </span><span class="token comment" spellcheck="true">/* Operation not permitted */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ENOENT 2 </span><span class="token comment" spellcheck="true">/* No such file or directory */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ESRCH 3 </span><span class="token comment" spellcheck="true">/* No such process */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EINTR 4 </span><span class="token comment" spellcheck="true">/* Interrupted system call */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EIO 5 </span><span class="token comment" spellcheck="true">/* I/O error */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ENXIO 6 </span><span class="token comment" spellcheck="true">/* No such device or address */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> E2BIG 7 </span><span class="token comment" spellcheck="true">/* Argument list too long */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ENOEXEC 8 </span><span class="token comment" spellcheck="true">/* Exec format error */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EBADF 9 </span><span class="token comment" spellcheck="true">/* Bad file number */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ECHILD 10 </span><span class="token comment" spellcheck="true">/* No child processes */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EAGAIN 11 </span><span class="token comment" spellcheck="true">/* Try again */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ENOMEM 12 </span><span class="token comment" spellcheck="true">/* Out of memory */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EACCES 13 </span><span class="token comment" spellcheck="true">/* Permission denied */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EFAULT 14 </span><span class="token comment" spellcheck="true">/* Bad address */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ENOTBLK 15 </span><span class="token comment" spellcheck="true">/* Block device required */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EBUSY 16 </span><span class="token comment" spellcheck="true">/* Device or resource busy */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EEXIST 17 </span><span class="token comment" spellcheck="true">/* File exists */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EXDEV 18 </span><span class="token comment" spellcheck="true">/* Cross-device link */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ENODEV 19 </span><span class="token comment" spellcheck="true">/* No such device */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ENOTDIR 20 </span><span class="token comment" spellcheck="true">/* Not a directory */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EISDIR 21 </span><span class="token comment" spellcheck="true">/* Is a directory */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EINVAL 22 </span><span class="token comment" spellcheck="true">/* Invalid argument */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ENFILE 23 </span><span class="token comment" spellcheck="true">/* File table overflow */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EMFILE 24 </span><span class="token comment" spellcheck="true">/* Too many open files */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ENOTTY 25 </span><span class="token comment" spellcheck="true">/* Not a typewriter */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ETXTBSY 26 </span><span class="token comment" spellcheck="true">/* Text file busy */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EFBIG 27 </span><span class="token comment" spellcheck="true">/* File too large */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ENOSPC 28 </span><span class="token comment" spellcheck="true">/* No space left on device */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ESPIPE 29 </span><span class="token comment" spellcheck="true">/* Illegal seek */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EROFS 30 </span><span class="token comment" spellcheck="true">/* Read-only file system */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EMLINK 31 </span><span class="token comment" spellcheck="true">/* Too many links */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EPIPE 32 </span><span class="token comment" spellcheck="true">/* Broken pipe */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EDOM 33 </span><span class="token comment" spellcheck="true">/* Math argument out of domain of func */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ERANGE 34 </span><span class="token comment" spellcheck="true">/* Math result not representable */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EDEADLK 35 </span><span class="token comment" spellcheck="true">/* Resource deadlock would occur */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ENAMETOOLONG 36 </span><span class="token comment" spellcheck="true">/* File name too long */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ENOLCK 37 </span><span class="token comment" spellcheck="true">/* No record locks available */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ENOSYS 38 </span><span class="token comment" spellcheck="true">/* Function not implemented */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ENOTEMPTY 39 </span><span class="token comment" spellcheck="true">/* Directory not empty */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ELOOP 40 </span><span class="token comment" spellcheck="true">/* Too many symbolic links encountered */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EWOULDBLOCK EAGAIN </span><span class="token comment" spellcheck="true">/* Operation would block */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ENOMSG 42 </span><span class="token comment" spellcheck="true">/* No message of desired type */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EIDRM 43 </span><span class="token comment" spellcheck="true">/* Identifier removed */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ECHRNG 44 </span><span class="token comment" spellcheck="true">/* Channel number out of range */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EL2NSYNC 45 </span><span class="token comment" spellcheck="true">/* Level 2 not synchronized */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EL3HLT 46 </span><span class="token comment" spellcheck="true">/* Level 3 halted */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EL3RST 47 </span><span class="token comment" spellcheck="true">/* Level 3 reset */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ELNRNG 48 </span><span class="token comment" spellcheck="true">/* Link number out of range */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EUNATCH 49 </span><span class="token comment" spellcheck="true">/* Protocol driver not attached */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ENOCSI 50 </span><span class="token comment" spellcheck="true">/* No CSI structure available */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EL2HLT 51 </span><span class="token comment" spellcheck="true">/* Level 2 halted */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EBADE 52 </span><span class="token comment" spellcheck="true">/* Invalid exchange */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EBADR 53 </span><span class="token comment" spellcheck="true">/* Invalid request descriptor */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EXFULL 54 </span><span class="token comment" spellcheck="true">/* Exchange full */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ENOANO 55 </span><span class="token comment" spellcheck="true">/* No anode */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EBADRQC 56 </span><span class="token comment" spellcheck="true">/* Invalid request code */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EBADSLT 57 </span><span class="token comment" spellcheck="true">/* Invalid slot */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EDEADLOCK EDEADLK</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EBFONT 59 </span><span class="token comment" spellcheck="true">/* Bad font file format */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ENOSTR 60 </span><span class="token comment" spellcheck="true">/* Device not a stream */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ENODATA 61 </span><span class="token comment" spellcheck="true">/* No data available */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ETIME 62 </span><span class="token comment" spellcheck="true">/* Timer expired */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ENOSR 63 </span><span class="token comment" spellcheck="true">/* Out of streams resources */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ENONET 64 </span><span class="token comment" spellcheck="true">/* Machine is not on the network */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ENOPKG 65 </span><span class="token comment" spellcheck="true">/* Package not installed */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EREMOTE 66 </span><span class="token comment" spellcheck="true">/* Object is remote */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ENOLINK 67 </span><span class="token comment" spellcheck="true">/* Link has been severed */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EADV 68 </span><span class="token comment" spellcheck="true">/* Advertise error */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ESRMNT 69 </span><span class="token comment" spellcheck="true">/* Srmount error */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ECOMM 70 </span><span class="token comment" spellcheck="true">/* Communication error on send */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EPROTO 71 </span><span class="token comment" spellcheck="true">/* Protocol error */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EMULTIHOP 72 </span><span class="token comment" spellcheck="true">/* Multihop attempted */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EDOTDOT 73 </span><span class="token comment" spellcheck="true">/* RFS specific error */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EBADMSG 74 </span><span class="token comment" spellcheck="true">/* Not a data message */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EOVERFLOW 75 </span><span class="token comment" spellcheck="true">/* Value too large for defined data type */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ENOTUNIQ 76 </span><span class="token comment" spellcheck="true">/* Name not unique on network */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EBADFD 77 </span><span class="token comment" spellcheck="true">/* File descriptor in bad state */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EREMCHG 78 </span><span class="token comment" spellcheck="true">/* Remote address changed */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ELIBACC 79 </span><span class="token comment" spellcheck="true">/* Can not access a needed shared library */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ELIBBAD 80 </span><span class="token comment" spellcheck="true">/* Accessing a corrupted shared library */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ELIBSCN 81 </span><span class="token comment" spellcheck="true">/* .lib section in a.out corrupted */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ELIBMAX 82 </span><span class="token comment" spellcheck="true">/* Attempting to link in too many shared libraries */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ELIBEXEC 83 </span><span class="token comment" spellcheck="true">/* Cannot exec a shared library directly */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EILSEQ 84 </span><span class="token comment" spellcheck="true">/* Illegal byte sequence */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ERESTART 85 </span><span class="token comment" spellcheck="true">/* Interrupted system call should be restarted */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ESTRPIPE 86 </span><span class="token comment" spellcheck="true">/* Streams pipe error */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EUSERS 87 </span><span class="token comment" spellcheck="true">/* Too many users */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ENOTSOCK 88 </span><span class="token comment" spellcheck="true">/* Socket operation on non-socket */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EDESTADDRREQ 89 </span><span class="token comment" spellcheck="true">/* Destination address required */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EMSGSIZE 90 </span><span class="token comment" spellcheck="true">/* Message too long */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EPROTOTYPE 91 </span><span class="token comment" spellcheck="true">/* Protocol wrong type for socket */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ENOPROTOOPT 92 </span><span class="token comment" spellcheck="true">/* Protocol not available */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EPROTONOSUPPORT 93 </span><span class="token comment" spellcheck="true">/* Protocol not supported */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ESOCKTNOSUPPORT 94 </span><span class="token comment" spellcheck="true">/* Socket type not supported */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EOPNOTSUPP 95 </span><span class="token comment" spellcheck="true">/* Operation not supported on transport endpoint */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EPFNOSUPPORT 96 </span><span class="token comment" spellcheck="true">/* Protocol family not supported */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EAFNOSUPPORT 97 </span><span class="token comment" spellcheck="true">/* Address family not supported by protocol */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EADDRINUSE 98 </span><span class="token comment" spellcheck="true">/* Address already in use */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EADDRNOTAVAIL 99 </span><span class="token comment" spellcheck="true">/* Cannot assign requested address */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ENETDOWN 100 </span><span class="token comment" spellcheck="true">/* Network is down */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ENETUNREACH 101 </span><span class="token comment" spellcheck="true">/* Network is unreachable */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ENETRESET 102 </span><span class="token comment" spellcheck="true">/* Network dropped connection because of reset */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ECONNABORTED 103 </span><span class="token comment" spellcheck="true">/* Software caused connection abort */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ECONNRESET 104 </span><span class="token comment" spellcheck="true">/* Connection reset by peer */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ENOBUFS 105 </span><span class="token comment" spellcheck="true">/* No buffer space available */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EISCONN 106 </span><span class="token comment" spellcheck="true">/* Transport endpoint is already connected */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ENOTCONN 107 </span><span class="token comment" spellcheck="true">/* Transport endpoint is not connected */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ESHUTDOWN 108 </span><span class="token comment" spellcheck="true">/* Cannot send after transport endpoint shutdown */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ETOOMANYREFS 109 </span><span class="token comment" spellcheck="true">/* Too many references: cannot splice */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ETIMEDOUT 110 </span><span class="token comment" spellcheck="true">/* Connection timed out */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ECONNREFUSED 111 </span><span class="token comment" spellcheck="true">/* Connection refused */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EHOSTDOWN 112 </span><span class="token comment" spellcheck="true">/* Host is down */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EHOSTUNREACH 113 </span><span class="token comment" spellcheck="true">/* No route to host */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EALREADY 114 </span><span class="token comment" spellcheck="true">/* Operation already in progress */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EINPROGRESS 115 </span><span class="token comment" spellcheck="true">/* Operation now in progress */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ESTALE 116 </span><span class="token comment" spellcheck="true">/* Stale NFS file handle */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EUCLEAN 117 </span><span class="token comment" spellcheck="true">/* Structure needs cleaning */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ENOTNAM 118 </span><span class="token comment" spellcheck="true">/* Not a XENIX named type file */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ENAVAIL 119 </span><span class="token comment" spellcheck="true">/* No XENIX semaphores available */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EISNAM 120 </span><span class="token comment" spellcheck="true">/* Is a named type file */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EREMOTEIO 121 </span><span class="token comment" spellcheck="true">/* Remote I/O error */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EDQUOT 122 </span><span class="token comment" spellcheck="true">/* Quota exceeded */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ENOMEDIUM 123 </span><span class="token comment" spellcheck="true">/* Nomedium found */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EMEDIUMTYEP 124 </span><span class="token comment" spellcheck="true">/*Wrongmedium found */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ECANCELED 125 </span><span class="token comment" spellcheck="true">/* Operation Canceled */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ENOKEY 126 </span><span class="token comment" spellcheck="true">/* Required key not available */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EKEYEXPIRED 127 </span><span class="token comment" spellcheck="true">/* Key has expired */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EKEYREVOKED 128 </span><span class="token comment" spellcheck="true">/* Key has been revoked */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EKEYREJECTED 129 </span><span class="token comment" spellcheck="true">/* Key was rejected by service */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EOWNERDEAD 130 </span><span class="token comment" spellcheck="true">/* Owner died */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ENOTRECOVERABLE 131 </span><span class="token comment" spellcheck="true">/* State not recoverable */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> ERFKILL 132 </span><span class="token comment" spellcheck="true">/* Operation not possible due to RF-kill */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> EHWPOISON 133 </span><span class="token comment" spellcheck="true">/* Memory page has hardware error */</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="read"><a href="#read" class="headerlink" title="read()"></a>read()</h2><p>read()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x4ECE;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26; fd &#x6240;&#x6307;&#x4EE3;&#x7684;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x4E2D;&#x8BFB;&#x53D6;&#x6570;&#x636E;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property"># <span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h&gt;</span></span>
ssize_t <span class="token function">read</span><span class="token punctuation">(</span><span class="token keyword">int</span> fd<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token operator">*</span>buffer<span class="token punctuation">,</span> size_t count<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>fd,&#x5DF2;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x7684;&#x8FD4;&#x56DE;&#x7801;&#x3002;<br>buffer&#xFF0C;&#x7F13;&#x5B58;&#x7684;&#x5730;&#x5740;&#x3002;<br>count&#xFF0C;&#x4E00;&#x6B21;&#x6700;&#x591A;&#x80FD;&#x8BFB;&#x53D6;&#x7684;&#x5B57;&#x8282;&#x6570;&#x3002;<br>&#x6210;&#x529F;&#x8FD4;&#x56DE;&#x5B9E;&#x9645;&#x8BFB;&#x53D6;&#x7684;&#x5B57;&#x8282;&#x6570;&#xFF0C;&#x5982;&#x679C;&#x9047;&#x5230;&#x6587;&#x4EF6;&#x7ED3;&#x675F;&#x7B26;&#xFF08;EOF&#xFF09;&#x8FD4;&#x56DE;0&#x3002;&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1&#x5E76;&#x8BBE;&#x7F6E;errno&#x3002;</p>
<div class="uk-alert uk-alert-warning"><i class="fa fa-exclamation-circle"></i> &#xA0;&#xA0;read&#x7684;&#x6587;&#x4EF6;&#x7ED3;&#x5C3E;&#x8981;&#x6709; \n <br>
&#x7531;&#x4E8E;&#x8868;&#x793A;&#x5B57;&#x7B26;&#x4E32;&#x7EC8;&#x6B62;&#x7684;&#x7A7A;&#x5B57;&#x7B26;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x5B57;&#x8282;&#x7684;&#x5185;&#x5B58;&#xFF0C;&#x6240;&#x4EE5;&#x7F13;&#x51B2;&#x533A;&#x7684;&#x5927;&#x5C0F;&#x81F3;&#x5C11;&#x8981;&#x6BD4;&#x9884;&#x8BA1;&#x8BFB;&#x53D6;&#x7684;&#x6700;&#x5927;&#x5B57;&#x7B26;&#x4E32;&#x957F;&#x5EA6;&#x591A;&#x51FA;1&#x4E2A;&#x5B57;&#x8282;&#x3002;</div>

<p><strong>&#x4F8B;&#x5B50;&#xFF1A;</strong><br>/opt/test.txt</p>
<pre class="line-numbers language-txt"><code class="language-txt">Hello Boss Chen!\n<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;fcntl.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;sys/stat.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;unistd.h&gt;</span></span>

using namespace std<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> fd<span class="token punctuation">;</span>
    ssize_t num<span class="token punctuation">;</span>
    <span class="token keyword">char</span> ttt<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;abc\n&quot;</span><span class="token punctuation">;</span>

    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Hello World!&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span>ttt<span class="token punctuation">;</span>

    fd<span class="token operator">=</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;/opt/test.txt&quot;</span><span class="token punctuation">,</span>O_RDWR<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>fd<span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      cout<span class="token operator">&lt;&lt;</span><span class="token string">&quot;Open file error!&quot;</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    num<span class="token operator">=</span><span class="token function">read</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span>ttt<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>num<span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      cout<span class="token operator">&lt;&lt;</span><span class="token string">&quot;Read file error!&quot;</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    cout<span class="token operator">&lt;&lt;</span>ttt<span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>Hello Boss Chen!
abc
abc</code></pre><h2 id="write"><a href="#write" class="headerlink" title="write()"></a>write()</h2><p>write()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5C06;&#x6570;&#x636E;&#x5199;&#x5165;&#x4E00;&#x4E2A;&#x5DF2;&#x6253;&#x5F00;&#x7684;&#x6587;&#x4EF6;&#x4E2D;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h&gt;</span></span>
ssize_t <span class="token function">write</span><span class="token punctuation">(</span><span class="token keyword">int</span> fd<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token operator">*</span>buffer<span class="token punctuation">,</span> size_t count<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>fd,&#x5DF2;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x7684;&#x8FD4;&#x56DE;&#x7801;&#x3002;<br>buffer&#xFF0C;&#x7F13;&#x5B58;&#x7684;&#x5730;&#x5740;&#x3002;<br>count&#xFF0C;&#x8981;&#x5199;&#x5165;&#x7684;&#x5B57;&#x8282;&#x6570;&#x3002;<br>&#x6210;&#x529F;&#x8FD4;&#x56DE;&#x5B9E;&#x9645;&#x5199;&#x5165;&#x7684;&#x5B57;&#x8282;&#x6570;&#xFF0C;&#x53EF;&#x80FD;&#x4F1A;&#x51FA;&#x73B0;&#x90E8;&#x5206;&#x5199;&#x7684;&#x60C5;&#x51B5;&#xFF08;&#x78C1;&#x76D8;&#x5DF2;&#x6EE1;&#x6216;&#x8005;&#x8FDB;&#x7A0B;&#x8D44;&#x6E90;&#x5BF9;&#x6587;&#x4EF6;&#x5927;&#x5C0F;&#x6709;&#x9650;&#x5236;&#xFF09;&#x3002;<br>&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1&#xFF0C;&#x5E76;&#x8BBE;&#x7F6E;&#x9519;&#x8BEF;&#x7801;&#x3002;</p>
<h2 id="close"><a href="#close" class="headerlink" title="close()"></a>close()</h2><p>close()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5173;&#x95ED;&#x4E00;&#x4E2A;&#x6253;&#x5F00;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#xFF0C;&#x5E76;&#x5C06;&#x5176;&#x91CA;&#x653E;&#x56DE;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#xFF0C;&#x4F9B;&#x8BE5;&#x8FDB;&#x7A0B;&#x7EE7;&#x7EED;&#x4F7F;&#x7528;&#x3002;&#x5F53;&#x4E00;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#x65F6;&#xFF0C;&#x5C06;&#x81EA;&#x52A8;&#x5173;&#x95ED;&#x5176;&#x5DF2;&#x6253;&#x5F00;&#x7684;&#x6240;&#x6709;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token keyword">int</span> fd<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>fd,&#x5DF2;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x7684;&#x8FD4;&#x56DE;&#x7801;&#x3002;<br>&#x6210;&#x529F;&#x8FD4;&#x56DE;0&#x3002;<br>&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1&#x5E76;&#x8BBE;&#x7F6E;&#x9519;&#x8BEF;&#x7801;&#x3002;</p>
<h2 id="&#x68C0;&#x67E5;&#x6587;&#x4EF6;&#x6709;&#x6548;&#x6027;"><a href="#&#x68C0;&#x67E5;&#x6587;&#x4EF6;&#x6709;&#x6548;&#x6027;" class="headerlink" title="&#x68C0;&#x67E5;&#x6587;&#x4EF6;&#x6709;&#x6548;&#x6027;"></a>&#x68C0;&#x67E5;&#x6587;&#x4EF6;&#x6709;&#x6548;&#x6027;</h2><p>&#x68C0;&#x67E5;&#x6587;&#x4EF6;&#x6709;&#x6548;&#x6027;&#x6709;&#x4E24;&#x529E;&#x6CD5;&#xFF1A;<br><strong>1.open()</strong><br>&#x6839;&#x636E;open()&#x8FD4;&#x56DE;&#x7801;&#x5224;&#x65AD;&#x3002;<br><strong>2.access()</strong><br>&#x6709;&#x6548;&#x8FD4;&#x56DE;0&#xFF0C;&#x65E0;&#x6548;&#x8FD4;&#x56DE;&#x975E;0.</p>
<h2 id="lseek"><a href="#lseek" class="headerlink" title="lseek()"></a>lseek()</h2><p>&#x6587;&#x4EF6;&#x504F;&#x79FB;&#x91CF;&#x662F;&#x6307;&#x6267;&#x884C;&#x4E0B;&#x4E00;&#x4E2A;read()&#x6216;write()&#x64CD;&#x4F5C;&#x7684;&#x6587;&#x4EF6;&#x8D77;&#x59CB;&#x4F4D;&#x7F6E;&#xFF0C;&#x4F1A;&#x4EE5;&#x76F8;&#x5BF9;&#x4E8E;&#x6587;&#x4EF6;&#x5934;&#x90E8;&#x8D77;&#x59CB;&#x70B9;&#x7684;&#x6587;&#x4EF6;&#x5F53;&#x524D;&#x4F4D;&#x7F6E;&#x6765;&#x8868;&#x793A;&#x3002;&#x6587;&#x4EF6;&#x7B2C;&#x4E00;&#x4E2A;&#x5B57;&#x8282;&#x7684;&#x504F;&#x79FB;&#x91CF;&#x4E3A;0&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property"># <span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h&gt;</span></span>
off_t <span class="token function">lseek</span><span class="token punctuation">(</span><span class="token keyword">int</span> fd<span class="token punctuation">,</span> off_t offset<span class="token punctuation">,</span> <span class="token keyword">int</span> whence<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>fd,&#x5DF2;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x7684;&#x8FD4;&#x56DE;&#x7801;&#x3002;<br>offset,&#x6307;&#x5B9A;&#x4E86;&#x4E00;&#x4E2A;&#x4EE5;&#x5B57;&#x8282;&#x4E3A;&#x5355;&#x4F4D;&#x7684;&#x6570;&#x503C;&#x3002;<br>whence,&#x8868;&#x660E;&#x5E94;&#x53C2;&#x7167;&#x54EA;&#x4E2A;&#x57FA;&#x70B9;&#x6765;&#x89E3;&#x91CA;offset &#x53C2;&#x6570;.<br>&#x6210;&#x529F;&#x8FD4;&#x56DE;&#x504F;&#x79FB;&#x91CF;&#xFF0C;<br>&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1&#x5E76;&#x8BBE;&#x7F6E;&#x9519;&#x8BEF;&#x7801;&#x3002;</p>
<p><strong>whence</strong></p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>whence</th>
<th>&#x503C;</th>
<th>&#x542B;&#x4E49;</th>
</tr>
</thead>
<tbody><tr>
<td>SEEK_SET</td>
<td>0</td>
<td>&#x76F8;&#x5BF9;&#x4E8E;&#x6587;&#x4EF6;&#x5934;&#x90E8;&#x5F00;&#x59CB;&#x7684;offset&#x4E2A;&#x5B57;&#x8282;</td>
</tr>
<tr>
<td>SEEK_CUR</td>
<td>1</td>
<td>&#x76F8;&#x5BF9;&#x4E8E;&#x5F53;&#x524D;&#x6587;&#x4EF6;&#x504F;&#x79FB;&#x91CF;&#x8D77;&#x59CB;&#x7684;offset&#x4E2A;&#x5B57;&#x8282;</td>
</tr>
<tr>
<td>SEEK_END</td>
<td>2</td>
<td>&#x76F8;&#x5BF9;&#x4E8E;&#x6587;&#x4EF6;&#x5C3E;&#x90E8;&#x8D77;&#x59CB;&#x7684;offset&#x4E2A;&#x5B57;&#x8282;</td>
</tr>
</tbody></table></div>
<p><strong>lseek&#x4F8B;&#x5B50;</strong></p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token function">lseek</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> SEEK_SET<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">//&#x6587;&#x4EF6;&#x5934;</span>
<span class="token function">lseek</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> SEEK_END<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">//&#x6587;&#x4EF6;&#x5C3E;</span>
<span class="token function">lseek</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> SEEK_END<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">//&#x6587;&#x4EF6;&#x5C3E;&#x7684;&#x524D;1&#x4E2A;&#x5B57;&#x8282;</span>
<span class="token function">lseek</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> SEEK_CUR<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">//&#x6587;&#x4EF6;&#x5F53;&#x524D;&#x504F;&#x79FB;&#x7684;&#x524D;10&#x4E2A;&#x5B57;&#x8282;</span>
<span class="token function">lseek</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">,</span> SEEK_END<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">//&#x6587;&#x4EF6;&#x5C3E;&#x7684;&#x540E;10000&#x4E2A;&#x5B57;&#x8282;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<div class="uk-alert uk-alert-warning"><i class="fa fa-exclamation-circle"></i> &#xA0;&#xA0;&#x6587;&#x4EF6;&#x7A7A;&#x6D1E;<br>
&#x6587;&#x4EF6;&#x504F;&#x79FB;&#x91CF;&#x8DE8;&#x8D8A;&#x4E86;&#x6587;&#x4EF6;&#x7ED3;&#x5C3E;&#xFF0C;&#x5982; lseek(fd, 1000, SEEK_END) &#xFF0C;&#x4E4B;&#x540E;&#x518D;&#x8FDB;&#x884C;I/O&#x64CD;&#x4F5C;&#xFF0C;read()&#x8C03;&#x7528;&#x4F1A;&#x8FD4;&#x56DE;0&#xFF0C;write()&#x8C03;&#x7528;&#x4F1A;&#x5199;&#x5165;&#x6570;&#x636E;&#xFF0C;&#x6587;&#x4EF6;&#x7ED3;&#x5C3E;&#x5230;&#x65B0;&#x5199;&#x5165;&#x6570;&#x636E;&#x4E4B;&#x95F4;&#x7684;&#x8FD9;&#x6BB5;&#x7A7A;&#x95F4;&#x88AB;&#x79F0;&#x4E3A;&#x6587;&#x4EF6;&#x7A7A;&#x6D1E;&#x3002;&#x6587;&#x4EF6;&#x7A7A;&#x6D1E;&#x4E0D;&#x5360;&#x7528;&#x4EFB;&#x4F55;&#x78C1;&#x76D8;&#x7A7A;&#x95F4;&#xFF08;&#x5927;&#x591A;&#x6570;&#x60C5;&#x51B5;&#x4E0B;&#xFF09;&#xFF0C;&#x5F53;&#x5411;&#x6587;&#x4EF6;&#x7A7A;&#x6D1E;&#x5199;&#x5165;&#x6570;&#x636E;&#x65F6;&#xFF0C;&#x7CFB;&#x7EDF;&#x624D;&#x4F1A;&#x4E3A;&#x5176;&#x5206;&#x914D;&#x7A7A;&#x95F4;&#x3002;</div>

<div class="uk-alert uk-alert-warning"><i class="fa fa-exclamation-circle"></i> &#xA0;&#xA0;&#x539F;&#x5B50;&#x64CD;&#x4F5C;&#x548C;&#x7ADE;&#x4E89;&#x6761;&#x4EF6;<br>
&#x539F;&#x5B50;&#x64CD;&#x4F5C;&#xFF1A;&#x5185;&#x6838;&#x4FDD;&#x8BC1;&#x4E86;&#x67D0;&#x4E9B;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x4F1A;&#x4E00;&#x6B21;&#x6027;&#x6267;&#x884C;&#xFF0C;&#x4E0D;&#x4F1A;&#x88AB;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x6216;&#x7EBF;&#x7A0B;&#x6240;&#x4E2D;&#x65AD;&#xFF0C;&#x539F;&#x5B50;&#x64CD;&#x4F5C;&#x7684;&#x4F5C;&#x7528;&#x662F;&#x4E3A;&#x4E86;&#x907F;&#x514D;&#x7ADE;&#x4E89;&#x6761;&#x4EF6;&#x3002;
&#x7ADE;&#x4E89;&#x6761;&#x4EF6;&#xFF1A;&#x5F53;&#x4E24;&#x4E2A;&#x8FDB;&#x7A0B;&#x540C;&#x65F6;&#x5BF9;&#x540C;&#x4E00;&#x4E2A;&#x8D44;&#x6E90;&#x8FDB;&#x884C;&#x4FEE;&#x6539;&#x64CD;&#x4F5C;&#x65F6;&#xFF0C;&#x4F1A;&#x4EA7;&#x751F;&#x7ADE;&#x4E89;&#x6761;&#x4EF6;&#x3002;</div>

<h2 id="&#x6587;&#x4EF6;&#x7684;&#x539F;&#x5B50;&#x64CD;&#x4F5C;"><a href="#&#x6587;&#x4EF6;&#x7684;&#x539F;&#x5B50;&#x64CD;&#x4F5C;" class="headerlink" title="&#x6587;&#x4EF6;&#x7684;&#x539F;&#x5B50;&#x64CD;&#x4F5C;"></a>&#x6587;&#x4EF6;&#x7684;&#x539F;&#x5B50;&#x64CD;&#x4F5C;</h2><p><strong>&#x4EE5;&#x72EC;&#x5360;&#x65B9;&#x5F0F;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;</strong><br>&#x5F53;&#x540C;&#x65F6;&#x6307;&#x5B9A;O_EXCL&#x4E0E;O_CREAT&#x4F5C;&#x4E3A;open()&#x7684;&#x6807;&#x5FD7;&#x4F4D;&#x65F6;&#xFF0C;&#x5982;&#x679C;&#x8981;&#x6253;&#x5F00;&#x7684;&#x6587;&#x4EF6;&#x5DF2;&#x7136;&#x5B58;&#x5728;&#xFF0C;&#x5219;open()&#x5C06;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#x3002;&#x8FD9;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x79CD;&#x673A;&#x5236;&#xFF0C;&#x4FDD;&#x8BC1;&#x8FDB;&#x7A0B;&#x662F;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x7684;&#x521B;&#x5EFA;&#x8005;&#x3002;&#x5BF9;&#x6587;&#x4EF6;&#x662F;&#x5426;&#x5B58;&#x5728;&#x7684;&#x68C0;&#x67E5;&#x548C;&#x521B;&#x5EFA;&#x6587;&#x4EF6;&#x5C5E;&#x4E8E;&#x540C;&#x4E00;&#x539F;&#x5B50;&#x64CD;&#x4F5C;&#x3002;<br>&#x6B64;&#x65B9;&#x5F0F;&#x662F;&#x4E3A;&#x4E86;&#x907F;&#x514D;&#x8986;&#x76D6;&#x539F;&#x6587;&#x4EF6;&#x3002;</p>
<p><strong>&#x5411;&#x6587;&#x4EF6;&#x5C3E;&#x90E8;&#x8FFD;&#x52A0;&#x6570;&#x636E;</strong><br>&#x7528;&#x4EE5;&#x8BF4;&#x660E;&#x539F;&#x5B50;&#x64CD;&#x4F5C;&#x5FC5;&#x8981;&#x6027;&#x7684;&#x7B2C;&#x4E8C;&#x4E2A;&#x4F8B;&#x5B50;&#x662F;&#xFF1A;&#x591A;&#x4E2A;&#x8FDB;&#x7A0B;&#x540C;&#x65F6;&#x5411;&#x540C;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#xFF08;&#x4F8B;&#x5982;&#xFF0C;&#x5168;&#x5C40;&#x65E5;&#x5FD7;&#x6587;&#x4EF6;&#xFF09;&#x5C3E;&#x90E8;&#x6DFB;&#x52A0;&#x6570;&#x636E;&#x3002;&#x4E3A;&#x4E86;&#x8FBE;&#x5230;&#x8FD9;&#x4E00;&#x76EE;&#x7684;&#xFF0C;&#x9700;&#x8981;&#x5C06;&#x6587;&#x4EF6;&#x504F;&#x79FB;&#x91CF;&#x7684;&#x79FB;&#x52A8;&#x4E0E;&#x6570;&#x636E;&#x5199;&#x64CD;&#x4F5C;&#x7EB3;&#x5165;&#x540C;&#x4E00;&#x539F;&#x5B50;&#x64CD;&#x4F5C;&#x3002;&#x5728;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x65F6;&#x52A0;&#x5165;O_APPEND&#x6807;&#x5FD7;&#x5C31;&#x53EF;&#x4EE5;&#x4FDD;&#x8BC1;&#x8FD9;&#x4E00;&#x70B9;&#x3002;</p>
<h2 id="&#x6587;&#x4EF6;&#x63A7;&#x5236;&#x64CD;&#x4F5C;&#xFF1A;fcntl"><a href="#&#x6587;&#x4EF6;&#x63A7;&#x5236;&#x64CD;&#x4F5C;&#xFF1A;fcntl" class="headerlink" title="&#x6587;&#x4EF6;&#x63A7;&#x5236;&#x64CD;&#x4F5C;&#xFF1A;fcntl()"></a>&#x6587;&#x4EF6;&#x63A7;&#x5236;&#x64CD;&#x4F5C;&#xFF1A;fcntl()</h2><p>fcntl()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5BF9;&#x4E00;&#x4E2A;&#x6253;&#x5F00;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x6267;&#x884C;&#x4E00;&#x7CFB;&#x5217;&#x63A7;&#x5236;&#x64CD;&#x4F5C;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;fcntl.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">fcntl</span><span class="token punctuation">(</span><span class="token keyword">int</span> fd <span class="token punctuation">,</span><span class="token keyword">int</span> cmd <span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>fcntl()&#x7684;&#x7B2C;&#x4E09;&#x4E2A;&#x53C2;&#x6570;&#x4EE5;&#x7701;&#x7565;&#x53F7;&#x6765;&#x8868;&#x793A;&#xFF0C;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x53EF;&#x4EE5;&#x5C06;&#x5176;&#x8BBE;&#x7F6E;&#x4E3A;&#x4E0D;&#x540C;&#x7684;&#x7C7B;&#x578B;&#xFF0C;&#x6216;&#x8005;&#x52A0;&#x4EE5;&#x7701;&#x7565;&#x3002;&#x5185;&#x6838;&#x4F1A;&#x4F9D;&#x636E;cmd&#x53C2;&#x6570;&#xFF08;&#x5982;&#x679C;&#x6709;&#x7684;&#x8BDD;&#xFF09;&#x7684;&#x503C;&#x6765;&#x786E;&#x5B9A;&#x8BE5;&#x53C2;&#x6570;&#x7684;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x3002;</p>
<p><strong>cmd&#x53C2;&#x6570;&#xFF1A;</strong><br>1.<br>&#x5224;&#x5B9A;&#x6587;&#x4EF6;&#x7684;&#x8BBF;&#x95EE;&#x6A21;&#x5F0F;&#x6709;&#x4E00;&#x70B9;&#x590D;&#x6742;&#xFF0C;&#x8FD9;&#x662F;&#x56E0;&#x4E3A;O_RDONLY(0)&#x3001;O_WRONLY(1)&#x548C;O_RDWR(2)&#x8FD9;3&#x4E2A;&#x5E38;&#x91CF;&#x5E76;&#x4E0D;&#x4E0E;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x72B6;&#x6001;&#x6807;&#x5FD7;&#x4E2D;&#x7684;&#x5355;&#x4E2A;&#x6BD4;&#x7279;&#x4F4D;&#x5BF9;&#x5E94;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x8981;&#x5224;&#x5B9A;&#x8BBF;&#x95EE;&#x6A21;&#x5F0F;&#xFF0C;&#x9700;&#x4F7F;&#x7528;&#x63A9;&#x7801;O_ACCMODE&#x4E0E;flag&#x76F8;&#x4E0E;&#xFF0C;&#x5C06;&#x7ED3;&#x679C;&#x4E0E;3&#x4E2A;&#x5E38;&#x91CF;&#x8FDB;&#x884C;&#x6BD4;&#x5BF9;&#xFF0C;&#x793A;&#x4F8B;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">int</span> flags<span class="token punctuation">,</span>accessMode<span class="token punctuation">;</span>

flags<span class="token operator">=</span><span class="token function">fcntl</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span>F_GETFL<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//&#x7B2C;&#x4E09;&#x4E2A;&#x53C2;&#x6570;&#x4E0D;&#x8981;&#x6C42;</span>
accessMode<span class="token operator">=</span>flags <span class="token operator">&amp;</span> O_ACCMODE<span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>accessMode <span class="token operator">==</span> O_WRONLY <span class="token operator">||</span> accessMode <span class="token operator">==</span> O_RDWR<span class="token punctuation">)</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;file is writeable\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>2.<br>&#x4E3A;&#x4E86;&#x4FEE;&#x6539;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x7684;&#x72B6;&#x6001;&#x6807;&#x5FD7;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;fcntl()&#x7684;F_GETFL&#x547D;&#x4EE4;&#x6765;&#x83B7;&#x53D6;&#x5F53;&#x524D;&#x6807;&#x5FD7;&#x7684;&#x526F;&#x672C;&#xFF0C;&#x7136;&#x540E;&#x4FEE;&#x6539;&#x9700;&#x8981;&#x53D8;&#x66F4;&#x7684;&#x6BD4;&#x7279;&#x4F4D;&#xFF0C;&#x6700;&#x540E;&#x518D;&#x6B21;&#x8C03;&#x7528;fcntl()&#x51FD;&#x6570;&#x7684;F_SETFL&#x547D;&#x4EE4;&#x6765;&#x66F4;&#x65B0;&#x6B64;&#x72B6;&#x6001;&#x6807;&#x5FD7;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x4E3A;&#x4E86;&#x6DFB;&#x52A0;O_APPEND&#x6807;&#x5FD7;&#xFF0C;&#x53EF;&#x4EE5;&#x7F16;&#x5199;&#x5982;&#x4E0B;&#x4EE3;&#x7801;&#xFF1A;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">int</span> flags<span class="token punctuation">;</span>

flags<span class="token operator">=</span><span class="token function">fcntl</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span>F_GETFL<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>flags <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token function">errExit</span><span class="token punctuation">(</span><span class="token string">&quot;fcntl&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
flags <span class="token operator">|</span><span class="token operator">=</span> O_APPEND<span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">fcntl</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span>F_SETFL<span class="token punctuation">,</span>flags<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token function">errExit</span><span class="token punctuation">(</span><span class="token string">&quot;fcntl&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x548C;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x7CFB;"><a href="#&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x548C;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x7CFB;" class="headerlink" title="&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x548C;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x7CFB;"></a>&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x548C;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x7CFB;</h2><p>&#x5185;&#x6838;&#x5BF9;&#x6240;&#x6709;&#x6253;&#x5F00;&#x7684;&#x6587;&#x4EF6;&#x7EF4;&#x62A4;&#x6709;&#x4E00;&#x4E2A;&#x7CFB;&#x7EDF;&#x7EA7;&#x7684;&#x63CF;&#x8FF0;&#x8868;&#x683C;&#xFF08;open file description table&#xFF09;&#x3002;&#x6709;&#x65F6;&#xFF0C;&#x4E5F;&#x79F0;&#x4E4B;&#x4E3A;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x8868;&#xFF08;open file table&#xFF09;&#xFF0C;&#x5E76;&#x5C06;&#x8868;&#x4E2D;&#x5404;&#x6761;&#x76EE;&#x79F0;&#x4E3A;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x53E5;&#x67C4;&#xFF08;open file handle&#xFF09;&#x3002;&#x4E00;&#x4E2A;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x53E5;&#x67C4;&#x5B58;&#x50A8;&#x4E86;&#x4E0E;&#x4E00;&#x4E2A;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x76F8;&#x5173;&#x7684;&#x5168;&#x90E8;&#x4FE1;&#x606F;&#xFF0C;&#x5982;&#x4E0B;&#x6240;&#x793A;:</p>
<p>&#x5F53;&#x524D;&#x6587;&#x4EF6;&#x504F;&#x79FB;&#x91CF;&#xFF08;&#x8C03;&#x7528;read()&#x548C;write()&#x65F6;&#x66F4;&#x65B0;&#xFF0C;&#x6216;&#x4F7F;&#x7528;lseek()&#x76F4;&#x63A5;&#x4FEE;&#x6539;&#xFF09;&#x3002;<br>&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x65F6;&#x6240;&#x4F7F;&#x7528;&#x7684;&#x72B6;&#x6001;&#x6807;&#x5FD7;&#xFF08;&#x5373;&#xFF0C;open()&#x7684;flags&#x53C2;&#x6570;&#xFF09;&#x3002;<br>&#x6587;&#x4EF6;&#x8BBF;&#x95EE;&#x6A21;&#x5F0F;&#xFF08;&#x5982;&#x8C03;&#x7528;open()&#x65F6;&#x6240;&#x8BBE;&#x7F6E;&#x7684;&#x53EA;&#x8BFB;&#x6A21;&#x5F0F;&#x3001;&#x53EA;&#x5199;&#x6A21;&#x5F0F;&#x6216;&#x8BFB;&#x5199;&#x6A21;&#x5F0F;&#xFF09;&#x3002;<br>&#x4E0E;&#x4FE1;&#x53F7;&#x9A71;&#x52A8;I/O&#x76F8;&#x5173;&#x7684;&#x8BBE;&#x7F6E;&#x3002;<br>&#x5BF9;&#x8BE5;&#x6587;&#x4EF6;i-node&#x5BF9;&#x8C61;&#x7684;&#x5F15;&#x7528;&#x3002;</p>
<p>&#x4E24;&#x4E2A;&#x4E0D;&#x540C;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#xFF0C;&#x82E5;&#x6307;&#x5411;&#x540C;&#x4E00;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x53E5;&#x67C4;&#xFF0C;&#x5C06;&#x5171;&#x4EAB;&#x540C;&#x4E00;&#x6587;&#x4EF6;&#x504F;&#x79FB;&#x91CF;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x5982;&#x679C;&#x901A;&#x8FC7;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x6765;&#x4FEE;&#x6539;&#x6587;&#x4EF6;&#x504F;&#x79FB;&#x91CF;&#xFF08;&#x7531;&#x8C03;&#x7528;read()&#x3001;write()&#x6216;lseek()&#x6240;&#x81F4;&#xFF09;&#xFF0C;&#x90A3;&#x4E48;&#x4ECE;&#x53E6;&#x4E00;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x4E2D;&#x4E5F;&#x4F1A;&#x89C2;&#x5BDF;&#x5230;&#x8FD9;&#x4E00;&#x53D8;&#x5316;&#x3002;&#x65E0;&#x8BBA;&#x8FD9;&#x4E24;&#x4E2A;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x5206;&#x5C5E;&#x4E8E;&#x4E0D;&#x540C;&#x8FDB;&#x7A0B;&#xFF0C;&#x8FD8;&#x662F;&#x540C;&#x5C5E;&#x4E8E;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#xFF0C;&#x60C5;&#x51B5;&#x90FD;&#x662F;&#x5982;&#x6B64;&#x3002;<br>&#x8981;&#x83B7;&#x53D6;&#x548C;&#x4FEE;&#x6539;&#x6253;&#x5F00;&#x7684;&#x6587;&#x4EF6;&#x6807;&#x5FD7;&#xFF08;&#x4F8B;&#x5982;&#xFF0C;O_APPEND&#x3001;O_NONBLOCK&#x548C;O_ASYNC&#xFF09;&#xFF0C;&#x53EF;&#x6267;&#x884C;fcntl()&#x7684;F_GETFL&#x548C;F_SETFL&#x64CD;&#x4F5C;&#xFF0C;&#x5176;&#x5BF9;&#x4F5C;&#x7528;&#x57DF;&#x7684;&#x7EA6;&#x675F;&#x4E0E;&#x4E0A;&#x4E00;&#x6761;&#x9887;&#x4E3A;&#x7C7B;&#x4F3C;&#x3002;<br>&#x76F8;&#x5F62;&#x4E4B;&#x4E0B;&#xFF0C;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x6807;&#x5FD7;&#xFF08;&#x4EA6;&#x5373;&#xFF0C;close-on-exec&#x6807;&#x5FD7;&#xFF09;&#x4E3A;&#x8FDB;&#x7A0B;&#x548C;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x6240;&#x79C1;&#x6709;&#x3002;&#x5BF9;&#x8FD9;&#x4E00;&#x6807;&#x5FD7;&#x7684;&#x4FEE;&#x6539;&#x5C06;&#x4E0D;&#x4F1A;&#x5F71;&#x54CD;&#x540C;&#x4E00;&#x8FDB;&#x7A0B;&#x6216;&#x4E0D;&#x540C;&#x8FDB;&#x7A0B;&#x4E2D;&#x7684;&#x5176;&#x4ED6;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x3002;</p>
<h2 id="&#x590D;&#x5236;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;"><a href="#&#x590D;&#x5236;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;" class="headerlink" title="&#x590D;&#x5236;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;"></a>&#x590D;&#x5236;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;</h2><p>dup()&#x8C03;&#x7528;&#x590D;&#x5236;&#x4E00;&#x4E2A;&#x6253;&#x5F00;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;oldfd&#xFF0C;&#x5E76;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x65B0;&#x63CF;&#x8FF0;&#x7B26;&#xFF0C;&#x4E8C;&#x8005;&#x90FD;&#x6307;&#x5411;&#x540C;&#x4E00;&#x6253;&#x5F00;&#x7684;&#x6587;&#x4EF6;&#x53E5;&#x67C4;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;unistd.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">dup</span><span class="token punctuation">(</span><span class="token keyword">int</span> oldfd<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>Linux&#x4ECE;2.6.24&#x5F00;&#x59CB;&#x652F;&#x6301;fcntl()&#x7528;&#x4E8E;&#x590D;&#x5236;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x7684;&#x9644;&#x52A0;&#x547D;&#x4EE4;&#xFF1A;F_DUPFD_CLOEXEC&#x3002;&#x8BE5;&#x6807;&#x5FD7;&#x4E0D;&#x4EC5;&#x5B9E;&#x73B0;&#x4E86;&#x4E0E;F_DUPFD&#x76F8;&#x540C;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x8FD8;&#x4E3A;&#x65B0;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x8BBE;&#x7F6E;close-on-exec&#x6807;&#x5FD7;&#x3002;&#x540C;&#x6837;&#xFF0C;&#x6B64;&#x547D;&#x4EE4;&#x4E4B;&#x6240;&#x4EE5;&#x5F97;&#x4EE5;&#x4E00;&#x663E;&#x8EAB;&#x624B;&#xFF0C;&#x5176;&#x539F;&#x56E0;&#x4E5F;&#x7C7B;&#x4F3C;&#x4E8E;open()&#x8C03;&#x7528;&#x4E2D;&#x7684;O_CLOEXEC&#x6807;&#x5FD7;&#x3002;SUSv3&#x5E76;&#x672A;&#x8BBA;&#x53CA;F_DUPFD_CLOEXEC&#x6807;&#x5FD7;&#xFF0C;&#x4F46;SUSv4&#x5BF9;&#x5176;&#x4F5C;&#x4E86;&#x89C4;&#x8303;&#x3002;</p>
<h2 id="&#x5728;&#x6587;&#x4EF6;&#x7279;&#x5B9A;&#x504F;&#x79FB;&#x91CF;&#x5904;&#x7684;I-O&#xFF1A;pread-&#x548C;pwrite"><a href="#&#x5728;&#x6587;&#x4EF6;&#x7279;&#x5B9A;&#x504F;&#x79FB;&#x91CF;&#x5904;&#x7684;I-O&#xFF1A;pread-&#x548C;pwrite" class="headerlink" title="&#x5728;&#x6587;&#x4EF6;&#x7279;&#x5B9A;&#x504F;&#x79FB;&#x91CF;&#x5904;&#x7684;I/O&#xFF1A;pread()&#x548C;pwrite()"></a>&#x5728;&#x6587;&#x4EF6;&#x7279;&#x5B9A;&#x504F;&#x79FB;&#x91CF;&#x5904;&#x7684;I/O&#xFF1A;pread()&#x548C;pwrite()</h2><p>&#x7CFB;&#x7EDF;&#x8C03;&#x7528;pread()&#x548C;pwrite()&#x5B8C;&#x6210;&#x4E0E;read()&#x548C;write()&#x76F8;&#x7C7B;&#x4F3C;&#x7684;&#x5DE5;&#x4F5C;&#xFF0C;&#x53EA;&#x662F;&#x524D;&#x4E24;&#x8005;&#x4F1A;&#x5728;offset&#x53C2;&#x6570;&#x6240;&#x6307;&#x5B9A;&#x7684;&#x4F4D;&#x7F6E;&#x8FDB;&#x884C;&#x6587;&#x4EF6;I/O&#x64CD;&#x4F5C;&#xFF0C;&#x800C;&#x975E;&#x59CB;&#x4E8E;&#x6587;&#x4EF6;&#x7684;&#x5F53;&#x524D;&#x504F;&#x79FB;&#x91CF;&#x5904;&#xFF0C;&#x4E14;&#x5B83;&#x4EEC;&#x4E0D;&#x4F1A;&#x6539;&#x53D8;&#x6587;&#x4EF6;&#x7684;&#x5F53;&#x524D;&#x504F;&#x79FB;&#x91CF;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;unistd.h&gt;</span></span>
ssize_t <span class="token function">pread</span><span class="token punctuation">(</span><span class="token keyword">int</span> fd<span class="token punctuation">,</span><span class="token keyword">void</span> <span class="token operator">*</span>buf<span class="token punctuation">,</span>size_t count<span class="token punctuation">,</span>off_t offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x8C03;&#x7528;&#x6210;&#x529F;&#x8FD4;&#x56DE;&#x5B57;&#x8282;&#x6570;&#xFF0C;&#x6587;&#x4EF6;&#x5C3E;&#x8FD4;&#x56DE;0&#xFF0C;&#x8C03;&#x7528;&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1</span>
ssize_t <span class="token function">pwite</span><span class="token punctuation">(</span><span class="token keyword">int</span> fd<span class="token punctuation">,</span><span class="token keyword">const</span> <span class="token keyword">void</span> <span class="token operator">*</span>buf<span class="token punctuation">,</span>size_t count<span class="token punctuation">,</span>off_t offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x8C03;&#x7528;&#x6210;&#x529F;&#x8FD4;&#x56DE;&#x5B57;&#x8282;&#x6570;&#xFF0C;&#x8C03;&#x7528;&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x5982;&#x679C;&#x9700;&#x8981;&#x53CD;&#x590D;&#x6267;&#x884C;lseek()&#xFF0C;&#x5E76;&#x4F34;&#x4E4B;&#x4EE5;&#x6587;&#x4EF6;I/O&#xFF0C;&#x90A3;&#x4E48;pread()&#x548C;pwrite()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5728;&#x67D0;&#x4E9B;&#x60C5;&#x51B5;&#x4E0B;&#x662F;&#x5177;&#x6709;&#x6027;&#x80FD;&#x4F18;&#x52BF;&#x7684;&#x3002;&#x8FD9;&#x662F;&#x56E0;&#x4E3A;&#x6267;&#x884C;&#x5355;&#x4E2A;pread()&#xFF08;&#x6216;pwrite()&#xFF09;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x7684;&#x6210;&#x672C;&#x8981;&#x4F4E;&#x4E8E;&#x6267;&#x884C;lseek()&#x548C;read()&#xFF08;&#x6216;write()&#xFF09;&#x4E24;&#x4E2A;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x3002;&#x7136;&#x800C;&#xFF0C;&#x8F83;&#x4E4B;&#x4E8E;&#x6267;&#x884C;I/O&#x5B9E;&#x9645;&#x6240;&#x9700;&#x7684;&#x65F6;&#x95F4;&#xFF0C;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x7684;&#x5F00;&#x9500;&#x5C31;&#x6709;&#x4E9B;&#x76F8;&#x5F62;&#x89C1;&#x7ECC;&#x4E86;&#x3002;</p>
<h2 id="&#x5206;&#x6563;&#x8F93;&#x5165;&#x548C;&#x96C6;&#x4E2D;&#x8F93;&#x51FA;"><a href="#&#x5206;&#x6563;&#x8F93;&#x5165;&#x548C;&#x96C6;&#x4E2D;&#x8F93;&#x51FA;" class="headerlink" title="&#x5206;&#x6563;&#x8F93;&#x5165;&#x548C;&#x96C6;&#x4E2D;&#x8F93;&#x51FA;"></a>&#x5206;&#x6563;&#x8F93;&#x5165;&#x548C;&#x96C6;&#x4E2D;&#x8F93;&#x51FA;</h2><p>readv()&#x548C;writev()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5206;&#x522B;&#x5B9E;&#x73B0;&#x4E86;&#x5206;&#x6563;&#x8F93;&#x5165;&#x548C;&#x96C6;&#x4E2D;&#x8F93;&#x51FA;&#x7684;&#x529F;&#x80FD;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;sys/uio.h&gt;</span></span>
ssize_t <span class="token function">readv</span><span class="token punctuation">(</span><span class="token keyword">int</span> fd<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">struct</span> iovec <span class="token operator">*</span>iov<span class="token punctuation">,</span><span class="token keyword">int</span> iovcnt<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x8C03;&#x7528;&#x6210;&#x529F;&#x8FD4;&#x56DE;&#x5B57;&#x8282;&#x6570;&#xFF0C;&#x6587;&#x4EF6;&#x5C3E;&#x8FD4;&#x56DE;0&#xFF0C;&#x8C03;&#x7528;&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1</span>
ssize_t <span class="token function">writev</span><span class="token punctuation">(</span><span class="token keyword">int</span> fd<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">struct</span> iovec <span class="token operator">*</span>iov<span class="token punctuation">,</span><span class="token keyword">int</span> iovcnt<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x8FD9;&#x4E9B;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5E76;&#x975E;&#x53EA;&#x5BF9;&#x5355;&#x4E2A;&#x7F13;&#x51B2;&#x533A;&#x8FDB;&#x884C;&#x8BFB;&#x5199;&#x64CD;&#x4F5C;&#xFF0C;&#x800C;&#x662F;&#x4E00;&#x6B21;&#x5373;&#x53EF;&#x4F20;&#x8F93;&#x591A;&#x4E2A;&#x7F13;&#x51B2;&#x533A;&#x7684;&#x6570;&#x636E;&#x3002;&#x6570;&#x7EC4;iov&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x7EC4;&#x7528;&#x6765;&#x4F20;&#x8F93;&#x6570;&#x636E;&#x7684;&#x7F13;&#x51B2;&#x533A;&#x3002;&#x6574;&#x578B;&#x6570;iovcnt&#x5219;&#x6307;&#x5B9A;&#x4E86;iov&#x7684;&#x6210;&#x5458;&#x4E2A;&#x6570;&#x3002;iov&#x4E2D;&#x7684;&#x6BCF;&#x4E2A;&#x6210;&#x5458;&#x90FD;&#x662F;&#x5982;&#x4E0B;&#x5F62;&#x5F0F;&#x7684;&#x6570;&#x636E;&#x7ED3;&#x6784;:</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">struct</span> iovec<span class="token punctuation">{</span>
<span class="token keyword">void</span> <span class="token operator">*</span>iov_base<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//&#x7F13;&#x51B2;&#x533A;&#x8D77;&#x59CB;&#x5730;&#x5740;</span>
size_t iov_len<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//&#x8F6C;&#x6362;&#x5B57;&#x8282;&#x6570;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>&#x4F8B;&#x7A0B;&#xFF1A;</strong></p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token comment" spellcheck="true">/* t_readv.c

   Demonstrate the use of the readv() system call to perform &quot;gather I/O&quot;.

   (This program is merely intended to provide a code snippet for the book;
   unless you construct a suitably formatted input file, it can&apos;t be
   usefully executed.)
*/</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;sys/stat.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;sys/uio.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;fcntl.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string.h&gt;</span></span>

<span class="token keyword">int</span>
<span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> fd<span class="token punctuation">;</span>
    <span class="token keyword">struct</span> iovec iov<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">struct</span> stat myStruct<span class="token punctuation">;</span>       <span class="token comment" spellcheck="true">/* First buffer */</span>
    <span class="token keyword">int</span> x<span class="token punctuation">;</span>                      <span class="token comment" spellcheck="true">/* Second buffer */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> STR_SIZE 100</span>
    <span class="token keyword">char</span> str<span class="token punctuation">[</span>STR_SIZE<span class="token punctuation">]</span><span class="token punctuation">;</span>         <span class="token comment" spellcheck="true">/* Third buffer */</span>
    ssize_t numRead<span class="token punctuation">,</span> totRequired<span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>argc <span class="token operator">!=</span> <span class="token number">2</span> <span class="token operator">||</span> <span class="token function">strcmp</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;--help&quot;</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%s file\n&quot;</span><span class="token punctuation">,</span> argv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    fd <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> O_RDONLY<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>fd <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;open&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    totRequired <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    iov<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>iov_base <span class="token operator">=</span> <span class="token operator">&amp;</span>myStruct<span class="token punctuation">;</span>
    iov<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>iov_len <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> stat<span class="token punctuation">)</span><span class="token punctuation">;</span>
    totRequired <span class="token operator">+</span><span class="token operator">=</span> iov<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>iov_len<span class="token punctuation">;</span>

    iov<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>iov_base <span class="token operator">=</span> <span class="token operator">&amp;</span>x<span class="token punctuation">;</span>
    iov<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>iov_len <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    totRequired <span class="token operator">+</span><span class="token operator">=</span> iov<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>iov_len<span class="token punctuation">;</span>

    iov<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>iov_base <span class="token operator">=</span> str<span class="token punctuation">;</span>
    iov<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>iov_len <span class="token operator">=</span> STR_SIZE<span class="token punctuation">;</span>
    totRequired <span class="token operator">+</span><span class="token operator">=</span> iov<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>iov_len<span class="token punctuation">;</span>

    numRead <span class="token operator">=</span> <span class="token function">readv</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> iov<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>numRead <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;readv&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>numRead <span class="token operator">&lt;</span> totRequired<span class="token punctuation">)</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Read fewer bytes than requested\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;total bytes requested: %ld; bytes read: %ld\n&quot;</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span> totRequired<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span> numRead<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>./a.out file
openreadvRead fewer bytes than requested
total bytes requested: 248; bytes read: -1</code></pre><h2 id="&#x622A;&#x65AD;&#x6587;&#x4EF6;"><a href="#&#x622A;&#x65AD;&#x6587;&#x4EF6;" class="headerlink" title="&#x622A;&#x65AD;&#x6587;&#x4EF6;"></a>&#x622A;&#x65AD;&#x6587;&#x4EF6;</h2><p>truncate()&#x548C;ftruncate()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5C06;&#x6587;&#x4EF6;&#x5927;&#x5C0F;&#x8BBE;&#x7F6E;&#x4E3A;length&#x53C2;&#x6570;&#x6307;&#x5B9A;&#x7684;&#x503C;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;unistd.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">truncate</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>pathname<span class="token punctuation">,</span>off_t length<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">ftruncate</span><span class="token punctuation">(</span><span class="token keyword">int</span> fd<span class="token punctuation">,</span>off_t length<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x90FD;&#x662F;&#x6210;&#x529F;&#x8FD4;&#x56DE;0&#xFF0C;&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x82E5;&#x6587;&#x4EF6;&#x5F53;&#x524D;&#x957F;&#x5EA6;&#x5927;&#x4E8E;&#x53C2;&#x6570;length&#xFF0C;&#x8C03;&#x7528;&#x5C06;&#x4E22;&#x5F03;&#x8D85;&#x51FA;&#x90E8;&#x5206;&#xFF0C;&#x82E5;&#x5C0F;&#x4E8E;&#x53C2;&#x6570;length&#xFF0C;&#x8C03;&#x7528;&#x5C06;&#x5728;&#x6587;&#x4EF6;&#x5C3E;&#x90E8;&#x6DFB;&#x52A0;&#x4E00;&#x7CFB;&#x5217;&#x7A7A;&#x5B57;&#x8282;&#x6216;&#x662F;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x7A7A;&#x6D1E;&#x3002;<br>&#x4E24;&#x4E2A;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x4E4B;&#x95F4;&#x7684;&#x5DEE;&#x522B;&#x5728;&#x4E8E;&#x5982;&#x4F55;&#x6307;&#x5B9A;&#x64CD;&#x4F5C;&#x6587;&#x4EF6;&#x3002;truncate()&#x4EE5;&#x8DEF;&#x5F84;&#x540D;&#x5B57;&#x7B26;&#x4E32;&#x6765;&#x6307;&#x5B9A;&#x6587;&#x4EF6;&#xFF0C;&#x5E76;&#x8981;&#x6C42;&#x53EF;&#x8BBF;&#x95EE;&#x8BE5;&#x6587;&#x4EF6;&#xFF0C;&#x4E14;&#x5BF9;&#x6587;&#x4EF6;&#x62E5;&#x6709;&#x5199;&#x6743;&#x9650;&#x3002;&#x82E5;&#x6587;&#x4EF6;&#x540D;&#x4E3A;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#xFF0C;&#x90A3;&#x4E48;&#x8C03;&#x7528;&#x5C06;&#x5BF9;&#x5176;&#x8FDB;&#x884C;&#x89E3;&#x5F15;&#x7528;&#x3002;&#x800C;&#x8C03;&#x7528;ftruncate()&#x4E4B;&#x524D;&#xFF0C;&#x9700;&#x4EE5;&#x53EF;&#x5199;&#x65B9;&#x5F0F;&#x6253;&#x5F00;&#x64CD;&#x4F5C;&#x6587;&#x4EF6;&#xFF0C;&#x83B7;&#x53D6;&#x5176;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x4EE5;&#x6307;&#x4EE3;&#x8BE5;&#x6587;&#x4EF6;&#xFF0C;&#x8BE5;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x4E0D;&#x4F1A;&#x4FEE;&#x6539;&#x6587;&#x4EF6;&#x504F;&#x79FB;&#x91CF;&#x3002;</p>
<h2 id="&#x975E;&#x963B;&#x585E;I-O"><a href="#&#x975E;&#x963B;&#x585E;I-O" class="headerlink" title="&#x975E;&#x963B;&#x585E;I/O"></a>&#x975E;&#x963B;&#x585E;I/O</h2><p>&#x5728;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x65F6;&#x6307;&#x5B9A;O_NONBLOCK&#x6807;&#x5FD7;&#xFF0C;&#x76EE;&#x7684;&#x6709;&#x4E8C;&#x3002;</p>
<p>&#x82E5;open()&#x8C03;&#x7528;&#x672A;&#x80FD;&#x7ACB;&#x5373;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#xFF0C;&#x5219;&#x8FD4;&#x56DE;&#x9519;&#x8BEF;&#xFF0C;&#x800C;&#x975E;&#x9677;&#x5165;&#x963B;&#x585E;&#x3002;&#x6709;&#x4E00;&#x79CD;&#x60C5;&#x51B5;&#x5C5E;&#x4E8E;&#x4F8B;&#x5916;&#xFF0C;&#x8C03;&#x7528;open()&#x64CD;&#x4F5C;FIFO&#x53EF;&#x80FD;&#x4F1A;&#x9677;&#x5165;&#x963B;&#x585E;&#x3002;<br>&#x8C03;&#x7528;open()&#x6210;&#x529F;&#x540E;&#xFF0C;&#x540E;&#x7EED;&#x7684;I/O&#x64CD;&#x4F5C;&#x4E5F;&#x662F;&#x975E;&#x963B;&#x585E;&#x7684;&#x3002;&#x82E5;I/O&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x672A;&#x80FD;&#x7ACB;&#x5373;&#x5B8C;&#x6210;&#xFF0C;&#x5219;&#x53EF;&#x80FD;&#x4F1A;&#x53EA;&#x4F20;&#x8F93;&#x90E8;&#x5206;&#x6570;&#x636E;&#xFF0C;&#x6216;&#x8005;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5931;&#x8D25;&#xFF0C;&#x5E76;&#x8FD4;&#x56DE;EAGAIN&#x6216;EWOULDBLOCK&#x9519;&#x8BEF;&#x3002;&#x5177;&#x4F53;&#x8FD4;&#x56DE;&#x4F55;&#x79CD;&#x9519;&#x8BEF;&#x5C06;&#x4F9D;<br>&#x8D56;&#x4E8E;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x3002;Linux&#x7CFB;&#x7EDF;&#x4E0E;&#x8BB8;&#x591A;UNIX&#x5B9E;&#x73B0;&#x4E00;&#x6837;&#xFF0C;&#x5C06;&#x4E24;&#x4E2A;&#x9519;&#x8BEF;&#x5E38;&#x91CF;&#x89C6;&#x4E3A;&#x540C;&#x4E49;&#x3002;<br>&#x7BA1;&#x9053;&#x3001;FIFO&#x3001;&#x5957;&#x63A5;&#x5B57;&#x3001;&#x8BBE;&#x5907;&#xFF08;&#x6BD4;&#x5982;&#x7EC8;&#x7AEF;&#x3001;&#x4F2A;&#x7EC8;&#x7AEF;&#xFF09;&#x90FD;&#x652F;&#x6301;&#x975E;&#x963B;&#x585E;&#x6A21;&#x5F0F;&#x3002;&#xFF08;&#x56E0;&#x4E3A;&#x65E0;&#x6CD5;&#x901A;&#x8FC7; open()&#x6765;&#x83B7;&#x53D6;&#x7BA1;&#x9053;&#x548C;&#x5957;&#x63A5;&#x5B57;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#xFF0C;&#x6240;&#x4EE5;&#x8981;&#x542F;&#x7528;&#x975E;&#x963B;&#x585E;&#x6807;&#x5FD7;&#xFF0C;&#x5C31;&#x5FC5;&#x987B;&#x4F7F;&#x7528;5.3&#x8282;&#x6240;&#x8FF0;fcntl()&#x7684;F_SETFL&#x547D;&#x4EE4;&#x3002;&#xFF09;</p>
<p>&#x7531;&#x4E8E;&#x5185;&#x6838;&#x7F13;&#x51B2;&#x533A;&#x4FDD;&#x8BC1;&#x4E86;&#x666E;&#x901A;&#x6587;&#x4EF6;I/O&#x4E0D;&#x4F1A;&#x9677;&#x5165;&#x963B;&#x585E;&#xFF0C;&#x6545;&#x800C;&#x6253;&#x5F00;&#x666E;&#x901A;&#x6587;&#x4EF6;&#x65F6;&#x4E00;&#x822C;&#x4F1A;&#x5FFD;&#x7565;O_NONBLOCK&#x6807;&#x5FD7;&#x3002;&#x7136;&#x800C;&#xFF0C;&#x5F53;&#x4F7F;&#x7528;&#x5F3A;&#x5236;&#x6587;&#x4EF6;&#x9501;&#x65F6;&#xFF0C;O_NONBLOCK&#x6807;&#x5FD7;&#x5BF9;&#x666E;&#x901A;&#x6587;&#x4EF6;&#x4E5F;&#x662F;&#x8D77;&#x4F5C;&#x7528;&#x7684;&#x3002;</p>
<h2 id="&#x5927;&#x6587;&#x4EF6;I-O"><a href="#&#x5927;&#x6587;&#x4EF6;I-O" class="headerlink" title="&#x5927;&#x6587;&#x4EF6;I/O"></a>&#x5927;&#x6587;&#x4EF6;I/O</h2><p>&#x901A;&#x5E38;&#x5C06;&#x5B58;&#x653E;&#x6587;&#x4EF6;&#x504F;&#x79FB;&#x91CF;&#x7684;&#x6570;&#x636E;&#x7C7B;&#x578B; off_t &#x5B9E;&#x73B0;&#x4E3A;&#x4E00;&#x4E2A;&#x6709;&#x7B26;&#x53F7;&#x7684;&#x957F;&#x6574;&#x578B;&#x3002;&#xFF08;&#x4E4B;&#x6240;&#x4EE5;&#x91C7;&#x7528;&#x6709;&#x7B26;&#x53F7;&#x6570;&#x636E;&#x7C7B;&#x578B;&#xFF0C;&#x662F;&#x8981;&#x4EE5;&#x2212;1&#x6765;&#x8868;&#x793A;&#x9519;&#x8BEF;&#x60C5;&#x51B5;&#x3002;&#xFF09;&#x5728;32&#x4F4D;&#x4F53;&#x7CFB;&#x67B6;&#x6784;&#x4E2D;&#xFF08;&#x6BD4;&#x5982;x86-32&#xFF09;&#xFF0C;&#x8FD9;&#x5C06;&#x6587;&#x4EF6;&#x5927;&#x5C0F;&#x7F6E;&#x4E8E;(2^31)&#x2212;1&#x4E2A;&#x5B57;&#x8282;&#xFF08;&#x5373;2GB&#xFF09;&#x7684;&#x9650;&#x5236;&#x4E4B;&#x4E0B;&#x3002;<br>&#x7136;&#x800C;&#xFF0C;&#x78C1;&#x76D8;&#x9A71;&#x52A8;&#x5668;&#x7684;&#x5BB9;&#x91CF;&#x65E9;&#x5DF2;&#x8D85;&#x51FA;&#x8FD9;&#x4E00;&#x9650;&#x5236;&#xFF0C;&#x56E0;&#x6B64;32&#x4F4D;UNIX&#x5B9E;&#x73B0;&#x6709;&#x5904;&#x7406;&#x8D85;&#x8FC7;2GB&#x5927;&#x5C0F;&#x6587;&#x4EF6;&#x7684;&#x9700;&#x6C42;&#xFF0C;&#x8FD9;&#x4E5F;&#x5728;&#x60C5;&#x7406;&#x4E4B;&#x4E2D;&#x3002;&#x7531;&#x4E8E;&#x95EE;&#x9898;&#x8F83;&#x4E3A;&#x666E;&#x904D;&#xFF0C;UNIX&#x5382;&#x5546;&#x8054;&#x76DF;&#x5728;&#x5927;&#x578B;&#x6587;&#x4EF6;&#x5CF0;&#x4F1A;&#xFF08;Large File Summit&#xFF09;&#x4E0A;&#x5C31;&#x6B64;&#x8FDB;&#x884C;&#x4E86;&#x534F;&#x5546;&#xFF0C;&#x5E76;&#x9488;&#x5BF9;&#x5FC5;&#x9700;&#x7684;&#x5927;&#x6587;&#x4EF6;&#x8BBF;&#x95EE;&#x529F;&#x80FD;&#xFF0C;&#x5F62;&#x6210;&#x4E86;&#x5BF9;SUSv2&#x89C4;&#x8303;&#x7684;&#x6269;&#x5C55;&#x3002;<br>&#x59CB;&#x4E8E;&#x5185;&#x6838;&#x7248;&#x672C;2.4&#xFF0C;32&#x4F4D;Linux&#x7CFB;&#x7EDF;&#x5F00;&#x59CB;&#x63D0;&#x4F9B;&#x5BF9;LFS&#x7684;&#x652F;&#x6301;&#xFF08;glibc&#x7248;&#x672C;&#x5FC5;&#x987B;&#x4E3A;2.2&#x6216;&#x66F4;&#x9AD8;&#xFF09;&#x3002;&#x53E6;&#x4E00;&#x4E2A;&#x524D;&#x63D0;&#x662F;&#xFF0C;&#x76F8;&#x5E94;&#x7684;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x4E5F;&#x5FC5;&#x987B;&#x652F;&#x6301;&#x5927;&#x6587;&#x4EF6;&#x64CD;&#x4F5C;&#x3002;&#x5927;&#x591A;&#x6570;&#x201C;&#x539F;&#x751F;&#x201D;Linux&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x63D0;&#x4F9B;&#x4E86;LFS&#x652F;&#x6301;&#xFF0C;&#x4F46;&#x4E00;&#x4E9B;&#x201C;&#x975E;&#x539F;&#x751F;&#x201D;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x5219;&#x672A;&#x63D0;&#x4F9B;&#x8BE5;&#x529F;&#x80FD;&#xFF08;&#x5FAE;&#x8F6F;&#x7684; VFAT &#x548C;NFSv2&#x7CFB;&#x7EDF;&#x662F;&#x5176;&#x4E2D;&#x8F83;&#x4E3A;&#x77E5;&#x540D;&#x7684;&#x8303;&#x4F8B;&#xFF0C;&#x65E0;&#x8BBA;&#x7CFB;&#x7EDF;&#x662F;&#x5426;&#x542F;&#x7528;&#x4E86;LFS&#x6269;&#x5C55;&#x529F;&#x80FD;&#xFF0C;2GB&#x7684;&#x6587;&#x4EF6;&#x5927;&#x5C0F;&#x9650;&#x5236;&#x90FD;&#x662F;&#x786C;&#x6760;&#x6760;&#xFF09;&#x3002;</p>
<p>&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x53EF;&#x4F7F;&#x7528;&#x5982;&#x4E0B;&#x4E24;&#x79CD;&#x65B9;&#x5F0F;&#x4E4B;&#x4E00;&#x4EE5;&#x83B7;&#x5F97;LFS&#x529F;&#x80FD;&#x3002;<br>1.&#x4F7F;&#x7528;&#x652F;&#x6301;&#x5927;&#x6587;&#x4EF6;&#x64CD;&#x4F5C;&#x7684;&#x5907;&#x9009;API&#x3002;&#x8BE5;API&#x7531;LFS&#x8BBE;&#x8BA1;&#xFF0C;&#x610F;&#x5728;&#x4F5C;&#x4E3A;SUS&#x89C4;&#x8303;&#x7684;&#x201C;&#x8FC7;&#x6E21;&#x578B;&#x6269;&#x5C55;&#x201D;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x5C3D;&#x7BA1;&#x5927;&#x90E8;&#x5206;&#x7CFB;&#x7EDF;&#x90FD;&#x652F;&#x6301;&#x8FD9;&#x4E00;API&#xFF0C;&#x4F46;&#x8FD9;&#x5BF9;&#x4E8E;&#x7B26;&#x5408;SUSv2&#x6216;SUSv3&#x89C4;&#x8303;&#x7684;&#x7CFB;&#x7EDF;&#x5176;&#x5B9E;&#x5E76;&#x975E;&#x5FC5;&#x987B;&#x3002;&#x8FD9;&#x4E00;&#x65B9;&#x6CD5;&#x73B0;&#x5DF2;&#x8FC7;&#x65F6;&#x3002;<br>2.&#x5728;&#x7F16;&#x8BD1;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x65F6;&#xFF0C;&#x5C06;&#x5B8F;_FILE_OFFSET_BITS&#x7684;&#x503C;&#x5B9A;&#x4E49;&#x4E3A;64&#x3002;&#x8FD9;&#x4E00;&#x65B9;&#x6CD5;&#x66F4;&#x4E3A;&#x53EF;&#x53D6;&#xFF0C;&#x56E0;&#x4E3A;&#x7B26;&#x5408;SUS&#x89C4;&#x8303;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x65E0;&#x9700;&#x4FEE;&#x6539;&#x4EFB;&#x4F55;&#x6E90;&#x7801;&#x5373;&#x53EF;&#x83B7;&#x5F97;LFS&#x529F;&#x80FD;&#x3002;</p>
<p>&#x5C06;&#x5B8F;_FILE_OFFSET_BITS&#x7684;&#x503C;&#x5B9A;&#x4E49;&#x4E3A;64&#x3002;&#x505A;&#x6CD5;&#x4E4B;&#x4E00;&#x662F;&#x5229;&#x7528;C&#x8BED;&#x8A00;&#x7F16;&#x8BD1;&#x5668;&#x7684;&#x547D;&#x4EE4;&#x884C;&#x9009;&#x9879;&#xFF1A;</p>
<pre class="line-numbers language-bash"><code class="language-bash">cc -D_FILE_OFFSET_BIT<span class="token operator">=</span>64 pro.c<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>&#x53E6;&#x5916;&#x4E00;&#x79CD;&#x65B9;&#x6CD5;&#xFF0C;&#x662F;&#x5728;C&#x8BED;&#x8A00;&#x7684;&#x6E90;&#x6587;&#x4EF6;&#x4E2D;&#xFF0C;&#x5728;&#x5305;&#x542B;&#x6240;&#x6709;&#x5934;&#x6587;&#x4EF6;&#x4E4B;&#x524D;&#x6DFB;&#x52A0;&#x5982;&#x4E0B;&#x5B8F;&#x5B9A;&#x4E49;&#xFF1A;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">define</span> _FILE_OFFSET_BIT 64</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="&#x521B;&#x5EFA;&#x4E34;&#x65F6;&#x6587;&#x4EF6;"><a href="#&#x521B;&#x5EFA;&#x4E34;&#x65F6;&#x6587;&#x4EF6;" class="headerlink" title="&#x521B;&#x5EFA;&#x4E34;&#x65F6;&#x6587;&#x4EF6;"></a>&#x521B;&#x5EFA;&#x4E34;&#x65F6;&#x6587;&#x4EF6;</h2><p>&#x6709;&#x4E9B;&#x7A0B;&#x5E8F;&#x9700;&#x8981;&#x521B;&#x5EFA;&#x4E00;&#x4E9B;&#x4E34;&#x65F6;&#x6587;&#x4EF6;&#xFF0C;&#x4EC5;&#x4F9B;&#x5176;&#x5728;&#x8FD0;&#x884C;&#x671F;&#x95F4;&#x4F7F;&#x7528;&#xFF0C;&#x7A0B;&#x5E8F;&#x7EC8;&#x6B62;&#x540E;&#x5373;&#x884C;&#x5220;&#x9664;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x5F88;&#x591A;&#x7F16;&#x8BD1;&#x5668;&#x7A0B;&#x5E8F;&#x4F1A;&#x5728;&#x7F16;&#x8BD1;&#x8FC7;&#x7A0B;&#x4E2D;&#x521B;&#x5EFA;&#x4E34;&#x65F6;&#x6587;&#x4EF6;&#x3002;GNU C&#x8BED;&#x8A00;&#x51FD;&#x6570;&#x5E93;&#x4E3A;&#x6B64;&#x800C;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x7CFB;&#x5217;&#x5E93;&#x51FD;&#x6570;&#x3002;&#xFF08;&#x4E4B;&#x6240;&#x4EE5;&#x6709;&#x201C;&#x4E00;&#x7CFB;&#x5217;&#x201D;&#x7684;&#x5E93;&#x51FD;&#x6570;&#xFF0C;&#x90E8;&#x5206;&#x539F;&#x56E0;&#x662F;&#x7531;&#x4E8E;&#x8FD9;&#x4E9B;&#x51FD;&#x6570;&#x5206;&#x522B;&#x7EE7;&#x627F;&#x81EA;&#x5404;&#x79CD;UNIX&#x5B9E;&#x73B0;&#x3002;&#xFF09;&#x672C;&#x8282;&#x5C06;&#x4ECB;&#x7ECD;&#x5176;&#x4E2D;&#x7684;&#x4E24;&#x4E2A;&#x51FD;&#x6570;&#xFF1A;mkstemp()&#x548C;tmpfile()&#x3002;<br>&#x57FA;&#x4E8E;&#x8C03;&#x7528;&#x8005;&#x63D0;&#x4F9B;&#x7684;&#x6A21;&#x677F;&#xFF0C;mkstemp()&#x51FD;&#x6570;&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x552F;&#x4E00;&#x6587;&#x4EF6;&#x540D;&#x5E76;&#x6253;&#x5F00;&#x8BE5;&#x6587;&#x4EF6;&#xFF0C;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x53EF;&#x7528;&#x4E8E;I/O&#x8C03;&#x7528;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdlib.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">mkstemp</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>template<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x6210;&#x529F;&#x8FD4;&#x56DE;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#xFF0C;&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x6A21;&#x677F;&#x53C2;&#x6570;&#x91C7;&#x7528;&#x8DEF;&#x5F84;&#x540D;&#x5F62;&#x5F0F;&#xFF0C;&#x5176;&#x4E2D;&#x6700;&#x540E;6&#x4E2A;&#x5B57;&#x7B26;&#x5FC5;&#x987B;&#x4E3A;XXXXXX&#x3002;&#x8FD9;6&#x4E2A;&#x5B57;&#x7B26;&#x5C06;&#x88AB;&#x66FF;&#x6362;&#xFF0C;&#x4EE5;&#x4FDD;&#x8BC1;&#x6587;&#x4EF6;&#x540D;&#x7684;&#x552F;&#x4E00;&#x6027;&#xFF0C;&#x4E14;&#x4FEE;&#x6539;&#x540E;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x5C06;&#x901A;&#x8FC7;template&#x53C2;&#x6570;&#x4F20;&#x56DE;&#x3002;&#x56E0;&#x4E3A;&#x4F1A;&#x5BF9;&#x4F20;&#x5165;&#x7684;template&#x53C2;&#x6570;&#x8FDB;&#x884C;&#x4FEE;&#x6539;&#xFF0C;&#x6240;&#x4EE5;&#x5FC5;&#x987B;&#x5C06;&#x5176;&#x6307;&#x5B9A;&#x4E3A;&#x5B57;&#x7B26;&#x6570;&#x7EC4;&#xFF0C;&#x800C;&#x975E;&#x5B57;&#x7B26;&#x4E32;&#x5E38;&#x91CF;&#x3002;<br>&#x6587;&#x4EF6;&#x62E5;&#x6709;&#x8005;&#x5BF9;mkstemp()&#x51FD;&#x6570;&#x5EFA;&#x7ACB;&#x7684;&#x6587;&#x4EF6;&#x62E5;&#x6709;&#x8BFB;&#x5199;&#x6743;&#x9650;&#xFF08;&#x5176;&#x4ED6;&#x7528;&#x6237;&#x5219;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x64CD;&#x4F5C;&#x6743;&#x9650;&#xFF09;&#xFF0C;&#x4E14;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x65F6;&#x4F7F;&#x7528;&#x4E86;O_EXCL&#x6807;&#x5FD7;&#xFF0C;&#x4EE5;&#x4FDD;&#x8BC1;&#x8C03;&#x7528;&#x8005;&#x4EE5;&#x72EC;&#x5360;&#x65B9;&#x5F0F;&#x8BBF;&#x95EE;&#x6587;&#x4EF6;&#x3002;<br>&#x901A;&#x5E38;&#xFF0C;&#x6253;&#x5F00;&#x4E34;&#x65F6;&#x6587;&#x4EF6;&#x4E0D;&#x4E45;&#xFF0C;&#x7A0B;&#x5E8F;&#x5C31;&#x4F1A;&#x4F7F;&#x7528;unlink&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5C06;&#x5176;&#x5220;&#x9664;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">int</span> fd<span class="token punctuation">;</span>
<span class="token keyword">char</span> template<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;/tmp/somestringXXXXXX&quot;</span><span class="token punctuation">;</span>

fd<span class="token operator">=</span><span class="token function">mkstemp</span><span class="token punctuation">(</span>template<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>fd <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;mkstemp&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Generated filrname was:%s\n&quot;</span><span class="token punctuation">,</span>template<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">unlink</span><span class="token punctuation">(</span>template<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">close</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span><span class="token operator">==</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;close&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>tmpfile()&#x51FD;&#x6570;&#x4F1A;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x540D;&#x79F0;&#x552F;&#x4E00;&#x7684;&#x4E34;&#x65F6;&#x6587;&#x4EF6;&#xFF0C;&#x5E76;&#x4EE5;&#x8BFB;&#x5199;&#x65B9;&#x5F0F;&#x5C06;&#x5176;&#x6253;&#x5F00;&#x3002;&#xFF08;&#x6253;&#x5F00;&#x8BE5;&#x6587;&#x4EF6;&#x65F6;&#x4F7F;&#x7528;&#x4E86;O_EXCL&#x6807;&#x5FD7;&#xFF0C;&#x4EE5;&#x9632;&#x4E00;&#x4E2A;&#x53EF;&#x80FD;&#x6027;&#x6781;&#x5C0F;&#x7684;&#x51B2;&#x7A81;&#xFF0C;&#x5373;&#x53E6;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x5DF2;&#x7ECF;&#x521B;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A;&#x540C;&#x540D;&#x6587;&#x4EF6;&#x3002;&#xFF09;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
FILE <span class="token operator">*</span><span class="token function">tmpfile</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x6210;&#x529F;&#x8FD4;&#x56DE;&#x6587;&#x4EF6;&#x6307;&#x9488;&#xFF0C;&#x5931;&#x8D25;&#x8FD4;&#x56DE;NULL</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>tmpfile()&#x51FD;&#x6570;&#x6267;&#x884C;&#x6210;&#x529F;&#xFF0C;&#x5C06;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x6D41;&#x4F9B;stdio&#x5E93;&#x51FD;&#x6570;&#x4F7F;&#x7528;&#x3002;&#x6587;&#x4EF6;&#x6D41;&#x5173;&#x95ED;&#x540E;&#x5C06;&#x81EA;&#x52A8;&#x5220;&#x9664;&#x4E34;&#x65F6;&#x6587;&#x4EF6;&#x3002;&#x4E3A;&#x8FBE;&#x5230;&#x8FD9;&#x4E00;&#x76EE;&#x7684;&#xFF0C;tmpfile()&#x51FD;&#x6570;&#x4F1A;&#x5728;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x540E;&#xFF0C;&#x4ECE;&#x5185;&#x90E8;&#x7ACB;&#x5373;&#x8C03;&#x7528;unlink()&#x6765;&#x5220;&#x9664;&#x8BE5;&#x6587;&#x4EF6;&#x540D;.</p>
<h2 id="&#x6587;&#x4EF6;I-O&#x7F13;&#x51B2;"><a href="#&#x6587;&#x4EF6;I-O&#x7F13;&#x51B2;" class="headerlink" title="&#x6587;&#x4EF6;I/O&#x7F13;&#x51B2;"></a>&#x6587;&#x4EF6;I/O&#x7F13;&#x51B2;</h2><p>&#x51FA;&#x4E8E;&#x901F;&#x5EA6;&#x548C;&#x6548;&#x7387;&#x8003;&#x8651;&#xFF0C;&#x7CFB;&#x7EDF;I/O&#x8C03;&#x7528;&#xFF08;&#x5373;&#x5185;&#x6838;&#xFF09;&#x548C;&#x6807;&#x51C6;C&#x8BED;&#x8A00;&#x5E93;I/O&#x51FD;&#x6570;&#xFF08;&#x5373;stdio&#x51FD;&#x6570;&#xFF09;&#x5728;&#x64CD;&#x4F5C;&#x78C1;&#x76D8;&#x6587;&#x4EF6;&#x65F6;&#x4F1A;&#x5BF9;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x7F13;&#x51B2;&#x3002;</p>
<h3 id="&#x6587;&#x4EF6;I-O&#x7684;&#x5185;&#x6838;&#x7F13;&#x51B2;&#xFF1A;&#x7F13;&#x51B2;&#x533A;&#x9AD8;&#x901F;&#x7F13;&#x5B58;"><a href="#&#x6587;&#x4EF6;I-O&#x7684;&#x5185;&#x6838;&#x7F13;&#x51B2;&#xFF1A;&#x7F13;&#x51B2;&#x533A;&#x9AD8;&#x901F;&#x7F13;&#x5B58;" class="headerlink" title="&#x6587;&#x4EF6;I/O&#x7684;&#x5185;&#x6838;&#x7F13;&#x51B2;&#xFF1A;&#x7F13;&#x51B2;&#x533A;&#x9AD8;&#x901F;&#x7F13;&#x5B58;"></a>&#x6587;&#x4EF6;I/O&#x7684;&#x5185;&#x6838;&#x7F13;&#x51B2;&#xFF1A;&#x7F13;&#x51B2;&#x533A;&#x9AD8;&#x901F;&#x7F13;&#x5B58;</h3><p>read()&#x548C;write()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5728;&#x64CD;&#x4F5C;&#x78C1;&#x76D8;&#x6587;&#x4EF6;&#x65F6;&#x4E0D;&#x4F1A;&#x76F4;&#x63A5;&#x53D1;&#x8D77;&#x78C1;&#x76D8;&#x8BBF;&#x95EE;&#xFF0C;&#x800C;&#x662F;&#x4EC5;&#x4EC5;&#x5728;&#x7528;&#x6237;&#x7A7A;&#x95F4;&#x7F13;&#x51B2;&#x533A;&#x4E0E;&#x5185;&#x6838;&#x7F13;&#x51B2;&#x533A;&#x9AD8;&#x901F;&#x7F13;&#x5B58;&#xFF08;kernel buffer cache&#xFF09;&#x4E4B;&#x95F4;&#x590D;&#x5236;&#x6570;&#x636E;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x5982;&#x4E0B;&#x8C03;&#x7528;&#x5C06;3&#x4E2A;&#x5B57;&#x8282;&#x7684;&#x6570;&#x636E;&#x4ECE;&#x7528;&#x6237;&#x7A7A;&#x95F4;&#x5185;&#x5B58;&#x4F20;&#x9012;&#x5230;&#x5185;&#x6838;&#x7A7A;&#x95F4;&#x7684;&#x7F13;&#x51B2;&#x533A;&#x4E2D;&#xFF1A;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token function">write</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span><span class="token string">&quot;abc&quot;</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>write()&#x968F;&#x5373;&#x8FD4;&#x56DE;&#x3002;&#x5728;&#x540E;&#x7EED;&#x67D0;&#x4E2A;&#x65F6;&#x523B;&#xFF0C;&#x5185;&#x6838;&#x4F1A;&#x5C06;&#x5176;&#x7F13;&#x51B2;&#x533A;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x5199;&#x5165;&#xFF08;&#x5237;&#x65B0;&#x81F3;&#xFF09;&#x78C1;&#x76D8;&#x3002;&#xFF08;&#x56E0;&#x6B64;&#xFF0C;&#x53EF;&#x4EE5;&#x8BF4;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x4E0E;&#x78C1;&#x76D8;&#x64CD;&#x4F5C;&#x5E76;&#x4E0D;&#x540C;&#x6B65;&#x3002;&#xFF09;&#x5982;&#x679C;&#x5728;&#x6B64;&#x671F;&#x95F4;&#xFF0C;&#x53E6;&#x4E00;&#x8FDB;&#x7A0B;&#x8BD5;&#x56FE;&#x8BFB;&#x53D6;&#x8BE5;&#x6587;&#x4EF6;&#x7684;&#x8FD9;&#x51E0;&#x4E2A;&#x5B57;&#x8282;&#xFF0C;&#x90A3;&#x4E48;&#x5185;&#x6838;&#x5C06;&#x81EA;&#x52A8;&#x4ECE;&#x7F13;&#x51B2;&#x533A;&#x9AD8;&#x901F;&#x7F13;&#x5B58;&#x4E2D;&#x63D0;&#x4F9B;&#x8FD9;&#x4E9B;&#x6570;&#x636E;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x4ECE;&#x6587;&#x4EF6;&#x4E2D;&#xFF08;&#x8BFB;&#x53D6;&#x8FC7;&#x671F;&#x7684;&#x5185;&#x5BB9;&#xFF09;&#x3002;<br>&#x4E0E;&#x6B64;&#x540C;&#x7406;&#xFF0C;&#x5BF9;&#x8F93;&#x5165;&#x800C;&#x8A00;&#xFF0C;&#x5185;&#x6838;&#x4ECE;&#x78C1;&#x76D8;&#x4E2D;&#x8BFB;&#x53D6;&#x6570;&#x636E;&#x5E76;&#x5B58;&#x50A8;&#x5230;&#x5185;&#x6838;&#x7F13;&#x51B2;&#x533A;&#x4E2D;&#x3002;read()&#x8C03;&#x7528;&#x5C06;&#x4ECE;&#x8BE5;&#x7F13;&#x51B2;&#x533A;&#x4E2D;&#x8BFB;&#x53D6;&#x6570;&#x636E;&#xFF0C;&#x76F4;&#x81F3;&#x628A;&#x7F13;&#x51B2;&#x533A;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x53D6;&#x5B8C;&#xFF0C;&#x8FD9;&#x65F6;&#xFF0C;&#x5185;&#x6838;&#x4F1A;&#x5C06;&#x6587;&#x4EF6;&#x7684;&#x4E0B;&#x4E00;&#x6BB5;&#x5185;&#x5BB9;&#x8BFB;&#x5165;&#x7F13;&#x51B2;&#x533A;&#x9AD8;&#x901F;&#x7F13;&#x5B58;&#x3002;<br>&#x91C7;&#x7528;&#x8FD9;&#x4E00;&#x8BBE;&#x8BA1;&#xFF0C;&#x610F;&#x5728;&#x4F7F;read()&#x548C;write()&#x8C03;&#x7528;&#x7684;&#x64CD;&#x4F5C;&#x66F4;&#x4E3A;&#x5FEB;&#x901F;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x4EEC;&#x4E0D;&#x9700;&#x8981;&#x7B49;&#x5F85;&#xFF08;&#x7F13;&#x6162;&#x7684;&#xFF09;&#x78C1;&#x76D8;&#x64CD;&#x4F5C;&#x3002;&#x540C;&#x65F6;&#xFF0C;&#x8FD9;&#x4E00;&#x8BBE;&#x8BA1;&#x4E5F;&#x6781;&#x4E3A;&#x9AD8;&#x6548;&#xFF0C;&#x56E0;&#x4E3A;&#x8FD9;&#x51CF;&#x5C11;&#x4E86;&#x5185;&#x6838;&#x5FC5;&#x987B;&#x6267;&#x884C;&#x7684;&#x78C1;&#x76D8;&#x4F20;&#x8F93;&#x6B21;&#x6570;&#x3002;<br>Linux&#x5185;&#x6838;&#x5BF9;&#x7F13;&#x51B2;&#x533A;&#x9AD8;&#x901F;&#x7F13;&#x5B58;&#x7684;&#x5927;&#x5C0F;&#x6CA1;&#x6709;&#x56FA;&#x5B9A;&#x4E0A;&#x9650;&#x3002;&#x5185;&#x6838;&#x4F1A;&#x5206;&#x914D;&#x5C3D;&#x53EF;&#x80FD;&#x591A;&#x7684;&#x7F13;&#x51B2;&#x533A;&#x9AD8;&#x901F;&#x7F13;&#x5B58;&#x9875;&#xFF0C;&#x800C;&#x4EC5;&#x53D7;&#x9650;&#x4E8E;&#x4E24;&#x4E2A;&#x56E0;&#x7D20;&#xFF1A;&#x53EF;&#x7528;&#x7684;&#x7269;&#x7406;&#x5185;&#x5B58;&#x603B;&#x91CF;&#xFF0C;&#x4EE5;&#x53CA;&#x51FA;&#x4E8E;&#x5176;&#x4ED6;&#x76EE;&#x7684;&#x5BF9;&#x7269;&#x7406;&#x5185;&#x5B58;&#x7684;&#x9700;&#x6C42;&#xFF08;&#x4F8B;&#x5982;&#xFF0C;&#x9700;&#x8981;&#x5C06;&#x6B63;&#x5728;&#x8FD0;&#x884C;&#x8FDB;&#x7A0B;&#x7684;&#x6587;&#x672C;&#x548C;&#x6570;&#x636E;&#x9875;&#x4FDD;&#x7559;&#x5728;&#x7269;&#x7406;&#x5185;&#x5B58;&#x4E2D;&#xFF09;&#x3002;&#x82E5;&#x53EF;&#x7528;&#x5185;&#x5B58;&#x4E0D;&#x8DB3;&#xFF0C;&#x5219;&#x5185;&#x6838;&#x4F1A;&#x5C06;&#x4E00;&#x4E9B;&#x4FEE;&#x6539;&#x8FC7;&#x7684;&#x7F13;&#x51B2;&#x533A;&#x9AD8;&#x901F;&#x7F13;&#x5B58;&#x9875;&#x5185;&#x5BB9;&#x5237;&#x65B0;&#x5230;&#x78C1;&#x76D8;&#xFF0C;&#x5E76;&#x91CA;&#x653E;&#x5176;&#x4F9B;&#x7CFB;&#x7EDF;&#x91CD;&#x7528;&#x3002;<br>&#x66F4;&#x786E;&#x5207;&#x5730;&#x8BF4;&#xFF0C;&#x4ECE;&#x5185;&#x6838;2.4&#x5F00;&#x59CB;&#xFF0C;Linux &#x4E0D;&#x518D;&#x7EF4;&#x62A4;&#x4E00;&#x4E2A;&#x5355;&#x72EC;&#x7684;&#x7F13;&#x51B2;&#x533A;&#x9AD8;&#x901F;&#x7F13;&#x5B58;&#x3002;&#x76F8;&#x53CD;&#xFF0C;&#x4F1A;&#x5C06;&#x6587;&#x4EF6;I/O&#x7F13;&#x51B2;&#x533A;&#x7F6E;&#x4E8E;&#x9875;&#x9762;&#x9AD8;&#x901F;&#x7F13;&#x5B58;&#x4E2D;&#xFF0C;&#x5176;&#x4E2D;&#x8FD8;&#x542B;&#x6709;&#x8BF8;&#x5982;&#x5185;&#x5B58;&#x6620;&#x5C04;&#x6587;&#x4EF6;&#x7684;&#x9875;&#x9762;&#x3002;&#x7136;&#x800C;&#xFF0C;&#x6B63;&#x6587;&#x7684;&#x8BA8;&#x8BBA;&#x91C7;&#x7528;&#x4E86;&#x201C;&#x7F13;&#x51B2;&#x533A;&#x9AD8;&#x901F;&#x7F13;&#x5B58;&#xFF08;buffer cache&#xFF09;&#x201D;&#x8FD9;&#x4E00;&#x672F;&#x8BED;&#xFF0C;&#x56E0;&#x4E3A;&#x8FD9;&#x662F;UNIX &#x5B9E;&#x73B0;&#x4E2D;&#x5386;&#x53F2;&#x60A0;&#x4E45;&#x7684;&#x901A;&#x79F0;&#x3002;<br>&#x65E0;&#x8BBA;&#x662F;&#x8BA9;&#x78C1;&#x76D8;&#x5199;1000&#x6B21;&#xFF0C;&#x6BCF;&#x6B21;&#x5199;&#x5165;&#x4E00;&#x4E2A;&#x5B57;&#x8282;&#xFF0C;&#x8FD8;&#x662F;&#x4E00;&#x6B21;&#x5199;&#x5165;1000&#x4E2A;&#x5B57;&#x8282;&#xFF0C;&#x5185;&#x6838;&#x8BBF;&#x95EE;&#x78C1;&#x76D8;&#x7684;&#x5B57;&#x8282;&#x6570;&#x90FD;&#x662F;&#x76F8;&#x540C;&#x7684;&#x3002;&#x7136;&#x800C;&#xFF0C;&#x6211;&#x4EEC;&#x66F4;&#x5C5E;&#x610F;&#x4E8E;&#x540E;&#x8005;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x53EA;&#x9700;&#x8981;&#x4E00;&#x6B21;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF0C;&#x800C;&#x524D;&#x8005;&#x5219;&#x9700;&#x8981;&#x8C03;&#x7528;1000&#x6B21;&#x3002;&#x5C3D;&#x7BA1;&#x6BD4;&#x78C1;&#x76D8;&#x64CD;&#x4F5C;&#x8981;&#x5FEB;&#x8BB8;&#x591A;&#xFF0C;&#x4F46;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x6240;&#x8017;&#x8D39;&#x7684;&#x65F6;&#x95F4;&#x603B;&#x91CF;&#x4E5F;&#x76F8;&#x5F53;&#x53EF;&#x89C2;&#xFF1A;&#x5185;&#x6838;&#x5FC5;&#x987B;&#x6355;&#x83B7;&#x8C03;&#x7528;&#xFF0C;&#x68C0;&#x67E5;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x53C2;&#x6570;&#x7684;&#x6709;&#x6548;&#x6027;&#xFF0C;&#x5728;&#x7528;&#x6237;&#x7A7A;&#x95F4;&#x548C;&#x5185;&#x6838;&#x7A7A;&#x95F4;&#x4E4B;&#x95F4;&#x4F20;&#x8F93;&#x6570;&#x636E;.</p>
<p>&#x6240;&#x8C13;&#x666E;&#x901A;&#x5185;&#x6838;&#xFF08;vanilla kernel&#xFF09;&#xFF0C;&#x610F;&#x6307;&#x672A;&#x6253;&#x8865;&#x4E01;&#x7684;&#x4E3B;&#x7EBF;&#xFF08;mainline&#xFF09;&#x5185;&#x6838;&#x3002;&#x4E0E;&#x4E4B;&#x5F62;&#x6210;&#x9C9C;&#x660E;&#x5BF9;&#x6BD4;&#x7684;&#x662F;&#x5927;&#x591A;&#x6570;&#x53D1;&#x884C;&#x5546;&#x6240;&#x63D0;&#x4F9B;&#x7684;&#x5185;&#x6838;&#xFF0C;&#x5E38;&#x5305;&#x542B;&#x5404;&#x79CD;&#x8865;&#x4E01;&#x6765;&#x4FEE;&#x590D;&#x9519;&#x8BEF;&#x548C;&#x6DFB;&#x52A0;&#x65B0;&#x529F;&#x80FD;&#x3002;</p>
<div class="amp-img-wrapper"><amp-img src="https://pagepig.oss-cn-hangzhou.aliyuncs.com/20200208105123.png?x-oss-process=image/resize,m_lfit,h_450" width="392" height="450" layout="responsive"></amp-img></div><br>&#x56E0;&#x4E3A;&#x91C7;&#x7528;&#x4E0D;&#x540C;&#x7684;&#x7F13;&#x51B2;&#x533A;&#x5927;&#x5C0F;&#x65F6;&#xFF0C;&#x6570;&#x636E;&#x7684;&#x4F20;&#x8F93;&#x603B;&#x91CF;&#xFF08;&#x56E0;&#x6B64;&#x62DB;&#x81F4;&#x78C1;&#x76D8;&#x64CD;&#x4F5C;&#x7684;&#x6570;&#x91CF;&#xFF09;&#x662F;&#x76F8;&#x540C;&#x7684;&#xFF0C;&#x8868;13-1&#x6240;&#x793A;&#x4E3A;&#x53D1;&#x8D77;read()&#x548C;write()&#x8C03;&#x7528;&#x7684;&#x5F00;&#x9500;&#x3002;&#x7F13;&#x51B2;&#x533A;&#x5927;&#x5C0F;&#x4E3A;1&#x5B57;&#x8282;&#x65F6;&#xFF0C;&#x9700;&#x8981;&#x8C03;&#x7528;read()&#x548C;write()1&#x4EBF;&#x6B21;&#xFF0C;&#x7F13;&#x51B2;&#x533A;&#x5927;&#x5C0F;&#x4E3A;4096&#x4E2A;&#x5B57;&#x8282;&#x65F6;&#xFF0C;&#x9700;&#x8981;&#x8C03;&#x7528;read()&#x548C;write() 24000&#x6B21;&#x5DE6;&#x53F3;&#xFF0C;&#x51E0;&#x4E4E;&#x8FBE;&#x5230;&#x6700;&#x4F18;&#x6027;&#x80FD;&#x3002;&#x8BBE;&#x7F6E;&#x518D;&#x8D85;&#x8FC7;&#x8FD9;&#x4E2A;&#x503C;&#xFF0C;&#x5BF9;&#x6027;&#x80FD;&#x7684;&#x63D0;&#x5347;&#x5C31;&#x4E0D;&#x663E;&#x8457;&#x4E86;&#xFF0C;&#x8FD9;&#x662F;&#x56E0;&#x4E3A;&#x4E0E;&#x5728;&#x7528;&#x6237;&#x7A7A;&#x95F4;&#x548C;&#x5185;&#x6838;&#x7A7A;&#x95F4;&#x4E4B;&#x95F4;&#x590D;&#x5236;&#x6570;&#x636E;&#x4EE5;&#x53CA;&#x6267;&#x884C;&#x5B9E;&#x9645;&#x78C1;&#x76D8;I/O &#x6240;&#x82B1;&#x8D39;&#x7684;&#x65F6;&#x95F4;&#x76F8;&#x6BD4;&#xFF0C;read()&#x548C;write() &#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x7684;&#x6210;&#x672C;&#x5C31;&#x663E;&#x5F97;&#x5FAE;&#x4E0D;&#x8DB3;&#x9053;&#x4E86;&#x3002;
<p>&#x603B;&#x4E4B;&#xFF0C;&#x5982;&#x679C;&#x4E0E;&#x6587;&#x4EF6;&#x53D1;&#x751F;&#x5927;&#x91CF;&#x7684;&#x6570;&#x636E;&#x4F20;&#x8F93;&#xFF0C;&#x901A;&#x8FC7;&#x91C7;&#x7528;&#x5927;&#x5757;&#x7A7A;&#x95F4;&#x7F13;&#x51B2;&#x6570;&#x636E;&#xFF0C;&#x4EE5;&#x53CA;&#x6267;&#x884C;&#x66F4;&#x5C11;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF0C;&#x53EF;&#x4EE5;&#x6781;&#x5927;&#x5730;&#x63D0;&#x9AD8;I / O &#x6027;&#x80FD;&#x3002;</p>
<h3 id="stdio&#x5E93;&#x7684;&#x7F13;&#x51B2;"><a href="#stdio&#x5E93;&#x7684;&#x7F13;&#x51B2;" class="headerlink" title="stdio&#x5E93;&#x7684;&#x7F13;&#x51B2;"></a>stdio&#x5E93;&#x7684;&#x7F13;&#x51B2;</h3><p>&#x5F53;&#x64CD;&#x4F5C;&#x78C1;&#x76D8;&#x6587;&#x4EF6;&#x65F6;&#xFF0C;&#x7F13;&#x51B2;&#x5927;&#x5757;&#x6570;&#x636E;&#x4EE5;&#x51CF;&#x5C11;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF0C;C&#x8BED;&#x8A00;&#x51FD;&#x6570;&#x5E93;&#x7684;I/O&#x51FD;&#x6570;&#xFF08;&#x6BD4;&#x5982;&#xFF0C;fprintf()&#x3001;fscanf()&#x3001;fgets()&#x3001;fputs()&#x3001;fputc()&#x3001;fgetc()&#xFF09;&#x6B63;&#x662F;&#x8FD9;&#x4E48;&#x505A;&#x7684;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x4F7F;&#x7528;stdio&#x5E93;&#x53EF;&#x4EE5;&#x4F7F;&#x7F16;&#x7A0B;&#x8005;&#x514D;&#x4E8E;&#x81EA;&#x884C;&#x5904;&#x7406;&#x5BF9;&#x6570;&#x636E;&#x7684;&#x7F13;&#x51B2;&#xFF0C;&#x65E0;&#x8BBA;&#x662F;&#x8C03;&#x7528; write()&#x6765;&#x8F93;&#x51FA;&#xFF0C;&#x8FD8;&#x662F;&#x8C03;&#x7528; read()&#x6765;&#x8F93;&#x5165;&#x3002;</p>
<p>&#x8C03;&#x7528;setvbuf()&#x51FD;&#x6570;&#xFF0C;&#x53EF;&#x4EE5;&#x63A7;&#x5236;stdio&#x5E93;&#x4F7F;&#x7528;&#x7F13;&#x51B2;&#x7684;&#x5F62;&#x5F0F;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">setvbuf</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>stream<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>buffer<span class="token punctuation">,</span> <span class="token keyword">int</span> mode<span class="token punctuation">,</span> size_t size<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x6570;stream&#x6807;&#x8BC6;&#x5C06;&#x8981;&#x4FEE;&#x6539;&#x54EA;&#x4E2A;&#x6587;&#x4EF6;&#x6D41;&#x7684;&#x7F13;&#x51B2;&#x3002;&#x6253;&#x5F00;&#x6D41;&#x540E;&#xFF0C;&#x5FC5;&#x987B;&#x5728;&#x8C03;&#x7528;&#x4EFB;&#x4F55;&#x5176;&#x4ED6;stdio&#x51FD;&#x6570;&#x4E4B;&#x524D;&#x5148;&#x8C03;&#x7528;setvbuf()&#x3002;setvbuf()&#x8C03;&#x7528;&#x5C06;&#x5F71;&#x54CD;&#x540E;&#x7EED;&#x5728;&#x6307;&#x5B9A;&#x6D41;&#x4E0A;&#x8FDB;&#x884C;&#x7684;&#x6240;&#x6709;stdio&#x64CD;&#x4F5C;&#x3002;<br>&#x53C2;&#x6570;buf&#x548C;size&#x5219;&#x9488;&#x5BF9;&#x53C2;&#x6570;stream&#x8981;&#x4F7F;&#x7528;&#x7684;&#x7F13;&#x51B2;&#x533A;.<br>&#x53C2;&#x6570;mode&#x6307;&#x5B9A;&#x4E86;&#x7F13;&#x51B2;&#x7C7B;&#x578B;&#xFF0C;&#x5E76;&#x5177;&#x6709;&#x4E0B;&#x5217;&#x503C;&#x4E4B;&#x4E00;&#x3002;<br><code>_IONBF</code><br>&#x4E0D;&#x5BF9;I/O&#x8FDB;&#x884C;&#x7F13;&#x51B2;&#x3002;&#x6BCF;&#x4E2A;stdio&#x5E93;&#x51FD;&#x6570;&#x5C06;&#x7ACB;&#x5373;&#x8C03;&#x7528;write()&#x6216;&#x8005;read()&#xFF0C;&#x5E76;&#x4E14;&#x5FFD;&#x7565;buf&#x548C;size&#x53C2;&#x6570;&#xFF0C;&#x53EF;&#x4EE5;&#x5206;&#x522B;&#x6307;&#x5B9A;&#x4E24;&#x4E2A;&#x53C2;&#x6570;&#x4E3A;NULL&#x548C;0&#x3002;stderr&#x9ED8;&#x8BA4;&#x5C5E;&#x4E8E;&#x8FD9;&#x4E00;&#x7C7B;&#x578B;&#xFF0C;&#x4ECE;&#x800C;&#x4FDD;&#x8BC1;&#x9519;&#x8BEF;&#x80FD;&#x7ACB;&#x5373;&#x8F93;&#x51FA;&#x3002;<br><code>_IOLBF</code><br>&#x91C7;&#x7528;&#x884C;&#x7F13;&#x51B2;I/O&#x3002;&#x6307;&#x4EE3;&#x7EC8;&#x7AEF;&#x8BBE;&#x5907;&#x7684;&#x6D41;&#x9ED8;&#x8BA4;&#x5C5E;&#x4E8E;&#x8FD9;&#x4E00;&#x7C7B;&#x578B;&#x3002;&#x5BF9;&#x4E8E;&#x8F93;&#x51FA;&#x6D41;&#xFF0C;&#x5728;&#x8F93;&#x51FA;&#x4E00;&#x4E2A;&#x6362;&#x884C;&#x7B26;&#xFF08;&#x9664;&#x975E;&#x7F13;&#x51B2;&#x533A;&#x5DF2;&#x7ECF;&#x586B;&#x6EE1;&#xFF09;&#x524D;&#x5C06;&#x7F13;&#x51B2;&#x6570;&#x636E;&#x3002;&#x5BF9;&#x4E8E;&#x8F93;&#x5165;&#x6D41;&#xFF0C;&#x6BCF;&#x6B21;&#x8BFB;&#x53D6;&#x4E00;&#x884C;&#x6570;&#x636E;&#x3002;<br><code>_IOFBF</code><br>&#x91C7;&#x7528;&#x5168;&#x7F13;&#x51B2;I/O&#x3002;&#x5355;&#x6B21;&#x8BFB;&#x3001;&#x5199;&#x6570;&#x636E;&#xFF08;&#x901A;&#x8FC7;read()&#x6216;write()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF09;&#x7684;&#x5927;&#x5C0F;&#x4E0E;&#x7F13;&#x51B2;&#x533A;&#x76F8;&#x540C;&#x3002;&#x6307;&#x4EE3;&#x78C1;&#x76D8;&#x7684;&#x6D41;&#x9ED8;&#x8BA4;&#x91C7;&#x7528;&#x6B64;&#x6A21;&#x5F0F;&#x3002;</p>
<p><strong>&#x4F8B;&#x5B50;&#xFF1A;</strong></p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">define</span> BUF_SIZE 1024</span>
<span class="token keyword">static</span> <span class="token keyword">char</span> buf<span class="token punctuation">[</span>BUF_SIZE<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">setvbuf</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">,</span>buf<span class="token punctuation">,</span>_IOFBF<span class="token punctuation">,</span>BUF_SIZE<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x6CE8;&#x610F;&#xFF1A;setvbuf()&#x51FA;&#x9519;&#x65F6;&#x8FD4;&#x56DE;&#x975E;0&#x503C;&#xFF08;&#x800C;&#x4E0D;&#x4E00;&#x5B9A;&#x662F;&#x2212;1&#xFF09;&#x3002;</p>
<p>setbuf()&#x51FD;&#x6570;&#x6784;&#x5EFA;&#x4E8E;setvbuf()&#x4E4B;&#x4E0A;&#xFF0C;&#x6267;&#x884C;&#x4E86;&#x7C7B;&#x4F3C;&#x4EFB;&#x52A1;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token keyword">void</span> <span class="token function">setbuf</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>steam<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>setbuffer()&#x51FD;&#x6570;&#x7C7B;&#x4F3C;&#x4E8E;setbuf()&#x51FD;&#x6570;&#xFF0C;&#x4F46;&#x5141;&#x8BB8;&#x8C03;&#x7528;&#x8005;&#x6307;&#x5B9A;buf&#x7F13;&#x51B2;&#x533A;&#x5927;&#x5C0F;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token keyword">void</span> <span class="token function">setbuffer</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span> stream<span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span> buf<span class="token punctuation">,</span>size_t size<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x5BF9;setbuffer(fp,buf,size)&#x7684;&#x8C03;&#x7528;&#x76F8;&#x5F53;&#x4E8E;&#x5982;&#x4E0B;&#x8C03;&#x7528;&#xFF1A;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token function">setvbuf</span><span class="token punctuation">(</span>fp<span class="token punctuation">,</span>buf<span class="token punctuation">,</span><span class="token punctuation">(</span>buf <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token operator">?</span> _IOFBF<span class="token punctuation">:</span>_IONBF<span class="token punctuation">,</span>size<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>SUSv3&#x5E76;&#x672A;&#x5BF9;setbuffer()&#x51FD;&#x6570;&#x52A0;&#x4EE5;&#x5B9A;&#x4E49;&#xFF0C;&#x4F46;&#x5927;&#x591A;&#x6570;UNIX&#x5B9E;&#x73B0;&#x5747;&#x652F;&#x6301;&#x5B83;&#x3002;</p>
<h3 id="&#x5237;&#x65B0;stdio&#x7F13;&#x51B2;&#x533A;"><a href="#&#x5237;&#x65B0;stdio&#x7F13;&#x51B2;&#x533A;" class="headerlink" title="&#x5237;&#x65B0;stdio&#x7F13;&#x51B2;&#x533A;"></a>&#x5237;&#x65B0;stdio&#x7F13;&#x51B2;&#x533A;</h3><p>&#x65E0;&#x8BBA;&#x5F53;&#x524D;&#x91C7;&#x7528;&#x4F55;&#x79CD;&#x7F13;&#x51B2;&#x533A;&#x6A21;&#x5F0F;&#xFF0C;&#x5728;&#x4EFB;&#x4F55;&#x65F6;&#x5019;&#xFF0C;&#x90FD;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; fflush()&#x5E93;&#x51FD;&#x6570;&#x5F3A;&#x5236;&#x5C06; stdio&#x8F93;&#x51FA;&#x6D41;&#x4E2D;&#x7684;&#x6570;&#x636E;&#xFF08;&#x5373;&#x901A;&#x8FC7;write()&#xFF09;&#x5237;&#x65B0;&#x5230;&#x5185;&#x6838;&#x7F13;&#x51B2;&#x533A;&#x4E2D;&#x3002;&#x6B64;&#x51FD;&#x6570;&#x4F1A;&#x5237;&#x65B0;&#x6307;&#x5B9A;stream&#x7684;&#x8F93;&#x51FA;&#x7F13;&#x51B2;&#x533A;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token keyword">void</span> <span class="token function">fflush</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>steam<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x82E5;&#x53C2;&#x6570;stream&#x4E3A;NULL&#xFF0C;&#x5219;fflush()&#x5C06;&#x5237;&#x65B0;&#x6240;&#x6709;&#x7684;stdio&#x7F13;&#x51B2;&#x533A;&#x3002;<br>&#x4E5F;&#x80FD;&#x5C06; fflush()&#x51FD;&#x6570;&#x5E94;&#x7528;&#x4E8E;&#x8F93;&#x5165;&#x6D41;&#xFF0C;&#x8FD9;&#x5C06;&#x4E22;&#x5F03;&#x4E1A;&#x5DF2;&#x7F13;&#x51B2;&#x7684;&#x8F93;&#x5165;&#x6570;&#x636E;&#x3002;&#xFF08;&#x5F53;&#x7A0B;&#x5E8F;&#x4E0B;&#x4E00;&#x6B21;&#x5C1D;&#x8BD5;&#x4ECE;&#x6D41;&#x4E2D;&#x8BFB;&#x53D6;&#x6570;&#x636E;&#x65F6;&#xFF0C;&#x5C06;&#x91CD;&#x65B0;&#x88C5;&#x6EE1;&#x7F13;&#x51B2;&#x533A;&#x3002;&#xFF09;<br>&#x5F53;&#x5173;&#x95ED;&#x76F8;&#x5E94;&#x6D41;&#x65F6;&#xFF0C;&#x5C06;&#x81EA;&#x52A8;&#x5237;&#x65B0;&#x5176;stdio&#x7F13;&#x51B2;&#x533A;&#x3002;<br>&#x5728;&#x5305;&#x62EC;glibc&#x5E93;&#x5728;&#x5185;&#x7684;&#x8BB8;&#x591A;C&#x51FD;&#x6570;&#x5E93;&#x5B9E;&#x73B0;&#x4E2D;&#xFF0C;&#x82E5;stdin&#x548C;stdout&#x6307;&#x5411;&#x4E00;&#x7EC8;&#x7AEF;&#xFF0C;&#x90A3;&#x4E48;&#x65E0;&#x8BBA;&#x4F55;&#x65F6;&#x4ECE;stdin&#x4E2D;&#x8BFB;&#x53D6;&#x8F93;&#x5165;&#x65F6;&#xFF0C;&#x90FD;&#x5C06;&#x9690;&#x542B;&#x8C03;&#x7528;&#x4E00;&#x6B21;fflush(stdout)&#x51FD;&#x6570;&#x3002;&#x8FD9;&#x5C06;&#x5237;&#x65B0;&#x5199;&#x5165;stdout&#x7684;&#x4EFB;&#x4F55;&#x63D0;&#x793A;&#xFF0C;&#x4F46;&#x4E0D;&#x5305;&#x62EC;&#x7EC8;&#x6B62;&#x6362;&#x884C;&#x7B26;&#xFF08;&#x6BD4;&#x5982;&#xFF0C;printf(&#x201C;Date&#xFF1A;&#x201D;)&#xFF09;&#x3002;&#x7136;&#x800C;&#xFF0C;SUSv3&#x548C;C99&#x5E76;&#x672A;&#x89C4;&#x5B9A;&#x8FD9;&#x4E00;&#x884C;&#x4E3A;&#xFF0C;&#x4E5F;&#x5E76;&#x975E;&#x6240;&#x6709;&#x7684;C&#x8BED;&#x8A00;&#x51FD;&#x6570;&#x5E93;&#x90FD;&#x5B9E;&#x73B0;&#x4E86;&#x8FD9;&#x4E00;&#x884C;&#x4E3A;&#x3002;&#x8981;&#x4FDD;&#x8BC1;&#x7A0B;&#x5E8F;&#x7684;&#x53EF;&#x79FB;&#x690D;&#x6027;&#xFF0C;&#x5E94;&#x7528;&#x5E94;&#x4F7F;&#x7528;&#x663E;&#x5F0F;&#x7684;fflush(stdout)&#x8C03;&#x7528;&#x6765;&#x786E;&#x4FDD;&#x663E;&#x793A;&#x8FD9;&#x4E9B;&#x63D0;&#x793A;&#x3002;<br>&#x82E5;&#x6253;&#x5F00;&#x4E00;&#x4E2A;&#x6D41;&#x540C;&#x65F6;&#x7528;&#x4E8E;&#x8F93;&#x5165;&#x548C;&#x8F93;&#x51FA;&#xFF0C;&#x5219;C99&#x6807;&#x51C6;&#x4E2D;&#x63D0;&#x51FA;&#x4E86;&#x4E24;&#x9879;&#x8981;&#x6C42;&#x3002;&#x9996;&#x5148;&#xFF0C;&#x4E00;&#x4E2A;&#x8F93;&#x51FA;&#x64CD;&#x4F5C;&#x4E0D;&#x80FD;&#x7D27;&#x8DDF;&#x4E00;&#x4E2A;&#x8F93;&#x5165;&#x64CD;&#x4F5C;&#xFF0C;&#x5FC5;&#x987B;&#x5728;&#x4E8C;&#x8005;&#x4E4B;&#x95F4;&#x8C03;&#x7528;fflush()&#x51FD;&#x6570;&#x6216;&#x662F;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x5B9A;&#x4F4D;&#x51FD;&#x6570;&#xFF08;fseek()&#x3001;fsetpos()&#x6216;&#x8005;rewind()&#xFF09;&#x3002;&#x5176;&#x6B21;&#xFF0C;&#x4E00;&#x4E2A;&#x8F93;&#x5165;&#x64CD;&#x4F5C;&#x4E0D;&#x80FD;&#x7D27;&#x8DDF;&#x4E00;&#x4E2A;&#x8F93;&#x51FA;&#x64CD;&#x4F5C;&#xFF0C;&#x5FC5;&#x987B;&#x5728;&#x4E8C;&#x8005;&#x4E4B;&#x95F4;&#x8C03;&#x7528;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x5B9A;&#x4F4D;&#x51FD;&#x6570;&#xFF0C;&#x9664;&#x975E;&#x8F93;&#x5165;&#x64CD;&#x4F5C;&#x906D;&#x9047;&#x6587;&#x4EF6;&#x7ED3;&#x5C3E;&#x3002;</p>
<h3 id="&#x63A7;&#x5236;&#x6587;&#x4EF6;I-O&#x7684;&#x5185;&#x6838;&#x7F13;&#x51B2;"><a href="#&#x63A7;&#x5236;&#x6587;&#x4EF6;I-O&#x7684;&#x5185;&#x6838;&#x7F13;&#x51B2;" class="headerlink" title="&#x63A7;&#x5236;&#x6587;&#x4EF6;I/O&#x7684;&#x5185;&#x6838;&#x7F13;&#x51B2;"></a>&#x63A7;&#x5236;&#x6587;&#x4EF6;I/O&#x7684;&#x5185;&#x6838;&#x7F13;&#x51B2;</h3><p>&#x5F3A;&#x5236;&#x5237;&#x65B0;&#x5185;&#x6838;&#x7F13;&#x51B2;&#x533A;&#x5230;&#x8F93;&#x51FA;&#x6587;&#x4EF6;&#x662F;&#x53EF;&#x80FD;&#x7684;&#x3002;&#x8FD9;&#x6709;&#x65F6;&#x5F88;&#x6709;&#x5FC5;&#x8981;&#xFF0C;&#x4F8B;&#x5982;&#xFF0C;&#x5F53;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#xFF08;&#x8BF8;&#x5982;&#x6570;&#x636E;&#x5E93;&#x7684;&#x65E5;&#x5FD7;&#x8FDB;&#x7A0B;&#xFF09;&#x8981;&#x786E;&#x4FDD;&#x5728;&#x7EE7;&#x7EED;&#x64CD;&#x4F5C;&#x524D;&#x5C06;&#x8F93;&#x51FA;&#x771F;&#x6B63;&#x5199;&#x5165;&#x78C1;&#x76D8;&#xFF08;&#x6216;&#x8005;&#x81F3;&#x5C11;&#x5199;&#x5165;&#x78C1;&#x76D8;&#x7684;&#x786C;&#x4EF6;&#x9AD8;&#x901F;&#x7F13;&#x5B58;&#x4E2D;&#xFF09;&#x3002;</p>
<h3 id="&#x540C;&#x6B65;I-O&#x6570;&#x636E;&#x5B8C;&#x6574;&#x6027;&#x548C;&#x540C;&#x6B65;I-O&#x6587;&#x4EF6;&#x5B8C;&#x6574;&#x6027;"><a href="#&#x540C;&#x6B65;I-O&#x6570;&#x636E;&#x5B8C;&#x6574;&#x6027;&#x548C;&#x540C;&#x6B65;I-O&#x6587;&#x4EF6;&#x5B8C;&#x6574;&#x6027;" class="headerlink" title="&#x540C;&#x6B65;I/O&#x6570;&#x636E;&#x5B8C;&#x6574;&#x6027;&#x548C;&#x540C;&#x6B65;I/O&#x6587;&#x4EF6;&#x5B8C;&#x6574;&#x6027;"></a>&#x540C;&#x6B65;I/O&#x6570;&#x636E;&#x5B8C;&#x6574;&#x6027;&#x548C;&#x540C;&#x6B65;I/O&#x6587;&#x4EF6;&#x5B8C;&#x6574;&#x6027;</h3><p>SUSv3&#x5C06;&#x540C;&#x6B65;I/O&#x5B8C;&#x6210;&#x5B9A;&#x4E49;&#x4E3A;&#xFF1A;&#x67D0;&#x4E00;I/O&#x64CD;&#x4F5C;&#xFF0C;&#x8981;&#x4E48;&#x5DF2;&#x6210;&#x529F;&#x5B8C;&#x6210;&#x5230;&#x78C1;&#x76D8;&#x7684;&#x6570;&#x636E;&#x4F20;&#x9012;&#xFF0C;&#x8981;&#x4E48;&#x88AB;&#x8BCA;&#x65AD;&#x4E3A;&#x4E0D;&#x6210;&#x529F;&#x3002;<br>SUSv3&#x5B9A;&#x4E49;&#x4E86;&#x4E24;&#x79CD;&#x4E0D;&#x540C;&#x7C7B;&#x578B;&#x7684;&#x540C;&#x6B65;I/O&#x5B8C;&#x6210;&#xFF0C;&#x4E8C;&#x8005;&#x4E4B;&#x95F4;&#x7684;&#x533A;&#x522B;&#x6D89;&#x53CA;&#x7528;&#x4E8E;&#x63CF;&#x8FF0;&#x6587;&#x4EF6;&#x7684;&#x5143;&#x6570;&#x636E;&#xFF08;&#x5173;&#x4E8E;&#x6570;&#x636E;&#x7684;&#x6570;&#x636E;&#xFF09;&#xFF0C;&#x4EA6;&#x5373;&#x5185;&#x6838;&#x9488;&#x5BF9;&#x6587;&#x4EF6;&#x800C;&#x5B58;&#x50A8;&#x7684;&#x6570;&#x636E;&#x3002;&#x63CF;&#x8FF0;&#x6587;&#x4EF6;i-node&#x65F6;&#x5C06;&#x8BE6;&#x7EC6;&#x8BA8;&#x8BBA;&#x6587;&#x4EF6;&#x7684;&#x5143;&#x6570;&#x636E;&#xFF0C;&#x4F46;&#x5C31;&#x76EE;&#x524D;&#x800C;&#x8A00;&#xFF0C;&#x4E86;&#x89E3;&#x6587;&#x4EF6;&#x5143;&#x6570;&#x636E;&#x5305;&#x542B;&#x4E86;&#x4E9B;&#x4EC0;&#x4E48;&#xFF0C;&#x8BF8;&#x5982;&#x6587;&#x4EF6;&#x5C5E;&#x4E3B;&#x3001;&#x5C5E;&#x7EC4;&#x3001;&#x6587;&#x4EF6;&#x6743;&#x9650;&#x3001;&#x6587;&#x4EF6;&#x5927;&#x5C0F;&#x3001;&#x6587;&#x4EF6;&#xFF08;&#x786C;&#xFF09;&#x94FE;&#x63A5;&#x6570;&#x91CF;&#xFF0C;&#x8868;&#x660E;&#x6587;&#x4EF6;&#x6700;&#x8FD1;&#x8BBF;&#x95EE;&#x3001;&#x4FEE;&#x6539;&#x4EE5;&#x53CA;&#x5143;&#x6570;&#x636E;&#x53D1;&#x751F;&#x53D8;&#x5316;&#x7684;&#x65F6;&#x95F4;&#x6233;&#xFF0C;&#x6307;&#x5411;&#x6587;&#x4EF6;&#x6570;&#x636E;&#x5757;&#x7684;&#x6307;&#x9488;&#xFF0C;&#x5C31;&#x8DB3;&#x591F;&#x4E86;&#x3002;</p>
<p>SUSv3&#x5B9A;&#x4E49;&#x7684;&#x7B2C;&#x4E00;&#x79CD;&#x540C;&#x6B65;I/O&#x5B8C;&#x6210;&#x7C7B;&#x578B;&#x662F;synchronized I/O data integrity completion&#xFF0C;&#x65E8;&#x5728;&#x786E;&#x4FDD;&#x9488;&#x5BF9;&#x6587;&#x4EF6;&#x7684;&#x4E00;&#x6B21;&#x66F4;&#x65B0;&#x4F20;&#x9012;&#x4E86;&#x8DB3;&#x591F;&#x7684;&#x4FE1;&#x606F;&#xFF08;&#x5230;&#x78C1;&#x76D8;&#xFF09;&#xFF0C;&#x4EE5;&#x4FBF;&#x4E8E;&#x4E4B;&#x540E;&#x5BF9;&#x6570;&#x636E;&#x7684;&#x83B7;&#x53D6;&#x3002;</p>
<ul>
<li>&#x5C31;&#x8BFB;&#x64CD;&#x4F5C;&#x800C;&#x8A00;&#xFF0C;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x88AB;&#x8BF7;&#x6C42;&#x7684;&#x6587;&#x4EF6;&#x6570;&#x636E;&#x5DF2;&#x7ECF;&#xFF08;&#x4ECE;&#x78C1;&#x76D8;&#xFF09;&#x4F20;&#x9012;&#x7ED9;&#x8FDB;&#x7A0B;&#x3002;&#x82E5;&#x5B58;&#x5728;&#x4EFB;&#x4F55;&#x5F71;&#x54CD;&#x5230;&#x6240;&#x8BF7;&#x6C42;&#x6570;&#x636E;&#x7684;&#x6302;&#x8D77;&#x5199;&#x64CD;&#x4F5C;&#xFF0C;&#x90A3;&#x4E48;&#x5728;&#x6267;&#x884C;&#x8BFB;&#x64CD;&#x4F5C;&#x4E4B;&#x524D;&#xFF0C;&#x4F1A;&#x5C06;&#x8FD9;&#x4E9B;&#x6570;&#x636E;&#x4F20;&#x9012;&#x5230;&#x78C1;&#x76D8;&#x3002;</li>
<li>&#x5C31;&#x5199;&#x64CD;&#x4F5C;&#x800C;&#x8A00;&#xFF0C;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x5199;&#x8BF7;&#x6C42;&#x6240;&#x6307;&#x5B9A;&#x7684;&#x6570;&#x636E;&#x5DF2;&#x4F20;&#x9012;&#xFF08;&#x81F3;&#x78C1;&#x76D8;&#xFF09;&#x5B8C;&#x6BD5;&#xFF0C;&#x4E14;&#x7528;&#x4E8E;&#x83B7;&#x53D6;&#x6570;&#x636E;&#x7684;&#x6240;&#x6709;&#x6587;&#x4EF6;&#x5143;&#x6570;&#x636E;&#x4E5F;&#x5DF2;&#x4F20;&#x9012;&#xFF08;&#x81F3;&#x78C1;&#x76D8;&#xFF09;&#x5B8C;&#x6BD5;&#x3002;&#x6B64;&#x5904;&#x7684;&#x8981;&#x70B9;&#x5728;&#x4E8E;&#x8981;&#x83B7;&#x53D6;&#x6587;&#x4EF6;&#x6570;&#x636E;&#xFF0C;&#x5E76;&#x975E;&#x9700;&#x8981;&#x4F20;&#x9012;&#x6240;&#x6709;&#x7ECF;&#x8FC7;&#x4FEE;&#x6539;&#x7684;&#x6587;&#x4EF6;&#x5143;&#x6570;&#x636E;&#x5C5E;&#x6027;&#x3002;&#x53D1;&#x751F;&#x4FEE;&#x6539;&#x7684;&#x6587;&#x4EF6;&#x5143;&#x6570;&#x636E;&#x4E2D;&#x9700;&#x8981;&#x4F20;&#x9012;&#x7684;&#x5C5E;&#x6027;&#x4E4B;&#x4E00;&#x662F;&#x6587;&#x4EF6;&#x5927;&#x5C0F;&#xFF08;&#x5982;&#x679C;&#x5199;&#x64CD;&#x4F5C;&#x786E;&#x5B9E;&#x6269;&#x5C55;&#x4E86;&#x6587;&#x4EF6;&#xFF09;&#x3002;&#x76F8;&#x5F62;&#x4E4B;&#x4E0B;&#xFF0C;&#x5982;&#x679C;&#x662F;&#x6587;&#x4EF6;&#x65F6;&#x95F4;&#x6233;&#x53D1;&#x751F;&#x4E86;&#x53D8;&#x5316;&#xFF0C;&#x5C31;&#x65E0;&#x9700;&#x5728;&#x4E0B;&#x6B21;&#x83B7;&#x53D6;&#x6570;&#x636E;&#x524D;&#x5C06;&#x5176;&#x4F20;&#x9012;&#x5230;&#x78C1;&#x76D8;&#x3002;</li>
</ul>
<p>Synchronized I/O file integrity completion&#x662F;SUSv3&#x5B9A;&#x4E49;&#x7684;&#x53E6;&#x4E00;&#x79CD;&#x540C;&#x6B65;I/O&#x5B8C;&#x6210;&#xFF0C;&#x4E5F;&#x662F;&#x4E0A;&#x8FF0;synchronized I/O data integrity completion&#x7684;&#x8D85;&#x96C6;&#x3002;&#x8BE5;I/O&#x5B8C;&#x6210;&#x6A21;&#x5F0F;&#x7684;&#x533A;&#x522B;&#x5728;&#x4E8E;&#x5728;&#x5BF9;&#x6587;&#x4EF6;&#x7684;&#x4E00;&#x6B21;&#x66F4;&#x65B0;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x8981;&#x5C06;&#x6240;&#x6709;&#x53D1;&#x751F;&#x66F4;&#x65B0;&#x7684;&#x6587;&#x4EF6;&#x5143;&#x6570;&#x636E;&#x90FD;&#x4F20;&#x9012;&#x5230;&#x78C1;&#x76D8;&#x4E0A;&#xFF0C;&#x5373;&#x4F7F;&#x6709;&#x4E9B;&#x5728;&#x540E;&#x7EED;&#x5BF9;&#x6587;&#x4EF6;&#x6570;&#x636E;&#x7684;&#x8BFB;&#x64CD;&#x4F5C;&#x4E2D;&#x5E76;&#x4E0D;&#x9700;&#x8981;&#x3002;</p>
<p>fsync()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5C06;&#x4F7F;&#x7F13;&#x51B2;&#x6570;&#x636E;&#x548C;&#x4E0E;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;fd&#x76F8;&#x5173;&#x7684;&#x6240;&#x6709;&#x5143;&#x6570;&#x636E;&#x90FD;&#x5237;&#x65B0;&#x5230;&#x78C1;&#x76D8;&#x4E0A;&#x3002;&#x8C03;&#x7528;fsync()&#x4F1A;&#x5F3A;&#x5236;&#x4F7F;&#x6587;&#x4EF6;&#x5904;&#x4E8E;Synchronized I/O file integrity completion&#x72B6;&#x6001;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">fsync</span><span class="token punctuation">(</span><span class="token keyword">int</span> fd<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x4EC5;&#x5728;&#x5BF9;&#x78C1;&#x76D8;&#x8BBE;&#x5907;&#xFF08;&#x6216;&#x8005;&#x81F3;&#x5C11;&#x662F;&#x5176;&#x9AD8;&#x901F;&#x7F13;&#x5B58;&#xFF09;&#x7684;&#x4F20;&#x9012;&#x5B8C;&#x6210;&#x540E;&#xFF0C;fsync()&#x8C03;&#x7528;&#x624D;&#x4F1A;&#x8FD4;&#x56DE;&#x3002;</p>
<p>fdatasync()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x7684;&#x8FD0;&#x4F5C;&#x7C7B;&#x4F3C;&#x4E8E; fsync()&#xFF0C;&#x53EA;&#x662F;&#x5F3A;&#x5236;&#x6587;&#x4EF6;&#x5904;&#x4E8E;synchronized I/O data integrity completion&#x7684;&#x72B6;&#x6001;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">fdatasync</span><span class="token punctuation">(</span><span class="token keyword">int</span> fd<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>fdatasync&#x53EA;&#x5237;&#x65B0;&#x6570;&#x636E;&#x5230;&#x78C1;&#x76D8;&#x3002;<br>fsync&#x540C;&#x65F6;&#x5237;&#x65B0;&#x6570;&#x636E;&#x548C;inode&#x4FE1;&#x606F;&#x5230;&#x78C1;&#x76D8;.<br>fdatasync()&#x53EF;&#x80FD;&#x4F1A;&#x51CF;&#x5C11;&#x5BF9;&#x78C1;&#x76D8;&#x64CD;&#x4F5C;&#x7684;&#x6B21;&#x6570;&#xFF0C;&#x7531;fsync()&#x8C03;&#x7528;&#x8BF7;&#x6C42;&#x7684;&#x4E24;&#x6B21;&#x53D8;&#x4E3A;&#x4E00;&#x6B21;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x82E5;&#x4FEE;&#x6539;&#x4E86;&#x6587;&#x4EF6;&#x6570;&#x636E;&#xFF0C;&#x800C;&#x6587;&#x4EF6;&#x5927;&#x5C0F;&#x4E0D;&#x53D8;&#xFF0C;&#x90A3;&#x4E48;&#x8C03;&#x7528;fdatasync()&#x53EA;&#x5F3A;&#x5236;&#x8FDB;&#x884C;&#x4E86;&#x6570;&#x636E;&#x66F4;&#x65B0;&#x3002;<br>&#x76F8;&#x6BD4;&#x4E4B;&#x4E0B;&#xFF0C;fsync()&#x8C03;&#x7528;&#x4F1A;&#x5F3A;&#x5236;&#x5C06;&#x5143;&#x6570;&#x636E;&#x4F20;&#x9012;&#x5230;&#x78C1;&#x76D8;&#x4E0A;&#x3002;</p>
<p>sync()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x4F1A;&#x4F7F;&#x5305;&#x542B;&#x66F4;&#x65B0;&#x6587;&#x4EF6;&#x4FE1;&#x606F;&#x7684;&#x6240;&#x6709;&#x5185;&#x6838;&#x7F13;&#x51B2;&#x533A;&#xFF08;&#x5373;&#x6570;&#x636E;&#x5757;&#x3001;&#x6307;&#x9488;&#x5757;&#x3001;&#x5143;&#x6570;&#x636E;&#x7B49;&#xFF09;&#x5237;&#x65B0;&#x5230;&#x78C1;&#x76D8;&#x4E0A;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h&gt;</span></span>
<span class="token keyword">void</span> <span class="token function">sync</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x82E5;&#x5185;&#x5BB9;&#x53D1;&#x751F;&#x53D8;&#x5316;&#x7684;&#x5185;&#x6838;&#x7F13;&#x51B2;&#x533A;&#x5728;30&#x79D2;&#x5185;&#x672A;&#x7ECF;&#x663E;&#x5F0F;&#x65B9;&#x5F0F;&#x540C;&#x6B65;&#x5230;&#x78C1;&#x76D8;&#x4E0A;&#xFF0C;&#x5219;&#x4E00;&#x6761;&#x957F;&#x671F;&#x8FD0;&#x884C;&#x7684;&#x5185;&#x6838;&#x7EBF;&#x7A0B;&#x4F1A;&#x786E;&#x4FDD;&#x5C06;&#x5176;&#x5237;&#x65B0;&#x5230;&#x78C1;&#x76D8;&#x4E0A;&#x3002;&#x8FD9;&#x4E00;&#x505A;&#x6CD5;&#x662F;&#x4E3A;&#x4E86;&#x89C4;&#x907F;&#x7F13;&#x51B2;&#x533A;&#x4E0E;&#x76F8;&#x5173;&#x78C1;&#x76D8;&#x6587;&#x4EF6;&#x5185;&#x5BB9;&#x957F;&#x671F;&#x5904;&#x4E8E;&#x4E0D;&#x4E00;&#x81F4;&#x72B6;&#x6001;&#xFF08;&#x4EE5;&#x81F3;&#x4E8E;&#x5728;&#x7CFB;&#x7EDF;&#x5D29;&#x6E83;&#x65F6;&#x53D1;&#x751F;&#x6570;&#x636E;&#x4E22;&#x5931;&#xFF09;&#x7684;&#x95EE;&#x9898;&#x3002;</p>
<h3 id="&#x4F7F;&#x6240;&#x6709;&#x5199;&#x5165;&#x540C;&#x6B65;&#xFF1A;O-SYNC"><a href="#&#x4F7F;&#x6240;&#x6709;&#x5199;&#x5165;&#x540C;&#x6B65;&#xFF1A;O-SYNC" class="headerlink" title="&#x4F7F;&#x6240;&#x6709;&#x5199;&#x5165;&#x540C;&#x6B65;&#xFF1A;O_SYNC"></a>&#x4F7F;&#x6240;&#x6709;&#x5199;&#x5165;&#x540C;&#x6B65;&#xFF1A;O_SYNC</h3><p>&#x8C03;&#x7528;open()&#x51FD;&#x6570;&#x65F6;&#x5982;&#x6307;&#x5B9A;O_SYNC&#x6807;&#x5FD7;&#xFF0C;&#x5219;&#x4F1A;&#x4F7F;&#x6240;&#x6709;&#x540E;&#x7EED;&#x8F93;&#x51FA;&#x540C;&#x6B65;&#xFF08;synchronous&#xFF09;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c">fd<span class="token operator">=</span><span class="token function">open</span><span class="token punctuation">(</span>pathname<span class="token punctuation">,</span>O_WRONLY <span class="token operator">|</span> O_SYNC<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>&#x8C03;&#x7528; open()&#x540E;&#xFF0C;&#x6BCF;&#x4E2A; write()&#x8C03;&#x7528;&#x4F1A;&#x81EA;&#x52A8;&#x5C06;&#x6587;&#x4EF6;&#x6570;&#x636E;&#x548C;&#x5143;&#x6570;&#x636E;&#x5237;&#x65B0;&#x5230;&#x78C1;&#x76D8;&#x4E0A;&#xFF08;&#x5373;&#xFF0C;&#x6309;&#x7167;Synchronized I/O file integrity completion&#x7684;&#x8981;&#x6C42;&#x6267;&#x884C;&#x5199;&#x64CD;&#x4F5C;&#xFF09;&#x3002;<br>&#x65E9;&#x671F;BSD&#x7CFB;&#x7EDF;&#x66FE;&#x4F7F;&#x7528;O_FSYNC&#x6807;&#x5FD7;&#x6765;&#x63D0;&#x4F9B;O_SYNC&#x6807;&#x5FD7;&#x7684;&#x529F;&#x80FD;&#x3002;&#x5728;glibc&#x5E93;&#x4E2D;&#xFF0C;&#x5C06;O_FSYNC&#x5B9A;&#x4E49;&#x4E3A;&#x4E0E;O_SYNC&#x6807;&#x5FD7;&#x540C;&#x4E49;&#x3002;<br>&#x91C7;&#x7528;O_SYNC&#x6807;&#x5FD7;&#xFF08;&#x6216;&#x8005;&#x9891;&#x7E41;&#x8C03;&#x7528;fsync()&#x3001;fdatasync()&#x6216;sync()&#xFF09;&#x5BF9;&#x6027;&#x80FD;&#x7684;&#x5F71;&#x54CD;&#x6781;&#x5927;&#x3002;<br></p><div class="amp-img-wrapper"><amp-img src="https://pagepig.oss-cn-hangzhou.aliyuncs.com/20200208154822.png?x-oss-process=image/resize,m_lfit,h_450" width="770" height="450" layout="responsive"></amp-img></div>
<h3 id="O-DSYNC&#x548C;O-RSYNC&#x6807;&#x5FD7;"><a href="#O-DSYNC&#x548C;O-RSYNC&#x6807;&#x5FD7;" class="headerlink" title="O_DSYNC&#x548C;O_RSYNC&#x6807;&#x5FD7;"></a>O_DSYNC&#x548C;O_RSYNC&#x6807;&#x5FD7;</h3><p>SUSv3&#x89C4;&#x5B9A;&#x4E86;&#x4E24;&#x4E2A;&#x4E0E;&#x540C;&#x6B65;I/O&#x6709;&#x5173;&#x7684;&#x3001;&#x66F4;&#x4E3A;&#x7EC6;&#x5316;&#x7684;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x72B6;&#x6001;&#x6807;&#x5FD7;&#xFF1A;O_DSYNC &#x548C; O_RSYNC&#x3002;<br>O_DSYNC&#x6807;&#x5FD7;&#x8981;&#x6C42;&#x5199;&#x64CD;&#x4F5C;&#x6309;&#x7167;synchronized I/O data integrity completion&#x6765;&#x6267;&#x884C;&#xFF08;&#x7C7B;&#x4F3C;&#x4E8E;fdatasync()&#xFF09;&#x3002;&#x4E0E;&#x4E4B;&#x76F8;&#x6620;&#x6210;&#x8DA3;&#x7684;&#x662F;O_SYNC&#x6807;&#x5FD7;&#xFF0C;&#x9075;&#x4ECE;synchronized I/O file integrity completion&#xFF08;&#x7C7B;&#x4F3C;&#x4E8E;fsync()&#x51FD;&#x6570;&#xFF09;&#x3002;<br>O_RSYNC&#x6807;&#x5FD7;&#x662F;&#x4E0E;O_SYNC&#x6807;&#x5FD7;&#x6216;O_DSYNC&#x6807;&#x5FD7;&#x914D;&#x5408;&#x4E00;&#x8D77;&#x4F7F;&#x7528;&#x7684;&#xFF0C;&#x5C06;&#x8FD9;&#x4E9B;&#x6807;&#x5FD7;&#x5BF9;&#x5199;&#x64CD;&#x4F5C;&#x7684;&#x4F5C;&#x7528;&#x7ED3;&#x5408;&#x5230;&#x8BFB;&#x64CD;&#x4F5C;&#x4E2D;&#x3002;&#x5982;&#x679C;&#x5728;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x65F6;&#x540C;&#x65F6;&#x6307;&#x5B9A;O_RSYNC &#x548C;O_DSYNC&#x6807;&#x5FD7;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x610F;&#x5473;&#x7740;&#x4F1A;&#x9075;&#x7167;synchronized I/O data integrity completion&#x7684;&#x8981;&#x6C42;&#x6765;&#x5B8C;&#x6210;&#x6240;&#x6709;&#x540E;&#x7EED;&#x8BFB;&#x64CD;&#x4F5C;&#xFF08;&#x5373;&#xFF0C;&#x5728;&#x6267;&#x884C;&#x8BFB;&#x64CD;&#x4F5C;&#x4E4B;&#x524D;&#xFF0C;&#x50CF;&#x6267;&#x884C;O_DSYNC&#x6807;&#x5FD7;&#x4E00;&#x6837;&#x5B8C;&#x6210;&#x6240;&#x6709;&#x5F85;&#x5904;&#x7406;&#x7684;&#x5199;&#x64CD;&#x4F5C;&#xFF09;&#x3002;&#x800C;&#x5728;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x65F6;&#x6307;&#x5B9A;O_RSYNC &#x548C; O_SYNC&#x6807;&#x5FD7;&#xFF0C;&#x5219;&#x610F;&#x5473;&#x7740;&#x4F1A;&#x9075;&#x7167;synchronized I/O file integrity completion&#x7684;&#x8981;&#x6C42;&#x6765;&#x5B8C;&#x6210;&#x6240;&#x6709;&#x540E;&#x7EED;&#x8BFB;&#x64CD;&#x4F5C;&#xFF08;&#x5373;&#xFF0C;&#x5728;&#x6267;&#x884C;&#x8BFB;&#x64CD;&#x4F5C;&#x4E4B;&#x524D;&#xFF0C;&#x50CF;&#x6267;&#x884C;O_SYNC&#x6807;&#x5FD7;&#x4E00;&#x6837;&#x5B8C;&#x6210;&#x6240;&#x6709;&#x5F85;&#x5904;&#x7406;&#x7684;&#x5199;&#x64CD;&#x4F5C;&#xFF09;&#x3002;</p>
<h3 id="I-O&#x7F13;&#x51B2;&#x5C0F;&#x7ED3;"><a href="#I-O&#x7F13;&#x51B2;&#x5C0F;&#x7ED3;" class="headerlink" title="I/O&#x7F13;&#x51B2;&#x5C0F;&#x7ED3;"></a>I/O&#x7F13;&#x51B2;&#x5C0F;&#x7ED3;</h3><p>&#x4E0B;&#x56FE;&#x6982;&#x62EC;&#x4E86;stdio&#x51FD;&#x6570;&#x5E93;&#x548C;&#x5185;&#x6838;&#x6240;&#x91C7;&#x7528;&#x7684;&#x7F13;&#x51B2;&#xFF08;&#x9488;&#x5BF9;&#x8F93;&#x51FA;&#x6587;&#x4EF6;&#xFF09;&#xFF0C;&#x4EE5;&#x53CA;&#x5BF9;&#x5404;&#x79CD;&#x7F13;&#x51B2;&#x7C7B;&#x578B;&#x7684;&#x63A7;&#x5236;&#x673A;&#x5236;&#x3002;&#x4ECE;&#x56FE;&#x4E2D;&#x81EA;&#x4E0A;&#x800C;&#x4E0B;&#xFF0C;&#x9996;&#x5148;&#x662F;&#x901A;&#x8FC7;stdio&#x5E93;&#x5C06;&#x7528;&#x6237;&#x6570;&#x636E;&#x4F20;&#x9012;&#x5230;stdio&#x7F13;&#x51B2;&#x533A;&#xFF0C;&#x8BE5;&#x7F13;&#x51B2;&#x533A;&#x4F4D;&#x4E8E;&#x7528;&#x6237;&#x6001;&#x5185;&#x5B58;&#x533A;&#x3002;&#x5F53;&#x7F13;&#x51B2;&#x533A;&#x586B;&#x6EE1;&#x65F6;&#xFF0C;stdio&#x5E93;&#x4F1A;&#x8C03;&#x7528;write()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF0C;&#x5C06;&#x6570;&#x636E;&#x4F20;&#x9012;&#x5230;&#x5185;&#x6838;&#x9AD8;&#x901F;&#x7F13;&#x51B2;&#x533A;&#xFF08;&#x4F4D;&#x4E8E;&#x5185;&#x6838;&#x6001;&#x5185;&#x5B58;&#x533A;&#xFF09;&#x3002;&#x6700;&#x7EC8;&#xFF0C;&#x5185;&#x6838;&#x53D1;&#x8D77;&#x78C1;&#x76D8;&#x64CD;&#x4F5C;&#xFF0C;&#x5C06;&#x6570;&#x636E;&#x4F20;&#x9012;&#x5230;&#x78C1;&#x76D8;&#x3002;<br></p><div class="amp-img-wrapper"><amp-img src="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1581148432393.png?x-oss-process=image/resize,m_lfit,h_450" width="515" height="450" layout="responsive"></amp-img></div>
<h3 id="&#x5C31;I-O&#x6A21;&#x5F0F;&#x5411;&#x5185;&#x6838;&#x63D0;&#x51FA;&#x5EFA;&#x8BAE;"><a href="#&#x5C31;I-O&#x6A21;&#x5F0F;&#x5411;&#x5185;&#x6838;&#x63D0;&#x51FA;&#x5EFA;&#x8BAE;" class="headerlink" title="&#x5C31;I/O&#x6A21;&#x5F0F;&#x5411;&#x5185;&#x6838;&#x63D0;&#x51FA;&#x5EFA;&#x8BAE;"></a>&#x5C31;I/O&#x6A21;&#x5F0F;&#x5411;&#x5185;&#x6838;&#x63D0;&#x51FA;&#x5EFA;&#x8BAE;</h3><p>posix_fadvise()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5141;&#x8BB8;&#x8FDB;&#x7A0B;&#x5C31;&#x81EA;&#x8EAB;&#x8BBF;&#x95EE;&#x6587;&#x4EF6;&#x6570;&#x636E;&#x65F6;&#x53EF;&#x80FD;&#x91C7;&#x53D6;&#x7684;&#x6A21;&#x5F0F;&#x901A;&#x77E5;&#x5185;&#x6838;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">define</span> _XOPEN_SOURCE 600</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;fcntl.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">posix_fadvise</span><span class="token punctuation">(</span><span class="token keyword">int</span> fd<span class="token punctuation">,</span>off_t offset<span class="token punctuation">,</span> off_t len<span class="token punctuation">,</span> <span class="token keyword">int</span> advice<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x6210;&#x529F;&#x8FD4;&#x56DE;0&#xFF0C;&#x5931;&#x8D25;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x6B63;&#x6570;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x7565;&#x3002;</p>
<h3 id="&#x7ED5;&#x8FC7;&#x7F13;&#x51B2;&#x533A;&#x9AD8;&#x901F;&#x7F13;&#x5B58;&#xFF1A;&#x76F4;&#x63A5;I-O"><a href="#&#x7ED5;&#x8FC7;&#x7F13;&#x51B2;&#x533A;&#x9AD8;&#x901F;&#x7F13;&#x5B58;&#xFF1A;&#x76F4;&#x63A5;I-O" class="headerlink" title="&#x7ED5;&#x8FC7;&#x7F13;&#x51B2;&#x533A;&#x9AD8;&#x901F;&#x7F13;&#x5B58;&#xFF1A;&#x76F4;&#x63A5;I/O"></a>&#x7ED5;&#x8FC7;&#x7F13;&#x51B2;&#x533A;&#x9AD8;&#x901F;&#x7F13;&#x5B58;&#xFF1A;&#x76F4;&#x63A5;I/O</h3><p>&#x59CB;&#x4E8E;&#x5185;&#x6838;2.4&#xFF0C;Linux&#x5141;&#x8BB8;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5728;&#x6267;&#x884C;&#x78C1;&#x76D8;I/O&#x65F6;&#x7ED5;&#x8FC7;&#x7F13;&#x51B2;&#x533A;&#x9AD8;&#x901F;&#x7F13;&#x5B58;&#xFF0C;&#x4ECE;&#x7528;&#x6237;&#x7A7A;&#x95F4;&#x76F4;&#x63A5;&#x5C06;&#x6570;&#x636E;&#x4F20;&#x9012;&#x5230;&#x6587;&#x4EF6;&#x6216;&#x78C1;&#x76D8;&#x8BBE;&#x5907;&#x3002;&#x6709;&#x65F6;&#x4E5F;&#x79F0;&#x6B64;&#x4E3A;&#x76F4;&#x63A5;I/O&#xFF08;direct I/O&#xFF09;&#x6216;&#x8005;&#x88F8;I/O(raw I/O)&#x3002;<br>&#x6B64;&#x5904;&#x7684;&#x63CF;&#x8FF0;&#x7EC6;&#x8282;&#x4E3A;Linux&#x6240;&#x7279;&#x6709;&#xFF0C;SUSv3&#x5E76;&#x672A;&#x5BF9;&#x5176;&#x8FDB;&#x884C;&#x89C4;&#x8303;&#x3002;&#x5C3D;&#x7BA1;&#x5982;&#x6B64;&#xFF0C;&#x5927;&#x591A;&#x6570;UNIX&#x5B9E;&#x73B0;&#x5747;&#x5BF9;&#x8BBE;&#x5907;&#x548C;&#x6587;&#x4EF6;&#x63D0;&#x4F9B;&#x4E86;&#x67D0;&#x79CD;&#x5F62;&#x5F0F;&#x7684;&#x76F4;&#x63A5;I/O&#x8BBF;&#x95EE;&#x3002;</p>
<p>&#x6709;&#x65F6;&#x4F1A;&#x5C06;&#x76F4;&#x63A5;I/O&#x8BEF;&#x8BA4;&#x4E3A;&#x83B7;&#x53D6;&#x5FEB;&#x901F;I/O&#x6027;&#x80FD;&#x7684;&#x4E00;&#x79CD;&#x624B;&#x6BB5;&#x3002;&#x7136;&#x800C;&#xFF0C;&#x5BF9;&#x4E8E;&#x5927;&#x591A;&#x6570;&#x5E94;&#x7528;&#x800C;&#x8A00;&#xFF0C;&#x4F7F;&#x7528;&#x76F4;&#x63A5;I/O&#x53EF;&#x80FD;&#x4F1A;&#x5927;&#x5927;&#x964D;&#x4F4E;&#x6027;&#x80FD;&#x3002;&#x8FD9;&#x662F;&#x56E0;&#x4E3A;&#x4E3A;&#x4E86;&#x63D0;&#x9AD8;I/O&#x6027;&#x80FD;&#xFF0C;&#x5185;&#x6838;&#x9488;&#x5BF9;&#x7F13;&#x51B2;&#x533A;&#x9AD8;&#x901F;&#x7F13;&#x5B58;&#x505A;&#x4E86;&#x4E0D;&#x5C11;&#x4F18;&#x5316;&#xFF0C;&#x5176;&#x4E2D;&#x5305;&#x62EC;&#xFF1A;&#x6309;&#x987A;&#x5E8F;&#x9884;&#x8BFB;&#x53D6;&#xFF0C;&#x5728;&#x6210;&#x7C07;&#xFF08;clusters&#xFF09;&#x78C1;&#x76D8;&#x5757;&#x4E0A;&#x6267;&#x884C;I/O&#xFF0C;&#x5141;&#x8BB8;&#x8BBF;&#x95EE;&#x540C;&#x4E00;&#x6587;&#x4EF6;&#x7684;&#x591A;&#x4E2A;&#x8FDB;&#x7A0B;&#x5171;&#x4EAB;&#x9AD8;&#x901F;&#x7F13;&#x5B58;&#x7684;&#x7F13;&#x51B2;&#x533A;&#x3002;&#x5E94;&#x7528;&#x5982;&#x4F7F;&#x7528;&#x4E86;&#x76F4;&#x63A5;I/O&#x5C06;&#x65E0;&#x6CD5;&#x53D7;&#x76CA;&#x4E8E;&#x8FD9;&#x4E9B;&#x4F18;&#x5316;&#x4E3E;&#x63AA;&#x3002;&#x76F4;&#x63A5;I/O&#x53EA;&#x9002;&#x7528;&#x4E8E;&#x6709;&#x7279;&#x5B9A;I/O&#x9700;&#x6C42;&#x7684;&#x5E94;&#x7528;&#x3002;&#x4F8B;&#x5982;&#x6570;&#x636E;&#x5E93;&#x7CFB;&#x7EDF;&#xFF0C;&#x5176;&#x9AD8;&#x901F;&#x7F13;&#x5B58;&#x548C;I/O&#x4F18;&#x5316;&#x673A;&#x5236;&#x5747;&#x81EA;&#x6210;&#x4E00;&#x4F53;&#xFF0C;&#x65E0;&#x9700;&#x5185;&#x6838;&#x6D88;&#x8017;CPU&#x65F6;&#x95F4;&#x548C;&#x5185;&#x5B58;&#x53BB;&#x5B8C;&#x6210;&#x76F8;&#x540C;&#x4EFB;&#x52A1;&#x3002;<br>&#x53EF;&#x9488;&#x5BF9;&#x4E00;&#x4E2A;&#x5355;&#x72EC;&#x6587;&#x4EF6;&#x6216;&#x5757;&#x8BBE;&#x5907;&#xFF08;&#x6BD4;&#x5982;&#xFF0C;&#x4E00;&#x5757;&#x78C1;&#x76D8;&#xFF09;&#x6267;&#x884C;&#x76F4;&#x63A5;I/O&#x3002;&#x8981;&#x505A;&#x5230;&#x8FD9;&#x70B9;&#xFF0C;&#x9700;&#x8981;&#x5728;&#x8C03;&#x7528;open()&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x6216;&#x8BBE;&#x5907;&#x65F6;&#x6307;&#x5B9A;O_DIRECT&#x6807;&#x5FD7;&#x3002;<br>O_DIRECT&#x6807;&#x5FD7;&#x81EA;&#x5185;&#x6838;2.4.10&#x5F00;&#x59CB;&#x6709;&#x6548;&#xFF0C;&#x5E76;&#x975E;&#x6240;&#x6709;Linux&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x548C;&#x5185;&#x6838;&#x7248;&#x672C;&#x90FD;&#x652F;&#x6301;&#x8BE5;&#x6807;&#x5FD7;&#x3002;&#x7EDD;&#x5927;&#x591A;&#x6570;&#x539F;&#x751F;&#xFF08;native&#xFF09;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x90FD;&#x652F;&#x6301;O_DIRECT&#xFF0C;&#x4F46;&#x8BB8;&#x591A;&#x975E;UNIX&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#xFF08;&#x6BD4;&#x5982;VFAT&#xFF09;&#x5219;&#x4E0D;&#x652F;&#x6301;&#x3002;&#x5BF9;&#x4E8E;&#x6240;&#x5173;&#x6CE8;&#x7684;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#xFF0C;&#x6709;&#x5FC5;&#x8981;&#x8FDB;&#x884C;&#x76F8;&#x5173;&#x6D4B;&#x8BD5;&#xFF08;&#x82E5;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x4E0D;&#x652F;&#x6301;O_DIRECT&#xFF0C;&#x5219;open()&#x5C06;&#x5931;&#x8D25;&#x5E76;&#x8FD4;&#x56DE;&#x9519;&#x8BEF;&#x53F7;EINVAL&#xFF09;&#x6216;&#x662F;&#x9605;&#x8BFB;&#x5185;&#x6838;&#x6E90;&#x7801;&#xFF0C;&#x4EE5;&#x6B64;&#x6765;&#x52A0;&#x4EE5;&#x9A8C;&#x8BC1;&#x3002;<br>&#x82E5;&#x4E00;&#x8FDB;&#x7A0B;&#x4EE5;O_DIRECT&#x6807;&#x5FD7;&#x6253;&#x5F00;&#x67D0;&#x6587;&#x4EF6;&#xFF0C;&#x800C;&#x53E6;&#x4E00;&#x8FDB;&#x7A0B;&#x4EE5;&#x666E;&#x901A;&#x65B9;&#x5F0F;&#xFF08;&#x5373;&#x4F7F;&#x7528;&#x4E86;&#x9AD8;&#x901F;&#x7F13;&#x5B58;&#x7F13;&#x51B2;&#x533A;&#xFF09;&#x6253;&#x5F00;&#x540C;&#x4E00;&#x6587;&#x4EF6;&#xFF0C;&#x5219;&#x7531;&#x76F4;&#x63A5;I/O&#x6240;&#x8BFB;&#x5199;&#x7684;&#x6570;&#x636E;&#x4E0E;&#x7F13;&#x51B2;&#x533A;&#x9AD8;&#x901F;&#x7F13;&#x5B58;&#x4E2D;&#x5185;&#x5BB9;&#x4E4B;&#x95F4;&#x4E0D;&#x5B58;&#x5728;&#x4E00;&#x81F4;&#x6027;&#x3002;&#x5E94;&#x5C3D;&#x91CF;&#x907F;&#x514D;&#x8FD9;&#x4E00;&#x573A;&#x666F;&#x3002;</p>
<p>&#x56E0;&#x4E3A;&#x76F4;&#x63A5;I/O&#xFF08;&#x9488;&#x5BF9;&#x78C1;&#x76D8;&#x8BBE;&#x5907;&#x548C;&#x6587;&#x4EF6;&#xFF09;&#x6D89;&#x53CA;&#x5BF9;&#x78C1;&#x76D8;&#x7684;&#x76F4;&#x63A5;&#x8BBF;&#x95EE;&#xFF0C;&#x6240;&#x4EE5;&#x5728;&#x6267;&#x884C;I/O&#x65F6;&#xFF0C;&#x5FC5;&#x987B;&#x9075;&#x5B88;&#x4E00;&#x4E9B;&#x9650;&#x5236;&#x3002;</p>
<ul>
<li>&#x7528;&#x4E8E;&#x4F20;&#x9012;&#x6570;&#x636E;&#x7684;&#x7F13;&#x51B2;&#x533A;&#xFF0C;&#x5176;&#x5185;&#x5B58;&#x8FB9;&#x754C;&#x5FC5;&#x987B;&#x5BF9;&#x9F50;&#x4E3A;&#x5757;&#x5927;&#x5C0F;&#x7684;&#x6574;&#x6570;&#x500D;&#x3002;</li>
<li>&#x6570;&#x636E;&#x4F20;&#x8F93;&#x7684;&#x5F00;&#x59CB;&#x70B9;&#xFF0C;&#x4EA6;&#x5373;&#x6587;&#x4EF6;&#x548C;&#x8BBE;&#x5907;&#x7684;&#x504F;&#x79FB;&#x91CF;&#xFF0C;&#x5FC5;&#x987B;&#x662F;&#x5757;&#x5927;&#x5C0F;&#x7684;&#x6574;&#x6570;&#x500D;&#x3002;</li>
<li>&#x5F85;&#x4F20;&#x9012;&#x6570;&#x636E;&#x7684;&#x957F;&#x5EA6;&#x5FC5;&#x987B;&#x662F;&#x5757;&#x5927;&#x5C0F;&#x7684;&#x6574;&#x6570;&#x500D;&#x3002;</li>
</ul>
<p>&#x4E0D;&#x9075;&#x5B88;&#x4E0A;&#x8FF0;&#x4EFB;&#x4E00;&#x9650;&#x5236;&#x5747;&#x5C06;&#x5BFC;&#x81F4;EINVAL&#x9519;&#x8BEF;&#x3002;&#x5728;&#x4E0A;&#x8FF0;&#x5217;&#x8868;&#x4E2D;&#xFF0C;&#x5757;&#x5927;&#x5C0F;&#xFF08;block size&#xFF09;&#x6307;&#x8BBE;&#x5907;&#x7684;&#x7269;&#x7406;&#x5757;&#x5927;&#x5C0F;&#xFF08;&#x901A;&#x5E38;&#x4E3A;512&#x5B57;&#x8282;&#xFF09;&#x3002;</p>
<h3 id="&#x6DF7;&#x5408;&#x4F7F;&#x7528;&#x5E93;&#x51FD;&#x6570;&#x548C;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x8FDB;&#x884C;&#x6587;&#x4EF6;I-O"><a href="#&#x6DF7;&#x5408;&#x4F7F;&#x7528;&#x5E93;&#x51FD;&#x6570;&#x548C;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x8FDB;&#x884C;&#x6587;&#x4EF6;I-O" class="headerlink" title="&#x6DF7;&#x5408;&#x4F7F;&#x7528;&#x5E93;&#x51FD;&#x6570;&#x548C;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x8FDB;&#x884C;&#x6587;&#x4EF6;I/O"></a>&#x6DF7;&#x5408;&#x4F7F;&#x7528;&#x5E93;&#x51FD;&#x6570;&#x548C;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x8FDB;&#x884C;&#x6587;&#x4EF6;I/O</h3><p>&#x5728;&#x540C;&#x4E00;&#x6587;&#x4EF6;&#x4E0A;&#x6267;&#x884C;I/O&#x64CD;&#x4F5C;&#x65F6;&#xFF0C;&#x8FD8;&#x53EF;&#x4EE5;&#x5C06;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x548C;&#x6807;&#x51C6;C&#x8BED;&#x8A00;&#x5E93;&#x51FD;&#x6570;&#x6DF7;&#x5408;&#x4F7F;&#x7528;&#x3002;fileno()&#x548C;fdopen()&#x51FD;&#x6570;&#x6709;&#x52A9;&#x4E8E;&#x5B8C;&#x6210;&#x8FD9;&#x4E00;&#x5DE5;&#x4F5C;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">fileno</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span>
FILE <span class="token operator">*</span><span class="token function">fdopen</span><span class="token punctuation">(</span><span class="token keyword">int</span> fildes<span class="token punctuation">,</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> mode<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x7ED9;&#x5B9A;&#x4E00;&#x4E2A;&#xFF08;&#x6587;&#x4EF6;&#xFF09;&#x6D41;&#xFF0C;fileno()&#x51FD;&#x6570;&#x5C06;&#x8FD4;&#x56DE;&#x76F8;&#x5E94;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#xFF08;&#x5373;stdio&#x5E93;&#x5728;&#x8BE5;&#x6D41;&#x4E0A;&#x5DF2;&#x7ECF;&#x6253;&#x5F00;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#xFF09;&#x3002;&#x968F;&#x5373;&#x53EF;&#x4EE5;&#x5728;&#x8BF8;&#x5982;read()&#x3001;write()&#x3001;dup()&#x548C;fcntl()&#x4E4B;&#x7C7B;&#x7684;I/O&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x4E2D;&#x6B63;&#x5E38;&#x4F7F;&#x7528;&#x8BE5;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x3002;<br>fdopen()&#x51FD;&#x6570;&#x4E0E; fileno()&#x51FD;&#x6570;&#x7684;&#x529F;&#x80FD;&#x76F8;&#x53CD;&#x3002;&#x7ED9;&#x5B9A;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#xFF0C;&#x8BE5;&#x51FD;&#x6570;&#x5C06;&#x521B;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A;&#x4F7F;&#x7528;&#x8BE5;&#x63CF;&#x8FF0;&#x7B26;&#x8FDB;&#x884C;&#x6587;&#x4EF6;I/O&#x7684;&#x76F8;&#x5E94;&#x6D41;&#x3002;mode&#x53C2;&#x6570;&#x4E0E;fopen()&#x51FD;&#x6570;&#x4E2D;mode&#x53C2;&#x6570;&#x542B;&#x4E49;&#x76F8;&#x540C;&#x3002;&#x4F8B;&#x5982;&#xFF0C;r&#x4E3A;&#x8BFB;&#xFF0C;w&#x4E3A;&#x5199;&#xFF0C;a&#x4E3A;&#x8FFD;&#x52A0;&#x3002;&#x82E5;&#x8BE5;&#x53C2;&#x6570;&#x4E0E;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;fd&#x7684;&#x8BBF;&#x95EE;&#x6A21;&#x5F0F;&#x4E0D;&#x4E00;&#x81F4;&#xFF0C;&#x5219;&#x5BF9;fdopen()&#x7684;&#x8C03;&#x7528;&#x5C06;&#x5931;&#x8D25;&#x3002;</p>
<p>&#x5F53;&#x4F7F;&#x7528;stdio&#x5E93;&#x51FD;&#x6570;&#xFF0C;&#x5E76;&#x7ED3;&#x5408;&#x7CFB;&#x7EDF;I/O&#x8C03;&#x7528;&#x6765;&#x5B9E;&#x73B0;&#x5BF9;&#x78C1;&#x76D8;&#x6587;&#x4EF6;&#x7684;I/O&#x64CD;&#x4F5C;&#x65F6;&#xFF0C;&#x5FC5;&#x987B;&#x5C06;&#x7F13;&#x51B2;&#x95EE;&#x9898;&#x7262;&#x8BB0;&#x4E8E;&#x5FC3;&#x3002;I/O&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x4F1A;&#x76F4;&#x63A5;&#x5C06;&#x6570;&#x636E;&#x4F20;&#x9012;&#x5230;&#x5185;&#x6838;&#x7F13;&#x51B2;&#x533A;&#x9AD8;&#x901F;&#x7F13;&#x5B58;&#xFF0C;&#x800C;stdio&#x5E93;&#x51FD;&#x6570;&#x4F1A;&#x7B49;&#x5230;&#x7528;&#x6237;&#x7A7A;&#x95F4;&#x7684;&#x6D41;&#x7F13;&#x51B2;&#x533A;&#x586B;&#x6EE1;&#xFF0C;&#x518D;&#x8C03;&#x7528;write()&#x5C06;&#x5176;&#x4F20;&#x9012;&#x5230;&#x5185;&#x6838;&#x7F13;&#x51B2;&#x533A;&#x9AD8;&#x901F;&#x7F13;&#x5B58;&#x3002;&#x8BF7;&#x8003;&#x8651;&#x5982;&#x4E0B;&#x5411;&#x6807;&#x51C6;&#x8F93;&#x51FA;&#x5199;&#x5165;&#x7684;&#x4EE3;&#x7801;&#xFF1A;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;111&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span><span class="token string">&quot;222&quot;</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x901A;&#x5E38;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;printf()&#x51FD;&#x6570;&#x7684;&#x8F93;&#x51FA;&#x5F80;&#x5F80;&#x5728; write()&#x51FD;&#x6570;&#x7684;&#x8F93;&#x51FA;&#x4E4B;&#x540E;&#x51FA;&#x73B0;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x4EE3;&#x7801;&#x4EA7;&#x751F;&#x5982;&#x4E0B;&#x8F93;&#x51FA;&#xFF1A;</p>
<pre><code>222
111</code></pre><p>&#x5C06;I/O&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x548C;stdio&#x51FD;&#x6570;&#x6DF7;&#x5408;&#x4F7F;&#x7528;&#x65F6;&#xFF0C;&#x4F7F;&#x7528;fflush()&#x6765;&#x89C4;&#x907F;&#x8FD9;&#x4E00;&#x95EE;&#x9898;&#xFF0C;&#x662F;&#x660E;&#x667A;&#x4E4B;&#x4E3E;&#x3002;&#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;setvbuf()&#x6216;setbuf()&#x4F7F;&#x7F13;&#x51B2;&#x533A;&#x5931;&#x6548;&#xFF0C;&#x4F46;&#x8FD9;&#x6837;&#x505A;&#x53EF;&#x80FD;&#x4F1A;&#x5F71;&#x54CD;&#x5E94;&#x7528;&#x7684;I/O&#x6027;&#x80FD;&#xFF0C;&#x56E0;&#x4E3A;&#x6BCF;&#x4E2A;&#x8F93;&#x51FA;&#x64CD;&#x4F5C;&#x5C06;&#x5F15;&#x8D77;&#x4E00;&#x6B21;write()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x3002;</p>
<h1 id="&#x6587;&#x4EF6;&#x5C5E;&#x6027;"><a href="#&#x6587;&#x4EF6;&#x5C5E;&#x6027;" class="headerlink" title="&#x6587;&#x4EF6;&#x5C5E;&#x6027;"></a>&#x6587;&#x4EF6;&#x5C5E;&#x6027;</h1><h2 id="&#x83B7;&#x53D6;&#x6587;&#x4EF6;&#x4FE1;&#x606F;&#xFF1A;stat"><a href="#&#x83B7;&#x53D6;&#x6587;&#x4EF6;&#x4FE1;&#x606F;&#xFF1A;stat" class="headerlink" title="&#x83B7;&#x53D6;&#x6587;&#x4EF6;&#x4FE1;&#x606F;&#xFF1A;stat()"></a>&#x83B7;&#x53D6;&#x6587;&#x4EF6;&#x4FE1;&#x606F;&#xFF1A;stat()</h2><p>&#x5229;&#x7528;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;stat()&#x3001;lstat()&#x4EE5;&#x53CA;fstat()&#xFF0C;&#x53EF;&#x83B7;&#x53D6;&#x4E0E;&#x6587;&#x4EF6;&#x6709;&#x5173;&#x7684;&#x4FE1;&#x606F;&#xFF0C;&#x5176;&#x4E2D;&#x5927;&#x90E8;&#x5206;&#x63D0;&#x53D6;&#x81EA;&#x6587;&#x4EF6;i&#x8282;&#x70B9;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;sys/stat.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">stat</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>pathname<span class="token punctuation">,</span> <span class="token keyword">struct</span> stat <span class="token operator">*</span>statbuf<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">lstat</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>pathname<span class="token punctuation">,</span> <span class="token keyword">struct</span> stat <span class="token operator">*</span>statbuf<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">fstat</span><span class="token punctuation">(</span><span class="token keyword">int</span> fd<span class="token punctuation">,</span> <span class="token keyword">struct</span> stat <span class="token operator">*</span>statbuf<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> stat
<span class="token punctuation">{</span>
    dev_t     st_dev<span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">/* ID of device containing file */</span> <span class="token comment" spellcheck="true">//&#x6587;&#x4EF6;&#x4F7F;&#x7528;&#x7684;&#x8BBE;&#x5907;&#x53F7;</span>
    ino_t     st_ino<span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">/* inode number */</span>    <span class="token comment" spellcheck="true">//&#x7D22;&#x5F15;&#x8282;&#x70B9;&#x53F7; </span>
    mode_t    st_mode<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/* protection */</span>  <span class="token comment" spellcheck="true">//&#x6587;&#x4EF6;&#x5BF9;&#x5E94;&#x7684;&#x6A21;&#x5F0F;&#xFF0C;&#x6587;&#x4EF6;&#xFF0C;&#x76EE;&#x5F55;&#x7B49;</span>
    nlink_t   st_nlink<span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">/* number of hard links */</span>    <span class="token comment" spellcheck="true">//&#x6587;&#x4EF6;&#x7684;&#x786C;&#x8FDE;&#x63A5;&#x6570;  </span>
    uid_t     st_uid<span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">/* user ID of owner */</span>    <span class="token comment" spellcheck="true">//&#x6240;&#x6709;&#x8005;&#x7528;&#x6237;&#x8BC6;&#x522B;&#x53F7;</span>
    gid_t     st_gid<span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">/* group ID of owner */</span>   <span class="token comment" spellcheck="true">//&#x7EC4;&#x8BC6;&#x522B;&#x53F7;  </span>
    dev_t     st_rdev<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/* device ID (if special file) */</span> <span class="token comment" spellcheck="true">//&#x8BBE;&#x5907;&#x6587;&#x4EF6;&#x7684;&#x8BBE;&#x5907;&#x53F7;</span>
    off_t     st_size<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/* total size, in bytes */</span> <span class="token comment" spellcheck="true">//&#x4EE5;&#x5B57;&#x8282;&#x4E3A;&#x5355;&#x4F4D;&#x7684;&#x6587;&#x4EF6;&#x5BB9;&#x91CF;   </span>
    blksize_t st_blksize<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* blocksize for file system I/O */</span> <span class="token comment" spellcheck="true">//&#x5305;&#x542B;&#x8BE5;&#x6587;&#x4EF6;&#x7684;&#x78C1;&#x76D8;&#x5757;&#x7684;&#x5927;&#x5C0F;   </span>
    blkcnt_t  st_blocks<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">/* number of 512B blocks allocated */</span> <span class="token comment" spellcheck="true">//&#x8BE5;&#x6587;&#x4EF6;&#x6240;&#x5360;&#x7684;&#x78C1;&#x76D8;&#x5757;  </span>
    time_t    st_atime<span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">/* time of last access */</span> <span class="token comment" spellcheck="true">//&#x6700;&#x540E;&#x4E00;&#x6B21;&#x8BBF;&#x95EE;&#x8BE5;&#x6587;&#x4EF6;&#x7684;&#x65F6;&#x95F4;   </span>
    time_t    st_mtime<span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">/* time of last modification */</span> <span class="token comment" spellcheck="true">//&#x6700;&#x540E;&#x4E00;&#x6B21;&#x4FEE;&#x6539;&#x8BE5;&#x6587;&#x4EF6;&#x7684;&#x65F6;&#x95F4;   </span>
    time_t    st_ctime<span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">/* time of last status change */</span> <span class="token comment" spellcheck="true">//&#x6700;&#x540E;&#x4E00;&#x6B21;&#x6539;&#x53D8;&#x8BE5;&#x6587;&#x4EF6;&#x72B6;&#x6001;&#x7684;&#x65F6;&#x95F4;   </span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x4EE5;&#x4E0A;3&#x4E2A;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x4E4B;&#x95F4;&#x4EC5;&#x6709;&#x7684;&#x533A;&#x522B;&#x5728;&#x4E8E;&#x5BF9;&#x6587;&#x4EF6;&#x7684;&#x63CF;&#x8FF0;&#x65B9;&#x5F0F;&#x4E0D;&#x540C;&#x3002;</p>
<ul>
<li>stat()&#x4F1A;&#x8FD4;&#x56DE;&#x6240;&#x547D;&#x540D;&#x6587;&#x4EF6;&#x7684;&#x76F8;&#x5173;&#x4FE1;&#x606F;&#x3002;</li>
<li>lstat()&#x4E0E;stat()&#x7C7B;&#x4F3C;&#xFF0C;&#x533A;&#x522B;&#x5728;&#x4E8E;&#x5982;&#x679C;&#x6587;&#x4EF6;&#x5C5E;&#x4E8E;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#xFF0C;&#x90A3;&#x4E48;&#x6240;&#x8FD4;&#x56DE;&#x7684;&#x4FE1;&#x606F;&#x9488;&#x5BF9;&#x7684;&#x662F;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#x81EA;&#x8EAB;&#xFF08;&#x800C;&#x975E;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#x6240;&#x6307;&#x5411;&#x7684;&#x6587;&#x4EF6;&#xFF09;&#x3002;</li>
<li>fstat()&#x5219;&#x4F1A;&#x8FD4;&#x56DE;&#x7531;&#x67D0;&#x4E2A;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x6240;&#x6307;&#x4EE3;&#x6587;&#x4EF6;&#x7684;&#x76F8;&#x5173;&#x4FE1;&#x606F;&#x3002;</li>
</ul>
<h2 id="&#x6587;&#x4EF6;&#x65F6;&#x95F4;&#x6233;"><a href="#&#x6587;&#x4EF6;&#x65F6;&#x95F4;&#x6233;" class="headerlink" title="&#x6587;&#x4EF6;&#x65F6;&#x95F4;&#x6233;"></a>&#x6587;&#x4EF6;&#x65F6;&#x95F4;&#x6233;</h2><p>&#x4F7F;&#x7528;utime()&#x6216;&#x4E0E;&#x4E4B;&#x76F8;&#x5173;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x96C6;&#x4E4B;&#x4E00;&#xFF0C;&#x53EF;&#x663E;&#x5F0F;&#x6539;&#x53D8;&#x5B58;&#x50A8;&#x4E8E;&#x6587;&#x4EF6;i&#x8282;&#x70B9;&#x4E2D;&#x7684;&#x6587;&#x4EF6;&#x4E0A;&#x6B21;&#x8BBF;&#x95EE;&#x65F6;&#x95F4;&#x6233;&#x548C;&#x4E0A;&#x6B21;&#x4FEE;&#x6539;&#x65F6;&#x95F4;&#x6233;&#x3002;&#x89E3;&#x538B;&#x6587;&#x4EF6;&#x65F6;&#xFF0C;tar(1)&#x548C;unzip(1)&#x4E4B;&#x7C7B;&#x7684;&#x7A0B;&#x5E8F;&#x4F1A;&#x4F7F;&#x7528;&#x8FD9;&#x4E9B;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x53BB;&#x91CD;&#x7F6E;&#x6587;&#x4EF6;&#x7684;&#x65F6;&#x95F4;&#x6233;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;utime.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">utime</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>pathname<span class="token punctuation">,</span><span class="token keyword">const</span> <span class="token keyword">struct</span> utimbuf <span class="token operator">*</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> utimbuf<span class="token punctuation">{</span>
    time_t actime<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//&#x4E0A;&#x6B21;&#x4FEE;&#x6539;&#x65F6;&#x95F4;</span>
    time_t modtime<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//&#x4FEE;&#x6539;&#x65F6;&#x95F4;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//&#x8BE5;&#x7ED3;&#x6784;&#x4E2D;&#x7684;&#x5B57;&#x6BB5;&#x8BB0;&#x5F55;&#x4E86;&#x81EA;Epoch&#xFF08;&#x89C1;10.1&#x8282;&#xFF09;&#x4EE5;&#x6765;&#x7684;&#x79D2;&#x6570;&#x3002;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x53C2;&#x6570;pathname&#x7528;&#x6765;&#x6807;&#x8BC6;&#x6B32;&#x4FEE;&#x6539;&#x65F6;&#x95F4;&#x7684;&#x6587;&#x4EF6;&#x3002;&#x82E5;&#x8BE5;&#x53C2;&#x6570;&#x4E3A;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#xFF0C;&#x5219;&#x4F1A;&#x8FDB;&#x4E00;&#x6B65;&#x89E3;&#x9664;&#x5F15;&#x7528;&#x3002;&#x53C2;&#x6570;buf&#x65E2;&#x53EF;&#x4E3A;NULL&#xFF0C;&#x4E5F;&#x53EF;&#x4E3A;&#x6307;&#x5411;utimbuf&#x7ED3;&#x6784;&#x7684;&#x6307;&#x9488;&#x3002;<br>utime()&#x7684;&#x8FD0;&#x4F5C;&#x65B9;&#x5F0F;&#x5219;&#x89C6;&#x4EE5;&#x4E0B;&#x4E24;&#x79CD;&#x4E0D;&#x540C;&#x60C5;&#x51B5;&#x800C;&#x5B9A;&#x3002;</p>
<ul>
<li>&#x5982;&#x679C;buf&#x4E3A;NULL&#xFF0C;&#x90A3;&#x4E48;&#x4F1A;&#x5C06;&#x6587;&#x4EF6;&#x7684;&#x4E0A;&#x6B21;&#x8BBF;&#x95EE;&#x548C;&#x4FEE;&#x6539;&#x65F6;&#x95F4;&#x540C;&#x65F6;&#x7F6E;&#x4E3A;&#x5F53;&#x524D;&#x65F6;&#x95F4;&#x3002;&#x8FD9;&#x65F6;&#xFF0C;&#x8FDB;&#x7A0B;&#x8981;&#x4E48;&#x5177;&#x6709;&#x7279;&#x6743;&#x7EA7;&#x522B;&#xFF08;CAP_FOWNER&#x6216;CAP_DAC_OVERRIDE&#xFF09;&#xFF0C;&#x8981;&#x4E48;&#x5176;&#x6709;&#x6548;&#x7528;&#x6237;ID&#x4E0E;&#x8BE5;&#x6587;&#x4EF6;&#x7684;&#x7528;&#x6237;ID&#xFF08;&#x5C5E;&#x4E3B;&#xFF09;&#x76F8;&#x5339;&#x914D;&#xFF0C;&#x4E14;&#x5BF9;&#x6587;&#x4EF6;&#x6709;&#x5199;&#x6743;&#x9650;&#xFF08;&#x903B;&#x8F91;&#x4E0A;&#xFF0C;&#x5BF9;&#x6587;&#x4EF6;&#x62E5;&#x6709;&#x5199;&#x6743;&#x9650;&#x7684;&#x8FDB;&#x7A0B;&#x5728;&#x8C03;&#x7528;&#x5176;&#x4ED6;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x65F6;&#xFF0C;&#x53EF;&#x80FD;&#x4F1A;&#x4E8E;&#x65E0;&#x610F;&#x95F4;&#x6539;&#x53D8;&#x8FD9;&#x4E9B;&#x65F6;&#x95F4;&#x6233;&#xFF09;&#x3002;&#xFF08;&#x51C6;&#x786E;&#x5730;&#x8BF4;&#xFF0C;&#x5982;9.5&#x8282;&#x6240;&#x8FF0;&#xFF0C;&#x5728;Linux&#x7CFB;&#x7EDF;&#x4E2D;&#xFF0C;&#x7528;&#x6765;&#x4E0E;&#x6587;&#x4EF6;&#x7528;&#x6237;ID&#x505A;&#x6BD4;&#x5BF9;&#x7684;&#x662F;&#x8FDB;&#x7A0B;&#x7684;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x7528;&#x6237;ID&#xFF0C;&#x800C;&#x975E;&#x5176;&#x6709;&#x6548;&#x7528;&#x6237;ID&#x3002;&#xFF09;</li>
<li>&#x82E5;&#x5C06;buf&#x6307;&#x5B9A;&#x4E3A;&#x6307;&#x5411;utimbuf&#x7ED3;&#x6784;&#x7684;&#x6307;&#x9488;&#xFF0C;&#x5219;&#x4F1A;&#x4F7F;&#x7528;&#x8BE5;&#x7ED3;&#x6784;&#x7684;&#x76F8;&#x5E94;&#x5B57;&#x6BB5;&#x53BB;&#x66F4;&#x65B0;&#x6587;&#x4EF6;&#x7684;&#x4E0A;&#x6B21;&#x8BBF;&#x95EE;&#x548C;&#x4FEE;&#x6539;&#x65F6;&#x95F4;&#x3002;&#x6B64;&#x65F6;&#xFF0C;&#x8981;&#x4E48;&#x8C03;&#x7528;&#x7A0B;&#x5E8F;&#x5177;&#x6709;&#x7279;&#x6743;&#x7EA7;&#x522B;&#xFF08;CAP_FOWNER&#xFF09;&#xFF0C;&#x8981;&#x4E48;&#x8FDB;&#x7A0B;&#x7684;&#x6709;&#x6548;&#x7528;&#x6237;ID&#x5FC5;&#x9700;&#x5339;&#x914D;&#x6587;&#x4EF6;&#x7684;&#x7528;&#x6237;ID&#xFF08;&#x4EC5;&#x5BF9;&#x6587;&#x4EF6;&#x62E5;&#x6709;&#x5199;&#x6743;&#x9650;&#x662F;&#x4E0D;&#x591F;&#x7684;&#xFF09;&#x3002;</li>
</ul>
<p>inux&#x8FD8;&#x63D0;&#x4F9B;&#x4E86;&#x6E90;&#x4E8E;BSD&#x7684;utimes()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF0C;&#x5176;&#x529F;&#x7528;&#x7C7B;&#x4F3C;&#x4E8E;utime()&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;sys/time.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">utimes</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>pathname<span class="token punctuation">,</span><span class="token keyword">const</span> <span class="token keyword">struct</span> timeval tv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>utime()&#x4E0E; utimes()&#x4E4B;&#x95F4;&#x6700;&#x663E;&#x8457;&#x7684;&#x5DEE;&#x522B;&#x5728;&#x4E8E;&#x540E;&#x8005;&#x53EF;&#x4EE5;&#x4EE5;&#x5FAE;&#x79D2;&#x7EA7;&#x7CBE;&#x5EA6;&#x6765;&#x6307;&#x5B9A;&#x65F6;&#x95F4;&#x503C;.</p>
<p>futimes()&#x548C;lutimes()&#x5E93;&#x51FD;&#x6570;&#x7684;&#x529F;&#x80FD;&#x4E0E;utimes()&#x5927;&#x540C;&#x5C0F;&#x5F02;&#x3002;&#x524D;&#x4E24;&#x8005;&#x4E0E;&#x540E;&#x8005;&#x4E4B;&#x95F4;&#x7684;&#x5DEE;&#x5F02;&#x5728;&#x4E8E;&#xFF0C;&#x7528;&#x6765;&#x6307;&#x5B9A;&#x8981;&#x66F4;&#x6539;&#x65F6;&#x95F4;&#x6233;&#x6587;&#x4EF6;&#x7684;&#x53C2;&#x6570;&#x4E0D;&#x540C;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;sys/time.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">futimes</span><span class="token punctuation">(</span><span class="token keyword">int</span> fd<span class="token punctuation">,</span><span class="token keyword">const</span> <span class="token keyword">struct</span> timeval tv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">lutimes</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>pathname<span class="token punctuation">,</span><span class="token keyword">const</span> <span class="token keyword">struct</span> timeval tv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x8C03;&#x7528;futimes()&#x65F6;&#xFF0C;&#x4F7F;&#x7528;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;fd&#x6765;&#x6307;&#x5B9A;&#x6587;&#x4EF6;&#x3002;<br>&#x8C03;&#x7528;lutimes()&#x65F6;&#xFF0C;&#x4F7F;&#x7528;&#x8DEF;&#x5F84;&#x540D;&#x6765;&#x6307;&#x5B9A;&#x6587;&#x4EF6;&#xFF0C;&#x6709;&#x522B;&#x4E8E;&#x8C03;&#x7528;utimes()&#x7684;&#x662F;&#xFF1A;&#x5BF9;&#x4E8E;lutimes()&#xFF0C;&#x82E5;&#x8DEF;&#x5F84;&#x540D;&#x6307;&#x5411;&#x4E00;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#xFF0C;&#x5219;&#x8C03;&#x7528;&#x4E0D;&#x4F1A;&#x5BF9;&#x8BE5;&#x94FE;&#x63A5;&#x8FDB;&#x884C;&#x89E3;&#x5F15;&#x7528;&#xFF0C;&#x800C;&#x662F;&#x66F4;&#x6539;&#x94FE;&#x63A5;&#x81EA;&#x8EAB;&#x7684;&#x65F6;&#x95F4;&#x6233;&#x3002;</p>
<p>utimensat()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x4F1A;&#x628A;&#x7531;pathname&#x6307;&#x5B9A;&#x6587;&#x4EF6;&#x7684;&#x65F6;&#x95F4;&#x6233;&#x66F4;&#x65B0;&#x4E3A;&#x7531;&#x6570;&#x7EC4;times&#x6307;&#x5B9A;&#x7684;&#x503C;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;sys/stat.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">utimensat</span><span class="token punctuation">(</span><span class="token keyword">int</span> dirfd<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>pathname<span class="token punctuation">,</span><span class="token keyword">const</span> <span class="token keyword">struct</span> timespectimes<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> intflags<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">futimens</span><span class="token punctuation">(</span><span class="token keyword">int</span> fd<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">struct</span> timespectimes<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h2 id="&#x6587;&#x4EF6;&#x5C5E;&#x4E3B;"><a href="#&#x6587;&#x4EF6;&#x5C5E;&#x4E3B;" class="headerlink" title="&#x6587;&#x4EF6;&#x5C5E;&#x4E3B;"></a>&#x6587;&#x4EF6;&#x5C5E;&#x4E3B;</h2><p>&#x6BCF;&#x4E2A;&#x6587;&#x4EF6;&#x90FD;&#x6709;&#x4E00;&#x4E2A;&#x4E0E;&#x4E4B;&#x5173;&#x8054;&#x7684;&#x7528;&#x6237;ID&#xFF08;UID&#xFF09;&#x548C;&#x7EC4;ID&#xFF08;GID&#xFF09;&#xFF0C;&#x7C4D;&#x6B64;&#x53EF;&#x4EE5;&#x5224;&#x5B9A;&#x6587;&#x4EF6;&#x7684;&#x5C5E;&#x4E3B;&#x548C;&#x5C5E;&#x7EC4;&#x3002;</p>
<h3 id="&#x6539;&#x53D8;&#x6587;&#x4EF6;&#x5C5E;&#x4E3B;"><a href="#&#x6539;&#x53D8;&#x6587;&#x4EF6;&#x5C5E;&#x4E3B;" class="headerlink" title="&#x6539;&#x53D8;&#x6587;&#x4EF6;&#x5C5E;&#x4E3B;"></a>&#x6539;&#x53D8;&#x6587;&#x4EF6;&#x5C5E;&#x4E3B;</h3><p>&#x7CFB;&#x7EDF;&#x8C03;&#x7528;chown()&#x3001;lchown()&#x548C;fchown()&#x53EF;&#x7528;&#x6765;&#x6539;&#x53D8;&#x6587;&#x4EF6;&#x7684;&#x5C5E;&#x4E3B;&#xFF08;&#x7528;&#x6237;ID&#xFF09;&#x548C;&#x5C5E;&#x7EC4;&#xFF08;&#x7EC4;ID&#xFF09;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;unistd.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">chown</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>pathname<span class="token punctuation">,</span>uid_t owner<span class="token punctuation">,</span>gid_t group<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token macro property">#<span class="token directive keyword">define</span> _XOPEN_SOURCE 500</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;unistd.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">lchown</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>pathname <span class="token punctuation">,</span> uid_t owner<span class="token punctuation">,</span>gid_t group<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">fchown</span><span class="token punctuation">(</span><span class="token keyword">int</span> fd<span class="token punctuation">,</span>uid_t owner<span class="token punctuation">,</span>gid_t group<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>chown()&#x6539;&#x53D8;&#x7531;pathname&#x53C2;&#x6570;&#x547D;&#x540D;&#x6587;&#x4EF6;&#x7684;&#x6240;&#x6709;&#x6743;&#x3002;</li>
<li>lchown()&#x7528;&#x9014;&#x4E0E;chown()&#x76F8;&#x540C;&#xFF0C;&#x4E0D;&#x540C;&#x4E4B;&#x5904;&#x5728;&#x4E8E;&#x82E5;&#x53C2;&#x6570;pathname&#x4E3A;&#x4E00;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#xFF0C;&#x5219;&#x5C06;&#x4F1A;&#x6539;&#x53D8;&#x94FE;&#x63A5;&#x6587;&#x4EF6;&#x672C;&#x8EAB;&#x7684;&#x6240;&#x6709;&#x6743;&#xFF0C;&#x800C;&#x4E0E;&#x8BE5;&#x94FE;&#x63A5;&#x6240;&#x6307;&#x4EE3;&#x7684;&#x6587;&#x4EF6;&#x65E0;&#x5E72;&#x3002;</li>
<li>fchown()&#x4E5F;&#x4F1A;&#x6539;&#x53D8;&#x6587;&#x4EF6;&#x7684;&#x6240;&#x6709;&#x6743;&#xFF0C;&#x53EA;&#x662F;&#x6587;&#x4EF6;&#x7531;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;fd&#x6240;&#x5F15;&#x7528;&#x3002;</li>
</ul>
<h2 id="&#x6587;&#x4EF6;&#x6743;&#x9650;"><a href="#&#x6587;&#x4EF6;&#x6743;&#x9650;" class="headerlink" title="&#x6587;&#x4EF6;&#x6743;&#x9650;"></a>&#x6587;&#x4EF6;&#x6743;&#x9650;</h2><h3 id="&#x666E;&#x901A;&#x6587;&#x4EF6;&#x7684;&#x6743;&#x9650;"><a href="#&#x666E;&#x901A;&#x6587;&#x4EF6;&#x7684;&#x6743;&#x9650;" class="headerlink" title="&#x666E;&#x901A;&#x6587;&#x4EF6;&#x7684;&#x6743;&#x9650;"></a>&#x666E;&#x901A;&#x6587;&#x4EF6;&#x7684;&#x6743;&#x9650;</h3><p>&#x6587;&#x4EF6;&#x6743;&#x9650;&#x63A9;&#x7801;&#x5206;&#x4E3A;3&#x7C7B;&#x3002;</p>
<ul>
<li>Owner&#xFF08;&#x4EA6;&#x79F0;&#x4E3A;user&#xFF09;&#xFF1A;&#x6388;&#x4E88;&#x6587;&#x4EF6;&#x5C5E;&#x4E3B;&#x7684;&#x6743;&#x9650;&#x3002;</li>
<li>Group&#xFF1A;&#x6388;&#x4E88;&#x6587;&#x4EF6;&#x5C5E;&#x7EC4;&#x6210;&#x5458;&#x7528;&#x6237;&#x7684;&#x6743;&#x9650;&#x3002;</li>
<li>Other&#xFF1A;&#x6388;&#x4E88;&#x5176;&#x4ED6;&#x7528;&#x6237;&#x7684;&#x6743;&#x9650;&#x3002;</li>
</ul>
<p>&#x53EF;&#x4E3A;&#x6BCF;&#x4E00;&#x7C7B;&#x7528;&#x6237;&#x6388;&#x4E88;&#x7684;&#x6743;&#x9650;&#x5982;&#x4E0B;&#x6240;&#x793A;&#x3002;</p>
<ul>
<li>Read&#xFF1A;&#x53EF;&#x9605;&#x8BFB;&#x6587;&#x4EF6;&#x7684;&#x5185;&#x5BB9;&#x3002;</li>
<li>Write&#xFF1A;&#x53EF;&#x66F4;&#x6539;&#x6587;&#x4EF6;&#x7684;&#x5185;&#x5BB9;&#x3002;</li>
<li>Execute&#xFF1A;&#x53EF;&#x4EE5;&#x6267;&#x884C;&#x6587;&#x4EF6;&#xFF08;&#x4EA6;&#x5373;&#xFF0C;&#x6587;&#x4EF6;&#x662F;&#x7A0B;&#x5E8F;&#x6216;&#x811A;&#x672C;&#xFF09;&#x3002;&#x8981;&#x6267;&#x884C;&#x811A;&#x672C;&#x6587;&#x4EF6;&#xFF08;&#x6BD4;&#x5982;&#xFF0C;&#x4E00;&#x4E2A;bash&#x811A;&#x672C;&#xFF09;&#xFF0C;&#x9700;&#x540C;&#x65F6;&#x5177;&#x5907;&#x8BFB;&#x6743;&#x9650;&#x548C;&#x6267;&#x884C;&#x6743;&#x9650;&#x3002;</li>
</ul>
<p>&#x5934;&#x6587;&#x4EF6;<code>&lt;sys/stat.h&gt;</code>&#x5B9A;&#x4E49;&#x4E86;&#x53EF;&#x4E0E;stat&#x7ED3;&#x6784;&#x4E2D;st_mode&#x76F8;&#x4E0E;&#xFF08;&amp;&#xFF09;&#x7684;&#x5E38;&#x91CF;&#xFF0C;&#x7528;&#x4E8E;&#x68C0;&#x67E5;&#x7279;&#x5B9A;&#x6743;&#x9650;&#x4F4D;&#x7F6E;&#x4F4D;&#x4E0E;&#x5426;&#x3002;</p>
<h3 id="&#x76EE;&#x5F55;&#x6743;&#x9650;"><a href="#&#x76EE;&#x5F55;&#x6743;&#x9650;" class="headerlink" title="&#x76EE;&#x5F55;&#x6743;&#x9650;"></a>&#x76EE;&#x5F55;&#x6743;&#x9650;</h3><p>&#x76EE;&#x5F55;&#x4E0E;&#x6587;&#x4EF6;&#x62E5;&#x6709;&#x76F8;&#x540C;&#x7684;&#x6743;&#x9650;&#x65B9;&#x6848;&#xFF0C;&#x53EA;&#x662F;&#x5BF9;3&#x79CD;&#x6743;&#x9650;&#x7684;&#x542B;&#x4E49;&#x53E6;&#x6709;&#x6240;&#x6307;&#x3002;</p>
<ul>
<li>&#x8BFB;&#x6743;&#x9650;&#xFF1A;&#x53EF;&#x5217;&#x51FA;&#xFF08;&#x6BD4;&#x5982;&#xFF0C;&#x901A;&#x8FC7;ls&#x547D;&#x4EE4;&#xFF09;&#x76EE;&#x5F55;&#x4E4B;&#x4E0B;&#x7684;&#x5185;&#x5BB9;&#xFF08;&#x5373;&#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x6587;&#x4EF6;&#x540D;&#xFF09;&#x3002;</li>
<li>&#x5199;&#x6743;&#x9650;&#xFF1A;&#x53EF;&#x5728;&#x76EE;&#x5F55;&#x5185;&#x521B;&#x5EFA;&#x3001;&#x5220;&#x9664;&#x6587;&#x4EF6;&#x3002;&#x6CE8;&#x610F;&#xFF0C;&#x8981;&#x5220;&#x9664;&#x6587;&#x4EF6;&#xFF0C;&#x5BF9;&#x6587;&#x4EF6;&#x672C;&#x8EAB;&#x65E0;&#x9700;&#x6709;&#x4EFB;&#x4F55;&#x6743;&#x9650;&#x3002;</li>
<li>&#x53EF;&#x6267;&#x884C;&#x6743;&#x9650;&#xFF1A;&#x53EF;&#x8BBF;&#x95EE;&#x76EE;&#x5F55;&#x4E2D;&#x7684;&#x6587;&#x4EF6;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x6709;&#x65F6;&#x4E5F;&#x5C06;&#x5BF9;&#x76EE;&#x5F55;&#x7684;&#x6267;&#x884C;&#x6743;&#x9650;&#x79F0;&#x4E3A;search&#xFF08;&#x641C;&#x7D22;&#xFF09;&#x6743;&#x9650;&#x3002;</li>
</ul>
<h3 id="&#x66F4;&#x6539;&#x6587;&#x4EF6;&#x6743;&#x9650;&#xFF1A;chmod-&#x548C;fchmod"><a href="#&#x66F4;&#x6539;&#x6587;&#x4EF6;&#x6743;&#x9650;&#xFF1A;chmod-&#x548C;fchmod" class="headerlink" title="&#x66F4;&#x6539;&#x6587;&#x4EF6;&#x6743;&#x9650;&#xFF1A;chmod()&#x548C;fchmod()"></a>&#x66F4;&#x6539;&#x6587;&#x4EF6;&#x6743;&#x9650;&#xFF1A;chmod()&#x548C;fchmod()</h3><p>&#x53EF;&#x5229;&#x7528;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;chmod()&#x548C;fchmod()&#x53BB;&#x4FEE;&#x6539;&#x6587;&#x4EF6;&#x6743;&#x9650;&#x3002;</p>
<h2 id="&#x76EE;&#x5F55;&#x4E0E;&#x94FE;&#x63A5;"><a href="#&#x76EE;&#x5F55;&#x4E0E;&#x94FE;&#x63A5;" class="headerlink" title="&#x76EE;&#x5F55;&#x4E0E;&#x94FE;&#x63A5;"></a>&#x76EE;&#x5F55;&#x4E0E;&#x94FE;&#x63A5;</h2><h3 id="&#x66F4;&#x6539;&#x6587;&#x4EF6;&#x540D;&#xFF1A;rename"><a href="#&#x66F4;&#x6539;&#x6587;&#x4EF6;&#x540D;&#xFF1A;rename" class="headerlink" title="&#x66F4;&#x6539;&#x6587;&#x4EF6;&#x540D;&#xFF1A;rename()"></a>&#x66F4;&#x6539;&#x6587;&#x4EF6;&#x540D;&#xFF1A;rename()</h3><p>&#x501F;&#x52A9;&#x4E8E;rename()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF0C;&#x65E2;&#x53EF;&#x4EE5;&#x91CD;&#x547D;&#x540D;&#x6587;&#x4EF6;&#xFF0C;&#x53C8;&#x53EF;&#x4EE5;&#x5C06;&#x6587;&#x4EF6;&#x79FB;&#x81F3;&#x540C;&#x4E00;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x4E2D;&#x7684;&#x53E6;&#x4E00;&#x76EE;&#x5F55;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">rename</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>oldpath<span class="token punctuation">,</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>newpath<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x8C03;&#x7528;&#x4F1A;&#x5C06;&#x73B0;&#x6709;&#x7684;&#x4E00;&#x4E2A;&#x8DEF;&#x5F84;&#x540D;oldpath&#x91CD;&#x547D;&#x540D;&#x4E3A;newpath&#x53C2;&#x6570;&#x6240;&#x6307;&#x5B9A;&#x7684;&#x8DEF;&#x5F84;&#x540D;&#x3002;<br>rename()&#x8C03;&#x7528;&#x4EC5;&#x64CD;&#x4F5C;&#x76EE;&#x5F55;&#x6761;&#x76EE;&#xFF0C;&#x800C;&#x4E0D;&#x79FB;&#x52A8;&#x6587;&#x4EF6;&#x6570;&#x636E;&#x3002;&#x6539;&#x540D;&#x65E2;&#x4E0D;&#x5F71;&#x54CD;&#x6307;&#x5411;&#x8BE5;&#x6587;&#x4EF6;&#x7684;&#x5176;&#x4ED6;&#x786C;&#x94FE;&#x63A5;&#xFF0C;&#x4E5F;&#x4E0D;&#x5F71;&#x54CD;&#x6301;&#x6709;&#x8BE5;&#x6587;&#x4EF6;&#x6253;&#x5F00;&#x63CF;&#x8FF0;&#x7B26;&#x7684;&#x4EFB;&#x4F55;&#x8FDB;&#x7A0B;&#xFF0C;&#x56E0;&#x4E3A;&#x8FD9;&#x4E9B;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x6307;&#x5411;&#x7684;&#x662F;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#xFF0C;&#xFF08;&#x5728;&#x8C03;&#x7528;open()&#x4E4B;&#x540E;&#xFF09;&#x4E0E;&#x6587;&#x4EF6;&#x540D;&#x5E76;&#x65E0;&#x74DC;&#x845B;&#x3002;</p>
<p>&#x4EE5;&#x4E0B;&#x89C4;&#x5219;&#x9002;&#x7528;&#x4E0E;&#x5BF9;rename()&#x7684;&#x8C03;&#x7528;&#x3002;</p>
<ul>
<li>&#x82E5;newpath&#x5DF2;&#x7ECF;&#x5B58;&#x5728;&#xFF0C;&#x5219;&#x5C06;&#x5176;&#x8986;&#x76D6;&#x3002;</li>
<li>&#x82E5;newpath&#x4E0E;oldpath&#x6307;&#x5411;&#x540C;&#x4E00;&#x6587;&#x4EF6;&#xFF0C;&#x5219;&#x4E0D;&#x53D1;&#x751F;&#x53D8;&#x5316;&#xFF08;&#x4E14;&#x8C03;&#x7528;&#x6210;&#x529F;&#xFF09;&#x3002;</li>
</ul>
<h3 id="&#x4F7F;&#x7528;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#xFF1A;symlink-&#x548C;readlink"><a href="#&#x4F7F;&#x7528;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#xFF1A;symlink-&#x548C;readlink" class="headerlink" title="&#x4F7F;&#x7528;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#xFF1A;symlink()&#x548C;readlink()"></a>&#x4F7F;&#x7528;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#xFF1A;symlink()&#x548C;readlink()</h3><p>&#x73B0;&#x5728;&#x6765;&#x770B;&#x770B;&#x7528;&#x4E8E;&#x521B;&#x5EFA;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#xFF0C;&#x4EE5;&#x53CA;&#x68C0;&#x67E5;&#x5176;&#x5185;&#x5BB9;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x3002;<br>symlink()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x4F1A;&#x9488;&#x5BF9;&#x7531;filepath&#x6240;&#x6307;&#x5B9A;&#x7684;&#x8DEF;&#x5F84;&#x540D;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#x2014;&#x2014;linkpath&#x3002;&#xFF08;&#x60F3;&#x79FB;&#x9664;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#xFF0C;&#x9700;&#x4F7F;&#x7528;unlink()&#x8C03;&#x7528;&#x3002;&#xFF09;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;unistd.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">symlink</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>filepath<span class="token punctuation">,</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>linkpath<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x82E5;linkpath&#x4E2D;&#x7ED9;&#x5B9A;&#x7684;&#x8DEF;&#x5F84;&#x540D;&#x5DF2;&#x7136;&#x5B58;&#x5728;&#xFF0C;&#x5219;&#x8C03;&#x7528;&#x5931;&#x8D25;&#xFF08;&#x4E14;&#x5C06;errno&#x7F6E;&#x4E3A;EEXIST&#xFF09;&#x3002;&#x7531;filepath&#x6307;&#x5B9A;&#x7684;&#x8DEF;&#x5F84;&#x540D;&#x53EF;&#x4EE5;&#x662F;&#x7EDD;&#x5BF9;&#x8DEF;&#x5F84;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x662F;&#x76F8;&#x5BF9;&#x8DEF;&#x5F84;&#x3002;</p>
<p>&#x5982;&#x679C;&#x6307;&#x5B9A;&#x4E00;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#x4F5C;&#x4E3A;open()&#x8C03;&#x7528;&#x7684;pathname&#x53C2;&#x6570;&#xFF0C;&#x90A3;&#x4E48;&#x5C06;&#x6253;&#x5F00;&#x94FE;&#x63A5;&#x6307;&#x5411;&#x7684;&#x6587;&#x4EF6;&#x3002;&#x6709;&#x65F6;&#xFF0C;&#x5012;&#x5B81;&#x613F;&#x83B7;&#x53D6;&#x94FE;&#x63A5;&#x672C;&#x8EAB;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x5373;&#x5176;&#x6240;&#x6307;&#x5411;&#x7684;&#x8DEF;&#x5F84;&#x540D;&#x3002;&#x8FD9;&#x6B63;&#x662F;readlink()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x7684;&#x672C;&#x804C;&#x5DE5;&#x4F5C;&#xFF0C;&#x5C06;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x4E00;&#x4EFD;&#x526F;&#x672C;&#x7F6E;&#x4E8E;buffer&#x6307;&#x5411;&#x7684;&#x5B57;&#x7B26;&#x6570;&#x7EC4;&#x4E2D;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;unistd.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">readlink</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>pathname<span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>buffer<span class="token punctuation">,</span>size_t bufsize<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>bufsiz&#x662F;&#x4E00;&#x4E2A;&#x6574;&#x578B;&#x53C2;&#x6570;&#xFF0C;&#x7528;&#x4EE5;&#x544A;&#x77E5;readlink()&#x8C03;&#x7528;buffer&#x4E2D;&#x7684;&#x53EF;&#x7528;&#x5B57;&#x8282;&#x6570;&#x3002;<br>&#x5982;&#x679C;&#x4E00;&#x5207;&#x987A;&#x5229;&#xFF0C;readlink()&#x5C06;&#x8FD4;&#x56DE;&#x5B9E;&#x9645;&#x653E;&#x5165;buffer&#x4E2D;&#x7684;&#x5B57;&#x8282;&#x6570;&#x3002;&#x82E5;&#x94FE;&#x63A5;&#x957F;&#x5EA6;&#x8D85;&#x8FC7;bufsiz&#xFF0C;&#x5219;&#x7F6E;&#x4E8E;buffer&#x4E2D;&#x7684;&#x662F;&#x7ECF;&#x622A;&#x65AD;&#x5904;&#x7406;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF08;&#x5E76;&#x8FD4;&#x56DE;&#x5B57;&#x7B26;&#x4E32;&#x5927;&#x5C0F;&#xFF0C;&#x4EA6;&#x5373;bufsiz&#xFF09;&#x3002;</p>
<h3 id="&#x521B;&#x5EFA;&#x548C;&#x79FB;&#x9664;&#x76EE;&#x5F55;&#xFF1A;mkdir-&#x548C;rmdir"><a href="#&#x521B;&#x5EFA;&#x548C;&#x79FB;&#x9664;&#x76EE;&#x5F55;&#xFF1A;mkdir-&#x548C;rmdir" class="headerlink" title="&#x521B;&#x5EFA;&#x548C;&#x79FB;&#x9664;&#x76EE;&#x5F55;&#xFF1A;mkdir()&#x548C;rmdir()"></a>&#x521B;&#x5EFA;&#x548C;&#x79FB;&#x9664;&#x76EE;&#x5F55;&#xFF1A;mkdir()&#x548C;rmdir()</h3><p>mkdir()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x76EE;&#x5F55;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;sys/stat.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> pathname<span class="token punctuation">,</span>mode_t mode<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>pathname&#x53C2;&#x6570;&#x6307;&#x5B9A;&#x4E86;&#x65B0;&#x76EE;&#x5F55;&#x7684;&#x8DEF;&#x5F84;&#x540D;&#x3002;&#x8BE5;&#x8DEF;&#x5F84;&#x540D;&#x53EF;&#x4EE5;&#x662F;&#x76F8;&#x5BF9;&#x8DEF;&#x5F84;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x662F;&#x7EDD;&#x5BF9;&#x8DEF;&#x5F84;&#x3002;&#x82E5;&#x5177;&#x6709;&#x8BE5;&#x8DEF;&#x5F84;&#x540D;&#x7684;&#x6587;&#x4EF6;&#x5DF2;&#x7ECF;&#x5B58;&#x5728;&#xFF0C;&#x5219;&#x8C03;&#x7528;&#x5931;&#x8D25;&#x5E76;&#x5C06;errno&#x7F6E;&#x4E3A;EEXIST&#x3002;<br>mode&#x53C2;&#x6570;&#x6307;&#x5B9A;&#x4E86;&#x65B0;&#x76EE;&#x5F55;&#x7684;&#x6743;&#x9650;&#x3002;&#x5BF9;&#x8BE5;&#x4F4D;&#x63A9;&#x7801;&#x503C;&#x7684;&#x6307;&#x5B9A;&#x65B9;&#x5F0F;&#x65E2;&#x53EF;&#x4EE5;&#x4E0E;open()&#x8C03;&#x7528;&#x76F8;&#x540C;,&#x4E5F;&#x53EF;&#x76F4;&#x63A5;&#x8D4B;&#x4E88;&#x516B;&#x8FDB;&#x5236;&#x6570;&#x503C;&#x3002;<br>mkdir()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x6240;&#x521B;&#x5EFA;&#x7684;&#x4EC5;&#x4EC5;&#x662F;&#x8DEF;&#x5F84;&#x540D;&#x4E2D;&#x7684;&#x6700;&#x540E;&#x4E00;&#x90E8;&#x5206;&#x3002;&#x6362;&#x8A00;&#x4E4B;&#xFF0C;mkdir(&#x201C;aaa/bbb/ccc&#x201D;&#xFF0C;mode)&#x4EC5;&#x5F53;&#x76EE;&#x5F55;aaa&#x548C;aaa/bbb&#x5DF2;&#x7ECF;&#x5B58;&#x5728;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x624D;&#x4F1A;&#x6210;&#x529F;&#x3002;</p>
<p>rmdir()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x79FB;&#x9664;&#x7531;pathname&#x6307;&#x5B9A;&#x7684;&#x76EE;&#x5F55;&#xFF0C;&#x8BE5;&#x76EE;&#x5F55;&#x53EF;&#x4EE5;&#x662F;&#x7EDD;&#x5BF9;&#x8DEF;&#x5F84;&#x540D;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x662F;&#x76F8;&#x5BF9;&#x8DEF;&#x5F84;&#x540D;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;sys/stat.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">rmdir</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> pathname<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x8981;&#x4F7F;rmdir()&#x8C03;&#x7528;&#x6210;&#x529F;&#xFF0C;&#x5219;&#x8981;&#x5220;&#x9664;&#x7684;&#x76EE;&#x5F55;&#x5FC5;&#x987B;&#x4E3A;&#x7A7A;&#x3002;&#x5982;&#x679C;pathname&#x7684;&#x6700;&#x540E;&#x4E00;&#x90E8;&#x5206;&#x4E3A;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#xFF0C;&#x90A3;&#x4E48;rmdir()&#x8C03;&#x7528;&#x5C06;&#x4E0D;&#x5BF9;&#x5176;&#x8FDB;&#x884C;&#x89E3;&#x5F15;&#x7528;&#x64CD;&#x4F5C;&#xFF0C;&#x5E76;&#x8FD4;&#x56DE;&#x9519;&#x8BEF;&#xFF0C;&#x540C;&#x65F6;&#x5C06;errno&#x7F6E;&#x4E3A;ENOTDIR&#x3002;</p>
<h3 id="&#x79FB;&#x9664;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x6216;&#x76EE;&#x5F55;&#xFF1A;remove"><a href="#&#x79FB;&#x9664;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x6216;&#x76EE;&#x5F55;&#xFF1A;remove" class="headerlink" title="&#x79FB;&#x9664;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x6216;&#x76EE;&#x5F55;&#xFF1A;remove()"></a>&#x79FB;&#x9664;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x6216;&#x76EE;&#x5F55;&#xFF1A;remove()</h3><p>remove()&#x5E93;&#x51FD;&#x6570;&#x79FB;&#x9664;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x6216;&#x4E00;&#x4E2A;&#x7A7A;&#x76EE;&#x5F55;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;sys/stat.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> pathname<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="&#x8FDB;&#x7A0B;&#x7684;&#x5F53;&#x524D;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;"><a href="#&#x8FDB;&#x7A0B;&#x7684;&#x5F53;&#x524D;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;" class="headerlink" title="&#x8FDB;&#x7A0B;&#x7684;&#x5F53;&#x524D;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;"></a>&#x8FDB;&#x7A0B;&#x7684;&#x5F53;&#x524D;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;</h3><p>&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7684;&#x5F53;&#x524D;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;&#xFF08;current working directory&#xFF09;&#x5B9A;&#x4E49;&#x4E86;&#x8BE5;&#x8FDB;&#x7A0B;&#x89E3;&#x6790;&#x76F8;&#x5BF9;&#x8DEF;&#x5F84;&#x540D;&#x7684;&#x8D77;&#x70B9;&#x3002;&#x65B0;&#x8FDB;&#x7A0B;&#x7684;&#x5F53;&#x524D;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;&#x7EE7;&#x627F;&#x81EA;&#x5176;&#x7236;&#x8FDB;&#x7A0B;&#x3002;<br>&#x8FDB;&#x7A0B;&#x53EF;&#x4F7F;&#x7528;getcwd()&#x6765;&#x83B7;&#x53D6;&#x5F53;&#x524D;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;unistd.h&gt;</span></span>
<span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">getcwd</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>cwdbuf<span class="token punctuation">,</span>size_t size<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h1 id="&#x76D1;&#x63A7;&#x6587;&#x4EF6;&#x4E8B;&#x4EF6;"><a href="#&#x76D1;&#x63A7;&#x6587;&#x4EF6;&#x4E8B;&#x4EF6;" class="headerlink" title="&#x76D1;&#x63A7;&#x6587;&#x4EF6;&#x4E8B;&#x4EF6;"></a>&#x76D1;&#x63A7;&#x6587;&#x4EF6;&#x4E8B;&#x4EF6;</h1><p>&#x5F53;&#x4E00;&#x7EC4;&#x53D7;&#x76D1;&#x63A7;&#x7684;&#x6587;&#x4EF6;&#x6216;&#x76EE;&#x5F55;&#x6709;&#x4E8B;&#x4EF6;&#x53D1;&#x751F;&#xFF08;&#x5BF9;&#x6587;&#x4EF6;&#x7684;&#x6253;&#x5F00;&#x3001;&#x5173;&#x95ED;&#x3001;&#x521B;&#x5EFA;&#x3001;&#x5220;&#x9664;&#x3001;&#x4FEE;&#x6539;&#x4EE5;&#x53CA;&#x91CD;&#x547D;&#x540D;&#x7B49;&#x64CD;&#x4F5C;&#xFF09;&#x65F6;&#xFF0C;Linux&#x4E13;&#x6709;&#x7684;inotify&#x673A;&#x5236;&#x53EF;&#x8BA9;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x83B7;&#x5F97;&#x901A;&#x77E5;&#x3002;inotify&#x673A;&#x5236;&#x53D6;&#x4EE3;&#x4E86;&#x8F83;&#x8001;&#x7684;dnotify&#x673A;&#x5236;&#x3002;</p>
<h2 id="inotify-API"><a href="#inotify-API" class="headerlink" title="inotify API"></a>inotify API</h2><p>inotify_init()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x53EF;&#x521B;&#x5EFA;&#x4E00;&#x65B0;&#x7684;inotify&#x5B9E;&#x4F8B;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;sys/inotify.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">inotify_init</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x6210;&#x529F;&#x8FD4;&#x56DE;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#xFF0C;&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x4F5C;&#x4E3A;&#x51FD;&#x6570;&#x7ED3;&#x679C;&#xFF0C;inotify_init()&#x4F1A;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#xFF08;&#x53E5;&#x67C4;&#xFF09;&#xFF0C;&#x7528;&#x4E8E;&#x5728;&#x540E;&#x7EED;&#x64CD;&#x4F5C;&#x4E2D;&#x6307;&#x4EE3;&#x6B64;inotify&#x5B9E;&#x4F8B;&#x3002;</p>
<p>&#x9488;&#x5BF9;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;fd&#x6240;&#x6307;&#x4EE3;inotify&#x5B9E;&#x4F8B;&#x7684;&#x76D1;&#x63A7;&#x5217;&#x8868;&#xFF0C;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;inotify_add_watch()&#x65E2;&#x53EF;&#x4EE5;&#x8FFD;&#x52A0;&#x65B0;&#x7684;&#x76D1;&#x63A7;&#x9879;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x4FEE;&#x6539;&#x73B0;&#x6709;&#x76D1;&#x63A7;&#x9879;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;sys/inotify.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">inotify_add_watch</span><span class="token punctuation">(</span><span class="token keyword">int</span> fd<span class="token punctuation">,</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> pathname<span class="token punctuation">,</span>uint32_t mask<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x6210;&#x529F;&#x8FD4;&#x56DE;&#x89C2;&#x5BDF;&#x63CF;&#x8FF0;&#x7B26;&#xFF0C;&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x53C2;&#x6570;pathname&#x6807;&#x8BC6;&#x6B32;&#x521B;&#x5EFA;&#x6216;&#x4FEE;&#x6539;&#x7684;&#x76D1;&#x63A7;&#x9879;&#x6240;&#x5BF9;&#x5E94;&#x7684;&#x6587;&#x4EF6;&#x3002;&#x8C03;&#x7528;&#x7A0B;&#x5E8F;&#x5FC5;&#x987B;&#x5BF9;&#x8BE5;&#x6587;&#x4EF6;&#x5177;&#x6709;&#x8BFB;&#x6743;&#x9650;&#xFF08;&#x8C03;&#x7528;inotify_add_watch()&#x65F6;&#xFF0C;&#x4F1A;&#x5BF9;&#x6587;&#x4EF6;&#x6743;&#x9650;&#x505A;&#x4E00;&#x6B21;&#x6027;&#x68C0;&#x67E5;&#x3002;&#x53EA;&#x8981;&#x76D1;&#x63A7;&#x9879;&#x7EE7;&#x7EED;&#x5B58;&#x5728;&#xFF0C;&#x5373;&#x4FBF;&#x6709;&#x4EBA;&#x66F4;&#x6539;&#x4E86;&#x6587;&#x4EF6;&#x6743;&#x9650;&#xFF0C;&#x4F7F;&#x8C03;&#x7528;&#x7A0B;&#x5E8F;&#x4E0D;&#x518D;&#x5BF9;&#x6587;&#x4EF6;&#x5177;&#x6709;&#x8BFB;&#x6743;&#x9650;&#xFF0C;&#x8C03;&#x7528;&#x7A0B;&#x5E8F;&#x4F9D;&#x7136;&#x4F1A;&#x7EE7;&#x7EED;&#x6536;&#x5230;&#x6587;&#x4EF6;&#x7684;&#x901A;&#x77E5;&#x6D88;&#x606F;&#xFF09;&#x3002;<br>&#x53C2;&#x6570;mask&#x4E3A;&#x4E00;&#x4F4D;&#x63A9;&#x7801;&#xFF0C;&#x9488;&#x5BF9;pathname&#x5B9A;&#x4E49;&#x4E86;&#x610F;&#x6B32;&#x76D1;&#x63A7;&#x7684;&#x4E8B;&#x4EF6;&#x3002;</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th align="left">mask</th>
<th align="center">&#x4E8B;&#x4EF6;</th>
</tr>
</thead>
<tbody><tr>
<td align="left">IN_ACCESS</td>
<td align="center">&#x6587;&#x4EF6;&#x88AB;&#x8BBF;&#x95EE;</td>
</tr>
<tr>
<td align="left">IN_ATTRIB</td>
<td align="center">&#x6587;&#x4EF6;&#x5143;&#x6570;&#x636E;&#x6539;&#x53D8;</td>
</tr>
<tr>
<td align="left">IN_CLOSE_WRITE</td>
<td align="center">&#x5173;&#x95ED;&#x4E3A;&#x4E86;&#x5199;&#x5165;&#x800C;&#x6253;&#x5F00;&#x7684;&#x6587;&#x4EF6;</td>
</tr>
<tr>
<td align="left">IN_CREATE</td>
<td align="center">&#x5728;&#x53D7;&#x76D1;&#x63A7;&#x76EE;&#x5F55;&#x4E0B;&#x521B;&#x5EFA;&#x4E86;&#x6587;&#x4EF6;&#x6216;&#x76EE;&#x5F55;</td>
</tr>
<tr>
<td align="left">IN_DELETE</td>
<td align="center">&#x5728;&#x53D7;&#x76D1;&#x63A7;&#x76EE;&#x5F55;&#x5185;&#x5220;&#x9664;&#x4E86;&#x6587;&#x4EF6;&#x6216;&#x76EE;&#x5F55;</td>
</tr>
<tr>
<td align="left">IN_DELETE_SELF</td>
<td align="center">&#x5220;&#x9664;&#x4E86;&#x53D7;&#x76D1;&#x63A7;&#x76EE;&#x5F55;/&#x6587;&#x4EF6;&#x672C;&#x8EAB;</td>
</tr>
<tr>
<td align="left">IN_MODIFY</td>
<td align="center">&#x6587;&#x4EF6;&#x88AB;&#x4FEE;&#x6539;</td>
</tr>
<tr>
<td align="left">IN_MODIFY_SELF</td>
<td align="center">&#x79FB;&#x52A8;&#x53D7;&#x76D1;&#x63A7;&#x76EE;&#x5F55;&#x6216;&#x6587;&#x4EF6;&#x672C;&#x8EAB;</td>
</tr>
<tr>
<td align="left">IN_MOVED_FROM</td>
<td align="center">&#x6587;&#x4EF6;&#x79FB;&#x9664;&#x53D7;&#x76D1;&#x63A7;&#x76EE;&#x5F55;</td>
</tr>
<tr>
<td align="left">IN_MOVED_TO</td>
<td align="center">&#x5C06;&#x6587;&#x4EF6;&#x79FB;&#x5230;&#x53D7;&#x76D1;&#x63A7;&#x76EE;&#x5F55;</td>
</tr>
<tr>
<td align="left">IN_OPEN</td>
<td align="center">&#x6587;&#x4EF6;&#x88AB;&#x6253;&#x5F00;</td>
</tr>
<tr>
<td align="left">IN_ALL_EVENTS</td>
<td align="center">&#x4EE5;&#x4E0A;&#x6240;&#x6709;&#x8F93;&#x51FA;&#x4E8B;&#x4EF6;&#x7684;&#x7EDF;&#x79F0;</td>
</tr>
<tr>
<td align="left">IN_MOVE</td>
<td align="center">IN_MOVED_FROM</td>
</tr>
<tr>
<td align="left">IN_ONESHOT</td>
<td align="center">&#x53EA;&#x76D1;&#x63A7;pathname&#x7684;&#x4E00;&#x4E2A;&#x4E8B;&#x4EF6;</td>
</tr>
<tr>
<td align="left">IN_ONLYDIR</td>
<td align="center">pathname&#x4E0D;&#x4E3A;&#x76EE;&#x5F55;&#x65F6;&#x4F1A;&#x5931;&#x8D25;</td>
</tr>
<tr>
<td align="left">IN_IGNORED</td>
<td align="center">&#x76D1;&#x63A7;&#x9879;&#x4E3A;&#x5185;&#x6838;&#x6216;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x6240;&#x79FB;&#x9664;</td>
</tr>
<tr>
<td align="left">IN_ISDIR</td>
<td align="center">name&#x4E2D;&#x6240;&#x8FD4;&#x56DE;&#x7684;&#x6587;&#x4EF6;&#x540D;&#x4E3A;&#x8DEF;&#x5F84;</td>
</tr>
<tr>
<td align="left">IN_Q_OVERFLOW</td>
<td align="center">&#x4E8B;&#x4EF6;&#x961F;&#x5217;&#x6EA2;&#x51FA;</td>
</tr>
<tr>
<td align="left">IN_UNMOUNT</td>
<td align="center">&#x5305;&#x542B;&#x5BF9;&#x8C61;&#x7684;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x906D;&#x5378;&#x8F7D;</td>
</tr>
</tbody></table></div>
<p>&#x7CFB;&#x7EDF;&#x8C03;&#x7528;inotify_rm_watch()&#x4F1A;&#x4ECE;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;fd&#x6240;&#x6307;&#x4EE3;&#x7684;inotify&#x5B9E;&#x4F8B;&#x4E2D;&#xFF0C;&#x5220;&#x9664;&#x7531;wd&#x6240;&#x5B9A;&#x4E49;&#x7684;&#x76D1;&#x63A7;&#x9879;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;sys/inotify.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">inotify_rm_watch</span><span class="token punctuation">(</span><span class="token keyword">int</span> fd<span class="token punctuation">,</span>uint32_t wd<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x6210;&#x529F;&#x8FD4;&#x56DE;&#x89C2;&#x5BDF;&#x63CF;&#x8FF0;&#x7B26;&#xFF0C;&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x53C2;&#x6570;wd&#x662F;&#x4E00;&#x76D1;&#x63A7;&#x63CF;&#x8FF0;&#x7B26;&#xFF0C;&#x7531;&#x4E4B;&#x524D;&#x5BF9;inotify_add_watch()&#x7684;&#x8C03;&#x7528;&#x8FD4;&#x56DE;&#x3002;&#xFF08;uint32_t&#x6570;&#x636E;&#x7C7B;&#x578B;&#x4E3A;&#x4E00;&#x65E0;&#x7B26;&#x53F7;32&#x4F4D;&#x6574;&#x6570;&#x3002;&#xFF09;</p>
<h3 id="&#x8BFB;&#x53D6;inotify&#x4E8B;&#x4EF6;"><a href="#&#x8BFB;&#x53D6;inotify&#x4E8B;&#x4EF6;" class="headerlink" title="&#x8BFB;&#x53D6;inotify&#x4E8B;&#x4EF6;"></a>&#x8BFB;&#x53D6;inotify&#x4E8B;&#x4EF6;</h3><p>&#x4E8B;&#x4EF6;&#x53D1;&#x751F;&#x540E;&#xFF0C;&#x6BCF;&#x6B21;&#x8C03;&#x7528;read()&#x4F1A;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x7F13;&#x51B2;&#x533A;&#xFF0C;&#x5185;&#x542B;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x5982;&#x4E0B;&#x7C7B;&#x578B;&#x7684;&#x7ED3;&#x6784;:</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">struct</span> inotify_event <span class="token punctuation">{</span>  
    <span class="token keyword">int</span>      wd<span class="token punctuation">;</span>           <span class="token comment" spellcheck="true">/*watch&#x63CF;&#x8FF0;&#x7B26; */</span>  
    uint32_t mask<span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">/*  &#x4E8B;&#x4EF6;&#x63A9;&#x7801; */</span>  
    uint32_t cookie<span class="token punctuation">;</span>   
    uint32_t len<span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">/* name&#x7684;&#x957F;&#x5EA6; */</span>  
    <span class="token keyword">char</span>     name<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">/* &#x6587;&#x4EF6;&#x6216;&#x76EE;&#x5F55;&#x540D; */</span>  
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h1 id="&#x7CFB;&#x7EDF;&#x7F16;&#x7A0B;&#x6982;&#x5FF5;"><a href="#&#x7CFB;&#x7EDF;&#x7F16;&#x7A0B;&#x6982;&#x5FF5;" class="headerlink" title="&#x7CFB;&#x7EDF;&#x7F16;&#x7A0B;&#x6982;&#x5FF5;"></a>&#x7CFB;&#x7EDF;&#x7F16;&#x7A0B;&#x6982;&#x5FF5;</h1><h3 id="&#x8BBE;&#x5907;&#x4E13;&#x7528;&#x6587;&#x4EF6;&#xFF08;&#x8BBE;&#x5907;&#x6587;&#x4EF6;&#xFF09;"><a href="#&#x8BBE;&#x5907;&#x4E13;&#x7528;&#x6587;&#x4EF6;&#xFF08;&#x8BBE;&#x5907;&#x6587;&#x4EF6;&#xFF09;" class="headerlink" title="&#x8BBE;&#x5907;&#x4E13;&#x7528;&#x6587;&#x4EF6;&#xFF08;&#x8BBE;&#x5907;&#x6587;&#x4EF6;&#xFF09;"></a>&#x8BBE;&#x5907;&#x4E13;&#x7528;&#x6587;&#x4EF6;&#xFF08;&#x8BBE;&#x5907;&#x6587;&#x4EF6;&#xFF09;</h3><p>&#x8BBE;&#x5907;&#x4E13;&#x7528;&#x6587;&#x4EF6;&#x4E0E;&#x7CFB;&#x7EDF;&#x7684;&#x67D0;&#x4E2A;&#x8BBE;&#x5907;&#x76F8;&#x5BF9;&#x5E94;&#x3002;&#x5728;&#x5185;&#x6838;&#x4E2D;&#xFF0C;&#x6BCF;&#x79CD;&#x8BBE;&#x5907;&#x7C7B;&#x578B;&#x90FD;&#x6709;&#x4E0E;&#x4E4B;&#x76F8;&#x5BF9;&#x5E94;&#x7684;&#x8BBE;&#x5907;&#x9A71;&#x52A8;&#x7A0B;&#x5E8F;&#xFF0C;&#x7528;&#x6765;&#x5904;&#x7406;&#x8BBE;&#x5907;&#x7684;&#x6240;&#x6709;I/O&#x8BF7;&#x6C42;&#x3002;&#x8BBE;&#x5907;&#x9A71;&#x52A8;&#x7A0B;&#x5E8F;&#x5C5E;&#x5185;&#x6838;&#x4EE3;&#x7801;&#x5355;&#x5143;&#xFF0C;&#x53EF;&#x6267;&#x884C;&#x4E00;&#x7CFB;&#x5217;&#x64CD;&#x4F5C;&#xFF0C;&#xFF08;&#x901A;&#x5E38;&#xFF09;&#x4E0E;&#x76F8;&#x5173;&#x786C;&#x4EF6;&#x7684;&#x8F93;&#x5165;/&#x8F93;&#x51FA;&#x52A8;&#x4F5C;&#x76F8;&#x5BF9;&#x5E94;&#x3002;&#x7531;&#x8BBE;&#x5907;&#x9A71;&#x52A8;&#x7A0B;&#x5E8F;&#x63D0;&#x4F9B;&#x7684;API&#x662F;&#x56FA;&#x5B9A;&#x7684;&#xFF0C;&#x5305;&#x542B;&#x7684;&#x64CD;&#x4F5C;&#x5BF9;&#x5E94;&#x4E8E;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;open()&#x3001;close()&#x3001;read()&#x3001;write()&#x3001;mmap()&#x4EE5;&#x53CA;ioctl()&#x3002;&#x6BCF;&#x4E2A;&#x8BBE;&#x5907;&#x9A71;&#x52A8;&#x7A0B;&#x5E8F;&#x6240;&#x63D0;&#x4F9B;&#x7684;&#x63A5;&#x53E3;&#x4E00;&#x81F4;&#xFF0C;&#x8FD9;&#x9690;&#x85CF;&#x4E86;&#x6BCF;&#x4E2A;&#x8BBE;&#x5907;&#x5728;&#x64CD;&#x4F5C;&#x65B9;&#x9762;&#x7684;&#x5DEE;&#x5F02;&#xFF0C;&#x4ECE;&#x800C;&#x6EE1;&#x8DB3;&#x4E86;I/O&#x64CD;&#x4F5C;&#x7684;&#x901A;&#x7528;&#x6027;.</p>
<p>&#x67D0;&#x4E9B;&#x8BBE;&#x5907;&#x662F;&#x5B9E;&#x9645;&#x5B58;&#x5728;&#x7684;&#xFF0C;&#x6BD4;&#x5982;&#x9F20;&#x6807;&#x3001;&#x78C1;&#x76D8;&#x548C;&#x78C1;&#x5E26;&#x8BBE;&#x5907;&#x3002;&#x800C;&#x53E6;&#x4E00;&#x4E9B;&#x8BBE;&#x5907;&#x5219;&#x662F;&#x865A;&#x62DF;&#x7684;&#xFF0C;&#x4EA6;&#x5373;&#x5E76;&#x4E0D;&#x5B58;&#x5728;&#x76F8;&#x5E94;&#x786C;&#x4EF6;&#xFF0C;&#x4F46;&#x5185;&#x6838;&#x4F1A;&#xFF08;&#x901A;&#x8FC7;&#x8BBE;&#x5907;&#x9A71;&#x52A8;&#x7A0B;&#x5E8F;&#xFF09;&#x63D0;&#x4F9B;&#x4E00;&#x79CD;&#x62BD;&#x8C61;&#x8BBE;&#x5907;&#xFF0C;&#x5176;&#x6240;&#x643A;&#x5E26;&#x7684;API&#x4E0E;&#x771F;&#x5B9E;&#x8BBE;&#x5907;&#x4E00;&#x822C;&#x65E0;&#x5F02;&#x3002;<br>&#x53EF;&#x5C06;&#x8BBE;&#x5907;&#x5212;&#x5206;&#x4E3A;&#x4EE5;&#x4E0B;&#x4E24;&#x79CD;&#x7C7B;&#x578B;&#x3002;</p>
<ul>
<li>&#x5B57;&#x7B26;&#x578B;&#x8BBE;&#x5907;&#x57FA;&#x4E8E;&#x6BCF;&#x4E2A;&#x5B57;&#x7B26;&#x6765;&#x5904;&#x7406;&#x6570;&#x636E;&#x3002;&#x7EC8;&#x7AEF;&#x548C;&#x952E;&#x76D8;&#x90FD;&#x5C5E;&#x4E8E;&#x5B57;&#x7B26;&#x578B;&#x8BBE;&#x5907;&#x3002;</li>
<li>&#x5757;&#x8BBE;&#x5907;&#x5219;&#x6BCF;&#x6B21;&#x5904;&#x7406;&#x4E00;&#x5757;&#x6570;&#x636E;&#x3002;&#x5757;&#x7684;&#x5927;&#x5C0F;&#x53D6;&#x51B3;&#x4E8E;&#x8BBE;&#x5907;&#x7C7B;&#x578B;&#xFF0C;&#x4F46;&#x901A;&#x5E38;&#x4E3A;512&#x5B57;&#x8282;&#x7684;&#x500D;&#x6570;&#x3002;&#x78C1;&#x76D8;&#x548C;&#x78C1;&#x5E26;&#x8BBE;&#x5907;&#x90FD;&#x5C5E;&#x4E8E;&#x5757;&#x8BBE;&#x5907;&#x3002;</li>
</ul>
<p>&#x4E0E;&#x5176;&#x4ED6;&#x7C7B;&#x578B;&#x7684;&#x6587;&#x4EF6;&#x4E00;&#x6837;&#xFF0C;&#x8BBE;&#x5907;&#x6587;&#x4EF6;&#x603B;&#x4F1A;&#x51FA;&#x73B0;&#x5728;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x4E2D;&#xFF0C;&#x901A;&#x5E38;&#x4F4D;&#x4E8E;/dev&#x76EE;&#x5F55;&#x4E0B;&#x3002;&#x8D85;&#x7EA7;&#x7528;&#x6237;&#x53EF;&#x4F7F;&#x7528;mknod&#x547D;&#x4EE4;&#x521B;&#x5EFA;&#x8BBE;&#x5907;&#x6587;&#x4EF6;&#xFF0C;&#x7279;&#x6743;&#x7EA7;&#x7A0B;&#x5E8F;&#xFF08;CAP_MKNOD&#xFF09;&#x6267;&#x884C;mknod()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x4EA6;&#x53EF;&#x5B8C;&#x6210;&#x76F8;&#x540C;&#x4EFB;&#x52A1;&#x3002;</p>
<p>&#x5728;Linux&#x7684;&#x65E9;&#x671F;&#x7248;&#x672C;&#x4E2D;&#xFF0C;/dev&#x5305;&#x542B;&#x4E86;&#x7CFB;&#x7EDF;&#x4E2D;&#x6240;&#x6709;&#x53EF;&#x80FD;&#x8BBE;&#x5907;&#x7684;&#x6761;&#x76EE;&#xFF0C;&#x5373;&#x4F7F;&#x67D0;&#x4E9B;&#x8BBE;&#x5907;&#x5B9E;&#x9645;&#x5E76;&#x672A;&#x4E0E;&#x7CFB;&#x7EDF;&#x8FDE;&#x63A5;&#x3002;&#x8FD9;&#x610F;&#x5473;&#x7740;/dev&#x4F1A;&#x5305;&#x542B;&#x6570;&#x4EE5;&#x5343;&#x8BA1;&#x7684;&#x672A;&#x7528;&#x8BBE;&#x5907;&#x9879;&#xFF0C;&#x4ECE;&#x800C;&#x5BFC;&#x81F4;&#x4E86;&#x4E24;&#x4E2A;&#x7F3A;&#x70B9;&#xFF1A;&#x5176;&#x4E00;&#xFF0C;&#x5BF9;&#x4E8E;&#x9700;&#x8981;&#x626B;&#x63CF;&#x8BE5;&#x76EE;&#x5F55;&#x5185;&#x5BB9;&#x7684;&#x5E94;&#x7528;&#x800C;&#x8A00;&#xFF0C;&#x964D;&#x4F4E;&#x4E86;&#x7A0B;&#x5E8F;&#x7684;&#x6267;&#x884C;&#x901F;&#x5EA6;&#xFF1B;&#x5176;&#x4E8C;&#xFF0C;&#x6839;&#x636E;&#x8BE5;&#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x5185;&#x5BB9;&#x65E0;&#x6CD5;&#x53D1;&#x73B0;&#x7CFB;&#x7EDF;&#x4E2D;&#x5B9E;&#x9645;&#x5B58;&#x5728;&#x54EA;&#x4E9B;&#x8BBE;&#x5907;&#x3002;Linux2.6&#x8FD0;&#x7528;udev&#x7A0B;&#x5E8F;&#x89E3;&#x51B3;&#x4E86;&#x4E0A;&#x8FF0;&#x95EE;&#x9898;&#x3002;&#x8BE5;&#x7A0B;&#x5E8F;&#x6240;&#x4F9D;&#x8D56;&#x7684;sysfs&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#xFF0C;&#x662F;&#x88C5;&#x8F7D;&#x4E8E;/sys&#x4E0B;&#x7684;&#x4F2A;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#xFF0C;&#x5C06;&#x8BBE;&#x5907;&#x548C;&#x5176;&#x4ED6;&#x5185;&#x6838;&#x5BF9;&#x8C61;&#x7684;&#x76F8;&#x5173;&#x4FE1;&#x606F;&#x5BFC;&#x51FA;&#x81F3;&#x7528;&#x6237;&#x7A7A;&#x95F4;&#x3002;</p>
<h3 id="&#x8BBE;&#x5907;ID"><a href="#&#x8BBE;&#x5907;ID" class="headerlink" title="&#x8BBE;&#x5907;ID"></a>&#x8BBE;&#x5907;ID</h3><p>&#x6BCF;&#x4E2A;&#x8BBE;&#x5907;&#x6587;&#x4EF6;&#x90FD;&#x6709;&#x4E3B;&#x3001;&#x8F85;ID&#x53F7;&#x5404;&#x4E00;&#x3002;&#x4E3B;ID&#x53F7;&#x6807;&#x8BC6;&#x4E00;&#x822C;&#x7684;&#x8BBE;&#x5907;&#x7B49;&#x7EA7;&#xFF0C;&#x5185;&#x6838;&#x4F1A;&#x4F7F;&#x7528;&#x4E3B;ID&#x53F7;&#x67E5;&#x627E;&#x4E0E;&#x8BE5;&#x7C7B;&#x8BBE;&#x5907;&#x76F8;&#x5E94;&#x7684;&#x9A71;&#x52A8;&#x7A0B;&#x5E8F;&#x3002;&#x8F85; ID &#x53F7;&#x80FD;&#x591F;&#x5728;&#x4E00;&#x822C;&#x7B49;&#x7EA7;&#x4E2D;&#x552F;&#x4E00;&#x6807;&#x8BC6;&#x7279;&#x5B9A;&#x8BBE;&#x5907;&#x3002;&#x547D;&#x4EE4;ls &#x2013;l&#x53EF;&#x663E;&#x793A;&#x51FA;&#x8BBE;&#x5907;&#x6587;&#x4EF6;&#x7684;&#x4E3B;&#x3001;&#x8F85;ID&#x3002;</p>
<p>&#x8BBE;&#x5907;&#x6587;&#x4EF6;&#x7684;i&#x8282;&#x70B9;&#x4E2D;&#x8BB0;&#x5F55;&#x4E86;&#x8BBE;&#x5907;&#x6587;&#x4EF6;&#x7684;&#x4E3B;&#x3001;&#x8F85;ID&#xFF08;&#x672C;&#x7AE0;&#x7B2C;4&#x8282;&#x5C06;&#x4ECB;&#x7ECD;i&#x8282;&#x70B9;&#xFF09;&#x3002;&#x6BCF;&#x4E2A;&#x8BBE;&#x5907;&#x9A71;&#x52A8;&#x7A0B;&#x5E8F;&#x90FD;&#x4F1A;&#x5C06;&#x81EA;&#x5DF1;&#x4E0E;&#x7279;&#x5B9A;&#x4E3B;&#x8BBE;&#x5907;&#x53F7;&#x7684;&#x5173;&#x8054;&#x5173;&#x7CFB;&#x5411;&#x5185;&#x6838;&#x6CE8;&#x518C;&#xFF0C;&#x85C9;&#x6B64;&#x5EFA;&#x7ACB;&#x8BBE;&#x5907;&#x4E13;&#x7528;&#x6587;&#x4EF6;&#x548C;&#x8BBE;&#x5907;&#x9A71;&#x52A8;&#x7A0B;&#x5E8F;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x7CFB;&#x3002;&#x5185;&#x6838;&#x662F;&#x4E0D;&#x4F1A;&#x4F7F;&#x7528;&#x8BBE;&#x5907;&#x6587;&#x4EF6;&#x540D;&#x6765;&#x67E5;&#x627E;&#x9A71;&#x52A8;&#x7A0B;&#x5E8F;&#x7684;&#x3002;</p>
<p>&#x5728;Linux 2.4&#x4EE5;&#x53CA;&#x66F4;&#x65E9;&#x7684;&#x7248;&#x672C;&#x4E2D;&#xFF0C;&#x7CFB;&#x7EDF;&#x7684;&#x8BBE;&#x5907;&#x603B;&#x6570;&#x53D7;&#x9650;&#x4E8E;&#x8FD9;&#x4E00;&#x4E8B;&#x5B9E;&#xFF1A;&#x8BBE;&#x5907;&#x7684;&#x4E3B;&#x3001;&#x8F85;ID&#x53EA;&#x80FD;&#x7528;8&#x4F4D;&#x6570;&#x6765;&#x8868;&#x793A;&#x3002;&#x52A0;&#x4E4B;&#x4E3B;&#x8BBE;&#x5907;ID&#x56FA;&#x5B9A;&#x4E0D;&#x53D8;&#xFF0C;&#x4E14;&#x4E3A;&#x7EDF;&#x4E00;&#x5206;&#x914D;&#xFF08;&#x7531;Linux&#x547D;&#x540D;&#x548C;&#x7F16;&#x53F7;&#x673A;&#x6784;&#x5206;&#x914D;&#xFF0C;&#x8BF7;&#x89C1;<a href="https://www.lanana.org" target="_blank" rel="noopener">https://www.lanana.org</a> &#xFF09;&#xFF0C;&#x4F7F;&#x5F97;&#x4E0A;&#x8FF0;&#x95EE;&#x9898;&#x66F4;&#x4E3A;&#x4E25;&#x91CD;&#x3002;Linux 2.6&#x91C7;&#x7528;&#x4E86;&#x66F4;&#x591A;&#x4F4D;&#x6570;&#x6765;&#x5B58;&#x653E;&#x4E3B;&#x3001;&#x8F85;ID&#xFF08;&#x5206;&#x522B;&#x4E3A;12&#x4F4D;&#x548C;20&#x4F4D;&#xFF09;&#xFF0C;&#x4ECE;&#x800C;&#x7F13;&#x89E3;&#x4E86;&#x8FD9;&#x4E00;&#x95EE;&#x9898;&#x3002;</p>
<h1 id="&#x7528;&#x6237;&#x548C;&#x7EC4;"><a href="#&#x7528;&#x6237;&#x548C;&#x7EC4;" class="headerlink" title="&#x7528;&#x6237;&#x548C;&#x7EC4;"></a>&#x7528;&#x6237;&#x548C;&#x7EC4;</h1><p>&#x6BCF;&#x4E2A;&#x7528;&#x6237;&#x90FD;&#x62E5;&#x6709;&#x4E00;&#x4E2A;&#x552F;&#x4E00;&#x7684;&#x7528;&#x6237;&#x540D;&#x548C;&#x4E00;&#x4E2A;&#x4E0E;&#x4E4B;&#x76F8;&#x5173;&#x7684;&#x6570;&#x503C;&#x578B;&#x7528;&#x6237;&#x6807;&#x8BC6;&#x7B26;&#xFF08;UID&#xFF09;&#x3002;&#x7528;&#x6237;&#x53EF;&#x4EE5;&#x96B6;&#x5C5E;&#x4E8E;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x7EC4;&#x3002;&#x800C;&#x6BCF;&#x4E2A;&#x7EC4;&#x4E5F;&#x90FD;&#x62E5;&#x6709;&#x552F;&#x4E00;&#x7684;&#x4E00;&#x4E2A;&#x540D;&#x79F0;&#x548C;&#x4E00;&#x4E2A;&#x7EC4;&#x6807;&#x8BC6;&#x7B26;&#xFF08;GID&#xFF09;&#x3002;<br>&#x7528;&#x6237;&#x548C;&#x7EC4;ID&#x7684;&#x4E3B;&#x8981;&#x7528;&#x9014;&#x6709;&#x4E8C;&#xFF1A;&#x5176;&#x4E00;&#xFF0C;&#x786E;&#x5B9A;&#x5404;&#x79CD;&#x7CFB;&#x7EDF;&#x8D44;&#x6E90;&#x7684;&#x6240;&#x6709;&#x6743;&#xFF1B;&#x5176;&#x4E8C;&#xFF0C;&#x5BF9;&#x8D4B;&#x4E88;&#x8FDB;&#x7A0B;&#x8BBF;&#x95EE;&#x4E0A;&#x8FF0;&#x8D44;&#x6E90;&#x7684;&#x6743;&#x9650;&#x52A0;&#x4EE5;&#x63A7;&#x5236;&#x3002;</p>
<pre><code>vim /etc/passwd</code></pre><pre><code>root:0:0:root:/root:/bin/bash
bin:1:1:bin:/bin:/sbin/nologin
daemon:2:2:daemon:/sbin:/sbin/nologin
adm:3:4:adm:/var/adm:/sbin/nologin
&#x2026;&#x7701;&#x7565;&#x90E8;&#x5206;&#x8F93;&#x51FA;&#x2026;</code></pre><p>&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x7684;&#x5185;&#x5BB9;&#x975E;&#x5E38;&#x89C4;&#x5F8B;&#xFF0C;&#x6BCF;&#x884C;&#x4EE3;&#x8868;&#x4E00;&#x4E2A;&#x7528;&#x6237;&#x3002;&#x5927;&#x5BB6;&#x53EF;&#x80FD;&#x4F1A;&#x6BD4;&#x8F83;&#x60CA;&#x8BB6;&#xFF0C;Linux &#x7CFB;&#x7EDF;&#x4E2D;&#x9ED8;&#x8BA4;&#x600E;&#x4E48;&#x4F1A;&#x6709;&#x8FD9;&#x4E48;&#x591A;&#x7684;&#x7528;&#x6237;&#x554A;&#xFF01;&#x8FD9;&#x4E9B;&#x7528;&#x6237;&#x4E2D;&#x7684;&#x7EDD;&#x5927;&#x591A;&#x6570;&#x662F;&#x7CFB;&#x7EDF;&#x6216;&#x670D;&#x52A1;&#x6B63;&#x5E38;&#x8FD0;&#x884C;&#x6240;&#x5FC5;&#x9700;&#x7684;&#x7528;&#x6237;&#xFF0C;&#x6211;&#x4EEC;&#x628A;&#x8FD9;&#x79CD;&#x7528;&#x6237;&#x79F0;&#x4E3A;&#x7CFB;&#x7EDF;&#x7528;&#x6237;&#x6216;&#x4F2A;&#x7528;&#x6237;&#x3002;&#x7CFB;&#x7EDF;&#x7528;&#x6237;&#x662F;&#x4E0D;&#x80FD;&#x767B;&#x5F55;&#x7CFB;&#x7EDF;&#x7684;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x4E9B;&#x7528;&#x6237;&#x540C;&#x6837;&#x4E5F;&#x4E0D;&#x80FD;&#x88AB;&#x5220;&#x9664;&#xFF0C;&#x56E0;&#x4E3A;&#x4E00;&#x65E6;&#x5220;&#x9664;&#xFF0C;&#x4F9D;&#x8D56;&#x8FD9;&#x4E9B;&#x7528;&#x6237;&#x8FD0;&#x884C;&#x7684;&#x670D;&#x52A1;&#x6216;&#x7A0B;&#x5E8F;&#x5C31;&#x4E0D;&#x80FD;&#x6B63;&#x5E38;&#x6267;&#x884C;&#xFF0C;&#x4F1A;&#x5BFC;&#x81F4;&#x7CFB;&#x7EDF;&#x95EE;&#x9898;&#x3002;</p>
<p>&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x5C31;&#x628A; root &#x7528;&#x6237;&#x8FD9;&#x4E00;&#x884C;&#x62FF;&#x51FA;&#x6765;&#xFF0C;&#x5177;&#x4F53;&#x5206;&#x6790;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x5185;&#x5BB9;&#x5177;&#x4F53;&#x4EE3;&#x8868;&#x7684;&#x542B;&#x4E49;&#x3002;&#x53EF;&#x4EE5;&#x6CE8;&#x610F;&#x5230;&#xFF0C;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x7528;&#x201D;:&#x201D;&#x4F5C;&#x4E3A;&#x5206;&#x9694;&#x7B26;&#xFF0C;&#x5212;&#x5206;&#x4E3A; 7 &#x4E2A;&#x5B57;&#x6BB5;&#xFF0C;&#x6211;&#x4EEC;&#x9010;&#x4E2A;&#x6765;&#x770B;&#x5177;&#x4F53;&#x7684;&#x542B;&#x4E49;&#x3002;<br><strong>&#x7528;&#x6237;&#x540D;&#x79F0;</strong><br>&#x7B2C;&#x4E00;&#x4E2A;&#x5B57;&#x6BB5;&#x4E2D;&#x4FDD;&#x5B58;&#x7684;&#x662F;&#x7528;&#x6237;&#x540D;&#x79F0;&#x3002;&#x4E0D;&#x8FC7;&#x5927;&#x5BB6;&#x9700;&#x8981;&#x6CE8;&#x610F;&#xFF0C;&#x7528;&#x6237;&#x540D;&#x79F0;&#x53EA;&#x662F;&#x4E3A;&#x4E86;&#x65B9;&#x4FBF;&#x7BA1;&#x7406;&#x5458;&#x8BB0;&#x5FC6;&#xFF0C;Linux &#x7CFB;&#x7EDF;&#x662F;&#x901A;&#x8FC7;&#x7528;&#x6237; ID (UID) &#x6765;&#x533A;&#x5206;&#x4E0D;&#x540C;&#x7528;&#x6237;&#x3001;&#x5206;&#x914D;&#x7528;&#x6237;&#x6743;&#x9650;&#x7684;&#x3002;&#x800C;&#x7528;&#x6237;&#x540D;&#x79F0;&#x548C; UID &#x7684;&#x5BF9;&#x5E94;&#x6B63;&#x662F;&#x901A;&#x8FC7; /etc/passwd &#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x6765;&#x5B9A;&#x4E49;&#x7684;&#x3002;<br><strong>&#x5BC6;&#x7801;&#x6807;&#x5FD7;</strong><br>&#x8FD9;&#x91CC;&#x7684;&#x201D;x&#x201D;&#x4EE3;&#x8868;&#x7684;&#x662F;&#x5BC6;&#x7801;&#x6807;&#x5FD7;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x771F;&#x6B63;&#x7684;&#x5BC6;&#x7801;&#xFF0C;&#x771F;&#x6B63;&#x7684;&#x5BC6;&#x7801;&#x662F;&#x4FDD;&#x5B58;&#x5728; /etc/shadow &#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x3002;&#x5728;&#x65E9;&#x671F;&#x7684; UNIX &#x4E2D;&#xFF0C;&#x8FD9;&#x91CC;&#x4FDD;&#x5B58;&#x7684;&#x5C31;&#x662F;&#x771F;&#x6B63;&#x7684;&#x52A0;&#x5BC6;&#x5BC6;&#x7801;&#x4E32;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x7684;&#x6743;&#x9650;&#x662F; 644&#xFF0C;&#x67E5;&#x8BE2;&#x547D;&#x4EE4;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># ll /etc/passwd</span>
-rw-r&#x2013;r-- 1 root root 1648 12&#x6708;29 00:17 /etc/passwd<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x6240;&#x6709;&#x7528;&#x6237;&#x90FD;&#x53EF;&#x4EE5;&#x8BFB;&#x53D6; /etc/passwd &#x6587;&#x4EF6;&#xFF0C;&#x8FD9;&#x6837;&#x975E;&#x5E38;&#x5BB9;&#x6613;&#x5BFC;&#x81F4;&#x5BC6;&#x7801;&#x7684;&#x6CC4;&#x9732;&#x3002;&#x867D;&#x7136;&#x5BC6;&#x7801;&#x662F;&#x52A0;&#x5BC6;&#x7684;&#xFF0C;&#x4F46;&#x662F;&#x91C7;&#x7528;&#x66B4;&#x529B;&#x7834;&#x89E3;&#x7684;&#x65B9;&#x5F0F;&#x4E5F;&#x662F;&#x80FD;&#x591F;&#x8FDB;&#x884C;&#x7834;&#x89E3;&#x7684;&#x3002;&#x6240;&#x4EE5;&#x73B0;&#x5728;&#x7684; Linux &#x7CFB;&#x7EDF;&#x628A;&#x771F;&#x6B63;&#x7684;&#x52A0;&#x5BC6;&#x5BC6;&#x7801;&#x4E32;&#x653E;&#x7F6E;&#x5728;&#x5F71;&#x5B50;&#x6587;&#x4EF6;/etc/shadow&#x4E2D;&#xFF0C;&#x800C;&#x5F71;&#x5B50;&#x6587;&#x4EF6;&#x7684;&#x6743;&#x9650;&#x662F; 000&#xFF0C;&#x67E5;&#x8BE2;&#x547D;&#x4EE4;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># ll /etc/shadow</span>
---------- 1 root root 1028 12&#x6708;29 00:18 /etc/shadow<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x662F;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x6743;&#x9650;&#x7684;&#xFF0C;&#x4F46;&#x56E0;&#x4E3A;&#x6211;&#x662F; root &#x7528;&#x6237;&#xFF0C;&#x6240;&#x4EE5;&#x8BFB;&#x53D6;&#x6743;&#x9650;&#x4E0D;&#x53D7;&#x9650;&#x5236;&#x3002;&#x5F53;&#x7136;&#xFF0C;&#x7528;&#x5F3A;&#x5236;&#x4FEE;&#x6539;&#x7684;&#x65B9;&#x6CD5;&#x4E5F;&#x662F;&#x53EF;&#x4EE5;&#x624B;&#x5DE5;&#x4FEE;&#x6539;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x7684;&#x5185;&#x5BB9;&#x7684;&#x3002;&#x53EA;&#x6709; root &#x7528;&#x6237;&#x53EF;&#x4EE5;&#x6D4F;&#x89C8;&#x548C;&#x64CD;&#x4F5C;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x6700;&#x5927;&#x9650;&#x5EA6;&#x5730;&#x4FDD;&#x8BC1;&#x4E86;&#x5BC6;&#x7801;&#x7684;&#x5B89;&#x5168;&#x3002;<br>&#x6240;&#x4EE5;&#x5728; /etc/passwd &#x4E2D;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x201D;x&#x201D;&#x4EE3;&#x8868;&#x7528;&#x6237;&#x662F;&#x62E5;&#x6709;&#x5BC6;&#x7801;&#x7684;&#xFF0C;&#x6211;&#x4EEC;&#x628A;&#x8FD9;&#x4E2A;&#x5B57;&#x6BB5;&#x79F0;&#x4F5C;&#x5BC6;&#x7801;&#x6807;&#x5FD7;&#xFF0C;&#x5177;&#x4F53;&#x7684;&#x5BC6;&#x7801;&#x8981;&#x53BB; /etc/shadow &#x6587;&#x4EF6;&#x4E2D;&#x67E5;&#x8BE2;&#x3002;&#x4F46;&#x662F;&#x8FD9;&#x4E2A;&#x5BC6;&#x7801;&#x6807;&#x5FD7;&#x201D;x&#x201D;&#x4E5F;&#x662F;&#x4E0D;&#x80FD;&#x88AB;&#x5220;&#x9664;&#x7684;&#xFF0C;&#x5982;&#x679C;&#x5220;&#x9664;&#x4E86;&#x5BC6;&#x7801;&#x6807;&#x5FD7;&#x201D;x&#x201D;&#xFF0C;&#x90A3;&#x4E48;&#x7CFB;&#x7EDF;&#x4F1A;&#x8BA4;&#x4E3A;&#x8FD9;&#x4E2A;&#x7528;&#x6237;&#x6CA1;&#x6709;&#x5BC6;&#x7801;&#xFF0C;&#x4ECE;&#x800C;&#x5BFC;&#x81F4;&#x53EA;&#x8F93;&#x5165;&#x7528;&#x6237;&#x540D;&#x800C;&#x4E0D;&#x7528;&#x8F93;&#x5165;&#x5BC6;&#x7801;&#x5C31;&#x53EF;&#x4EE5;&#x767B;&#x9646;&#xFF08;&#x5F53;&#x7136;&#x53EA;&#x80FD;&#x5728;&#x4F7F;&#x7528;&#x65E0;&#x5BC6;&#x7801;&#x767B;&#x5F55;&#xFF0C;&#x8FDC;&#x7A0B;&#x662F;&#x4E0D;&#x53EF;&#x4EE5;&#x7684;&#xFF09;&#xFF0C;&#x9664;&#x975E;&#x7279;&#x6B8A;&#x60C5;&#x51B5;&#xFF08;&#x5982;&#x7834;&#x89E3;&#x7528;&#x6237;&#x5BC6;&#x7801;&#xFF09;&#xFF0C;&#x8FD9;&#x5F53;&#x7136;&#x662F;&#x4E0D;&#x53EF;&#x884C;&#x7684;&#x3002;<br><strong>UID</strong><br>&#x7B2C;&#x4E09;&#x4E2A;&#x5B57;&#x6BB5;&#x5C31;&#x662F;&#x7528;&#x6237; ID(UID)&#xFF0C;&#x6211;&#x4EEC;&#x5DF2;&#x7ECF;&#x77E5;&#x9053;&#x7CFB;&#x7EDF;&#x662F;&#x901A;&#x8FC7; UID &#x6765;&#x8BC6;&#x522B;&#x4E0D;&#x540C;&#x7684;&#x7528;&#x6237;&#x548C;&#x5206;&#x914D;&#x7528;&#x6237;&#x6743;&#x9650;&#x7684;&#x3002;&#x8FD9;&#x4E9B; UID &#x662F;&#x6709;&#x4F7F;&#x7528;&#x9650;&#x5236;&#x548C;&#x8981;&#x6C42;&#x7684;&#xFF1A;<br>0&#xFF1A;&#x8D85;&#x7EA7;&#x7528;&#x6237; UID&#x3002;&#x5982;&#x679C;&#x7528;&#x6237; UID &#x4E3A; 0&#xFF0C;&#x5219;&#x4EE3;&#x8868;&#x8FD9;&#x4E2A;&#x8D26;&#x53F7;&#x662F;&#x7BA1;&#x7406;&#x5458;&#x8D26;&#x53F7;&#x3002;&#x5728; Linux &#x4E2D;&#x5982;&#x4F55;&#x628A;&#x666E;&#x901A;&#x7528;&#x6237;&#x5347;&#x7EA7;&#x6210;&#x7BA1;&#x7406;&#x5458;&#x5462;&#xFF1F;&#x53EA;&#x9700;&#x628A;&#x5176;&#x4ED6;&#x7528;&#x6237;&#x7684; UID &#x4FEE;&#x6539;&#x4E3A; 0 &#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#xFF0C;&#x8FD9;&#x4E00;&#x70B9;&#x548C; Windows &#x662F;&#x4E0D;&#x540C;&#x7684;&#x3002;&#x4E0D;&#x8FC7;&#x4E0D;&#x5EFA;&#x8BAE;&#x5EFA;&#x7ACB;&#x591A;&#x4E2A;&#x7BA1;&#x7406;&#x5458;&#x8D26;&#x53F7;&#x3002;<br>1~499&#xFF1A;&#x7CFB;&#x7EDF;&#x7528;&#x6237;&#xFF08;&#x4F2A;&#x7528;&#x6237;&#xFF09;UID&#x3002;&#x8FD9;&#x4E9B; UID &#x662F;&#x7CFB;&#x7EDF;&#x4FDD;&#x7559;&#x7ED9;&#x7CFB;&#x7EDF;&#x7528;&#x6237;&#x7684; UID&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4; UID &#x662F; 1<del>499 &#x8303;&#x56F4;&#x5185;&#x7684;&#x7528;&#x6237;&#x662F;&#x4E0D;&#x80FD;&#x767B;&#x5F55;&#x7CFB;&#x7EDF;&#x7684;&#xFF0C;&#x800C;&#x662F;&#x7528;&#x6765;&#x8FD0;&#x884C;&#x7CFB;&#x7EDF;&#x6216;&#x670D;&#x52A1;&#x7684;&#x3002;&#x5176;&#x4E2D;&#xFF0C;1</del>99 &#x662F;&#x7CFB;&#x7EDF;&#x4FDD;&#x7559;&#x7684;&#x8D26;&#x53F7;&#xFF0C;&#x7CFB;&#x7EDF;&#x81EA;&#x52A8;&#x521B;&#x5EFA;&#xFF1B;100<del>499 &#x662F;&#x9884;&#x7559;&#x7ED9;&#x7528;&#x6237;&#x521B;&#x5EFA;&#x8D26;&#x53F7;&#x7684;&#x3002;<br>500</del>65535&#xFF1A;&#x666E;&#x901A;&#x7528;&#x6237; UID&#x3002;&#x5EFA;&#x7ACB;&#x7684;&#x666E;&#x901A;&#x7528;&#x6237; UID &#x4ECE; 500 &#x5F00;&#x59CB;&#xFF0C;&#x6700;&#x5927;&#x5230; 65535&#x3002;<br><strong>GID</strong><br>&#x7B2C;&#x56DB;&#x4E2A;&#x5B57;&#x6BB5;&#x5C31;&#x662F;&#x7528;&#x6237;&#x7684;&#x7EC4; ID(GID)&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8FD9;&#x4E2A;&#x7528;&#x6237;&#x7684;&#x521D;&#x59CB;&#x7EC4;&#x7684;&#x6807;&#x5FD7;&#x53F7;&#x3002;&#x8FD9;&#x91CC;&#x9700;&#x8981;&#x89E3;&#x91CA;&#x4E00;&#x4E0B;&#x521D;&#x59CB;&#x7EC4;&#x548C;&#x9644;&#x52A0;&#x7EC4;&#x7684;&#x6982;&#x5FF5;&#x3002;<br>&#x6240;&#x8C13;&#x521D;&#x59CB;&#x7EC4;&#xFF0C;&#x6307;&#x7528;&#x6237;&#x4E00;&#x767B;&#x9646;&#x5F55;&#x5C31;&#x7ACB;&#x523B;&#x62E5;&#x6709;&#x8FD9;&#x4E2A;&#x7528;&#x6237;&#x7EC4;&#x7684;&#x76F8;&#x5173;&#x6743;&#x9650;&#x3002;&#x6BCF;&#x4E2A;&#x7528;&#x6237;&#x7684;&#x521D;&#x59CB;&#x7EC4;&#x53EA;&#x80FD;&#x6709;&#x4E00;&#x4E2A;&#xFF0C;&#x4E00;&#x822C;&#x5C31;&#x662F;&#x5C06;&#x548C;&#x8FD9;&#x4E2A;&#x7528;&#x6237;&#x7684;&#x7528;&#x6237;&#x540D;&#x76F8;&#x540C;&#x7684;&#x7EC4;&#x540D;&#x4F5C;&#x4E3A;&#x8FD9;&#x4E2A;&#x7528;&#x6237;&#x7684;&#x521D;&#x59CB;&#x7EC4;&#x3002;&#x4E3E;&#x4F8B;&#x6765;&#x8BF4;&#xFF0C;&#x6211;&#x4EEC;&#x624B;&#x5DE5;&#x6DFB;&#x52A0;&#x7528;&#x6237; lamp&#xFF0C;&#x5728;&#x5EFA;&#x7ACB;&#x7528;&#x6237; lamp &#x7684;&#x540C;&#x65F6;&#x5C31;&#x4F1A;&#x5EFA;&#x7ACB; lamp &#x7EC4;&#x4F5C;&#x4E3A; lamp &#x7528;&#x6237;&#x7684;&#x521D;&#x59CB;&#x7EC4;&#x3002;<br>&#x6240;&#x8C13;&#x9644;&#x52A0;&#x7EC4;&#xFF0C;&#x6307;&#x7528;&#x6237;&#x53EF;&#x4EE5;&#x52A0;&#x5165;&#x591A;&#x4E2A;&#x5176;&#x4ED6;&#x7684;&#x7528;&#x6237;&#x7EC4;&#xFF0C;&#x5E76;&#x62E5;&#x6709;&#x8FD9;&#x4E9B;&#x7EC4;&#x7684;&#x6743;&#x9650;&#x3002;&#x6BCF;&#x4E2A;&#x7528;&#x6237;&#x53EA;&#x80FD;&#x6709;&#x4E00;&#x4E2A;&#x521D;&#x59CB;&#x7EC4;&#xFF0C;&#x9664;&#x521D;&#x59CB;&#x7EC4;&#x8981;&#x628A;&#x7528;&#x6237;&#x518D;&#x52A0;&#x5165;&#x5176;&#x4ED6;&#x7684;&#x7528;&#x6237;&#x7EC4;&#x5916;&#xFF0C;&#x8FD9;&#x4E9B;&#x7528;&#x6237;&#x7EC4;&#x5C31;&#x662F;&#x8FD9;&#x4E2A;&#x7528;&#x6237;&#x7684;&#x9644;&#x52A0;&#x7EC4;&#x3002;&#x9644;&#x52A0;&#x7EC4;&#x53EF;&#x4EE5;&#x6709;&#x591A;&#x4E2A;&#xFF0C;&#x800C;&#x4E14;&#x7528;&#x6237;&#x53EF;&#x4EE5;&#x6709;&#x8FD9;&#x4E9B;&#x9644;&#x52A0;&#x7EC4;&#x7684;&#x6743;&#x9650;&#x3002;<br>&#x4E3E;&#x4F8B;&#x6765;&#x8BF4;&#xFF0C;&#x521A;&#x521A;&#x7684; lamp &#x7528;&#x6237;&#x9664;&#x5C5E;&#x4E8E;&#x521D;&#x59CB;&#x7EC4; lamp &#x5916;&#xFF0C;&#x6211;&#x53C8;&#x628A;&#x5B83;&#x52A0;&#x5165;&#x4E86; users &#x7EC4;&#xFF0C;&#x90A3;&#x4E48; lamp &#x7528;&#x6237;&#x540C;&#x65F6;&#x5C5E;&#x4E8E; lamp &#x7EC4;&#x3001;users &#x7EC4;&#xFF0C;&#x5176;&#x4E2D; lamp &#x662F;&#x521D;&#x59CB;&#x7EC4;&#xFF0C;users &#x662F;&#x9644;&#x52A0;&#x7EC4;&#x3002;&#x5F53;&#x7136;&#xFF0C;&#x521D;&#x59CB;&#x7EC4;&#x548C;&#x9644;&#x52A0;&#x7EC4;&#x7684;&#x8EAB;&#x4EFD;&#x662F;&#x53EF;&#x4EE5;&#x4FEE;&#x6539;&#x7684;&#xFF0C;&#x4F46;&#x662F;&#x6211;&#x4EEC;&#x5728;&#x5DE5;&#x4F5C;&#x4E2D;&#x4E0D;&#x4FEE;&#x6539;&#x521D;&#x59CB;&#x7EC4;&#xFF0C;&#x53EA;&#x4FEE;&#x6539;&#x9644;&#x52A0;&#x7EC4;&#xFF0C;&#x56E0;&#x4E3A;&#x4FEE;&#x6539;&#x4E86;&#x521D;&#x59CB;&#x7EC4;&#x6709;&#x65F6;&#x4F1A;&#x8BA9;&#x7BA1;&#x7406;&#x5458;&#x903B;&#x8F91;&#x6DF7;&#x4E71;&#x3002;<br>&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#xFF0C;&#x5728; /etc/passwd &#x6587;&#x4EF6;&#x7684;&#x7B2C;&#x56DB;&#x4E2A;&#x5B57;&#x6BB5;&#x4E2D;&#x770B;&#x5230;&#x7684; ID &#x662F;&#x8FD9;&#x4E2A;&#x7528;&#x6237;&#x7684;&#x521D;&#x59CB;&#x7EC4;&#x3002;<br><strong>&#x7528;&#x6237;&#x8BF4;&#x660E;</strong><br>&#x7B2C;&#x4E94;&#x4E2A;&#x5B57;&#x6BB5;&#x662F;&#x8FD9;&#x4E2A;&#x7528;&#x6237;&#x7684;&#x7B80;&#x5355;&#x8BF4;&#x660E;&#xFF0C;&#x6CA1;&#x6709;&#x4EC0;&#x4E48;&#x7279;&#x6B8A;&#x4F5C;&#x7528;&#xFF0C;&#x53EF;&#x4EE5;&#x4E0D;&#x5199;&#x3002;<br><strong>&#x5BB6;&#x76EE;&#x5F55;</strong><br>&#x7B2C;&#x516D;&#x4E2A;&#x5B57;&#x6BB5;&#x662F;&#x8FD9;&#x4E2A;&#x7528;&#x6237;&#x7684;&#x5BB6;&#x76EE;&#x5F55;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x7528;&#x6237;&#x767B;&#x5F55;&#x540E;&#x6709;&#x64CD;&#x4F5C;&#x6743;&#x9650;&#x7684;&#x8BBF;&#x95EE;&#x76EE;&#x5F55;&#xFF0C;&#x6211;&#x4EEC;&#x628A;&#x8FD9;&#x4E2A;&#x76EE;&#x5F55;&#x79F0;&#x4E3A;&#x7528;&#x6237;&#x7684;&#x5BB6;&#x76EE;&#x5F55;&#x3002;<br>&#x8D85;&#x7EA7;&#x7528;&#x6237;&#x7684;&#x5BB6;&#x76EE;&#x5F55;&#x662F; /root &#x76EE;&#x5F55;&#xFF0C;&#x666E;&#x901A;&#x7528;&#x6237;&#x5728; /home/ &#x76EE;&#x5F55;&#x4E0B;&#x5EFA;&#x7ACB;&#x548C;&#x7528;&#x6237;&#x540D;&#x76F8;&#x540C;&#x7684;&#x76EE;&#x5F55;&#x4F5C;&#x4E3A;&#x5BB6;&#x76EE;&#x5F55;&#xFF0C;&#x5982; lamp &#x7528;&#x6237;&#x7684;&#x5BB6;&#x76EE;&#x5F55;&#x5C31;&#x662F; /home/lamp/ &#x76EE;&#x5F55;&#x3002;<br><strong>&#x767B;&#x5F55;&#x4E4B;&#x540E;&#x7684;Shell</strong><br>Shell &#x5C31;&#x662F; Linux &#x7684;&#x547D;&#x4EE4;&#x89E3;&#x91CA;&#x5668;&#x3002;&#x7BA1;&#x7406;&#x5458;&#x8F93;&#x5165;&#x7684;&#x5BC6;&#x7801;&#x90FD;&#x662F; ASCII &#x7801;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x7C7B;&#x4F3C; abcd &#x7684;&#x82F1;&#x6587;&#x3002;&#x4F46;&#x662F;&#x7CFB;&#x7EDF;&#x53EF;&#x4EE5;&#x8BC6;&#x522B;&#x7684;&#x7F16;&#x7801;&#x662F;&#x7C7B;&#x4F3C; 0101 &#x7684;&#x673A;&#x5668;&#x8BED;&#x8A00;&#x3002;Shell &#x7684;&#x4F5C;&#x7528;&#x5C31;&#x662F;&#x628A; ASCII &#x7F16;&#x7801;&#x7684;&#x547D;&#x4EE4;&#x7FFB;&#x8BD1;&#x6210;&#x7CFB;&#x7EDF;&#x53EF;&#x4EE5;&#x8BC6;&#x522B;&#x7684;&#x673A;&#x5668;&#x8BED;&#x8A00;&#xFF0C;&#x540C;&#x65F6;&#x628A;&#x7CFB;&#x7EDF;&#x7684;&#x6267;&#x884C;&#x7ED3;&#x679C;&#x7FFB;&#x8BD1;&#x4E3A;&#x7528;&#x6237;&#x53EF;&#x4EE5;&#x8BC6;&#x522B;&#x7684; ASCII &#x7F16;&#x7801;&#x3002;Linux &#x7684;&#x6807;&#x51C6; Shell &#x5C31;&#x662F; /bin/bash&#x3002;<br>&#x5728; /etc/passw &#x6587;&#x4EF6;&#x4E2D;&#xFF0C;&#x5927;&#x5BB6;&#x53EF;&#x4EE5;&#x628A;&#x8FD9;&#x4E2A;&#x5B57;&#x6BB5;&#x7406;&#x89E3;&#x4E3A;&#x7528;&#x6237;&#x767B;&#x5F55;&#x4E4B;&#x540E;&#x6240;&#x62E5;&#x6709;&#x7684;&#x6743;&#x9650;&#x3002;&#x5982;&#x679C;&#x5199;&#x5165;&#x7684;&#x662F; Linux &#x7684;&#x6807;&#x51C6; Shell&#xFF0C;/bin/bash &#x5C31;&#x4EE3;&#x8868;&#x8FD9;&#x4E2A;&#x7528;&#x6237;&#x62E5;&#x6709;&#x6743;&#x9650;&#x8303;&#x56F4;&#x5185;&#x7684;&#x6240;&#x6709;&#x6743;&#x9650;&#x3002;&#x4F8B;&#x5982;&#xFF1A;</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># vi /etc/passwd</span>
lamp:502:502::/home/lamp:/bin/bash<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x6211;&#x624B;&#x5DE5;&#x6DFB;&#x52A0;&#x4E86; lamp &#x7528;&#x6237;&#xFF0C;&#x5B83;&#x7684;&#x767B;&#x5F55; Shell &#x662F; /bin/bash&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x4E2A;&#x7528;&#x6237;&#x5C31;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x666E;&#x901A;&#x7528;&#x6237;&#x7684;&#x6240;&#x6709;&#x6743;&#x9650;&#x3002;&#x5982;&#x679C;&#x6211;&#x628A; lamp &#x7528;&#x6237;&#x7684; Shell &#x4FEE;&#x6539;&#x4E3A; /sbin/nologin&#xFF0C;&#x4F8B;&#x5982;&#xFF1A;</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># vi /etc/passwd</span>
lamp:502:502::/home/lamp:/sbin/nologin<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x90A3;&#x4E48;&#x8FD9;&#x4E2A;&#x7528;&#x6237;&#x5C31;&#x4E0D;&#x80FD;&#x767B;&#x5F55;&#x4E86;&#xFF0C;&#x56E0;&#x4E3A; /sbin/nologin &#x5C31;&#x662F;&#x7981;&#x6B62;&#x767B;&#x5F55;&#x7684; Shell&#x3002;&#x8FD9;&#x6837;&#x8BF4;&#x660E;&#x767D;&#x4E86;&#x5417;&#xFF1F;&#x5982;&#x679C;&#x6211;&#x5728;&#x8FD9;&#x91CC;&#x653E;&#x5165;&#x7684;&#x7CFB;&#x7EDF;&#x547D;&#x4EE4;&#xFF0C;&#x5982; /usr/bin/passwd&#xFF0C;&#x4F8B;&#x5982;&#xFF1A;</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true">#vi /etc/passwd</span>
lamp:502:502::/home/lamp:/usr/bin/passwd<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x90A3;&#x4E48;&#x8FD9;&#x4E2A;&#x7528;&#x6237;&#x53EF;&#x4EE5;&#x767B;&#x5F55;&#xFF0C;&#x4F46;&#x767B;&#x5F55;&#x4E4B;&#x540E;&#x5C31;&#x53EA;&#x80FD;&#x4FEE;&#x6539;&#x81EA;&#x5DF1;&#x7684;&#x5BC6;&#x7801;&#x4E86;&#x3002;&#x8FD9;&#x91CC;&#x4E0D;&#x80FD;&#x968F;&#x4FBF;&#x5199;&#x5165;&#x548C;&#x767B;&#x9646;&#x6CA1;&#x6709;&#x5173;&#x7CFB;&#x7684;&#x547D;&#x4EE4;&#xFF0C;&#x5982; ls&#xFF0C;&#x5426;&#x5219;&#x7CFB;&#x7EDF;&#x4E0D;&#x4F1A;&#x8BC6;&#x522B;&#x8FD9;&#x4E9B;&#x547D;&#x4EE4;&#xFF0C;&#x4E5F;&#x5C31;&#x610F;&#x5473;&#x7740;&#x8FD9;&#x4E2A;&#x7528;&#x6237;&#x4E0D;&#x80FD;&#x767B;&#x5F55;&#x3002;</p>
<h3 id="&#x83B7;&#x53D6;&#x7528;&#x6237;&#x548C;&#x7EC4;&#x7684;&#x4FE1;&#x606F;"><a href="#&#x83B7;&#x53D6;&#x7528;&#x6237;&#x548C;&#x7EC4;&#x7684;&#x4FE1;&#x606F;" class="headerlink" title="&#x83B7;&#x53D6;&#x7528;&#x6237;&#x548C;&#x7EC4;&#x7684;&#x4FE1;&#x606F;"></a>&#x83B7;&#x53D6;&#x7528;&#x6237;&#x548C;&#x7EC4;&#x7684;&#x4FE1;&#x606F;</h3><p>&#x51FD;&#x6570;getpwnam()&#x548C;getpwuid()&#x7684;&#x4F5C;&#x7528;&#x662F;&#x4ECE;&#x5BC6;&#x7801;&#x6587;&#x4EF6;&#x4E2D;&#x83B7;&#x53D6;&#x8BB0;&#x5F55;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;pwd.h&gt;</span></span>
<span class="token keyword">struct</span> passwd <span class="token operator">*</span><span class="token function">getpwnam</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> passwd <span class="token operator">*</span><span class="token function">getpwuid</span><span class="token punctuation">(</span>uid_t uid<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> passwd
<span class="token punctuation">{</span>
  <span class="token keyword">char</span> <span class="token operator">*</span>pw_name<span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">/* &#x7528;&#x6237;&#x767B;&#x5F55;&#x540D; */</span>
  <span class="token keyword">char</span> <span class="token operator">*</span>pw_passwd<span class="token punctuation">;</span>              <span class="token comment" spellcheck="true">/* &#x5BC6;&#x7801;(&#x52A0;&#x5BC6;&#x540E;) */</span>
  __uid_t pw_uid<span class="token punctuation">;</span>               <span class="token comment" spellcheck="true">/* &#x7528;&#x6237;ID */</span>
  __gid_t pw_gid<span class="token punctuation">;</span>               <span class="token comment" spellcheck="true">/* &#x7EC4;ID */</span>
  <span class="token keyword">char</span> <span class="token operator">*</span>pw_gecos<span class="token punctuation">;</span>               <span class="token comment" spellcheck="true">/* &#x8BE6;&#x7EC6;&#x7528;&#x6237;&#x540D; */</span>
  <span class="token keyword">char</span> <span class="token operator">*</span>pw_dir<span class="token punctuation">;</span>                 <span class="token comment" spellcheck="true">/* &#x7528;&#x6237;&#x76EE;&#x5F55; */</span>
  <span class="token keyword">char</span> <span class="token operator">*</span>pw_shell<span class="token punctuation">;</span>               <span class="token comment" spellcheck="true">/* Shell&#x7A0B;&#x5E8F;&#x540D; */</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x51FD;&#x6570;getgrnam()&#x548C;getgrgid()&#x7684;&#x4F5C;&#x7528;&#x662F;&#x4ECE;&#x7EC4;&#x6587;&#x4EF6;&#x4E2D;&#x83B7;&#x53D6;&#x8BB0;&#x5F55;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;grp.h&gt;</span></span>
<span class="token keyword">struct</span> passwd <span class="token operator">*</span><span class="token function">getgrnam</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> passwd <span class="token operator">*</span><span class="token function">getgrgid</span><span class="token punctuation">(</span>gid_t gid<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> group
<span class="token punctuation">{</span>
  <span class="token keyword">char</span> <span class="token operator">*</span>gr_name<span class="token punctuation">;</span>                  <span class="token comment" spellcheck="true">/* &#x7EC4;&#x540D; */</span>
  <span class="token keyword">char</span> <span class="token operator">*</span>gr_passwd<span class="token punctuation">;</span>              <span class="token comment" spellcheck="true">/* &#x5BC6;&#x7801; */</span>
  __gid_t gr_gid<span class="token punctuation">;</span>                  <span class="token comment" spellcheck="true">/* &#x7EC4;ID */</span>
  <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>gr_mem<span class="token punctuation">;</span>                  <span class="token comment" spellcheck="true">/* &#x7EC4;&#x6210;&#x5458;&#x540D;&#x5355; */</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="&#x626B;&#x63CF;&#x5BC6;&#x7801;&#x6587;&#x4EF6;&#x548C;&#x7EC4;&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x8BB0;&#x5F55;"><a href="#&#x626B;&#x63CF;&#x5BC6;&#x7801;&#x6587;&#x4EF6;&#x548C;&#x7EC4;&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x8BB0;&#x5F55;" class="headerlink" title="&#x626B;&#x63CF;&#x5BC6;&#x7801;&#x6587;&#x4EF6;&#x548C;&#x7EC4;&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x8BB0;&#x5F55;"></a>&#x626B;&#x63CF;&#x5BC6;&#x7801;&#x6587;&#x4EF6;&#x548C;&#x7EC4;&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x8BB0;&#x5F55;</h3><p>&#x51FD;&#x6570;setpwent()&#x3001;getpwent()&#x548C;endpwent()&#x7684;&#x4F5C;&#x7528;&#x662F;&#x6309;&#x987A;&#x5E8F;&#x626B;&#x63CF;&#x5BC6;&#x7801;&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x8BB0;&#x5F55;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;pwd.h&gt;</span></span>
<span class="token keyword">struct</span> passwd <span class="token operator">*</span><span class="token function">getpwent</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x53EF;&#x4F7F;&#x7528;&#x4EE5;&#x4E0B;&#x4EE3;&#x7801;&#x904D;&#x5386;&#x6574;&#x4E2A;&#x5BC6;&#x7801;&#x6587;&#x4EF6;&#xFF0C;&#x5E76;&#x6253;&#x5370;&#x51FA;&#x767B;&#x5F55;&#x540D;&#x548C;&#x7528;&#x6237;ID&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">struct</span> passwd <span class="token operator">*</span>pwd<span class="token punctuation">;</span>
<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>pwd<span class="token operator">=</span><span class="token function">getpwent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token constant">NULL</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%-8s %5ld\n&quot;</span><span class="token punctuation">,</span>pwd<span class="token operator">-&gt;</span>pw_name<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span>pwd<span class="token operator">-&gt;</span>pw_uid<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">endpwent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h1 id="&#x65F6;&#x95F4;"><a href="#&#x65F6;&#x95F4;" class="headerlink" title="&#x65F6;&#x95F4;"></a>&#x65F6;&#x95F4;</h1><ul>
<li>&#x7A0B;&#x5E8F;&#x53EF;&#x80FD;&#x4F1A;&#x5173;&#x6CE8;&#x4E24;&#x79CD;&#x65F6;&#x95F4;&#x7C7B;&#x578B;&#x3002;</li>
<li>&#x771F;&#x5B9E;&#x65F6;&#x95F4;&#xFF1A;&#x5EA6;&#x91CF;&#x8FD9;&#x4E00;&#x65F6;&#x95F4;&#x7684;&#x8D77;&#x70B9;&#x6709;&#x4E8C;&#xFF1A;&#x4E00;&#x4E3A;&#x67D0;&#x4E2A;&#x6807;&#x51C6;&#x70B9;&#xFF1B;&#x4E8C;&#x4E3A;&#x8FDB;&#x7A0B;&#x751F;&#x547D;&#x5468;&#x671F;&#x5185;&#x7684;&#x67D0;&#x4E2A;&#x56FA;&#x5B9A;&#x65F6;&#x70B9;&#xFF08;&#x901A;&#x5E38;&#x4E3A;&#x7A0B;&#x5E8F;&#x542F;&#x52A8;&#xFF09;&#x3002;&#x524D;&#x8005;&#x4E3A;&#x65E5;&#x5386;&#xFF08;calendar&#xFF09;&#x65F6;&#x95F4;&#xFF0C;&#x9002;&#x7528;&#x4E8E;&#x9700;&#x8981;&#x5BF9;&#x6570;&#x636E;&#x5E93;&#x8BB0;&#x5F55;&#x6216;&#x6587;&#x4EF6;&#x6253;&#x4E0A;&#x65F6;&#x95F4;&#x6233;&#x7684;&#x7A0B;&#x5E8F;&#xFF1B;&#x540E;&#x8005;&#x5219;&#x79F0;&#x4E4B;&#x4E3A;&#x6D41;&#x901D;&#xFF08;elapsed&#xFF09;&#x65F6;&#x95F4;&#x6216;&#x6302;&#x949F;&#xFF08;wall clock&#xFF09;&#x65F6;&#x95F4;&#xFF0C;&#x4E3B;&#x8981;&#x9488;&#x5BF9;&#x9700;&#x8981;&#x5468;&#x671F;&#x6027;&#x64CD;&#x4F5C;&#x6216;&#x5B9A;&#x671F;&#x4ECE;&#x5916;&#x90E8;&#x8F93;&#x5165;&#x8BBE;&#x5907;&#x8FDB;&#x884C;&#x5EA6;&#x91CF;&#x7684;&#x7A0B;&#x5E8F;&#x3002;<br>&#x8FDB;&#x7A0B;&#x65F6;&#x95F4;&#xFF1A;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x6240;&#x4F7F;&#x7528;&#x7684;CPU&#x65F6;&#x95F4;&#x603B;&#x91CF;&#xFF0C;&#x9002;&#x7528;&#x4E8E;&#x5BF9;&#x7A0B;&#x5E8F;&#x3001;&#x7B97;&#x6CD5;&#x6027;&#x80FD;&#x7684;&#x68C0;&#x67E5;&#x6216;&#x4F18;&#x5316;&#x3002;</li>
</ul>
<p>&#x5927;&#x591A;&#x6570;&#x8BA1;&#x7B97;&#x673A;&#x4F53;&#x7CFB;&#x7ED3;&#x6784;&#x90FD;&#x5185;&#x7F6E;&#x6709;&#x786C;&#x4EF6;&#x65F6;&#x949F;&#xFF0C;&#x4F7F;&#x5185;&#x6838;&#x5F97;&#x4EE5;&#x8BA1;&#x7B97;&#x771F;&#x5B9E;&#x65F6;&#x95F4;&#x548C;&#x8FDB;&#x7A0B;&#x65F6;&#x95F4;&#x3002;</p>
<h2 id="&#x65F6;&#x95F4;&#x8F6C;&#x6362;&#x51FD;&#x6570;"><a href="#&#x65F6;&#x95F4;&#x8F6C;&#x6362;&#x51FD;&#x6570;" class="headerlink" title="&#x65F6;&#x95F4;&#x8F6C;&#x6362;&#x51FD;&#x6570;"></a>&#x65F6;&#x95F4;&#x8F6C;&#x6362;&#x51FD;&#x6570;</h2><h3 id="&#x65E5;&#x5386;&#x65F6;&#x95F4;&#xFF08;Calendar-Time&#xFF09;"><a href="#&#x65E5;&#x5386;&#x65F6;&#x95F4;&#xFF08;Calendar-Time&#xFF09;" class="headerlink" title="&#x65E5;&#x5386;&#x65F6;&#x95F4;&#xFF08;Calendar Time&#xFF09;"></a>&#x65E5;&#x5386;&#x65F6;&#x95F4;&#xFF08;Calendar Time&#xFF09;</h3><p>&#x65E0;&#x8BBA;&#x5730;&#x7406;&#x4F4D;&#x7F6E;&#x5982;&#x4F55;&#xFF0C;UNIX&#x7CFB;&#x7EDF;&#x5185;&#x90E8;&#x5BF9;&#x65F6;&#x95F4;&#x7684;&#x8868;&#x793A;&#x65B9;&#x5F0F;&#x5747;&#x662F;&#x4EE5;&#x81EA;Epoch&#x4EE5;&#x6765;&#x7684;&#x79D2;&#x6570;&#x6765;&#x5EA6;&#x91CF;&#x7684;&#xFF0C;Epoch&#x4EA6;&#x5373;&#x901A;&#x7528;&#x534F;&#x8C03;&#x65F6;&#x95F4;&#xFF08;UTC&#xFF0C;&#x4EE5;&#x524D;&#x4E5F;&#x79F0;&#x4E3A;&#x683C;&#x6797;&#x5A01;&#x6CBB;&#x6807;&#x51C6;&#x65F6;&#x95F4;&#xFF0C;&#x6216;GMT&#xFF09;&#x7684;1970&#x5E74;1&#x6708;1&#x65E5;&#x65E9;&#x6668;&#x96F6;&#x70B9;&#x3002;&#x8FD9;&#x4E5F;&#x662F;UNIX&#x7CFB;&#x7EDF;&#x95EE;&#x4E16;&#x7684;&#x5927;&#x81F4;&#x65E5;&#x671F;&#x3002;&#x65E5;&#x5386;&#x65F6;&#x95F4;&#x5B58;&#x50A8;&#x4E8E;&#x7C7B;&#x578B;&#x4E3A;time_t&#x7684;&#x53D8;&#x91CF;&#x4E2D;&#xFF0C;&#x6B64;&#x7C7B;&#x578B;&#x662F;&#x7531;SUSv3&#x5B9A;&#x4E49;&#x7684;&#x6574;&#x6570;&#x7C7B;&#x578B;&#x3002;<br>&#x5728;32&#x4F4D;Linux&#x7CFB;&#x7EDF;&#xFF0C;time_t&#x662F;&#x4E00;&#x4E2A;&#x6709;&#x7B26;&#x53F7;&#x6574;&#x6570;&#xFF0C;&#x53EF;&#x4EE5;&#x8868;&#x793A;&#x7684;&#x65E5;&#x671F;&#x8303;&#x56F4;&#x4ECE;1901&#x5E74;12&#x6708;13&#x65E5;20&#x65F6;45&#x5206;52&#x79D2;&#x81F3;2038&#x5E74;1&#x6708;19&#x53F7;03:14:07&#x3002;&#xFF08;SUSv3&#x672A;&#x5B9A;&#x4E49;time_t&#x503C;&#x4E3A;&#x8D1F;&#x6570;&#x65F6;&#x7684;&#x542B;&#x4E49;&#x3002;&#xFF09;&#x56E0;&#x6B64;&#xFF0C;&#x5F53;&#x524D;&#x8BB8;&#x591A;32&#x4F4D;UNIX&#x7CFB;&#x7EDF;&#x90FD;&#x9762;&#x4E34;&#x4E00;&#x4E2A;2038&#x5E74;&#x7684;&#x7406;&#x8BBA;&#x95EE;&#x9898;&#xFF0C;&#x5982;&#x679C;&#x6267;&#x884C;&#x7684;&#x8BA1;&#x7B97;&#x5DE5;&#x4F5C;&#x6D89;&#x53CA;&#x672A;&#x6765;&#x65E5;&#x671F;&#xFF0C;&#x90A3;&#x4E48;&#x5728;2038&#x5E74;&#x4E4B;&#x524D;&#x5C31;&#x4F1A;&#x4E0E;&#x4E4B;&#x906D;&#x9047;&#x3002;&#x4E8B;&#x5B9E;&#x4E0A;&#xFF0C;&#x5230;&#x4E86; 2038&#x5E74;&#xFF0C;&#x53EF;&#x80FD;&#x6240;&#x6709;&#x7684;UNIX&#x7CFB;&#x7EDF;&#x90FD;&#x65E9;&#x5DF2;&#x5347;&#x7EA7;&#x4E3A;64&#x4F4D;&#x6216;&#x66F4;&#x591A;&#x4F4D;&#x6570;&#x7684;&#x7CFB;&#x7EDF;&#xFF0C;&#x8FD9;&#x4E00;&#x95EE;&#x9898;&#x4E5F;&#x8BB8;&#x4F1A;&#x968F;&#x4E4B;&#x800C;&#x5927;&#x4E3A;&#x7F13;&#x89E3;&#x3002;&#x7136;&#x800C;&#xFF0C;32&#x4F4D;&#x5D4C;&#x5165;&#x5F0F;&#x7CFB;&#x7EDF;&#xFF0C;&#x7531;&#x4E8E;&#x5176;&#x5BFF;&#x547D;&#x8F83;&#x4E4B;&#x53F0;&#x5F0F;&#x673A;&#x786C;&#x4EF6;&#x66F4;&#x957F;&#xFF0C;&#x6545;&#x800C;&#x4ECD;&#x7136;&#x4F1A;&#x53D7;&#x6B64;&#x95EE;&#x9898;&#x7684;&#x56F0;&#x6270;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x5BF9;&#x4E8E;&#x4F9D;&#x7136;&#x4EE5;32&#x4F4D;time_t&#x683C;&#x5F0F;&#x4FDD;&#x5B58;&#x65F6;&#x95F4;&#x7684;&#x5386;&#x53F2;&#x6570;&#x636E;&#x548C;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#xFF0C;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x5C06;&#x4F9D;&#x7136;&#x5B58;&#x5728;&#x3002;</p>
<p>&#x4E4B;&#x6240;&#x4EE5;&#x5B58;&#x5728;&#x4E24;&#x4E2A;&#x672C;&#x8D28;&#x4E0A;&#x76EE;&#x7684;&#x76F8;&#x540C;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF08;time()&#x548C;gettimeofday()&#xFF09;&#xFF0C;&#x81EA;&#x6709;&#x5176;&#x5386;&#x53F2;&#x539F;&#x56E0;&#x3002;&#x65E9;&#x671F;&#x7684;UNIX&#x5B9E;&#x73B0;&#x63D0;&#x4F9B;&#x4E86;time()&#x3002;&#x800C;4.3BSD&#x53C8;&#x8865;&#x5145;&#x4E86;&#x66F4;&#x4E3A;&#x7CBE;&#x786E;&#x7684;gettimeofday()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x3002;&#x8FD9;&#x65F6;&#xFF0C;&#x518D;&#x5C06; time()&#x4F5C;&#x4E3A;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5C31;&#x663E;&#x5F97;&#x591A;&#x4F59;&#xFF0C;&#x53EF;&#x4EE5;&#x5C06;&#x5176;&#x5B9E;&#x73B0;&#x4E3A;&#x4E00;&#x4E2A;&#x8C03;&#x7528;gettimeofday()&#x7684;&#x5E93;&#x51FD;&#x6570;&#x3002;</p>
<p>&#x7CFB;&#x7EDF;&#x8C03;&#x7528;gettimeofday()&#xFF0C;&#x53EF;&#x4E8E;tv&#x6307;&#x5411;&#x7684;&#x7F13;&#x51B2;&#x533A;&#x4E2D;&#x8FD4;&#x56DE;&#x65E5;&#x5386;&#x65F6;&#x95F4;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;sys/time.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">gettimeofday</span><span class="token punctuation">(</span><span class="token keyword">struct</span> timeval <span class="token operator">*</span>tv<span class="token punctuation">,</span> <span class="token keyword">struct</span> timezone <span class="token operator">*</span>tz<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span>  timeval<span class="token punctuation">{</span>
    <span class="token keyword">long</span>  tv_sec<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/*&#x79D2;*/</span>
    <span class="token keyword">long</span>  tv_usec<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/*&#x5FAE;&#x5999;*/</span>
<span class="token punctuation">}</span>&#xFF1B;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>gettimeofday()&#x4F1A;&#x628A;&#x76EE;&#x524D;&#x7684;&#x65F6;&#x95F4;&#x7528;tv &#x7ED3;&#x6784;&#x4F53;&#x8FD4;&#x56DE;&#xFF0C;&#x5F53;&#x5730;&#x65F6;&#x533A;&#x7684;&#x4FE1;&#x606F;&#x5219;&#x653E;&#x5230;tz&#x6240;&#x6307;&#x7684;&#x7ED3;&#x6784;&#x4E2D;.<br>gettimeofday()&#x7684;&#x53C2;&#x6570;tz&#x662F;&#x4E2A;&#x5386;&#x53F2;&#x4EA7;&#x7269;&#x3002;&#x65E9;&#x671F;&#x7684;UNIX&#x5B9E;&#x73B0;&#x7528;&#x5176;&#x6765;&#x83B7;&#x53D6;&#x7CFB;&#x7EDF;&#x7684;&#x65F6;&#x533A;&#x4FE1;&#x606F;&#xFF0C;&#x76EE;&#x524D;&#x5DF2;&#x906D;&#x5E9F;&#x5F03;&#xFF0C;&#x5E94;&#x59CB;&#x7EC8;&#x5C06;&#x5176;&#x7F6E;&#x4E3A;NULL&#x3002;</p>
<p>time()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x8FD4;&#x56DE;&#x81EA; Epoch &#x4EE5;&#x6765;&#x7684;&#x79D2;&#x6570;&#xFF08;&#x548C;&#x51FD;&#x6570; gettimeofday()&#x6240;&#x8FD4;&#x56DE;&#x7684; tv &#x53C2;&#x6570;&#x4E2D;tv_sec&#x5B57;&#x6BB5;&#x7684;&#x6570;&#x503C;&#x76F8;&#x540C;&#xFF09;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;time.h&gt;</span></span>
time_t <span class="token function">time</span><span class="token punctuation">(</span>time_t <span class="token operator">*</span>timep<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x6210;&#x529F;&#x8FD4;&#x56DE;&#x65F6;&#x95F4;&#xFF0C;&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="&#x5C06;time-t&#x8F6C;&#x6362;&#x4E3A;&#x53EF;&#x6253;&#x5370;&#x683C;&#x5F0F;"><a href="#&#x5C06;time-t&#x8F6C;&#x6362;&#x4E3A;&#x53EF;&#x6253;&#x5370;&#x683C;&#x5F0F;" class="headerlink" title="&#x5C06;time_t&#x8F6C;&#x6362;&#x4E3A;&#x53EF;&#x6253;&#x5370;&#x683C;&#x5F0F;"></a>&#x5C06;time_t&#x8F6C;&#x6362;&#x4E3A;&#x53EF;&#x6253;&#x5370;&#x683C;&#x5F0F;</h3><p>&#x4E3A;&#x4E86;&#x5C06;time_t&#x8F6C;&#x6362;&#x4E3A;&#x53EF;&#x6253;&#x5370;&#x683C;&#x5F0F;&#xFF0C;ctime()&#x51FD;&#x6570;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x65B9;&#x6CD5;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;time.h&gt;</span></span>
<span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">ctime</span><span class="token punctuation">(</span><span class="token keyword">const</span> time_t <span class="token operator">*</span>timep<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x5931;&#x8D25;&#x8FD4;&#x56DE;&#x7A7A;&#x6307;&#x9488;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x628A;&#x4E00;&#x4E2A;&#x6307;&#x5411;time_t&#x7684;&#x6307;&#x9488;&#x4F5C;&#x4E3A;timep&#x53C2;&#x6570;&#x4F20;&#x5165;&#x51FD;&#x6570;ctime()&#xFF0C;&#x5C06;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x957F;&#x8FBE;26&#x5B57;&#x8282;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x5185;&#x542B;&#x6807;&#x51C6;&#x683C;&#x5F0F;&#x7684;&#x65E5;&#x671F;&#x548C;&#x65F6;&#x95F4;&#x3002;</p>
<h3 id="time-t&#x548C;&#x5206;&#x89E3;&#x65F6;&#x95F4;&#x4E4B;&#x95F4;&#x7684;&#x8F6C;&#x6362;"><a href="#time-t&#x548C;&#x5206;&#x89E3;&#x65F6;&#x95F4;&#x4E4B;&#x95F4;&#x7684;&#x8F6C;&#x6362;" class="headerlink" title="time_t&#x548C;&#x5206;&#x89E3;&#x65F6;&#x95F4;&#x4E4B;&#x95F4;&#x7684;&#x8F6C;&#x6362;"></a>time_t&#x548C;&#x5206;&#x89E3;&#x65F6;&#x95F4;&#x4E4B;&#x95F4;&#x7684;&#x8F6C;&#x6362;</h3><p>&#x51FD;&#x6570;gmtime()&#x548C;localtime()&#x53EF;&#x5C06;&#x4E00;time_t&#x503C;&#x8F6C;&#x6362;&#x4E3A;&#x4E00;&#x4E2A;&#x6240;&#x8C13;&#x7684;&#x5206;&#x89E3;&#x65F6;&#x95F4;&#xFF08;broken-down time)&#x3002;&#x5206;&#x89E3;&#x65F6;&#x95F4;&#x88AB;&#x7F6E;&#x4E8E;&#x4E00;&#x4E2A;&#x7ECF;&#x7531;&#x9759;&#x6001;&#x5206;&#x914D;&#x7684;&#x7ED3;&#x6784;&#x4E2D;&#xFF0C;&#x5176;&#x5730;&#x5740;&#x5219;&#x4F5C;&#x4E3A;&#x51FD;&#x6570;&#x7ED3;&#x679C;&#x8FD4;&#x56DE;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;time.h&gt;</span></span>
<span class="token keyword">struct</span> tm <span class="token operator">*</span><span class="token function">gmtime</span><span class="token punctuation">(</span><span class="token keyword">const</span> time_t <span class="token operator">*</span>timep<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> tm <span class="token operator">*</span><span class="token function">localtime</span><span class="token punctuation">(</span><span class="token keyword">const</span> time_t <span class="token operator">*</span>timep<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> tm<span class="token punctuation">{</span>
    <span class="token keyword">int</span> tm_sec<span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//&#x53D6;&#x503C;[0,59]&#xFF0C;&#x975E;&#x6B63;&#x5E38;&#x60C5;&#x51B5;&#x4E0B;&#x53EF;&#x5230;&#x8FBE;61</span>
    <span class="token keyword">int</span> tm_min<span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//&#x53D6;&#x503C;&#x540C;&#x4E0A;</span>
    <span class="token keyword">int</span> tm_hour<span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//&#x53D6;&#x503C;[0,23]</span>
    <span class="token keyword">int</span> tm_mday<span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//&#x53D6;&#x503C;[1,31]</span>
    <span class="token keyword">int</span> tm_mon<span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//&#x53D6;&#x503C;[0,11]</span>
    <span class="token keyword">int</span> tm_year<span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//1900&#x5E74;&#x8D77;&#x8DDD;&#x4ECA;&#x7684;&#x5E74;&#x6570;</span>
    <span class="token keyword">int</span> tm_wday<span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//&#x53D6;&#x503C;[0,6]</span>
    <span class="token keyword">int</span> tm_yday<span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//&#x53D6;&#x503C;[0&#xFF0C;366]</span>
    <span class="token keyword">int</span> tm_isdst<span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//&#x590F;&#x4EE4;&#x65F6;&#x6807;&#x5FD7;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x51FD;&#x6570;gmtime()&#x80FD;&#x591F;&#x628A;&#x65E5;&#x5386;&#x65F6;&#x95F4;&#x8F6C;&#x6362;&#x4E3A;&#x4E00;&#x4E2A;&#x5BF9;&#x5E94;&#x4E8E;UTC&#x7684;&#x5206;&#x89E3;&#x65F6;&#x95F4;&#x3002;&#xFF08;&#x5B57;&#x6BCD;GM&#x6E90;&#x4E8E;&#x683C;&#x6797;&#x5A01;&#x6CBB;&#x6807;&#x51C6;&#x65F6;&#x95F4;&#xFF09;&#x3002;<br>&#x76F8;&#x5F62;&#x4E4B;&#x4E0B;&#xFF0C;&#x51FD;&#x6570;localtime()&#x9700;&#x8981;&#x8003;&#x8651;&#x65F6;&#x533A;&#x548C;&#x590F;&#x4EE4;&#x65F6;&#x8BBE;&#x7F6E;&#xFF0C;&#x8FD4;&#x56DE;&#x5BF9;&#x5E94;&#x4E8E;&#x7CFB;&#x7EDF;&#x672C;&#x5730;&#x65F6;&#x95F4;&#x7684;&#x4E00;&#x4E2A;&#x5206;&#x89E3;&#x65F6;&#x95F4;&#x3002;</p>
<p>&#x51FD;&#x6570; mktime() &#x5C06;&#x4E00;&#x4E2A;&#x672C;&#x5730;&#x65F6;&#x533A;&#x7684;&#x5206;&#x89E3;&#x65F6;&#x95F4;&#x7FFB;&#x8BD1;&#x4E3A; time_t&#x503C;&#xFF0C;&#x5E76;&#x5C06;&#x5176;&#x4F5C;&#x4E3A;&#x51FD;&#x6570;&#x7ED3;&#x679C;&#x8FD4;&#x56DE;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;time.h&gt;</span></span>
time_t <span class="token operator">*</span><span class="token function">mktime</span><span class="token punctuation">(</span><span class="token keyword">struct</span> tm <span class="token operator">*</span>timeptr<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="&#x5206;&#x89E3;&#x65F6;&#x95F4;&#x548C;&#x6253;&#x5370;&#x683C;&#x5F0F;&#x4E4B;&#x95F4;&#x7684;&#x8F6C;&#x6362;"><a href="#&#x5206;&#x89E3;&#x65F6;&#x95F4;&#x548C;&#x6253;&#x5370;&#x683C;&#x5F0F;&#x4E4B;&#x95F4;&#x7684;&#x8F6C;&#x6362;" class="headerlink" title="&#x5206;&#x89E3;&#x65F6;&#x95F4;&#x548C;&#x6253;&#x5370;&#x683C;&#x5F0F;&#x4E4B;&#x95F4;&#x7684;&#x8F6C;&#x6362;"></a>&#x5206;&#x89E3;&#x65F6;&#x95F4;&#x548C;&#x6253;&#x5370;&#x683C;&#x5F0F;&#x4E4B;&#x95F4;&#x7684;&#x8F6C;&#x6362;</h3><p>&#x5728;&#x53C2;&#x6570;tm&#x4E2D;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;&#x6307;&#x5411;&#x5206;&#x89E3;&#x65F6;&#x95F4;&#x7ED3;&#x6784;&#x7684;&#x6307;&#x9488;&#xFF0C;asctime()&#x5219;&#x4F1A;&#x8FD4;&#x56DE;&#x4E00;&#x6307;&#x9488;&#xFF0C;&#x6307;&#x5411;&#x7ECF;&#x7531;&#x9759;&#x6001;&#x5206;&#x914D;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x5185;&#x542B;&#x65F6;&#x95F4;&#xFF0C;&#x683C;&#x5F0F;&#x5219;&#x4E0E;ctime ()&#x76F8;&#x540C;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;time.h&gt;</span></span>
<span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">asctime</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">struct</span> tm <span class="token operator">*</span>timeptr<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x5F53;&#x628A;&#x4E00;&#x4E2A;&#x5206;&#x89E3;&#x65F6;&#x95F4;&#x8F6C;&#x6362;&#x6210;&#x6253;&#x5370;&#x683C;&#x5F0F;&#x65F6;&#xFF0C;&#x51FD;&#x6570; strftime()&#x53EF;&#x4EE5;&#x63D0;&#x4F9B;&#x66F4;&#x4E3A;&#x7CBE;&#x786E;&#x7684;&#x63A7;&#x5236;&#x3002;&#x4EE4;timeptr&#x6307;&#x5411;&#x5206;&#x89E3;&#x65F6;&#x95F4;&#xFF0C;strftime()&#x4F1A;&#x5C06;&#x4EE5;null&#x7ED3;&#x5C3E;&#x3001;&#x7531;&#x65E5;&#x671F;&#x548C;&#x65F6;&#x95F4;&#x7EC4;&#x6210;&#x7684;&#x76F8;&#x5E94;&#x5B57;&#x7B26;&#x4E32;&#x7F6E;&#x4E8E;outstr&#x6240;&#x6307;&#x5411;&#x7684;&#x7F13;&#x51B2;&#x533A;&#x4E2D;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;time.h&gt;</span></span>
size_t <span class="token function">strftime</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>outstr<span class="token punctuation">,</span>size_t maxsize<span class="token punctuation">,</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>format<span class="token punctuation">,</span><span class="token keyword">const</span>  <span class="token keyword">struct</span> tm <span class="token operator">*</span>timeptr<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x5931;&#x8D25;&#x8FD4;&#x56DE;0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>outstr&#x4E2D;&#x8FD4;&#x56DE;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x6309;&#x7167;format&#x53C2;&#x6570;&#x5B9A;&#x4E49;&#x7684;&#x683C;&#x5F0F;&#x505A;&#x4E86;&#x683C;&#x5F0F;&#x5316;&#x3002;Maxsize&#x53C2;&#x6570;&#x6307;&#x5B9A; outstr&#x7684;&#x6700;&#x5927;&#x957F;&#x5EA6;&#x3002;&#x4E0D;&#x540C;&#x4E8E; ctime()&#x548C;asctime()&#xFF0C;strftime()&#x4E0D;&#x4F1A;&#x5728;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x7ED3;&#x5C3E;&#x5305;&#x62EC;&#x6362;&#x884C;&#x7B26;&#xFF08;&#x9664;&#x975E;format&#x4E2D;&#x5B9A;&#x4E49;&#x6709;&#x6362;&#x884C;&#x7B26;&#xFF09;&#x3002;</p>
<h3 id="&#x5C06;&#x6253;&#x5370;&#x683C;&#x5F0F;&#x65F6;&#x95F4;&#x8F6C;&#x6362;&#x4E3A;&#x5206;&#x89E3;&#x65F6;&#x95F4;"><a href="#&#x5C06;&#x6253;&#x5370;&#x683C;&#x5F0F;&#x65F6;&#x95F4;&#x8F6C;&#x6362;&#x4E3A;&#x5206;&#x89E3;&#x65F6;&#x95F4;" class="headerlink" title="&#x5C06;&#x6253;&#x5370;&#x683C;&#x5F0F;&#x65F6;&#x95F4;&#x8F6C;&#x6362;&#x4E3A;&#x5206;&#x89E3;&#x65F6;&#x95F4;"></a>&#x5C06;&#x6253;&#x5370;&#x683C;&#x5F0F;&#x65F6;&#x95F4;&#x8F6C;&#x6362;&#x4E3A;&#x5206;&#x89E3;&#x65F6;&#x95F4;</h3><p>&#x51FD;&#x6570;strptime()&#x662F;strftime()&#x7684;&#x9006;&#x5411;&#x51FD;&#x6570;&#xFF0C;&#x5C06;&#x5305;&#x542B;&#x65E5;&#x671F;&#x548C;&#x65F6;&#x95F4;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x8F6C;&#x6362;&#x6210;&#x4E00;&#x5206;&#x89E3;&#x65F6;&#x95F4;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;time.h&gt;</span></span>
<span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">strptime</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">,</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>format<span class="token punctuation">,</span> <span class="token keyword">struct</span> tm <span class="token operator">*</span>timeptr<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h2 id="&#x65F6;&#x533A;"><a href="#&#x65F6;&#x533A;" class="headerlink" title="&#x65F6;&#x533A;"></a>&#x65F6;&#x533A;</h2><p>&#x4E0D;&#x540C;&#x7684;&#x56FD;&#x5BB6;&#xFF08;&#x6709;&#x65F6;&#x751A;&#x81F3;&#x662F;&#x540C;&#x4E00;&#x56FD;&#x5BB6;&#x5185;&#x7684;&#x4E0D;&#x540C;&#x5730;&#x533A;&#xFF09;&#x4F7F;&#x7528;&#x4E0D;&#x540C;&#x7684;&#x65F6;&#x533A;&#x548C;&#x590F;&#x65F6;&#x5236;&#x3002;&#x5BF9;&#x4E8E;&#x8981;&#x8F93;&#x5165;&#x548C;&#x8F93;&#x51FA;&#x65F6;&#x95F4;&#x7684;&#x7A0B;&#x5E8F;&#x6765;&#x8BF4;&#xFF0C;&#x5FC5;&#x987B;&#x5BF9;&#x7CFB;&#x7EDF;&#x6240;&#x5904;&#x7684;&#x65F6;&#x533A;&#x548C;&#x590F;&#x65F6;&#x5236;&#x52A0;&#x4EE5;&#x8003;&#x8651;&#x3002;</p>
<p>&#x65F6;&#x533A;&#x4FE1;&#x606F;&#x5F80;&#x5F80;&#x662F;&#x65E2;&#x6D69;&#x7E41;&#x53C8;&#x591A;&#x53D8;&#x7684;&#x3002;&#x51FA;&#x4E8E;&#x8FD9;&#x4E00;&#x539F;&#x56E0;&#xFF0C;&#x7CFB;&#x7EDF;&#x6CA1;&#x6709;&#x5C06;&#x5176;&#x76F4;&#x63A5;&#x7F16;&#x7801;&#x4E8E;&#x7A0B;&#x5E8F;&#x6216;&#x51FD;&#x6570;&#x5E93;&#x4E2D;&#xFF0C;&#x800C;&#x662F;&#x4EE5;&#x6807;&#x51C6;&#x683C;&#x5F0F;&#x4FDD;&#x5B58;&#x4E8E;&#x6587;&#x4EF6;&#x4E2D;&#xFF0C;&#x5E76;&#x52A0;&#x4EE5;&#x7EF4;&#x62A4;&#x3002;</p>
<p>&#x8FD9;&#x4E9B;&#x6587;&#x4EF6;&#x4F4D;&#x4E8E;&#x76EE;&#x5F55;/usr/share/zoneinfo&#x4E2D;&#x3002;&#x8BE5;&#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x6BCF;&#x4E2A;&#x6587;&#x4EF6;&#x90FD;&#x5305;&#x542B;&#x4E86;&#x4E00;&#x4E2A;&#x7279;&#x5B9A;&#x56FD;&#x5BB6;&#x6216;&#x5730;&#x533A;&#x5185;&#x65F6;&#x533A;&#x5236;&#x5EA6;&#x7684;&#x76F8;&#x5173;&#x4FE1;&#x606F;&#xFF0C;&#x4E14;&#x5F80;&#x5F80;&#x6839;&#x636E;&#x5176;&#x6240;&#x63CF;&#x8FF0;&#x7684;&#x65F6;&#x533A;&#x6765;&#x52A0;&#x4EE5;&#x547D;&#x540D;&#xFF0C;&#x8BF8;&#x5982;EST&#xFF08;&#x7F8E;&#x56FD;&#x4E1C;&#x90E8;&#x6807;&#x51C6;&#x65F6;&#x95F4;&#xFF09;&#x3001;CET&#xFF08;&#x6B27;&#x6D32;&#x4E2D;&#x90E8;&#x65F6;&#x95F4;&#xFF09;&#x3001;UTC&#x3001;Turkey&#x548C;Iran&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x5B50;&#x76EE;&#x5F55;&#x5BF9;&#x76F8;&#x5173;&#x65F6;&#x533A;&#x8FDB;&#x884C;&#x6709;&#x5C42;&#x6B21;&#x7684;&#x5206;&#x7EC4;&#x3002;&#x4F8B;&#x5982;&#xFF0C;Pacific &#x76EE;&#x5F55;&#x5C31;&#x53EF;&#x80FD;&#x5305;&#x542B;&#x6587;&#x4EF6; Auckland&#x3001;Port_Moresby&#x548C;Galapagos&#x3002;&#x5728;&#x7A0B;&#x5E8F;&#x4E2D;&#x6307;&#x5B9A;&#x4F7F;&#x7528;&#x7684;&#x65F6;&#x533A;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x662F;&#x6307;&#x5B9A;&#x8BE5;&#x76EE;&#x5F55;&#x4E0B;&#x67D0;&#x4E00;&#x65F6;&#x533A;&#x6587;&#x4EF6;&#x7684;&#x76F8;&#x5BF9;&#x8DEF;&#x5F84;&#x540D;&#x3002;</p>
<p>&#x7CFB;&#x7EDF;&#x7684;&#x672C;&#x5730;&#x65F6;&#x95F4;&#x7531;&#x65F6;&#x533A;&#x6587;&#x4EF6;/etc/localtime&#x5B9A;&#x4E49;&#xFF0C;&#x901A;&#x5E38;&#x94FE;&#x63A5;&#x5230;/usr/share/zoneinfo&#x4E0B;&#x7684;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x3002;</p>
<p>&#x4E3A;&#x8FD0;&#x884C;&#x4E2D;&#x7684;&#x7A0B;&#x5E8F;&#x6307;&#x5B9A;&#x4E00;&#x4E2A;&#x65F6;&#x533A;&#xFF0C;&#x9700;&#x8981;&#x5C06;TZ&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x8BBE;&#x7F6E;&#x4E3A;&#x7531;&#x4E00;&#x5192;&#x53F7;(:)&#x548C;&#x65F6;&#x533A;&#x540D;&#x79F0;&#x7EC4;&#x6210;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x5176;&#x4E2D;&#x65F6;&#x533A;&#x540D;&#x79F0;&#x5B9A;&#x4E49;&#x4E8E;/usr/share/zoneinfo&#x4E2D;&#x3002;&#x8BBE;&#x7F6E;&#x65F6;&#x533A;&#x4F1A;&#x81EA;&#x52A8;&#x5F71;&#x54CD;&#x5230;&#x51FD;&#x6570;ctime()&#x3001;localtime()&#x3001;mktime()&#x548C;strftime()&#x3002;</p>
<h2 id="&#x5730;&#x533A;&#xFF08;Locale&#xFF09;"><a href="#&#x5730;&#x533A;&#xFF08;Locale&#xFF09;" class="headerlink" title="&#x5730;&#x533A;&#xFF08;Locale&#xFF09;"></a>&#x5730;&#x533A;&#xFF08;Locale&#xFF09;</h2><p>&#x4E16;&#x754C;&#x5404;&#x5730;&#x5728;&#x4F7F;&#x7528;&#x6570;&#x5343;&#x79CD;&#x8BED;&#x8A00;&#xFF0C;&#x5176;&#x4E2D;&#x5728;&#x8BA1;&#x7B97;&#x673A;&#x7CFB;&#x7EDF;&#x4E0A;&#x7ECF;&#x5E38;&#x4F7F;&#x7528;&#x7684;&#x5360;&#x4E86;&#x76F8;&#x5F53;&#x6BD4;&#x4F8B;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x5728;&#x663E;&#x793A;&#x8BF8;&#x5982;&#x6570;&#x5B57;&#x3001;&#x8D27;&#x5E01;&#x91D1;&#x989D;&#x3001;&#x65E5;&#x671F;&#x548C;&#x65F6;&#x95F4;&#x4E4B;&#x7C7B;&#x7684;&#x4FE1;&#x606F;&#x65F6;&#xFF0C;&#x4E0D;&#x540C;&#x56FD;&#x5BB6;&#x7684;&#x4E60;&#x4FD7;&#x4E5F;&#x4E0D;&#x540C;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x5927;&#x591A;&#x6570;&#x6B27;&#x6D32;&#x56FD;&#x5BB6;&#x4F7F;&#x7528;&#x9017;&#x53F7;&#xFF0C;&#x800C;&#x975E;&#x5C0F;&#x6570;&#x70B9;&#x6765;&#x5206;&#x9694;&#x5B9E;&#x6570;&#x7684;&#x6574;&#x6570;&#x548C;&#x5C0F;&#x6570;&#x90E8;&#x5206;&#xFF0C;&#x5927;&#x591A;&#x6570;&#x56FD;&#x5BB6;&#x65E5;&#x671F;&#x7684;&#x4E66;&#x5199;&#x683C;&#x5F0F;&#x4E5F;&#x4E0E;&#x7F8E;&#x56FD;&#x6240;&#x91C7;&#x7528;&#x7684;MM/DD/ YY&#x683C;&#x5F0F;&#x5E76;&#x4E0D;&#x76F8;&#x540C;&#x3002;SUSv3&#x5BF9; locale&#x7684;&#x5B9A;&#x4E49;&#x4E3A;&#xFF1A;&#x7528;&#x6237;&#x73AF;&#x5883;&#x4E2D;&#x4F9D;&#x8D56;&#x4E8E;&#x8BED;&#x8A00;&#x548C;&#x6587;&#x5316;&#x4E60;&#x4FD7;&#x7684;&#x4E00;&#x4E2A;&#x5B50;&#x96C6;&#x3002;<br>&#x548C;&#x65F6;&#x533A;&#x4FE1;&#x606F;&#x4E00;&#x6837;&#xFF0C;&#x5730;&#x533A;&#x4FE1;&#x606F;&#x540C;&#x6837;&#x662F;&#x65E2;&#x6D69;&#x7E41;&#x4E14;&#x591A;&#x53D8;&#x7684;&#x3002;&#x51FA;&#x4E8E;&#x8FD9;&#x4E00;&#x539F;&#x56E0;&#xFF0C;&#x4E0E;&#x5176;&#x8981;&#x6C42;&#x5404;&#x4E2A;&#x7A0B;&#x5E8F;&#x548C;&#x51FD;&#x6570;&#x5E93;&#x6765;&#x5B58;&#x50A8;&#x5730;&#x533A;&#x4FE1;&#x606F;&#xFF0C;&#x8FD8;&#x4E0D;&#x5982;&#x7531;&#x7CFB;&#x7EDF;&#x6309;&#x6807;&#x51C6;&#x683C;&#x5F0F;&#x5C06;&#x5730;&#x533A;&#x4FE1;&#x606F;&#x5B58;&#x50A8;&#x4E8E;&#x6587;&#x4EF6;&#x4E2D;&#xFF0C;&#x5E76;&#x52A0;&#x4EE5;&#x7EF4;&#x62A4;&#x3002;</p>
<p>&#x5730;&#x533A;&#x4FE1;&#x606F;&#x7EF4;&#x62A4;&#x4E8E;/usr/share/local&#xFF08;&#x5728;&#x4E00;&#x4E9B;&#x53D1;&#x884C;&#x7248;&#x672C;&#x4E2D;&#x4E3A;/usr/lib/local&#xFF09;&#x4E4B;&#x4E0B;&#x7684;&#x76EE;&#x5F55;&#x5C42;&#x6B21;&#x7ED3;&#x6784;&#x4E2D;&#x3002;&#x8BE5;&#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x6BCF;&#x4E2A;&#x5B50;&#x76EE;&#x5F55;&#x90FD;&#x5305;&#x542B;&#x4E00;&#x7279;&#x5B9A;&#x5730;&#x533A;&#x7684;&#x4FE1;&#x606F;&#x3002;</p>
<p>&#x51FD;&#x6570;setlocale()&#x65E2;&#x53EF;&#x8BBE;&#x7F6E;&#x4E5F;&#x53EF;&#x67E5;&#x8BE2;&#x7A0B;&#x5E8F;&#x7684;&#x5F53;&#x524D;&#x5730;&#x533A;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;local.h&gt;</span></span>
<span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">setlocale</span> <span class="token punctuation">(</span><span class="token keyword">int</span> category<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> locale<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>category&#x53C2;&#x6570;&#x9009;&#x62E9;&#x8BBE;&#x7F6E;&#x6216;&#x67E5;&#x8BE2;&#x5730;&#x533A;&#x7684;&#x54EA;&#x4E00;&#x90E8;&#x5206;&#xFF0C;&#x5B83;&#x4EC5;&#x80FD;&#x4F7F;&#x7528;&#x8868; 10-2&#x4E2D;&#x5217;&#x51FA;&#x7684;&#x5730;&#x533A;&#x7C7B;&#x522B;&#x7684;&#x5E38;&#x91CF;&#x540D;&#x79F0;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x5B83;&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&#x5730;&#x533A;&#x7684;&#x65F6;&#x95F4;&#x663E;&#x793A;&#x683C;&#x5F0F;&#x662F;&#x5FB7;&#x56FD;&#xFF0C;&#x800C;&#x5730;&#x533A;&#x7684;&#x8D27;&#x5E01;&#x7B26;&#x53F7;&#x662F;&#x7F8E;&#x5143;&#x3002;&#x6216;&#x8005;&#xFF0C;&#x66F4;&#x5E38;&#x89C1;&#x7684;&#x662F;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5229;&#x7528;LC_ALL&#x6765;&#x6307;&#x5B9A;&#x6211;&#x4EEC;&#x8981;&#x8BBE;&#x7F6E;&#x7684;&#x5730;&#x533A;&#x7684;&#x6240;&#x6709;&#x90E8;&#x5206;&#x7684;&#x503C;&#x3002;</p>
<h2 id="&#x66F4;&#x65B0;&#x7CFB;&#x7EDF;&#x65F6;&#x949F;"><a href="#&#x66F4;&#x65B0;&#x7CFB;&#x7EDF;&#x65F6;&#x949F;" class="headerlink" title="&#x66F4;&#x65B0;&#x7CFB;&#x7EDF;&#x65F6;&#x949F;"></a>&#x66F4;&#x65B0;&#x7CFB;&#x7EDF;&#x65F6;&#x949F;</h2><p>&#x6211;&#x4EEC;&#x73B0;&#x5728;&#x6765;&#x770B;&#x4E24;&#x4E2A;&#x66F4;&#x65B0;&#x7CFB;&#x7EDF;&#x65F6;&#x949F;&#x7684;&#x63A5;&#x53E3;&#xFF1A;settimeofday()&#x548C;adjtime()&#x3002;&#x8FD9;&#x4E9B;&#x63A5;&#x53E3;&#x90FD;&#x5F88;&#x5C11;&#x88AB;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4F7F;&#x7528;&#xFF0C;&#x56E0;&#x4E3A;&#x7CFB;&#x7EDF;&#x65F6;&#x95F4;&#x901A;&#x5E38;&#x662F;&#x7531;&#x5DE5;&#x5177;&#x8F6F;&#x4EF6;&#x7EF4;&#x62A4;&#xFF0C;&#x5982;&#x7F51;&#x7EDC;&#x65F6;&#x95F4;&#x534F;&#x8BAE;&#xFF08;Network Time Protocol&#xFF09;&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#xFF0C;&#x5E76;&#x4E14;&#x5B83;&#x4EEC;&#x9700;&#x8981;&#x8C03;&#x7528;&#x8005;&#x5DF2;&#x88AB;&#x6388;&#x6743;&#xFF08;CAP_SYS_TIME&#xFF09;&#x3002;<br>&#x7CFB;&#x7EDF;&#x8C03;&#x7528;settimeofday()&#x662F;gettimeofday()&#x7684;&#x9006;&#x5411;&#x64CD;&#x4F5C;&#xFF08;&#x8FD9;&#x662F;&#x6211;&#x4EEC;&#x5728;10.1&#x8282;&#x4E2D;&#x63CF;&#x8FF0;&#x7684;&#xFF09;&#x3002;&#x5B83;&#x5C06;tv&#x6307;&#x5411;timeval&#x7ED3;&#x6784;&#x4F53;&#x91CC;&#x7684;&#x79D2;&#x6570;&#x548C;&#x5FAE;&#x79D2;&#x6570;&#xFF0C;&#x8BBE;&#x7F6E;&#x5230;&#x7CFB;&#x7EDF;&#x7684;&#x65E5;&#x5386;&#x65F6;&#x95F4;&#x3002;</p>
<h2 id="&#x8FDB;&#x7A0B;&#x65F6;&#x95F4;"><a href="#&#x8FDB;&#x7A0B;&#x65F6;&#x95F4;" class="headerlink" title="&#x8FDB;&#x7A0B;&#x65F6;&#x95F4;"></a>&#x8FDB;&#x7A0B;&#x65F6;&#x95F4;</h2><p>&#x8FDB;&#x7A0B;&#x65F6;&#x95F4;&#x662F;&#x8FDB;&#x7A0B;&#x521B;&#x5EFA;&#x540E;&#x4F7F;&#x7528;&#x7684;CPU&#x65F6;&#x95F4;&#x6570;&#x91CF;&#x3002;&#x51FA;&#x4E8E;&#x8BB0;&#x5F55;&#x7684;&#x76EE;&#x7684;&#xFF0C;&#x5185;&#x6838;&#x628A;CPU&#x65F6;&#x95F4;&#x5206;&#x6210;&#x4EE5;&#x4E0B;&#x4E24;&#x90E8;&#x5206;&#x3002;</p>
<ul>
<li>&#x7528;&#x6237; CPU &#x65F6;&#x95F4;&#x662F;&#x5728;&#x7528;&#x6237;&#x6A21;&#x5F0F;&#x4E0B;&#x6267;&#x884C;&#x6240;&#x82B1;&#x8D39;&#x7684;&#x65F6;&#x95F4;&#x6570;&#x91CF;&#x3002;&#x6709;&#x65F6;&#x4E5F;&#x79F0;&#x4E3A;&#x865A;&#x62DF;&#x65F6;&#x95F4;&#xFF08;virtual time&#xFF09;&#xFF0C;&#x8FD9;&#x5BF9;&#x4E8E;&#x7A0B;&#x5E8F;&#x6765;&#x8BF4;&#xFF0C;&#x662F;&#x5B83;&#x5DF2;&#x7ECF;&#x5F97;&#x5230;CPU&#x7684;&#x65F6;&#x95F4;&#x3002;</li>
<li>&#x7CFB;&#x7EDF;CPU&#x65F6;&#x95F4;&#x662F;&#x5728;&#x5185;&#x6838;&#x6A21;&#x5F0F;&#x4E2D;&#x6267;&#x884C;&#x6240;&#x82B1;&#x8D39;&#x7684;&#x65F6;&#x95F4;&#x6570;&#x91CF;&#x3002;&#x8FD9;&#x662F;&#x5185;&#x6838;&#x7528;&#x4E8E;&#x6267;&#x884C;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x6216;&#x4EE3;&#x8868;&#x7A0B;&#x5E8F;&#x6267;&#x884C;&#x7684;&#x5176;&#x4ED6;&#x4EFB;&#x52A1;&#xFF08;&#x4F8B;&#x5982;&#xFF0C;&#x670D;&#x52A1;&#x9875;&#x9519;&#x8BEF;&#xFF09;&#x7684;&#x65F6;&#x95F4;&#x3002;</li>
</ul>
<p>&#x5F53;&#x6211;&#x4EEC;&#x8FD0;&#x884C;&#x4E00;&#x4E2A;shell&#x7A0B;&#x5E8F;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x7684;time(1)&#x547D;&#x4EE4;&#xFF0C;&#x540C;&#x65F6;&#x83B7;&#x5F97;&#x8FD9;&#x4E24;&#x4E2A;&#x90E8;&#x5206;&#x7684;&#x65F6;&#x95F4;&#x503C;&#xFF0C;&#x4EE5;&#x53CA;&#x8FD0;&#x884C;&#x7A0B;&#x5E8F;&#x6240;&#x9700;&#x7684;&#x5B9E;&#x9645;&#x65F6;&#x95F4;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">time</span> ./a.out<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre><code>real    0m0.491s
user    0m0.073s
sys    0m0.287s</code></pre><p>clock()&#x662F;C/C++&#x4E2D;&#x7684;&#x8BA1;&#x65F6;&#x51FD;&#x6570;&#xFF0C;&#x800C;&#x4E0E;&#x5176;&#x76F8;&#x5173;&#x7684;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x662F;clock_t&#x3002;&#x5728;MSDN&#x4E2D;&#xFF0C;&#x67E5;&#x5F97;&#x5BF9;clock&#x51FD;&#x6570;&#x5B9A;&#x4E49;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;time.h&gt;</span></span>
clock_t <span class="token function">clock</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>   <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x7B80;&#x5355;&#x800C;&#x8A00;&#xFF0C;&#x5C31;&#x662F;&#x8BE5;&#x7A0B;&#x5E8F;&#x4ECE;&#x542F;&#x52A8;&#x5230;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x5360;&#x7528;CPU&#x7684;&#x65F6;&#x95F4;&#x3002;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x4ECE;&#x201C;&#x5F00;&#x542F;&#x8FD9;&#x4E2A;&#x7A0B;&#x5E8F;&#x8FDB;&#x7A0B;&#x201D;&#x5230;&#x201C;&#x7A0B;&#x5E8F;&#x4E2D;&#x8C03;&#x7528;clock()&#x51FD;&#x6570;&#x201D;&#x65F6;&#x4E4B;&#x95F4;&#x7684;CPU&#x65F6;&#x949F;&#x8BA1;&#x65F6;&#x5355;&#x5143;&#xFF08;clock tick&#xFF09;&#x6570;&#xFF0C;&#x5728;MSDN&#x4E2D;&#x79F0;&#x4E4B;&#x4E3A;&#x6302;&#x949F;&#x65F6;&#x95F4;&#xFF08;wal-clock&#xFF09;&#xFF1B;&#x82E5;&#x6302;&#x949F;&#x65F6;&#x95F4;&#x4E0D;&#x53EF;&#x53D6;&#xFF0C;&#x5219;&#x8FD4;&#x56DE;-1&#x3002;&#x5176;&#x4E2D;clock_t&#x662F;&#x7528;&#x6765;&#x4FDD;&#x5B58;&#x65F6;&#x95F4;&#x7684;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x3002;</p>
<h1 id="&#x7CFB;&#x7EDF;&#x9650;&#x5236;&#x548C;&#x9009;&#x9879;"><a href="#&#x7CFB;&#x7EDF;&#x9650;&#x5236;&#x548C;&#x9009;&#x9879;" class="headerlink" title="&#x7CFB;&#x7EDF;&#x9650;&#x5236;&#x548C;&#x9009;&#x9879;"></a>&#x7CFB;&#x7EDF;&#x9650;&#x5236;&#x548C;&#x9009;&#x9879;</h1><h2 id="&#x7CFB;&#x7EDF;&#x9650;&#x5236;"><a href="#&#x7CFB;&#x7EDF;&#x9650;&#x5236;" class="headerlink" title="&#x7CFB;&#x7EDF;&#x9650;&#x5236;"></a>&#x7CFB;&#x7EDF;&#x9650;&#x5236;</h2><p>SUSv3&#x8981;&#x6C42;&#xFF0C;&#x9488;&#x5BF9;&#x5176;&#x6240;&#x89C4;&#x8303;&#x7684;&#x6BCF;&#x4E2A;&#x9650;&#x5236;&#xFF0C;&#x6240;&#x6709;&#x5B9E;&#x73B0;&#x90FD;&#x5FC5;&#x987B;&#x652F;&#x6301;&#x4E00;&#x4E2A;&#x6700;&#x5C0F;&#x503C;&#x3002;&#x5728;&#x5927;&#x591A;&#x6570;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x4F1A;&#x5C06;&#x8FD9;&#x4E9B;&#x6700;&#x5C0F;&#x503C;&#x5B9A;&#x4E49;&#x4E3A;&lt;limits.h&gt;&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x5E38;&#x91CF;&#xFF0C;&#x5176;&#x547D;&#x540D;&#x5219;&#x51A0;&#x4EE5;&#x5B57;&#x7B26;&#x4E32;_POSIX_&#xFF0C;&#x800C;&#x4E14;&#xFF08;&#x901A;&#x5E38;&#xFF09;&#x8FD8;&#x5305;&#x542B;&#x5B57;&#x7B26;&#x4E32;_MAX&#xFF0C;&#x56E0;&#x6B64;&#xFF0C;&#x5E38;&#x91CF;&#x547D;&#x540D;&#x5F62;&#x5982;_POSIX_XXX_MAX&#x3002;</p>
<h3 id="&#x8FD0;&#x884C;&#x65F6;&#x6052;&#x5B9A;&#x503C;&#xFF08;&#x53EF;&#x80FD;&#x4E0D;&#x786E;&#x5B9A;&#xFF09;"><a href="#&#x8FD0;&#x884C;&#x65F6;&#x6052;&#x5B9A;&#x503C;&#xFF08;&#x53EF;&#x80FD;&#x4E0D;&#x786E;&#x5B9A;&#xFF09;" class="headerlink" title="&#x8FD0;&#x884C;&#x65F6;&#x6052;&#x5B9A;&#x503C;&#xFF08;&#x53EF;&#x80FD;&#x4E0D;&#x786E;&#x5B9A;&#xFF09;"></a>&#x8FD0;&#x884C;&#x65F6;&#x6052;&#x5B9A;&#x503C;&#xFF08;&#x53EF;&#x80FD;&#x4E0D;&#x786E;&#x5B9A;&#xFF09;</h3><p>MQ_PRIO_MAX&#x9650;&#x5236;&#x5C31;&#x662F;&#x8FD0;&#x884C;&#x65F6;&#x6052;&#x5B9A;&#x503C;&#x7684;&#x4F8B;&#x5B50;&#x4E4B;&#x4E00;&#x3002;&#x9488;&#x5BF9;POSIX&#x6D88;&#x606F;&#x961F;&#x5217;&#x4E2D;&#x7684;&#x6D88;&#x606F;&#xFF0C;&#x5B58;&#x5728;&#x7740;&#x4F18;&#x5148;&#x7EA7;&#x65B9;&#x9762;&#x7684;&#x9650;&#x5236;&#x3002;SUSv3 &#x5B9A;&#x4E49;&#x4E86;&#x503C;&#x4E3A; 32 &#x7684;&#x5E38;&#x91CF;_POSIX_MQ_PRIO_MAX&#xFF0C;&#x5C06;&#x5176;&#x4F5C;&#x4E3A;&#x7B26;&#x5408;&#x89C4;&#x8303;&#x7684;&#x5B9E;&#x73B0;&#x4E3A;&#x8BE5;&#x9650;&#x5236;&#x6240;&#x5FC5;&#x987B;&#x63D0;&#x4F9B;&#x7684;&#x6700;&#x5C0F;&#x503C;&#x3002;&#x8FD9;&#x610F;&#x5473;&#x7740;&#xFF0C;&#x6240;&#x6709;&#x7B26;&#x5408;&#x89C4;&#x8303;&#x7684;&#x5B9E;&#x73B0;&#xFF0C;&#x5176;&#x5BF9;&#x6D88;&#x606F;&#x4F18;&#x5148;&#x7EA7;&#x7684;&#x652F;&#x6301;&#x81F3;&#x5C11;&#x5E94;&#x4E3A;&#x4ECE;0&#xFF5E;31&#x3002;&#x4E00;&#x4E2A;UNIX&#x5B9E;&#x73B0;&#x53EF;&#x4EE5;&#x4E3A;&#x6B64;&#x9650;&#x5236;&#x8BBE;&#x5B9A;&#x66F4;&#x9AD8;&#x503C;&#xFF0C;&#x5E76;&#x5C06;&#x8BE5;&#x503C;&#x5728;&lt;limits.h&gt;&#x6587;&#x4EF6;&#x4E2D;&#x4EE5;&#x5E38;&#x91CF;MQ_PRIO_MAX&#x52A0;&#x4EE5;&#x5B9A;&#x4E49;&#x3002;&#x4F8B;&#x5982;&#xFF0C;Linux&#x5C31;&#x5C06;MQ_PRIO_MAX&#x7684;&#x503C;&#x5B9A;&#x4E49;&#x4E3A;32768&#x3002;&#x4E5F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4E0B;&#x5217;&#x8C03;&#x7528;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x83B7;&#x53D6;&#x8BE5;&#x503C;&#xFF1A;</p>
<pre class="line-numbers language-c"><code class="language-c">lim<span class="token operator">=</span><span class="token function">sysconf</span><span class="token punctuation">(</span>_SC_MQ_PRIO_MAX<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="&#x8DEF;&#x5F84;&#x540D;&#x53D8;&#x91CF;&#x503C;"><a href="#&#x8DEF;&#x5F84;&#x540D;&#x53D8;&#x91CF;&#x503C;" class="headerlink" title="&#x8DEF;&#x5F84;&#x540D;&#x53D8;&#x91CF;&#x503C;"></a>&#x8DEF;&#x5F84;&#x540D;&#x53D8;&#x91CF;&#x503C;</h3><p>&#x6240;&#x8C13;&#x8DEF;&#x5F84;&#x540D;&#x53D8;&#x91CF;&#x503C;&#x662F;&#x6307;&#x4E0E;&#x8DEF;&#x5F84;&#x540D;&#xFF08;&#x6587;&#x4EF6;&#x3001;&#x76EE;&#x5F55;&#x3001;&#x7EC8;&#x7AEF;&#x7B49;&#xFF09;&#x76F8;&#x5173;&#x7684;&#x9650;&#x5236;&#xFF0C;&#x6BCF;&#x4E2A;&#x9650;&#x5236;&#x53EF;&#x80FD;&#x662F;&#x76F8;&#x5BF9;&#x4E8E;&#x67D0;&#x4E2A;&#x7CFB;&#x7EDF;&#x5B9E;&#x73B0;&#x7684;&#x5E38;&#x91CF;&#xFF0C;&#x4E5F;&#x53EF;&#x80FD;&#x968F;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x7684;&#x4E0D;&#x540C;&#x800C;&#x4E0D;&#x540C;&#x3002;&#x5728;&#x9650;&#x5236;&#x53EF;&#x80FD;&#x56E0;&#x8DEF;&#x5F84;&#x540D;&#x800C;&#x53D1;&#x751F;&#x53D8;&#x5316;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;pathconf()&#x6216;fpathconf()&#x6765;&#x83B7;&#x53D6;&#x8BE5;&#x503C;&#x3002;</p>
<p>NAME_MAX&#x9650;&#x5236;&#x662F;&#x8DEF;&#x5F84;&#x540D;&#x53D8;&#x91CF;&#x503C;&#x7684;&#x4F8B;&#x5B50;&#x4E4B;&#x4E00;&#x3002;&#x6B64;&#x9650;&#x5236;&#x5B9A;&#x4E49;&#x4E86;&#x5728;&#x4E00;&#x4E2A;&#x7279;&#x5B9A;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x4E2D;&#x6587;&#x4EF6;&#x540D;&#x7684;&#x6700;&#x5927;&#x957F;&#x5EA6;&#x3002;SUSv3&#x5B9A;&#x4E49;&#x4E86;&#x503C;&#x4E3A; 14 &#xFF08;&#x8001;&#x7248;&#x672C;&#x7684; System V &#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x9650;&#x5236;&#xFF09;&#x7684;&#x5E38;&#x91CF;_POSIX_NAME_MAX&#xFF0C;&#x4F5C;&#x4E3A;&#x7CFB;&#x7EDF;&#x5B9E;&#x73B0;&#x5FC5;&#x987B;&#x652F;&#x6301;&#x7684;&#x6700;&#x5C0F;&#x9650;&#x5236;&#x503C;&#x3002;&#x7CFB;&#x7EDF;&#x5B9E;&#x73B0;&#x53EF;&#x4EE5;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x9AD8;&#x4E8E;&#x6B64;&#x503C;&#x7684;NAME_MAX&#x9650;&#x5236;&#xFF0C;&#x5E76;/&#x6216;&#x5411;&#x5E94;&#x7528;&#x5F00;&#x653E;&#x5982;&#x4E0B;&#x5F62;&#x5F0F;&#x7684;&#x8C03;&#x7528;&#xFF0C;&#x4EE5;&#x83B7;&#x53D6;&#x7279;&#x5B9A;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x7684;&#x76F8;&#x5173;&#x4FE1;&#x606F;&#xFF1A;</p>
<pre class="line-numbers language-c"><code class="language-c">lim<span class="token operator">=</span><span class="token function">pathconf</span><span class="token punctuation">(</span>director_path<span class="token punctuation">,</span>PC_NAME_PATH<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>&#x53C2;&#x6570;directory_path&#x662F;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x4E0A;&#x7684;&#x76EE;&#x5F55;&#x8DEF;&#x5F84;&#x540D;&#x3002;</p>
<h3 id="&#x8FD0;&#x884C;&#x65F6;&#x53EF;&#x589E;&#x52A0;&#x503C;"><a href="#&#x8FD0;&#x884C;&#x65F6;&#x53EF;&#x589E;&#x52A0;&#x503C;" class="headerlink" title="&#x8FD0;&#x884C;&#x65F6;&#x53EF;&#x589E;&#x52A0;&#x503C;"></a>&#x8FD0;&#x884C;&#x65F6;&#x53EF;&#x589E;&#x52A0;&#x503C;</h3><p>&#x8FD0;&#x884C;&#x65F6;&#x53EF;&#x589E;&#x52A0;&#x503C;&#x662F;&#x6307;&#x67D0;&#x4E00;&#x9650;&#x5236;&#xFF0C;&#x76F8;&#x5BF9;&#x4E8E;&#x7279;&#x5B9A;&#x5B9E;&#x73B0;&#x5176;&#x503C;&#x56FA;&#x5B9A;&#xFF0C;&#x4E14;&#x8FD0;&#x884C;&#x6B64;&#x5B9E;&#x73B0;&#x7684;&#x6240;&#x6709;&#x7CFB;&#x7EDF;&#x81F3;&#x5C11;&#x90FD;&#x5E94;&#x652F;&#x6301;&#x8FD9;&#x4E00;&#x6700;&#x5C0F;&#x503C;&#x3002;&#x7136;&#x800C;&#xFF0C;&#x7279;&#x5B9A;&#x7CFB;&#x7EDF;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x53EF;&#x80FD;&#x4F1A;&#x589E;&#x52A0;&#x8BE5;&#x503C;&#xFF0C;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;sysconf()&#x6765;&#x83B7;&#x5F97;&#x7CFB;&#x7EDF;&#x6240;&#x652F;&#x6301;&#x7684;&#x5B9E;&#x9645;&#x503C;&#x3002;<br>&#x8FD0;&#x884C;&#x65F6;&#x53EF;&#x589E;&#x52A0;&#x503C;&#x7684;&#x4F8B;&#x5B50;&#x4E4B;&#x4E00;&#x662F;NGROUPS_MAX&#xFF0C;&#x8BE5;&#x9650;&#x5236;&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x8FDB;&#x7A0B;&#x53EF;&#x540C;&#x65F6;&#x4ECE;&#x5C5E;&#x7684;&#x8F85;&#x52A9;&#x7EC4;ID&#x7684;&#x6700;&#x5927;&#x6570;&#x91CF;&#x3002;SUSv3&#x5B9A;&#x4E49;&#x4E86;&#x76F8;&#x5E94;&#x7684;&#x6700;&#x5C0F;&#x503C;_POSIX_NGROUPS_MAX&#xFF0C;&#x5176;&#x503C;&#x4E3A;8&#x3002;&#x5E94;&#x7528;&#x53EF;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x901A;&#x8FC7;&#x8C03;&#x7528;sysconf(_SC_NGROUPS_MAX)&#x6765;&#x83B7;&#x53D6;&#x6B64;&#x9650;&#x5236;&#x503C;&#x3002;</p>
<h3 id="&#x4ECE;shell&#x4E2D;&#x83B7;&#x53D6;&#x9650;&#x5236;&#x548C;&#x9009;&#x9879;&#xFF1A;getconf"><a href="#&#x4ECE;shell&#x4E2D;&#x83B7;&#x53D6;&#x9650;&#x5236;&#x548C;&#x9009;&#x9879;&#xFF1A;getconf" class="headerlink" title="&#x4ECE;shell&#x4E2D;&#x83B7;&#x53D6;&#x9650;&#x5236;&#x548C;&#x9009;&#x9879;&#xFF1A;getconf"></a>&#x4ECE;shell&#x4E2D;&#x83B7;&#x53D6;&#x9650;&#x5236;&#x548C;&#x9009;&#x9879;&#xFF1A;getconf</h3><p>&#x5728;shell&#x4E2D;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;getconf&#x547D;&#x4EE4;&#x83B7;&#x53D6;&#x7279;&#x5B9A;UNIX&#x7CFB;&#x7EDF;&#x4E2D;&#x5DF2;&#x7136;&#x5B9E;&#x73B0;&#x7684;&#x9650;&#x5236;&#x548C;&#x9009;&#x9879;&#x3002;&#x8BE5;&#x547D;&#x4EE4;&#x7684;&#x683C;&#x5F0F;&#x4E00;&#x822C;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre class="line-numbers language-bash"><code class="language-bash">getconf variable-name<span class="token punctuation">[</span>pathname<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>variable-name&#x6807;&#x8BC6;&#x7528;&#x6237;&#x610F;&#x6B32;&#x83B7;&#x53D6;&#x7684;&#x9650;&#x5236;&#xFF0C;&#x5E94;&#x662F;&#x7B26;&#x5408;SUSV3&#x6807;&#x51C6;&#x7684;&#x9650;&#x5236;&#x540D;&#x79F0;&#xFF0C;&#x4F8B;&#x5982;&#xFF1A;ARG_MAX&#x6216;NAME_MAX&#x3002;&#x4F46;&#x51E1;&#x9650;&#x5236;&#x4E0E;&#x8DEF;&#x5F84;&#x540D;&#x76F8;&#x5173;&#xFF0C;&#x5219;&#x8FD8;&#x9700;&#x8981;&#x6307;&#x5B9A;&#x4E00;&#x4E2A;&#x8DEF;&#x5F84;&#x540D;&#xFF0C;&#x4F5C;&#x4E3A;&#x547D;&#x4EE4;&#x7684;&#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x5982;&#x4E0B;&#x7B2C;&#x4E8C;&#x4E2A;&#x5B9E;&#x4F8B;&#x6240;&#x793A;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c">getconf ARG_MAX
getconf NAME_MAX <span class="token operator">/</span>boot<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<pre><code>262144
255</code></pre><h2 id="&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x83B7;&#x53D6;&#x7CFB;&#x7EDF;&#x9650;&#x5236;&#xFF08;&#x548C;&#x9009;&#x9879;&#xFF09;"><a href="#&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x83B7;&#x53D6;&#x7CFB;&#x7EDF;&#x9650;&#x5236;&#xFF08;&#x548C;&#x9009;&#x9879;&#xFF09;" class="headerlink" title="&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x83B7;&#x53D6;&#x7CFB;&#x7EDF;&#x9650;&#x5236;&#xFF08;&#x548C;&#x9009;&#x9879;&#xFF09;"></a>&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x83B7;&#x53D6;&#x7CFB;&#x7EDF;&#x9650;&#x5236;&#xFF08;&#x548C;&#x9009;&#x9879;&#xFF09;</h2><p>sysconf()&#x51FD;&#x6570;&#x5141;&#x8BB8;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x83B7;&#x5F97;&#x7CFB;&#x7EDF;&#x9650;&#x5236;&#x503C;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h&gt;</span></span>
<span class="token keyword">long</span> <span class="token function">sysconf</span> <span class="token punctuation">(</span><span class="token keyword">int</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x53C2;&#x6570;name&#x5E94;&#x4E3A;&#x5B9A;&#x4E49;&#x4E8E;<code>&lt;unistd.h&gt;</code>&#x6587;&#x4EF6;&#x4E2D;&#x7684;_SC_&#x7CFB;&#x5217;&#x5E38;&#x91CF;&#x4E4B;&#x4E00;.</p>
<h2 id="&#x8FD0;&#x884C;&#x65F6;&#x83B7;&#x53D6;&#x4E0E;&#x6587;&#x4EF6;&#x76F8;&#x5173;&#x7684;&#x9650;&#x5236;&#xFF08;&#x548C;&#x9009;&#x9879;&#xFF09;"><a href="#&#x8FD0;&#x884C;&#x65F6;&#x83B7;&#x53D6;&#x4E0E;&#x6587;&#x4EF6;&#x76F8;&#x5173;&#x7684;&#x9650;&#x5236;&#xFF08;&#x548C;&#x9009;&#x9879;&#xFF09;" class="headerlink" title="&#x8FD0;&#x884C;&#x65F6;&#x83B7;&#x53D6;&#x4E0E;&#x6587;&#x4EF6;&#x76F8;&#x5173;&#x7684;&#x9650;&#x5236;&#xFF08;&#x548C;&#x9009;&#x9879;&#xFF09;"></a>&#x8FD0;&#x884C;&#x65F6;&#x83B7;&#x53D6;&#x4E0E;&#x6587;&#x4EF6;&#x76F8;&#x5173;&#x7684;&#x9650;&#x5236;&#xFF08;&#x548C;&#x9009;&#x9879;&#xFF09;</h2><p>pathconf()&#x548C;fpathconf()&#x51FD;&#x6570;&#x5141;&#x8BB8;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x83B7;&#x53D6;&#x6587;&#x4EF6;&#x76F8;&#x5173;&#x7684;&#x9650;&#x5236;&#x503C;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h&gt;</span></span>
<span class="token keyword">long</span> <span class="token function">pathconf</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> path&#xFF0C;<span class="token keyword">int</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">long</span> <span class="token function">fpathconf</span><span class="token punctuation">(</span><span class="token keyword">int</span> fd<span class="token punctuation">,</span><span class="token keyword">int</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>pathconf()&#x548C;fpathconf()&#x4E4B;&#x95F4;&#x552F;&#x4E00;&#x7684;&#x533A;&#x522B;&#x5728;&#x4E8E;&#x5BF9;&#x6587;&#x4EF6;&#x6216;&#x76EE;&#x5F55;&#x7684;&#x6307;&#x5B9A;&#x65B9;&#x5F0F;&#x3002;pathconf()&#x91C7;&#x7528;&#x8DEF;&#x5F84;&#x540D;&#x65B9;&#x5F0F;&#x6765;&#x6307;&#x5B9A;&#xFF0C;&#x800C;fpathconf()&#x5219;&#x4F7F;&#x7528;&#xFF08;&#x4E4B;&#x524D;&#x5DF2;&#x7ECF;&#x6253;&#x5F00;&#x7684;&#xFF09;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x3002;<br>&#x53C2;&#x6570;name&#x5219;&#x662F;&#x5B9A;&#x4E49;&#x4E8E;<code>&lt;unistd.h&gt;</code>&#x6587;&#x4EF6;&#x4E2D;&#x7684;_PC_&#x7CFB;&#x5217;&#x5E38;&#x91CF;&#x4E4B;&#x4E00;.</p>
<h2 id="&#x7CFB;&#x7EDF;&#x9009;&#x9879;"><a href="#&#x7CFB;&#x7EDF;&#x9009;&#x9879;" class="headerlink" title="&#x7CFB;&#x7EDF;&#x9009;&#x9879;"></a>&#x7CFB;&#x7EDF;&#x9009;&#x9879;</h2><p>&#x9664;&#x4E86;&#x5BF9;&#x5404;&#x79CD;&#x7CFB;&#x7EDF;&#x8D44;&#x6E90;&#x7684;&#x9650;&#x5236;&#x52A0;&#x4EE5;&#x89C4;&#x8303;&#x5916;&#xFF0C;SUSv3&#x8FD8;&#x89C4;&#x5B9A;&#x4E86;UNIX&#x5B9E;&#x73B0;&#x53EF;&#x652F;&#x6301;&#x7684;&#x5404;&#x79CD;&#x9009;&#x9879;&#x3002;&#x8FD9;&#x5305;&#x62EC;&#x5BF9;&#x8BF8;&#x5982;&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;&#x3001;POSIX&#x5171;&#x4EAB;&#x5185;&#x5B58;&#x3001;&#x4EFB;&#x52A1;&#x63A7;&#x5236;&#x4EE5;&#x53CA;POSIX&#x7EBF;&#x7A0B;&#x4E4B;&#x7C7B;&#x529F;&#x80FD;&#x7684;&#x652F;&#x6301;&#x3002;&#x9664;&#x5C11;&#x6570;&#x7279;&#x4F8B;&#x5916;&#xFF0C;&#x5E76;&#x672A;&#x8981;&#x6C42;&#x5B9E;&#x73B0;&#x652F;&#x6301;&#x8FD9;&#x4E9B;&#x9009;&#x9879;&#x3002;&#x76F8;&#x53CD;&#xFF0C;&#x5BF9;&#x4E8E;&#x5B9E;&#x73B0;&#x5728;&#x7F16;&#x8BD1;&#x53CA;&#x8FD0;&#x884C;&#x65F6;&#x662F;&#x5426;&#x652F;&#x6301;&#x67D0;&#x4E00;&#x7279;&#x5B9A;&#x7279;&#x6027;&#xFF0C;SUSv3&#x5141;&#x8BB8;&#x5B9E;&#x73B0;&#x81EA;&#x884C;&#x7ED9;&#x51FA;&#x5EFA;&#x8BAE;&#x3002;</p>
<p>&#x901A;&#x8FC7;&#x5728;<code>&lt;unistd.h&gt;</code>&#x6587;&#x4EF6;&#x4E2D;&#x5B9A;&#x4E49;&#x76F8;&#x5E94;&#x5E38;&#x91CF;&#xFF0C;&#x5B9E;&#x73B0;&#x80FD;&#x591F;&#x5728;&#x7F16;&#x8BD1;&#x65F6;&#x901A;&#x544A;&#x5176;&#x5BF9;&#x7279;&#x5B9A;SUSv3&#x9009;&#x9879;&#x7684;&#x652F;&#x6301;&#x3002;&#x6B64;&#x7C7B;&#x5E38;&#x91CF;&#x7684;&#x547D;&#x540D;&#x5747;&#x4F1A;&#x51A0;&#x4EE5;&#x524D;&#x7F00;&#xFF08;&#x6BD4;&#x5982;<em>POSIX</em> &#x6216;&#x8005;_XOPEN_&#xFF09;&#xFF0C;&#x4EE5;&#x6807;&#x8BC6;&#x5176;&#x6E90;&#x4E8E;&#x4F55;&#x79CD;&#x6807;&#x51C6;&#x3002;</p>
<p>&#x5BF9;&#x4E8E;&#x7CFB;&#x7EDF;&#x5B9E;&#x73B0;&#x5FC5;&#x987B;&#x652F;&#x6301;&#x7684;&#x9650;&#x5236;&#x548C;&#x53EF;&#x80FD;&#x652F;&#x6301;&#x7684;&#x7CFB;&#x7EDF;&#x9009;&#x9879;&#xFF0C;SUSv3&#x90FD;&#x505A;&#x4E86;&#x89C4;&#x8303;&#x3002;</p>
<p>&#x901A;&#x5E38;&#xFF0C;&#x4E0D;&#x5EFA;&#x8BAE;&#x5C06;&#x5BF9;&#x7CFB;&#x7EDF;&#x9650;&#x5236;&#x548C;&#x9009;&#x9879;&#x7684;&#x5047;&#x8BBE;&#x503C;&#x786C;&#x6027;&#x5199;&#x5165;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4EE3;&#x7801;&#xFF0C;&#x56E0;&#x4E3A;&#x8FD9;&#x4E9B;&#x503C;&#x65E2;&#x53EF;&#x80FD;&#x968F;&#x7CFB;&#x7EDF;&#x7684;&#x4E0D;&#x540C;&#x800C;&#x53D1;&#x751F;&#x53D8;&#x5316;&#xFF0C;&#x4E5F;&#x53EF;&#x80FD;&#x5728;&#x540C;&#x4E00;&#x4E2A;&#x7CFB;&#x7EDF;&#x5B9E;&#x73B0;&#x4E2D;&#x56E0;&#x4E0D;&#x540C;&#x7684;&#x8FD0;&#x884C;&#x671F;&#x95F4;&#x6216;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x800C;&#x4E0D;&#x540C;&#x3002;&#x56E0;&#x6B64;&#xFF0C;SUSv3&#x89C4;&#x5B9A;&#x4E86;&#x4E00;&#x5E72;&#x65B9;&#x6CD5;&#xFF0C;&#x501F;&#x52A9;&#x4E8E;&#x6B64;&#xFF0C;&#x7CFB;&#x7EDF;&#x5B9E;&#x73B0;&#x53EF;&#x53D1;&#x5E03;&#x5176;&#x6240;&#x652F;&#x6301;&#x7684;&#x9650;&#x5236;&#x548C;&#x9009;&#x9879;&#x3002;&#x5BF9;&#x4E8E;&#x5927;&#x591A;&#x6570;&#x9650;&#x5236;&#xFF0C;SUSv3&#x89C4;&#x5B9A;&#x4E86;&#x6240;&#x6709;&#x5B9E;&#x73B0;&#x6240;&#x5FC5;&#x987B;&#x652F;&#x6301;&#x7684;&#x6700;&#x5C0F;&#x503C;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x6BCF;&#x4E2A;&#x5B9E;&#x73B0;&#x8FD8;&#x80FD;&#x5728;&#x7F16;&#x8BD1;&#x65F6;(&#x901A;&#x8FC7;&#x5B9A;&#x4E49;&#x4E8E;&lt;limits.h&gt;&#x6216;&lt;unistd.h&gt;&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x5E38;&#x91CF;)&#x548C;/&#x6216;&#x8FD0;&#x884C;&#x65F6;(&#x901A;&#x8FC7;&#x8C03;&#x7528; sysconf()&#x3001;pathconf()&#x6216; fpathconf()&#x51FD;&#x6570;) &#x53D1;&#x5E03;&#x5176;&#x7279;&#x6709;&#x7684;&#x9650;&#x5236;&#x548C;&#x9009;&#x9879;&#x3002;&#x6B64;&#x7C7B;&#x6280;&#x672F;&#x540C;&#x6837;&#x53EF;&#x5E94;&#x7528;&#x4E8E;&#x627E;&#x51FA;&#x5B9E;&#x73B0;&#x6240;&#x652F;&#x6301;&#x7684;SUSv3&#x9009;&#x9879;&#x3002;&#x5728;&#x4E00;&#x4E9B;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x65E0;&#x8BBA;&#x4F7F;&#x7528;&#x4E0A;&#x8FF0;&#x4F55;&#x79CD;&#x65B9;&#x6CD5;&#xFF0C;&#x90FD;&#x4E0D;&#x80FD;&#x83B7;&#x53D6;&#x67D0;&#x4E2A;&#x7279;&#x5B9A;&#x9650;&#x5236;&#x7684;&#x503C;&#x3002;&#x5BF9;&#x4E8E;&#x8FD9;&#x4E9B;&#x4E0D;&#x786E;&#x5B9A;&#x7684;&#x9650;&#x5236;&#xFF0C;&#x5FC5;&#x987B;&#x91C7;&#x7528;&#x7279;&#x6B8A;&#x6280;&#x672F;&#x6765;&#x786E;&#x5B9A;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x6240;&#x5E94;&#x9075;&#x5FAA;&#x7684;&#x9650;&#x5236;&#x3002;</p>
<h1 id="&#x7CFB;&#x7EDF;&#x548C;&#x8FDB;&#x7A0B;&#x4FE1;&#x606F;"><a href="#&#x7CFB;&#x7EDF;&#x548C;&#x8FDB;&#x7A0B;&#x4FE1;&#x606F;" class="headerlink" title="&#x7CFB;&#x7EDF;&#x548C;&#x8FDB;&#x7A0B;&#x4FE1;&#x606F;"></a>&#x7CFB;&#x7EDF;&#x548C;&#x8FDB;&#x7A0B;&#x4FE1;&#x606F;</h1><h2 id="proc&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;"><a href="#proc&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;" class="headerlink" title="/proc&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;"></a>/proc&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;</h2><p>&#x5728;&#x8F83;&#x8001;&#x7684;UNIX&#x5B9E;&#x73B0;&#x4E2D;&#xFF0C;&#x901A;&#x5E38;&#x5E76;&#x65E0;&#x7B80;&#x5355;&#x65B9;&#x6CD5;&#x6765;&#x83B7;&#x53D6;&#xFF08;&#x6216;&#x4FEE;&#x6539;&#xFF09;&#x5185;&#x6838;&#x5C5E;&#x6027;&#x5E76;&#x56DE;&#x7B54;&#x5982;&#x4E0B;&#x95EE;&#x9898;&#xFF1A;</p>
<p>&#x7CFB;&#x7EDF;&#x4E2D;&#x6709;&#x591A;&#x5C11;&#x8FDB;&#x7A0B;&#x6B63;&#x5728;&#x8FD0;&#x884C;&#xFF0C;&#x5176;&#x5C5E;&#x4E3B;&#x662F;&#x8C01;&#xFF1F;<br>&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x5DF2;&#x7ECF;&#x6253;&#x5F00;&#x4E86;&#x4EC0;&#x4E48;&#x6587;&#x4EF6;&#xFF1F;<br>&#x76EE;&#x524D;&#x9501;&#x5B9A;&#x4E86;&#x4EC0;&#x4E48;&#x6587;&#x4EF6;&#xFF0C;&#x54EA;&#x4E9B;&#x8FDB;&#x7A0B;&#x6301;&#x6709;&#x8FD9;&#x4E9B;&#x9501;&#xFF1F;<br>&#x7CFB;&#x7EDF;&#x6B63;&#x5728;&#x4F7F;&#x7528;&#x4EC0;&#x4E48;&#x5957;&#x63A5;&#x5B57;&#xFF08;socket&#xFF09;?<br>&#x4E00;&#x4E9B;&#x8001;&#x7248;UNIX&#x5B9E;&#x73B0;&#x89E3;&#x51B3;&#x8FD9;&#x4E00;&#x95EE;&#x9898;&#x7684;&#x65B9;&#x6CD5;&#x662F;&#x5141;&#x8BB8;&#x7279;&#x6743;&#x7EA7;&#x7A0B;&#x5E8F;&#x6DF1;&#x5165;&#x5185;&#x6838;&#x5185;&#x5B58;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x3002;&#x7136;&#x800C;&#xFF0C;&#x8FD9;&#x4F1A;&#x5E26;&#x6765;&#x5404;&#x79CD;&#x95EE;&#x9898;&#x3002;&#x7279;&#x522B;&#x662F;&#xFF0C;&#x8FD9;&#x8981;&#x6C42;&#x5BF9;&#x5185;&#x6838;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x5177;&#x6709;&#x4E13;&#x4E1A;&#x77E5;&#x8BC6;&#xFF0C;&#x5E76;&#x4E14;&#x8FD9;&#x4E9B;&#x7ED3;&#x6784;&#x53EF;&#x80FD;&#x56E0;&#x5185;&#x6838;&#x7248;&#x672C;&#x7684;&#x6F14;&#x8FDB;&#x800C;&#x53D1;&#x751F;&#x6539;&#x53D8;&#xFF0C;&#x6545;&#x800C;&#x9700;&#x8981;&#x52A0;&#x4EE5;&#x91CD;&#x5199;&#x3002;<br>&#x4E3A;&#x4E86;&#x63D0;&#x4F9B;&#x66F4;&#x4E3A;&#x7B80;&#x4FBF;&#x7684;&#x65B9;&#x6CD5;&#x6765;&#x8BBF;&#x95EE;&#x5185;&#x6838;&#x4FE1;&#x606F;&#xFF0C;&#x8BB8;&#x591A;&#x73B0;&#x4EE3;UNIX&#x5B9E;&#x73B0;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;/proc&#x865A;&#x62DF;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x3002;&#x8BE5;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x9A7B;&#x7559;&#x4E8E;/proc&#x76EE;&#x5F55;&#x4E2D;&#xFF0C;&#x5305;&#x542B;&#x4E86;&#x5404;&#x79CD;&#x7528;&#x4E8E;&#x5C55;&#x793A;&#x5185;&#x6838;&#x4FE1;&#x606F;&#x7684;&#x6587;&#x4EF6;&#xFF0C;&#x5E76;&#x4E14;&#x5141;&#x8BB8;&#x8FDB;&#x7A0B;&#x901A;&#x8FC7;&#x5E38;&#x89C4;&#x6587;&#x4EF6;I/O&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x6765;&#x65B9;&#x4FBF;&#x5730;&#x8BFB;&#x53D6;&#xFF0C;&#x6709;&#x65F6;&#x8FD8;&#x53EF;&#x4EE5;&#x4FEE;&#x6539;&#x8FD9;&#x4E9B;&#x4FE1;&#x606F;&#x3002;&#x4E4B;&#x6240;&#x4EE5;&#x5C06;/proc&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x79F0;&#x4E3A;&#x865A;&#x62DF;&#xFF0C;&#x662F;&#x56E0;&#x4E3A;&#x5176;&#x5305;&#x542B;&#x7684;&#x6587;&#x4EF6;&#x548C;&#x5B50;&#x76EE;&#x5F55;&#x5E76;&#x672A;&#x5B58;&#x50A8;&#x4E8E;&#x78C1;&#x76D8;&#x4E0A;&#xFF0C;&#x800C;&#x662F;&#x7531;&#x5185;&#x6838;&#x5728;&#x8FDB;&#x7A0B;&#x8BBF;&#x95EE;&#x6B64;&#x7C7B;&#x4FE1;&#x606F;&#x65F6;&#x52A8;&#x6001;&#x521B;&#x5EFA;&#x800C;&#x6210;&#x3002;</p>
<h3 id="&#x83B7;&#x53D6;&#x4E0E;&#x8FDB;&#x7A0B;&#x6709;&#x5173;&#x7684;&#x4FE1;&#x606F;&#xFF1A;-proc-PID"><a href="#&#x83B7;&#x53D6;&#x4E0E;&#x8FDB;&#x7A0B;&#x6709;&#x5173;&#x7684;&#x4FE1;&#x606F;&#xFF1A;-proc-PID" class="headerlink" title="&#x83B7;&#x53D6;&#x4E0E;&#x8FDB;&#x7A0B;&#x6709;&#x5173;&#x7684;&#x4FE1;&#x606F;&#xFF1A;/proc/PID"></a>&#x83B7;&#x53D6;&#x4E0E;&#x8FDB;&#x7A0B;&#x6709;&#x5173;&#x7684;&#x4FE1;&#x606F;&#xFF1A;/proc/PID</h3><p>&#x5BF9;&#x4E8E;&#x7CFB;&#x7EDF;&#x4E2D;&#x6BCF;&#x4E2A;&#x8FDB;&#x7A0B;&#xFF0C;&#x5185;&#x6838;&#x90FD;&#x63D0;&#x4F9B;&#x4E86;&#x76F8;&#x5E94;&#x7684;&#x76EE;&#x5F55;&#xFF0C;&#x547D;&#x540D;&#x4E3A;/proc/PID&#xFF0C;&#x5176;&#x4E2D;PID&#x662F;&#x8FDB;&#x7A0B;&#x7684;ID&#x3002;&#x5728;&#x6B64;&#x76EE;&#x5F55;&#x4E2D;&#x7684;&#x5404;&#x79CD;&#x6587;&#x4EF6;&#x548C;&#x5B50;&#x76EE;&#x5F55;&#x5305;&#x542B;&#x4E86;&#x8FDB;&#x7A0B;&#x7684;&#x76F8;&#x5173;&#x4FE1;&#x606F;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x901A;&#x8FC7;&#x67E5;&#x770B;/proc/1&#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x6587;&#x4EF6;&#xFF0C;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;init&#x8FDB;&#x7A0B;&#x7684;&#x4FE1;&#x606F;&#xFF0C;&#x8BE5;&#x8FDB;&#x7A0B;&#x7684;ID&#x603B;&#x662F;&#x4E3A;1&#x3002;</p>
<p>&#x6BCF;&#x4E2A;/proc/PID&#x76EE;&#x5F55;&#x4E2D;&#x90FD;&#x5B58;&#x5728;&#x4E00;&#x4E2A;&#x547D;&#x540D;&#x4E3A;status&#x7684;&#x6587;&#x4EF6;&#xFF0C;&#x63D0;&#x4F9B;&#x4E86;&#x6709;&#x5173;&#x8BE5;&#x8FDB;&#x7A0B;&#x7684;&#x4E00;&#x7CFB;&#x5217;&#x4FE1;&#x606F;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">cat</span> /proc/1/status<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre><code>Name:    systemd
Umask:    0000
State:    S (sleeping)
Tgid:    1
Ngid:    0
Pid:    1
PPid:    0
TracerPid:    0
Uid:    0    0    0    0
Gid:    0    0    0    0
...</code></pre><p><strong>&#x6BCF;&#x4E2A;/proc/PID&#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x6587;&#x4EF6;&#x8282;&#x9009;</strong><br>cmdline,&#x4EE5;\0&#x5206;&#x9694;&#x7684;&#x547D;&#x4EE4;&#x884C;&#x53C2;&#x6570;</p>
<p>cwd,&#x6307;&#x5411;&#x5F53;&#x524D;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;&#x7684;&#x7B26;&#x53F7;&#x94FE;&#x63A5;</p>
<p>Environ,NAME=value &#x952E;&#x503C;&#x5BF9;&#x73AF;&#x5883;&#x5217;&#x8868;&#xFF0C;&#x4EE5;\0&#x5206;&#x9694;</p>
<p>exe,&#x6307;&#x5411;&#x6B63;&#x5728;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x7684;&#x7B26;&#x53F7;&#x94FE;&#x63A5;</p>
<p>fd,&#x6587;&#x4EF6;&#x76EE;&#x5F55;&#xFF0C;&#x5305;&#x542B;&#x4E86;&#x6307;&#x5411;&#x7531;&#x8FDB;&#x7A0B;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x7684;&#x7B26;&#x53F7;&#x94FE;&#x63A5;</p>
<p>maps,&#x5185;&#x5B58;&#x6620;&#x5C04;</p>
<p>mem,&#x8FDB;&#x7A0B;&#x865A;&#x62DF;&#x5185;&#x5B58;&#xFF08;&#x5728;I/O&#x64CD;&#x4F5C;&#x4E4B;&#x524D;&#x5FC5;&#x987B;&#x8C03;&#x7528;lseek()&#x79FB;&#x81F3;&#x6709;&#x6548;&#x504F;&#x79FB;&#x91CF;&#xFF09;</p>
<p>mounts,&#x8FDB;&#x7A0B;&#x7684;&#x5B89;&#x88C5;&#x70B9;</p>
<p>root,&#x6307;&#x5411;&#x6839;&#x76EE;&#x5F55;&#x7684;&#x7B26;&#x53F7;&#x94FE;&#x63A5;</p>
<p>status,&#x5404;&#x79CD;&#x4FE1;&#x606F;&#xFF08;&#x6BD4;&#x5982;&#xFF0C;&#x8FDB;&#x7A0B;ID&#x3001;&#x51ED;&#x8BC1;&#x3001;&#x5185;&#x5B58;&#x4F7F;&#x7528;&#x91CF;&#x3001;&#x4FE1;&#x53F7;&#xFF09;</p>
<p>task,&#x4E3A;&#x8FDB;&#x7A0B;&#x4E2D;&#x7684;&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x5747;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x5B50;&#x76EE;&#x5F55;&#xFF08;&#x59CB;&#x81EA;Linux 2.6&#xFF09;</p>
<h3 id="proc-&#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x7CFB;&#x7EDF;&#x4FE1;&#x606F;"><a href="#proc-&#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x7CFB;&#x7EDF;&#x4FE1;&#x606F;" class="headerlink" title="/proc &#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x7CFB;&#x7EDF;&#x4FE1;&#x606F;"></a>/proc &#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x7CFB;&#x7EDF;&#x4FE1;&#x606F;</h3><p>/proc&#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x5404;&#x79CD;&#x6587;&#x4EF6;&#x548C;&#x5B50;&#x76EE;&#x5F55;&#x63D0;&#x4F9B;&#x4E86;&#x5BF9;&#x7CFB;&#x7EDF;&#x7EA7;&#x4FE1;&#x606F;&#x7684;&#x8BBF;&#x95EE;&#x3002;<br></p><div class="amp-img-wrapper"><amp-img src="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1581127508973.png?x-oss-process=image/resize,m_lfit,h_450" width="323" height="450" layout="responsive"></amp-img></div>
<h3 id="&#x8BBF;&#x95EE;-proc&#x6587;&#x4EF6;"><a href="#&#x8BBF;&#x95EE;-proc&#x6587;&#x4EF6;" class="headerlink" title="&#x8BBF;&#x95EE;/proc&#x6587;&#x4EF6;"></a>&#x8BBF;&#x95EE;/proc&#x6587;&#x4EF6;</h3><p>&#x901A;&#x5E38;&#x4F7F;&#x7528;shell&#x811A;&#x672C;&#x6765;&#x8BBF;&#x95EE;/proc&#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x6587;&#x4EF6;&#xFF08;&#x4F7F;&#x7528;&#x8BF8;&#x5982;Python&#x6216;&#x8005;Perl&#x4E4B;&#x7C7B;&#x7684;&#x811A;&#x672C;&#x8BED;&#x8A00;&#xFF0C;&#x5F88;&#x5BB9;&#x6613;&#x89E3;&#x6790;&#x5927;&#x591A;&#x6570;/proc&#x76EE;&#x5F55;&#x4E0B;&#x5305;&#x542B;&#x6709;&#x591A;&#x4E2A;&#x503C;&#x7684;&#x6587;&#x4EF6;&#xFF09;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x4F7F;&#x7528;&#x5982;&#x4E0B;shell&#x547D;&#x4EE4;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x4FEE;&#x6539;&#x548C;&#x67E5;&#x770B;/proc&#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x6587;&#x4EF6;&#x5185;&#x5BB9;&#xFF1A;</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token keyword">echo</span> 100000 /proc/sys/kernel/pid_max
<span class="token function">cat</span> /proc/sys/kernel/pid_max<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<pre><code>100000</code></pre><p>&#x4E0A;&#x8FF0;&#x547D;&#x4EE4;&#x9700;&#x8981;su&#x6743;&#x9650;&#xFF1F;<br>&#x4E5F;&#x53EF;&#x4EE5;&#x4ECE;&#x7A0B;&#x5E8F;&#x4E2D;&#x4F7F;&#x7528;&#x5E38;&#x89C4;I/O&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x6765;&#x8BBF;&#x95EE;/proc&#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x6587;&#x4EF6;&#x3002;&#x4F46;&#x5728;&#x8BBF;&#x95EE;&#x8FD9;&#x4E9B;&#x6587;&#x4EF6;&#x65F6;&#xFF0C;&#x6709;&#x5982;&#x4E0B;&#x4E00;&#x4E9B;&#x9650;&#x5236;&#x3002;</p>
<ul>
<li>/proc&#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x4E00;&#x4E9B;&#x6587;&#x4EF6;&#x662F;&#x53EA;&#x8BFB;&#x7684;&#xFF0C;&#x5373;&#x8FD9;&#x4E9B;&#x6587;&#x4EF6;&#x4EC5;&#x7528;&#x4E8E;&#x663E;&#x793A;&#x5185;&#x6838;&#x4FE1;&#x606F;&#xFF0C;&#x4F46;&#x65E0;&#x6CD5;&#x5BF9;&#x5176;&#x8FDB;&#x884C;&#x4FEE;&#x6539;&#x3002;/proc/PID&#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x5927;&#x591A;&#x6570;&#x6587;&#x4EF6;&#x5C31;&#x5C5E;&#x4E8E;&#x6B64;&#x7C7B;&#x578B;&#x3002;</li>
<li>/proc&#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x4E00;&#x4E9B;&#x6587;&#x4EF6;&#x4EC5;&#x80FD;&#x7531;&#x6587;&#x4EF6;&#x62E5;&#x6709;&#x8005;&#xFF08;&#x6216;&#x7279;&#x6743;&#x7EA7;&#x8FDB;&#x7A0B;&#xFF09;&#x8BFB;&#x53D6;&#x3002;&#x4F8B;&#x5982;&#xFF0C;/proc/PID&#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x6240;&#x6709;&#x6587;&#x4EF6;&#x90FD;&#x5C5E;&#x4E8E;&#x62E5;&#x6709;&#x76F8;&#x5E94;&#x8FDB;&#x7A0B;&#x7684;&#x7528;&#x6237;&#xFF0C;&#x800C;&#x4E14;&#x5373;&#x4F7F;&#x662F;&#x5BF9;&#x6587;&#x4EF6;&#x7684;&#x5C5E;&#x4E3B;&#xFF0C;&#x5176;&#x4E2D;&#x7684;&#x90E8;&#x5206;&#x6587;&#x4EF6;&#xFF08;&#x5982;&#xFF1A;proc/PID/environ&#x6587;&#x4EF6;&#xFF09;&#x4E5F;&#x4EC5;&#x4EC5;&#x6388;&#x4E88;&#x4E86;&#x8BFB;&#x6743;&#x9650;&#x3002;</li>
<li>&#x9664;&#x4E86;/proc/PID&#x5B50;&#x76EE;&#x5F55;&#x4E2D;&#x7684;&#x6587;&#x4EF6;&#xFF0C;/proc&#x76EE;&#x5F55;&#x7684;&#x5176;&#x4ED6;&#x6587;&#x4EF6;&#x5927;&#x591A;&#x5C5E;&#x4E8E;root&#x7528;&#x6237;&#xFF0C;&#x5E76;&#x4E14;&#x4E5F;&#x4EC5;&#x6709;root&#x7528;&#x6237;&#x80FD;&#x591F;&#x4FEE;&#x6539;&#x90A3;&#x4E9B;&#x53EF;&#x4FEE;&#x6539;&#x7684;&#x6587;&#x4EF6;&#x3002;</li>
</ul>
<h2 id="&#x7CFB;&#x7EDF;&#x6807;&#x8BC6;&#xFF1A;uname"><a href="#&#x7CFB;&#x7EDF;&#x6807;&#x8BC6;&#xFF1A;uname" class="headerlink" title="&#x7CFB;&#x7EDF;&#x6807;&#x8BC6;&#xFF1A;uname()"></a>&#x7CFB;&#x7EDF;&#x6807;&#x8BC6;&#xFF1A;uname()</h2><p>uname()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x8FD4;&#x56DE;&#x4E86;&#x4E00;&#x7CFB;&#x5217;&#x5173;&#x4E8E;&#x4E3B;&#x673A;&#x7CFB;&#x7EDF;&#x7684;&#x6807;&#x8BC6;&#x4FE1;&#x606F;&#xFF0C;&#x5B58;&#x50A8;&#x4E8E;utsbuf&#x6240;&#x6307;&#x5411;&#x7684;&#x7ED3;&#x6784;&#x4E2D;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;sys/utsname.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">uname</span><span class="token punctuation">(</span><span class="token keyword">struct</span> utsname <span class="token operator">*</span>utsbuf<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> utsname<span class="token punctuation">{</span>
   <span class="token keyword">char</span> sysname<span class="token punctuation">[</span>_UTSNAME_SYSNAME_LENGTH<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//&#x5F53;&#x524D;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x540D;</span>
   <span class="token keyword">char</span> nodename<span class="token punctuation">[</span>_UTSNAME_NODENAME_LENGTH<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//&#x7F51;&#x7EDC;&#x4E0A;&#x7684;&#x540D;&#x79F0;</span>
   <span class="token keyword">char</span> release<span class="token punctuation">[</span>_UTSNAME_RELEASE_LENGTH<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//&#x5F53;&#x524D;&#x53D1;&#x5E03;&#x7EA7;&#x522B;</span>
   <span class="token keyword">char</span> version<span class="token punctuation">[</span>_UTSNAME_VERSION_LENGTH<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//&#x5F53;&#x524D;&#x53D1;&#x5E03;&#x7248;&#x672C;</span>
   <span class="token keyword">char</span> machine<span class="token punctuation">[</span>_UTSNAME_MACHINE_LENGTH<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//&#x5F53;&#x524D;&#x786C;&#x4EF6;&#x4F53;&#x7CFB;&#x7C7B;&#x578B;</span>

<span class="token macro property"># <span class="token directive keyword">ifdef</span> __USE_GNU</span>
    <span class="token keyword">char</span> domainname<span class="token punctuation">[</span>_UTSNAME_DOMAIN_LENGTH<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//&#x5F53;&#x524D;&#x57DF;&#x540D;</span>
<span class="token macro property"># <span class="token directive keyword">else</span></span>
    <span class="token keyword">char</span> __domainname<span class="token punctuation">[</span>_UTSNAME_DOMAIN_LENGTH<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token macro property"># <span class="token directive keyword">endif</span></span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>SUSv3&#x89C4;&#x8303;&#x4E86;uname()&#xFF0C;&#x4F46;&#x5BF9;utsname&#x7ED3;&#x6784;&#x4E2D;&#x5404;&#x79CD;&#x5B57;&#x6BB5;&#x7684;&#x957F;&#x5EA6;&#x672A;&#x52A0;&#x5B9A;&#x4E49;&#xFF0C;&#x4EC5;&#x8981;&#x6C42;&#x5B57;&#x7B26;&#x4E32;&#x4EE5;&#x7A7A;&#x5B57;&#x8282;&#x7EC8;&#x6B62;&#x3002;&#x5728;Linux&#x4E2D;&#xFF0C;&#x8FD9;&#x4E9B;&#x5B57;&#x6BB5;&#x957F;&#x5EA6;&#x5747;&#x4E3A;65&#x4E2A;&#x5B57;&#x8282;&#xFF0C;&#x5176;&#x4E2D;&#x5305;&#x62EC;&#x4E86;&#x7A7A;&#x5B57;&#x8282;&#x7EC8;&#x6B62;&#x7B26;&#x6240;&#x5360;&#x7528;&#x7684;&#x7A7A;&#x95F4;&#x3002;&#x800C;&#x5728;&#x4E00;&#x4E9B;UNIX&#x5B9E;&#x73B0;&#x4E2D;&#xFF0C;&#x8FD9;&#x4E9B;&#x5B57;&#x6BB5;&#x66F4;&#x77ED;&#xFF0C;&#x4F46;&#x5728;&#x5176;&#x4ED6;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#xFF08;&#x5982;Solaris&#xFF09;&#x4E2D;&#xFF0C;&#x8FD9;&#x4E9B;&#x5B57;&#x6BB5;&#x7684;&#x957F;&#x5EA6;&#x957F;&#x8FBE;257&#x4E2A;&#x5B57;&#x8282;&#x3002;</p>
<p>utsname&#x7ED3;&#x6784;&#x4E2D;&#x7684;sysname&#x3001;release&#x3001;version&#x548C;machine&#x5B57;&#x6BB5;&#x7531;&#x5185;&#x6838;&#x81EA;&#x52A8;&#x8BBE;&#x7F6E;&#x3002;</p>
<p>&#x5728;Linux&#x4E2D;&#xFF0C;/proc/sys/kernel&#x76EE;&#x5F55;&#x4E0B;&#x7684;3&#x4E2A;&#x6587;&#x4EF6;&#x63D0;&#x4F9B;&#x4E86;&#x4E0E;utsname&#x7ED3;&#x6784;&#x7684;sysname&#x3001;release&#x548C; version &#x5B57;&#x6BB5;&#x8FD4;&#x56DE;&#x503C;&#x76F8;&#x540C;&#x7684;&#x4FE1;&#x606F;&#xFF0C;&#x8FD9;&#x4E9B;&#x53EA;&#x8BFB;&#x6587;&#x4EF6;&#x5206;&#x522B;&#x4E3A; ostype&#x3001;osrelease&#x548C;version&#x3002;&#x53E6;&#x5916;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;/proc/version&#xFF0C;&#x4E5F;&#x5305;&#x542B;&#x4E86;&#x8FD9;&#x4E9B;&#x4FE1;&#x606F;&#xFF0C;&#x5E76;&#x4E14;&#x8FD8;&#x5305;&#x542B;&#x4E86;&#x6709;&#x5173;&#x5185;&#x6838;&#x7F16;&#x8BD1;&#x7684;&#x6B65;&#x9AA4;&#x4FE1;&#x606F;&#xFF08;&#x5373;&#x6267;&#x884C;&#x7F16;&#x8BD1;&#x7684;&#x7528;&#x6237;&#x540D;&#x3001;&#x7528;&#x4E8E;&#x7F16;&#x8BD1;&#x7684;&#x4E3B;&#x673A;&#x540D;&#xFF0C;&#x4EE5;&#x53CA;&#x4F7F;&#x7528;&#x7684;gcc&#x7248;&#x672C;&#xFF09;&#x3002;</p>
<p>&#x4F7F;&#x7528;uname()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF0C;&#x80FD;&#x591F;&#x83B7;&#x53D6;UNIX&#x7684;&#x5B9E;&#x73B0;&#x4FE1;&#x606F;&#x4EE5;&#x53CA;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x6240;&#x8FD0;&#x884C;&#x7684;&#x673A;&#x5668;&#x7C7B;&#x578B;&#x3002;</p>
<h1 id="&#x4FE1;&#x53F7;-Signal"><a href="#&#x4FE1;&#x53F7;-Signal" class="headerlink" title="&#x4FE1;&#x53F7; Signal"></a>&#x4FE1;&#x53F7; Signal</h1><p>&#x4FE1;&#x53F7;&#x662F;&#x4E8B;&#x4EF6;&#x53D1;&#x751F;&#x65F6;&#x5BF9;&#x8FDB;&#x7A0B;&#x7684;&#x901A;&#x77E5;&#x673A;&#x5236;&#x3002;&#x6709;&#x65F6;&#x4E5F;&#x79F0;&#x4E4B;&#x4E3A;&#x8F6F;&#x4EF6;&#x4E2D;&#x65AD;&#x3002;&#x4FE1;&#x53F7;&#x4E0E;&#x786C;&#x4EF6;&#x4E2D;&#x65AD;&#x7684;&#x76F8;&#x4F3C;&#x4E4B;&#x5904;&#x5728;&#x4E8E;&#x6253;&#x65AD;&#x4E86;&#x7A0B;&#x5E8F;&#x6267;&#x884C;&#x7684;&#x6B63;&#x5E38;&#x6D41;&#x7A0B;&#xFF0C;&#x5927;&#x591A;&#x6570;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x65E0;&#x6CD5;&#x9884;&#x6D4B;&#x4FE1;&#x53F7;&#x5230;&#x8FBE;&#x7684;&#x7CBE;&#x786E;&#x65F6;&#x95F4;&#x3002;<br>&#x4E00;&#x4E2A;&#xFF08;&#x5177;&#x6709;&#x5408;&#x9002;&#x6743;&#x9650;&#x7684;&#xFF09;&#x8FDB;&#x7A0B;&#x80FD;&#x591F;&#x5411;&#x53E6;&#x4E00;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x3002;&#x4FE1;&#x53F7;&#x7684;&#x8FD9;&#x4E00;&#x7528;&#x6CD5;&#x53EF;&#x4F5C;&#x4E3A;&#x4E00;&#x79CD;&#x540C;&#x6B65;&#x6280;&#x672F;&#xFF0C;&#x751A;&#x81F3;&#x662F;&#x8FDB;&#x7A0B;&#x95F4;&#x901A;&#x4FE1;&#xFF08;IPC&#xFF09;&#x7684;&#x539F;&#x59CB;&#x5F62;&#x5F0F;&#x3002;&#x8FDB;&#x7A0B;&#x4E5F;&#x53EF;&#x4EE5;&#x5411;&#x81EA;&#x8EAB;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x3002;&#x7136;&#x800C;&#xFF0C;&#x53D1;&#x5F80;&#x8FDB;&#x7A0B;&#x7684;&#x8BF8;&#x591A;&#x4FE1;&#x53F7;&#xFF0C;&#x901A;&#x5E38;&#x90FD;&#x662F;&#x6E90;&#x4E8E;&#x5185;&#x6838;&#x3002;&#x5F15;&#x53D1;&#x5185;&#x6838;&#x4E3A;&#x8FDB;&#x7A0B;&#x4EA7;&#x751F;&#x4FE1;&#x53F7;&#x7684;&#x5404;&#x7C7B;&#x4E8B;&#x4EF6;&#x5982;&#x4E0B;&#x3002;</p>
<ul>
<li>&#x786C;&#x4EF6;&#x53D1;&#x751F;&#x5F02;&#x5E38;&#xFF0C;&#x5373;&#x786C;&#x4EF6;&#x68C0;&#x6D4B;&#x5230;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#x6761;&#x4EF6;&#x5E76;&#x901A;&#x77E5;&#x5185;&#x6838;&#xFF0C;&#x968F;&#x5373;&#x518D;&#x7531;&#x5185;&#x6838;&#x53D1;&#x9001;&#x76F8;&#x5E94;&#x4FE1;&#x53F7;&#x7ED9;&#x76F8;&#x5173;&#x8FDB;&#x7A0B;&#x3002;&#x786C;&#x4EF6;&#x5F02;&#x5E38;&#x7684;&#x4F8B;&#x5B50;&#x5305;&#x62EC;&#x6267;&#x884C;&#x4E00;&#x6761;&#x5F02;&#x5E38;&#x7684;&#x673A;&#x5668;&#x8BED;&#x8A00;&#x6307;&#x4EE4;&#xFF0C;&#x8BF8;&#x5982;&#xFF0C;&#x88AB;0&#x9664;&#xFF0C;&#x6216;&#x8005;&#x5F15;&#x7528;&#x4E86;&#x65E0;&#x6CD5;&#x8BBF;&#x95EE;&#x7684;&#x5185;&#x5B58;&#x533A;&#x57DF;&#x3002;</li>
<li>&#x7528;&#x6237;&#x952E;&#x5165;&#x4E86;&#x80FD;&#x591F;&#x4EA7;&#x751F;&#x4FE1;&#x53F7;&#x7684;&#x7EC8;&#x7AEF;&#x7279;&#x6B8A;&#x5B57;&#x7B26;&#x3002;&#x5176;&#x4E2D;&#x5305;&#x62EC;&#x4E2D;&#x65AD;&#x5B57;&#x7B26;&#xFF08;&#x901A;&#x5E38;&#x662F;Control-C)&#x3001;&#x6682;&#x505C;&#x5B57;&#x7B26;&#xFF08;&#x901A;&#x5E38;&#x662F;Control-Z&#xFF09;&#x3002;</li>
<li>&#x53D1;&#x751F;&#x4E86;&#x8F6F;&#x4EF6;&#x4E8B;&#x4EF6;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x9488;&#x5BF9;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x7684;&#x8F93;&#x51FA;&#x53D8;&#x4E3A;&#x6709;&#x6548;&#xFF0C;&#x8C03;&#x6574;&#x4E86;&#x7EC8;&#x7AEF;&#x7A97;&#x53E3;&#x5927;&#x5C0F;&#xFF0C;&#x5B9A;&#x65F6;&#x5668;&#x5230;&#x671F;&#xFF0C;&#x8FDB;&#x7A0B;&#x6267;&#x884C;&#x7684;CPU&#x65F6;&#x95F4;&#x8D85;&#x9650;&#xFF0C;&#x6216;&#x8005;&#x8BE5;&#x8FDB;&#x7A0B;&#x7684;&#x67D0;&#x4E2A;&#x5B50;&#x8FDB;&#x7A0B;&#x9000;&#x51FA;&#x3002;</li>
</ul>
<p>&#x5F15;&#x53D1;&#x4FE1;&#x53F7;&#x7684;&#x539F;&#x56E0;&#xFF1A;<br>1.&#x952E;&#x76D8;&#x4E8B;&#x4EF6;  ctrl +c  ctrl +<br>2.&#x975E;&#x6CD5;&#x5185;&#x5B58;  &#x5982;&#x679C;&#x5185;&#x5B58;&#x7BA1;&#x7406;&#x51FA;&#x9519;&#xFF0C;&#x7CFB;&#x7EDF;&#x5C31;&#x4F1A;&#x53D1;&#x9001;&#x4E00;&#x4E2A;&#x4FE1;&#x53F7;&#x8FDB;&#x884C;&#x5904;&#x7406;<br>3.&#x786C;&#x4EF6;&#x6545;&#x969C;  &#x540C;&#x6837;&#x7684;&#xFF0C;&#x786C;&#x4EF6;&#x51FA;&#x73B0;&#x6545;&#x969C;&#x7CFB;&#x7EDF;&#x4E5F;&#x4F1A;&#x4EA7;&#x751F;&#x4E00;&#x4E2A;&#x4FE1;&#x53F7;<br>4.&#x73AF;&#x5883;&#x5207;&#x6362;  &#x6BD4;&#x5982;&#x8BF4;&#x4ECE;&#x7528;&#x6237;&#x6001;&#x5207;&#x6362;&#x5230;&#x5176;&#x4ED6;&#x6001;&#xFF0C;&#x72B6;&#x6001;&#x7684;&#x6539;&#x53D8;&#x4E5F;&#x4F1A;&#x53D1;&#x9001;&#x4E00;&#x4E2A;&#x4FE1;&#x53F7;&#xFF0C;&#x8FD9;&#x4E2A;&#x4FE1;&#x53F7;&#x4F1A;&#x544A;&#x77E5;&#x7ED9;&#x7CFB;&#x7EDF;</p>
<p>&#x9488;&#x5BF9;&#x6BCF;&#x4E2A;&#x4FE1;&#x53F7;&#xFF0C;&#x90FD;&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x4E2A;&#x552F;&#x4E00;&#x7684;&#xFF08;&#x5C0F;&#xFF09;&#x6574;&#x6570;&#xFF0C;&#x4ECE;1&#x5F00;&#x59CB;&#x987A;&#x5E8F;&#x5C55;&#x5F00;&#x3002;<code>&lt;signal.h&gt;</code>&#x4EE5;SIGxxxx&#x5F62;&#x5F0F;&#x7684;&#x7B26;&#x53F7;&#x540D;&#x5BF9;&#x8FD9;&#x4E9B;&#x6574;&#x6570;&#x505A;&#x4E86;&#x5B9A;&#x4E49;&#x3002;&#x7531;&#x4E8E;&#x6BCF;&#x4E2A;&#x4FE1;&#x53F7;&#x7684;&#x5B9E;&#x9645;&#x7F16;&#x53F7;&#x968F;&#x7CFB;&#x7EDF;&#x4E0D;&#x540C;&#x800C;&#x4E0D;&#x540C;&#xFF0C;&#x6240;&#x4EE5;&#x5728;&#x7A0B;&#x5E8F;&#x4E2D;&#x603B;&#x662F;&#x4F7F;&#x7528;&#x8FD9;&#x4E9B;&#x7B26;&#x53F7;&#x540D;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x5F53;&#x7528;&#x6237;&#x952E;&#x5165;&#x4E2D;&#x65AD;&#x5B57;&#x7B26;&#x65F6;&#xFF0C;&#x5C06;&#x4F20;&#x9012;&#x7ED9;&#x8FDB;&#x7A0B;SIGINT&#x4FE1;&#x53F7;&#xFF08;&#x4FE1;&#x53F7;&#x7F16;&#x53F7;&#x4E3A;2&#xFF09;&#x3002;<br>&#x4FE1;&#x53F7;&#x5206;&#x4E3A;&#x4E24;&#x5927;&#x7C7B;&#x3002;&#x7B2C;&#x4E00;&#x7EC4;&#x7528;&#x4E8E;&#x5185;&#x6838;&#x5411;&#x8FDB;&#x7A0B;&#x901A;&#x77E5;&#x4E8B;&#x4EF6;&#xFF0C;&#x6784;&#x6210;&#x6240;&#x8C13;&#x4F20;&#x7EDF;&#x6216;&#x8005;&#x6807;&#x51C6;&#x4FE1;&#x53F7;&#x3002;Linux&#x4E2D;&#x6807;&#x51C6;&#x4FE1;&#x53F7;&#x7684;&#x7F16;&#x53F7;&#x8303;&#x56F4;&#x4E3A;1&#xFF5E;31&#x3002;&#x53E6;&#x4E00;&#x7EC4;&#x4FE1;&#x53F7;&#x7531;&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;&#x6784;&#x6210;..</p>
<p>&#x4FE1;&#x53F7;&#x56E0;&#x67D0;&#x4E9B;&#x4E8B;&#x4EF6;&#x800C;&#x4EA7;&#x751F;&#x3002;&#x4FE1;&#x53F7;&#x4EA7;&#x751F;&#x540E;&#xFF0C;&#x4F1A;&#x4E8E;&#x7A0D;&#x540E;&#x88AB;&#x4F20;&#x9012;&#x7ED9;&#x67D0;&#x4E00;&#x8FDB;&#x7A0B;&#xFF0C;&#x800C;&#x8FDB;&#x7A0B;&#x4E5F;&#x4F1A;&#x91C7;&#x53D6;&#x67D0;&#x4E9B;&#x63AA;&#x65BD;&#x6765;&#x54CD;&#x5E94;&#x4FE1;&#x53F7;&#x3002;&#x5728;&#x4EA7;&#x751F;&#x548C;&#x5230;&#x8FBE;&#x671F;&#x95F4;&#xFF0C;&#x4FE1;&#x53F7;&#x5904;&#x4E8E;&#x7B49;&#x5F85;&#xFF08;pending&#xFF09;&#x72B6;&#x6001;&#x3002;</p>
<p>&#x4FE1;&#x53F7;&#x5230;&#x8FBE;&#x540E;&#xFF0C;&#x8FDB;&#x7A0B;&#x89C6;&#x5177;&#x4F53;&#x4FE1;&#x53F7;&#x6267;&#x884C;&#x5982;&#x4E0B;&#x9ED8;&#x8BA4;&#x64CD;&#x4F5C;&#x4E4B;&#x4E00;&#x3002;</p>
<ul>
<li>&#x5FFD;&#x7565;&#x4FE1;&#x53F7;&#xFF1A;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x5185;&#x6838;&#x5C06;&#x4FE1;&#x53F7;&#x4E22;&#x5F03;&#xFF0C;&#x4FE1;&#x53F7;&#x5BF9;&#x8FDB;&#x7A0B;&#x6CA1;&#x6709;&#x4EA7;&#x751F;&#x4EFB;&#x4F55;&#x5F71;&#x54CD;&#xFF08;&#x8FDB;&#x7A0B;&#x6C38;&#x8FDC;&#x90FD;&#x4E0D;&#x77E5;&#x9053;&#x66FE;&#x7ECF;&#x51FA;&#x73B0;&#x8FC7;&#x8BE5;&#x4FE1;&#x53F7;&#xFF09;&#x3002;</li>
<li>&#x7EC8;&#x6B62;&#xFF08;&#x6740;&#x6B7B;&#xFF09;&#x8FDB;&#x7A0B;&#xFF1A;&#x8FD9;&#x6709;&#x65F6;&#x662F;&#x6307;&#x8FDB;&#x7A0B;&#x5F02;&#x5E38;&#x7EC8;&#x6B62;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x8FDB;&#x7A0B;&#x56E0;&#x8C03;&#x7528;exit()&#x800C;&#x53D1;&#x751F;&#x7684;&#x6B63;&#x5E38;&#x7EC8;&#x6B62;&#x3002;</li>
<li>&#x4EA7;&#x751F;&#x6838;&#x5FC3;&#x8F6C;&#x50A8;&#x6587;&#x4EF6;&#xFF0C;&#x540C;&#x65F6;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#xFF1A;&#x6838;&#x5FC3;&#x8F6C;&#x50A8;&#x6587;&#x4EF6;&#x5305;&#x542B;&#x5BF9;&#x8FDB;&#x7A0B;&#x865A;&#x62DF;&#x5185;&#x5B58;&#x7684;&#x955C;&#x50CF;&#xFF0C;&#x53EF;&#x5C06;&#x5176;&#x52A0;&#x8F7D;&#x5230;&#x8C03;&#x8BD5;&#x5668;&#x4E2D;&#x4EE5;&#x68C0;&#x67E5;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#x65F6;&#x7684;&#x72B6;&#x6001;&#x3002;</li>
<li>&#x505C;&#x6B62;&#x8FDB;&#x7A0B;&#xFF1A;&#x6682;&#x505C;&#x8FDB;&#x7A0B;&#x7684;&#x6267;&#x884C;&#x3002;</li>
<li>&#x4E8E;&#x4E4B;&#x524D;&#x6682;&#x505C;&#x540E;&#x518D;&#x5EA6;&#x6062;&#x590D;&#x8FDB;&#x7A0B;&#x7684;&#x6267;&#x884C;&#x3002;</li>
</ul>
<p>&#x9664;&#x4E86;&#x6839;&#x636E;&#x7279;&#x5B9A;&#x4FE1;&#x53F7;&#x800C;&#x91C7;&#x53D6;&#x9ED8;&#x8BA4;&#x884C;&#x4E3A;&#x4E4B;&#x5916;&#xFF0C;&#x7A0B;&#x5E8F;&#x4E5F;&#x80FD;&#x6539;&#x53D8;&#x4FE1;&#x53F7;&#x5230;&#x8FBE;&#x65F6;&#x7684;&#x54CD;&#x5E94;&#x884C;&#x4E3A;&#x3002;&#x4E5F;&#x5C06;&#x6B64;&#x79F0;&#x4E4B;&#x4E3A;&#x5BF9;&#x4FE1;&#x53F7;&#x7684;&#x5904;&#x7F6E;&#xFF08;disposition&#xFF09;&#x8BBE;&#x7F6E;&#x3002;&#x7A0B;&#x5E8F;&#x53EF;&#x4EE5;&#x5C06;&#x5BF9;&#x4FE1;&#x53F7;&#x7684;&#x5904;&#x7F6E;&#x8BBE;&#x7F6E;&#x4E3A;&#x5982;&#x4E0B;&#x4E4B;&#x4E00;&#x3002;</p>
<ul>
<li>&#x91C7;&#x53D6;&#x9ED8;&#x8BA4;&#x884C;&#x4E3A;&#x3002;&#x8FD9;&#x9002;&#x7528;&#x4E8E;&#x64A4;&#x9500;&#x4E4B;&#x524D;&#x5BF9;&#x4FE1;&#x53F7;&#x5904;&#x7F6E;&#x7684;&#x4FEE;&#x6539;&#x3001;&#x6062;&#x590D;&#x5176;&#x9ED8;&#x8BA4;&#x5904;&#x7F6E;&#x7684;&#x573A;&#x666F;&#x3002;</li>
<li>&#x5FFD;&#x7565;&#x4FE1;&#x53F7;&#x3002;&#x8FD9;&#x9002;&#x7528;&#x4E8E;&#x9ED8;&#x8BA4;&#x884C;&#x4E3A;&#x4E3A;&#x7EC8;&#x6B62;&#x8FDB;&#x7A0B;&#x7684;&#x4FE1;&#x53F7;&#x3002;</li>
<li>&#x6267;&#x884C;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x7A0B;&#x5E8F;&#x3002;</li>
</ul>
<p>&#x67E5;&#x770B;&#x4FE1;&#x53F7;&#xFF1A;</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">kill</span> -l <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre><code>1) SIGHUP      2) SIGINT       3) SIGQUIT     4) SIGILL     5) SIGTRAP
6) SIGABRT     7) SIGBUS     8) SIGFPE     9) SIGKILL    10) SIGUSR1
11) SIGSEGV    12) SIGUSR2    13) SIGPIPE    14) SIGALRM    15) SIGTERM
16) SIGSTKFLT    17) SIGCHLD    18) SIGCONT    19) SIGSTOP    20) SIGTSTP
21) SIGTTIN    22) SIGTTOU    23) SIGURG    24) SIGXCPU    25) SIGXFSZ
26) SIGVTALRM    27) SIGPROF    28) SIGWINCH    29) SIGIO    30) SIGPWR
31) SIGSYS    34) SIGRTMIN    35) SIGRTMIN+1    36) SIGRTMIN+2    37) SIGRTMIN+3
38) SIGRTMIN+4    39) SIGRTMIN+5    40) SIGRTMIN+6    41) SIGRTMIN+7    42) SIGRTMIN+8
43) SIGRTMIN+9    44) SIGRTMIN+10    45) SIGRTMIN+11    46) SIGRTMIN+12    47) SIGRTMIN+13
48) SIGRTMIN+14    49) SIGRTMIN+15    50) SIGRTMAX-14    51) SIGRTMAX-13    52) SIGRTMAX-12
53) SIGRTMAX-11    54) SIGRTMAX-10    55) SIGRTMAX-9    56) SIGRTMAX-8    57) SIGRTMAX-7
58) SIGRTMAX-6    59) SIGRTMAX-5    60) SIGRTMAX-4    61) SIGRTMAX-3    62) SIGRTMAX-2
63) SIGRTMAX-1    64) SIGRTMAX</code></pre><h3 id="&#x5E38;&#x7528;&#x4FE1;&#x53F7;&#x91CA;&#x4E49;"><a href="#&#x5E38;&#x7528;&#x4FE1;&#x53F7;&#x91CA;&#x4E49;" class="headerlink" title="&#x5E38;&#x7528;&#x4FE1;&#x53F7;&#x91CA;&#x4E49;"></a>&#x5E38;&#x7528;&#x4FE1;&#x53F7;&#x91CA;&#x4E49;</h3><div class="table-wrapper"><table>
<thead>
<tr>
<th align="left">&#x540D;&#x79F0;</th>
<th align="center">&#x4FE1;&#x53F7;&#x503C;</th>
<th align="center">&#x63CF;&#x8FF0;</th>
<th align="center">SUSv3</th>
<th align="center">&#x9ED8;&#x8BA4;&#x503C;</th>
</tr>
</thead>
<tbody><tr>
<td align="left">SIGABRT</td>
<td align="center">6</td>
<td align="center">&#x4E2D;&#x6B62;&#x8FDB;&#x7A0B;</td>
<td align="center">&#x25CF;</td>
<td align="center">core</td>
</tr>
<tr>
<td align="left">SIGALRM</td>
<td align="center">14</td>
<td align="center">&#x5B9E;&#x65F6;&#x5B9A;&#x65F6;&#x5668;&#x8FC7;&#x671F;</td>
<td align="center">&#x25CF;</td>
<td align="center">term</td>
</tr>
<tr>
<td align="left">SIGBUS</td>
<td align="center">7 (SAMP=10)</td>
<td align="center">&#x5185;&#x5B58;&#x8BBF;&#x95EE;&#x9519;&#x8BEF;</td>
<td align="center">&#x25CF;</td>
<td align="center">core</td>
</tr>
<tr>
<td align="left">SIGCHLD</td>
<td align="center">17(SA=20, MP=18)</td>
<td align="center">&#x7EC8;&#x6B62;&#x6216;&#x8005;&#x505C;&#x6B62;&#x5B50;&#x8FDB;&#x7A0B;</td>
<td align="center">&#x25CF;</td>
<td align="center">ignore</td>
</tr>
<tr>
<td align="left">SIGCONT</td>
<td align="center">18 (SA=19, M=25, P=26)</td>
<td align="center">&#x82E5;&#x505C;&#x6B62;&#x5219;&#x7EE7;&#x7EED;</td>
<td align="center">&#x25CF;</td>
<td align="center">cont</td>
</tr>
<tr>
<td align="left">SIGEMT</td>
<td align="center">undef (SAMP=7)</td>
<td align="center">&#x786C;&#x4EF6;&#x9519;&#x8BEF;</td>
<td align="center">-</td>
<td align="center">term</td>
</tr>
<tr>
<td align="left">SIGFPE</td>
<td align="center">8</td>
<td align="center">&#x7B97;&#x672F;&#x5F02;&#x5E38;</td>
<td align="center">&#x25CF;</td>
<td align="center">core</td>
</tr>
<tr>
<td align="left">SIGHUP</td>
<td align="center">1</td>
<td align="center">&#x6302;&#x8D77;</td>
<td align="center">&#x25CF;</td>
<td align="center">term</td>
</tr>
<tr>
<td align="left">SIGILL</td>
<td align="center">4</td>
<td align="center">&#x975E;&#x6CD5;&#x6307;&#x4EE4;</td>
<td align="center">&#x25CF;</td>
<td align="center">core</td>
</tr>
<tr>
<td align="left">SIGINT</td>
<td align="center">2</td>
<td align="center">&#x7EC8;&#x7AEF;&#x4E2D;&#x65AD;</td>
<td align="center">&#x25CF;</td>
<td align="center">term</td>
</tr>
<tr>
<td align="left">SIGIO /</td>
<td align="center">29(SA=23, MP=22)</td>
<td align="center">I/O &#x65F6;&#x53EF;&#x80FD;&#x4EA7;&#x751F;</td>
<td align="center">&#x25CF;</td>
<td align="center">term</td>
</tr>
<tr>
<td align="left">SIGKILL</td>
<td align="center">9</td>
<td align="center">&#x5FC5;&#x6740;&#xFF08;&#x786E;&#x4FDD;&#x6740;&#x6B7B;&#xFF09;</td>
<td align="center">&#x25CF;</td>
<td align="center">term</td>
</tr>
<tr>
<td align="left">SIGPIPE</td>
<td align="center">13</td>
<td align="center">&#x7BA1;&#x9053;&#x65AD;&#x5F00;</td>
<td align="center">&#x25CF;</td>
<td align="center">term</td>
</tr>
<tr>
<td align="left">SIGPROF</td>
<td align="center">27 (M=29, P=21)</td>
<td align="center">&#x6027;&#x80FD;&#x5206;&#x6790;&#x5B9A;&#x65F6;&#x5668;&#x8FC7;&#x671F;</td>
<td align="center">&#x25CF;</td>
<td align="center">term</td>
</tr>
<tr>
<td align="left">SIGPWR</td>
<td align="center">30(SA=29, MP=19)</td>
<td align="center">&#x7535;&#x91CF;&#x884C;&#x5C06;&#x8017;&#x5C3D;</td>
<td align="center">-</td>
<td align="center">term</td>
</tr>
<tr>
<td align="left">SIGQUIT</td>
<td align="center">3</td>
<td align="center">&#x7EC8;&#x7AEF;&#x9000;&#x51FA;</td>
<td align="center">&#x25CF;</td>
<td align="center">core</td>
</tr>
<tr>
<td align="left">SIGSEGV</td>
<td align="center">11</td>
<td align="center">&#x65E0;&#x6548;&#x7684;&#x5185;&#x5B58;&#x5F15;&#x7528;</td>
<td align="center">&#x25CF;</td>
<td align="center">core</td>
</tr>
<tr>
<td align="left">SIGSTKFLT</td>
<td align="center">16 (SAM=undef, P=36)</td>
<td align="center">&#x534F;&#x5904;&#x7406;&#x5668;&#x6808;&#x9519;&#x8BEF;</td>
<td align="center">-</td>
<td align="center">term</td>
</tr>
<tr>
<td align="left">SIGSTOP</td>
<td align="center">19(SA=17, M=23, P=24)</td>
<td align="center">&#x786E;&#x4FDD;&#x505C;&#x6B62;</td>
<td align="center">&#x25CF;</td>
<td align="center">stop</td>
</tr>
<tr>
<td align="left">SIGSYS</td>
<td align="center">31 (SAMP=12)</td>
<td align="center">&#x65E0;&#x6548;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;</td>
<td align="center">&#x25CF;</td>
<td align="center">core</td>
</tr>
<tr>
<td align="left">SIGTERM</td>
<td align="center">15</td>
<td align="center">&#x7EC8;&#x6B62;&#x8FDB;&#x7A0B;</td>
<td align="center">&#x25CF;</td>
<td align="center">-</td>
</tr>
<tr>
<td align="left">SIGTRAP</td>
<td align="center">5</td>
<td align="center">&#x8DDF;&#x8E2A;/&#x65AD;&#x70B9;&#x9677;&#x9631;</td>
<td align="center">&#x25CF;</td>
<td align="center">core</td>
</tr>
<tr>
<td align="left">SIGTSTP</td>
<td align="center">20 (SA=18, M=24, P=25)</td>
<td align="center">&#x7EC8;&#x7AEF;&#x505C;&#x6B62;</td>
<td align="center">&#x25CF;</td>
<td align="center">stop</td>
</tr>
<tr>
<td align="left">SIGTTIN</td>
<td align="center">21 (M=26, P=27)</td>
<td align="center">BG1&#x4ECE;&#x7EC8;&#x7AEF;&#x8BFB;&#x53D6;</td>
<td align="center">&#x25CF;</td>
<td align="center">stop</td>
</tr>
<tr>
<td align="left">SIGTTOU</td>
<td align="center">22 (M=27, P=28)</td>
<td align="center">BG &#x5411;&#x7EC8;&#x7AEF;&#x5199;</td>
<td align="center">&#x25CF;</td>
<td align="center">stop</td>
</tr>
<tr>
<td align="left">SIGURG</td>
<td align="center">23 (SA=16, M=21, P=29)</td>
<td align="center">&#x5957;&#x63A5;&#x5B57;&#x4E0A;&#x7684;&#x7D27;&#x6025;&#x6570;&#x636E;</td>
<td align="center">&#x25CF;</td>
<td align="center">ignore</td>
</tr>
<tr>
<td align="left">SIGUSR1</td>
<td align="center">10 (SA=30, MP=16)</td>
<td align="center">&#x7528;&#x6237;&#x81EA;&#x5B9A;&#x4E49;&#x4FE1;&#x53F7;1</td>
<td align="center">&#x25CF;</td>
<td align="center">term</td>
</tr>
<tr>
<td align="left">SIGUSR2</td>
<td align="center">12 (SA=31, MP=17)</td>
<td align="center">&#x7528;&#x6237;&#x81EA;&#x5B9A;&#x4E49;&#x4FE1;&#x53F7;2</td>
<td align="center">&#x25CF;</td>
<td align="center">term</td>
</tr>
<tr>
<td align="left">SIGVTALRM</td>
<td align="center">26 (M=28, P=20)</td>
<td align="center">&#x865A;&#x62DF;&#x5B9A;&#x65F6;&#x5668;&#x8FC7;&#x671F;</td>
<td align="center">&#x25CF;</td>
<td align="center">term</td>
</tr>
<tr>
<td align="left">SIGWINCH</td>
<td align="center">28 (M=20, P=23)</td>
<td align="center">&#x7EC8;&#x7AEF;&#x7A97;&#x53E3;&#x5C3A;&#x5BF8;&#x53D1;&#x751F;&#x53D8;&#x5316;</td>
<td align="center">-</td>
<td align="center">ignore</td>
</tr>
<tr>
<td align="left">SIGXCPU</td>
<td align="center">24 (M=30, P=33)</td>
<td align="center">&#x7A81;&#x7834;&#x5BF9;CPU &#x65F6;&#x95F4;&#x7684;&#x9650;&#x5236;</td>
<td align="center">&#x25CF;</td>
<td align="center">core</td>
</tr>
<tr>
<td align="left">SIGXFSZ</td>
<td align="center">25 (M=31, P=34)</td>
<td align="center">&#x7A81;&#x7834;&#x5BF9;&#x6587;&#x4EF6;&#x5927;&#x5C0F;&#x7684;&#x9650;&#x5236;</td>
<td align="center">&#x25CF;</td>
<td align="center">core</td>
</tr>
</tbody></table></div>
<h2 id="&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x51FD;&#x6570;signal"><a href="#&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x51FD;&#x6570;signal" class="headerlink" title="&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x51FD;&#x6570;signal()"></a>&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x51FD;&#x6570;signal()</h2><p>UNIX &#x7CFB;&#x7EDF;&#x63D0;&#x4F9B;&#x4E86;&#x4E24;&#x79CD;&#x65B9;&#x6CD5;&#x6765;&#x6539;&#x53D8;&#x4FE1;&#x53F7;&#x5904;&#x7F6E;&#xFF1A;signal()&#x548C;sigaction()&#x3002;<br>signal()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF0C;&#x662F;&#x8BBE;&#x7F6E;&#x4FE1;&#x53F7;&#x5904;&#x7F6E;&#x7684;&#x539F;&#x59CB; API&#xFF0C;&#x6240;&#x63D0;&#x4F9B;&#x7684;&#x63A5;&#x53E3;&#x6BD4;sigaction()&#x7B80;&#x5355;&#x3002;<br>&#x4F46;sigaction()&#x4E0D;&#x5C5E;&#x4E8E; POSIX &#x6807;&#x51C6;&#xFF0C;&#x5728;&#x5404;&#x7C7B; UNIX &#x5E73;&#x53F0;&#x4E0A;&#x7684;&#x5B9E;&#x73B0;&#x4E0D;&#x5C3D;&#x76F8;&#x540C;&#xFF0C;&#x56E0;&#x6B64;&#x5176;&#x7528;&#x9014;&#x53D7;&#x5230;&#x4E86;&#x4E00;&#x5B9A;&#x7684;&#x9650;&#x5236;&#x3002;&#x800C; POSIX &#x6807;&#x51C6;&#x5B9A;&#x4E49;&#x7684;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x63A5;&#x53E3;&#x662F; sigaction &#x51FD;&#x6570;&#x3002;&#x6545;&#x6B64;&#xFF0C;sigaction()&#x662F;&#x5EFA;&#x7ACB;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x7684;&#x9996;&#x9009;API&#xFF08;&#x5F3A;&#x529B;&#x63A8;&#x8350;&#xFF09;&#x3002;</p>
<h3 id="signal"><a href="#signal" class="headerlink" title="signal"></a>signal</h3><pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;signal.h&gt;</span></span>
<span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token function">signal</span><span class="token punctuation">(</span><span class="token keyword">int</span> sig<span class="token punctuation">,</span><span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>handler<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x8FD9;&#x91CC;&#x9700;&#x8981;&#x5BF9;signal()&#x51FD;&#x6570;&#x7684;&#x539F;&#x578B;&#x505A;&#x4E00;&#x4E9B;&#x89E3;&#x91CA;&#x3002;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;sig&#xFF0C;&#x6807;&#x8BC6;&#x5E0C;&#x671B;&#x4FEE;&#x6539;&#x5904;&#x7F6E;&#x7684;&#x4FE1;&#x53F7;&#x7F16;&#x53F7;&#xFF0C;&#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570;handler&#xFF0C;&#x5219;&#x6807;&#x8BC6;&#x4FE1;&#x53F7;&#x62B5;&#x8FBE;&#x65F6;&#x6240;&#x8C03;&#x7528;&#x51FD;&#x6570;&#x7684;&#x5730;&#x5740;&#x3002;&#x8BE5;&#x51FD;&#x6570;&#x65E0;&#x8FD4;&#x56DE;&#x503C;&#xFF08;void&#xFF09;&#xFF0C;&#x5E76;&#x63A5;&#x6536;&#x4E00;&#x4E2A;&#x6574;&#x578B;&#x53C2;&#x6570;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x4E00;&#x822C;&#x5177;&#x6709;&#x4EE5;&#x4E0B;&#x5F62;&#x5F0F;&#xFF1A;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">handler</span><span class="token punctuation">(</span><span class="token keyword">int</span> sig<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x51FD;&#x6570;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x5728;&#x4E3A;signal()&#x6307;&#x5B9A;handler&#x53C2;&#x6570;&#x65F6;&#xFF0C;&#x53EF;&#x4EE5;&#x4EE5;&#x5982;&#x4E0B;&#x503C;&#x6765;&#x4EE3;&#x66FF;&#x51FD;&#x6570;&#x5730;&#x5740;&#xFF1A;</p>
<p>SIG_DFL<br>&#x5C06;&#x4FE1;&#x53F7;&#x5904;&#x7F6E;&#x91CD;&#x7F6E;&#x4E3A;&#x9ED8;&#x8BA4;&#x503C;&#xFF08;&#x8868;20-1&#xFF09;&#x3002;&#x8FD9;&#x9002;&#x7528;&#x4E8E;&#x5C06;&#x4E4B;&#x524D;signal()&#x8C03;&#x7528;&#x6240;&#x6539;&#x53D8;&#x7684;&#x4FE1;&#x53F7;&#x5904;&#x7F6E;&#x8FD8;&#x539F;&#x3002;</p>
<p>SIG_IGN<br>&#x5FFD;&#x7565;&#x8BE5;&#x4FE1;&#x53F7;&#x3002;&#x5982;&#x679C;&#x4FE1;&#x53F7;&#x4E13;&#x4E3A;&#x6B64;&#x8FDB;&#x7A0B;&#x800C;&#x751F;&#xFF0C;&#x90A3;&#x4E48;&#x5185;&#x6838;&#x4F1A;&#x9ED8;&#x9ED8;&#x5C06;&#x5176;&#x4E22;&#x5F03;&#x3002;&#x8FDB;&#x7A0B;&#x751A;&#x81F3;&#x4ECE;&#x672A;&#x77E5;&#x9053;&#x66FE;&#x7ECF;&#x4EA7;&#x751F;&#x4E86;&#x8BE5;&#x4FE1;&#x53F7;&#x3002;</p>
<p><strong>&#x4F8B;1:</strong></p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;signal.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h&gt;</span></span>

<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">sigHandler</span><span class="token punctuation">(</span><span class="token keyword">int</span> sig<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Ouch!\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> j<span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">signal</span><span class="token punctuation">(</span>SIGINT<span class="token punctuation">,</span>sigHandler<span class="token punctuation">)</span><span class="token operator">==</span>SIG_ERR<span class="token punctuation">)</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;signal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%d\n&quot;</span><span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>0
1
2
^Ouch!
3
4
...</code></pre><p>&#x4E3B;&#x7A0B;&#x5E8F;&#x4F1A;&#x6301;&#x7EED;&#x5FAA;&#x73AF;&#x3002;&#x6BCF;&#x6B21;&#x8FED;&#x4EE3;&#xFF0C;&#x7A0B;&#x5E8F;&#x90FD;&#x5C06;&#x9012;&#x589E;&#x8BA1;&#x6570;&#x5668;&#x503C;&#x5E76;&#x5C06;&#x5176;&#x6253;&#x5370;&#x51FA;&#x6765;&#xFF0C;&#x7136;&#x540E;&#x4F11;&#x7720;&#x51E0;&#x79D2;&#x949F;&#x3002;</p>
<h2 id="&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#xFF1A;kill"><a href="#&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#xFF1A;kill" class="headerlink" title="&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#xFF1A;kill()"></a>&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#xFF1A;kill()</h2><p>&#x4E0E;shell&#x7684;kill&#x547D;&#x4EE4;&#x76F8;&#x7C7B;&#x4F3C;&#xFF0C;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x80FD;&#x591F;&#x4F7F;&#x7528;kill()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5411;&#x53E6;&#x4E00;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x3002;&#xFF08;&#x4E4B;&#x6240;&#x4EE5;&#x9009;&#x62E9;kill&#x4F5C;&#x4E3A;&#x672F;&#x8BED;&#xFF0C;&#x662F;&#x56E0;&#x4E3A;&#x65E9;&#x671F;UNIX&#x5B9E;&#x73B0;&#x4E2D;&#x5927;&#x591A;&#x6570;&#x4FE1;&#x53F7;&#x7684;&#x9ED8;&#x8BA4;&#x884C;&#x4E3A;&#x662F;&#x7EC8;&#x6B62;&#x8FDB;&#x7A0B;&#x3002;&#xFF09;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;signal.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">kill</span><span class="token punctuation">(</span>pid_t pid <span class="token punctuation">,</span><span class="token keyword">int</span> sig<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x6210;&#x529F;&#x8FD4;&#x56DE;0&#xFF0C;&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>pid&#x53C2;&#x6570;&#x6807;&#x8BC6;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x76EE;&#x6807;&#x8FDB;&#x7A0B;&#xFF0C;&#x800C;sig&#x5219;&#x6307;&#x5B9A;&#x4E86;&#x8981;&#x53D1;&#x9001;&#x7684;&#x4FE1;&#x53F7;&#x3002;&#x5982;&#x4F55;&#x89E3;&#x91CA;pid&#xFF0C;&#x8981;&#x89C6;&#x4EE5;&#x4E0B;4&#x79CD;&#x60C5;&#x51B5;&#x800C;&#x5B9A;&#x3002;</p>
<ul>
<li>&#x5982;&#x679C;pid&#x5927;&#x4E8E;0&#xFF0C;&#x90A3;&#x4E48;&#x4F1A;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x7ED9;&#x7531;pid&#x6307;&#x5B9A;&#x7684;&#x8FDB;&#x7A0B;&#x3002;</li>
<li>&#x5982;&#x679C;pid&#x7B49;&#x4E8E;0&#xFF0C;&#x90A3;&#x4E48;&#x4F1A;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x7ED9;&#x4E0E;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x540C;&#x7EC4;&#x7684;&#x6BCF;&#x4E2A;&#x8FDB;&#x7A0B;&#xFF0C;&#x5305;&#x62EC;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x81EA;&#x8EAB;&#x3002;&#xFF08;SUSv3&#x58F0;&#x660E;&#xFF0C;&#x9664;&#x53BB;&#x201C;&#x4E00;&#x7EC4;&#x672A;&#x4E88;&#x660E;&#x786E;&#x7684;&#x7CFB;&#x7EDF;&#x8FDB;&#x7A0B;&#x201D;&#x4E4B;&#x5916;&#xFF0C;&#x5E94;&#x5C06;&#x4FE1;&#x53F7;&#x53D1;&#x9001;&#x7ED9;&#x540C;&#x4E00;&#x8FDB;&#x7A0B;&#x7EC4;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x8FDB;&#x7A0B;&#xFF0C;&#x4E14;&#x8FD9;&#x4E00;&#x6392;&#x9664;&#x6761;&#x4EF6;&#x540C;&#x6837;&#x9002;&#x7528;&#x4E8E;&#x4F59;&#x4E0B;&#x7684;&#x4E24;&#x79CD;&#x60C5;&#x51B5;&#x3002;&#xFF09;</li>
<li>&#x5982;&#x679C;pid&#x5C0F;&#x4E8E;&#x2212;1&#xFF0C;&#x90A3;&#x4E48;&#x4F1A;&#x5411;&#x7EC4;ID&#x7B49;&#x4E8E;&#x8BE5;pid&#x7EDD;&#x5BF9;&#x503C;&#x7684;&#x8FDB;&#x7A0B;&#x7EC4;&#x5185;&#x6240;&#x6709;&#x4E0B;&#x5C5E;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x3002;&#x5411;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7EC4;&#x7684;&#x6240;&#x6709;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x5728; shell &#x4F5C;&#x4E1A;&#x63A7;&#x5236;&#x4E2D;&#x6709;&#x7279;&#x6B8A;&#x7528;&#x9014;&#x3002;</li>
<li>&#x5982;&#x679C;pid&#x7B49;&#x4E8E;&#x2212;1&#xFF0C;&#x90A3;&#x4E48;&#x4FE1;&#x53F7;&#x7684;&#x53D1;&#x9001;&#x8303;&#x56F4;&#x662F;&#xFF1A;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x6709;&#x6743;&#x5C06;&#x4FE1;&#x53F7;&#x53D1;&#x5F80;&#x7684;&#x6BCF;&#x4E2A;&#x76EE;&#x6807;&#x8FDB;&#x7A0B;&#xFF0C;&#x9664;&#x53BB;init&#xFF08;&#x8FDB;&#x7A0B;ID&#x4E3A;1&#xFF09;&#x548C;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x81EA;&#x8EAB;&#x3002;&#x5982;&#x679C;&#x7279;&#x6743;&#x7EA7;&#x8FDB;&#x7A0B;&#x53D1;&#x8D77;&#x8FD9;&#x4E00;&#x8C03;&#x7528;&#xFF0C;&#x90A3;&#x4E48;&#x4F1A;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x7ED9;&#x7CFB;&#x7EDF;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x8FDB;&#x7A0B;&#xFF0C;&#x4E0A;&#x8FF0;&#x4E24;&#x4E2A;&#x8FDB;&#x7A0B;&#x9664;&#x5916;&#x3002;&#x663E;&#x800C;&#x6613;&#x89C1;&#xFF0C;&#x6709;&#x65F6;&#x4E5F;&#x5C06;&#x8FD9;&#x79CD;&#x4FE1;&#x53F7;&#x53D1;&#x9001;&#x65B9;&#x5F0F;&#x79F0;&#x4E4B;&#x4E3A;&#x5E7F;&#x64AD;&#x4FE1;&#x53F7;&#x3002;&#xFF08;SUSv3&#x5E76;&#x672A;&#x8981;&#x6C42;&#x5C06;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x6392;&#x9664;&#x5728;&#x4FE1;&#x53F7;&#x7684;&#x63A5;&#x6536;&#x8303;&#x56F4;&#x4E4B;&#x5916;&#xFF0C;Linux&#x6B64;&#x5904;&#x6240;&#x9075;&#x5FAA;&#x7684;&#x662F;BSD&#x7CFB;&#x7EDF;&#x7684;&#x8BED;&#x4E49;&#x3002;&#xFF09;</li>
</ul>
<p>&#x5982;&#x679C;&#x5E76;&#x65E0;&#x8FDB;&#x7A0B;&#x4E0E;&#x6307;&#x5B9A;&#x7684;pid&#x76F8;&#x5339;&#x914D;&#xFF0C;&#x90A3;&#x4E48;kill()&#x8C03;&#x7528;&#x5931;&#x8D25;&#xFF0C;&#x540C;&#x65F6;&#x5C06;errno&#x7F6E;&#x4E3A;ESRCH&#xFF08;&#x201C;&#x67E5;&#x65E0;&#x6B64;&#x8FDB;&#x7A0B;&#x201D;&#xFF09;&#x3002;</p>
<p>&#x8FDB;&#x7A0B;&#x8981;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x7ED9;&#x53E6;&#x4E00;&#x8FDB;&#x7A0B;&#xFF0C;&#x8FD8;&#x9700;&#x8981;&#x9002;&#x5F53;&#x7684;&#x6743;&#x9650;&#xFF0C;&#x5176;&#x6743;&#x9650;&#x89C4;&#x5219;&#x5982;&#x4E0B;&#x3002;</p>
<ul>
<li>&#x7279;&#x6743;&#x7EA7;&#xFF08;CAP_KILL&#xFF09;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x5411;&#x4EFB;&#x4F55;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x3002;</li>
<li>&#x4EE5;root&#x7528;&#x6237;&#x548C;&#x7EC4;&#x8FD0;&#x884C;&#x7684;init&#x8FDB;&#x7A0B;&#xFF08;&#x8FDB;&#x7A0B;&#x53F7;&#x4E3A;1&#xFF09;&#xFF0C;&#x662F;&#x4E00;&#x79CD;&#x7279;&#x4F8B;&#xFF0C;&#x4EC5;&#x80FD;&#x63A5;&#x6536;&#x5DF2;&#x5B89;&#x88C5;&#x4E86;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x7684;&#x4FE1;&#x53F7;&#x3002;&#x8FD9;&#x53EF;&#x4EE5;&#x9632;&#x6B62;&#x7CFB;&#x7EDF;&#x7BA1;&#x7406;&#x5458;&#x610F;&#x5916;&#x6740;&#x6B7B;init&#x8FDB;&#x7A0B;&#x2014;&#x2014;&#x8FD9;&#x4E00;&#x7CFB;&#x7EDF;&#x8FD0;&#x4F5C;&#x7684;&#x57FA;&#x77F3;&#x3002;</li>
<li>&#x5982;&#x679C;&#x53D1;&#x9001;&#x8005;&#x7684;&#x5B9E;&#x9645;&#x6216;&#x6709;&#x6548;&#x7528;&#x6237;ID&#x5339;&#x914D;&#x4E8E;&#x63A5;&#x53D7;&#x8005;&#x7684;&#x5B9E;&#x9645;&#x7528;&#x6237;ID&#x6216;&#x8005;&#x4FDD;&#x5B58;&#x8BBE;&#x7F6E;&#x7528;&#x6237;ID(saved set-user-id)&#xFF0C;&#x90A3;&#x4E48;&#x975E;&#x7279;&#x6743;&#x8FDB;&#x7A0B;&#x4E5F;&#x53EF;&#x4EE5;&#x5411;&#x53E6;&#x4E00;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x3002;&#x5229;&#x7528;&#x8FD9;&#x4E00;&#x89C4;&#x5219;&#xFF0C;&#x7528;&#x6237;&#x53EF;&#x4EE5;&#x5411;&#x7531;&#x4ED6;&#x4EEC;&#x542F;&#x52A8;&#x7684;set-user-ID&#x7A0B;&#x5E8F;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#xFF0C;&#x800C;&#x65E0;&#x9700;&#x8003;&#x8651;&#x76EE;&#x6807;&#x8FDB;&#x7A0B;&#x6709;&#x6548;&#x7528;&#x6237;ID&#x7684;&#x5F53;&#x524D;&#x8BBE;&#x7F6E;&#x3002;&#x5C06;&#x76EE;&#x6807;&#x8FDB;&#x7A0B;&#x6709;&#x6548;&#x7528;&#x6237;ID&#x6392;&#x9664;&#x5728;&#x68C0;&#x67E5;&#x8303;&#x56F4;&#x4E4B;&#x5916;&#xFF0C;&#x8FD9;&#x4E00;&#x4E3E;&#x63AA;&#x7684;&#x8F85;&#x52A9;&#x4F5C;&#x7528;&#x5728;&#x4E8E;&#x9632;&#x6B62;&#x7528;&#x6237;&#x67D0;&#x7532;&#x5411;&#x7528;&#x6237;&#x67D0;&#x4E59;&#x7684;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#xFF0C;&#x800C;&#x8BE5;&#x8FDB;&#x7A0B;&#x6B63;&#x5728;&#x6267;&#x884C;&#x7684;set-user-ID&#x7A0B;&#x5E8F;&#x53C8;&#x5C5E;&#x4E8E;&#x7528;&#x6237;&#x67D0;&#x7532;&#x3002;&#xFF08;SUSv3&#x8981;&#x6C42;&#x5F3A;&#x5236;&#x6267;&#x884C;&#x56FE;20-2&#x6240;&#x793A;&#x7684;&#x89C4;&#x5219;&#xFF0C;&#x4F46;&#x5982;kill(2)&#x624B;&#x518C;&#x9875;&#x6240;&#x8FF0;&#xFF0C;Linux&#x5185;&#x6838;&#x5728;2.0&#x7248;&#x672C;&#x4E4B;&#x524D;&#x6240;&#x9075;&#x5FAA;&#x7684;&#x89C4;&#x5219;&#x7565;&#x6709;&#x4E0D;&#x540C;&#x3002;&#xFF09;</li>
<li>SIGCONT&#x4FE1;&#x53F7;&#x9700;&#x8981;&#x7279;&#x6B8A;&#x5904;&#x7406;&#x3002;&#x65E0;&#x8BBA;&#x5BF9;&#x7528;&#x6237;ID&#x7684;&#x68C0;&#x67E5;&#x7ED3;&#x679C;&#x5982;&#x4F55;&#xFF0C;&#x975E;&#x7279;&#x6743;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x5411;&#x540C;&#x4E00;&#x4F1A;&#x8BDD;&#x4E2D;&#x7684;&#x4EFB;&#x4F55;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;&#x8FD9;&#x4E00;&#x4FE1;&#x53F7;&#x3002;&#x5229;&#x7528;&#x8FD9;&#x4E00;&#x89C4;&#x5219;&#xFF0C;&#x8FD0;&#x884C;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;&#x7684;shell&#x53EF;&#x4EE5;&#x91CD;&#x542F;&#x5DF2;&#x505C;&#x6B62;&#x7684;&#x4F5C;&#x4E1A;&#xFF08;&#x8FDB;&#x7A0B;&#x7EC4;&#xFF09;&#xFF0C;&#x5373;&#x4F7F;&#x4F5C;&#x4E1A;&#x8FDB;&#x7A0B;&#x5DF2;&#x7ECF;&#x4FEE;&#x6539;&#x4E86;&#x5B83;&#x4EEC;&#x7684;&#x7528;&#x6237;ID&#x3002;</li>
</ul>
<div class="amp-img-wrapper"><amp-img src="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1581238392245.png?x-oss-process=image/resize,m_lfit,h_450" width="602" height="308" layout="responsive"></amp-img></div>
<p>&#x5982;&#x679C;&#x8FDB;&#x7A0B;&#x65E0;&#x6743;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x7ED9;&#x6240;&#x8BF7;&#x6C42;&#x7684;pid&#xFF0C;&#x90A3;&#x4E48;kill()&#x8C03;&#x7528;&#x5C06;&#x5931;&#x8D25;&#xFF0C;&#x4E14;&#x5C06;errno&#x7F6E;&#x4E3A;EPERM&#x3002;&#x82E5;pid&#x6240;&#x6307;&#x4E3A;&#x4E00;&#x7CFB;&#x5217;&#x8FDB;&#x7A0B;&#xFF08;&#x5373;pid&#x662F;&#x8D1F;&#x503C;&#xFF09;&#x65F6;&#xFF0C;&#x53EA;&#x8981;&#x53EF;&#x4EE5;&#x5411;&#x5176;&#x4E2D;&#x4E4B;&#x4E00;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#xFF0C;&#x5219;kill()&#x8C03;&#x7528;&#x6210;&#x529F;&#x3002;</p>
<h2 id="&#x68C0;&#x67E5;&#x8FDB;&#x7A0B;&#x7684;&#x5B58;&#x5728;"><a href="#&#x68C0;&#x67E5;&#x8FDB;&#x7A0B;&#x7684;&#x5B58;&#x5728;" class="headerlink" title="&#x68C0;&#x67E5;&#x8FDB;&#x7A0B;&#x7684;&#x5B58;&#x5728;"></a>&#x68C0;&#x67E5;&#x8FDB;&#x7A0B;&#x7684;&#x5B58;&#x5728;</h2><p>kill()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x8FD8;&#x6709;&#x53E6;&#x4E00;&#x91CD;&#x529F;&#x7528;&#x3002;&#x82E5;&#x5C06;&#x53C2;&#x6570;sig&#x6307;&#x5B9A;&#x4E3A;0&#xFF08;&#x5373;&#x6240;&#x8C13;&#x7A7A;&#x4FE1;&#x53F7;&#xFF09;&#xFF0C;&#x5219;&#x65E0;&#x4FE1;&#x53F7;&#x53D1;&#x9001;&#x3002;&#x76F8;&#x53CD;&#xFF0C;kill()&#x4EC5;&#x4F1A;&#x53BB;&#x6267;&#x884C;&#x9519;&#x8BEF;&#x68C0;&#x67E5;&#xFF0C;&#x67E5;&#x770B;&#x662F;&#x5426;&#x53EF;&#x4EE5;&#x5411;&#x76EE;&#x6807;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x3002;&#x4ECE;&#x53E6;&#x4E00;&#x89D2;&#x5EA6;&#x6765;&#x770B;&#xFF0C;&#x8FD9;&#x610F;&#x5473;&#x7740;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x7A7A;&#x4FE1;&#x53F7;&#x6765;&#x68C0;&#x6D4B;&#x5177;&#x6709;&#x7279;&#x5B9A;&#x8FDB;&#x7A0B;ID&#x7684;&#x8FDB;&#x7A0B;&#x662F;&#x5426;&#x5B58;&#x5728;&#x3002;&#x82E5;&#x53D1;&#x9001;&#x7A7A;&#x4FE1;&#x53F7;&#x5931;&#x8D25;&#xFF0C;&#x4E14;errno&#x4E3A;ESRCH&#xFF0C;&#x5219;&#x8868;&#x660E;&#x76EE;&#x6807;&#x8FDB;&#x7A0B;&#x4E0D;&#x5B58;&#x5728;&#x3002;&#x5982;&#x679C;&#x8C03;&#x7528;&#x5931;&#x8D25;&#xFF0C;&#x4E14;errno&#x4E3A;EPERM&#xFF08;&#x8868;&#x793A;&#x8FDB;&#x7A0B;&#x5B58;&#x5728;&#xFF0C;&#x4F46;&#x65E0;&#x6743;&#x5411;&#x76EE;&#x6807;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#xFF09;&#x6216;&#x8005;&#x8C03;&#x7528;&#x6210;&#x529F;&#xFF08;&#x6709;&#x6743;&#x5411;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#xFF09;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x8868;&#x793A;&#x8FDB;&#x7A0B;&#x5B58;&#x5728;&#x3002;</p>
<h2 id="&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x7684;&#x5176;&#x4ED6;&#x65B9;&#x5F0F;&#xFF1A;raise-&#x548C;killpg"><a href="#&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x7684;&#x5176;&#x4ED6;&#x65B9;&#x5F0F;&#xFF1A;raise-&#x548C;killpg" class="headerlink" title="&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x7684;&#x5176;&#x4ED6;&#x65B9;&#x5F0F;&#xFF1A;raise()&#x548C;killpg()"></a>&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x7684;&#x5176;&#x4ED6;&#x65B9;&#x5F0F;&#xFF1A;raise()&#x548C;killpg()</h2><p>&#x6709;&#x65F6;&#xFF0C;&#x8FDB;&#x7A0B;&#x9700;&#x8981;&#x5411;&#x81EA;&#x8EAB;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x3002;raise()&#x51FD;&#x6570;&#x5C31;&#x6267;&#x884C;&#x4E86;&#x8FD9;&#x4E00;&#x4EFB;&#x52A1;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;signal.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">raise</span><span class="token punctuation">(</span><span class="token keyword">int</span> sig<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x5728;&#x5355;&#x7EBF;&#x7A0B;&#x7A0B;&#x5E8F;&#x4E2D;&#xFF0C;&#x8C03;&#x7528;raise()&#x76F8;&#x5F53;&#x4E8E;&#x5BF9;kill()&#x7684;&#x5982;&#x4E0B;&#x8C03;&#x7528;&#xFF1A;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token function">kill</span><span class="token punctuation">(</span><span class="token function">getpid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>sig<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>&#x652F;&#x6301;&#x7EBF;&#x7A0B;&#x7684;&#x7CFB;&#x7EDF;&#x4F1A;&#x5C06;raise(sig)&#x5B9E;&#x73B0;&#x4E3A;&#xFF1A;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token function">pthread_kill</span><span class="token punctuation">(</span><span class="token function">pthread_self</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>sig<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>pthread_kill()&#x610F;&#x5473;&#x7740;&#x5C06;&#x4FE1;&#x53F7;&#x4F20;&#x9012;&#x7ED9;&#x8C03;&#x7528;raise()&#x7684;&#x7279;&#x5B9A;&#x7EBF;&#x7A0B;&#x3002;&#x76F8;&#x6BD4;&#x4E4B;&#x4E0B;&#xFF0C;kill(getpid(), sig)&#x8C03;&#x7528;&#x4F1A;&#x53D1;&#x9001;&#x4E00;&#x4E2A;&#x4FE1;&#x53F7;&#x7ED9;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#xFF0C;&#x5E76;&#x53EF;&#x5C06;&#x8BE5;&#x4FE1;&#x53F7;&#x4F20;&#x9012;&#x7ED9;&#x8BE5;&#x8FDB;&#x7A0B;&#x7684;&#x4EFB;&#x4E00;&#x7EBF;&#x7A0B;&#x3002;</p>
<p>killpg()&#x51FD;&#x6570;&#x5411;&#x67D0;&#x4E00;&#x8FDB;&#x7A0B;&#x7EC4;&#x7684;&#x6240;&#x6709;&#x6210;&#x5458;&#x53D1;&#x9001;&#x4E00;&#x4E2A;&#x4FE1;&#x53F7;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;signal.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">killpg</span><span class="token punctuation">(</span>pid_t pgrp<span class="token punctuation">,</span><span class="token keyword">int</span> sig<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>killpg()&#x8C03;&#x7528;&#x76F8;&#x5F53;&#x4E8E;&#x5BF9;kill()&#x7684;&#x5982;&#x4E0B;&#x8C03;&#x7528;&#xFF1A;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token function">kill</span><span class="token punctuation">(</span><span class="token operator">-</span>pgrp<span class="token punctuation">,</span><span class="token keyword">int</span> sig<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="&#x663E;&#x793A;&#x4FE1;&#x53F7;&#x63CF;&#x8FF0;"><a href="#&#x663E;&#x793A;&#x4FE1;&#x53F7;&#x63CF;&#x8FF0;" class="headerlink" title="&#x663E;&#x793A;&#x4FE1;&#x53F7;&#x63CF;&#x8FF0;"></a>&#x663E;&#x793A;&#x4FE1;&#x53F7;&#x63CF;&#x8FF0;</h2><pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;signal.h&gt;</span></span>

<span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">strsignal</span><span class="token punctuation">(</span><span class="token keyword">int</span> sig<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>strsignal()&#x51FD;&#x6570;&#x5BF9;sig&#x53C2;&#x6570;&#x8FDB;&#x884C;&#x8FB9;&#x754C;&#x68C0;&#x67E5;&#xFF0C;&#x7136;&#x540E;&#x8FD4;&#x56DE;&#x4E00;&#x679A;&#x6307;&#x9488;&#xFF0C;&#x6307;&#x5411;&#x9488;&#x5BF9;&#x8BE5;&#x4FE1;&#x53F7;&#x7684;&#x53EF;&#x6253;&#x5370;&#x63CF;&#x8FF0;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x6216;&#x8005;&#x662F;&#x5F53;&#x4FE1;&#x53F7;&#x7F16;&#x53F7;&#x65E0;&#x6548;&#x65F6;&#x6307;&#x5411;&#x9519;&#x8BEF;&#x5B57;&#x7B26;&#x4E32;&#x3002;&#xFF08;&#x5728;&#x5176;&#x4ED6;&#x4E00;&#x4E9B;UNIX&#x5B9E;&#x73B0;&#x4E2D;&#xFF0C;strsignal()&#x51FD;&#x6570;&#x4F1A;&#x5728;sig&#x65E0;&#x6548;&#x65F6;&#x8FD4;&#x56DE;&#x7A7A;&#x503C;&#x3002;&#xFF09;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;signal.h&gt;</span></span>

<span class="token keyword">void</span> <span class="token function">psignal</span><span class="token punctuation">(</span><span class="token keyword">int</span> sig<span class="token punctuation">,</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h2 id="&#x4FE1;&#x53F7;&#x96C6;"><a href="#&#x4FE1;&#x53F7;&#x96C6;" class="headerlink" title="&#x4FE1;&#x53F7;&#x96C6;"></a>&#x4FE1;&#x53F7;&#x96C6;</h2><p>&#x591A;&#x4E2A;&#x4FE1;&#x53F7;&#x53EF;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x79F0;&#x4E4B;&#x4E3A;&#x4FE1;&#x53F7;&#x96C6;&#x7684;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x6765;&#x8868;&#x793A;&#xFF0C;&#x5176;&#x7CFB;&#x7EDF;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x4E3A;sigset_t.&#x3002;SUSv3&#x89C4;&#x5B9A;&#x4E86;&#x4E00;&#x7CFB;&#x5217;&#x51FD;&#x6570;&#x6765;&#x64CD;&#x7EB5;&#x4FE1;&#x53F7;&#x96C6;.</p>
<p>sigemptyset()&#x51FD;&#x6570;&#x521D;&#x59CB;&#x5316;&#x4E00;&#x4E2A;&#x672A;&#x5305;&#x542B;&#x4EFB;&#x4F55;&#x6210;&#x5458;&#x7684;&#x4FE1;&#x53F7;&#x96C6;&#x3002;sigfillset()&#x51FD;&#x6570;&#x5219;&#x521D;&#x59CB;&#x5316;&#x4E00;&#x4E2A;&#x4FE1;&#x53F7;&#x96C6;&#xFF0C;&#x4F7F;&#x5176;&#x5305;&#x542B;&#x6240;&#x6709;&#x4FE1;&#x53F7;&#xFF08;&#x5305;&#x62EC;&#x6240;&#x6709;&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;&#xFF09;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;signal.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">sigemptyset</span><span class="token punctuation">(</span>sigset_t <span class="token operator">*</span>set<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x6210;&#x529F;&#x8FD4;&#x56DE;0&#xFF0C;&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1</span>
<span class="token keyword">int</span> <span class="token function">sigfillset</span><span class="token punctuation">(</span>sigset_t <span class="token operator">*</span>set<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x6210;&#x529F;&#x8FD4;&#x56DE;0&#xFF0C;&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x5FC5;&#x987B;&#x4F7F;&#x7528;sigemptyset()&#x6216;&#x8005;sigfillset()&#x6765;&#x521D;&#x59CB;&#x5316;&#x4FE1;&#x53F7;&#x96C6;&#x3002;&#x8FD9;&#x662F;&#x56E0;&#x4E3A;C&#x8BED;&#x8A00;&#x4E0D;&#x4F1A;&#x5BF9;&#x81EA;&#x52A8;&#x53D8;&#x91CF;&#x8FDB;&#x884C;&#x521D;&#x59CB;&#x5316;&#xFF0C;&#x5E76;&#x4E14;&#xFF0C;&#x501F;&#x52A9;&#x4E8E;&#x5C06;&#x9759;&#x6001;&#x53D8;&#x91CF;&#x521D;&#x59CB;&#x5316;&#x4E3A;0&#x7684;&#x673A;&#x5236;&#x6765;&#x8868;&#x793A;&#x7A7A;&#x4FE1;&#x53F7;&#x96C6;&#x7684;&#x4F5C;&#x6CD5;&#x5728;&#x53EF;&#x79FB;&#x690D;&#x6027;&#x4E0A;&#x5B58;&#x5728;&#x95EE;&#x9898;&#xFF0C;&#x56E0;&#x4E3A;&#x6709;&#x53EF;&#x80FD;&#x4F7F;&#x7528;&#x4F4D;&#x63A9;&#x7801;&#x4E4B;&#x5916;&#x7684;&#x7ED3;&#x6784;&#x6765;&#x5B9E;&#x73B0;&#x4FE1;&#x53F7;&#x96C6;&#x3002;&#xFF08;&#x51FA;&#x4E8E;&#x540C;&#x4E00;&#x539F;&#x56E0;&#xFF0C;&#x4E3A;&#x5C06;&#x4FE1;&#x53F7;&#x96C6;&#x6807;&#x8BB0;&#x4E3A;&#x7A7A;&#x800C;&#x4F7F;&#x7528;memset(3)&#x51FD;&#x6570;&#x5C06;&#x5176;&#x5185;&#x5BB9;&#x6E05;&#x96F6;&#x7684;&#x505A;&#x6CD5;&#x4E5F;&#x4E0D;&#x6B63;&#x786E;&#x3002;&#xFF09;</p>
<p>&#x4FE1;&#x53F7;&#x96C6;&#x521D;&#x59CB;&#x5316;&#x540E;&#xFF0C;&#x53EF;&#x4EE5;&#x5206;&#x522B;&#x4F7F;&#x7528; sigaddset()&#x548C; sigdelset()&#x51FD;&#x6570;&#x5411;&#x4E00;&#x4E2A;&#x96C6;&#x5408;&#x4E2D;&#x6DFB;&#x52A0;&#x6216;&#x8005;&#x79FB;&#x9664;&#x5355;&#x4E2A;&#x4FE1;&#x53F7;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;signal.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">sigaddset</span><span class="token punctuation">(</span>sigset_t <span class="token operator">*</span>set<span class="token punctuation">,</span><span class="token keyword">int</span> sig<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x6210;&#x529F;&#x8FD4;&#x56DE;0&#xFF0C;&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1</span>
<span class="token keyword">int</span> <span class="token function">sigfillset</span><span class="token punctuation">(</span>sigset_t <span class="token operator">*</span>set<span class="token punctuation">,</span><span class="token keyword">int</span> sig<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x6210;&#x529F;&#x8FD4;&#x56DE;0&#xFF0C;&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>sigismember()&#x51FD;&#x6570;&#x7528;&#x6765;&#x6D4B;&#x8BD5;&#x4FE1;&#x53F7;sig&#x662F;&#x5426;&#x662F;&#x4FE1;&#x53F7;&#x96C6;set&#x7684;&#x6210;&#x5458;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;signal.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">sigaddset</span><span class="token punctuation">(</span>sigset_t <span class="token operator">*</span>set<span class="token punctuation">,</span><span class="token keyword">int</span> sig<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x662F;&#x6210;&#x5458;&#x8FD4;&#x56DE;1&#xFF0C;&#x4E0D;&#x662F;&#x6210;&#x5458;&#x5219;&#x8FD4;&#x56DE;0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="&#x4FE1;&#x53F7;&#x63A9;&#x7801;&#xFF08;&#x963B;&#x585E;&#x4FE1;&#x53F7;&#x4F20;&#x9012;&#xFF09;"><a href="#&#x4FE1;&#x53F7;&#x63A9;&#x7801;&#xFF08;&#x963B;&#x585E;&#x4FE1;&#x53F7;&#x4F20;&#x9012;&#xFF09;" class="headerlink" title="&#x4FE1;&#x53F7;&#x63A9;&#x7801;&#xFF08;&#x963B;&#x585E;&#x4FE1;&#x53F7;&#x4F20;&#x9012;&#xFF09;"></a>&#x4FE1;&#x53F7;&#x63A9;&#x7801;&#xFF08;&#x963B;&#x585E;&#x4FE1;&#x53F7;&#x4F20;&#x9012;&#xFF09;</h2><p>&#x5185;&#x6838;&#x4F1A;&#x4E3A;&#x6BCF;&#x4E2A;&#x8FDB;&#x7A0B;&#x7EF4;&#x62A4;&#x4E00;&#x4E2A;&#x4FE1;&#x53F7;&#x63A9;&#x7801;&#xFF0C;&#x5373;&#x4E00;&#x7EC4;&#x4FE1;&#x53F7;&#xFF0C;&#x5E76;&#x5C06;&#x963B;&#x585E;&#x5176;&#x9488;&#x5BF9;&#x8BE5;&#x8FDB;&#x7A0B;&#x7684;&#x4F20;&#x9012;&#x3002;&#x5982;&#x679C;&#x5C06;&#x906D;&#x963B;&#x585E;&#x7684;&#x4FE1;&#x53F7;&#x53D1;&#x9001;&#x7ED9;&#x67D0;&#x8FDB;&#x7A0B;&#xFF0C;&#x90A3;&#x4E48;&#x5BF9;&#x8BE5;&#x4FE1;&#x53F7;&#x7684;&#x4F20;&#x9012;&#x5C06;&#x5EF6;&#x540E;&#xFF0C;&#x76F4;&#x81F3;&#x4ECE;&#x8FDB;&#x7A0B;&#x4FE1;&#x53F7;&#x63A9;&#x7801;&#x4E2D;&#x79FB;&#x9664;&#x8BE5;&#x4FE1;&#x53F7;&#xFF0C;&#x4ECE;&#x800C;&#x89E3;&#x9664;&#x963B;&#x585E;&#x4E3A;&#x6B62;&#x3002;<br>&#x5411;&#x4FE1;&#x53F7;&#x63A9;&#x7801;&#x4E2D;&#x6DFB;&#x52A0;&#x4E00;&#x4E2A;&#x4FE1;&#x53F7;&#xFF0C;&#x6709;&#x5982;&#x4E0B;&#x51E0;&#x79CD;&#x65B9;&#x5F0F;&#x3002;</p>
<ul>
<li>&#x5F53;&#x8C03;&#x7528;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x7A0B;&#x5E8F;&#x65F6;&#xFF0C;&#x53EF;&#x5C06;&#x5F15;&#x53D1;&#x8C03;&#x7528;&#x7684;&#x4FE1;&#x53F7;&#x81EA;&#x52A8;&#x6DFB;&#x52A0;&#x5230;&#x4FE1;&#x53F7;&#x63A9;&#x7801;&#x4E2D;&#x3002;&#x662F;&#x5426;&#x53D1;&#x751F;&#x8FD9;&#x4E00;&#x60C5;&#x51B5;&#xFF0C;&#x8981;&#x89C6;sigaction()&#x51FD;&#x6570;&#x5728;&#x5B89;&#x88C5;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x7A0B;&#x5E8F;&#x65F6;&#x6240;&#x4F7F;&#x7528;&#x7684;&#x6807;&#x5FD7;&#x800C;&#x5B9A;&#x3002;</li>
<li>&#x4F7F;&#x7528;sigaction()&#x51FD;&#x6570;&#x5EFA;&#x7ACB;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x7A0B;&#x5E8F;&#x65F6;&#xFF0C;&#x53EF;&#x4EE5;&#x6307;&#x5B9A;&#x4E00;&#x7EC4;&#x989D;&#x5916;&#x4FE1;&#x53F7;&#xFF0C;&#x5F53;&#x8C03;&#x7528;&#x8BE5;&#x5904;&#x7406;&#x5668;&#x7A0B;&#x5E8F;&#x65F6;&#x4F1A;&#x5C06;&#x5176;&#x963B;&#x585E;&#x3002;</li>
<li>&#x4F7F;&#x7528;sigprocmask()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF0C;&#x968F;&#x65F6;&#x53EF;&#x4EE5;&#x663E;&#x5F0F;&#x5411;&#x4FE1;&#x53F7;&#x63A9;&#x7801;&#x4E2D;&#x6DFB;&#x52A0;&#x6216;&#x79FB;&#x9664;&#x4FE1;&#x53F7;&#x3002;</li>
</ul>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;signal.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">sigprocmask</span><span class="token punctuation">(</span><span class="token keyword">int</span> how<span class="token punctuation">,</span>cosnt sigset_t  <span class="token operator">*</span>sel<span class="token punctuation">,</span> sigset_t <span class="token operator">*</span>oldsel<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x6210;&#x529F;&#x8FD4;&#x56DE;0&#xFF0C;&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x4F7F;&#x7528;sigprocmask()&#x51FD;&#x6570;&#x65E2;&#x53EF;&#x4FEE;&#x6539;&#x8FDB;&#x7A0B;&#x7684;&#x4FE1;&#x53F7;&#x63A9;&#x7801;&#xFF0C;&#x53C8;&#x53EF;&#x83B7;&#x53D6;&#x73B0;&#x6709;&#x63A9;&#x7801;&#xFF0C;&#x6216;&#x8005;&#x4E24;&#x91CD;&#x529F;&#x6548;&#x517C;&#x5177;&#x3002;how&#x53C2;&#x6570;&#x6307;&#x5B9A;&#x4E86;sigprocmask()&#x51FD;&#x6570;&#x60F3;&#x7ED9;&#x4FE1;&#x53F7;&#x63A9;&#x7801;&#x5E26;&#x6765;&#x7684;&#x53D8;&#x5316;&#x3002;<br><code>SIG_BLOCK</code>&#x5C06;set&#x6307;&#x5411;&#x4FE1;&#x53F7;&#x96C6;&#x5185;&#x7684;&#x6307;&#x5B9A;&#x4FE1;&#x53F7;&#x6DFB;&#x52A0;&#x5230;&#x4FE1;&#x53F7;&#x63A9;&#x7801;&#x4E2D;&#x3002;&#x6362;&#x8A00;&#x4E4B;&#xFF0C;&#x5C06;&#x4FE1;&#x53F7;&#x63A9;&#x7801;&#x8BBE;&#x7F6E;&#x4E3A;&#x5176;&#x5F53;&#x524D;&#x503C;&#x548C;set&#x7684;&#x5E76;&#x96C6;&#x3002;<br><code>SIG_UNBLOCK</code>&#x5C06;set&#x6307;&#x5411;&#x4FE1;&#x53F7;&#x96C6;&#x4E2D;&#x7684;&#x4FE1;&#x53F7;&#x4ECE;&#x4FE1;&#x53F7;&#x63A9;&#x7801;&#x4E2D;&#x79FB;&#x9664;&#x3002;&#x5373;&#x4F7F;&#x8981;&#x89E3;&#x9664;&#x963B;&#x585E;&#x7684;&#x4FE1;&#x53F7;&#x5F53;&#x524D;&#x5E76;&#x672A;&#x5904;&#x4E8E;&#x963B;&#x585E;&#x72B6;&#x6001;&#xFF0C;&#x4E5F;&#x4E0D;&#x4F1A;&#x8FD4;&#x56DE;&#x9519;&#x8BEF;&#x3002;<br><code>SIG_SETMASK</code>&#x5C06;set&#x6307;&#x5411;&#x7684;&#x4FE1;&#x53F7;&#x96C6;&#x8D4B;&#x7ED9;&#x4FE1;&#x53F7;&#x63A9;&#x7801;&#x3002;<br>&#x4E0A;&#x8FF0;&#x5404;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x82E5;oldset&#x53C2;&#x6570;&#x4E0D;&#x4E3A;&#x7A7A;&#xFF0C;&#x5219;&#x5176;&#x6307;&#x5411;&#x4E00;&#x4E2A;sigset_t&#x7ED3;&#x6784;&#x7F13;&#x51B2;&#x533A;&#xFF0C;&#x7528;&#x4E8E;&#x8FD4;&#x56DE;&#x4E4B;&#x524D;&#x7684;&#x4FE1;&#x53F7;&#x63A9;&#x7801;&#x3002;<br>&#x5982;&#x679C;&#x60F3;&#x83B7;&#x53D6;&#x4FE1;&#x53F7;&#x63A9;&#x7801;&#x800C;&#x53C8;&#x5BF9;&#x5176;&#x4E0D;&#x4F5C;&#x6539;&#x52A8;&#xFF0C;&#x90A3;&#x4E48;&#x53EF;&#x5C06;set&#x53C2;&#x6570;&#x6307;&#x5B9A;&#x4E3A;&#x7A7A;&#xFF0C;&#x8FD9;&#x65F6;&#x5C06;&#x5FFD;&#x7565;how&#x53C2;&#x6570;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c">sigset_t blockSet<span class="token punctuation">,</span>precMask<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//&#x521D;&#x59CB;&#x5316;&#x4FE1;&#x53F7;&#x96C6;</span>
<span class="token function">sigemptyset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>blockSet<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">sigaddset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>blockSet<span class="token punctuation">,</span>SIFINT<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">sigprocmask</span><span class="token punctuation">(</span>SIG_BLOCK<span class="token punctuation">,</span><span class="token operator">&amp;</span>blockSet<span class="token punctuation">,</span><span class="token operator">&amp;</span>precMask<span class="token punctuation">)</span><span class="token operator">==</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;sigprocmask1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">sigprocmask</span><span class="token punctuation">(</span>SIG_SETMASK<span class="token punctuation">,</span><span class="token operator">&amp;</span>prevMask<span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;sigprocmask2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="&#x5904;&#x4E8E;&#x7B49;&#x5F85;&#x72B6;&#x6001;&#x7684;&#x4FE1;&#x53F7;"><a href="#&#x5904;&#x4E8E;&#x7B49;&#x5F85;&#x72B6;&#x6001;&#x7684;&#x4FE1;&#x53F7;" class="headerlink" title="&#x5904;&#x4E8E;&#x7B49;&#x5F85;&#x72B6;&#x6001;&#x7684;&#x4FE1;&#x53F7;"></a>&#x5904;&#x4E8E;&#x7B49;&#x5F85;&#x72B6;&#x6001;&#x7684;&#x4FE1;&#x53F7;</h2><p>&#x5982;&#x679C;&#x67D0;&#x8FDB;&#x7A0B;&#x63A5;&#x53D7;&#x4E86;&#x4E00;&#x4E2A;&#x8BE5;&#x8FDB;&#x7A0B;&#x6B63;&#x5728;&#x963B;&#x585E;&#x7684;&#x4FE1;&#x53F7;&#xFF0C;&#x90A3;&#x4E48;&#x4F1A;&#x5C06;&#x8BE5;&#x4FE1;&#x53F7;&#x586B;&#x52A0;&#x5230;&#x8FDB;&#x7A0B;&#x7684;&#x7B49;&#x5F85;&#x4FE1;&#x53F7;&#x96C6;&#x4E2D;&#x3002;&#x5F53;&#xFF08;&#x4E14;&#x5982;&#x679C;&#xFF09;&#x4E4B;&#x540E;&#x89E3;&#x9664;&#x4E86;&#x5BF9;&#x8BE5;&#x4FE1;&#x53F7;&#x7684;&#x9501;&#x5B9A;&#x65F6;&#xFF0C;&#x4F1A;&#x968F;&#x4E4B;&#x5C06;&#x4FE1;&#x53F7;&#x4F20;&#x9012;&#x7ED9;&#x6B64;&#x8FDB;&#x7A0B;&#x3002;&#x4E3A;&#x4E86;&#x786E;&#x5B9A;&#x8FDB;&#x7A0B;&#x4E2D;&#x5904;&#x4E8E;&#x7B49;&#x5F85;&#x72B6;&#x6001;&#x7684;&#x662F;&#x54EA;&#x4E9B;&#x4FE1;&#x53F7;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;sigpending()&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;signal.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">sigpending</span><span class="token punctuation">(</span>sigset_t <span class="token operator">*</span>set<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>sigpending()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x4E3A;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x8FD4;&#x56DE;&#x5904;&#x4E8E;&#x7B49;&#x5F85;&#x72B6;&#x6001;&#x7684;&#x4FE1;&#x53F7;&#x96C6;&#xFF0C;&#x5E76;&#x5C06;&#x5176;&#x7F6E;&#x4E8E; set &#x6307;&#x5411;&#x7684;sigset_t&#x7ED3;&#x6784;&#x4E2D;&#x3002;</p>
<h2 id="&#x4E0D;&#x5BF9;&#x4FE1;&#x53F7;&#x8FDB;&#x884C;&#x6392;&#x961F;&#x5904;&#x7406;"><a href="#&#x4E0D;&#x5BF9;&#x4FE1;&#x53F7;&#x8FDB;&#x884C;&#x6392;&#x961F;&#x5904;&#x7406;" class="headerlink" title="&#x4E0D;&#x5BF9;&#x4FE1;&#x53F7;&#x8FDB;&#x884C;&#x6392;&#x961F;&#x5904;&#x7406;"></a>&#x4E0D;&#x5BF9;&#x4FE1;&#x53F7;&#x8FDB;&#x884C;&#x6392;&#x961F;&#x5904;&#x7406;</h2><p>&#x7B49;&#x5F85;&#x4FE1;&#x53F7;&#x96C6;&#x53EA;&#x662F;&#x4E00;&#x4E2A;&#x63A9;&#x7801;&#xFF0C;&#x4EC5;&#x8868;&#x660E;&#x4E00;&#x4E2A;&#x4FE1;&#x53F7;&#x662F;&#x5426;&#x53D1;&#x751F;&#xFF0C;&#x800C;&#x672A;&#x8868;&#x660E;&#x5176;&#x53D1;&#x751F;&#x7684;&#x6B21;&#x6570;&#x3002;&#x6362;&#x8A00;&#x4E4B;&#xFF0C;&#x5982;&#x679C;&#x540C;&#x4E00;&#x4FE1;&#x53F7;&#x5728;&#x963B;&#x585E;&#x72B6;&#x6001;&#x4E0B;&#x4EA7;&#x751F;&#x591A;&#x6B21;&#xFF0C;&#x90A3;&#x4E48;&#x4F1A;&#x5C06;&#x8BE5;&#x4FE1;&#x53F7;&#x8BB0;&#x5F55;&#x5728;&#x7B49;&#x5F85;&#x4FE1;&#x53F7;&#x96C6;&#x4E2D;&#xFF0C;&#x5E76;&#x5728;&#x7A0D;&#x540E;&#x4EC5;&#x4F20;&#x9012;&#x4E00;&#x6B21;&#x3002;&#xFF08;&#x6807;&#x51C6;&#x4FE1;&#x53F7;&#x548C;&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;&#x4E4B;&#x95F4;&#x7684;&#x5DEE;&#x5F02;&#x4E4B;&#x4E00;&#x5728;&#x4E8E;&#xFF0C;&#x5BF9;&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;&#x8FDB;&#x884C;&#x4E86;&#x6392;&#x961F;&#x5904;&#x7406;&#x3002;&#xFF09;</p>
<p>TODO.</p>
<h2 id="&#x6539;&#x53D8;&#x4FE1;&#x53F7;&#x5904;&#x7F6E;&#xFF1A;sigaction"><a href="#&#x6539;&#x53D8;&#x4FE1;&#x53F7;&#x5904;&#x7F6E;&#xFF1A;sigaction" class="headerlink" title="&#x6539;&#x53D8;&#x4FE1;&#x53F7;&#x5904;&#x7F6E;&#xFF1A;sigaction ()"></a>&#x6539;&#x53D8;&#x4FE1;&#x53F7;&#x5904;&#x7F6E;&#xFF1A;sigaction ()</h2><p>&#x9664;&#x53BB; signal()&#x4E4B;&#x5916;&#xFF0C;sigaction()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x662F;&#x8BBE;&#x7F6E;&#x4FE1;&#x53F7;&#x5904;&#x7F6E;&#x7684;&#x53E6;&#x4E00;&#x9009;&#x62E9;&#x3002;&#x867D;&#x7136;sigaction()&#x7684;&#x7528;&#x6CD5;&#x6BD4;&#x4E4B;signal()&#x66F4;&#x4E3A;&#x590D;&#x6742;&#xFF0C;&#x4F46;&#x4F5C;&#x4E3A;&#x56DE;&#x62A5;&#xFF0C;&#x4E5F;&#x66F4;&#x5177;&#x7075;&#x6D3B;&#x6027;&#x3002;&#x5C24;&#x5176;&#x662F;&#xFF0C;sigaction()&#x5141;&#x8BB8;&#x5728;&#x83B7;&#x53D6;&#x4FE1;&#x53F7;&#x5904;&#x7F6E;&#x7684;&#x540C;&#x65F6;&#x65E0;&#x9700;&#x5C06;&#x5176;&#x6539;&#x53D8;&#xFF0C;&#x5E76;&#x4E14;&#xFF0C;&#x8FD8;&#x53EF;&#x8BBE;&#x7F6E;&#x5404;&#x79CD;&#x5C5E;&#x6027;&#x5BF9;&#x8C03;&#x7528;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x7A0B;&#x5E8F;&#x65F6;&#x7684;&#x884C;&#x4E3A;&#x65BD;&#x4EE5;&#x66F4;&#x52A0;&#x7CBE;&#x51C6;&#x7684;&#x63A7;&#x5236;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x5728;&#x5EFA;&#x7ACB;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x7A0B;&#x5E8F;&#x65F6;&#xFF0C;sigaction()&#x8F83;&#x4E4B;signal()&#x51FD;&#x6570;&#x53EF;&#x79FB;&#x690D;&#x6027;&#x66F4;&#x4F73;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;signal.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">sigaction</span><span class="token punctuation">(</span><span class="token keyword">int</span> signum<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">struct</span> sigaction <span class="token operator">*</span>act<span class="token punctuation">,</span> <span class="token keyword">struct</span> sigaction <span class="token operator">*</span>oldact<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x6210;&#x529F;&#x8FD4;&#x56DE;0&#xFF0C;&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>sig&#x53C2;&#x6570;&#x6807;&#x8BC6;&#x60F3;&#x8981;&#x83B7;&#x53D6;&#x6216;&#x6539;&#x53D8;&#x7684;&#x4FE1;&#x53F7;&#x7F16;&#x53F7;&#x3002;&#x8BE5;&#x53C2;&#x6570;&#x53EF;&#x4EE5;&#x662F;&#x9664;&#x53BB;SIGKILL&#x548C;SIGSTOP&#x4E4B;&#x5916;&#x7684;&#x4EFB;&#x4F55;&#x4FE1;&#x53F7;&#x3002;<br>oldact&#xFF1A;&#x539F;&#x6765;&#x5BF9;&#x4FE1;&#x53F7;&#x7684;&#x5904;&#x7406;&#x65B9;&#x5F0F;&#x3002;<br>act&#x53C2;&#x6570;&#x662F;&#x4E00;&#x679A;&#x6307;&#x9488;&#xFF0C;&#x6307;&#x5411;&#x63CF;&#x8FF0;&#x4FE1;&#x53F7;&#x65B0;&#x5904;&#x7F6E;&#x7684;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x3002;&#x5982;&#x679C;&#x4EC5;&#x5BF9;&#x4FE1;&#x53F7;&#x7684;&#x73B0;&#x6709;&#x5904;&#x7F6E;&#x611F;&#x5174;&#x8DA3;&#xFF0C;&#x90A3;&#x4E48;&#x53EF;&#x5C06;&#x8BE5;&#x53C2;&#x6570;&#x6307;&#x5B9A;&#x4E3A;NULL&#x3002;oldact&#x53C2;&#x6570;&#x662F;&#x6307;&#x5411;&#x540C;&#x4E00;&#x7ED3;&#x6784;&#x7C7B;&#x578B;&#x7684;&#x6307;&#x9488;&#xFF0C;&#x7528;&#x6765;&#x8FD4;&#x56DE;&#x4E4B;&#x524D;&#x4FE1;&#x53F7;&#x5904;&#x7F6E;&#x7684;&#x76F8;&#x5173;&#x4FE1;&#x606F;&#x3002;&#x5982;&#x679C;&#x65E0;&#x610F;&#x83B7;&#x53D6;&#x6B64;&#x7C7B;&#x4FE1;&#x606F;&#xFF0C;&#x90A3;&#x4E48;&#x53EF;&#x5C06;&#x8BE5;&#x53C2;&#x6570;&#x6307;&#x5B9A;&#x4E3A;NULL&#x3002;act&#x548C;oldact&#x6240;&#x6307;&#x5411;&#x7684;&#x7ED3;&#x6784;&#x7C7B;&#x578B;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">struct</span> sigaction
<span class="token punctuation">{</span>
<span class="token keyword">void</span>     <span class="token punctuation">(</span><span class="token operator">*</span>sa_handler<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x51FD;&#x6570;</span>
sigset_t  sa_mask<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//&#x9700;&#x8981;&#x88AB;&#x5C4F;&#x853D;&#x7684;&#x4FE1;&#x53F7;</span>
<span class="token keyword">int</span>       sa_flags<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//&#x6210;&#x5458;&#x7528;&#x4E8E;&#x6307;&#x5B9A;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x7684;&#x884C;&#x4E3A;&#xFF0C;&#x5B83;&#x53EF;&#x4EE5;&#x662F;&#x4E00;&#x4E0B;&#x503C;&#x7684;&#x201C;&#x6309;&#x4F4D;&#x6216;&#x201D;&#x7EC4;&#x5408;&#x3002;</span>
<span class="token keyword">void</span>     <span class="token punctuation">(</span><span class="token operator">*</span>sa_restorer<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//&#x5DF2;&#x7ECF;&#x5E9F;&#x5F03;&#x7684;&#x6570;&#x636E;&#x57DF;&#xFF0C;&#x4E0D;&#x8981;&#x4F7F;&#x7528;&#x3002;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>sa_flags&#x53EF;&#x9009;&#x884C;&#x4E3A;&#xFF1A;<br>&#x25C6; SA_RESTART&#xFF1A;&#x4F7F;&#x88AB;&#x4FE1;&#x53F7;&#x6253;&#x65AD;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x81EA;&#x52A8;&#x91CD;&#x65B0;&#x53D1;&#x8D77;&#x3002;<br>&#x25C6; SA_NOCLDSTOP&#xFF1A;&#x4F7F;&#x7236;&#x8FDB;&#x7A0B;&#x5728;&#x5B83;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x6682;&#x505C;&#x6216;&#x7EE7;&#x7EED;&#x8FD0;&#x884C;&#x65F6;&#x4E0D;&#x4F1A;&#x6536;&#x5230; SIGCHLD &#x4FE1;&#x53F7;&#x3002;<br>&#x25C6; SA_NOCLDWAIT&#xFF1A;&#x4F7F;&#x7236;&#x8FDB;&#x7A0B;&#x5728;&#x5B83;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x9000;&#x51FA;&#x65F6;&#x4E0D;&#x4F1A;&#x6536;&#x5230; SIGCHLD &#x4FE1;&#x53F7;&#xFF0C;&#x8FD9;&#x65F6;&#x5B50;&#x8FDB;&#x7A0B;&#x5982;&#x679C;&#x9000;&#x51FA;&#x4E5F;&#x4E0D;&#x4F1A;&#x6210;&#x4E3A;&#x50F5;&#x5C38;&#x8FDB;&#x7A0B;&#x3002;<br>&#x25C6; SA_NODEFER&#xFF1A;&#x4F7F;&#x5BF9;&#x4FE1;&#x53F7;&#x7684;&#x5C4F;&#x853D;&#x65E0;&#x6548;&#xFF0C;&#x5373;&#x5728;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x51FD;&#x6570;&#x6267;&#x884C;&#x671F;&#x95F4;&#x4ECD;&#x80FD;&#x53D1;&#x51FA;&#x8FD9;&#x4E2A;&#x4FE1;&#x53F7;&#x3002;<br>&#x25C6; SA_RESETHAND&#xFF1A;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x4E4B;&#x540E;&#x91CD;&#x65B0;&#x8BBE;&#x7F6E;&#x4E3A;&#x9ED8;&#x8BA4;&#x7684;&#x5904;&#x7406;&#x65B9;&#x5F0F;&#x3002;<br>&#x25C6; SA_SIGINFO&#xFF1A;&#x4F7F;&#x7528; sa_sigaction &#x6210;&#x5458;&#x800C;&#x4E0D;&#x662F; sa_handler &#x4F5C;&#x4E3A;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x51FD;&#x6570;&#x3002;</p>
<p><strong>&#x4F8B;1:</strong></p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;signal.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;errno.h&gt;</span></span>

<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">sig_usr</span><span class="token punctuation">(</span><span class="token keyword">int</span> signum<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>signum <span class="token operator">==</span> SIGUSR1<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;SIGUSR1 received\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>signum <span class="token operator">==</span> SIGUSR2<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;SIGUSR2 received\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;signal %d received\n&quot;</span><span class="token punctuation">,</span> signum<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">512</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span>  n<span class="token punctuation">;</span>
    <span class="token keyword">struct</span> sigaction sa_usr<span class="token punctuation">;</span>
    sa_usr<span class="token punctuation">.</span>sa_flags <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    sa_usr<span class="token punctuation">.</span>sa_handler <span class="token operator">=</span> sig_usr<span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">//&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x51FD;&#x6570;</span>

    <span class="token function">sigaction</span><span class="token punctuation">(</span>SIGUSR1<span class="token punctuation">,</span> <span class="token operator">&amp;</span>sa_usr<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">sigaction</span><span class="token punctuation">(</span>SIGUSR2<span class="token punctuation">,</span> <span class="token operator">&amp;</span>sa_usr<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;My PID is %d\n&quot;</span><span class="token punctuation">,</span> <span class="token function">getpid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>n <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span>STDIN_FILENO<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token number">511</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>errno <span class="token operator">==</span> EINTR<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;read is interrupted by signal\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">{</span>
            buf<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&apos;\0&apos;</span><span class="token punctuation">;</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%d bytes read: %s\n&quot;</span><span class="token punctuation">,</span> n<span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-bash"><code class="language-bash">gcc main.c
./a.out<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x5728;&#x8FD9;&#x4E2A;&#x4F8B;&#x7A0B;&#x4E2D;&#x4F7F;&#x7528; sigaction &#x51FD;&#x6570;&#x4E3A; SIGUSR1 &#x548C; SIGUSR2 &#x4FE1;&#x53F7;&#x6CE8;&#x518C;&#x4E86;&#x5904;&#x7406;&#x51FD;&#x6570;&#xFF0C;&#x7136;&#x540E;&#x4ECE;&#x6807;&#x51C6;&#x8F93;&#x5165;&#x8BFB;&#x5165;&#x5B57;&#x7B26;&#x3002;&#x7A0B;&#x5E8F;&#x8FD0;&#x884C;&#x540E;&#x9996;&#x5148;&#x8F93;&#x51FA;&#x81EA;&#x5DF1;&#x7684; PID&#xFF0C;&#x5982;&#xFF1A;My PID is 5904<br>&#x6B64;&#x65F6;&#x8F93;&#x5165;&#x5185;&#x5BB9;&#x4F1A;&#x6709;&#x5F97;&#x5230;&#x8F93;&#x51FA;&#x3002;<br>&#x8FD9;&#x65F6;&#x542F;&#x7528;&#x53E6;&#x4E00;&#x4E2A;&#x7EC8;&#x7AEF;&#x5411;&#x8FDB;&#x7A0B;&#x53D1;&#x9001; SIGUSR1 &#x6216; SIGUSR2 &#x4FE1;&#x53F7;&#xFF0C;&#x7528;&#x7C7B;&#x4F3C;&#x5982;&#x4E0B;&#x7684;&#x547D;&#x4EE4;&#xFF1A;<strong>kill -USR1 5904</strong><br>&#x5219;&#x7A0B;&#x5E8F;&#x5C06;&#x7EE7;&#x7EED;&#x8F93;&#x51FA;&#x5982;&#x4E0B;&#x5185;&#x5BB9;&#xFF1A;</p>
<pre><code>SIGUSR1 received
read is interrupted by signal</code></pre><p>&#x8FD9;&#x8BF4;&#x660E;&#x7528; sigaction &#x6CE8;&#x518C;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x51FD;&#x6570;&#x65F6;&#xFF0C;&#x4E0D;&#x4F1A;&#x81EA;&#x52A8;&#x91CD;&#x65B0;&#x53D1;&#x8D77;&#x88AB;&#x4FE1;&#x53F7;&#x6253;&#x65AD;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x3002;&#x5982;&#x679C;&#x9700;&#x8981;&#x81EA;&#x52A8;&#x91CD;&#x65B0;&#x53D1;&#x8D77;&#xFF0C;&#x5219;&#x8981;&#x8BBE;&#x7F6E; SA_RESTART &#x6807;&#x5FD7;&#xFF0C;&#x6BD4;&#x5982;&#x5728;&#x4E0A;&#x8FF0;&#x4F8B;&#x7A0B;&#x4E2D;&#x53EF;&#x4EE5;&#x8FDB;&#x884C;&#x7C7B;&#x4F3C;&#x4E00;&#x4E0B;&#x7684;&#x8BBE;&#x7F6E;&#xFF1A;</p>
<pre class="line-numbers language-c"><code class="language-c">sa_usr<span class="token punctuation">.</span>sa_flags <span class="token operator">=</span> SA_RESTART<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="&#x7B49;&#x5F85;&#x4FE1;&#x53F7;&#xFF1A;pause"><a href="#&#x7B49;&#x5F85;&#x4FE1;&#x53F7;&#xFF1A;pause" class="headerlink" title="&#x7B49;&#x5F85;&#x4FE1;&#x53F7;&#xFF1A;pause()"></a>&#x7B49;&#x5F85;&#x4FE1;&#x53F7;&#xFF1A;pause()</h2><p>&#x8C03;&#x7528;pause()&#x5C06;&#x6682;&#x505C;&#x8FDB;&#x7A0B;&#x7684;&#x6267;&#x884C;&#xFF0C;&#x76F4;&#x81F3;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x4E2D;&#x65AD;&#x8BE5;&#x8C03;&#x7528;&#x4E3A;&#x6B62;&#xFF08;&#x6216;&#x8005;&#x76F4;&#x81F3;&#x4E00;&#x4E2A;&#x672A;&#x5904;&#x7406;&#x4FE1;&#x53F7;&#x7EC8;&#x6B62;&#x8FDB;&#x7A0B;&#x4E3A;&#x6B62;&#xFF09;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;unistd.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">pause</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x8C03;&#x7528;pause()&#x5C06;&#x6682;&#x505C;&#x8FDB;&#x7A0B;&#x7684;&#x6267;&#x884C;&#xFF0C;&#x76F4;&#x81F3;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x4E2D;&#x65AD;&#x8BE5;&#x8C03;&#x7528;&#x4E3A;&#x6B62;&#xFF08;&#x6216;&#x8005;&#x76F4;&#x81F3;&#x4E00;&#x4E2A;&#x672A;&#x5904;&#x7406;&#x4FE1;&#x53F7;&#x7EC8;&#x6B62;&#x8FDB;&#x7A0B;&#x4E3A;&#x6B62;&#xFF09;&#x3002;</p>
<p><strong>&#x4F8B;1:</strong></p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;signal.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;124\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">alarm</span><span class="token punctuation">(</span> <span class="token number">5</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;end\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>124
Alarm clock</code></pre><h2 id="&#x8BBE;&#x8BA1;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;"><a href="#&#x8BBE;&#x8BA1;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;" class="headerlink" title="&#x8BBE;&#x8BA1;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;"></a>&#x8BBE;&#x8BA1;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;</h2><p>&#x4E00;&#x822C;&#x800C;&#x8A00;&#xFF0C;&#x5C06;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x8BBE;&#x8BA1;&#x5F97;&#x8D8A;&#x7B80;&#x5355;&#x8D8A;&#x597D;&#x3002;&#x5176;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x91CD;&#x8981;&#x539F;&#x56E0;&#x5C31;&#x5728;&#x4E8E;&#xFF0C;&#x8FD9;&#x5C06;&#x964D;&#x4F4E;&#x5F15;&#x53D1;&#x7ADE;&#x4E89;&#x6761;&#x4EF6;&#x7684;&#x98CE;&#x9669;&#x3002;&#x4E0B;&#x9762;&#x662F;&#x9488;&#x5BF9;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x7684;&#x4E24;&#x79CD;&#x5E38;&#x89C1;&#x8BBE;&#x8BA1;&#x3002;</p>
<ul>
<li>&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x8BBE;&#x7F6E;&#x5168;&#x5C40;&#x6027;&#x6807;&#x5FD7;&#x53D8;&#x91CF;&#x5E76;&#x9000;&#x51FA;&#x3002;&#x4E3B;&#x7A0B;&#x5E8F;&#x5BF9;&#x6B64;&#x6807;&#x5FD7;&#x8FDB;&#x884C;&#x5468;&#x671F;&#x6027;&#x68C0;&#x67E5;&#xFF0C;&#x4E00;&#x65E6;&#x7F6E;&#x4F4D;&#x968F;&#x5373;&#x91C7;&#x53D6;&#x76F8;&#x5E94;&#x52A8;&#x4F5C;&#x3002;&#xFF08;&#x4E3B;&#x7A0B;&#x5E8F;&#x82E5;&#x56E0;&#x76D1;&#x63A7;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x7684;I/O&#x72B6;&#x6001;&#x800C;&#x65E0;&#x6CD5;&#x8FDB;&#x884C;&#x8FD9;&#x79CD;&#x5468;&#x671F;&#x6027;&#x68C0;&#x67E5;&#x65F6;&#xFF0C;&#x5219;&#x53EF;&#x4EE4;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x5411;&#x4E00;&#x4E13;&#x7528;&#x7BA1;&#x9053;&#x5199;&#x5165;&#x4E00;&#x4E2A;&#x5B57;&#x8282;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x540C;&#x65F6;&#x5C06;&#x8BE5;&#x7BA1;&#x9053;&#x7684;&#x8BFB;&#x53D6;&#x7AEF;&#x7F6E;&#x4E8E;&#x4E3B;&#x7A0B;&#x5E8F;&#x6240;&#x76D1;&#x63A7;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x8303;&#x56F4;&#x4E4B;&#x5185;&#x3002;63.5.2&#x8282;&#x5C55;&#x793A;&#x4E86;&#x8FD9;&#x4E00;&#x6280;&#x672F;&#x7684;&#x8FD0;&#x7528;&#x3002;&#xFF09;</li>
<li>&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x6267;&#x884C;&#x67D0;&#x79CD;&#x7C7B;&#x578B;&#x7684;&#x6E05;&#x7406;&#x52A8;&#x4F5C;&#xFF0C;&#x63A5;&#x7740;&#x7EC8;&#x6B62;&#x8FDB;&#x7A0B;&#x6216;&#x8005;&#x4F7F;&#x7528;&#x975E;&#x672C;&#x5730;&#x8DF3;&#x8F6C;&#xFF08;21.2.1&#x8282;&#xFF09;&#x5C06;&#x6808;&#x89E3;&#x5F00;&#x5E76;&#x5C06;&#x63A7;&#x5236;&#x8FD4;&#x56DE;&#x5230;&#x4E3B;&#x7A0B;&#x5E8F;&#x4E2D;&#x7684;&#x9884;&#x5B9A;&#x4F4D;&#x7F6E;&#x3002;</li>
</ul>
<h3 id="&#x518D;&#x8BBA;&#x4FE1;&#x53F7;&#x7684;&#x975E;&#x961F;&#x5217;&#x5316;&#x5904;&#x7406;"><a href="#&#x518D;&#x8BBA;&#x4FE1;&#x53F7;&#x7684;&#x975E;&#x961F;&#x5217;&#x5316;&#x5904;&#x7406;" class="headerlink" title="&#x518D;&#x8BBA;&#x4FE1;&#x53F7;&#x7684;&#x975E;&#x961F;&#x5217;&#x5316;&#x5904;&#x7406;"></a>&#x518D;&#x8BBA;&#x4FE1;&#x53F7;&#x7684;&#x975E;&#x961F;&#x5217;&#x5316;&#x5904;&#x7406;</h3><p>&#x5728;&#x6267;&#x884C;&#x67D0;&#x4FE1;&#x53F7;&#x7684;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x65F6;&#x4F1A;&#x963B;&#x585E;&#x540C;&#x7C7B;&#x4FE1;&#x53F7;&#x7684;&#x4F20;&#x9012;&#xFF08;&#x9664;&#x975E;&#x5728;&#x8C03;&#x7528;sigaction()&#x65F6;&#x6307;&#x5B9A;&#x4E86;SA_NODEFER&#x6807;&#x5FD7;&#xFF09;&#x3002;&#x5982;&#x679C;&#x5728;&#x6267;&#x884C;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x65F6;&#xFF08;&#x518D;&#x6B21;&#xFF09;&#x4EA7;&#x751F;&#x540C;&#x7C7B;&#x4FE1;&#x53F7;&#xFF0C;&#x90A3;&#x4E48;&#x4F1A;&#x5C06;&#x8BE5;&#x4FE1;&#x53F7;&#x6807;&#x8BB0;&#x4E3A;&#x7B49;&#x5F85;&#x72B6;&#x6001;&#x5E76;&#x5728;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x4E4B;&#x540E;&#x518D;&#x884C;&#x4F20;&#x9012;&#x3002;&#x5728;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x6267;&#x884C;&#x671F;&#x95F4;&#xFF0C;&#x5982;&#x679C;&#x591A;&#x6B21;&#x4EA7;&#x751F;&#x540C;&#x7C7B;&#x4FE1;&#x53F7;&#xFF0C;&#x90A3;&#x4E48;&#x4ECD;&#x7136;&#x4F1A;&#x5C06;&#x5176;&#x6807;&#x8BB0;&#x4E3A;&#x7B49;&#x5F85;&#x72B6;&#x6001;&#xFF0C;&#x4F46;&#x7A0D;&#x540E;&#x53EA;&#x4F1A;&#x4F20;&#x9012;&#x4E00;&#x6B21;&#x3002;<br>&#x4FE1;&#x53F7;&#x7684;&#x8FD9;&#x79CD;&#x201C;&#x5931;&#x8E2A;&#x201D;&#x65B9;&#x5F0F;&#x65E0;&#x7591;&#x5C06;&#x5F71;&#x54CD;&#x5BF9;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x7684;&#x8BBE;&#x8BA1;&#x3002;&#x9996;&#x5148;&#xFF0C;&#x65E0;&#x6CD5;&#x5BF9;&#x4FE1;&#x53F7;&#x7684;&#x4EA7;&#x751F;&#x6B21;&#x6570;&#x8FDB;&#x884C;&#x53EF;&#x9760;&#x8BA1;&#x6570;&#x3002;&#x5176;&#x6B21;&#xFF0C;&#x5728;&#x4E3A;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x7F16;&#x7801;&#x65F6;&#x53EF;&#x80FD;&#x9700;&#x8981;&#x8003;&#x8651;&#x5904;&#x7406;&#x540C;&#x7C7B;&#x4FE1;&#x53F7;&#x591A;&#x6B21;&#x4EA7;&#x751F;&#x7684;&#x60C5;&#x51B5;&#x3002;</p>
<h3 id="&#x53EF;&#x91CD;&#x5165;&#x51FD;&#x6570;&#x548C;&#x5F02;&#x6B65;&#x4FE1;&#x53F7;&#x5B89;&#x5168;&#x51FD;&#x6570;"><a href="#&#x53EF;&#x91CD;&#x5165;&#x51FD;&#x6570;&#x548C;&#x5F02;&#x6B65;&#x4FE1;&#x53F7;&#x5B89;&#x5168;&#x51FD;&#x6570;" class="headerlink" title="&#x53EF;&#x91CD;&#x5165;&#x51FD;&#x6570;&#x548C;&#x5F02;&#x6B65;&#x4FE1;&#x53F7;&#x5B89;&#x5168;&#x51FD;&#x6570;"></a>&#x53EF;&#x91CD;&#x5165;&#x51FD;&#x6570;&#x548C;&#x5F02;&#x6B65;&#x4FE1;&#x53F7;&#x5B89;&#x5168;&#x51FD;&#x6570;</h3><p>&#x5728;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x4E2D;&#xFF0C;&#x5E76;&#x975E;&#x6240;&#x6709;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x4EE5;&#x53CA;&#x5E93;&#x51FD;&#x6570;&#x5747;&#x53EF;&#x4E88;&#x4EE5;&#x5B89;&#x5168;&#x8C03;&#x7528;&#x3002;&#x8981;&#x4E86;&#x89E3;&#x6765;&#x9F99;&#x53BB;&#x8109;&#xFF0C;&#x5C31;&#x9700;&#x8981;&#x89E3;&#x91CA;&#x4E00;&#x4E0B;&#x4EE5;&#x4E0B;&#x4E24;&#x79CD;&#x6982;&#x5FF5;&#xFF1A;&#x53EF;&#x91CD;&#x5165;&#xFF08;reentrant&#xFF09;&#x51FD;&#x6570;&#x548C;&#x5F02;&#x6B65;&#x4FE1;&#x53F7;&#x5B89;&#x5168;&#xFF08;async-signal-safe&#xFF09;&#x51FD;&#x6570;&#x3002;</p>
<p><strong>&#x53EF;&#x91CD;&#x5165;&#x548C;&#x975E;&#x53EF;&#x91CD;&#x5165;&#x51FD;&#x6570;</strong><br>&#x8981;&#x89E3;&#x91CA;&#x53EF;&#x91CD;&#x5165;&#x51FD;&#x6570;&#x4E3A;&#x4F55;&#x7269;&#xFF0C;&#x9996;&#x5148;&#x9700;&#x8981;&#x533A;&#x5206;&#x5355;&#x7EBF;&#x7A0B;&#x7A0B;&#x5E8F;&#x548C;&#x591A;&#x7EBF;&#x7A0B;&#x7A0B;&#x5E8F;&#x3002;&#x5178;&#x578B;UNIX&#x7A0B;&#x5E8F;&#x90FD;&#x5177;&#x6709;&#x4E00;&#x6761;&#x6267;&#x884C;&#x7EBF;&#x7A0B;&#xFF0C;&#x8D2F;&#x7A7F;&#x7A0B;&#x5E8F;&#x59CB;&#x7EC8;&#xFF0C;CPU&#x56F4;&#x7ED5;&#x5355;&#x6761;&#x6267;&#x884C;&#x903B;&#x8F91;&#x6765;&#x5904;&#x7406;&#x6307;&#x4EE4;&#x3002;&#x800C;&#x5BF9;&#x4E8E;&#x591A;&#x7EBF;&#x7A0B;&#x7A0B;&#x5E8F;&#x800C;&#x8A00;&#xFF0C;&#x540C;&#x4E00;&#x8FDB;&#x7A0B;&#x5374;&#x5B58;&#x5728;&#x591A;&#x6761;&#x72EC;&#x7ACB;&#x3001;&#x5E76;&#x53D1;&#x7684;&#x6267;&#x884C;&#x903B;&#x8F91;&#x6D41;&#x3002;<br>&#x5982;&#x679C;&#x540C;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7684;&#x591A;&#x6761;&#x7EBF;&#x7A0B;&#x53EF;&#x4EE5;&#x540C;&#x65F6;&#x5B89;&#x5168;&#x5730;&#x8C03;&#x7528;&#x67D0;&#x4E00;&#x51FD;&#x6570;&#xFF0C;&#x90A3;&#x4E48;&#x8BE5;&#x51FD;&#x6570;&#x5C31;&#x662F;&#x53EF;&#x91CD;&#x5165;&#x7684;&#x3002;&#x6B64;&#x5904;&#xFF0C;&#x201C;&#x5B89;&#x5168;&#x201D;&#x610F;&#x5473;&#x7740;&#xFF0C;&#x65E0;&#x8BBA;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x8C03;&#x7528;&#x8BE5;&#x51FD;&#x6570;&#x7684;&#x6267;&#x884C;&#x72B6;&#x6001;&#x5982;&#x4F55;&#xFF0C;&#x51FD;&#x6570;&#x5747;&#x53EF;&#x4EA7;&#x751F;&#x9884;&#x671F;&#x7ED3;&#x679C;&#x3002;</p>
<p><strong>&#x6807;&#x51C6;&#x7684;&#x5F02;&#x6B65;&#x4FE1;&#x53F7;&#x5B89;&#x5168;&#x51FD;&#x6570;</strong><br>&#x5F02;&#x6B65;&#x4FE1;&#x53F7;&#x5B89;&#x5168;&#x7684;&#x51FD;&#x6570;&#x662F;&#x6307;&#x5F53;&#x4ECE;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x65F6;&#xFF0C;&#x53EF;&#x4EE5;&#x4FDD;&#x8BC1;&#x5176;&#x5B9E;&#x73B0;&#x662F;&#x5B89;&#x5168;&#x7684;&#x3002;&#x5982;&#x679C;&#x67D0;&#x4E00;&#x51FD;&#x6570;&#x662F;&#x53EF;&#x91CD;&#x5165;&#x7684;&#xFF0C;&#x53C8;&#x6216;&#x8005;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x65E0;&#x6CD5;&#x5C06;&#x5176;&#x4E2D;&#x65AD;&#x65F6;&#xFF0C;&#x5C31;&#x79F0;&#x8BE5;&#x51FD;&#x6570;&#x662F;&#x5F02;&#x6B65;&#x4FE1;&#x53F7;&#x5B89;&#x5168;&#x7684;&#x3002;</p>
<p><strong>POSIX.1-1990&#x3001;SUSv2&#x548C;SUSv3&#x89C4;&#x5B9A;&#x4E3A;&#x5F02;&#x6B65;&#x4FE1;&#x53F7;&#x5B89;&#x5168;&#x7684;&#x51FD;&#x6570;</strong></p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th align="left">&#x65E0;</th>
<th align="left">&#x65E0;</th>
<th align="left">&#x65E0;</th>
</tr>
</thead>
<tbody><tr>
<td align="left">_Exit() (v3)</td>
<td align="left">getpid()</td>
<td align="left">sigdelset()</td>
</tr>
<tr>
<td align="left">_exit()</td>
<td align="left">getppid()</td>
<td align="left">sigemptyset()</td>
</tr>
<tr>
<td align="left">abort() (v3)</td>
<td align="left">getsockname() (v3)</td>
<td align="left">sigfillset()</td>
</tr>
<tr>
<td align="left">accept() (v3)</td>
<td align="left">getsockopt() (v3)</td>
<td align="left">sigismember()</td>
</tr>
<tr>
<td align="left">access()</td>
<td align="left">getuid()</td>
<td align="left">signal() (v2)</td>
</tr>
<tr>
<td align="left">aio_error() (v2)</td>
<td align="left">kill()</td>
<td align="left">sigpause() (v2)</td>
</tr>
<tr>
<td align="left">aio_return() (v2)</td>
<td align="left">link()</td>
<td align="left">sigpending()</td>
</tr>
<tr>
<td align="left">aio_suspend() (v2)</td>
<td align="left">listen() (v3)</td>
<td align="left">sigprocmask()</td>
</tr>
<tr>
<td align="left">alarm()</td>
<td align="left">lseek()</td>
<td align="left">sigqueue() (v2)</td>
</tr>
<tr>
<td align="left">bind() (v3)</td>
<td align="left">lstat() (v3)</td>
<td align="left">sigset() (v2)</td>
</tr>
<tr>
<td align="left">cfgetispeed()</td>
<td align="left">mkdir()</td>
<td align="left">sigsuspend()</td>
</tr>
<tr>
<td align="left">cfgetospeed()</td>
<td align="left">mkfifo()</td>
<td align="left">sleep()</td>
</tr>
<tr>
<td align="left">cfsetispeed()</td>
<td align="left">open()</td>
<td align="left">socket() (v3)</td>
</tr>
<tr>
<td align="left">cfsetospeed()</td>
<td align="left">pathconf()</td>
<td align="left">sockatmark() (v3)</td>
</tr>
<tr>
<td align="left">chdir()</td>
<td align="left">pause()</td>
<td align="left">socketpair() (v3)</td>
</tr>
<tr>
<td align="left">chmod()</td>
<td align="left">pipe()</td>
<td align="left">stat()</td>
</tr>
<tr>
<td align="left">chown()</td>
<td align="left">poll() (v3)</td>
<td align="left">symlink() (v3)</td>
</tr>
<tr>
<td align="left">clock_gettime() (v2)</td>
<td align="left">posix_trace_event() (v3)</td>
<td align="left">sysconf()</td>
</tr>
<tr>
<td align="left">close()</td>
<td align="left">pselect() (v3)</td>
<td align="left">tcdrain()</td>
</tr>
<tr>
<td align="left">connect() (v3)</td>
<td align="left">raise() (v2)</td>
<td align="left">tcflow()</td>
</tr>
<tr>
<td align="left">creat()</td>
<td align="left">read()</td>
<td align="left">tcflush()</td>
</tr>
<tr>
<td align="left">dup()</td>
<td align="left">readlink() (v3)</td>
<td align="left">tcgetattr()</td>
</tr>
<tr>
<td align="left">dup2()</td>
<td align="left">recv() (v3)</td>
<td align="left">tcgetpgrp()</td>
</tr>
<tr>
<td align="left">execle()</td>
<td align="left">recvfrom() (v3)</td>
<td align="left">tcsendbreak()</td>
</tr>
<tr>
<td align="left">execve()</td>
<td align="left">recvmsg() (v3)</td>
<td align="left">tcsetattr()</td>
</tr>
<tr>
<td align="left">fchmod() (v3)</td>
<td align="left">rename()</td>
<td align="left">tcsetpgrp()</td>
</tr>
<tr>
<td align="left">fchown() (v3)</td>
<td align="left">rmdir()</td>
<td align="left">time()</td>
</tr>
<tr>
<td align="left">fcntl()</td>
<td align="left">select() (v3)</td>
<td align="left">timer_getoverrun() (v2)</td>
</tr>
<tr>
<td align="left">fdatasync() (v2)</td>
<td align="left">sem_post() (v2)</td>
<td align="left">timer_gettime() (v2)</td>
</tr>
<tr>
<td align="left">fork()</td>
<td align="left">send() (v3)</td>
<td align="left">timer_settime() (v2)</td>
</tr>
<tr>
<td align="left">fpathconf() (v2)</td>
<td align="left">sendmsg() (v3)</td>
<td align="left">times()</td>
</tr>
<tr>
<td align="left">fstat()</td>
<td align="left">sendto() (v3)</td>
<td align="left">umask()</td>
</tr>
<tr>
<td align="left">fsync() (v2)</td>
<td align="left">setgid()</td>
<td align="left">uname()</td>
</tr>
<tr>
<td align="left">ftruncate() (v3)</td>
<td align="left">setpgid()</td>
<td align="left">unlink()</td>
</tr>
<tr>
<td align="left">getegid()</td>
<td align="left">setsid()</td>
<td align="left">utime()</td>
</tr>
<tr>
<td align="left">geteuid()</td>
<td align="left">setsockopt() (v3)</td>
<td align="left">wait()</td>
</tr>
<tr>
<td align="left">getgid()</td>
<td align="left">setuid()</td>
<td align="left">waitpid()</td>
</tr>
<tr>
<td align="left">getgroups()</td>
<td align="left">shutdown() (v3)</td>
<td align="left">write()</td>
</tr>
<tr>
<td align="left">getpeername() (v3)</td>
<td align="left">sigaction()</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">getpgrp()</td>
<td align="left">sigaddset()</td>
<td align="left"></td>
</tr>
</tbody></table></div>
<h3 id="&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x548C;sig-atomic-t&#x6570;&#x636E;&#x7C7B;&#x578B;"><a href="#&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x548C;sig-atomic-t&#x6570;&#x636E;&#x7C7B;&#x578B;" class="headerlink" title="&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x548C;sig_atomic_t&#x6570;&#x636E;&#x7C7B;&#x578B;"></a>&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x548C;sig_atomic_t&#x6570;&#x636E;&#x7C7B;&#x578B;</h3><p>&#x5C3D;&#x7BA1;&#x5B58;&#x5728;&#x53EF;&#x91CD;&#x5165;&#x95EE;&#x9898;&#xFF0C;&#x6709;&#x65F6;&#x4ECD;&#x9700;&#x8981;&#x5728;&#x4E3B;&#x7A0B;&#x5E8F;&#x548C;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x4E4B;&#x95F4;&#x5171;&#x4EAB;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x3002;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x53EF;&#x80FD;&#x4F1A;&#x968F;&#x65F6;&#x4FEE;&#x6539;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x2014;&#x2014;&#x53EA;&#x8981;&#x4E3B;&#x7A0B;&#x5E8F;&#x80FD;&#x591F;&#x6B63;&#x786E;&#x5904;&#x7406;&#x8FD9;&#x79CD;&#x53EF;&#x80FD;&#x6027;&#xFF0C;&#x5171;&#x4EAB;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x5C31;&#x662F;&#x5B89;&#x5168;&#x7684;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x4E00;&#x79CD;&#x5E38;&#x89C1;&#x7684;&#x8BBE;&#x8BA1;&#x662F;&#xFF0C;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x53EA;&#x505A;&#x4E00;&#x4EF6;&#x4E8B;&#x60C5;&#xFF0C;&#x8BBE;&#x7F6E;&#x5168;&#x5C40;&#x6807;&#x5FD7;&#x3002;&#x4E3B;&#x7A0B;&#x5E8F;&#x5219;&#x4F1A;&#x5468;&#x671F;&#x6027;&#x5730;&#x68C0;&#x67E5;&#x8FD9;&#x4E00;&#x6807;&#x5FD7;&#xFF0C;&#x5E76;&#x91C7;&#x53D6;&#x76F8;&#x5E94;&#x52A8;&#x4F5C;&#x6765;&#x54CD;&#x5E94;&#x4FE1;&#x53F7;&#x4F20;&#x9012;&#xFF08;&#x540C;&#x65F6;&#x6E05;&#x9664;&#x6807;&#x5FD7;&#xFF09;&#x3002;&#x5F53;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x4EE5;&#x6B64;&#x65B9;&#x5F0F;&#x6765;&#x8BBF;&#x95EE;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x65F6;&#xFF0C;&#x5E94;&#x8BE5;&#x603B;&#x662F;&#x5728;&#x58F0;&#x660E;&#x53D8;&#x91CF;&#x65F6;&#x4F7F;&#x7528;volatile&#x5173;&#x952E;&#x5B57;&#xFF0C;&#x4ECE;&#x800C;&#x9632;&#x6B62;&#x7F16;&#x8BD1;&#x5668;&#x5C06;&#x5176;&#x4F18;&#x5316;&#x5230;&#x5BC4;&#x5B58;&#x5668;&#x4E2D;&#x3002;</p>
<p>&#x5BF9;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x7684;&#x8BFB;&#x5199;&#x53EF;&#x80FD;&#x4E0D;&#x6B62;&#x4E00;&#x6761;&#x673A;&#x5668;&#x6307;&#x4EE4;&#xFF0C;&#x800C;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x5C31;&#x53EF;&#x80FD;&#x4F1A;&#x5728;&#x8FD9;&#x4E9B;&#x6307;&#x4EE4;&#x5E8F;&#x5217;&#x4E4B;&#x95F4;&#x5C06;&#x4E3B;&#x7A0B;&#x5E8F;&#x4E2D;&#x65AD;&#xFF08;&#x4E5F;&#x5C06;&#x6B64;&#x7C7B;&#x53D8;&#x91CF;&#x8BBF;&#x95EE;&#x79F0;&#x4E3A;&#x975E;&#x539F;&#x5B50;&#x64CD;&#x4F5C;&#xFF09;&#x3002;&#x56E0;&#x6B64;&#xFF0C;C&#x8BED;&#x8A00;&#x6807;&#x51C6;&#x4EE5;&#x53CA;SUSv3&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x79CD;&#x6574;&#x578B;&#x6570;&#x636E;&#x7C7B;&#x578B;sig_atomic_t&#xFF0C;&#x610F;&#x5728;&#x4FDD;&#x8BC1;&#x8BFB;&#x5199;&#x64CD;&#x4F5C;&#x7684;&#x539F;&#x5B50;&#x6027;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x6240;&#x6709;&#x5728;&#x4E3B;&#x7A0B;&#x5E8F;&#x4E0E;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x4E4B;&#x95F4;&#x5171;&#x4EAB;&#x7684;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x90FD;&#x5E94;&#x58F0;&#x660E;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">volatile</span> sig_atomic_t flag<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>&#x6CE8;&#x610F;&#xFF0C;C&#x8BED;&#x8A00;&#x7684;&#x9012;&#x589E;&#xFF08;++&#xFF09;&#x548C;&#x9012;&#x51CF;&#xFF08;&#x2013;&#xFF09;&#x64CD;&#x4F5C;&#x7B26;&#x5E76;&#x4E0D;&#x5728;sig_atomic_t&#x6240;&#x63D0;&#x4F9B;&#x7684;&#x4FDD;&#x969C;&#x8303;&#x56F4;&#x4E4B;&#x5185;&#x3002;&#x8FD9;&#x4E9B;&#x64CD;&#x4F5C;&#x5728;&#x67D0;&#x4E9B;&#x786C;&#x4EF6;&#x67B6;&#x6784;&#x4E0A;&#x53EF;&#x80FD;&#x4E0D;&#x662F;&#x539F;&#x5B50;&#x64CD;&#x4F5C;.</p>
<h2 id="&#x7EC8;&#x6B62;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x7684;&#x5176;&#x4ED6;&#x65B9;&#x6CD5;"><a href="#&#x7EC8;&#x6B62;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x7684;&#x5176;&#x4ED6;&#x65B9;&#x6CD5;" class="headerlink" title="&#x7EC8;&#x6B62;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x7684;&#x5176;&#x4ED6;&#x65B9;&#x6CD5;"></a>&#x7EC8;&#x6B62;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x7684;&#x5176;&#x4ED6;&#x65B9;&#x6CD5;</h2><p>&#x76EE;&#x524D;&#x4E3A;&#x6B62;&#x6240;&#x770B;&#x5230;&#x7684;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x90FD;&#x662F;&#x4EE5;&#x8FD4;&#x56DE;&#x4E3B;&#x7A0B;&#x5E8F;&#x800C;&#x7EC8;&#x7ED3;&#x3002;&#x4E0D;&#x8FC7;&#xFF0C;&#x53EA;&#x662F;&#x7B80;&#x5355;&#x5730;&#x4ECE;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x4E2D;&#x8FD4;&#x56DE;&#x5E76;&#x4E0D;&#x80FD;&#x6EE1;&#x8DB3;&#x9700;&#x8981;&#xFF0C;&#x6709;&#x65F6;&#x5019;&#x751A;&#x81F3;&#x6CA1;&#x4EC0;&#x4E48;&#x7528;&#x5904;&#x3002;</p>
<p>&#x4EE5;&#x4E0B;&#x662F;&#x4ECE;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x4E2D;&#x7EC8;&#x6B62;&#x7684;&#x5176;&#x4ED6;&#x4E00;&#x4E9B;&#x65B9;&#x6CD5;&#x3002;</p>
<ul>
<li>&#x4F7F;&#x7528;_exit()&#x7EC8;&#x6B62;&#x8FDB;&#x7A0B;&#x3002;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x4E8B;&#x5148;&#x53EF;&#x4EE5;&#x505A;&#x4E00;&#x4E9B;&#x6E05;&#x7406;&#x5DE5;&#x4F5C;&#x3002;&#x6CE8;&#x610F;&#xFF0C;&#x4E0D;&#x8981;&#x4F7F;&#x7528;exit()&#x6765;&#x7EC8;&#x6B62;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x4E0D;&#x5728;&#x8868;21-1&#x6240;&#x5217;&#x7684;&#x5B89;&#x5168;&#x51FD;&#x6570;&#x4E2D;&#x3002;&#x4E4B;&#x6240;&#x4EE5;&#x4E0D;&#x5B89;&#x5168;&#xFF0C;&#x662F;&#x56E0;&#x4E3A;&#x8BE5;&#x51FD;&#x6570;&#x4F1A;&#x5728;&#x8C03;&#x7528;_exit()&#x4E4B;&#x524D;&#x5237;&#x65B0;stdio&#x7684;&#x7F13;&#x51B2;&#x533A;&#x3002;</li>
<li>&#x4F7F;&#x7528;kill()&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x6765;&#x6740;&#x6389;&#x8FDB;&#x7A0B;&#xFF08;&#x5373;&#xFF0C;&#x4FE1;&#x53F7;&#x7684;&#x9ED8;&#x8BA4;&#x52A8;&#x4F5C;&#x662F;&#x7EC8;&#x6B62;&#x8FDB;&#x7A0B;&#xFF09;&#x3002;</li>
<li>&#x4ECE;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x4E2D;&#x6267;&#x884C;&#x975E;&#x672C;&#x5730;&#x8DF3;&#x8F6C;&#x3002;</li>
<li>&#x4F7F;&#x7528;abort()&#x51FD;&#x6570;&#x7EC8;&#x6B62;&#x8FDB;&#x7A0B;&#xFF0C;&#x5E76;&#x4EA7;&#x751F;&#x6838;&#x5FC3;&#x8F6C;&#x50A8;&#x3002;</li>
</ul>
<h2 id="&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x7684;&#x4E2D;&#x65AD;&#x548C;&#x91CD;&#x542F;"><a href="#&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x7684;&#x4E2D;&#x65AD;&#x548C;&#x91CD;&#x542F;" class="headerlink" title="&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x7684;&#x4E2D;&#x65AD;&#x548C;&#x91CD;&#x542F;"></a>&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x7684;&#x4E2D;&#x65AD;&#x548C;&#x91CD;&#x542F;</h2><p>&#x8003;&#x8651;&#x5982;&#x4E0B;&#x573A;&#x666F;&#x3002;<br>1&#xFF0E; &#x4E3A;&#x67D0;&#x4FE1;&#x53F7;&#x521B;&#x5EFA;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x3002;<br>2&#xFF0E; &#x53D1;&#x8D77;&#x4E00;&#x4E2A;&#x963B;&#x585E;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF08;blocking system call&#xFF09;&#xFF0C;&#x4F8B;&#x5982;&#xFF0C;&#x4ECE;&#x7EC8;&#x7AEF;&#x8BBE;&#x5907;&#x8C03;&#x7528;&#x7684;read()&#x5C31;&#x4F1A;&#x963B;&#x585E;&#x5230;&#x6709;&#x6570;&#x636E;&#x8F93;&#x5165;&#x4E3A;&#x6B62;&#x3002;<br>3&#xFF0E; &#x5F53;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x906D;&#x5230;&#x963B;&#x585E;&#x65F6;&#xFF0C;&#x4E4B;&#x524D;&#x521B;&#x5EFA;&#x4E86;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x7684;&#x4FE1;&#x53F7;&#x4F20;&#x9012;&#x4E86;&#x8FC7;&#x6765;&#xFF0C;&#x968F;&#x5373;&#x5F15;&#x53D1;&#x5BF9;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x7684;&#x8C03;&#x7528;&#x3002;</p>
<p>&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x8FD4;&#x56DE;&#x540E;&#x53C8;&#x4F1A;&#x53D1;&#x751F;&#x4EC0;&#x4E48;&#xFF1F;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5931;&#x8D25;&#xFF0C;&#x5E76;&#x5C06;errno&#x7F6E;&#x4E3A;EINTR&#x3002;&#x8FD9;&#x662F;&#x4E00;&#x79CD;&#x6709;&#x7528;&#x7684;&#x7279;&#x6027;&#x3002;&#x5982;&#x4F7F;&#x7528;&#x5B9A;&#x65F6;&#x5668;&#xFF08;&#x4F1A;&#x4EA7;&#x751F;SIGALRM&#x4FE1;&#x53F7;&#xFF09;&#x6765;&#x8BBE;&#x7F6E;&#x50CF;read()&#x4E4B;&#x7C7B;&#x963B;&#x585E;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x7684;&#x8D85;&#x65F6;&#x3002;<br>&#x4E0D;&#x8FC7;&#xFF0C;&#x66F4;&#x4E3A;&#x5E38;&#x89C1;&#x7684;&#x60C5;&#x51B5;&#x662F;&#x5E0C;&#x671B;&#x906D;&#x5230;&#x4E2D;&#x65AD;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5F97;&#x4EE5;&#x7EE7;&#x7EED;&#x8FD0;&#x884C;&#x3002;&#x4E3A;&#x6B64;&#xFF0C;&#x53EF;&#x5728;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x906D;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x4E2D;&#x65AD;&#x7684;&#x4E8B;&#x4EF6;&#x4E2D;&#xFF0C;&#x5229;&#x7528;&#x5982;&#x4E0B;&#x4EE3;&#x7801;&#x6765;&#x624B;&#x52A8;&#x91CD;&#x542F;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token comment" spellcheck="true">/*&#x901A;&#x8FC7;errno&#x503C;&#x5224;&#x65AD;&#x662F;&#x5426;&#x88AB;&#x4E2D;&#x65AD;&#xFF0C;&#x7136;&#x540E;&#x51B3;&#x5B9A;&#x662F;&#x5426;&#x7EE7;&#x7EED;&#x6267;&#x884C;&#x88AB;&#x6253;&#x65AD;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;*/</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>cnt <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> BUF_SIZE<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> errno <span class="token operator">==</span> EINTR<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">continue</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x5982;&#x679C;&#x8BE5;&#x4EE3;&#x7801;&#x9891;&#x7E41;&#x4F7F;&#x7528;&#xFF1A;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">define</span> NO_EINTR(SMT)  while ((smt) == -1 &amp;&amp; errno == EINTR);  </span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>&#x4F7F;&#x7528;&#x8BE5;&#x5B8F;&#xFF0C;&#x53EF;&#x4EE5;&#x5C06;&#x65E9;&#x5148;&#x5BF9;read()&#x7684;&#x8C03;&#x7528;&#x6539;&#x5199;&#x5982;&#x4E0B; &#xFF1A;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token function">NO_EINTR</span><span class="token punctuation">(</span>cnt<span class="token operator">=</span><span class="token function">read</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span>buf<span class="token punctuation">,</span>BUF_SIZE<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span>cnt<span class="token operator">==</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;read&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>GNU C&#x5E93;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#xFF08;&#x975E;&#x6807;&#x51C6;&#xFF09;&#x5B8F;&#xFF0C;&#x5176;&#x4F5C;&#x7528;&#x4E0E;&#x5B9A;&#x4E49;&#x4E8E;&lt;unistd.h&gt;&#x4E2D;&#x7684;NO_EINTR()&#x76F8;&#x540C;&#x3002;&#x8BE5;&#x5B8F;&#x540D;&#x4E3A;TEMP_FAILURE_RETRY()&#xFF0C;&#x5B9A;&#x4E49;&#x7279;&#x6027;&#x6D4B;&#x8BD5;&#x5B8F;_GNU_SOURCE&#x540E;&#x5373;&#x53EF;&#x4F7F;&#x7528;&#x3002;</p>
<p>&#x5373;&#x4F7F;&#x91C7;&#x7528;&#x4E86;&#x7C7B;&#x4F3C;NO_EINTR()&#x8FD9;&#x6837;&#x7684;&#x5B8F;&#xFF0C;&#x8BA9;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x6765;&#x4E2D;&#x65AD;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x8FD8;&#x662F;&#x9887;&#x4E3A;&#x4E0D;&#x4FBF;&#xFF0C;&#x56E0;&#x4E3A;&#x53EA;&#x8981;&#x6709;&#x610F;&#x91CD;&#x542F;&#x963B;&#x585E;&#x7684;&#x8C03;&#x7528;&#xFF0C;&#x5C31;&#x9700;&#x8981;&#x4E3A;&#x6BCF;&#x4E2A;&#x963B;&#x585E;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x6DFB;&#x52A0;&#x4EE3;&#x7801;&#x3002;&#x53CD;&#x4E4B;&#xFF0C;&#x53EF;&#x4EE5;&#x8C03;&#x7528;&#x6307;&#x5B9A;&#x4E86;SA_RESTART&#x6807;&#x5FD7;&#x7684;sigaction()&#x6765;&#x521B;&#x5EFA;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#xFF0C;&#x4ECE;&#x800C;&#x4EE4;&#x5185;&#x6838;&#x4EE3;&#x8868;&#x8FDB;&#x7A0B;&#x81EA;&#x52A8;&#x91CD;&#x542F;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF0C;&#x8FD8;&#x65E0;&#x9700;&#x5904;&#x7406;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x53EF;&#x80FD;&#x8FD4;&#x56DE;&#x7684;EINTR&#x9519;&#x8BEF;&#x3002;<br>&#x6807;&#x5FD7;SA_RESTART&#x662F;&#x9488;&#x5BF9;&#x6BCF;&#x4E2A;&#x4FE1;&#x53F7;&#x7684;&#x8BBE;&#x7F6E;&#x3002;&#x6362;&#x8A00;&#x4E4B;&#xFF0C;&#x5141;&#x8BB8;&#x67D0;&#x4E9B;&#x4FE1;&#x53F7;&#x7684;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x4E2D;&#x65AD;&#x963B;&#x585E;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF0C;&#x800C;&#x5176;&#x4ED6;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5219;&#x53EF;&#x4EE5;&#x81EA;&#x52A8;&#x91CD;&#x542F;&#x3002;<br>&#x4E0D;&#x5E78;&#x7684;&#x662F;&#xFF0C;&#x5E76;&#x975E;&#x6240;&#x6709;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x90FD;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x6307;&#x5B9A;SA_RESTART&#x6765;&#x8FBE;&#x5230;&#x81EA;&#x52A8;&#x91CD;&#x542F;&#x7684;&#x76EE;&#x7684;&#x3002;&#x7A76;&#x5176;&#x539F;&#x56E0;&#xFF0C;&#x6709;&#x90E8;&#x5206;&#x5386;&#x53F2;&#x56E0;&#x7D20;&#x3002;</p>
<ul>
<li>4.2BSD&#x5F15;&#x5165;&#x4E86;&#x91CD;&#x542F;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x7684;&#x6982;&#x5FF5;&#xFF0C;&#x5305;&#x62EC;&#x4E2D;&#x65AD;&#x5BF9;wait()&#x548C;waitpid()&#x7684;&#x8C03;&#x7528;&#xFF0C;&#x4EE5;&#x53CA;&#x5982;&#x4E0B;I/O&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF1A;read()&#x3001;readv()&#x3001;write()&#x548C;&#x963B;&#x585E;&#x7684;ioctl()&#x64CD;&#x4F5C;&#x3002;I/O&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x90FD;&#x662F;&#x53EF;&#x4E2D;&#x65AD;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x53EA;&#x6709;&#x5728;&#x64CD;&#x4F5C;&#x201C;&#x6162;&#x901F;&#xFF08;slow&#xFF09;&#x201D;&#x8BBE;&#x5907;&#x65F6;&#xFF0C;&#x624D;&#x53EF;&#x4EE5;&#x5229;&#x7528;SA_RESTART&#x6807;&#x5FD7;&#x6765;&#x81EA;&#x52A8;&#x91CD;&#x542F;&#x8C03;&#x7528;&#x3002;&#x6162;&#x901F;&#x8BBE;&#x5907;&#x5305;&#x62EC;&#x7EC8;&#x7AEF;&#xFF08;terminal&#xFF09;&#x3001;&#x7BA1;&#x9053;&#xFF08;pipe&#xFF09;&#x3001;FIFO&#x4EE5;&#x53CA;&#x5957;&#x63A5;&#x5B57;&#xFF08;socket&#xFF09;&#x3002;&#x5BF9;&#x4E8E;&#x8FD9;&#x4E9B;&#x6587;&#x4EF6;&#x7C7B;&#x578B;&#xFF0C;&#x5404;&#x79CD;I/O&#x64CD;&#x4F5C;&#x90FD;&#x6709;&#x53EF;&#x80FD;&#x5835;&#x585E;&#x3002;&#xFF08;&#x76F8;&#x6BD4;&#x4E4B;&#x4E0B;&#xFF0C;&#x78C1;&#x76D8;&#x6587;&#x4EF6;&#x5E76;&#x672A;&#x6CA6;&#x5165;&#x6162;&#x901F;&#x8BBE;&#x5907;&#x4E4B;&#x5217;&#xFF0C;&#x56E0;&#x4E3A;&#x501F;&#x52A9;&#x4E8E;&#x7F13;&#x51B2;&#x533A;&#x9AD8;&#x901F;&#x7F13;&#x5B58;&#xFF0C;&#x78C1;&#x76D8;I/O&#x8BF7;&#x6C42;&#x4E00;&#x822C;&#x90FD;&#x53EF;&#x4EE5;&#x7ACB;&#x5373;&#x5F97;&#x5230;&#x6EE1;&#x8DB3;&#x3002;&#x5F53;&#x51FA;&#x73B0;&#x78C1;&#x76D8;I/O&#x8BF7;&#x6C42;&#x65F6;&#xFF0C;&#x5185;&#x6838;&#x4F1A;&#x4EE4;&#x8BE5;&#x8FDB;&#x7A0B;&#x4F11;&#x7720;&#xFF0C;&#x76F4;&#x81F3;&#x5B8C;&#x6210;I/O&#x52A8;&#x4F5C;&#x4E3A;&#x6B62;&#x3002;&#xFF09;</li>
<li>&#x5176;&#x4ED6;&#x5927;&#x91CF;&#x963B;&#x585E;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5219;&#x7EE7;&#x627F;&#x81EA;System V&#xFF0C;&#x5728;&#x5176;&#x521D;&#x59CB;&#x8BBE;&#x8BA1;&#x4E2D;&#x5E76;&#x672A;&#x63D0;&#x4F9B;&#x91CD;&#x542F;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x7684;&#x529F;&#x80FD;&#x3002;</li>
<li>&#x7528;&#x6765;&#x7B49;&#x5F85;&#x5B50;&#x8FDB;&#x7A0B;&#xFF08;26.1&#x8282;&#xFF09;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF1A;wait()&#x3001;waitpid()&#x3001;wait3()&#x3001;wait4()&#x548C;waitid()&#x3002;</li>
<li>&#x8BBF;&#x95EE;&#x6162;&#x901F;&#x8BBE;&#x5907;&#x65F6;&#x7684;I/O&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF1A;read()&#x3001;readv()&#x3001;write()&#x3001;writev()&#x548C;ioctl()&#x3002;&#x5982;&#x679C;&#x5728;&#x6536;&#x5230;&#x4FE1;&#x53F7;&#x65F6;&#x5DF2;&#x7ECF;&#x4F20;&#x9012;&#x4E86;&#x90E8;&#x5206;&#x6570;&#x636E;&#xFF0C;&#x90A3;&#x4E48;&#x8FD8;&#x662F;&#x4F1A;&#x4E2D;&#x65AD;&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF0C;&#x4F46;&#x4F1A;&#x8FD4;&#x56DE;&#x6210;&#x529F;&#x72B6;&#x6001;&#xFF1A;&#x4E00;&#x4E2A;&#x6574;&#x578B;&#x503C;&#xFF0C;&#x8868;&#x793A;&#x5DF2;&#x6210;&#x529F;&#x4F20;&#x9012;&#x6570;&#x636E;&#x7684;&#x5B57;&#x8282;&#x6570;&#x3002;</li>
<li>&#x7CFB;&#x7EDF;&#x8C03;&#x7528;open()&#xFF0C;&#x5728;&#x53EF;&#x80FD;&#x963B;&#x585E;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF08;&#x4F8B;&#x5982;&#xFF0C;&#x5982;44.7&#x8282;&#x6240;&#x8FF0;&#xFF0C;&#x5728;&#x6253;&#x5F00;FIFO&#x65F6;&#xFF09;&#x3002;</li>
<li>&#x7528;&#x4E8E;&#x5957;&#x63A5;&#x5B57;&#x7684;&#x5404;&#x79CD;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF1A;accept()&#x3001;accept4()&#x3001;connect()&#x3001;send()&#x3001;sendmsg()&#x3001;sendto()&#x3001;recv()&#x3001;recvfrom()&#x548C;recvmsg()&#x3002;&#xFF08;&#x5728;Linux&#x4E2D;&#xFF0C;&#x5982;&#x679C;&#x4F7F;&#x7528;setsockopt()&#x6765;&#x8BBE;&#x7F6E;&#x8D85;&#x65F6;&#xFF0C;&#x8FD9;&#x4E9B;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5C31;&#x4E0D;&#x4F1A;&#x81EA;&#x52A8;&#x91CD;&#x542F;&#x3002;&#x66F4;&#x591A;&#x7EC6;&#x8282;&#x8BF7;&#x53C2;&#x8003;signal(7)&#x624B;&#x518C;&#x9875;&#x3002;&#xFF09;</li>
<li>&#x5BF9;POSIX&#x6D88;&#x606F;&#x961F;&#x5217;&#x8FDB;&#x884C;I/O&#x64CD;&#x4F5C;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF1A;mq_receive()&#x3001;mq_timedreceive()&#x3001;mq_send()&#x548C;mq_timedsend()&#x3002;</li>
<li>&#x7528;&#x4E8E;&#x8BBE;&#x7F6E;&#x6587;&#x4EF6;&#x9501;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x548C;&#x5E93;&#x51FD;&#x6570;&#xFF1A;flock()&#x3001;fcntl()&#x548C;lockf()&#x3002;</li>
<li>Linux&#x7279;&#x6709;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;futex()&#x7684;FUTEX_WAIT&#x64CD;&#x4F5C;&#x3002;</li>
<li>&#x7528;&#x4E8E;&#x9012;&#x51CF;POSIX&#x4FE1;&#x53F7;&#x91CF;&#x7684;sem_wait()&#x548C;sem_timedwait()&#x51FD;&#x6570;&#x3002;&#xFF08;&#x5728;&#x4E00;&#x4E9B;UNIX&#x5B9E;&#x73B0;&#x4E0A;&#xFF0C;&#x5982;&#x679C;&#x8BBE;&#x7F6E;&#x4E86;SA_RESTART&#x6807;&#x5FD7;&#xFF0C;sem_wait()&#x5C31;&#x4F1A;&#x91CD;&#x542F;&#x3002;&#xFF09;</li>
<li>&#x7528;&#x4E8E;&#x540C;&#x6B65;POSIX&#x7EBF;&#x7A0B;&#x7684;&#x51FD;&#x6570;&#xFF1A;pthread_mutex_lock()&#x3001;pthread_mutex_trylock()&#x3001;pthread_mutex_timedlock()&#x3001;pthread_cond_wait()&#x548C;pthread_cond_timedwait()&#x3002;</li>
</ul>
<p>&#x5185;&#x6838;2.6.22&#x4E4B;&#x524D;&#xFF0C;&#x4E0D;&#x7BA1;&#x662F;&#x5426;&#x8BBE;&#x7F6E;&#x4E86;SA_RESTART&#x6807;&#x5FD7;&#xFF0C;futex()&#x3001;sem_wait()&#x548C;sem_timedwait()&#x906D;&#x5230;&#x4E2D;&#x65AD;&#x65F6;&#x603B;&#x662F;&#x4EA7;&#x751F;EINTR&#x9519;&#x8BEF;&#x3002;<br>&#x4EE5;&#x4E0B;&#x963B;&#x585E;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF08;&#x4EE5;&#x53CA;&#x6784;&#x5EFA;&#x4E8E;&#x5176;&#x4E0A;&#x7684;&#x5E93;&#x51FD;&#x6570;&#xFF09;&#x5219;&#x7EDD;&#x4E0D;&#x4F1A;&#x81EA;&#x52A8;&#x91CD;&#x542F;&#xFF08;&#x5373;&#x4FBF;&#x6307;&#x5B9A;&#x4E86;SA_RESTART&#xFF09;&#x3002;</p>
<ul>
<li>poll()&#x3001;ppoll()&#x3001;select()&#x548C;pselect()&#x8FD9;&#x4E9B;I/O&#x591A;&#x8DEF;&#x590D;&#x7528;&#x8C03;&#x7528;&#x3002;&#xFF08;SUSv3&#x660E;&#x6587;&#x89C4;&#x5B9A;&#xFF0C;&#x65E0;&#x8BBA;&#x8BBE;&#x7F6E;SA_RESTART&#x6807;&#x5FD7;&#x4E0E;&#x5426;&#xFF0C;&#x90FD;&#x4E0D;&#x5BF9;select()&#x548C;pselect()&#x906D;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x4E2D;&#x65AD;&#x65F6;&#x7684;&#x884C;&#x4E3A;&#x8FDB;&#x884C;&#x5B9A;&#x4E49;&#x3002;&#xFF09;</li>
<li>Linux&#x7279;&#x6709;&#x7684;epoll_wait()&#x548C;epoll_pwait()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x3002;</li>
<li>Linux&#x7279;&#x6709;&#x7684;io_getevents()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x3002;</li>
<li>&#x64CD;&#x4F5C;System V&#x6D88;&#x606F;&#x961F;&#x5217;&#x548C;&#x4FE1;&#x53F7;&#x91CF;&#x7684;&#x963B;&#x585E;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF1A;semop()&#x3001;semtimedop()&#x3001;msgrcv()&#x548C;msgsnd()&#x3002;&#xFF08;&#x867D;&#x7136;System V&#x539F;&#x672C;&#x5E76;&#x672A;&#x63D0;&#x4F9B;&#x81EA;&#x52A8;&#x91CD;&#x542F;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x4F46;&#x5728;&#x67D0;&#x4E9B;UNIX&#x5B9E;&#x73B0;&#x4E0A;&#xFF0C;&#x5982;&#x679C;&#x8BBE;&#x7F6E;&#x4E86;SA_RESTART&#x6807;&#x5FD7;&#xFF0C;&#x8FD9;&#x4E9B;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x8FD8;&#x662F;&#x4F1A;&#x81EA;&#x52A8;&#x91CD;&#x542F;&#x3002;&#xFF09;</li>
<li>&#x5BF9;inotify&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x53D1;&#x8D77;&#x7684;read()&#x8C03;&#x7528;&#x3002;</li>
<li>&#x7528;&#x4E8E;&#x5C06;&#x8FDB;&#x7A0B;&#x6302;&#x8D77;&#x6307;&#x5B9A;&#x65F6;&#x95F4;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x548C;&#x5E93;&#x51FD;&#x6570;&#xFF1A;sleep()&#x3001;nanosleep()&#x548C;clock_nanosleep()&#x3002;</li>
<li>&#x7279;&#x610F;&#x8BBE;&#x8BA1;&#x7528;&#x6765;&#x7B49;&#x5F85;&#x67D0;&#x4E00;&#x4FE1;&#x53F7;&#x5230;&#x8FBE;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF1A;pause()&#x3001;sigsuspend()&#x3001;sigtimedwait()&#x548C;sigwaitinfo()&#x3002;</li>
</ul>
<h3 id="&#x4E3A;&#x4FE1;&#x53F7;&#x4FEE;&#x6539;SA-RESTART&#x6807;&#x5FD7;"><a href="#&#x4E3A;&#x4FE1;&#x53F7;&#x4FEE;&#x6539;SA-RESTART&#x6807;&#x5FD7;" class="headerlink" title="&#x4E3A;&#x4FE1;&#x53F7;&#x4FEE;&#x6539;SA_RESTART&#x6807;&#x5FD7;"></a>&#x4E3A;&#x4FE1;&#x53F7;&#x4FEE;&#x6539;SA_RESTART&#x6807;&#x5FD7;</h3><p>&#x51FD;&#x6570;siginterrupt()&#x7528;&#x4E8E;&#x6539;&#x53D8;&#x4FE1;&#x53F7;&#x7684;SA_RESTART&#x8BBE;&#x7F6E;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;signal.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">siginterrupt</span><span class="token punctuation">(</span><span class="token keyword">int</span> sig<span class="token punctuation">,</span> <span class="token keyword">int</span> flag<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x82E5;&#x53C2;&#x6570;flag&#x4E3A;&#x771F;&#xFF08;1&#xFF09;&#xFF0C;&#x5219;&#x9488;&#x5BF9;&#x4FE1;&#x53F7;sig&#x7684;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x5C06;&#x4F1A;&#x4E2D;&#x65AD;&#x963B;&#x585E;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x7684;&#x6267;&#x884C;&#x3002;&#x5982;&#x679C;flag&#x4E3A;&#x5047;&#xFF08;0&#xFF09;&#xFF0C;&#x90A3;&#x4E48;&#x5728;&#x6267;&#x884C;&#x4E86;sig&#x7684;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x4E4B;&#x540E;&#xFF0C;&#x4F1A;&#x81EA;&#x52A8;&#x91CD;&#x542F;&#x963B;&#x585E;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x3002;<br>SUSv4&#x6807;&#x8BB0;sigterrupt()&#x4E3A;&#x5DF2;&#x5E9F;&#x6B62;&#xFF0C;&#x5E76;&#x63A8;&#x8350;&#x4F7F;&#x7528;sigaction()&#x52A0;&#x4EE5;&#x66FF;&#x4EE3;&#x3002;</p>
<h2 id="&#x6838;&#x5FC3;&#x8F6C;&#x50A8;&#x6587;&#x4EF6;"><a href="#&#x6838;&#x5FC3;&#x8F6C;&#x50A8;&#x6587;&#x4EF6;" class="headerlink" title="&#x6838;&#x5FC3;&#x8F6C;&#x50A8;&#x6587;&#x4EF6;"></a>&#x6838;&#x5FC3;&#x8F6C;&#x50A8;&#x6587;&#x4EF6;</h2><p>&#x7279;&#x5B9A;&#x4FE1;&#x53F7;&#x4F1A;&#x5F15;&#x53D1;&#x8FDB;&#x7A0B;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x6838;&#x5FC3;&#x8F6C;&#x50A8;&#x6587;&#x4EF6;&#x5E76;&#x7EC8;&#x6B62;&#x8FD0;&#x884C;&#x3002;&#x6240;&#x8C13;&#x6838;&#x5FC3;&#x8F6C;&#x50A8;&#x662F;&#x5185;&#x542B;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#x65F6;&#x5185;&#x5B58;&#x6620;&#x50CF;&#x7684;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x3002;&#xFF08;&#x672F;&#x8BED;core&#x6E90;&#x4E8E;&#x4E00;&#x79CD;&#x8001;&#x8FC8;&#x7684;&#x5185;&#x5B58;&#x6280;&#x672F;&#x3002;&#xFF09;&#x5C06;&#x8BE5;&#x5185;&#x5B58;&#x6620;&#x50CF;&#x52A0;&#x8F7D;&#x5230;&#x8C03;&#x8BD5;&#x5668;&#x4E2D;&#xFF0C;&#x5373;&#x53EF;&#x67E5;&#x660E;&#x4FE1;&#x53F7;&#x5230;&#x8FBE;&#x65F6;&#x7A0B;&#x5E8F;&#x4EE3;&#x7801;&#x548C;&#x6570;&#x636E;&#x7684;&#x72B6;&#x6001;&#x3002;</p>
<p>TODO.</p>
<h2 id="&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;"><a href="#&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;" class="headerlink" title="&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;"></a>&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;</h2><p>&#x5B9A;&#x4E49;&#x4E8E;POSIX.1b&#x4E2D;&#x7684;&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;&#xFF0C;&#x610F;&#x5728;&#x5F25;&#x8865;&#x5BF9;&#x6807;&#x51C6;&#x4FE1;&#x53F7;&#x7684;&#x8BF8;&#x591A;&#x9650;&#x5236;&#x3002;&#x8F83;&#x4E4B;&#x4E8E;&#x6807;&#x51C6;&#x4FE1;&#x53F7;&#xFF0C;&#x5176;&#x4F18;&#x52BF;&#x5982;&#x4E0B;&#x6240;&#x793A;&#x3002;</p>
<ul>
<li>&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;&#x7684;&#x4FE1;&#x53F7;&#x8303;&#x56F4;&#x6709;&#x6240;&#x6269;&#x5927;&#xFF0C;&#x53EF;&#x5E94;&#x7528;&#x4E8E;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x81EA;&#x5B9A;&#x4E49;&#x7684;&#x76EE;&#x7684;&#x3002;&#x800C;&#x6807;&#x51C6;&#x4FE1;&#x53F7;&#x4E2D;&#x53EF;&#x4F9B;&#x5E94;&#x7528;&#x968F;&#x610F;&#x4F7F;&#x7528;&#x7684;&#x4FE1;&#x53F7;&#x4EC5;&#x6709;&#x4E24;&#x4E2A;&#xFF1A;SIGUSR1&#x548C;SIGUSR2&#x3002;</li>
<li>&#x5BF9;&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;&#x6240;&#x91C7;&#x53D6;&#x7684;&#x662F;&#x961F;&#x5217;&#x5316;&#x7BA1;&#x7406;&#x3002;&#x5982;&#x679C;&#x5C06;&#x67D0;&#x4E00;&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;&#x7684;&#x591A;&#x4E2A;&#x5B9E;&#x4F8B;&#x53D1;&#x9001;&#x7ED9;&#x4E00;&#x8FDB;&#x7A0B;&#xFF0C;&#x90A3;&#x4E48;&#x5C06;&#x4F1A;&#x591A;&#x6B21;&#x4F20;&#x9012;&#x4FE1;&#x53F7;&#x3002;&#x76F8;&#x53CD;&#xFF0C;&#x5982;&#x679C;&#x67D0;&#x4E00;&#x6807;&#x51C6;&#x4FE1;&#x53F7;&#x5DF2;&#x7ECF;&#x5728;&#x7B49;&#x5F85;&#x67D0;&#x4E00;&#x8FDB;&#x7A0B;&#xFF0C;&#x800C;&#x6B64;&#x65F6;&#x5373;&#x4F7F;&#x518D;&#x6B21;&#x5411;&#x8BE5;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;&#x6B64;&#x4FE1;&#x53F7;&#x7684;&#x5B9E;&#x4F8B;&#xFF0C;&#x4FE1;&#x53F7;&#x4E5F;&#x53EA;&#x4F1A;&#x4F20;&#x9012;&#x4E00;&#x6B21;&#x3002;</li>
<li>&#x5F53;&#x53D1;&#x9001;&#x4E00;&#x4E2A;&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;&#x65F6;&#xFF0C;&#x53EF;&#x4E3A;&#x4FE1;&#x53F7;&#x6307;&#x5B9A;&#x4F34;&#x968F;&#x6570;&#x636E;&#xFF08;&#x4E00;&#x6574;&#x578B;&#x6570;&#x6216;&#x8005;&#x6307;&#x9488;&#x503C;&#xFF09;&#xFF0C;&#x4F9B;&#x63A5;&#x6536;&#x8FDB;&#x7A0B;&#x7684;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x83B7;&#x53D6;&#x3002;</li>
<li>&#x4E0D;&#x540C;&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;&#x7684;&#x4F20;&#x9012;&#x987A;&#x5E8F;&#x5F97;&#x5230;&#x4FDD;&#x969C;&#x3002;&#x5982;&#x679C;&#x6709;&#x591A;&#x4E2A;&#x4E0D;&#x540C;&#x7684;&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;&#x5904;&#x4E8E;&#x7B49;&#x5F85;&#x72B6;&#x6001;&#xFF0C;&#x90A3;&#x4E48;&#x5C06;&#x7387;&#x5148;&#x4F20;&#x9012;&#x5177;&#x6709;&#x6700;&#x5C0F;&#x7F16;&#x53F7;&#x7684;&#x4FE1;&#x53F7;&#x3002;&#x6362;&#x8A00;&#x4E4B;&#xFF0C;&#x4FE1;&#x53F7;&#x7684;&#x7F16;&#x53F7;&#x8D8A;&#x5C0F;&#xFF0C;&#x5176;&#x4F18;&#x5148;&#x7EA7;&#x8D8A;&#x9AD8;&#x3002;&#x5982;&#x679C;&#x662F;&#x540C;&#x4E00;&#x7C7B;&#x578B;&#x7684;&#x591A;&#x4E2A;&#x4FE1;&#x53F7;&#x5728;&#x6392;&#x961F;&#xFF0C;&#x90A3;&#x4E48;&#x4FE1;&#x53F7;&#xFF08;&#x4EE5;&#x53CA;&#x4F34;&#x968F;&#x6570;&#x636E;&#xFF09;&#x7684;&#x4F20;&#x9012;&#x987A;&#x5E8F;&#x4E0E;&#x4FE1;&#x53F7;&#x53D1;&#x9001;&#x6765;&#x65F6;&#x7684;&#x987A;&#x5E8F;&#x4FDD;&#x6301;&#x4E00;&#x81F4;&#x3002;</li>
</ul>
<p>SUSv3&#x8981;&#x6C42;&#xFF0C;&#x5B9E;&#x73B0;&#x6240;&#x63D0;&#x4F9B;&#x7684;&#x5404;&#x79CD;&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;&#x4E0D;&#x5F97;&#x5C11;&#x4E8E;_POSIX_RTSIG_MAX&#xFF08;&#x5B9A;&#x4E49;&#x4E3A;8&#xFF09;&#x4E2A;&#x3002;Linux&#x5185;&#x6838;&#x5219;&#x5B9A;&#x4E49;&#x4E86;32&#x4E2A;&#x4E0D;&#x540C;&#x7684;&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;&#xFF0C;&#x7F16;&#x53F7;&#x8303;&#x56F4;&#x4E3A; 32&#xFF5E;63&#x3002;&lt;signal.h&gt;&#x5934;&#x6587;&#x4EF6;&#x6240;&#x5B9A;&#x4E49;&#x7684;RTSIG_MAX&#x5E38;&#x91CF;&#x5219;&#x8868;&#x5F81;&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;&#x7684;&#x53EF;&#x7528;&#x6570;&#x91CF;&#xFF0C;&#x800C;&#x6B64;&#x5916;&#x6240;&#x5B9A;&#x4E49;&#x7684;&#x5E38;&#x91CF;SIGRTMIN&#x548C;SIGRTMAX&#x5219;&#x5206;&#x522B;&#x8868;&#x793A;&#x53EF;&#x7528;&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;&#x7F16;&#x53F7;&#x7684;&#x6700;&#x5C0F;&#x503C;&#x548C;&#x6700;&#x5927;&#x503C;&#x3002;</p>
<h3 id="&#x5BF9;&#x6392;&#x961F;&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;&#x7684;&#x6570;&#x91CF;&#x9650;&#x5236;"><a href="#&#x5BF9;&#x6392;&#x961F;&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;&#x7684;&#x6570;&#x91CF;&#x9650;&#x5236;" class="headerlink" title="&#x5BF9;&#x6392;&#x961F;&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;&#x7684;&#x6570;&#x91CF;&#x9650;&#x5236;"></a>&#x5BF9;&#x6392;&#x961F;&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;&#x7684;&#x6570;&#x91CF;&#x9650;&#x5236;</h3><p>SUSv3&#x5141;&#x8BB8;&#x5B9E;&#x73B0;&#x4E3A;&#x6BCF;&#x4E2A;&#x8FDB;&#x7A0B;&#x4E2D;&#x53EF;&#x6392;&#x961F;&#x7684;&#xFF08;&#x5404;&#x7C7B;&#xFF09;&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;&#x6570;&#x91CF;&#x8BBE;&#x7F6E;&#x4E0A;&#x9650;&#xFF0C;&#x5E76;&#x8981;&#x6C42;&#x5176;&#x4E0D;&#x5F97;&#x5C11;&#x4E8E;_POSIX_SIGQUEUE_MAX&#xFF08;&#x5B9A;&#x4E49;&#x4E3A;32&#xFF09;&#x3002;&#x5B9E;&#x73B0;&#x53EF;&#x501F;&#x52A9;&#x4E8E;&#x5BF9;SIGQUEUE_MAX&#x5E38;&#x91CF;&#x7684;&#x5B9A;&#x4E49;&#x6765;&#x8868;&#x793A;&#x5176;&#x6240;&#x5141;&#x8BB8;&#x7684;&#x6392;&#x961F;&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;&#x6570;&#x91CF;&#x3002;</p>
<h3 id="&#x53D1;&#x9001;&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;"><a href="#&#x53D1;&#x9001;&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;" class="headerlink" title="&#x53D1;&#x9001;&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;"></a>&#x53D1;&#x9001;&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;</h3><p>&#x7CFB;&#x7EDF;&#x8C03;&#x7528;sigqueue()&#x5C06;&#x7531;sig&#x6307;&#x5B9A;&#x7684;&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;&#x53D1;&#x9001;&#x7ED9;&#x7531;pid&#x6307;&#x5B9A;&#x7684;&#x8FDB;&#x7A0B;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">define</span> _POSIX_C_SOURCE 199309</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;signal.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">sigqueue</span><span class="token punctuation">(</span>pid_t pid<span class="token punctuation">,</span><span class="token keyword">int</span> sig<span class="token punctuation">,</span><span class="token keyword">const</span> <span class="token keyword">union</span> sigval value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x6210;&#x529F;&#x8FD4;&#x56DE;0&#xFF0C;&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x4F7F;&#x7528;sigqueue()&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x6240;&#x9700;&#x8981;&#x7684;&#x6743;&#x9650;&#x4E0E;kill()&#x7684;&#x8981;&#x6C42;&#x4E00;&#x81F4;&#x3002;&#x4E5F;&#x53EF;&#x4EE5;&#x53D1;&#x9001;&#x7A7A;&#x4FE1;&#x53F7;&#xFF08;&#x5373;&#x4FE1;&#x53F7;0&#xFF09;&#xFF0C;&#x5176;&#x8BED;&#x4E49;&#x4E0E;kill()&#x4E2D;&#x7684;&#x542B;&#x4E49;&#x76F8;&#x540C;&#x3002;&#xFF08;&#x4E0D;&#x540C;&#x4E8E;kill()&#xFF0C;sigqueue()&#x4E0D;&#x80FD;&#x901A;&#x8FC7;&#x5C06;pid&#x6307;&#x5B9A;&#x4E3A;&#x8D1F;&#x503C;&#x800C;&#x5411;&#x6574;&#x4E2A;&#x8FDB;&#x7A0B;&#x7EC4;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x3002;&#xFF09;<br>&#x4E00;&#x65E6;&#x89E6;&#x53CA;&#x5BF9;&#x6392;&#x961F;&#x4FE1;&#x53F7;&#x7684;&#x6570;&#x91CF;&#x9650;&#x5236;&#xFF0C;sigqueue()&#x8C03;&#x7528;&#x5C06;&#x4F1A;&#x5931;&#x8D25;&#x3002;&#x540C;&#x65F6;&#x5C06;errno&#x7F6E;&#x4E3A;EAGAIN&#xFF0C;&#x4EE5;&#x793A;&#x9700;&#x8981;&#x518D;&#x6B21;&#x53D1;&#x9001;&#x8BE5;&#x4FE1;&#x53F7;&#xFF08;&#x5728;&#x5F53;&#x524D;&#x961F;&#x5217;&#x4E2D;&#x67D0;&#x4E9B;&#x4FE1;&#x53F7;&#x4F20;&#x9012;&#x4E4B;&#x540E;&#x7684;&#x67D0;&#x4E00;&#x65F6;&#x95F4;&#x70B9;&#xFF09;&#x3002;</p>
<h3 id="&#x5904;&#x7406;&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;"><a href="#&#x5904;&#x7406;&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;" class="headerlink" title="&#x5904;&#x7406;&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;"></a>&#x5904;&#x7406;&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;</h3><p>&#x53EF;&#x4EE5;&#x50CF;&#x6807;&#x51C6;&#x4FE1;&#x53F7;&#x4E00;&#x6837;&#xFF0C;&#x4F7F;&#x7528;&#x5E38;&#x89C4;&#xFF08;&#x5355;&#x53C2;&#x6570;&#xFF09;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x6765;&#x5904;&#x7406;&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;&#x3002;<code>sigaction</code></p>
<h1 id="&#x5B9A;&#x65F6;&#x5668;&#x4E0E;&#x4F11;&#x7720;"><a href="#&#x5B9A;&#x65F6;&#x5668;&#x4E0E;&#x4F11;&#x7720;" class="headerlink" title="&#x5B9A;&#x65F6;&#x5668;&#x4E0E;&#x4F11;&#x7720;"></a>&#x5B9A;&#x65F6;&#x5668;&#x4E0E;&#x4F11;&#x7720;</h1><p>&#x5B9A;&#x65F6;&#x5668;&#x662F;&#x8FDB;&#x7A0B;&#x89C4;&#x5212;&#x81EA;&#x5DF1;&#x5728;&#x672A;&#x6765;&#x67D0;&#x4E00;&#x65F6;&#x523B;&#x63A5;&#x83B7;&#x901A;&#x77E5;&#x7684;&#x4E00;&#x79CD;&#x673A;&#x5236;&#x3002;</p>
<h2 id="&#x95F4;&#x9694;&#x5B9A;&#x65F6;&#x5668;"><a href="#&#x95F4;&#x9694;&#x5B9A;&#x65F6;&#x5668;" class="headerlink" title="&#x95F4;&#x9694;&#x5B9A;&#x65F6;&#x5668;"></a>&#x95F4;&#x9694;&#x5B9A;&#x65F6;&#x5668;</h2><p>&#x7CFB;&#x7EDF;&#x8C03;&#x7528;setitimer()&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x95F4;&#x9694;&#x5F0F;&#x5B9A;&#x65F6;&#x5668;&#xFF08;interval timer&#xFF09;&#xFF0C;&#x8FD9;&#x79CD;&#x5B9A;&#x65F6;&#x5668;&#x4F1A;&#x5728;&#x672A;&#x6765;&#x67D0;&#x4E2A;&#x65F6;&#x95F4;&#x70B9;&#x5230;&#x671F;&#xFF0C;&#x5E76;&#x4E8E;&#x6B64;&#x540E;&#xFF08;&#x53EF;&#x9009;&#x62E9;&#x5730;&#xFF09;&#x6BCF;&#x9694;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;&#x5230;&#x671F;&#x4E00;&#x6B21;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;sys/time.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">setitimer</span><span class="token punctuation">(</span><span class="token keyword">int</span> which<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">struct</span> itimerval <span class="token operator">*</span>new_value<span class="token punctuation">,</span><span class="token keyword">struct</span> itimerval <span class="token operator">*</span>old_value<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x901A;&#x8FC7;&#x5728;&#x8C03;&#x7528;setitimer()&#x65F6;&#x4E3A;which&#x6307;&#x5B9A;&#x4EE5;&#x4E0B;&#x503C;&#xFF0C;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x521B;&#x5EFA;3&#x79CD;&#x4E0D;&#x540C;&#x7C7B;&#x578B;&#x7684;&#x5B9A;&#x65F6;&#x5668;&#x3002;<br><code>ITIMER_REAL</code>&#x521B;&#x5EFA;&#x4EE5;&#x771F;&#x5B9E;&#x65F6;&#x95F4;&#x5012;&#x8BA1;&#x65F6;&#x7684;&#x5B9A;&#x65F6;&#x5668;&#x3002;&#x5230;&#x671F;&#x65F6;&#x4F1A;&#x4EA7;&#x751F;SIGALARM&#x4FE1;&#x53F7;&#x5E76;&#x53D1;&#x9001;&#x7ED9;&#x8FDB;&#x7A0B;.<br><code>ITIMER_VIRTUAL</code>&#x521B;&#x5EFA;&#x4EE5;&#x8FDB;&#x7A0B;&#x865A;&#x62DF;&#x65F6;&#x95F4;&#xFF08;&#x7528;&#x6237;&#x6A21;&#x5F0F;&#x4E0B;&#x7684;CPU&#x65F6;&#x95F4;&#xFF09;&#x5012;&#x8BA1;&#x65F6;&#x7684;&#x5B9A;&#x65F6;&#x5668;&#x3002;&#x5230;&#x671F;&#x65F6;&#x4F1A;&#x4EA7;&#x751F;&#x4FE1;&#x53F7;SIGVTALRM&#x3002;<br><code>ITIMER_PROF</code>&#x521B;&#x5EFA;&#x4E00;&#x4E2A;profiling&#x5B9A;&#x65F6;&#x5668;&#xFF0C;&#x4EE5;&#x8FDB;&#x7A0B;&#x65F6;&#x95F4;&#xFF08;&#x7528;&#x6237;&#x6001;&#x4E0E;&#x5185;&#x6838;&#x6001;CPU&#x65F6;&#x95F4;&#x7684;&#x603B;&#x548C;&#xFF09;&#x5012;&#x8BA1;&#x65F6;&#x3002;&#x5230;&#x671F;&#x65F6;&#xFF0C;&#x5219;&#x4F1A;&#x4EA7;&#x751F;SIGPROF&#x4FE1;&#x53F7;&#x3002;<br>&#x53C2;&#x6570;new_value&#x548C;old_value&#x5747;&#x4E3A;&#x6307;&#x5411;&#x7ED3;&#x6784;itimerval&#x7684;&#x6307;&#x9488;&#xFF0C;&#x7ED3;&#x6784;&#x7684;&#x5B9A;&#x4E49;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">struct</span> itimerval <span class="token punctuation">{</span>
    <span class="token keyword">struct</span> timerval it_interval<span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">//&#x8BBE;&#x4E3A;&#x65F6;&#x949F;&#x95F4;&#x9694;</span>
    <span class="token keyword">struct</span> timerval it_value<span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">//&#x8BBE;&#x4E3A;&#x7B2C;&#x4E00;&#x6B21;&#x89E6;&#x53D1;&#x7684;&#x65F6;&#x949F;&#x95F4;&#x9694;&#xFF0C;&#x53EA;&#x88AB;&#x6267;&#x884C;&#x4E00;&#x6B21;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> timeval <span class="token punctuation">{</span>
    <span class="token keyword">long</span> tv_sec<span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">//&#x79D2;</span>
    <span class="token keyword">long</span> tv_usec<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//&#x5FAE;&#x79D2;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>            <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x6570;new_value&#x7684;&#x4E0B;&#x5C5E;&#x7ED3;&#x6784;it_value&#x6307;&#x5B9A;&#x4E86;&#x8DDD;&#x79BB;&#x5B9A;&#x65F6;&#x5668;&#x5230;&#x671F;&#x7684;&#x5EF6;&#x8FDF;&#x65F6;&#x95F4;&#x3002;&#x53E6;&#x4E00;&#x4E0B;&#x5C5E;&#x7ED3;&#x6784;it_interval&#x5219;&#x8BF4;&#x660E;&#x8BE5;&#x5B9A;&#x65F6;&#x5668;&#x662F;&#x5426;&#x4E3A;&#x5468;&#x671F;&#x6027;&#x5B9A;&#x65F6;&#x5668;&#x3002;&#x5982;&#x679C;it_interval&#x7684;&#x4E24;&#x4E2A;&#x5B57;&#x6BB5;&#x503C;&#x5747;&#x4E3A;0&#xFF0C;&#x90A3;&#x4E48;&#x8BE5;&#x5B9A;&#x65F6;&#x5668;&#x5C31;&#x5C5E;&#x4E8E;&#x5728;it_value&#x6240;&#x6307;&#x5B9A;&#x7684;&#x65F6;&#x95F4;&#x95F4;&#x9694;&#x540E;&#x5230;&#x671F;&#x7684;&#x4E00;&#x6B21;&#x6027;&#x5B9A;&#x65F6;&#x5668;&#x3002;&#x53EA;&#x8981;it_interval&#x4E2D;&#x7684;&#x4EFB;&#x4E00;&#x5B57;&#x6BB5;&#x975E;0&#xFF0C;&#x90A3;&#x4E48;&#x5728;&#x6BCF;&#x6B21;&#x5B9A;&#x65F6;&#x5668;&#x5230;&#x671F;&#x4E4B;&#x540E;&#xFF0C;&#x90FD;&#x4F1A;&#x5C06;&#x5B9A;&#x65F6;&#x5668;&#x91CD;&#x7F6E;&#x4E3A;&#x5728;&#x6307;&#x5B9A;&#x95F4;&#x9694;&#x540E;&#x518D;&#x6B21;&#x5230;&#x671F;&#x3002;<br>&#x8FDB;&#x7A0B;&#x53EA;&#x80FD;&#x62E5;&#x6709;&#x4E0A;&#x8FF0;3&#x79CD;&#x5B9A;&#x65F6;&#x5668;&#x4E2D;&#x7684;&#x4E00;&#x79CD;&#x3002;&#x5F53;&#x7B2C;2&#x6B21;&#x8C03;&#x7528;setitimer()&#x65F6;&#xFF0C;&#x4FEE;&#x6539;&#x5DF2;&#x6709;&#x5B9A;&#x65F6;&#x5668;&#x7684;&#x5C5E;&#x6027;&#x8981;&#x7B26;&#x5408;&#x53C2;&#x6570;which&#x4E2D;&#x7684;&#x7C7B;&#x578B;&#x3002;&#x5982;&#x679C;&#x8C03;&#x7528;setitimer()&#x65F6;&#x5C06;new_value.it_value&#x7684;&#x4E24;&#x4E2A;&#x5B57;&#x6BB5;&#x5747;&#x7F6E;&#x4E3A;0&#xFF0C;&#x90A3;&#x4E48;&#x4F1A;&#x5C4F;&#x853D;&#x4EFB;&#x4F55;&#x5DF2;&#x6709;&#x7684;&#x5B9A;&#x65F6;&#x5668;&#x3002;<br>&#x82E5;&#x53C2;&#x6570;old_value&#x4E0D;&#x4E3A;NULL&#xFF0C;&#x5219;&#x4EE5;&#x5176;&#x6240;&#x6307;&#x5411;&#x7684;itimerval&#x7ED3;&#x6784;&#x6765;&#x8FD4;&#x56DE;&#x5B9A;&#x65F6;&#x5668;&#x7684;&#x524D;&#x4E00;&#x8BBE;&#x7F6E;&#x3002;&#x5982;&#x679C;old_value.it_value&#x7684;&#x4E24;&#x4E2A;&#x5B57;&#x6BB5;&#x503C;&#x5747;&#x4E3A;0&#xFF0C;&#x90A3;&#x4E48;&#x8BE5;&#x5B9A;&#x65F6;&#x5668;&#x4E4B;&#x524D;&#x5904;&#x4E8E;&#x5C4F;&#x853D;&#x72B6;&#x6001;&#x3002;&#x5982;&#x679C;old_value.it_interval&#x7684;&#x4E24;&#x4E2A;&#x5B57;&#x6BB5;&#x503C;&#x5747;&#x4E3A;0&#xFF0C;&#x90A3;&#x4E48;&#x8BE5;&#x5B9A;&#x65F6;&#x5668;&#x4E4B;&#x524D;&#x88AB;&#x8BBE;&#x7F6E;&#x4E3A;&#x5386;&#x7ECF;old_value.it_value&#x6307;&#x5B9A;&#x65F6;&#x95F4;&#x800C;&#x5230;&#x671F;&#x7684;&#x4E00;&#x6B21;&#x6027;&#x5B9A;&#x65F6;&#x5668;&#x3002;&#x5BF9;&#x4E8E;&#x9700;&#x8981;&#x5728;&#x65B0;&#x5B9A;&#x65F6;&#x5668;&#x5230;&#x671F;&#x540E;&#x5C06;&#x5176;&#x8FD8;&#x539F;&#x7684;&#x60C5;&#x51B5;&#x800C;&#x8A00;&#xFF0C;&#x83B7;&#x53D6;&#x5B9A;&#x65F6;&#x5668;&#x7684;&#x524D;&#x4E00;&#x8BBE;&#x7F6E;&#x5C31;&#x5F88;&#x91CD;&#x8981;&#x3002;&#x5982;&#x679C;&#x4E0D;&#x5173;&#x5FC3;&#x5B9A;&#x65F6;&#x5668;&#x7684;&#x524D;&#x4E00;&#x8BBE;&#x7F6E;&#xFF0C;&#x53EF;&#x4EE5;&#x5C06;old_value&#x7F6E;&#x4E3A;NULL&#x3002;</p>
<p>&#x53EF;&#x4EE5;&#x5728;&#x4EFB;&#x4F55;&#x65F6;&#x523B;&#x8C03;&#x7528;getitimer()&#xFF0C;&#x4EE5;&#x4E86;&#x89E3;&#x5B9A;&#x65F6;&#x5668;&#x7684;&#x5F53;&#x524D;&#x72B6;&#x6001;&#x3001;&#x8DDD;&#x79BB;&#x4E0B;&#x6B21;&#x5230;&#x671F;&#x7684;&#x5269;&#x4F59;&#x65F6;&#x95F4;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;sys/time.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">getitimer</span><span class="token punctuation">(</span><span class="token keyword">int</span> which<span class="token punctuation">,</span> <span class="token keyword">struct</span> itimerval <span class="token operator">*</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x7CFB;&#x7EDF;&#x8C03;&#x7528;getitimer()&#x8FD4;&#x56DE;&#x7531;which&#x6307;&#x5B9A;&#x5B9A;&#x65F6;&#x5668;&#x7684;&#x5F53;&#x524D;&#x72B6;&#x6001;&#xFF0C;&#x5E76;&#x7F6E;&#x4E8E;&#x7531;curr_value&#x6240;&#x6307;&#x5411;&#x7684;&#x7F13;&#x51B2;&#x533A;&#x4E2D;&#x3002;&#x8FD9;&#x4E0E;setitimer()&#x501F;&#x53C2;&#x6570;old_value&#x6240;&#x8FD4;&#x56DE;&#x7684;&#x4FE1;&#x606F;&#x5B8C;&#x5168;&#x76F8;&#x540C;&#xFF0C;&#x533A;&#x522B;&#x5219;&#x5728;&#x4E8E;getitimer()&#x65E0;&#x9700;&#x4E3A;&#x4E86;&#x83B7;&#x53D6;&#x8FD9;&#x4E9B;&#x4FE1;&#x606F;&#x800C;&#x6539;&#x53D8;&#x5B9A;&#x65F6;&#x5668;&#x7684;&#x8BBE;&#x7F6E;&#x3002;</p>
<h3 id="&#x66F4;&#x4E3A;&#x7B80;&#x5355;&#x7684;&#x5B9A;&#x65F6;&#x5668;&#x63A5;&#x53E3;&#xFF1A;alarm"><a href="#&#x66F4;&#x4E3A;&#x7B80;&#x5355;&#x7684;&#x5B9A;&#x65F6;&#x5668;&#x63A5;&#x53E3;&#xFF1A;alarm" class="headerlink" title="&#x66F4;&#x4E3A;&#x7B80;&#x5355;&#x7684;&#x5B9A;&#x65F6;&#x5668;&#x63A5;&#x53E3;&#xFF1A;alarm()"></a>&#x66F4;&#x4E3A;&#x7B80;&#x5355;&#x7684;&#x5B9A;&#x65F6;&#x5668;&#x63A5;&#x53E3;&#xFF1A;alarm()</h3><pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;unistd.h&gt;</span></span>
<span class="token keyword">unsigned</span> <span class="token keyword">int</span> alarm&#xFF08;<span class="token keyword">unsigned</span> <span class="token keyword">int</span> seconds<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x603B;&#x662F;&#x8C03;&#x7528;&#x6210;&#x529F;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x53C2;&#x6570;seconds&#x8868;&#x793A;&#x5B9A;&#x65F6;&#x5668;&#x5230;&#x671F;&#x7684;&#x79D2;&#x6570;&#x3002;&#x5230;&#x671F;&#x65F6;&#xFF0C;&#x4F1A;&#x5411;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;SIGALRM&#x4FE1;&#x53F7;&#x3002;<br>&#x8C03;&#x7528;alarm()&#x4F1A;&#x8986;&#x76D6;&#x5BF9;&#x5B9A;&#x65F6;&#x5668;&#x7684;&#x524D;&#x4E00;&#x4E2A;&#x8BBE;&#x7F6E;&#x3002;&#x8C03;&#x7528;alarm(0)&#x53EF;&#x5C4F;&#x853D;&#x73B0;&#x6709;&#x5B9A;&#x65F6;&#x5668;&#x3002;<br>alarm()&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x662F;&#x5B9A;&#x65F6;&#x5668;&#x524D;&#x4E00;&#x8BBE;&#x7F6E;&#x8DDD;&#x79BB;&#x5230;&#x671F;&#x7684;&#x5269;&#x4F59;&#x79D2;&#x6570;&#xFF0C;&#x5982;&#x672A;&#x8BBE;&#x7F6E;&#x5B9A;&#x65F6;&#x5668;&#x5219;&#x8FD4;&#x56DE;0&#x3002;</p>
<h3 id="setitimer-&#x548C;alarm-&#x4E4B;&#x95F4;&#x7684;&#x4EA4;&#x4E92;"><a href="#setitimer-&#x548C;alarm-&#x4E4B;&#x95F4;&#x7684;&#x4EA4;&#x4E92;" class="headerlink" title="setitimer()&#x548C;alarm()&#x4E4B;&#x95F4;&#x7684;&#x4EA4;&#x4E92;"></a>setitimer()&#x548C;alarm()&#x4E4B;&#x95F4;&#x7684;&#x4EA4;&#x4E92;</h3><p>Linux&#x4E2D;&#xFF0C;alarm()&#x548C;setitimer()&#x9488;&#x5BF9;&#x540C;&#x4E00;&#x8FDB;&#x7A0B;&#xFF08;per-process&#xFF09;&#x5171;&#x4EAB;&#x540C;&#x4E00;&#x5B9E;&#x65F6;&#x5B9A;&#x65F6;&#x5668;&#xFF0C;&#x4E3A;&#x4E86;&#x786E;&#x4FDD;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x53EF;&#x79FB;&#x690D;&#x6027;&#x7684;&#x6700;&#x5927;&#x5316;&#xFF0C;&#x7A0B;&#x5E8F;&#x8BBE;&#x7F6E;&#x5B9E;&#x65F6;&#x5B9A;&#x65F6;&#x5668;&#x7684;&#x51FD;&#x6570;&#x53EA;&#x80FD;&#x5728;&#x4E8C;&#x8005;&#x4E2D;&#x9009;&#x62E9;&#x5176;&#x4E00;&#x3002;</p>
<h2 id="&#x5B9A;&#x65F6;&#x5668;&#x7684;&#x8C03;&#x5EA6;&#x53CA;&#x7CBE;&#x5EA6;"><a href="#&#x5B9A;&#x65F6;&#x5668;&#x7684;&#x8C03;&#x5EA6;&#x53CA;&#x7CBE;&#x5EA6;" class="headerlink" title="&#x5B9A;&#x65F6;&#x5668;&#x7684;&#x8C03;&#x5EA6;&#x53CA;&#x7CBE;&#x5EA6;"></a>&#x5B9A;&#x65F6;&#x5668;&#x7684;&#x8C03;&#x5EA6;&#x53CA;&#x7CBE;&#x5EA6;</h2><p>&#x53D6;&#x51B3;&#x4E8E;&#x5F53;&#x524D;&#x8D1F;&#x8F7D;&#x548C;&#x5BF9;&#x8FDB;&#x7A0B;&#x7684;&#x8C03;&#x5EA6;&#xFF0C;&#x7CFB;&#x7EDF;&#x53EF;&#x80FD;&#x4F1A;&#x5728;&#x5B9A;&#x65F6;&#x5668;&#x5230;&#x671F;&#x7684;&#x77AC;&#x95F4;&#xFF08;&#x901A;&#x5E38;&#x662F;&#x51E0;&#x5206;&#x4E4B;&#x4E00;&#x79D2;&#xFF09;&#x4E4B;&#x540E;&#x624D;&#x53BB;&#x8C03;&#x5EA6;&#x5176;&#x6240;&#x5C5E;&#x8FDB;&#x7A0B;&#x3002;&#x5C3D;&#x7BA1;&#x5982;&#x6B64;&#xFF0C;&#x7531;setitimer()&#x6216;&#x5176;&#x4ED6;&#x63A5;&#x53E3;&#x6240;&#x521B;&#x5EFA;&#x7684;&#x5468;&#x671F;&#x6027;&#x5B9A;&#x65F6;&#x5668;&#xFF0C;&#x5728;&#x5230;&#x671F;&#x540E;&#x4F9D;&#x7136;&#x4F1A;&#x606A;&#x5B88;&#x5176;&#x89C4;&#x5F8B;&#x6027;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x5047;&#x8BBE;&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x5B9E;&#x65F6;&#x5B9A;&#x65F6;&#x5668;&#x6BCF;&#x4E24;&#x79D2;&#x5230;&#x671F;&#x4E00;&#x6B21;&#xFF0C;&#x867D;&#x7136;&#x4E0A;&#x8FF0;&#x5EF6;&#x8FDF;&#x53EF;&#x80FD;&#x4F1A;&#x5F71;&#x54CD;&#x6BCF;&#x4E2A;&#x5B9A;&#x65F6;&#x5668;&#x4E8B;&#x4EF6;&#x7684;&#x9001;&#x8FBE;&#xFF0C;&#x4F46;&#x7CFB;&#x7EDF;&#x5BF9;&#x540E;&#x7EED;&#x5B9A;&#x65F6;&#x5668;&#x5230;&#x671F;&#x7684;&#x8C03;&#x5EA6;&#x4F9D;&#x7136;&#x4F1A;&#x4E25;&#x683C;&#x9075;&#x5FAA;&#x4E24;&#x79D2;&#x7684;&#x65F6;&#x95F4;&#x95F4;&#x9694;&#x3002;&#x6362;&#x8A00;&#x4E4B;&#xFF0C;&#x95F4;&#x9694;&#x5F0F;&#x5B9A;&#x65F6;&#x5668;&#x4E0D;&#x53D7;&#x6F5C;&#x5728;&#x9519;&#x8BEF;&#x5DE6;&#x53F3;&#x3002;</p>
<p>&#x5BF9;&#x4E8E;&#x73B0;&#x4EE3;Linux&#x5185;&#x6838;&#x800C;&#x8A00;&#xFF0C;&#x9002;&#x624D;&#x5173;&#x4E8E;&#x5B9A;&#x65F6;&#x5668;&#x5206;&#x8FA8;&#x7387;&#x53D7;&#x9650;&#x4E8E;&#x8F6F;&#x4EF6;&#x65F6;&#x949F;&#x9891;&#x7387;&#x7684;&#x8BBA;&#x65AD;&#x5DF2;&#x7ECF;&#x4E0D;&#x518D;&#x6210;&#x7ACB;&#x3002;&#x81EA;&#x7248;&#x672C;2.6.21&#x5F00;&#x59CB;&#xFF0C;Linux&#x5185;&#x6838;&#x53EF;&#x9009;&#x62E9;&#x662F;&#x5426;&#x652F;&#x6301;&#x9AD8;&#x5206;&#x8FA8;&#x7387;&#x5B9A;&#x65F6;&#x5668;&#x3002;&#x5982;&#x679C;&#x9009;&#x62E9;&#x652F;&#x6301;&#xFF08;&#x901A;&#x8FC7;&#x5185;&#x6838;&#x914D;&#x7F6E;&#x9009;&#x9879;CONFIG_HIGH_RES_TIMERS&#xFF09;&#xFF0C;&#x90A3;&#x4E48;&#x672C;&#x7AE0;&#x5404;&#x79CD;&#x5B9A;&#x65F6;&#x5668;&#x4EE5;&#x53CA;&#x4F11;&#x7720;&#x63A5;&#x53E3;&#x7684;&#x7684;&#x7CBE;&#x5EA6;&#x5219;&#x4E0D;&#x518D;&#x53D7;&#x5185;&#x6838;jiffy&#xFF08;&#x8F6F;&#x4EF6;&#x65F6;&#x949F;&#x5468;&#x671F;&#xFF09;&#x7684;&#x5F71;&#x54CD;&#xFF0C;&#x53EF;&#x4EE5;&#x8FBE;&#x5230;&#x5E95;&#x5C42;&#x786C;&#x4EF6;&#x6240;&#x652F;&#x6301;&#x7684;&#x7CBE;&#x5EA6;&#x3002;&#x5728;&#x73B0;&#x4EE3;&#x786C;&#x4EF6;&#x5E73;&#x53F0;&#x4E0A;&#xFF0C;&#x7CBE;&#x5EA6;&#x8FBE;&#x5230;&#x5FAE;&#x79D2;&#x7EA7;&#x662F;&#x53F8;&#x7A7A;&#x89C1;&#x60EF;&#x7684;&#x4E8B;&#x60C5;&#x3002;</p>
<h3 id="&#x4E3A;&#x963B;&#x585E;&#x64CD;&#x4F5C;&#x8BBE;&#x7F6E;&#x8D85;&#x65F6;"><a href="#&#x4E3A;&#x963B;&#x585E;&#x64CD;&#x4F5C;&#x8BBE;&#x7F6E;&#x8D85;&#x65F6;" class="headerlink" title="&#x4E3A;&#x963B;&#x585E;&#x64CD;&#x4F5C;&#x8BBE;&#x7F6E;&#x8D85;&#x65F6;"></a>&#x4E3A;&#x963B;&#x585E;&#x64CD;&#x4F5C;&#x8BBE;&#x7F6E;&#x8D85;&#x65F6;</h3><pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;signal.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;string&gt;</span></span>

using namespace std<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">handler</span><span class="token punctuation">(</span><span class="token keyword">int</span> sig<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  cout<span class="token operator">&lt;&lt;</span><span class="token string">&quot;hello&quot;</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
 <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;124\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

 <span class="token keyword">struct</span> sigaction sa<span class="token punctuation">;</span>
 sa<span class="token punctuation">.</span>sa_handler<span class="token operator">=</span>handler<span class="token punctuation">;</span>
 <span class="token function">sigaction</span><span class="token punctuation">(</span>SIGALRM<span class="token punctuation">,</span><span class="token operator">&amp;</span>sa<span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token function">alarm</span><span class="token punctuation">(</span> <span class="token number">5</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

 string test<span class="token punctuation">;</span>
 cin<span class="token operator">&gt;&gt;</span>test<span class="token punctuation">;</span>

 <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;end\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

 <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>124
hello
end</code></pre><p>&#x5982;&#x679C;&#x4E0D;&#x8C03;&#x7528;sigaction&#xFF0C;&#x5219;&#x663E;&#x793A;&#xFF1A;</p>
<pre><code>124
Alarm clock</code></pre><h2 id="&#x6682;&#x505C;&#x8FD0;&#x884C;&#xFF08;&#x4F11;&#x7720;&#xFF09;&#x4E00;&#x6BB5;&#x56FA;&#x5B9A;&#x65F6;&#x95F4;"><a href="#&#x6682;&#x505C;&#x8FD0;&#x884C;&#xFF08;&#x4F11;&#x7720;&#xFF09;&#x4E00;&#x6BB5;&#x56FA;&#x5B9A;&#x65F6;&#x95F4;" class="headerlink" title="&#x6682;&#x505C;&#x8FD0;&#x884C;&#xFF08;&#x4F11;&#x7720;&#xFF09;&#x4E00;&#x6BB5;&#x56FA;&#x5B9A;&#x65F6;&#x95F4;"></a>&#x6682;&#x505C;&#x8FD0;&#x884C;&#xFF08;&#x4F11;&#x7720;&#xFF09;&#x4E00;&#x6BB5;&#x56FA;&#x5B9A;&#x65F6;&#x95F4;</h2><h3 id="&#x4F4E;&#x5206;&#x8FA8;&#x7387;&#x4F11;&#x7720;&#xFF1A;sleep"><a href="#&#x4F4E;&#x5206;&#x8FA8;&#x7387;&#x4F11;&#x7720;&#xFF1A;sleep" class="headerlink" title="&#x4F4E;&#x5206;&#x8FA8;&#x7387;&#x4F11;&#x7720;&#xFF1A;sleep()"></a>&#x4F4E;&#x5206;&#x8FA8;&#x7387;&#x4F11;&#x7720;&#xFF1A;sleep()</h3><p>&#x51FD;&#x6570;sleep()&#x53EF;&#x4EE5;&#x6682;&#x505C;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x7684;&#x6267;&#x884C;&#x8FBE;&#x6570;&#x79D2;&#x4E4B;&#x4E45;&#xFF08;&#x7531;&#x53C2;&#x6570;seconds&#x8BBE;&#x7F6E;&#xFF09;&#xFF0C;&#x6216;&#x8005;&#x5728;&#x6355;&#x83B7;&#x5230;&#x4FE1;&#x53F7;&#xFF08;&#x4ECE;&#x800C;&#x4E2D;&#x65AD;&#x8C03;&#x7528;&#xFF09;&#x540E;&#x6062;&#x590D;&#x8FDB;&#x7A0B;&#x7684;&#x8FD0;&#x884C;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;unistd.h&gt;</span></span>
<span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> seconds<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x5982;&#x679C;&#x4F11;&#x7720;&#x6B63;&#x5E38;&#x7ED3;&#x675F;&#xFF0C;sleep()&#x8FD4;&#x56DE;0&#x3002;&#x5982;&#x679C;&#x56E0;&#x4FE1;&#x53F7;&#x800C;&#x4E2D;&#x65AD;&#x4F11;&#x7720;&#xFF0C;sleep()&#x5C06;&#x8FD4;&#x56DE;&#x5269;&#x4F59;&#xFF08;&#x672A;&#x4F11;&#x7720;&#xFF09;&#x7684;&#x79D2;&#x6570;&#x3002;&#x4E0E;alarm()&#x548C;setitimer()&#x6240;&#x8BBE;&#x7F6E;&#x7684;&#x5B9A;&#x65F6;&#x5668;&#x76F8;&#x540C;&#xFF0C;&#x7531;&#x4E8E;&#x7CFB;&#x7EDF;&#x8D1F;&#x8F7D;&#x7684;&#x539F;&#x56E0;&#xFF0C;&#x5185;&#x6838;&#x53EF;&#x80FD;&#x4F1A;&#x5728;&#x5B8C;&#x6210;sleep()&#x7684;&#x4E00;&#x6BB5;&#xFF08;&#x901A;&#x5E38;&#x5F88;&#x77ED;&#xFF09;&#x65F6;&#x95F4;&#x540E;&#x624D;&#x5BF9;&#x8FDB;&#x7A0B;&#x91CD;&#x65B0;&#x52A0;&#x4EE5;&#x8C03;&#x5EA6;&#x3002;<br>Linux&#x5C06;sleep()&#x5B9E;&#x73B0;&#x4E3A;&#x5BF9;nanosleep()&#x7684;&#x8C03;&#x7528;&#xFF0C;&#x5176;&#x7ED3;&#x679C;&#x662F;sleep()&#x4E0E;&#x5B9A;&#x65F6;&#x5668;&#x51FD;&#x6570;&#x4E4B;&#x95F4;&#x5E76;&#x65E0;&#x4EA4;&#x4E92;&#x3002;<br>&#x8003;&#x8651;&#x5230;&#x53EF;&#x79FB;&#x690D;&#x6027;&#xFF0C;&#x5E94;&#x907F;&#x514D;&#x5C06;sleep()&#x548C;alarm()&#x4EE5;&#x53CA;setitimer()&#x6DF7;&#x7528;&#x3002;</p>
<h3 id="&#x9AD8;&#x5206;&#x8FA8;&#x7387;&#x4F11;&#x7720;&#xFF1A;nanosleep"><a href="#&#x9AD8;&#x5206;&#x8FA8;&#x7387;&#x4F11;&#x7720;&#xFF1A;nanosleep" class="headerlink" title="&#x9AD8;&#x5206;&#x8FA8;&#x7387;&#x4F11;&#x7720;&#xFF1A;nanosleep()"></a>&#x9AD8;&#x5206;&#x8FA8;&#x7387;&#x4F11;&#x7720;&#xFF1A;nanosleep()</h3><p>&#x51FD;&#x6570;nanosleep()&#x7684;&#x529F;&#x7528;&#x4E0E;sleep()&#x7C7B;&#x4F3C;&#xFF0C;&#x4F46;&#x66F4;&#x5177;&#x4F18;&#x52BF;&#xFF0C;&#x5176;&#x4E2D;&#x5305;&#x62EC;&#x80FD;&#x4EE5;&#x66F4;&#x9AD8;&#x5206;&#x8FA8;&#x7387;&#x6765;&#x8BBE;&#x5B9A;&#x4F11;&#x7720;&#x95F4;&#x9694;&#x65F6;&#x95F4;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;time.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">nanosleep</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">struct</span> timespec <span class="token operator">*</span>request<span class="token punctuation">,</span> <span class="token keyword">struct</span> timespec <span class="token operator">*</span>remain<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> timespec<span class="token punctuation">{</span>
    time_t tv_sec<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//&#x79D2;</span>
    <span class="token keyword">long</span>   tv_usec<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//&#x7EB3;&#x79D2;&#xFF0C;&#x53D6;&#x503C;&#x8303;&#x56F4;&#x5728;0&#xFF5E;999999999&#x4E4B;&#x95F4;&#x3002;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x53C2;&#x6570;request&#x6307;&#x5B9A;&#x4E86;&#x4F11;&#x7720;&#x7684;&#x6301;&#x7EED;&#x65F6;&#x95F4;&#x3002;<br>nanosleep()&#x7684;&#x66F4;&#x5927;&#x4F18;&#x52BF;&#x5728;&#x4E8E;&#xFF0C;SUSv3&#x660E;&#x6587;&#x89C4;&#x5B9A;&#x4E0D;&#x5F97;&#x4F7F;&#x7528;&#x4FE1;&#x53F7;&#x6765;&#x5B9E;&#x73B0;&#x8BE5;&#x51FD;&#x6570;&#x3002;&#x8FD9;&#x610F;&#x5473;&#x7740;&#xFF0C;&#x4E0E;sleep()&#x4E0D;&#x540C;&#xFF0C;&#x5373;&#x4F7F;&#x5C06;nanosleep()&#x4E0E;alarm()&#x6216;setitimer()&#x6DF7;&#x7528;&#xFF0C;&#x4E5F;&#x4E0D;&#x4F1A;&#x5371;&#x53CA;&#x7A0B;&#x5E8F;&#x7684;&#x53EF;&#x79FB;&#x690D;&#x6027;&#x3002;</p>
<h2 id="POSIX&#x65F6;&#x949F;"><a href="#POSIX&#x65F6;&#x949F;" class="headerlink" title="POSIX&#x65F6;&#x949F;"></a>POSIX&#x65F6;&#x949F;</h2><p>POSIX&#x65F6;&#x949F;&#xFF08;&#x539F;&#x5B9A;&#x4E49;&#x4E8E;POSIX.1b&#xFF09;&#x6240;&#x63D0;&#x4F9B;&#x7684;&#x65F6;&#x949F;&#x8BBF;&#x95EE;API&#x53EF;&#x4EE5;&#x652F;&#x6301;&#x7EB3;&#x79D2;&#x7EA7;&#x7684;&#x65F6;&#x95F4;&#x7CBE;&#x5EA6;&#xFF0C;&#x5176;&#x4E2D;&#x8868;&#x793A;&#x7EB3;&#x79D2;&#x7EA7;&#x65F6;&#x95F4;&#x503C;&#x7684;timespec&#x7ED3;&#x6784;&#x540C;&#x6837;&#x4E5F;&#x7528;&#x4E8E;nanosleep()&#x8C03;&#x7528;&#x3002;<br>Linux&#x4E2D;&#xFF0C;&#x8C03;&#x7528;&#x6B64;API&#x7684;&#x7A0B;&#x5E8F;&#x5FC5;&#x987B;&#x4EE5;-lrt&#x9009;&#x9879;&#x8FDB;&#x884C;&#x7F16;&#x8BD1;&#xFF0C;&#x4ECE;&#x800C;&#x4E0E;librt&#xFF08;realtime&#xFF0C;&#x5B9E;&#x65F6;&#xFF09;&#x51FD;&#x6570;&#x5E93;&#x76F8;&#x94FE;&#x63A5;&#x3002;<br>POSIX&#x65F6;&#x949F;API&#x7684;&#x4E3B;&#x8981;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5305;&#x62EC;&#x83B7;&#x53D6;&#x65F6;&#x949F;&#x5F53;&#x524D;&#x503C;&#x7684;clock_gettime()&#x3001;&#x8FD4;&#x56DE;&#x65F6;&#x949F;&#x5206;&#x8FA8;&#x7387;&#x7684;clock_getres()&#xFF0C;&#x4EE5;&#x53CA;&#x66F4;&#x65B0;&#x65F6;&#x949F;&#x7684;clock_settime()&#x3002;</p>
<h3 id="&#x83B7;&#x53D6;&#x65F6;&#x949F;&#x7684;&#x503C;&#xFF1A;clock-gettime"><a href="#&#x83B7;&#x53D6;&#x65F6;&#x949F;&#x7684;&#x503C;&#xFF1A;clock-gettime" class="headerlink" title="&#x83B7;&#x53D6;&#x65F6;&#x949F;&#x7684;&#x503C;&#xFF1A;clock_gettime()"></a>&#x83B7;&#x53D6;&#x65F6;&#x949F;&#x7684;&#x503C;&#xFF1A;clock_gettime()</h3><p>&#x7CFB;&#x7EDF;&#x8C03;&#x7528;clock_gettime()&#x9488;&#x5BF9;&#x53C2;&#x6570;clockid&#x6240;&#x6307;&#x5B9A;&#x7684;&#x65F6;&#x949F;&#x8FD4;&#x56DE;&#x65F6;&#x95F4;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">define</span> _POSIX_C_SOURCE  199309</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;time.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">clock_gettime</span><span class="token punctuation">(</span>clockid_t clockid<span class="token punctuation">,</span><span class="token keyword">struct</span> timespec <span class="token operator">*</span>tp<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">clock_getres</span><span class="token punctuation">(</span>clockid_t clockid<span class="token punctuation">,</span><span class="token keyword">struct</span> timespec <span class="token operator">*</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x6210;&#x529F;&#x8FD4;&#x56DE;0&#xFF0C;&#x5931;&#x8D25;&#x8FD4;&#x56DE;&#x2014;1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x8FD4;&#x56DE;&#x7684;&#x65F6;&#x95F4;&#x503C;&#x7F6E;&#x4E8E;tp&#x6307;&#x9488;&#x6240;&#x6307;&#x5411;&#x7684;timespec&#x7ED3;&#x6784;&#x4E2D;&#x3002;&#x867D;&#x7136;timespec&#x7ED3;&#x6784;&#x63D0;&#x4F9B;&#x4E86;&#x7EB3;&#x79D2;&#x7EA7;&#x7CBE;&#x5EA6;&#xFF0C;&#x4F46;clock_gettime()&#x8FD4;&#x56DE;&#x7684;&#x65F6;&#x95F4;&#x503C;&#x7C92;&#x5EA6;&#x53EF;&#x80FD;&#x8FD8;&#x662F;&#x8981;&#x66F4;&#x5927;&#x4E00;&#x70B9;&#x3002;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;clock_getres()&#x5728;&#x53C2;&#x6570;res&#x4E2D;&#x8FD4;&#x56DE;&#x6307;&#x5411;timespec&#x7ED3;&#x6784;&#x7684;&#x6307;&#x9488;&#xFF0C;&#x673A;&#x6784;&#x4E2D;&#x5305;&#x542B;&#x4E86;&#x7531;clockid&#x6240;&#x6307;&#x5B9A;&#x65F6;&#x949F;&#x7684;&#x5206;&#x8FA8;&#x7387;&#x3002;<br>clockid_t&#x662F;&#x4E00;&#x79CD;&#x7531;SUSv3&#x5B9A;&#x4E49;&#x7684;&#x6570;&#x636E;&#x7C7B;&#x578B;&#xFF0C;&#x7528;&#x4E8E;&#x8868;&#x793A;&#x65F6;&#x949F;&#x6807;&#x8BC6;&#x7B26;&#x3002;</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th align="left">clockid_t</th>
<th align="center">&#x63CF;&#x3000;&#x3000;&#x8FF0;</th>
</tr>
</thead>
<tbody><tr>
<td align="left">CLOCK_REALTIME</td>
<td align="center">&#x53EF;&#x8BBE;&#x5B9A;&#x7684;&#x7CFB;&#x7EDF;&#x7EA7;&#x5B9E;&#x65F6;&#x65F6;&#x949F;</td>
</tr>
<tr>
<td align="left">CLOCK_MONOTONIC</td>
<td align="center">&#x4E0D;&#x53EF;&#x8BBE;&#x5B9A;&#x7684;&#x6052;&#x5B9A;&#x6001;&#x65F6;&#x949F;</td>
</tr>
<tr>
<td align="left">CLOCK_PROCESS_CPUTIME_ID</td>
<td align="center">&#x6BCF;&#x8FDB;&#x7A0B;CPU&#x65F6;&#x95F4;&#x7684;&#x65F6;&#x949F;&#xFF08;&#x81EA;Linux 2.6.12&#xFF09;</td>
</tr>
<tr>
<td align="left">CLOCK_THREAD_CPUTIME_ID</td>
<td align="center">&#x6BCF;&#x7EBF;&#x7A0B;CPU&#x65F6;&#x95F4;&#x7684;&#x65F6;&#x949F;&#xFF08;&#x81EA;Linux 2.6.12&#xFF09;</td>
</tr>
</tbody></table></div>
<p>CLOCK_REALTIME&#x65F6;&#x949F;&#x662F;&#x4E00;&#x79CD;&#x7CFB;&#x7EDF;&#x7EA7;&#x65F6;&#x949F;&#xFF0C;&#x7528;&#x4E8E;&#x5EA6;&#x91CF;&#x771F;&#x5B9E;&#x65F6;&#x95F4;&#x3002;&#x4E0E;CLOCK_MONOTONIC&#x65F6;&#x949F;&#x4E0D;&#x540C;&#xFF0C;&#x5B83;&#x7684;&#x8BBE;&#x7F6E;&#x662F;&#x53EF;&#x4EE5;&#x53D8;&#x66F4;&#x7684;&#x3002;<br>SUSv3&#x89C4;&#x5B9A;&#xFF0C;CLOCK_MONOTONIC&#x65F6;&#x949F;&#x5BF9;&#x65F6;&#x95F4;&#x7684;&#x5EA6;&#x91CF;&#x59CB;&#x4E8E;&#x201C;&#x672A;&#x4E88;&#x89C4;&#x8303;&#x7684;&#x8FC7;&#x53BB;&#x67D0;&#x4E00;&#x65F6;&#x70B9;&#x201D;&#xFF0C;&#x7CFB;&#x7EDF;&#x542F;&#x52A8;&#x540E;&#x5C31;&#x4E0D;&#x4F1A;&#x53D1;&#x751F;&#x6539;&#x53D8;&#x3002;&#x8BE5;&#x65F6;&#x949F;&#x9002;&#x7528;&#x4E8E;&#x90A3;&#x4E9B;&#x65E0;&#x6CD5;&#x5BB9;&#x5FCD;&#x7CFB;&#x7EDF;&#x65F6;&#x949F;&#x53D1;&#x751F;&#x8DF3;&#x8DC3;&#x6027;&#x53D8;&#x5316;&#xFF08;&#x4F8B;&#x5982;&#xFF1A;&#x624B;&#x5DE5;&#x6539;&#x53D8;&#x4E86;&#x7CFB;&#x7EDF;&#x65F6;&#x95F4;&#xFF09;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x3002;Linux&#x4E0A;&#xFF0C;&#x8FD9;&#x79CD;&#x65F6;&#x949F;&#x5BF9;&#x65F6;&#x95F4;&#x7684;&#x6D4B;&#x91CF;&#x59CB;&#x4E8E;&#x7CFB;&#x7EDF;&#x542F;&#x52A8;&#x3002;<br>CLOCK_PROCESS_CPUTIME_ID &#x65F6;&#x949F;&#x6D4B;&#x91CF;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x6240;&#x6D88;&#x8017;&#x7684;&#x7528;&#x6237;&#x548C;&#x7CFB;&#x7EDF; CPU &#x65F6;&#x95F4;&#x3002;CLOCK_THREAD_CPUTIME_ID&#x65F6;&#x949F;&#x7684;&#x529F;&#x7528;&#x4E0E;&#x4E4B;&#x76F8;&#x7C7B;&#x4F3C;&#xFF0C;&#x4E0D;&#x8FC7;&#x6D4B;&#x91CF;&#x5BF9;&#x8C61;&#x662F;&#x8FDB;&#x7A0B;&#x4E2D;&#x7684;&#x5355;&#x6761;&#x7EBF;&#x7A0B;&#x3002;</p>
<h3 id="&#x8BBE;&#x7F6E;&#x65F6;&#x949F;&#x7684;&#x503C;&#xFF1A;clock-settime"><a href="#&#x8BBE;&#x7F6E;&#x65F6;&#x949F;&#x7684;&#x503C;&#xFF1A;clock-settime" class="headerlink" title="&#x8BBE;&#x7F6E;&#x65F6;&#x949F;&#x7684;&#x503C;&#xFF1A;clock_settime()"></a>&#x8BBE;&#x7F6E;&#x65F6;&#x949F;&#x7684;&#x503C;&#xFF1A;clock_settime()</h3><p>&#x7CFB;&#x7EDF;&#x8C03;&#x7528;clock_settime()&#x5229;&#x7528;&#x53C2;&#x6570;tp&#x6240;&#x6307;&#x5411;&#x7F13;&#x51B2;&#x533A;&#x4E2D;&#x7684;&#x65F6;&#x95F4;&#x6765;&#x8BBE;&#x7F6E;&#x7531;clockid&#x6307;&#x5B9A;&#x7684;&#x65F6;&#x949F;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">define</span> _POSIX_C_SOURCE 199309</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;time.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">clock_settime</span><span class="token punctuation">(</span>clockid_t clockid<span class="token punctuation">,</span><span class="token keyword">const</span> <span class="token keyword">struct</span> timespect <span class="token operator">*</span>tp<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x6210;&#x529F;&#x8FD4;&#x56DE;0&#xFF0C;&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x5982;&#x679C;&#x7531;tp&#x6307;&#x5B9A;&#x7684;&#x65F6;&#x95F4;&#x5E76;&#x975E;&#x7531;clock_getres()&#x6240;&#x8FD4;&#x56DE;&#x65F6;&#x949F;&#x5206;&#x8FA8;&#x7387;&#x7684;&#x6574;&#x6570;&#x500D;&#xFF0C;&#x65F6;&#x95F4;&#x4F1A;&#x5411;&#x4E0B;&#x53D6;&#x6574;&#x3002;<br>&#x7279;&#x6743;&#x7EA7;&#xFF08;CAP_SYS_TIME&#xFF09;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;CLOCK_REALTIME&#x65F6;&#x949F;&#x3002;&#x8BE5;&#x65F6;&#x949F;&#x7684;&#x521D;&#x59CB;&#x503C;&#x901A;&#x5E38;&#x662F;&#x81EA;Epoch&#xFF08;1970&#x5E74;1&#x6708;1&#x65E5;0&#x70B9;0&#x5206;0&#x79D2;&#xFF09;&#x4EE5;&#x6765;&#x7684;&#x65F6;&#x95F4;&#x3002;</p>
<h3 id="&#x83B7;&#x53D6;&#x7279;&#x5B9A;&#x8FDB;&#x7A0B;&#x6216;&#x7EBF;&#x7A0B;&#x7684;&#x65F6;&#x949F;ID"><a href="#&#x83B7;&#x53D6;&#x7279;&#x5B9A;&#x8FDB;&#x7A0B;&#x6216;&#x7EBF;&#x7A0B;&#x7684;&#x65F6;&#x949F;ID" class="headerlink" title="&#x83B7;&#x53D6;&#x7279;&#x5B9A;&#x8FDB;&#x7A0B;&#x6216;&#x7EBF;&#x7A0B;&#x7684;&#x65F6;&#x949F;ID"></a>&#x83B7;&#x53D6;&#x7279;&#x5B9A;&#x8FDB;&#x7A0B;&#x6216;&#x7EBF;&#x7A0B;&#x7684;&#x65F6;&#x949F;ID</h3><p>&#x8981;&#x6D4B;&#x91CF;&#x7279;&#x5B9A;&#x8FDB;&#x7A0B;&#x6216;&#x7EBF;&#x7A0B;&#x6240;&#x6D88;&#x8017;&#x7684;CPU&#x65F6;&#x95F4;&#xFF0C;&#x9996;&#x5148;&#x53EF;&#x501F;&#x52A9;&#x672C;&#x8282;&#x6240;&#x63CF;&#x8FF0;&#x7684;&#x51FD;&#x6570;&#x6765;&#x83B7;&#x53D6;&#x5176;&#x65F6;&#x949F;ID&#x3002;&#x63A5;&#x7740;&#x518D;&#x4EE5;&#x6B64;&#x8FD4;&#x56DE;id&#x53BB;&#x8C03;&#x7528;clock_gettime()&#xFF0C;&#x4ECE;&#x800C;&#x83B7;&#x5F97;&#x8FDB;&#x7A0B;&#x6216;&#x7EBF;&#x7A0B;&#x8017;&#x8D39;&#x7684;CPU&#x65F6;&#x95F4;&#x3002;<br>&#x51FD;&#x6570;clock_getcpuclockid()&#x4F1A;&#x5C06;&#x96B6;&#x5C5E;&#x4E8E;pid&#x8FDB;&#x7A0B;&#x7684;CPU&#x65F6;&#x95F4;&#x65F6;&#x949F;&#x7684;&#x6807;&#x8BC6;&#x7B26;&#x7F6E;&#x4E8E;clockid&#x6307;&#x9488;&#x6240;&#x6307;&#x5411;&#x7684;&#x7F13;&#x51B2;&#x533A;&#x4E2D;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">define</span> _XOPEN_SOURCE 600</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;time.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">clock_getcpuclockid</span><span class="token punctuation">(</span>pid_t pid<span class="token punctuation">,</span>clockid_t <span class="token operator">*</span>clockid<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x6210;&#x529F;&#x8FD4;&#x56DE;0&#xFF0C;&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x53C2;&#x6570;pid&#x4E3A;0&#x65F6;&#xFF0C;clock_getcpuclockid()&#x8FD4;&#x56DE;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x7684;CPU&#x65F6;&#x95F4;&#x65F6;&#x949F;ID&#x3002;</p>
<p>&#x51FD;&#x6570;pthread_getcpuclockid()&#x662F;clock_getcpuclockid()&#x7684;POSIX&#x7EBF;&#x7A0B;&#x7248;&#xFF0C;&#x8FD4;&#x56DE;&#x7684;&#x6807;&#x8BC6;&#x7B26;&#x6240;&#x6807;&#x8BC6;&#x7684;&#x65F6;&#x949F;&#x7528;&#x4E8E;&#x5EA6;&#x91CF;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x4E2D;&#x6307;&#x5B9A;&#x7EBF;&#x7A0B;&#x6D88;&#x8017;&#x7684;CPU&#x65F6;&#x95F4;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">define</span> _XOPEN_SOURCE 600</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;pthread.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;time.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">pthread_getcpuclockid</span><span class="token punctuation">(</span>pthread_t thread<span class="token punctuation">,</span>clockid_t <span class="token operator">*</span>clockid<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x6210;&#x529F;&#x8FD4;&#x56DE;0&#xFF0C;&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x53C2;&#x6570;thread&#x662F;POSIX&#x7EBF;&#x7A0B;ID&#xFF0C;&#x7528;&#x4E8E;&#x6307;&#x5B9A;&#x5E0C;&#x671B;&#x83B7;&#x53D6;&#x7684;CPU&#x65F6;&#x949F;ID&#x6240;&#x4ECE;&#x5C5E;&#x7684;&#x7EBF;&#x7A0B;&#x3002;&#x8FD4;&#x56DE;&#x7684;&#x65F6;&#x949F;ID&#x5B58;&#x653E;&#x4E8E;clockid&#x6307;&#x9488;&#x6240;&#x6307;&#x5411;&#x7684;&#x7F13;&#x51B2;&#x533A;&#x4E2D;&#x3002;</p>
<h3 id="&#x9AD8;&#x5206;&#x8FA8;&#x7387;&#x4F11;&#x7720;&#x7684;&#x6539;&#x8FDB;&#x7248;&#xFF1A;clock-nanosleep"><a href="#&#x9AD8;&#x5206;&#x8FA8;&#x7387;&#x4F11;&#x7720;&#x7684;&#x6539;&#x8FDB;&#x7248;&#xFF1A;clock-nanosleep" class="headerlink" title="&#x9AD8;&#x5206;&#x8FA8;&#x7387;&#x4F11;&#x7720;&#x7684;&#x6539;&#x8FDB;&#x7248;&#xFF1A;clock_nanosleep()"></a>&#x9AD8;&#x5206;&#x8FA8;&#x7387;&#x4F11;&#x7720;&#x7684;&#x6539;&#x8FDB;&#x7248;&#xFF1A;clock_nanosleep()</h3><p>&#x7C7B;&#x4F3C;&#x4E8E;nanosleep()&#xFF0C;Linux&#x7279;&#x6709;&#x7684;clock_nanosleep()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x4E5F;&#x53EF;&#x4EE5;&#x6682;&#x505C;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#xFF0C;&#x76F4;&#x5230;&#x5386;&#x7ECF;&#x4E00;&#x6BB5;&#x6307;&#x5B9A;&#x7684;&#x65F6;&#x95F4;&#x95F4;&#x9694;&#x540E;&#xFF0C;&#x4EA6;&#x6216;&#x662F;&#x6536;&#x5230;&#x4FE1;&#x53F7;&#x624D;&#x6062;&#x590D;&#x8FD0;&#x884C;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;time.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">clock_nanosleep</span><span class="token punctuation">(</span>clockid_t clockid<span class="token punctuation">,</span> <span class="token keyword">int</span> flags<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">struct</span> timespec <span class="token operator">*</span>request<span class="token punctuation">,</span> <span class="token keyword">struct</span> timespec <span class="token operator">*</span>remain<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x8FD4;&#x56DE;&#x503C;&#xFF1A;&#x82E5;&#x4F11;&#x7720;&#x5230;&#x8981;&#x6C42;&#x7684;&#x65F6;&#x95F4;&#xFF0C;&#x8FD4;&#x56DE;0&#xFF1B;&#x82E5;&#x51FA;&#x9519;&#xFF0C;&#x8FD4;&#x56DE;&#x9519;&#x8BEF;&#x7801;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x53C2;&#x6570;request&#x53CA;remain&#x540C;nanosleep()&#x4E2D;&#x7684;&#x5BF9;&#x5E94;&#x53C2;&#x6570;&#x76EE;&#x7684;&#x76F8;&#x4F3C;&#x3002;<br>TODO.</p>
<h2 id="POSIX&#x95F4;&#x9694;&#x5F0F;&#x5B9A;&#x65F6;&#x5668;"><a href="#POSIX&#x95F4;&#x9694;&#x5F0F;&#x5B9A;&#x65F6;&#x5668;" class="headerlink" title="POSIX&#x95F4;&#x9694;&#x5F0F;&#x5B9A;&#x65F6;&#x5668;"></a>POSIX&#x95F4;&#x9694;&#x5F0F;&#x5B9A;&#x65F6;&#x5668;</h2><p>&#x4F7F;&#x7528;setitimer()&#x6765;&#x8BBE;&#x7F6E;&#x7ECF;&#x5178;UNIX&#x95F4;&#x9694;&#x5F0F;&#x5B9A;&#x65F6;&#x5668;&#xFF0C;&#x4F1A;&#x53D7;&#x5230;&#x5982;&#x4E0B;&#x5236;&#x7EA6;&#x3002;</p>
<ul>
<li>&#x9488;&#x5BF9;ITIMER_REAL&#x3001;ITIMER_VIRTUAL&#x548C;ITIMER_PROF&#x8FD9;3&#x7C7B;&#x5B9A;&#x65F6;&#x5668;&#xFF0C;&#x6BCF;&#x79CD;&#x53EA;&#x80FD;&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x3002;</li>
<li>&#x53EA;&#x80FD;&#x901A;&#x8FC7;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x901A;&#x77E5;&#x5B9A;&#x65F6;&#x5668;&#x5230;&#x671F;&#x3002;&#x53E6;&#x5916;&#xFF0C;&#x4E5F;&#x4E0D;&#x80FD;&#x6539;&#x53D8;&#x5230;&#x671F;&#x65F6;&#x4EA7;&#x751F;&#x7684;&#x4FE1;&#x53F7;&#x3002;</li>
<li>&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x95F4;&#x9694;&#x5F0F;&#x5B9A;&#x65F6;&#x5668;&#x5230;&#x671F;&#x591A;&#x6B21;&#xFF0C;&#x4E14;&#x76F8;&#x5E94;&#x4FE1;&#x53F7;&#x906D;&#x5230;&#x963B;&#x585E;&#x65F6;&#xFF0C;&#x90A3;&#x4E48;&#x4F1A;&#x53EA;&#x8C03;&#x7528;&#x4E00;&#x6B21;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x3002;&#x6362;&#x8A00;&#x4E4B;&#xFF0C;&#x65E0;&#x4ECE;&#x77E5;&#x6653;&#x662F;&#x5426;&#x51FA;&#x73B0;&#x8FC7;&#x5B9A;&#x65F6;&#x5668;&#x6EA2;&#x51FA;&#xFF08;timer overrun&#xFF09;&#x7684;&#x60C5;&#x51B5;&#x3002;</li>
<li>&#x5B9A;&#x65F6;&#x5668;&#x7684;&#x5206;&#x8FA8;&#x7387;&#x53EA;&#x80FD;&#x8FBE;&#x5230;&#x5FAE;&#x79D2;&#x7EA7;&#x3002;&#x4E0D;&#x8FC7;&#xFF0C;&#x4E00;&#x4E9B;&#x7CFB;&#x7EDF;&#x7684;&#x786C;&#x4EF6;&#x65F6;&#x949F;&#x63D0;&#x4F9B;&#x4E86;&#x66F4;&#x4E3A;&#x7CBE;&#x7EC6;&#x7684;&#x65F6;&#x949F;&#x5206;&#x8FA8;&#x7387;&#xFF0C;&#x8F6F;&#x4EF6;&#x6B64;&#x65F6;&#x5E94;&#x91C7;&#x7528;&#x8FD9;&#x4E00;&#x8F83;&#x9AD8;&#x5206;&#x8FA8;&#x7387;&#x3002;</li>
</ul>
<p>POSIX.1b&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x5957;API&#x6765;&#x7A81;&#x7834;&#x8FD9;&#x4E9B;&#x9650;&#x5236;.</p>
<p>POSIX&#x5B9A;&#x65F6;&#x5668;API&#x5C06;&#x5B9A;&#x65F6;&#x5668;&#x751F;&#x547D;&#x5468;&#x671F;&#x5212;&#x5206;&#x4E3A;&#x5982;&#x4E0B;&#x51E0;&#x4E2A;&#x9636;&#x6BB5;&#x3002;</p>
<ul>
<li>&#x4EE5;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;timer_create()&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x5B9A;&#x65F6;&#x5668;&#xFF0C;&#x5E76;&#x5B9A;&#x4E49;&#x5176;&#x5230;&#x671F;&#x65F6;&#x5BF9;&#x8FDB;&#x7A0B;&#x7684;&#x901A;&#x77E5;&#x65B9;&#x6CD5;&#x3002;</li>
<li>&#x4EE5;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;timer_settime()&#x6765;&#x542F;&#x52A8;&#x6216;&#x505C;&#x6B62;&#x4E00;&#x4E2A;&#x5B9A;&#x65F6;&#x5668;&#x3002;</li>
<li>&#x4EE5;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;timer_delete()&#x5220;&#x9664;&#x4E0D;&#x518D;&#x9700;&#x8981;&#x7684;&#x5B9A;&#x65F6;&#x5668;&#x3002;</li>
</ul>
<p>&#x7531;fork()&#x521B;&#x5EFA;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x4E0D;&#x4F1A;&#x7EE7;&#x627F;POSIX&#x5B9A;&#x65F6;&#x5668;&#x3002;&#x8C03;&#x7528;exec()&#x671F;&#x95F4;&#x4EA6;&#x6216;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#x65F6;&#x5C06;&#x505C;&#x6B62;&#x5E76;&#x5220;&#x9664;&#x5B9A;&#x65F6;&#x5668;&#x3002;<br>Linux&#x4E0A;&#xFF0C;&#x8C03;&#x7528;POSIX&#x5B9A;&#x65F6;&#x5668;API&#x7684;&#x7A0B;&#x5E8F;&#x7F16;&#x8BD1;&#x65F6;&#x5E94;&#x4F7F;&#x7528;<code>-lrt</code>&#x9009;&#x9879;&#xFF0C;&#x4ECE;&#x800C;&#x4E0E;librt&#xFF08;&#x5B9E;&#x65F6;&#xFF09;&#x51FD;&#x6570;&#x5E93;&#x76F8;&#x94FE;&#x63A5;&#x3002;</p>
<h3 id="&#x521B;&#x5EFA;&#x5B9A;&#x65F6;&#x5668;&#xFF1A;timer-create"><a href="#&#x521B;&#x5EFA;&#x5B9A;&#x65F6;&#x5668;&#xFF1A;timer-create" class="headerlink" title="&#x521B;&#x5EFA;&#x5B9A;&#x65F6;&#x5668;&#xFF1A;timer_create()"></a>&#x521B;&#x5EFA;&#x5B9A;&#x65F6;&#x5668;&#xFF1A;timer_create()</h3><p>&#x51FD;&#x6570;timer_create()&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x5B9A;&#x65F6;&#x5668;&#xFF0C;&#x5E76;&#x4EE5;&#x7531;clockid&#x6307;&#x5B9A;&#x7684;&#x65F6;&#x949F;&#x6765;&#x8FDB;&#x884C;&#x65F6;&#x95F4;&#x5EA6;&#x91CF;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">define</span> _POSIX_C_SOURCE 199309</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;signal.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;time.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">timer_create</span><span class="token punctuation">(</span>clockid_t clockid<span class="token punctuation">,</span> <span class="token keyword">struct</span> sigevent <span class="token operator">*</span>evp<span class="token punctuation">,</span>  timer_t <span class="token operator">*</span>timerid<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x6210;&#x529F;&#x8FD4;&#x56DE;0&#xFF0C;&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x53C2;&#x6570;evp&#x53EF;&#x51B3;&#x5B9A;&#x5B9A;&#x65F6;&#x5668;&#x5230;&#x671F;&#x65F6;&#x5BF9;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x901A;&#x77E5;&#x65B9;&#x5F0F;&#xFF0C;&#x6307;&#x5411;&#x7C7B;&#x578B;&#x4E3A;sigevent&#x7684;&#x6570;&#x636E;&#x7ED3;&#x6784;&#xFF0C;&#x5177;&#x4F53;&#x5B9A;&#x4E49;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">union</span> sigval<span class="token punctuation">{</span>
<span class="token keyword">int</span> sival_int<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//&#x6574;&#x6570;&#x503C;</span>
<span class="token keyword">void</span> <span class="token operator">*</span>sival_ptr<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//&#x6307;&#x9488;&#x503C;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> sigevent<span class="token punctuation">{</span>
<span class="token keyword">int</span> sigev_notify<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//&#x901A;&#x77E5;&#x65B9;&#x5F0F;</span>
<span class="token keyword">int</span> sigev_signo<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//&#x5B9A;&#x65F6;&#x5668;&#x6EA2;&#x51FA;&#x4FE1;&#x53F7;</span>
<span class="token keyword">union</span> sigval sigev_value<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//&#x4FE1;&#x53F7;&#x503C;</span>
<span class="token keyword">union</span><span class="token punctuation">{</span>
    pid_t _tid<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//ID of thread to be signaled</span>
    <span class="token keyword">struct</span> <span class="token punctuation">{</span>
        <span class="token keyword">void</span><span class="token punctuation">(</span><span class="token operator">*</span>_function<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">union</span> sigval<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//&#x7EBF;&#x7A0B;&#x901A;&#x77E5;&#x51FD;&#x6570;</span>
        <span class="token keyword">void</span> <span class="token operator">*</span>_attribute<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//&#x771F;&#x6B63;&#x7684;&#x201C;pthread_attr_t&#x201D;</span>
    <span class="token punctuation">}</span>_sigev_thread<span class="token punctuation">;</span>
 <span class="token punctuation">}</span>_sigev_un<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token macro property">#<span class="token directive keyword">define</span> sigev_notify_function _sigev_un._sigev_thread._function</span>
<span class="token macro property">#<span class="token directive keyword">define</span> sigev_notify_attributes _sigev_un._sigev_thread._attribute</span>
<span class="token macro property">#<span class="token directive keyword">define</span> sigev_notify_thread_id _sigev_un._tid</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<div class="table-wrapper"><table>
<thead>
<tr>
<th align="left">sigev_notify</th>
<th align="center">&#x89E3;&#x91CA;</th>
</tr>
</thead>
<tbody><tr>
<td align="left">SIGEV_NONE</td>
<td align="center">&#x4E0D;&#x901A;&#x77E5;&#xFF1B;&#x4F7F;&#x7528;timer_gettime()&#x76D1;&#x6D4B;&#x5B9A;&#x65F6;&#x5668;</td>
</tr>
<tr>
<td align="left">SIGEV_SIGNAL</td>
<td align="center">&#x53D1;&#x9001;sigev_signo&#x4FE1;&#x53F7;&#x7ED9;&#x8FDB;&#x7A0B;</td>
</tr>
<tr>
<td align="left">SIGEV_THREAD</td>
<td align="center">&#x8C03;&#x7528;sigev_notify_function&#x4F5C;&#x4E3A;&#x65B0;&#x7EBF;&#x7A0B;&#x7684;&#x542F;&#x52A8;&#x51FD;&#x6570;</td>
</tr>
<tr>
<td align="left">SIGEV_THREAD_ID</td>
<td align="center">&#x53D1;&#x9001;sigev_signo&#x4FE1;&#x53F7;&#x7ED9; sigev_notify_thread_id&#x6240;&#x6807;&#x8BC6;&#x7684;&#x7EBF;&#x7A0B;</td>
</tr>
</tbody></table></div>
<h3 id="&#x914D;&#x5907;&#x548C;&#x89E3;&#x9664;&#x5B9A;&#x65F6;&#x5668;&#xFF1A;timer-settime"><a href="#&#x914D;&#x5907;&#x548C;&#x89E3;&#x9664;&#x5B9A;&#x65F6;&#x5668;&#xFF1A;timer-settime" class="headerlink" title="&#x914D;&#x5907;&#x548C;&#x89E3;&#x9664;&#x5B9A;&#x65F6;&#x5668;&#xFF1A;timer_settime()"></a>&#x914D;&#x5907;&#x548C;&#x89E3;&#x9664;&#x5B9A;&#x65F6;&#x5668;&#xFF1A;timer_settime()</h3><p>&#x4E00;&#x65E6;&#x521B;&#x5EFA;&#x4E86;&#x5B9A;&#x65F6;&#x5668;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;timer_settime()&#x5BF9;&#x5176;&#x8FDB;&#x884C;&#x914D;&#x5907;&#xFF08;&#x542F;&#x52A8;&#xFF09;&#x6216;&#x89E3;&#x9664;&#xFF08;&#x505C;&#x6B62;&#xFF09;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">define</span> _POSIX_C_SOURCE 199309</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;time.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">timer_settime</span><span class="token punctuation">(</span>timer_t <span class="token operator">*</span>timerid<span class="token punctuation">,</span><span class="token keyword">int</span> flags<span class="token punctuation">,</span>cosnt <span class="token keyword">struct</span> itimerspec <span class="token operator">*</span>value<span class="token punctuation">,</span><span class="token keyword">struct</span> itimerspec <span class="token operator">*</span>old_value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x6210;&#x529F;&#x8FD4;&#x56DE;0&#xFF0C;&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1</span>

<span class="token keyword">struct</span> itimerspec<span class="token punctuation">{</span>
    <span class="token keyword">struct</span> timespec it_interval<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//&#x4E2D;&#x65AD;&#x5468;&#x671F;</span>
    <span class="token keyword">struct</span> timespec it_value<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//&#x7B2C;&#x4E00;&#x6B21;&#x6267;&#x884C;&#x65F6;&#x95F4;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> timespec<span class="token punctuation">{</span>
    time_t tv_sec<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//&#x79D2;</span>
    <span class="token keyword">long</span> tv_nsec<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//&#x7EB3;&#x79D2;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x51FD;&#x6570;timer_settime()&#x7684;&#x53C2;&#x6570;timerid&#x662F;&#x4E00;&#x4E2A;&#x5B9A;&#x65F6;&#x5668;&#x53E5;&#x67C4;&#xFF08;handle&#xFF09;&#xFF0C;&#x7531;&#x4E4B;&#x524D;&#x5BF9;timer_create()&#x7684;&#x8C03;&#x7528;&#x8FD4;&#x56DE;&#x3002;</p>
<h3 id="&#x83B7;&#x53D6;&#x5B9A;&#x65F6;&#x5668;&#x7684;&#x5F53;&#x524D;&#x503C;&#xFF1A;timer-gettime"><a href="#&#x83B7;&#x53D6;&#x5B9A;&#x65F6;&#x5668;&#x7684;&#x5F53;&#x524D;&#x503C;&#xFF1A;timer-gettime" class="headerlink" title="&#x83B7;&#x53D6;&#x5B9A;&#x65F6;&#x5668;&#x7684;&#x5F53;&#x524D;&#x503C;&#xFF1A;timer_gettime()"></a>&#x83B7;&#x53D6;&#x5B9A;&#x65F6;&#x5668;&#x7684;&#x5F53;&#x524D;&#x503C;&#xFF1A;timer_gettime()</h3><p>&#x7CFB;&#x7EDF;&#x8C03;&#x7528;timer_gettime()&#x8FD4;&#x56DE;&#x7531;timerid&#x6307;&#x5B9A;POSIX&#x5B9A;&#x65F6;&#x5668;&#x7684;&#x95F4;&#x9694;&#x4EE5;&#x53CA;&#x5269;&#x4F59;&#x65F6;&#x95F4;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">define</span> _POSIX_C_SOURCE 199309</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;time.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">timer_gettime</span><span class="token punctuation">(</span>timer_t <span class="token operator">*</span>timerid<span class="token punctuation">,</span><span class="token keyword">struct</span> itimerspec <span class="token operator">*</span>curr_value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x6210;&#x529F;&#x8FD4;&#x56DE;0&#xFF0C;&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>curr_value&#x6307;&#x9488;&#x6240;&#x6307;&#x5411;&#x7684;itimerspec&#x7ED3;&#x6784;&#x4E2D;&#x8FD4;&#x56DE;&#x7684;&#x662F;&#x65F6;&#x95F4;&#x95F4;&#x9694;&#x4EE5;&#x53CA;&#x8DDD;&#x79BB;&#x4E0B;&#x6B21;&#x5B9A;&#x65F6;&#x5668;&#x5230;&#x671F;&#x7684;&#x65F6;&#x95F4;&#x3002;&#x5373;&#x4F7F;&#x662F;&#x4EE5;TIMER_ABSTIME&#x6807;&#x5FD7;&#x521B;&#x5EFA;&#x7684;&#x7EDD;&#x5BF9;&#x65F6;&#x95F4;&#x5B9A;&#x65F6;&#x5668;&#xFF0C;&#x5728;curr_value.it_value&#x5B57;&#x6BB5;&#x4E2D;&#x8FD4;&#x56DE;&#x7684;&#x4E5F;&#x662F;&#x8DDD;&#x79BB;&#x5B9A;&#x65F6;&#x5668;&#x4E0B;&#x6B21;&#x5230;&#x671F;&#x7684;&#x65F6;&#x95F4;&#x503C;&#x3002;</p>
<p>&#x5982;&#x679C;&#x8FD4;&#x56DE;&#x7ED3;&#x6784;curr_value.it_value&#x7684;&#x4E24;&#x4E2A;&#x5B57;&#x6BB5;&#x5747;&#x4E3A;0&#xFF0C;&#x90A3;&#x4E48;&#x5B9A;&#x65F6;&#x5668;&#x5F53;&#x524D;&#x5904;&#x4E8E;&#x505C;&#x6B62;&#x72B6;&#x6001;&#x3002;&#x5982;&#x679C;&#x8FD4;&#x56DE;&#x7ED3;&#x6784;curr_value.it_interval&#x7684;&#x4E24;&#x4E2A;&#x5B57;&#x6BB5;&#x90FD;&#x662F;0&#xFF0C;&#x90A3;&#x4E48;&#x8BE5;&#x5B9A;&#x65F6;&#x5668;&#x4EC5;&#x5728;curr_value.it_value&#x7ED9;&#x5B9A;&#x7684;&#x65F6;&#x95F4;&#x5230;&#x671F;&#x8FC7;&#x4E00;&#x6B21;&#x3002;</p>
<h3 id="&#x5220;&#x9664;&#x5B9A;&#x65F6;&#x5668;&#xFF1A;timer-delete"><a href="#&#x5220;&#x9664;&#x5B9A;&#x65F6;&#x5668;&#xFF1A;timer-delete" class="headerlink" title="&#x5220;&#x9664;&#x5B9A;&#x65F6;&#x5668;&#xFF1A;timer_delete()"></a>&#x5220;&#x9664;&#x5B9A;&#x65F6;&#x5668;&#xFF1A;timer_delete()</h3><p>&#x6BCF;&#x4E2A;POSIX&#x5B9A;&#x65F6;&#x5668;&#x90FD;&#x4F1A;&#x6D88;&#x8017;&#x5C11;&#x91CF;&#x7CFB;&#x7EDF;&#x8D44;&#x6E90;&#x3002;&#x6240;&#x4EE5;&#xFF0C;&#x4E00;&#x65E6;&#x4F7F;&#x7528;&#x5B8C;&#x6BD5;&#xFF0C;&#x5E94;&#x5F53;&#x7528;timer_delete()&#x6765;&#x79FB;&#x9664;&#x5B9A;&#x65F6;&#x5668;&#x5E76;&#x91CA;&#x653E;&#x8FD9;&#x4E9B;&#x8D44;&#x6E90;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">define</span> _POSIX_C_SOURCE 199309</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;time.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">timer_delete</span><span class="token punctuation">(</span>timer_t <span class="token operator">*</span>timerid<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x6210;&#x529F;&#x8FD4;&#x56DE;0&#xFF0C;&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x53C2;&#x6570;timerid&#x662F;&#x4E4B;&#x524D;&#x8C03;&#x7528;timer_create()&#x65F6;&#x8FD4;&#x56DE;&#x7684;&#x53E5;&#x67C4;&#x3002;&#x5BF9;&#x4E8E;&#x5DF2;&#x542F;&#x52A8;&#x7684;&#x5B9A;&#x65F6;&#x5668;&#xFF0C;&#x4F1A;&#x5728;&#x79FB;&#x9664;&#x524D;&#x81EA;&#x52A8;&#x5C06;&#x5176;&#x505C;&#x6B62;&#x3002;&#x5982;&#x679C;&#x56E0;&#x5B9A;&#x65F6;&#x5668;&#x5230;&#x671F;&#x800C;&#x5DF2;&#x7ECF;&#x5B58;&#x5728;&#x5F85;&#x5B9A;&#xFF08;pending&#xFF09;&#x4FE1;&#x53F7;&#xFF0C;&#x90A3;&#x4E48;&#x4FE1;&#x53F7;&#x4F1A;&#x4FDD;&#x6301;&#x8FD9;&#x4E00;&#x72B6;&#x6001;&#x3002;&#xFF08;SUSv3&#x5BF9;&#x6B64;&#x5E76;&#x672A;&#x52A0;&#x4EE5;&#x89C4;&#x8303;&#xFF0C;&#x6240;&#x4EE5;&#x5176;&#x4ED6;&#x7684;&#x4E00;&#x4E9B;UNIX&#x5B9E;&#x73B0;&#x53EF;&#x80FD;&#x4F1A;&#x6709;&#x4E0D;&#x540C;&#x884C;&#x4E3A;&#x3002;&#xFF09;&#x5F53;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#x65F6;&#xFF0C;&#x4F1A;&#x81EA;&#x52A8;&#x5220;&#x9664;&#x6240;&#x6709;&#x5B9A;&#x65F6;&#x5668;&#x3002;</p>
<h3 id="&#x901A;&#x8FC7;&#x4FE1;&#x53F7;&#x53D1;&#x51FA;&#x901A;&#x77E5;"><a href="#&#x901A;&#x8FC7;&#x4FE1;&#x53F7;&#x53D1;&#x51FA;&#x901A;&#x77E5;" class="headerlink" title="&#x901A;&#x8FC7;&#x4FE1;&#x53F7;&#x53D1;&#x51FA;&#x901A;&#x77E5;"></a>&#x901A;&#x8FC7;&#x4FE1;&#x53F7;&#x53D1;&#x51FA;&#x901A;&#x77E5;</h3><p>todo.</p>
<h3 id="&#x5B9A;&#x65F6;&#x5668;&#x6EA2;&#x51FA;"><a href="#&#x5B9A;&#x65F6;&#x5668;&#x6EA2;&#x51FA;" class="headerlink" title="&#x5B9A;&#x65F6;&#x5668;&#x6EA2;&#x51FA;"></a>&#x5B9A;&#x65F6;&#x5668;&#x6EA2;&#x51FA;</h3><p>&#x5047;&#x8BBE;&#x5DF2;&#x7ECF;&#x9009;&#x62E9;&#x901A;&#x8FC7;&#x4FE1;&#x53F7;&#xFF08;&#x5373;sigev_notify&#x4E3A;SIGEV_SIGNAL&#xFF09;&#x4F20;&#x9012;&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x63A5;&#x6536;&#x5B9A;&#x65F6;&#x5668;&#x5230;&#x671F;&#x901A;&#x77E5;&#x3002;&#x8FDB;&#x4E00;&#x6B65;&#x5047;&#x8BBE;&#xFF0C;&#x5728;&#x6355;&#x83B7;&#x6216;&#x63A5;&#x6536;&#x76F8;&#x5173;&#x4FE1;&#x53F7;&#x4E4B;&#x524D;&#xFF0C;&#x5B9A;&#x65F6;&#x5668;&#x5230;&#x671F;&#x591A;&#x6B21;&#x3002;&#x8FD9;&#x53EF;&#x80FD;&#x662F;&#x56E0;&#x4E3A;&#x8FDB;&#x7A0B;&#x518D;&#x6B21;&#x83B7;&#x5F97;&#x8C03;&#x5EA6;&#x524D;&#x7684;&#x5EF6;&#x65F6;&#x6240;&#x81F4;&#x3002;&#x53E6;&#x5916;&#xFF0C;&#x4E0D;&#x8BBA;&#x662F;&#x76F4;&#x63A5;&#x8C03;&#x7528;sigprocmask()&#xFF0C;&#x8FD8;&#x662F;&#x5728;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x91CC;&#x6697;&#x4E2D;&#x5904;&#x7406;&#xFF0C;&#x4E5F;&#x90FD;&#x6709;&#x53EF;&#x80FD;&#x5835;&#x585E;&#x76F8;&#x5173;&#x4FE1;&#x53F7;&#x7684;&#x53D1;&#x9001;&#x3002;&#x5982;&#x4F55;&#x77E5;&#x9053;&#x53D1;&#x751F;&#x4E86;&#x8FD9;&#x4E9B;&#x5B9A;&#x65F6;&#x5668;&#x6EA2;&#x51FA;&#x5462;&#xFF1F;<br>&#x4E5F;&#x8BB8;&#x4F1A;&#x8BA4;&#x4E3A;&#x4F7F;&#x7528;&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;&#x6709;&#x52A9;&#x4E8E;&#x89E3;&#x51B3;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x56E0;&#x4E3A;&#x53EF;&#x4EE5;&#x5BF9;&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;&#x7684;&#x591A;&#x4E2A;&#x5B9E;&#x4F8B;&#x8FDB;&#x884C;&#x6392;&#x961F;&#x3002;&#x4E0D;&#x8FC7;&#xFF0C;&#x7531;&#x4E8E;&#x5BF9;&#x6392;&#x961F;&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;&#x6709;&#x6570;&#x91CF;&#x4E0A;&#x7684;&#x9650;&#x5236;&#xFF0C;&#x7ED3;&#x679C;&#x8BC1;&#x660E;&#x8FD9;&#x79CD;&#x65B9;&#x6CD5;&#x4E5F;&#x65E0;&#x6CD5;&#x594F;&#x6548;&#x3002;&#x6240;&#x4EE5;POSIX.1b&#x59D4;&#x5458;&#x4F1A;&#x9009;&#x7528;&#x4E86;&#x53E6;&#x4E00;&#x79CD;&#x65B9;&#x6CD5;&#xFF1A;&#x4E00;&#x65E6;&#x9009;&#x62E9;&#x901A;&#x8FC7;&#x4FE1;&#x53F7;&#x6765;&#x63A5;&#x6536;&#x5B9A;&#x65F6;&#x5668;&#x901A;&#x77E5;&#xFF0C;&#x90A3;&#x4E48;&#x5373;&#x4FBF;&#x7528;&#x4E86;&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;&#xFF0C;&#x4E5F;&#x7EDD;&#x4E0D;&#x4F1A;&#x5BF9;&#x8BE5;&#x4FE1;&#x53F7;&#x7684;&#x591A;&#x4E2A;&#x5B9E;&#x4F8B;&#x8FDB;&#x884C;&#x6392;&#x961F;&#x3002;&#x76F8;&#x53CD;&#xFF0C;&#x5728;&#x63A5;&#x6536;&#x4FE1;&#x53F7;&#x540E;&#xFF08;&#x65E0;&#x8BBA;&#x662F;&#x901A;&#x8FC7;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x8FD8;&#x662F;&#x8C03;&#x7528;sigwaitinfo()&#xFF09;&#xFF0C;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#x5B9A;&#x65F6;&#x5668;&#x6EA2;&#x51FA;&#x8BA1;&#x6570;&#xFF0C;&#x5373;&#x5728;&#x4FE1;&#x53F7;&#x751F;&#x6210;&#x4E0E;&#x63A5;&#x6536;&#x4E4B;&#x95F4;&#x53D1;&#x751F;&#x7684;&#x5B9A;&#x65F6;&#x5668;&#x5230;&#x671F;&#x989D;&#x5916;&#x6B21;&#x6570;&#x3002;&#x5982;&#x679C;&#x4E0A;&#x6B21;&#x6536;&#x5230;&#x4FE1;&#x53F7;&#x540E;&#x5B9A;&#x65F6;&#x5668;&#x53D1;&#x751F;&#x4E86;3&#x6B21;&#x5230;&#x671F;&#xFF0C;&#x90A3;&#x4E48;&#x6EA2;&#x51FA;&#x8BA1;&#x6570;&#x662F;2&#x3002;</p>
<p>&#x63A5;&#x6536;&#x5230;&#x5B9A;&#x65F6;&#x5668;&#x4FE1;&#x53F7;&#x4E4B;&#x540E;&#xFF0C;&#x6709;&#x4E24;&#x79CD;&#x65B9;&#x6CD5;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#x5B9A;&#x65F6;&#x5668;&#x6EA2;&#x51FA;&#x503C;&#x3002;</p>
<ul>
<li>&#x8C03;&#x7528;timer_getoverrun()&#x3002;&#x8FD9;&#x662F;&#x7531;SUSv3&#x6307;&#x5B9A;&#x53BB;&#x83B7;&#x53D6;&#x6EA2;&#x51FA;&#x8BA1;&#x6570;&#x7684;&#x65B9;&#x6CD5;&#x3002;</li>
<li>&#x4F7F;&#x7528;&#x968F;&#x4FE1;&#x53F7;&#x4E00;&#x540C;&#x8FD4;&#x56DE;&#x7684;&#x7ED3;&#x6784; siginfo_t &#x4E2D;&#x7684; si_overrun &#x5B57;&#x6BB5;&#x503C;&#x3002;&#x8FD9;&#x79CD;&#x65B9;&#x6CD5;&#x53EF;&#x4EE5;&#x907F;&#x514D;timer_getoverrun()&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5F00;&#x9500;&#xFF0C;&#x4F46;&#x540C;&#x65F6;&#x4E5F;&#x662F;&#x4E00;&#x79CD;Linux&#x6269;&#x5C55;&#x65B9;&#x6CD5;&#xFF0C;&#x65E0;&#x6CD5;&#x79FB;&#x690D;&#x3002;</li>
</ul>
<p>&#x6BCF;&#x6B21;&#x6536;&#x5230;&#x5B9A;&#x65F6;&#x5668;&#x4FE1;&#x53F7;&#x540E;&#xFF0C;&#x90FD;&#x4F1A;&#x91CD;&#x7F6E;&#x5B9A;&#x65F6;&#x5668;&#x6EA2;&#x51FA;&#x8BA1;&#x6570;&#x3002;&#x82E5;&#x81EA;&#x5904;&#x7406;&#x6216;&#x63A5;&#x6536;&#x5B9A;&#x65F6;&#x5668;&#x4FE1;&#x53F7;&#x4E4B;&#x540E;&#xFF0C;&#x5B9A;&#x65F6;&#x5668;&#x4EC5;&#x5230;&#x671F;&#x4E00;&#x6B21;&#xFF0C;&#x5219;&#x6EA2;&#x51FA;&#x8BA1;&#x6570;&#x4E3A;0&#xFF08;&#x5373;&#x65E0;&#x6EA2;&#x51FA;&#xFF09;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">define</span> _POSIX_C_SOURCE 199309</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;time.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">timer_getoverrun</span><span class="token punctuation">(</span>timer_t timerid<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x6210;&#x529F;&#x8FD4;&#x56DE;&#x6EA2;&#x51FA;&#x6B21;&#x6570;&#xFF0C;&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x51FD;&#x6570;timer_getoverrun()&#x8FD4;&#x56DE;&#x7531;&#x53C2;&#x6570;timerid&#x6307;&#x5B9A;&#x5B9A;&#x65F6;&#x5668;&#x7684;&#x6EA2;&#x51FA;&#x503C;&#x3002;<br>&#x6839;&#x636E;SUSv3&#x89C4;&#x5B9A;&#xFF0C;&#x51FD;&#x6570;timer_getoverrun()&#x662F;&#x5F02;&#x6B65;&#x4FE1;&#x53F7;&#x5B89;&#x5168;&#x7684;&#x51FD;&#x6570;&#x4E4B;&#x4E00;&#xFF0C;&#x6545;&#x800C;&#x5728;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x51FD;&#x6570;&#x5185;&#x90E8;&#x8C03;&#x7528;&#x4E5F;&#x662F;&#x5B89;&#x5168;&#x7684;&#x3002;</p>
<h3 id="&#x901A;&#x8FC7;&#x7EBF;&#x7A0B;&#x6765;&#x901A;&#x77E5;"><a href="#&#x901A;&#x8FC7;&#x7EBF;&#x7A0B;&#x6765;&#x901A;&#x77E5;" class="headerlink" title="&#x901A;&#x8FC7;&#x7EBF;&#x7A0B;&#x6765;&#x901A;&#x77E5;"></a>&#x901A;&#x8FC7;&#x7EBF;&#x7A0B;&#x6765;&#x901A;&#x77E5;</h3><p>TODO.</p>
<h3 id="&#x5229;&#x7528;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x8FDB;&#x884C;&#x901A;&#x77E5;&#x7684;&#x5B9A;&#x65F6;&#x5668;&#xFF1A;timerfd-API"><a href="#&#x5229;&#x7528;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x8FDB;&#x884C;&#x901A;&#x77E5;&#x7684;&#x5B9A;&#x65F6;&#x5668;&#xFF1A;timerfd-API" class="headerlink" title="&#x5229;&#x7528;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x8FDB;&#x884C;&#x901A;&#x77E5;&#x7684;&#x5B9A;&#x65F6;&#x5668;&#xFF1A;timerfd API"></a>&#x5229;&#x7528;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x8FDB;&#x884C;&#x901A;&#x77E5;&#x7684;&#x5B9A;&#x65F6;&#x5668;&#xFF1A;timerfd API</h3><p>&#x59CB;&#x4E8E;&#x7248;&#x672C;2.6.25&#xFF0C;Linux&#x5185;&#x6838;&#x63D0;&#x4F9B;&#x4E86;&#x53E6;&#x4E00;&#x79CD;&#x521B;&#x5EFA;&#x5B9A;&#x65F6;&#x5668;&#x7684;API&#x3002;Linux&#x7279;&#x6709;&#x7684;timerfd API&#xFF0C;&#x53EF;&#x4ECE;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x4E2D;&#x8BFB;&#x53D6;&#x5176;&#x6240;&#x521B;&#x5EFA;&#x5B9A;&#x65F6;&#x5668;&#x7684;&#x5230;&#x671F;&#x901A;&#x77E5;&#x3002;&#x56E0;&#x4E3A;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;select()&#x3001;poll()&#x548C;epoll()&#x5C06;&#x8FD9;&#x79CD;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x4F1A;&#x540C;&#x5176;&#x4ED6;&#x63CF;&#x8FF0;&#x7B26;&#x4E00;&#x540C;&#x8FDB;&#x884C;&#x76D1;&#x63A7;&#xFF0C;&#x6240;&#x4EE5;&#x975E;&#x5E38;&#x5B9E;&#x7528;&#x3002;&#xFF08;&#x81F3;&#x4E8E;&#x8BF4;&#x672C;&#x7AE0;&#x8BA8;&#x8BBA;&#x7684;&#x5176;&#x4ED6;&#x5B9A;&#x65F6;&#x5668;API&#xFF0C;&#x60F3;&#x8981;&#x628A;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x5B9A;&#x65F6;&#x5668;&#x4E0E;&#x4E00;&#x7EC4;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x653E;&#x5728;&#x4E00;&#x8D77;&#x540C;&#x65F6;&#x76D1;&#x6D4B;&#xFF0C;&#x53EF;&#x4E0D;&#x662F;&#x4EF6;&#x5BB9;&#x6613;&#x7684;&#x4E8B;&#x3002;&#xFF09;</p>
<p>&#x65B0;&#x52A0;&#x5165;&#x7684;&#x7B2C;1&#x4E2A;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x662F;timerfd_create()&#xFF0C;&#x5B83;&#x4F1A;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x5B9A;&#x65F6;&#x5668;&#x5BF9;&#x8C61;&#xFF0C;&#x5E76;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x6307;&#x4EE3;&#x8BE5;&#x5BF9;&#x8C61;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;sys/timerfd.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">timerfd_create</span><span class="token punctuation">(</span><span class="token keyword">int</span> clockid<span class="token punctuation">,</span><span class="token keyword">int</span> flags<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x6210;&#x529F;&#x8FD4;&#x56DE;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#xFF0C;&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x53C2;&#x6570;clockid&#x7684;&#x503C;&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&#x4E3A;CLOCK_REALTIME&#x6216;CLOCK_MONOTONIC.<br>timerfd_create()&#x7684;&#x6700;&#x521D;&#x5B9E;&#x73B0;&#x5C06;&#x53C2;&#x6570;flags&#x9884;&#x7559;&#x4F9B;&#x672A;&#x6765;&#x4F7F;&#x7528;&#xFF0C;&#x5FC5;&#x987B;&#x8BBE;&#x7F6E;&#x4E3A;0&#x3002;&#x4E0D;&#x8FC7;&#xFF0C;Linux&#x5185;&#x6838;&#x4ECE;2.6.27&#x7248;&#x672C;&#x5F00;&#x59CB;&#x652F;&#x6301;&#x4E0B;&#x9762;&#x4E24;&#x79CD;flags&#x6807;&#x5FD7;&#x3002;<br><code>TFD_CLOEXEC</code>&#x4E3A;&#x65B0;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x8BBE;&#x7F6E;&#x8FD0;&#x884C;&#x65F6;&#x5173;&#x95ED;&#x6807;&#x5FD7;&#xFF08;FD_CLOEXEC&#xFF09;&#x3002;&#x4E0E;4.3.1&#x8282;&#x4ECB;&#x7ECD;&#x7684;open()&#x6807;&#x5FD7;O_CLOEXEC&#x9002;&#x7528;&#x4E8E;&#x76F8;&#x540C;&#x60C5;&#x51B5;&#x3002;<br><code>TFD_NONBLOCK</code>&#x4E3A;&#x5E95;&#x5C42;&#x7684;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x8BBE;&#x7F6E;O_NONBLOCK&#x6807;&#x5FD7;&#xFF0C;&#x968F;&#x540E;&#x7684;&#x8BFB;&#x64CD;&#x4F5C;&#x5C06;&#x662F;&#x975E;&#x963B;&#x585E;&#x5F0F;&#x7684;&#x3002;&#x8FD9;&#x6837;&#x8BBE;&#x7F6E;&#x7701;&#x5374;&#x4E86;&#x5BF9;fcntl()&#x7684;&#x989D;&#x5916;&#x8C03;&#x7528;&#xFF0C;&#x5374;&#x80FD;&#x8FBE;&#x5230;&#x76F8;&#x540C;&#x6548;&#x679C;&#x3002;<br>timerfd_create()&#x521B;&#x5EFA;&#x7684;&#x5B9A;&#x65F6;&#x5668;&#x4F7F;&#x7528;&#x5B8C;&#x6BD5;&#x540E;&#xFF0C;&#x5E94;&#x8C03;&#x7528;close()&#x5173;&#x95ED;&#x76F8;&#x5E94;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#xFF0C;&#x4EE5;&#x4FBF;&#x4E8E;&#x5185;&#x6838;&#x80FD;&#x591F;&#x91CA;&#x653E;&#x4E0E;&#x5B9A;&#x65F6;&#x5668;&#x76F8;&#x5173;&#x7684;&#x8D44;&#x6E90;&#x3002;</p>
<p>&#x7CFB;&#x7EDF;&#x8C03;&#x7528;timerfd_settime()&#x53EF;&#x4EE5;&#x914D;&#x5907;&#xFF08;&#x542F;&#x52A8;&#xFF09;&#x6216;&#x89E3;&#x9664;&#xFF08;&#x505C;&#x6B62;&#xFF09;&#x7531;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;fd&#x6240;&#x6307;&#x4EE3;&#x7684;&#x5B9A;&#x65F6;&#x5668;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;sys/timerfd.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">timerfd_settime</span><span class="token punctuation">(</span><span class="token keyword">int</span> fd<span class="token punctuation">,</span><span class="token keyword">int</span> flags<span class="token punctuation">,</span><span class="token keyword">const</span> <span class="token keyword">struct</span> itimerspec <span class="token operator">*</span>new_value<span class="token punctuation">,</span><span class="token keyword">struct</span> itimerspec <span class="token operator">*</span>old_value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x6210;&#x529F;&#x8FD4;&#x56DE;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#xFF0C;&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x7CFB;&#x7EDF;&#x8C03;&#x7528;timerfd_gettime()&#x8FD4;&#x56DE;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;fd&#x6240;&#x6807;&#x8BC6;&#x5B9A;&#x65F6;&#x5668;&#x7684;&#x95F4;&#x9694;&#x53CA;&#x5269;&#x4F59;&#x65F6;&#x95F4;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;sys/timerfd.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">timerfd_gettime</span><span class="token punctuation">(</span><span class="token keyword">int</span> fd<span class="token punctuation">,</span><span class="token keyword">struct</span> itimerspec <span class="token operator">*</span>curr_value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x6210;&#x529F;&#x8FD4;&#x56DE;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#xFF0C;&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="timerfd&#x4E0E;fork-&#x53CA;exec-&#x4E4B;&#x95F4;&#x7684;&#x4EA4;&#x4E92;"><a href="#timerfd&#x4E0E;fork-&#x53CA;exec-&#x4E4B;&#x95F4;&#x7684;&#x4EA4;&#x4E92;" class="headerlink" title="timerfd&#x4E0E;fork()&#x53CA;exec()&#x4E4B;&#x95F4;&#x7684;&#x4EA4;&#x4E92;"></a>timerfd&#x4E0E;fork()&#x53CA;exec()&#x4E4B;&#x95F4;&#x7684;&#x4EA4;&#x4E92;</h3><p>&#x8C03;&#x7528;fork()&#x671F;&#x95F4;&#xFF0C;&#x5B50;&#x8FDB;&#x7A0B;&#x4F1A;&#x7EE7;&#x627F;timerfd_create()&#x6240;&#x521B;&#x5EFA;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x7684;&#x62F7;&#x8D1D;&#x3002;&#x8FD9;&#x4E9B;&#x63CF;&#x8FF0;&#x7B26;&#x4E0E;&#x7236;&#x8FDB;&#x7A0B;&#x7684;&#x5BF9;&#x5E94;&#x63CF;&#x8FF0;&#x7B26;&#x5747;&#x6307;&#x4EE3;&#x76F8;&#x540C;&#x7684;&#x5B9A;&#x65F6;&#x5668;&#x5BF9;&#x8C61;&#xFF0C;&#x4EFB;&#x4E00;&#x8FDB;&#x7A0B;&#x90FD;&#x53EF;&#x8BFB;&#x53D6;&#x5B9A;&#x65F6;&#x5668;&#x7684;&#x5230;&#x671F;&#x4FE1;&#x606F;&#x3002;<br>timerfd_create()&#x521B;&#x5EFA;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x80FD;&#x8DE8;&#x8D8A;exec()&#x5F97;&#x4EE5;&#x4FDD;&#x5B58;&#xFF08;&#x9664;&#x975E;&#x5C06;&#x63CF;&#x8FF0;&#x7B26;&#x7F6E;&#x4E3A;&#x8FD0;&#x884C;&#x65F6;&#x5173;&#x95ED;&#xFF09;&#xFF0C;&#x5DF2;&#x914D;&#x5907;&#x7684;&#x5B9A;&#x65F6;&#x5668;&#x5728;exec()&#x4E4B;&#x540E;&#x4F1A;&#x7EE7;&#x7EED;&#x751F;&#x6210;&#x5230;&#x671F;&#x901A;&#x77E5;&#x3002;</p>
<h3 id="&#x4ECE;timerfd&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x8BFB;&#x53D6;"><a href="#&#x4ECE;timerfd&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x8BFB;&#x53D6;" class="headerlink" title="&#x4ECE;timerfd&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x8BFB;&#x53D6;"></a>&#x4ECE;timerfd&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x8BFB;&#x53D6;</h3><p>&#x4E00;&#x65E6;&#x4EE5;timerfd_settime()&#x542F;&#x52A8;&#x4E86;&#x5B9A;&#x65F6;&#x5668;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x4ECE;&#x76F8;&#x5E94;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x4E2D;&#x8C03;&#x7528;read()&#x6765;&#x8BFB;&#x53D6;&#x5B9A;&#x65F6;&#x5668;&#x7684;&#x5230;&#x671F;&#x4FE1;&#x606F;&#x3002;&#x51FA;&#x4E8E;&#x8FD9;&#x4E00;&#x76EE;&#x7684;&#xFF0C;&#x4F20;&#x7ED9;read()&#x7684;&#x7F13;&#x51B2;&#x533A;&#x5FC5;&#x987B;&#x8DB3;&#x4EE5;&#x5BB9;&#x7EB3;&#x4E00;&#x4E2A;&#x65E0;&#x7B26;&#x53F7;8&#x5B57;&#x8282;&#x6574;&#x578B;&#xFF08;uint64_t&#xFF09;&#x6570;&#x3002;</p>
<h1 id="&#x8FDB;&#x7A0B;&#xFF1A;&#x8FDB;&#x7A0B;&#x53CA;&#x8FDB;&#x7A0B;&#x7684;&#x521B;&#x5EFA;"><a href="#&#x8FDB;&#x7A0B;&#xFF1A;&#x8FDB;&#x7A0B;&#x53CA;&#x8FDB;&#x7A0B;&#x7684;&#x521B;&#x5EFA;" class="headerlink" title="&#x8FDB;&#x7A0B;&#xFF1A;&#x8FDB;&#x7A0B;&#x53CA;&#x8FDB;&#x7A0B;&#x7684;&#x521B;&#x5EFA;"></a>&#x8FDB;&#x7A0B;&#xFF1A;&#x8FDB;&#x7A0B;&#x53CA;&#x8FDB;&#x7A0B;&#x7684;&#x521B;&#x5EFA;</h1><p>&#x5728;&#x8BF8;&#x591A;&#x5E94;&#x7528;&#x4E2D;&#xFF0C;&#x521B;&#x5EFA;&#x591A;&#x4E2A;&#x8FDB;&#x7A0B;&#x662F;&#x4EFB;&#x52A1;&#x5206;&#x89E3;&#x65F6;&#x884C;&#x4E4B;&#x6709;&#x6548;&#x7684;&#x65B9;&#x6CD5;&#x3002;<br>&#x4F8B;&#x5982;&#xFF0C;&#x67D0;&#x4E00;&#x7F51;&#x7EDC;&#x670D;&#x52A1;&#x5668;&#x8FDB;&#x7A0B;&#x53EF;&#x5728;&#x4FA6;&#x542C;&#x5BA2;&#x6237;&#x7AEF;&#x8BF7;&#x6C42;&#x7684;&#x540C;&#x65F6;&#xFF0C;&#x4E3A;&#x5904;&#x7406;&#x6BCF;&#x4E00;&#x8BF7;&#x6C42;&#x800C;&#x521B;&#x5EFA;&#x4E00;&#x65B0;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#xFF0C;&#x4E0E;&#x6B64;&#x540C;&#x65F6;&#xFF0C;&#x670D;&#x52A1;&#x5668;&#x8FDB;&#x7A0B;&#x4F1A;&#x7EE7;&#x7EED;&#x4FA6;&#x542C;&#x66F4;&#x591A;&#x7684;&#x5BA2;&#x6237;&#x7AEF;&#x8FDE;&#x63A5;&#x8BF7;&#x6C42;&#x3002;&#x4EE5;&#x6B64;&#x7C7B;&#x624B;&#x6CD5;&#x5206;&#x89E3;&#x4EFB;&#x52A1;&#xFF0C;&#x901A;&#x5E38;&#x4F1A;&#x7B80;&#x5316;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x8BBE;&#x8BA1;&#xFF0C;&#x540C;&#x65F6;&#x63D0;&#x9AD8;&#x4E86;&#x7CFB;&#x7EDF;&#x7684;&#x5E76;&#x53D1;&#x6027;&#x3002;&#xFF08;&#x5373;&#xFF0C;&#x53EF;&#x540C;&#x65F6;&#x5904;&#x7406;&#x66F4;&#x591A;&#x7684;&#x4EFB;&#x52A1;&#x6216;&#x8BF7;&#x6C42;&#x3002;&#xFF09;</p>
<h2 id="&#x8FDB;&#x7A0B;&#x548C;&#x7A0B;&#x5E8F;"><a href="#&#x8FDB;&#x7A0B;&#x548C;&#x7A0B;&#x5E8F;" class="headerlink" title="&#x8FDB;&#x7A0B;&#x548C;&#x7A0B;&#x5E8F;"></a>&#x8FDB;&#x7A0B;&#x548C;&#x7A0B;&#x5E8F;</h2><p>&#x8FDB;&#x7A0B;&#xFF08;process&#xFF09;&#x662F;&#x4E00;&#x4E2A;&#x53EF;&#x6267;&#x884C;&#x7A0B;&#x5E8F;&#xFF08;program&#xFF09;&#x7684;&#x5B9E;&#x4F8B;&#x3002;</p>
<ul>
<li>&#x4E8C;&#x8FDB;&#x5236;&#x683C;&#x5F0F;&#x6807;&#x8BC6;&#xFF1A;&#x6BCF;&#x4E2A;&#x7A0B;&#x5E8F;&#x6587;&#x4EF6;&#x90FD;&#x5305;&#x542B;&#x7528;&#x4E8E;&#x63CF;&#x8FF0;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x683C;&#x5F0F;&#x7684;&#x5143;&#x4FE1;&#x606F;&#xFF08;metainformation&#xFF09;&#x3002;&#x5185;&#x6838;&#xFF08;kernel&#xFF09;&#x5229;&#x7528;&#x6B64;&#x4FE1;&#x606F;&#x6765;&#x89E3;&#x91CA;&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x5176;&#x4ED6;&#x4FE1;&#x606F;&#x3002;&#x5386;&#x53F2;&#x4E0A;&#xFF0C;UNIX&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x66FE;&#x6709;&#x4E24;&#x79CD;&#x5E7F;&#x6CDB;&#x4F7F;&#x7528;&#x7684;&#x683C;&#x5F0F;&#xFF0C;&#x5206;&#x522B;&#x4E3A;&#x6700;&#x521D;&#x7684;a.out&#xFF08;&#x6C47;&#x7F16;&#x7A0B;&#x5E8F;&#x8F93;&#x51FA;&#xFF09;&#x548C;&#x66F4;&#x52A0;&#x590D;&#x6742;&#x7684;COFF&#xFF08;&#x901A;&#x7528;&#x5BF9;&#x8C61;&#x6587;&#x4EF6;&#x683C;&#x5F0F;&#xFF09;&#x3002;&#x73B0;&#x5728;&#xFF0C;&#x5927;&#x591A;&#x6570;UNIX&#x5B9E;&#x73B0;&#xFF08;&#x5305;&#x62EC;Linux&#xFF09;&#x91C7;&#x7528;&#x53EF;&#x6267;&#x884C;&#x8FDE;&#x63A5;&#x683C;&#x5F0F;&#xFF08;ELF&#xFF09;&#xFF0C;&#x8FD9;&#x4E00;&#x6587;&#x4EF6;&#x683C;&#x5F0F;&#x6BD4;&#x8001;&#x7248;&#x672C;&#x683C;&#x5F0F;&#x5177;&#x6709;&#x66F4;&#x591A;&#x4F18;&#x70B9;&#x3002;</li>
<li>&#x673A;&#x5668;&#x8BED;&#x8A00;&#x6307;&#x4EE4;&#xFF1A;&#x5BF9;&#x7A0B;&#x5E8F;&#x7B97;&#x6CD5;&#x8FDB;&#x884C;&#x7F16;&#x7801;&#x3002;</li>
<li>&#x7A0B;&#x5E8F;&#x5165;&#x53E3;&#x5730;&#x5740;&#xFF1A;&#x6807;&#x8BC6;&#x7A0B;&#x5E8F;&#x5F00;&#x59CB;&#x6267;&#x884C;&#x65F6;&#x7684;&#x8D77;&#x59CB;&#x6307;&#x4EE4;&#x4F4D;&#x7F6E;&#x3002;</li>
<li>&#x6570;&#x636E;&#xFF1A;&#x7A0B;&#x5E8F;&#x6587;&#x4EF6;&#x5305;&#x542B;&#x7684;&#x53D8;&#x91CF;&#x521D;&#x59CB;&#x503C;&#x548C;&#x7A0B;&#x5E8F;&#x4F7F;&#x7528;&#x7684;&#x5B57;&#x9762;&#x5E38;&#x91CF;&#xFF08;literal constant&#xFF09;&#x503C;&#xFF08;&#x6BD4;&#x5982;&#x5B57;&#x7B26;&#x4E32;&#xFF09;&#x3002;</li>
<li>&#x7B26;&#x53F7;&#x8868;&#x53CA;&#x91CD;&#x5B9A;&#x4F4D;&#x8868;&#xFF1A;&#x63CF;&#x8FF0;&#x7A0B;&#x5E8F;&#x4E2D;&#x51FD;&#x6570;&#x548C;&#x53D8;&#x91CF;&#x7684;&#x4F4D;&#x7F6E;&#x53CA;&#x540D;&#x79F0;&#x3002;&#x8FD9;&#x4E9B;&#x8868;&#x683C;&#x6709;&#x591A;&#x79CD;&#x7528;&#x9014;&#xFF0C;&#x5176;&#x4E2D;&#x5305;&#x62EC;&#x8C03;&#x8BD5;&#x548C;&#x8FD0;&#x884C;&#x65F6;&#x7684;&#x7B26;&#x53F7;&#x89E3;&#x6790;&#xFF08;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#xFF09;&#x3002;</li>
<li>&#x5171;&#x4EAB;&#x5E93;&#x548C;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x4FE1;&#x606F;&#xFF1A;&#x7A0B;&#x5E8F;&#x6587;&#x4EF6;&#x6240;&#x5305;&#x542B;&#x7684;&#x4E00;&#x4E9B;&#x5B57;&#x6BB5;&#xFF0C;&#x5217;&#x51FA;&#x4E86;&#x7A0B;&#x5E8F;&#x8FD0;&#x884C;&#x65F6;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x7684;&#x5171;&#x4EAB;&#x5E93;&#xFF0C;&#x4EE5;&#x53CA;&#x52A0;&#x8F7D;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x7684;&#x8DEF;&#x5F84;&#x540D;&#x3002;</li>
<li>&#x5176;&#x4ED6;&#x4FE1;&#x606F;&#xFF1A;&#x7A0B;&#x5E8F;&#x6587;&#x4EF6;&#x8FD8;&#x5305;&#x542B;&#x8BB8;&#x591A;&#x5176;&#x4ED6;&#x4FE1;&#x606F;&#xFF0C;&#x7528;&#x4EE5;&#x63CF;&#x8FF0;&#x5982;&#x4F55;&#x521B;&#x5EFA;&#x8FDB;&#x7A0B;&#x3002;</li>
</ul>
<h3 id="&#x8FDB;&#x7A0B;&#x53F7;"><a href="#&#x8FDB;&#x7A0B;&#x53F7;" class="headerlink" title="&#x8FDB;&#x7A0B;&#x53F7;"></a>&#x8FDB;&#x7A0B;&#x53F7;</h3><p>&#x53EF;&#x4EE5;&#x7528;&#x4E00;&#x4E2A;&#x7A0B;&#x5E8F;&#x6765;&#x521B;&#x5EFA;&#x8BB8;&#x591A;&#x8FDB;&#x7A0B;&#x3002;<br>&#x4E00;&#x65E6;&#x8FDB;&#x7A0B;&#x53F7;&#x8FBE;&#x5230;32767&#xFF0C;&#x4F1A;&#x5C06;&#x8FDB;&#x7A0B;&#x53F7;&#x8BA1;&#x6570;&#x5668;&#x91CD;&#x7F6E;&#x4E3A;300&#xFF0C;&#x800C;&#x4E0D;&#x662F;1&#x3002;&#x4E4B;&#x6240;&#x4EE5;&#x5982;&#x6B64;&#xFF0C;&#x662F;&#x56E0;&#x4E3A;&#x4F4E;&#x6570;&#x503C;&#x7684;&#x8FDB;&#x7A0B;&#x53F7;&#x4E3A;&#x7CFB;&#x7EDF;&#x8FDB;&#x7A0B;&#x548C;&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x6240;&#x957F;&#x671F;&#x5360;&#x7528;&#xFF0C;&#x5728;&#x6B64;&#x8303;&#x56F4;&#x5185;&#x641C;&#x7D22;&#x5C1A;&#x672A;&#x4F7F;&#x7528;&#x7684;&#x8FDB;&#x7A0B;&#x53F7;&#x53EA;&#x4F1A;&#x662F;&#x6D6A;&#x8D39;&#x65F6;&#x95F4;&#x3002;</p>
<h3 id="&#x865A;&#x62DF;&#x5185;&#x5B58;&#x7BA1;&#x7406;"><a href="#&#x865A;&#x62DF;&#x5185;&#x5B58;&#x7BA1;&#x7406;" class="headerlink" title="&#x865A;&#x62DF;&#x5185;&#x5B58;&#x7BA1;&#x7406;"></a>&#x865A;&#x62DF;&#x5185;&#x5B58;&#x7BA1;&#x7406;</h3><p>&#x865A;&#x62DF;&#x5185;&#x5B58;&#x7684;&#x5B9E;&#x73B0;&#x9700;&#x8981;&#x786C;&#x4EF6;&#x4E2D;&#x5206;&#x9875;&#x5185;&#x5B58;&#x7BA1;&#x7406;&#x5355;&#x5143;&#xFF08;PMMU&#xFF09;&#x7684;&#x652F;&#x6301;&#x3002;PMMU&#x628A;&#x8981;&#x8BBF;&#x95EE;&#x7684;&#x6BCF;&#x4E2A;&#x865A;&#x62DF;&#x5185;&#x5B58;&#x5730;&#x5740;&#x8F6C;&#x6362;&#x6210;&#x76F8;&#x5E94;&#x7684;&#x7269;&#x7406;&#x5185;&#x5B58;&#x5730;&#x5740;&#xFF0C;&#x5F53;&#x7279;&#x5B9A;&#x865A;&#x62DF;&#x5185;&#x5B58;&#x5730;&#x5740;&#x6240;&#x5BF9;&#x5E94;&#x7684;&#x9875;&#x6CA1;&#x6709;&#x9A7B;&#x7559;&#x4E8E;RAM&#x4E2D;&#x65F6;&#xFF0C;&#x5C06;&#x4EE5;&#x9875;&#x9762;&#x9519;&#x8BEF;&#x901A;&#x77E5;&#x5185;&#x6838;&#x3002;</p>
<h3 id="&#x73AF;&#x5883;&#x5217;&#x8868;"><a href="#&#x73AF;&#x5883;&#x5217;&#x8868;" class="headerlink" title="&#x73AF;&#x5883;&#x5217;&#x8868;"></a>&#x73AF;&#x5883;&#x5217;&#x8868;</h3><p>&#x6BCF;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x90FD;&#x6709;&#x4E0E;&#x5176;&#x76F8;&#x5173;&#x7684;&#x79F0;&#x4E4B;&#x4E3A;&#x73AF;&#x5883;&#x5217;&#x8868;&#xFF08;environment list&#xFF09;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x6570;&#x7EC4;&#xFF0C;&#x6216;&#x7B80;&#x79F0;&#x4E3A;&#x73AF;&#x5883;&#xFF08;environment&#xFF09;&#x3002;&#x5176;&#x4E2D;&#x6BCF;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x90FD;&#x4EE5;&#x540D;&#x79F0;=&#x503C;&#xFF08;name=value&#xFF09;&#x5F62;&#x5F0F;&#x5B9A;&#x4E49;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x73AF;&#x5883;&#x662F;&#x201C;&#x540D;&#x79F0;-&#x503C;&#x201D;&#x7684;&#x6210;&#x5BF9;&#x96C6;&#x5408;&#xFF0C;&#x53EF;&#x5B58;&#x50A8;&#x4EFB;&#x4F55;&#x4FE1;&#x606F;&#x3002;&#x5E38;&#x5C06;&#x5217;&#x8868;&#x4E2D;&#x7684;&#x540D;&#x79F0;&#x79F0;&#x4E3A;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#xFF08;environment variables&#xFF09;&#x3002;<br>&#x65B0;&#x8FDB;&#x7A0B;&#x5728;&#x521B;&#x5EFA;&#x4E4B;&#x65F6;&#xFF0C;&#x4F1A;&#x7EE7;&#x627F;&#x5176;&#x7236;&#x8FDB;&#x7A0B;&#x7684;&#x73AF;&#x5883;&#x526F;&#x672C;&#x3002;&#x8FD9;&#x662F;&#x4E00;&#x79CD;&#x539F;&#x59CB;&#x7684;&#x8FDB;&#x7A0B;&#x95F4;&#x901A;&#x4FE1;&#x65B9;&#x5F0F;&#xFF0C;&#x5374;&#x9887;&#x4E3A;&#x5E38;&#x7528;&#x3002;&#x73AF;&#x5883;&#xFF08;environment&#xFF09;&#x63D0;&#x4F9B;&#x4E86;&#x5C06;&#x4FE1;&#x606F;&#x4ECE;&#x7236;&#x8FDB;&#x7A0B;&#x4F20;&#x9012;&#x7ED9;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x65B9;&#x6CD5;&#x3002;&#x7531;&#x4E8E;&#x5B50;&#x8FDB;&#x7A0B;&#x53EA;&#x6709;&#x5728;&#x521B;&#x5EFA;&#x65F6;&#x624D;&#x80FD;&#x83B7;&#x5F97;&#x5176;&#x7236;&#x8FDB;&#x7A0B;&#x7684;&#x73AF;&#x5883;&#x526F;&#x672C;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x4E00;&#x4FE1;&#x606F;&#x4F20;&#x9012;&#x662F;&#x5355;&#x5411;&#x7684;&#x3001;&#x4E00;&#x6B21;&#x6027;&#x7684;&#x3002;&#x5B50;&#x8FDB;&#x7A0B;&#x521B;&#x5EFA;&#x540E;&#xFF0C;&#x7236;&#x3001;&#x5B50;&#x8FDB;&#x7A0B;&#x5747;&#x53EF;&#x66F4;&#x6539;&#x5404;&#x81EA;&#x7684;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#xFF0C;&#x4E14;&#x8FD9;&#x4E9B;&#x53D8;&#x66F4;&#x5BF9;&#x5BF9;&#x65B9;&#x800C;&#x8A00;&#x4E0D;&#x518D;&#x53EF;&#x89C1;&#x3002;</p>
<p><strong>printenv&#x8BBF;&#x95EE;&#x73AF;&#x5883;&#x53D8;&#x91CF;</strong><br>&#x5728;bash&#x4E2D;&#x4F7F;&#x7528;printenv&#x663E;&#x793A;&#x73AF;&#x5883;&#x53D8;&#x91CF;:</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">printenv</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre><code>TERM_SESSION_ID=w0t0p0:F066B8F5-6D43-4D2E-BA82-8899DC1EF600
SSH_AUTH_SOCK=/private/tmp/com.apple.launchd.babpyp7kOs/Listeners
LC_TERMINAL_VERSION=3.3.8
COLORFGBG=15;0
ITERM_PROFILE=Default
XPC_FLAGS=0x0
LANG=zh_CN.UTF-8
PWD=/Users/cdq
SHELL=/bin/zsh
TERM_PROGRAM_VERSION=3.3.8
TERM_PROGRAM=iTerm.app
PATH=/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin
LC_TERMINAL=iTerm2
COLORTERM=truecolor
TERM=xterm-256color
HOME=/Users/cdq
TMPDIR=/var/folders/h1/hdbffw8540v54tbz5ll9lz5m0000gn/T/
USER=cdq
XPC_SERVICE_NAME=0
LOGNAME=cdq
ITERM_SESSION_ID=w0t0p0:F066B8F5-6D43-4D2E-BA82-8899DC1EF600
__CF_USER_TEXT_ENCODING=0x0:25:52
SHLVL=1
OLDPWD=/Users/cdq
ZSH=/Users/cdq/.oh-my-zsh
PAGER=less
LESS=-R
LSCOLORS=Gxfxcxdxbxegedabagacad
AUTOJUMP_SOURCED=1
AUTOJUMP_ERROR_PATH=/Users/cdq/Library/autojump/errors.log
_=/usr/bin/printenv</code></pre><p><strong>&#x8BBF;&#x95EE;environ&#x53D8;&#x91CF;&#x6765;&#x5C55;&#x793A;&#x8BE5;&#x8FDB;&#x7A0B;&#x73AF;&#x5883;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x503C;</strong></p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

using namespace std<span class="token punctuation">;</span>

<span class="token keyword">extern</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>environ<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>ep<span class="token punctuation">;</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span>ep<span class="token operator">=</span>environ<span class="token punctuation">;</span><span class="token operator">*</span>ep<span class="token operator">!=</span><span class="token constant">NULL</span><span class="token punctuation">;</span>ep<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">puts</span><span class="token punctuation">(</span><span class="token operator">*</span>ep<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x6548;&#x679C;&#x548C;&#x4E0A;&#x4E0D;&#x6B65;&#x4E00;&#x6837;&#x3002;</p>
<p><strong>getenv()&#x83B7;&#x5F97;&#x5355;&#x4E2A;&#x73AF;&#x5883;&#x53D8;&#x91CF;</strong></p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;unistd.h&gt;</span></span>

using namespace std<span class="token punctuation">;</span>

<span class="token keyword">extern</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>environ<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>ep<span class="token punctuation">;</span>

cout<span class="token operator">&lt;&lt;</span><span class="token function">getenv</span><span class="token punctuation">(</span><span class="token string">&quot;PATH&quot;</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin</code></pre><p><strong>&#x8BBE;&#x7F6E;&#x73AF;&#x5883;&#x53D8;&#x91CF;</strong><br>setenv()&#x51FD;&#x6570;&#x5411;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x7684;&#x73AF;&#x5883;&#x4E2D;&#x6DFB;&#x52A0;&#x4E00;&#x4E2A;&#x65B0;&#x53D8;&#x91CF;&#xFF0C;&#x6216;&#x8005;&#x4FEE;&#x6539;&#x4E00;&#x4E2A;&#x5DF2;&#x7ECF;&#x5B58;&#x5728;&#x7684;&#x53D8;&#x91CF;&#x503C;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">setenv</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>name<span class="token punctuation">,</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>value<span class="token punctuation">,</span><span class="token keyword">int</span> overwrite<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x6210;&#x529F;&#x8FD4;&#x56DE;0&#xFF0C;&#x5931;&#x8D25;&#x8FD4;&#x56DE;&#x975E;0&#x503C;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x82E5;&#x4EE5;name&#x6807;&#x8BC6;&#x7684;&#x53D8;&#x91CF;&#x5728;&#x73AF;&#x5883;&#x4E2D;&#x5DF2;&#x7ECF;&#x5B58;&#x5728;&#xFF0C;&#x4E14;&#x53C2;&#x6570;overwrite&#x7684;&#x503C;&#x4E3A;0&#xFF0C;&#x5219;setenv()&#x51FD;&#x6570;&#x5C06;&#x4E0D;&#x6539;&#x53D8;&#x73AF;&#x5883;&#xFF0C;&#x5982;&#x679C;&#x53C2;&#x6570;overwrite&#x7684;&#x503C;&#x4E3A;&#x975E;0&#xFF0C;&#x5219;setenv()&#x51FD;&#x6570;&#x603B;&#x662F;&#x6539;&#x53D8;&#x73AF;&#x5883;&#x3002;</p>
<p>unsetenv()&#x51FD;&#x6570;&#x4ECE;&#x73AF;&#x5883;&#x4E2D;&#x79FB;&#x9664;&#x7531;name&#x53C2;&#x6570;&#x6807;&#x8BC6;&#x7684;&#x53D8;&#x91CF;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">unsetenv</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x6210;&#x529F;&#x8FD4;&#x56DE;0&#xFF0C;&#x5931;&#x8D25;&#x8FD4;&#x56DE;&#x975E;0&#x503C;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h2 id="&#x6267;&#x884C;&#x975E;&#x5C40;&#x90E8;&#x8DF3;&#x8F6C;&#xFF1A;setjmp-&#x548C;longjmp"><a href="#&#x6267;&#x884C;&#x975E;&#x5C40;&#x90E8;&#x8DF3;&#x8F6C;&#xFF1A;setjmp-&#x548C;longjmp" class="headerlink" title="&#x6267;&#x884C;&#x975E;&#x5C40;&#x90E8;&#x8DF3;&#x8F6C;&#xFF1A;setjmp()&#x548C;longjmp()"></a>&#x6267;&#x884C;&#x975E;&#x5C40;&#x90E8;&#x8DF3;&#x8F6C;&#xFF1A;setjmp()&#x548C;longjmp()</h2><p>&#x4F7F;&#x7528;&#x5E93;&#x51FD;&#x6570;setjmp()&#x548C;longjmp()&#x53EF;&#x6267;&#x884C;&#x975E;&#x5C40;&#x90E8;&#x8DF3;&#x8F6C;&#xFF08;nonlocal goto&#xFF09;&#x3002;&#x672F;&#x8BED;&#x201C;&#x975E;&#x5C40;&#x90E8;&#xFF08;nonlocal&#xFF09;&#x201D;&#x662F;&#x6307;&#x8DF3;&#x8F6C;&#x7684;&#x76EE;&#x6807;&#x4E3A;&#x5F53;&#x524D;&#x6267;&#x884C;&#x51FD;&#x6570;&#x4E4B;&#x5916;&#x7684;&#x67D0;&#x4E2A;&#x4F4D;&#x7F6E;&#x3002;<br>C&#x8BED;&#x8A00;&#xFF0C;&#x50CF;&#x8BB8;&#x591A;&#x5176;&#x4ED6;&#x7F16;&#x7A0B;&#x8BED;&#x8A00;&#x4E00;&#x6837;&#xFF0C;&#x5305;&#x542B;goto&#x8BED;&#x53E5;&#x3002;&#x8FD9;&#x5C31;&#x597D;&#x6BD4;&#x6253;&#x5F00;&#x4E86;&#x6F58;&#x591A;&#x62C9;&#x7684;&#x9B54;&#x76D2;&#x3002;&#x82E5;&#x65E0;&#x6B62;&#x5883;&#x7684;&#x6EE5;&#x7528;&#xFF0C;&#x5C06;&#x4F7F;&#x7A0B;&#x5E8F;&#x96BE;&#x4EE5;&#x9605;&#x8BFB;&#x548C;&#x7EF4;&#x62A4;&#x3002;&#x4E0D;&#x8FC7;&#x5076;&#x5C14;&#x4E5F;&#x80FD;&#x4E00;&#x663E;&#x8EAB;&#x624B;&#xFF0C;&#x4EE4;&#x7A0B;&#x5E8F;&#x66F4;&#x7B80;&#x5355;&#x3001;&#x66F4;&#x5FEB;&#x901F;&#xFF0C;&#x6216;&#x662F;&#x517C;&#x800C;&#x6709;&#x4E4B;&#x3002;<br>C&#x8BED;&#x8A00;&#x7684;goto&#x8BED;&#x53E5;&#x5B58;&#x5728;&#x4E00;&#x4E2A;&#x9650;&#x5236;&#xFF0C;&#x5373;&#x4E0D;&#x80FD;&#x4ECE;&#x5F53;&#x524D;&#x51FD;&#x6570;&#x8DF3;&#x8F6C;&#x5230;&#x53E6;&#x4E00;&#x51FD;&#x6570;&#x3002;&#x7136;&#x800C;&#xFF0C;&#x5076;&#x5C14;&#x8FD8;&#x662F;&#x9700;&#x8981;&#x8FD9;&#x4E00;&#x529F;&#x80FD;&#x7684;&#x3002;&#x8003;&#x8651;&#x9519;&#x8BEF;&#x5904;&#x7406;&#x4E2D;&#x7ECF;&#x5E38;&#x51FA;&#x73B0;&#x7684;&#x5982;&#x4E0B;&#x573A;&#x666F;&#xFF1A;&#x5728;&#x4E00;&#x4E2A;&#x6DF1;&#x5EA6;&#x5D4C;&#x5957;&#x7684;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x4E2D;&#x53D1;&#x751F;&#x4E86;&#x9519;&#x8BEF;&#xFF0C;&#x9700;&#x8981;&#x653E;&#x5F03;&#x5F53;&#x524D;&#x4EFB;&#x52A1;&#xFF0C;&#x4ECE;&#x591A;&#x5C42;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x4E2D;&#x8FD4;&#x56DE;&#xFF0C;&#x5E76;&#x5728;&#x8F83;&#x9AD8;&#x5C42;&#x7EA7;&#x7684;&#x51FD;&#x6570;&#x4E2D;&#x7EE7;&#x7EED;&#x6267;&#x884C;&#xFF08;&#x4E5F;&#x8BB8;&#x751A;&#x81F3;&#x662F;&#x5728;main()&#x4E2D;&#xFF09;&#x3002;&#x8981;&#x505A;&#x5230;&#x8FD9;&#x4E00;&#x70B9;&#xFF0C;&#x53EF;&#x4EE5;&#x8BA9;&#x6BCF;&#x4E2A;&#x51FD;&#x6570;&#x90FD;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x72B6;&#x6001;&#x503C;&#xFF0C;&#x7531;&#x51FD;&#x6570;&#x7684;&#x8C03;&#x7528;&#x8005;&#x68C0;&#x67E5;&#x5E76;&#x505A;&#x76F8;&#x5E94;&#x5904;&#x7406;&#x3002;&#x8FD9;&#x4E00;&#x65B9;&#x6CD5;&#x5B8C;&#x5168;&#x6709;&#x6548;&#xFF0C;&#x800C;&#x4E14;&#xFF0C;&#x5728;&#x8BB8;&#x591A;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x662F;&#x5904;&#x7406;&#x8FD9;&#x7C7B;&#x573A;&#x666F;&#x7684;&#x7406;&#x60F3;&#x65B9;&#x6CD5;&#x3002;&#x7136;&#x800C;&#xFF0C;&#x6709;&#x65F6;&#x5019;&#x5982;&#x679C;&#x80FD;&#x4ECE;&#x5D4C;&#x5957;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x4E2D;&#x8DF3;&#x51FA;&#xFF0C;&#x8FD4;&#x56DE;&#x8BE5;&#x51FD;&#x6570;&#x7684;&#x8C03;&#x7528;&#x8005;&#x4E4B;&#x4E00;&#xFF08;&#x5F53;&#x524D;&#x8C03;&#x7528;&#x8005;&#x6216;&#x8005;&#x8C03;&#x7528;&#x8005;&#x7684;&#x8C03;&#x7528;&#x8005;&#xFF0C;&#x7B49;&#x7B49;&#xFF09;&#xFF0C;&#x7F16;&#x7801;&#x4F1A;&#x66F4;&#x4E3A;&#x7B80;&#x5355;&#x3002;setjmp()&#x548C;longjmp()&#x5C31;&#x63D0;&#x4F9B;&#x4E86;&#x8FD9;&#x4E00;&#x529F;&#x80FD;&#x3002;</p>
<p>TODO.</p>
<h2 id="&#x8FDB;&#x7A0B;&#x51ED;&#x8BC1;"><a href="#&#x8FDB;&#x7A0B;&#x51ED;&#x8BC1;" class="headerlink" title="&#x8FDB;&#x7A0B;&#x51ED;&#x8BC1;"></a>&#x8FDB;&#x7A0B;&#x51ED;&#x8BC1;</h2><p>&#x6BCF;&#x4E2A;&#x8FDB;&#x7A0B;&#x90FD;&#x6709;&#x4E00;&#x5957;&#x7528;&#x6570;&#x5B57;&#x8868;&#x793A;&#x7684;&#x7528;&#x6237;ID &#x2460; &#xFF08;UID&#xFF09;&#x548C;&#x7EC4;ID(GID)&#x3002;&#x6709;&#x65F6;&#xFF0C;&#x4E5F;&#x5C06;&#x8FD9;&#x4E9B;ID&#x79F0;&#x4E4B;&#x4E3A;&#x8FDB;&#x7A0B;&#x51ED;&#x8BC1;&#x3002;&#x5177;&#x4F53;&#x5982;&#x4E0B;&#x6240;&#x793A;&#x3002;</p>
<p>&#x5B9E;&#x9645;&#x7528;&#x6237;ID&#xFF08;real user ID&#xFF09;&#x548C;&#x5B9E;&#x9645;&#x7EC4;ID&#xFF08;real group ID&#xFF09;&#x3002;<br>&#x6709;&#x6548;&#x7528;&#x6237;ID&#xFF08;effective user ID&#xFF09;&#x548C;&#x6709;&#x6548;&#x7EC4;ID&#xFF08;effective group ID&#xFF09;&#x3002;<br>&#x4FDD;&#x5B58;&#x7684;set-user-ID&#xFF08;saved set-user-ID&#xFF09;&#x548C;&#x4FDD;&#x5B58;&#x7684;set-group-ID&#xFF08;saved set-group-ID&#xFF09;&#x3002;<br>&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x7528;&#x6237;ID&#xFF08;file-system user ID&#xFF09;&#x548C;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x7EC4;ID&#xFF08;file-system group ID&#xFF09;&#xFF08;Linux&#x4E13;&#x6709;&#xFF09;&#x3002;<br>&#x8F85;&#x52A9;&#x7EC4;ID&#x3002;</p>
<h2 id="&#x8FDB;&#x7A0B;&#x7684;&#x521B;&#x5EFA;"><a href="#&#x8FDB;&#x7A0B;&#x7684;&#x521B;&#x5EFA;" class="headerlink" title="&#x8FDB;&#x7A0B;&#x7684;&#x521B;&#x5EFA;"></a>&#x8FDB;&#x7A0B;&#x7684;&#x521B;&#x5EFA;</h2><h3 id="fork-&#x3001;exit-&#x3001;wait-&#x4EE5;&#x53CA;execve-&#x7684;&#x7B80;&#x4ECB;"><a href="#fork-&#x3001;exit-&#x3001;wait-&#x4EE5;&#x53CA;execve-&#x7684;&#x7B80;&#x4ECB;" class="headerlink" title="fork()&#x3001;exit()&#x3001;wait()&#x4EE5;&#x53CA;execve()&#x7684;&#x7B80;&#x4ECB;"></a>fork()&#x3001;exit()&#x3001;wait()&#x4EE5;&#x53CA;execve()&#x7684;&#x7B80;&#x4ECB;</h3><p><code>fork():</code>&#x7CFB;&#x7EDF;&#x8C03;&#x7528;fork()&#x5141;&#x8BB8;&#x4E00;&#x8FDB;&#x7A0B;&#xFF08;&#x7236;&#x8FDB;&#x7A0B;&#xFF09;&#x521B;&#x5EFA;&#x4E00;&#x65B0;&#x8FDB;&#x7A0B;&#xFF08;&#x5B50;&#x8FDB;&#x7A0B;&#xFF09;&#x3002;&#x5177;&#x4F53;&#x505A;&#x6CD5;&#x662F;&#xFF0C;&#x65B0;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x51E0;&#x8FD1;&#x4E8E;&#x5BF9;&#x7236;&#x8FDB;&#x7A0B;&#x7684;&#x7FFB;&#x7248;&#xFF1A;&#x5B50;&#x8FDB;&#x7A0B;&#x83B7;&#x5F97;&#x7236;&#x8FDB;&#x7A0B;&#x7684;&#x6808;&#x3001;&#x6570;&#x636E;&#x6BB5;&#x3001;&#x5806;&#x548C;&#x6267;&#x884C;&#x6587;&#x672C;&#x6BB5;&#xFF08;6.3&#x8282;&#xFF09;&#x7684;&#x62F7;&#x8D1D;&#x3002;&#x53EF;&#x5C06;&#x6B64;&#x89C6;&#x4E3A;&#x628A;&#x7236;&#x8FDB;&#x7A0B;&#x4E00;&#x5206;&#x4E3A;&#x4E8C;&#xFF0C;&#x672F;&#x8BED;fork&#x4E5F;&#x7531;&#x6B64;&#x5F97;&#x540D;&#x3002;<br><code>exit():</code>&#x5E93;&#x51FD;&#x6570;exit&#xFF08;status&#xFF09;&#x7EC8;&#x6B62;&#x4E00;&#x8FDB;&#x7A0B;&#xFF0C;&#x5C06;&#x8FDB;&#x7A0B;&#x5360;&#x7528;&#x7684;&#x6240;&#x6709;&#x8D44;&#x6E90;&#xFF08;&#x5185;&#x5B58;&#x3001;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x7B49;&#xFF09;&#x5F52;&#x8FD8;&#x5185;&#x6838;&#xFF0C;&#x4EA4;&#x5176;&#x8FDB;&#x884C;&#x518D;&#x6B21;&#x5206;&#x914D;&#x3002;&#x53C2;&#x6570;status&#x4E3A;&#x4E00;&#x6574;&#x578B;&#x53D8;&#x91CF;&#xFF0C;&#x8868;&#x793A;&#x8FDB;&#x7A0B;&#x7684;&#x9000;&#x51FA;&#x72B6;&#x6001;&#x3002;&#x7236;&#x8FDB;&#x7A0B;&#x53EF;&#x4F7F;&#x7528;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;wait()&#x6765;&#x83B7;&#x53D6;&#x8BE5;&#x72B6;&#x6001;&#x3002;<br><code>wait():</code>&#x7CFB;&#x7EDF;&#x8C03;&#x7528;wait&#xFF08;&amp;status&#xFF09;&#x7684;&#x76EE;&#x7684;&#x6709;&#x4E8C;&#xFF1A;&#x5176;&#x4E00;&#xFF0C;&#x5982;&#x679C;&#x5B50;&#x8FDB;&#x7A0B;&#x5C1A;&#x672A;&#x8C03;&#x7528; exit()&#x7EC8;&#x6B62;&#xFF0C;&#x90A3;&#x4E48;wait()&#x4F1A;&#x6302;&#x8D77;&#x7236;&#x8FDB;&#x7A0B;&#x76F4;&#x81F3;&#x5B50;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#xFF1B;&#x5176;&#x4E8C;&#xFF0C;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x7EC8;&#x6B62;&#x72B6;&#x6001;&#x901A;&#x8FC7;wait()&#x7684;status&#x53C2;&#x6570;&#x8FD4;&#x56DE;&#x3002;<br><code>execve():</code>&#x7CFB;&#x7EDF;&#x8C03;&#x7528; execve(pathname&#xFF0C;argv&#xFF0C;envp)&#x52A0;&#x8F7D;&#x4E00;&#x4E2A;&#x65B0;&#x7A0B;&#x5E8F;&#xFF08;&#x8DEF;&#x5F84;&#x540D;&#x4E3A; pathname&#xFF0C;&#x53C2;&#x6570;&#x5217;&#x8868;&#x4E3A; argv&#xFF0C;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x5217;&#x8868;&#x4E3A; envp&#xFF09;&#x5230;&#x5F53;&#x524D;&#x8FDB;&#x7A0B;&#x7684;&#x5185;&#x5B58;&#x3002;&#x8FD9;&#x5C06;&#x4E22;&#x5F03;&#x73B0;&#x5B58;&#x7684;&#x7A0B;&#x5E8F;&#x6587;&#x672C;&#x6BB5;&#xFF0C;&#x5E76;&#x4E3A;&#x65B0;&#x7A0B;&#x5E8F;&#x91CD;&#x65B0;&#x521B;&#x5EFA;&#x6808;&#x3001;&#x6570;&#x636E;&#x6BB5;&#x4EE5;&#x53CA;&#x5806;&#x3002;&#x901A;&#x5E38;&#x5C06;&#x8FD9;&#x4E00;&#x52A8;&#x4F5C;&#x79F0;&#x4E3A;&#x6267;&#x884C;&#xFF08;execing&#xFF09;&#x4E00;&#x4E2A;&#x65B0;&#x7A0B;&#x5E8F;&#x3002;</p>
<div class="amp-img-wrapper"><amp-img src="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1581392491639.png?x-oss-process=image/resize,m_lfit,h_450" width="321" height="450" layout="responsive"></amp-img></div><br>&#x56FE;&#x4E2D;&#x5BF9;execve()&#x7684;&#x8C03;&#x7528;&#x5E76;&#x975E;&#x5FC5;&#x987B;&#x3002;&#x6709;&#x65F6;&#xFF0C;&#x8BA9;&#x5B50;&#x8FDB;&#x7A0B;&#x7EE7;&#x7EED;&#x6267;&#x884C;&#x4E0E;&#x7236;&#x8FDB;&#x7A0B;&#x76F8;&#x540C;&#x7684;&#x7A0B;&#x5E8F;&#x53CD;&#x800C;&#x4F1A;&#x6709;&#x5999;&#x7528;&#x3002;&#x6700;&#x7EC8;&#xFF0C;&#x4E24;&#x79CD;&#x60C5;&#x51B5;&#x6B8A;&#x9014;&#x540C;&#x5F52;&#xFF1A;&#x603B;&#x662F;&#x8981;&#x901A;&#x8FC7;&#x8C03;&#x7528;exit()&#xFF08;&#x6216;&#x63A5;&#x6536;&#x4E00;&#x4E2A;&#x4FE1;&#x53F7;&#xFF09;&#x6765;&#x7EC8;&#x6B62;&#x5B50;&#x8FDB;&#x7A0B;&#xFF0C;&#x800C;&#x7236;&#x8FDB;&#x7A0B;&#x53EF;&#x8C03;&#x7528;wait()&#x6765;&#x83B7;&#x53D6;&#x5176;&#x7EC8;&#x6B62;&#x72B6;&#x6001;&#x3002;
<h2 id="&#x521B;&#x5EFA;&#x65B0;&#x8FDB;&#x7A0B;&#xFF1A;fork"><a href="#&#x521B;&#x5EFA;&#x65B0;&#x8FDB;&#x7A0B;&#xFF1A;fork" class="headerlink" title="&#x521B;&#x5EFA;&#x65B0;&#x8FDB;&#x7A0B;&#xFF1A;fork()"></a>&#x521B;&#x5EFA;&#x65B0;&#x8FDB;&#x7A0B;&#xFF1A;fork()</h2><p>&#x5728;&#x8BF8;&#x591A;&#x5E94;&#x7528;&#x4E2D;&#xFF0C;&#x521B;&#x5EFA;&#x591A;&#x4E2A;&#x8FDB;&#x7A0B;&#x662F;&#x4EFB;&#x52A1;&#x5206;&#x89E3;&#x65F6;&#x884C;&#x4E4B;&#x6709;&#x6548;&#x7684;&#x65B9;&#x6CD5;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x67D0;&#x4E00;&#x7F51;&#x7EDC;&#x670D;&#x52A1;&#x5668;&#x8FDB;&#x7A0B;&#x53EF;&#x5728;&#x4FA6;&#x542C;&#x5BA2;&#x6237;&#x7AEF;&#x8BF7;&#x6C42;&#x7684;&#x540C;&#x65F6;&#xFF0C;&#x4E3A;&#x5904;&#x7406;&#x6BCF;&#x4E00;&#x8BF7;&#x6C42;&#x800C;&#x521B;&#x5EFA;&#x4E00;&#x65B0;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#xFF0C;&#x4E0E;&#x6B64;&#x540C;&#x65F6;&#xFF0C;&#x670D;&#x52A1;&#x5668;&#x8FDB;&#x7A0B;&#x4F1A;&#x7EE7;&#x7EED;&#x4FA6;&#x542C;&#x66F4;&#x591A;&#x7684;&#x5BA2;&#x6237;&#x7AEF;&#x8FDE;&#x63A5;&#x8BF7;&#x6C42;&#x3002;&#x4EE5;&#x6B64;&#x7C7B;&#x624B;&#x6CD5;&#x5206;&#x89E3;&#x4EFB;&#x52A1;&#xFF0C;&#x901A;&#x5E38;&#x4F1A;&#x7B80;&#x5316;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x8BBE;&#x8BA1;&#xFF0C;&#x540C;&#x65F6;&#x63D0;&#x9AD8;&#x4E86;&#x7CFB;&#x7EDF;&#x7684;&#x5E76;&#x53D1;&#x6027;&#x3002;&#xFF08;&#x5373;&#xFF0C;&#x53EF;&#x540C;&#x65F6;&#x5904;&#x7406;&#x66F4;&#x591A;&#x7684;&#x4EFB;&#x52A1;&#x6216;&#x8BF7;&#x6C42;&#x3002;&#xFF09;</p>
<p>&#x7CFB;&#x7EDF;&#x8C03;&#x7528;fork()&#x521B;&#x5EFA;&#x4E00;&#x65B0;&#x8FDB;&#x7A0B;&#xFF08;child&#xFF09;&#xFF0C;&#x51E0;&#x8FD1;&#x4E8E;&#x5BF9;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#xFF08;parent&#xFF09;&#x7684;&#x7FFB;&#x7248;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;unistd.h&gt;</span></span>

pid_t <span class="token function">fork</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x5728;&#x7236;&#x8FDB;&#x7A0B;&#x4E2D;&#x6210;&#x529F;&#x8FD4;&#x56DE;&#x5B50;id,&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x7406;&#x89E3;fork()&#x7684;&#x8BC0;&#x7A8D;&#x662F;&#xFF0C;&#x8981;&#x610F;&#x8BC6;&#x5230;&#xFF0C;&#x5B8C;&#x6210;&#x5BF9;&#x5176;&#x8C03;&#x7528;&#x540E;&#x5C06;&#x5B58;&#x5728;&#x4E24;&#x4E2A;&#x8FDB;&#x7A0B;&#xFF0C;&#x4E14;&#x6BCF;&#x4E2A;&#x8FDB;&#x7A0B;&#x90FD;&#x4F1A;&#x4ECE;fork()&#x7684;&#x8FD4;&#x56DE;&#x5904;&#x7EE7;&#x7EED;&#x6267;&#x884C;&#x3002;<br>&#x8FD9;&#x4E24;&#x4E2A;&#x8FDB;&#x7A0B;&#x5C06;&#x6267;&#x884C;&#x76F8;&#x540C;&#x7684;&#x7A0B;&#x5E8F;&#x6587;&#x672C;&#x6BB5;&#xFF0C;&#x4F46;&#x5374;&#x5404;&#x81EA;&#x62E5;&#x6709;&#x4E0D;&#x540C;&#x7684;&#x6808;&#x6BB5;&#x3001;&#x6570;&#x636E;&#x6BB5;&#x4EE5;&#x53CA;&#x5806;&#x6BB5;&#x62F7;&#x8D1D;&#x3002;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x6808;&#x3001;&#x6570;&#x636E;&#x4EE5;&#x53CA;&#x6808;&#x6BB5;&#x5F00;&#x59CB;&#x65F6;&#x662F;&#x5BF9;&#x7236;&#x8FDB;&#x7A0B;&#x5185;&#x5B58;&#x76F8;&#x5E94;&#x5404;&#x90E8;&#x5206;&#x7684;&#x5B8C;&#x5168;&#x590D;&#x5236;&#x3002;&#x6267;&#x884C; fork()&#x4E4B;&#x540E;&#xFF0C;&#x6BCF;&#x4E2A;&#x8FDB;&#x7A0B;&#x5747;&#x53EF;&#x4FEE;&#x6539;&#x5404;&#x81EA;&#x7684;&#x6808;&#x6570;&#x636E;&#x3001;&#x4EE5;&#x53CA;&#x5806;&#x6BB5;&#x4E2D;&#x7684;&#x53D8;&#x91CF;&#xFF0C;&#x800C;&#x5E76;&#x4E0D;&#x5F71;&#x54CD;&#x53E6;&#x4E00;&#x8FDB;&#x7A0B;&#x3002;<br>&#x7A0B;&#x5E8F;&#x4EE3;&#x7801;&#x5219;&#x53EF;&#x901A;&#x8FC7;fork()&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x6765;&#x533A;&#x5206;&#x7236;&#x3001;&#x5B50;&#x8FDB;&#x7A0B;&#x3002;&#x5728;&#x7236;&#x8FDB;&#x7A0B;&#x4E2D;&#xFF0C;fork()&#x5C06;&#x8FD4;&#x56DE;&#x65B0;&#x521B;&#x5EFA;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x8FDB;&#x7A0B;ID&#x3002;&#x9274;&#x4E8E;&#x7236;&#x8FDB;&#x7A0B;&#x53EF;&#x80FD;&#x9700;&#x8981;&#x521B;&#x5EFA;&#xFF0C;&#x8FDB;&#x800C;&#x8FFD;&#x8E2A;&#x591A;&#x4E2A;&#x5B50;&#x8FDB;&#x7A0B;&#xFF08;&#x901A;&#x8FC7;wait()&#x6216;&#x7C7B;&#x4F3C;&#x65B9;&#x6CD5;&#xFF09;&#xFF0C;&#x8FD9;&#x79CD;&#x5B89;&#x6392;&#x8FD8;&#x662F;&#x5F88;&#x5B9E;&#x7528;&#x7684;&#x3002;&#x800C;fork()&#x5728;&#x5B50;&#x8FDB;&#x7A0B;&#x4E2D;&#x5219;&#x8FD4;&#x56DE;0&#x3002;&#x5982;&#x6709;&#x5FC5;&#x8981;&#xFF0C;&#x5B50;&#x8FDB;&#x7A0B;&#x53EF;&#x8C03;&#x7528;getpid()&#x4EE5;&#x83B7;&#x53D6;&#x81EA;&#x8EAB;&#x7684;&#x8FDB;&#x7A0B;ID&#xFF0C;&#x8C03;&#x7528;getppid()&#x4EE5;&#x83B7;&#x53D6;&#x7236;&#x8FDB;&#x7A0B;ID&#x3002;<br>&#x5F53;&#x65E0;&#x6CD5;&#x521B;&#x5EFA;&#x5B50;&#x8FDB;&#x7A0B;&#x65F6;&#xFF0C;fork()&#x5C06;&#x8FD4;&#x56DE;-1&#x3002;&#x5931;&#x8D25;&#x7684;&#x539F;&#x56E0;&#x53EF;&#x80FD;&#x5728;&#x4E8E;&#xFF0C;&#x8FDB;&#x7A0B;&#x6570;&#x91CF;&#x8981;&#x4E48;&#x8D85;&#x51FA;&#x4E86;&#x7CFB;&#x7EDF;&#x9488;&#x5BF9;&#x6B64;&#x771F;&#x5B9E;&#x7528;&#x6237;&#xFF08;real user ID&#xFF09;&#x5728;&#x8FDB;&#x7A0B;&#x6570;&#x91CF;&#x4E0A;&#x6240;&#x65BD;&#x52A0;&#x7684;&#x9650;&#x5236;&#xFF0C;&#x8981;&#x4E48;&#x662F;&#x89E6;&#x53CA;&#x5141;&#x8BB8;&#x8BE5;&#x7CFB;&#x7EDF;&#x521B;&#x5EFA;&#x7684;&#x6700;&#x5927;&#x8FDB;&#x7A0B;&#x6570;&#x8FD9;&#x4E00;&#x7CFB;&#x7EDF;&#x7EA7;&#x4E0A;&#x9650;&#x3002;</p>
<p>&#x8C03;&#x7528;fork()&#x65F6;&#xFF0C;&#x6709;&#x65F6;&#x4F1A;&#x91C7;&#x7528;&#x5982;&#x4E0B;&#x4E60;&#x60EF;&#x7528;&#x8BED;&#xFF1A;</p>
<pre class="line-numbers language-c"><code class="language-c">pid_t chlidPid<span class="token punctuation">;</span>

<span class="token keyword">switch</span><span class="token punctuation">(</span>childPid<span class="token operator">=</span><span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>
        <span class="token comment" spellcheck="true">//&#x5904;&#x7406;&#x9519;&#x8BEF;</span>
    <span class="token keyword">case</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token comment" spellcheck="true">//&#x6267;&#x884C;&#x5B50;&#x8FDB;&#x7A0B;&#x52A8;&#x4F5C;</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span>
        <span class="token comment" spellcheck="true">//&#x6267;&#x884C;&#x7236;&#x8FDB;&#x7A0B;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x8C03;&#x7528;fork()&#x4E4B;&#x540E;&#xFF0C;&#x7CFB;&#x7EDF;&#x5C06;&#x7387;&#x5148;&#x201C;&#x5782;&#x9752;&#x201D;&#x4E8E;&#x54EA;&#x4E2A;&#x8FDB;&#x7A0B;&#xFF08;&#x5373;&#x8C03;&#x5EA6;&#x5176;&#x4F7F;&#x7528;CPU&#xFF09;&#xFF0C;&#x662F;&#x65E0;&#x6CD5;&#x786E;&#x5B9A;&#x7684;&#xFF0C;&#x610F;&#x8BC6;&#x5230;&#x8FD9;&#x4E00;&#x70B9;&#x6781;&#x4E3A;&#x91CD;&#x8981;&#x3002;&#x5728;&#x8BBE;&#x8BA1;&#x62D9;&#x52A3;&#x7684;&#x7A0B;&#x5E8F;&#x4E2D;&#xFF0C;&#x8FD9;&#x79CD;&#x4E0D;&#x786E;&#x5B9A;&#x6027;&#x53EF;&#x80FD;&#x4F1A;&#x5BFC;&#x81F4;&#x6240;&#x8C13;&#x201C;&#x7ADE;&#x4E89;&#x6761;&#x4EF6;&#xFF08;race condition&#xFF09;&#x201D;&#x7684;&#x9519;&#x8BEF;&#x3002;</p>
<p><strong>&#x4F8B;1:</strong></p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;unistd.h&gt;</span></span>

using namespace std<span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> idata <span class="token operator">=</span> <span class="token number">111</span><span class="token punctuation">;</span>             <span class="token comment" spellcheck="true">/* Allocated in data segment */</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> istack <span class="token operator">=</span> <span class="token number">222</span><span class="token punctuation">;</span>               <span class="token comment" spellcheck="true">/* Allocated in stack segment */</span>
    pid_t childPid<span class="token punctuation">;</span>

    <span class="token keyword">switch</span> <span class="token punctuation">(</span>childPid <span class="token operator">=</span> <span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>
        cout<span class="token operator">&lt;&lt;</span><span class="token string">&quot;fork&quot;</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>

    <span class="token keyword">case</span> <span class="token number">0</span><span class="token punctuation">:</span>
        idata <span class="token operator">*</span><span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
        istack <span class="token operator">*</span><span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>

    <span class="token keyword">default</span><span class="token punctuation">:</span>
        <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                   <span class="token comment" spellcheck="true">/* Give child a chance to execute */</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">/* Both parent and child come here */</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;PID=%ld %s idata=%d istack=%d\n&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span> <span class="token function">getpid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span>childPid <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">&quot;(child) &quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;(parent)&quot;</span><span class="token punctuation">,</span> idata<span class="token punctuation">,</span> istack<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">exit</span><span class="token punctuation">(</span>EXIT_SUCCESS<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>PID=13443 (child)  idata=333 istack=666
PID=13442 (parent) idata=111 istack=222</code></pre><p>&#x8BE5;&#x7A0B;&#x5E8F;&#x521B;&#x5EFA;&#x4E00;&#x5B50;&#x8FDB;&#x7A0B;&#xFF0C;&#x5E76;&#x5BF9;&#x7EE7;&#x627F;&#x81EA;fork()&#x7684;&#x5168;&#x5C40;&#x53CA;&#x81EA;&#x52A8;&#x53D8;&#x91CF;&#x62F7;&#x8D1D;&#x8FDB;&#x884C;&#x4FEE;&#x6539;&#x3002;<br>&#x4EE5;&#x4E0A;&#x8F93;&#x51FA;&#x8868;&#x660E;&#xFF0C;&#x5B50;&#x8FDB;&#x7A0B;&#x5728;fork()&#x65F6;&#x62E5;&#x6709;&#x4E86;&#x81EA;&#x5DF1;&#x7684;&#x6808;&#x548C;&#x6570;&#x636E;&#x6BB5;&#x62F7;&#x8D1D;&#xFF0C;&#x4E14;&#x5176;&#x5BF9;&#x8FD9;&#x4E9B;&#x6BB5;&#x4E2D;&#x53D8;&#x91CF;&#x7684;&#x4FEE;&#x6539;&#x5C06;&#x4E0D;&#x4F1A;&#x5F71;&#x54CD;&#x7236;&#x8FDB;&#x7A0B;&#x3002;</p>
<h3 id="&#x7236;&#x3001;&#x5B50;&#x8FDB;&#x7A0B;&#x95F4;&#x7684;&#x6587;&#x4EF6;&#x5171;&#x4EAB;"><a href="#&#x7236;&#x3001;&#x5B50;&#x8FDB;&#x7A0B;&#x95F4;&#x7684;&#x6587;&#x4EF6;&#x5171;&#x4EAB;" class="headerlink" title="&#x7236;&#x3001;&#x5B50;&#x8FDB;&#x7A0B;&#x95F4;&#x7684;&#x6587;&#x4EF6;&#x5171;&#x4EAB;"></a>&#x7236;&#x3001;&#x5B50;&#x8FDB;&#x7A0B;&#x95F4;&#x7684;&#x6587;&#x4EF6;&#x5171;&#x4EAB;</h3><p>&#x6267;&#x884C;fork()&#x65F6;&#xFF0C;&#x5B50;&#x8FDB;&#x7A0B;&#x4F1A;&#x83B7;&#x5F97;&#x7236;&#x8FDB;&#x7A0B;&#x6240;&#x6709;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x7684;&#x526F;&#x672C;&#x3002;&#x8FD9;&#x4E9B;&#x526F;&#x672C;&#x7684;&#x521B;&#x5EFA;&#x65B9;&#x5F0F;&#x7C7B;&#x4F3C;&#x4E8E;dup()&#xFF0C;&#x8FD9;&#x4E5F;&#x610F;&#x5473;&#x7740;&#x7236;&#x3001;&#x5B50;&#x8FDB;&#x7A0B;&#x4E2D;&#x5BF9;&#x5E94;&#x7684;&#x63CF;&#x8FF0;&#x7B26;&#x5747;&#x6307;&#x5411;&#x76F8;&#x540C;&#x7684;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x53E5;&#x67C4;&#xFF08;&#x5373; open file description&#xFF09;&#x3002;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x53E5;&#x67C4;&#x5305;&#x542B;&#x6709;&#x5F53;&#x524D;&#x6587;&#x4EF6;&#x504F;&#x79FB;&#x91CF;&#xFF08;&#x7531;read()&#x3001;write()&#x548C;lseek()&#x4FEE;&#x6539;&#xFF09;&#x4EE5;&#x53CA;&#x6587;&#x4EF6;&#x72B6;&#x6001;&#x6807;&#x5FD7;&#xFF08;&#x7531;open()&#x8BBE;&#x7F6E;&#xFF0C;&#x901A;&#x8FC7;fcntl()&#x7684;F_SETFL&#x64CD;&#x4F5C;&#x6539;&#x53D8;&#xFF09;&#x3002;&#x4E00;&#x4E2A;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x7684;&#x8FD9;&#x4E9B;&#x5C5E;&#x6027;&#x56E0;&#x4E4B;&#x800C;&#x5728;&#x7236;&#x5B50;&#x8FDB;&#x7A0B;&#x95F4;&#x5B9E;&#x73B0;&#x4E86;&#x5171;&#x4EAB;&#x3002;&#x4E3E;&#x4F8B;&#x6765;&#x8BF4;&#xFF0C;&#x5982;&#x679C;&#x5B50;&#x8FDB;&#x7A0B;&#x66F4;&#x65B0;&#x4E86;&#x6587;&#x4EF6;&#x504F;&#x79FB;&#x91CF;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x79CD;&#x6539;&#x53D8;&#x4E5F;&#x4F1A;&#x5F71;&#x54CD;&#x5230;&#x7236;&#x8FDB;&#x7A0B;&#x4E2D;&#x76F8;&#x5E94;&#x7684;&#x63CF;&#x8FF0;&#x7B26;&#x3002;</p>
<p>&#x7236;&#x5B50;&#x8FDB;&#x7A0B;&#x95F4;&#x5171;&#x4EAB;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x5C5E;&#x6027;&#x7684;&#x5999;&#x7528;&#x5C61;&#x89C1;&#x4E0D;&#x9C9C;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x5047;&#x8BBE;&#x7236;&#x5B50;&#x8FDB;&#x7A0B;&#x540C;&#x65F6;&#x5199;&#x5165;&#x4E00;&#x6587;&#x4EF6;&#xFF0C;&#x5171;&#x4EAB;&#x6587;&#x4EF6;&#x504F;&#x79FB;&#x91CF;&#x4F1A;&#x786E;&#x4FDD;&#x4E8C;&#x8005;&#x4E0D;&#x4F1A;&#x8986;&#x76D6;&#x5F7C;&#x6B64;&#x7684;&#x8F93;&#x51FA;&#x5185;&#x5BB9;&#x3002;&#x4E0D;&#x8FC7;&#xFF0C;&#x8FD9;&#x5E76;&#x4E0D;&#x80FD;&#x963B;&#x6B62;&#x7236;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x8F93;&#x51FA;&#x968F;&#x610F;&#x6DF7;&#x6742;&#x5728;&#x4E00;&#x8D77;&#x3002;&#x8981;&#x60F3;&#x89C4;&#x907F;&#x8FD9;&#x4E00;&#x73B0;&#x8C61;&#xFF0C;&#x9700;&#x8981;&#x8FDB;&#x884C;&#x8FDB;&#x7A0B;&#x95F4;&#x540C;&#x6B65;&#x3002;&#x6BD4;&#x5982;&#xFF0C;&#x7236;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;wait()&#x6765;&#x6682;&#x505C;&#x8FD0;&#x884C;&#x5E76;&#x7B49;&#x5F85;&#x5B50;&#x8FDB;&#x7A0B;&#x9000;&#x51FA;&#x3002;shell&#x5C31;&#x662F;&#x8FD9;&#x4E48;&#x505A;&#x7684;&#xFF1A;&#x53EA;&#x6709;&#x5F53;&#x6267;&#x884C;&#x547D;&#x4EE4;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x9000;&#x51FA;&#x540E;&#xFF0C;shell&#x624D;&#x4F1A;&#x6253;&#x5370;&#x51FA;&#x63D0;&#x793A;&#x7B26;&#xFF08;&#x9664;&#x975E;&#x7528;&#x6237;&#x5728;&#x547D;&#x4EE4;&#x884C;&#x6700;&#x540E;&#x52A0;&#x4E0A;&amp;&#x7B26;&#x4EE5;&#x663E;&#x5F0F;&#x5728;&#x540E;&#x53F0;&#x8FD0;&#x884C;&#x547D;&#x4EE4;&#xFF09;&#x3002;</p>
<h3 id="fork-&#x7684;&#x5185;&#x5B58;&#x8BED;&#x4E49;"><a href="#fork-&#x7684;&#x5185;&#x5B58;&#x8BED;&#x4E49;" class="headerlink" title="fork()&#x7684;&#x5185;&#x5B58;&#x8BED;&#x4E49;"></a>fork()&#x7684;&#x5185;&#x5B58;&#x8BED;&#x4E49;</h3><p>&#x4ECE;&#x6982;&#x5FF5;&#x4E0A;&#x8BF4;&#x6765;&#xFF0C;&#x53EF;&#x4EE5;&#x5C06;fork()&#x8BA4;&#x4F5C;&#x5BF9;&#x7236;&#x8FDB;&#x7A0B;&#x7A0B;&#x5E8F;&#x6BB5;&#x3001;&#x6570;&#x636E;&#x6BB5;&#x3001;&#x5806;&#x6BB5;&#x4EE5;&#x53CA;&#x6808;&#x6BB5;&#x521B;&#x5EFA;&#x62F7;&#x8D1D;&#x3002;&#x7684;&#x786E;&#xFF0C;&#x5728;&#x4E00;&#x4E9B;&#x65E9;&#x671F;&#x7684;UNIX&#x5B9E;&#x73B0;&#x4E2D;&#xFF0C;&#x6B64;&#x7C7B;&#x590D;&#x5236;&#x786E;&#x5B9E;&#x662F;&#x539F;&#x6C41;&#x539F;&#x5473;&#xFF1A;&#x5C06;&#x7236;&#x8FDB;&#x7A0B;&#x5185;&#x5B58;&#x62F7;&#x8D1D;&#x81F3;&#x4EA4;&#x6362;&#x7A7A;&#x95F4;&#xFF0C;&#x4EE5;&#x6B64;&#x521B;&#x5EFA;&#x65B0;&#x8FDB;&#x7A0B;&#x6620;&#x50CF;&#xFF08;image&#xFF09;&#xFF0C;&#x800C;&#x5728;&#x7236;&#x8FDB;&#x7A0B;&#x4FDD;&#x6301;&#x81EA;&#x8EAB;&#x5185;&#x5B58;&#x7684;&#x540C;&#x65F6;&#xFF0C;&#x5C06;&#x6362;&#x51FA;&#x6620;&#x50CF;&#x7F6E;&#x4E3A;&#x5B50;&#x8FDB;&#x7A0B;&#x3002;&#x4E0D;&#x8FC7;&#xFF0C;&#x771F;&#x8981;&#x662F;&#x7B80;&#x5355;&#x5730;&#x5C06;&#x7236;&#x8FDB;&#x7A0B;&#x865A;&#x62DF;&#x5185;&#x5B58;&#x9875;&#x62F7;&#x8D1D;&#x5230;&#x65B0;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#xFF0C;&#x90A3;&#x5C31;&#x592A;&#x6D6A;&#x8D39;&#x4E86;&#x3002;&#x539F;&#x56E0;&#x6709;&#x5F88;&#x591A;&#xFF0C;&#x5176;&#x4E2D;&#x4E4B;&#x4E00;&#x662F;&#xFF1A;fork()&#x4E4B;&#x540E;&#x5E38;&#x5E38;&#x4F34;&#x968F;&#x7740; exec(), &#x8FD9;&#x4F1A;&#x7528;&#x65B0;&#x7A0B;&#x5E8F;&#x66FF;&#x6362;&#x8FDB;&#x7A0B;&#x7684;&#x4EE3;&#x7801;&#x6BB5;&#xFF0C;&#x5E76;&#x91CD;&#x65B0;&#x521D;&#x59CB;&#x5316;&#x5176;&#x6570;&#x636E;&#x6BB5;&#x3001;&#x5806;&#x6BB5;&#x548C;&#x6808;&#x6BB5;&#x3002;&#x5927;&#x90E8;&#x5206;&#x73B0;&#x4EE3;UNIX&#x5B9E;&#x73B0;&#xFF08;&#x5305;&#x62EC;Linux&#xFF09;&#x91C7;&#x7528;&#x4E24;&#x79CD;&#x6280;&#x672F;&#x6765;&#x907F;&#x514D;&#x8FD9;&#x79CD;&#x6D6A;&#x8D39;&#x3002;</p>
<ul>
<li>&#x5185;&#x6838;&#xFF08;Kernel&#xFF09;&#x5C06;&#x6BCF;&#x4E00;&#x8FDB;&#x7A0B;&#x7684;&#x4EE3;&#x7801;&#x6BB5;&#x6807;&#x8BB0;&#x4E3A;&#x53EA;&#x8BFB;&#xFF0C;&#x4ECE;&#x800C;&#x4F7F;&#x8FDB;&#x7A0B;&#x65E0;&#x6CD5;&#x4FEE;&#x6539;&#x81EA;&#x8EAB;&#x4EE3;&#x7801;&#x3002;&#x8FD9;&#x6837;&#xFF0C;&#x7236;&#x3001;&#x5B50;&#x8FDB;&#x7A0B;&#x53EF;&#x5171;&#x4EAB;&#x540C;&#x4E00;&#x4EE3;&#x7801;&#x6BB5;&#x3002;&#x7CFB;&#x7EDF;&#x8C03;&#x7528; fork()&#x5728;&#x4E3A;&#x5B50;&#x8FDB;&#x7A0B;&#x521B;&#x5EFA;&#x4EE3;&#x7801;&#x6BB5;&#x65F6;&#xFF0C;&#x5176;&#x6240;&#x6784;&#x5EFA;&#x7684;&#x4E00;&#x7CFB;&#x5217;&#x8FDB;&#x7A0B;&#x7EA7;&#x9875;&#x8868;&#x9879;&#xFF08;page-table entries&#xFF09;&#x5747;&#x6307;&#x5411;&#x4E0E;&#x7236;&#x8FDB;&#x7A0B;&#x76F8;&#x540C;&#x7684;&#x7269;&#x7406;&#x5185;&#x5B58;&#x9875;&#x5E27;&#x3002;</li>
<li>&#x5BF9;&#x4E8E;&#x7236;&#x8FDB;&#x7A0B;&#x6570;&#x636E;&#x6BB5;&#x3001;&#x5806;&#x6BB5;&#x548C;&#x6808;&#x6BB5;&#x4E2D;&#x7684;&#x5404;&#x9875;&#xFF0C;&#x5185;&#x6838;&#x91C7;&#x7528;&#x5199;&#x65F6;&#x590D;&#x5236;&#xFF08;copy-on-write&#xFF09;&#x6280;&#x672F;&#x6765;&#x5904;&#x7406;&#x3002;&#xFF08;[Bach, 1986]&#x548C;[Bovert &amp; Cersati, 2005]&#x63CF;&#x8FF0;&#x4E86;&#x5199;&#x65F6;&#x590D;&#x5236;&#x7684;&#x5B9E;&#x73B0;&#x3002;&#xFF09;&#x6700;&#x521D;&#xFF0C;&#x5185;&#x6838;&#x505A;&#x4E86;&#x4E00;&#x4E9B;&#x8BBE;&#x7F6E;&#xFF0C;&#x4EE4;&#x8FD9;&#x4E9B;&#x6BB5;&#x7684;&#x9875;&#x8868;&#x9879;&#x6307;&#x5411;&#x4E0E;&#x7236;&#x8FDB;&#x7A0B;&#x76F8;&#x540C;&#x7684;&#x7269;&#x7406;&#x5185;&#x5B58;&#x9875;&#xFF0C;&#x5E76;&#x5C06;&#x8FD9;&#x4E9B;&#x9875;&#x9762;&#x81EA;&#x8EAB;&#x6807;&#x8BB0;&#x4E3A;&#x53EA;&#x8BFB;&#x3002;&#x8C03;&#x7528; fork()&#x4E4B;&#x540E;&#xFF0C;&#x5185;&#x6838;&#x4F1A;&#x6355;&#x83B7;&#x6240;&#x6709;&#x7236;&#x8FDB;&#x7A0B;&#x6216;&#x5B50;&#x8FDB;&#x7A0B;&#x9488;&#x5BF9;&#x8FD9;&#x4E9B;&#x9875;&#x9762;&#x7684;&#x4FEE;&#x6539;&#x4F01;&#x56FE;&#xFF0C;&#x5E76;&#x4E3A;&#x5C06;&#x8981;&#x4FEE;&#x6539;&#x7684;&#xFF08;about-to-be-modified&#xFF09;&#x9875;&#x9762;&#x521B;&#x5EFA;&#x62F7;&#x8D1D;&#x3002;&#x7CFB;&#x7EDF;&#x5C06;&#x65B0;&#x7684;&#x9875;&#x9762;&#x62F7;&#x8D1D;&#x5206;&#x914D;&#x7ED9;&#x906D;&#x5185;&#x6838;&#x6355;&#x83B7;&#x7684;&#x8FDB;&#x7A0B;&#xFF0C;&#x8FD8;&#x4F1A;&#x5BF9;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x76F8;&#x5E94;&#x9875;&#x8868;&#x9879;&#x505A;&#x9002;&#x5F53;&#x8C03;&#x6574;&#x3002;&#x4ECE;&#x8FD9;&#x4E00;&#x523B;&#x8D77;&#xFF0C;&#x7236;&#x3001;&#x5B50;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x5206;&#x522B;&#x4FEE;&#x6539;&#x5404;&#x81EA;&#x7684;&#x9875;&#x62F7;&#x8D1D;&#xFF0C;&#x4E0D;&#x518D;&#x76F8;&#x4E92;&#x5F71;&#x54CD;&#x3002;</li>
</ul>
<h2 id="&#x7CFB;&#x7EDF;&#x8C03;&#x7528;vfork"><a href="#&#x7CFB;&#x7EDF;&#x8C03;&#x7528;vfork" class="headerlink" title="&#x7CFB;&#x7EDF;&#x8C03;&#x7528;vfork()"></a>&#x7CFB;&#x7EDF;&#x8C03;&#x7528;vfork()</h2><p>&#x5728;&#x65E9;&#x671F;&#x7684;BSD&#x5B9E;&#x73B0;&#x4E2D;&#xFF0C;fork()&#x4F1A;&#x5BF9;&#x7236;&#x8FDB;&#x7A0B;&#x7684;&#x6570;&#x636E;&#x6BB5;&#x3001;&#x5806;&#x548C;&#x6808;&#x65BD;&#x884C;&#x4E25;&#x683C;&#x7684;&#x590D;&#x5236;&#x3002;&#x5982;&#x524D;&#x6240;&#x8FF0;&#xFF0C;&#x8FD9;&#x662F;&#x4E00;&#x79CD;&#x6D6A;&#x8D39;&#xFF0C;&#x5C24;&#x5176;&#x662F;&#x5728;&#x8C03;&#x7528;fork()&#x540E;&#x7ACB;&#x5373;&#x6267;&#x884C;exec()&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x3002;&#x51FA;&#x4E8E;&#x8FD9;&#x4E00;&#x539F;&#x56E0;&#xFF0C;BSD&#x7684;&#x540E;&#x671F;&#x7248;&#x672C;&#x5F15;&#x5165;&#x4E86;vfork()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF0C;&#x5C3D;&#x7BA1;&#x5176;&#x8FD0;&#x4F5C;&#x542B;&#x4E49;&#x7A0D;&#x5FAE;&#x6709;&#x4E9B;&#x4E0D;&#x540C;&#xFF08;&#x5B9E;&#x5219;&#x6709;&#x4E9B;&#x602A;&#x5F02;&#xFF09;&#xFF0C;&#x4F46;&#x6548;&#x7387;&#x8981;&#x8FDC;&#x9AD8;&#x4E8E;BSD fork()&#x3002;&#x73B0;&#x4EE3;UNIX&#x91C7;&#x7528;&#x5199;&#x65F6;&#x590D;&#x5236;&#x6280;&#x672F;&#x6765;&#x5B9E;&#x73B0;fork()&#xFF0C;&#x5176;&#x6548;&#x7387;&#x8F83;&#x4E4B;&#x4E8E;&#x65E9;&#x671F;&#x7684;fork()&#x5B9E;&#x73B0;&#x8981;&#x9AD8;&#x51FA;&#x8BB8;&#x591A;&#xFF0C;&#x8FDB;&#x800C;&#x5C06;&#x5BF9;vfork()&#x7684;&#x9700;&#x6C42;&#x5254;&#x9664;&#x6B86;&#x5C3D;&#x3002;&#x867D;&#x7136;&#x5982;&#x6B64;&#xFF0C;Linux&#xFF08;&#x5982;&#x540C;&#x8BB8;&#x591A;&#x5176;&#x4ED6;&#x7684;UNIX&#x5B9E;&#x73B0;&#x4E00;&#x6837;&#xFF09;&#x8FD8;&#x662F;&#x63D0;&#x4F9B;&#x4E86;&#x5177;&#x6709;BSD&#x8BED;&#x4E49;&#x7684;vfork()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF0C;&#x4EE5;&#x671F;&#x4E3A;&#x7A0B;&#x5E8F;&#x63D0;&#x4F9B;&#x5C3D;&#x53EF;&#x80FD;&#x5FEB;&#x7684;fork&#x529F;&#x80FD;&#x3002;&#x4E0D;&#x8FC7;&#xFF0C;&#x9274;&#x4E8E;vfork()&#x7684;&#x602A;&#x5F02;&#x8BED;&#x4E49;&#x53EF;&#x80FD;&#x4F1A;&#x5BFC;&#x81F4;&#x4E00;&#x4E9B;&#x96BE;&#x4EE5;&#x5BDF;&#x89C9;&#x7684;&#x7A0B;&#x5E8F;&#x7F3A;&#x9677;&#xFF08;bug&#xFF09;&#xFF0C;&#x9664;&#x975E;&#x80FD;&#x7ED9;&#x6027;&#x80FD;&#x5E26;&#x6765;&#x91CD;&#x5927;&#x63D0;&#x5347;&#xFF08;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x53D1;&#x751F;&#x7684;&#x6982;&#x7387;&#x6781;&#x5C0F;&#xFF09;&#xFF0C;&#x5426;&#x5219;&#x5E94;&#x5F53;&#x5C3D;&#x91CF;&#x907F;&#x514D;&#x4F7F;&#x7528;&#x8FD9;&#x4E00;&#x8C03;&#x7528;&#x3002;</p>
<h2 id="fork-&#x4E4B;&#x540E;&#x7684;&#x7ADE;&#x4E89;&#x6761;&#x4EF6;&#xFF08;Race-Condition&#xFF09;"><a href="#fork-&#x4E4B;&#x540E;&#x7684;&#x7ADE;&#x4E89;&#x6761;&#x4EF6;&#xFF08;Race-Condition&#xFF09;" class="headerlink" title="fork()&#x4E4B;&#x540E;&#x7684;&#x7ADE;&#x4E89;&#x6761;&#x4EF6;&#xFF08;Race Condition&#xFF09;"></a>fork()&#x4E4B;&#x540E;&#x7684;&#x7ADE;&#x4E89;&#x6761;&#x4EF6;&#xFF08;Race Condition&#xFF09;</h2><p>&#x8C03;&#x7528; fork()&#x540E;&#xFF0C;&#x65E0;&#x6CD5;&#x786E;&#x5B9A;&#x7236;&#x3001;&#x5B50;&#x8FDB;&#x7A0B;&#x95F4;&#x8C01;&#x5C06;&#x7387;&#x5148;&#x8BBF;&#x95EE; CPU&#x3002;&#xFF08;&#x5728;&#x591A;&#x5904;&#x7406;&#x5668;&#x7CFB;&#x7EDF;&#x4E2D;&#xFF0C;&#x5B83;&#x4EEC;&#x53EF;&#x80FD;&#x4F1A;&#x540C;&#x65F6;&#x5404;&#x81EA;&#x8BBF;&#x95EE;&#x4E00;&#x4E2A; CPU&#x3002;&#xFF09;&#x5C31;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x800C;&#x8A00;&#xFF0C;&#x5982;&#x679C;&#x4E3A;&#x4E86;&#x4EA7;&#x751F;&#x6B63;&#x786E;&#x7684;&#x7ED3;&#x679C;&#x800C;&#x6216;&#x660E;&#x6216;&#x6697;&#xFF08;implicitly or explicitly&#xFF09;&#x5730;&#x4F9D;&#x8D56;&#x4E8E;&#x7279;&#x5B9A;&#x7684;&#x6267;&#x884C;&#x5E8F;&#x5217;&#xFF0C;&#x90A3;&#x4E48;&#x5C06;&#x53EF;&#x80FD;&#x56E0;&#x7ADE;&#x4E89;&#x6761;&#x4EF6;&#x800C;&#x5BFC;&#x81F4;&#x5931;&#x8D25;&#x3002;&#x7531;&#x4E8E;&#x6B64;&#x7C7B;&#x95EE;&#x9898;&#x7684;&#x53D1;&#x751F;&#x53D6;&#x51B3;&#x4E8E;&#x5185;&#x6838;&#x6839;&#x636E;&#x7CFB;&#x7EDF;&#x5F53;&#x65F6;&#x7684;&#x8D1F;&#x8F7D;&#x800C;&#x505A;&#x51FA;&#x7684;&#x8C03;&#x5EA6;&#x51B3;&#x5B9A;&#xFF0C;&#x6545;&#x800C;&#x5F80;&#x5F80;&#x96BE;&#x4EE5;&#x53D1;&#x73B0;&#x3002;</p>
<p>&#x5176;&#x5206;&#x6790;&#x7ED3;&#x679C;&#x8868;&#x660E;&#xFF0C;&#x9664;&#x53BB;332&#x6B21;&#x4E4B;&#x5916;&#xFF0C;&#x90FD;&#x662F;&#x7531;&#x7236;&#x8FDB;&#x7A0B;&#x5148;&#x884C;&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF08;&#x5360;&#x603B;&#x6570;&#x7684;99.97%&#xFF09;&#x3002;</p>
<p>&#x4F9D;&#x636E;&#x8FD9;&#x4E00;&#x7ED3;&#x679C;&#x53EF;&#x4EE5;&#x63A8;&#x6D4B;&#xFF0C;&#x5728;Linux 2.2.19&#x4E2D;&#xFF0C;fork()&#x4E4B;&#x540E;&#x603B;&#x662F;&#x7EE7;&#x7EED;&#x6267;&#x884C;&#x7236;&#x8FDB;&#x7A0B;&#x3002;&#x800C;&#x5B50;&#x8FDB;&#x7A0B;&#x4E4B;&#x6240;&#x4EE5;&#x5728;0.03%&#x7684;&#x60C5;&#x51B5;&#x4E2D;&#x9996;&#x5148;&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#xFF0C;&#x662F;&#x56E0;&#x4E3A;&#x7236;&#x8FDB;&#x7A0B;&#x5728;&#x6709;&#x673A;&#x4F1A;&#x8F93;&#x51FA;&#x6D88;&#x606F;&#x4E4B;&#x524D;&#xFF0C;&#x5176;CPU&#x65F6;&#x95F4;&#x7247;&#xFF08;CPU time slice&#xFF09;&#x5C31;&#x5230;&#x671F;&#x4E86;&#x3002;&#x6362;&#x8A00;&#x4E4B;&#xFF0C;&#x5982;&#x679C;&#x8BE5;&#x7A0B;&#x5E8F;&#x6240;&#x4EE3;&#x8868;&#x7684;&#x60C5;&#x51B5;&#x603B;&#x662F;&#x4F9D;&#x8D56;&#x4E8E;&#x5982;&#x4E0B;&#x5047;&#x8BBE;&#xFF0C;&#x5373;fork()&#x4E4B;&#x540E;&#x603B;&#x662F;&#x8C03;&#x5EA6;&#x7236;&#x8FDB;&#x7A0B;&#xFF0C;&#x90A3;&#x4E48;&#x7A0B;&#x5E8F;&#x901A;&#x5E38;&#x53EF;&#x4EE5;&#x6B63;&#x5E38;&#x8FD0;&#x884C;&#xFF0C;&#x4E0D;&#x8FC7;&#x6BCF;3000&#x6B21;&#x5C06;&#x4F1A;&#x51FA;&#x73B0;&#x4E00;&#x6B21;&#x9519;&#x8BEF;&#x3002;&#x5F53;&#x7136;&#xFF0C;&#x5982;&#x679C;&#x5E0C;&#x671B;&#x7236;&#x8FDB;&#x7A0B;&#x80FD;&#x5728;&#x8C03;&#x5EA6;&#x5B50;&#x8FDB;&#x7A0B;&#x524D;&#x6267;&#x884C;&#x5927;&#x91CF;&#x5DE5;&#x4F5C;&#xFF0C;&#x90A3;&#x4E48;&#x51FA;&#x9519;&#x7684;&#x53EF;&#x80FD;&#x6027;&#x5C06;&#x4F1A;&#x5927;&#x589E;&#x3002;&#x5728;&#x4E00;&#x4E2A;&#x590D;&#x6742;&#x7A0B;&#x5E8F;&#x4E2D;&#x8C03;&#x8BD5;&#x8FD9;&#x6837;&#x7684;&#x9519;&#x8BEF;&#x4F1A;&#x5F88;&#x56F0;&#x96BE;&#x3002;</p>
<p>fork()&#x4E4B;&#x540E;&#x5BF9;&#x7236;&#x3001;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x8C03;&#x5EA6;&#x8C01;&#x5148;&#x8C01;&#x540E;&#xFF1F;&#x5176;&#x7ED3;&#x679C;&#x5B70;&#x4F18;&#x5B70;&#x52A3;&#xFF1F;&#x6700;&#x8FD1;&#x7684;&#x4E00;&#x4E9B;&#x5B9E;&#x9A8C;&#x53C8;&#x63A8;&#x7FFB;&#x4E86;&#x5185;&#x6838;&#x5F00;&#x53D1;&#x8005;&#x5173;&#x4E8E;&#x8FD9;&#x4E00;&#x95EE;&#x9898;&#x7684;&#x8BC4;&#x4F30;&#x3002;&#x4ECE;Linux 2.6.32&#x5F00;&#x59CB;&#xFF0C;&#x7236;&#x8FDB;&#x7A0B;&#x518D;&#x5EA6;&#x6210;&#x4E3A;fork()&#x4E4B;&#x540E;&#xFF0C;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#x7387;&#x5148;&#x8C03;&#x5EA6;&#x7684;&#x5BF9;&#x8C61;&#x3002;&#x5C06;Linux&#x4E13;&#x6709;&#x6587;&#x4EF6;/proc/sys/kernel/sched_child_runs_first&#x8BBE;&#x4E3A;&#x975E;0&#x503C;&#x53EF;&#x4EE5;&#x6539;&#x53D8;&#x8BE5;&#x9ED8;&#x8BA4;&#x8BBE;&#x7F6E;&#x3002;</p>
<p>&#x4E0A;&#x8FF0;&#x8BA8;&#x8BBA;&#x6E05;&#x695A;&#x5730;&#x9610;&#x660E;&#xFF0C;&#x4E0D;&#x5E94;&#x5BF9;fork()&#x4E4B;&#x540E;&#x6267;&#x884C;&#x7236;&#x3001;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x7279;&#x5B9A;&#x987A;&#x5E8F;&#x505A;&#x4EFB;&#x4F55;&#x5047;&#x8BBE;&#x3002;&#x82E5;&#x786E;&#x9700;&#x4FDD;&#x8BC1;&#x67D0;&#x4E00;&#x7279;&#x5B9A;&#x6267;&#x884C;&#x987A;&#x5E8F;&#xFF0C;&#x5219;&#x5FC5;&#x987B;&#x91C7;&#x7528;&#x67D0;&#x79CD;&#x540C;&#x6B65;&#x6280;&#x672F;&#x3002;&#x4F8B;&#x5982;&#x4FE1;&#x53F7;&#x91CF;&#xFF08;semaphore&#xFF09;&#x3001;&#x6587;&#x4EF6;&#x9501;&#xFF08;file lock&#xFF09;&#x4EE5;&#x53CA;&#x8FDB;&#x7A0B;&#x95F4;&#x7ECF;&#x7531;&#x7BA1;&#x9053;&#xFF08;pipe&#xFF09;&#x7684;&#x6D88;&#x606F;&#x53D1;&#x9001;&#x3002;</p>
<h2 id="&#x540C;&#x6B65;&#x4FE1;&#x53F7;&#x4EE5;&#x89C4;&#x907F;&#x7ADE;&#x4E89;&#x6761;&#x4EF6;"><a href="#&#x540C;&#x6B65;&#x4FE1;&#x53F7;&#x4EE5;&#x89C4;&#x907F;&#x7ADE;&#x4E89;&#x6761;&#x4EF6;" class="headerlink" title="&#x540C;&#x6B65;&#x4FE1;&#x53F7;&#x4EE5;&#x89C4;&#x907F;&#x7ADE;&#x4E89;&#x6761;&#x4EF6;"></a>&#x540C;&#x6B65;&#x4FE1;&#x53F7;&#x4EE5;&#x89C4;&#x907F;&#x7ADE;&#x4E89;&#x6761;&#x4EF6;</h2><p>&#x8C03;&#x7528;fork()&#x4E4B;&#x540E;&#xFF0C;&#x5982;&#x679C;&#x8FDB;&#x7A0B;&#x67D0;&#x7532;&#x9700;&#x7B49;&#x5F85;&#x8FDB;&#x7A0B;&#x67D0;&#x4E59;&#x5B8C;&#x6210;&#x67D0;&#x4E00;&#x52A8;&#x4F5C;&#xFF0C;&#x90A3;&#x4E48;&#x67D0;&#x4E59;&#xFF08;&#x5373;&#x6D3B;&#x52A8;&#x8FDB;&#x7A0B;&#xFF09;&#x53EF;&#x5728;&#x52A8;&#x4F5C;&#x5B8C;&#x6210;&#x540E;&#x5411;&#x67D0;&#x7532;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#xFF1B;&#x67D0;&#x7532;&#x5219;&#x7B49;&#x5F85;&#x5373;&#x53EF;&#x3002;</p>
<h1 id="&#x8FDB;&#x7A0B;&#xFF1A;&#x8FDB;&#x7A0B;&#x7684;&#x7EC8;&#x6B62;"><a href="#&#x8FDB;&#x7A0B;&#xFF1A;&#x8FDB;&#x7A0B;&#x7684;&#x7EC8;&#x6B62;" class="headerlink" title="&#x8FDB;&#x7A0B;&#xFF1A;&#x8FDB;&#x7A0B;&#x7684;&#x7EC8;&#x6B62;"></a>&#x8FDB;&#x7A0B;&#xFF1A;&#x8FDB;&#x7A0B;&#x7684;&#x7EC8;&#x6B62;</h1><h2 id="&#x8FDB;&#x7A0B;&#x7684;&#x7EC8;&#x6B62;&#xFF1A;-exit-&#x548C;exit"><a href="#&#x8FDB;&#x7A0B;&#x7684;&#x7EC8;&#x6B62;&#xFF1A;-exit-&#x548C;exit" class="headerlink" title="&#x8FDB;&#x7A0B;&#x7684;&#x7EC8;&#x6B62;&#xFF1A;_exit()&#x548C;exit()"></a>&#x8FDB;&#x7A0B;&#x7684;&#x7EC8;&#x6B62;&#xFF1A;_exit()&#x548C;exit()</h2><p>&#x901A;&#x5E38;&#xFF0C;&#x8FDB;&#x7A0B;&#x6709;&#x4E24;&#x79CD;&#x7EC8;&#x6B62;&#x65B9;&#x5F0F;&#x3002;&#x5176;&#x4E00;&#x4E3A;&#x5F02;&#x5E38;&#xFF08;abnormal&#xFF09;&#x7EC8;&#x6B62;&#xFF0C;&#x7531;&#x5BF9;&#x4E00;&#x4FE1;&#x53F7;&#x7684;&#x63A5;&#x6536;&#x800C;&#x5F15;&#x53D1;&#xFF0C;&#x8BE5;&#x4FE1;&#x53F7;&#x7684;&#x9ED8;&#x8BA4;&#x52A8;&#x4F5C;&#x4E3A;&#x7EC8;&#x6B62;&#x5F53;&#x524D;&#x8FDB;&#x7A0B;&#xFF0C;&#x53EF;&#x80FD;&#x4EA7;&#x751F;&#x6838;&#x5FC3;&#x8F6C;&#x50A8;&#xFF08;core dump&#xFF09;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x8FDB;&#x7A0B;&#x53EF;&#x4F7F;&#x7528;_exit()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x6B63;&#x5E38;&#xFF08;normally&#xFF09;&#x7EC8;&#x6B62;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;unistd.h&gt;</span></span>

<span class="token keyword">void</span> <span class="token function">_exit</span><span class="token punctuation">(</span><span class="token keyword">int</span> status<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>_exit()&#x7684;status&#x53C2;&#x6570;&#x5B9A;&#x4E49;&#x4E86;&#x8FDB;&#x7A0B;&#x7684;&#x7EC8;&#x6B62;&#x72B6;&#x6001;&#xFF08;termination status&#xFF09;&#xFF0C;&#x7236;&#x8FDB;&#x7A0B;&#x53EF;&#x8C03;&#x7528;wait()&#x4EE5;&#x83B7;&#x53D6;&#x8BE5;&#x72B6;&#x6001;&#x3002;&#x867D;&#x7136;&#x5C06;&#x5176;&#x5B9A;&#x4E49;&#x4E3A;int&#x7C7B;&#x578B;&#xFF0C;&#x4F46;&#x4EC5;&#x6709;&#x4F4E;8&#x4F4D;&#x53EF;&#x4E3A;&#x7236;&#x8FDB;&#x7A0B;&#x6240;&#x7528;&#x3002;&#x6309;&#x7167;&#x60EF;&#x4F8B;&#xFF0C;&#x7EC8;&#x6B62;&#x72B6;&#x6001;&#x4E3A;0&#x8868;&#x793A;&#x8FDB;&#x7A0B;&#x201C;&#x529F;&#x6210;&#x8EAB;&#x9000;&#x201D;&#xFF0C;&#x800C;&#x975E;0&#x503C;&#x5219;&#x8868;&#x793A;&#x8FDB;&#x7A0B;&#x56E0;&#x5F02;&#x5E38;&#x800C;&#x9000;&#x51FA;&#x3002;&#x5BF9;&#x975E;0&#x8FD4;&#x56DE;&#x503C;&#x7684;&#x89E3;&#x91CA;&#x5219;&#x5E76;&#x65E0;&#x5B9A;&#x4F8B;&#xFF1B;&#x4E0D;&#x540C;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x81EA;&#x6210;&#x4E00;&#x6D3E;&#xFF0C;&#x5E76;&#x4F1A;&#x5728;&#x6587;&#x6863;&#x4E2D;&#x52A0;&#x4EE5;&#x63CF;&#x8FF0;&#x3002;SUSv3&#x89C4;&#x5B9A;&#x6709;&#x4E24;&#x4E2A;&#x5E38;&#x91CF;&#xFF1A;EXIT_SUCCESS(0)&#x548C;EXIT_FAILURE(1)&#xFF0C;&#x8C03;&#x7528;_exit()&#x7684;&#x7A0B;&#x5E8F;&#x603B;&#x4F1A;&#x6210;&#x529F;&#x7EC8;&#x6B62;&#xFF08;&#x5373;&#xFF0C;_exit()&#x4ECE;&#x4E0D;&#x8FD4;&#x56DE;&#xFF09;&#x3002;<br>&#x867D;&#x7136;&#x53EF;&#x5C06;0&#xFF5E;255&#x4E4B;&#x95F4;&#x7684;&#x4EFB;&#x610F;&#x503C;&#x8D4B;&#x7ED9;_exit()&#x7684;status&#x53C2;&#x6570;&#xFF0C;&#x5E76;&#x4F20;&#x9012;&#x7ED9;&#x7236;&#x8FDB;&#x7A0B;&#xFF0C;&#x4E0D;&#x8FC7;&#x5982;&#x53D6;&#x503C;&#x5927;&#x4E8E;128&#x5C06;&#x5728;shell&#x811A;&#x672C;&#x4E2D;&#x5F15;&#x53D1;&#x6DF7;&#x4E71;&#x3002;&#x539F;&#x56E0;&#x5728;&#x4E8E;&#xFF0C;&#x5F53;&#x4EE5;&#x4FE1;&#x53F7;&#xFF08;signal&#xFF09;&#x7EC8;&#x6B62;&#x4E00;&#x547D;&#x4EE4;&#x65F6;&#xFF0C;shell &#x4F1A;&#x5C06;&#x53D8;&#x91CF;$?&#x7F6E;&#x4E3A; 128 &#x4E0E;&#x4FE1;&#x53F7;&#x503C;&#x4E4B;&#x548C;&#xFF0C;&#x4EE5;&#x8868;&#x5F81;&#x8FD9;&#x4E00;&#x4E8B;&#x5B9E;&#x3002;&#x5982;&#x679C;&#x8FD9;&#x4E0E;&#x8FDB;&#x7A0B;&#x8C03;&#x7528;_exit()&#x65F6;&#x6240;&#x4F7F;&#x7528;&#x7684;&#x76F8;&#x540C;status&#x503C;&#x6DF7;&#x6742;&#x8D77;&#x6765;&#xFF0C;&#x5C06;&#x4EE4;shell&#x65E0;&#x6CD5;&#x533A;&#x5206;&#x3002;</p>
<p>&#x7A0B;&#x5E8F;&#x4E00;&#x822C;&#x4E0D;&#x4F1A;&#x76F4;&#x63A5;&#x8C03;&#x7528;_exit()&#xFF0C;&#x800C;&#x662F;&#x8C03;&#x7528;&#x5E93;&#x51FD;&#x6570; exit()&#xFF0C;&#x5B83;&#x4F1A;&#x5728;&#x8C03;&#x7528;_exit()&#x524D;&#x6267;&#x884C;&#x5404;&#x79CD;&#x52A8;&#x4F5C;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdlib.h&gt;</span></span>

<span class="token keyword">void</span> <span class="token function">exit</span><span class="token punctuation">(</span><span class="token keyword">int</span> status<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>exit()&#x4F1A;&#x6267;&#x884C;&#x7684;&#x52A8;&#x4F5C;&#x5982;&#x4E0B;&#x3002;</p>
<ul>
<li>&#x8C03;&#x7528;&#x9000;&#x51FA;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#xFF08;&#x901A;&#x8FC7; atexit()&#x548C; on_exit()&#x6CE8;&#x518C;&#x7684;&#x51FD;&#x6570;&#xFF09;&#xFF0C;&#x5176;&#x6267;&#x884C;&#x987A;&#x5E8F;&#x4E0E;&#x6CE8;&#x518C;&#x987A;&#x5E8F;&#x76F8;&#x53CD;&#x3002;</li>
<li>&#x5237;&#x65B0;stdio&#x6D41;&#x7F13;&#x51B2;&#x533A;&#x3002;</li>
<li>&#x4F7F;&#x7528;&#x7531;status&#x63D0;&#x4F9B;&#x7684;&#x503C;&#x6267;&#x884C;_exit()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x3002;</li>
</ul>
<p>&#x7A0B;&#x5E8F;&#x7684;&#x53E6;&#x4E00;&#x79CD;&#x7EC8;&#x6B62;&#x65B9;&#x6CD5;&#x662F;&#x4ECE; main()&#x51FD;&#x6570;&#x4E2D;&#x8FD4;&#x56DE;&#xFF08;return&#xFF09;&#xFF0C;&#x6216;&#x8005;&#x6216;&#x660E;&#x6216;&#x6697;&#x5730;&#x4E00;&#x76F4;&#x6267;&#x884C;&#x5230;main()&#x51FD;&#x6570;&#x7684;&#x7ED3;&#x5C3E;&#x5904;&#x3002;&#x6267;&#x884C;return n&#x7B49;&#x540C;&#x4E8E;&#x6267;&#x884C;&#x5BF9;exit(n)&#x7684;&#x8C03;&#x7528;&#xFF0C;&#x56E0;&#x4E3A;&#x8C03;&#x7528; main()&#x7684;&#x8FD0;&#x884C;&#x65F6;&#x51FD;&#x6570;&#x4F1A;&#x5C06; main()&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x4F5C;&#x4E3A; exit()&#x7684;&#x53C2;&#x6570;&#x3002;</p>
<h2 id="&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#x7684;&#x7EC6;&#x8282;"><a href="#&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#x7684;&#x7EC6;&#x8282;" class="headerlink" title="&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#x7684;&#x7EC6;&#x8282;"></a>&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#x7684;&#x7EC6;&#x8282;</h2><p>&#x65E0;&#x8BBA;&#x8FDB;&#x7A0B;&#x662F;&#x5426;&#x6B63;&#x5E38;&#x7EC8;&#x6B62;&#xFF0C;&#x90FD;&#x4F1A;&#x53D1;&#x751F;&#x5982;&#x4E0B;&#x52A8;&#x4F5C;&#x3002;</p>
<ul>
<li>&#x5173;&#x95ED;&#x6240;&#x6709;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x3001;&#x76EE;&#x5F55;&#x6D41;&#xFF08;18.8&#x8282;&#xFF09;&#x3001;&#x4FE1;&#x606F;&#x76EE;&#x5F55;&#x63CF;&#x8FF0;&#x7B26;&#xFF08;&#x53C2;&#x8003;&#x624B;&#x518C;&#x9875;catopen(3)&#x548C;catgets(3)&#xFF09;&#xFF0C;&#x4EE5;&#x53CA;&#xFF08;&#x5B57;&#x7B26;&#x96C6;&#xFF09;&#x8F6C;&#x6362;&#x63CF;&#x8FF0;&#x7B26;&#xFF08;&#x89C1;iconv_open(3)&#x624B;&#x518C;&#x9875;&#xFF09;&#x3002;</li>
<li>&#x4F5C;&#x4E3A;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x5173;&#x95ED;&#x7684;&#x540E;&#x679C;&#x4E4B;&#x4E00;&#xFF0C;&#x5C06;&#x91CA;&#x653E;&#x8BE5;&#x8FDB;&#x7A0B;&#x6240;&#x6301;&#x6709;&#x7684;&#x4EFB;&#x4F55;&#x6587;&#x4EF6;&#x9501;&#xFF08;&#x7B2C;55&#x7AE0;&#xFF09;&#x3002;</li>
<li>&#x5206;&#x79BB;&#xFF08;detach&#xFF09;&#x4EFB;&#x4F55;&#x5DF2;&#x8FDE;&#x63A5;&#x7684;System V&#x5171;&#x4EAB;&#x5185;&#x5B58;&#x6BB5;&#xFF0C;&#x4E14;&#x5BF9;&#x5E94;&#x4E8E;&#x5404;&#x6BB5;&#x7684;shm_nattch&#x8BA1;&#x6570;&#x5668;&#x503C;&#x5C06;&#x51CF;&#x4E00;&#x3002;&#xFF08;&#x53C2;&#x8003;48.8&#x8282;&#x3002;&#xFF09;</li>
<li>&#x8FDB;&#x7A0B;&#x4E3A;&#x6BCF;&#x4E2A;System V&#x4FE1;&#x53F7;&#x91CF;&#x6240;&#x8BBE;&#x7F6E;&#x7684;semadj&#x503C;&#x5C06;&#x4F1A;&#x88AB;&#x52A0;&#x5230;&#x4FE1;&#x53F7;&#x91CF;&#x503C;&#x4E2D;&#xFF08;&#x53C2;&#x8003;47.8&#x8282;&#xFF09;&#x3002;</li>
<li>&#x5982;&#x679C;&#x8BE5;&#x8FDB;&#x7A0B;&#x662F;&#x4E00;&#x4E2A;&#x7BA1;&#x7406;&#x7EC8;&#x7AEF;&#xFF08;terminal&#xFF09;&#x7684;&#x7BA1;&#x7406;&#x8FDB;&#x7A0B;&#xFF0C;&#x90A3;&#x4E48;&#x7CFB;&#x7EDF;&#x4F1A;&#x5411;&#x8BE5;&#x7EC8;&#x7AEF;&#x524D;&#x53F0;&#xFF08;foreground&#xFF09;&#x8FDB;&#x7A0B;&#x7EC4;&#x4E2D;&#x7684;&#x6BCF;&#x4E2A;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;SIGHUP&#x4FE1;&#x53F7;&#xFF0C;&#x63A5;&#x7740;&#x7EC8;&#x7AEF;&#x4F1A;&#x4E0E;&#x4F1A;&#x8BDD;&#xFF08;session&#xFF09;&#x8131;&#x79BB;&#x3002;34.6&#x8282;&#x5C06;&#x5C31;&#x6B64;&#x8FDB;&#x884C;&#x6DF1;&#x5165;&#x8BA8;&#x8BBA;&#x3002;</li>
<li>&#x5C06;&#x5173;&#x95ED;&#x8BE5;&#x8FDB;&#x7A0B;&#x6253;&#x5F00;&#x7684;&#x4EFB;&#x4F55;POSIX&#x6709;&#x540D;&#x4FE1;&#x53F7;&#x91CF;&#xFF0C;&#x7C7B;&#x4F3C;&#x4E8E;&#x8C03;&#x7528;sem_close()&#x3002;</li>
<li>&#x5C06;&#x5173;&#x95ED;&#x8BE5;&#x8FDB;&#x7A0B;&#x6253;&#x5F00;&#x7684;&#x4EFB;&#x4F55;POSIX&#x6D88;&#x606F;&#x961F;&#x5217;&#xFF0C;&#x7C7B;&#x4F3C;&#x4E8E;&#x8C03;&#x7528;mq_close()&#x3002;</li>
<li>&#x4F5C;&#x4E3A;&#x8FDB;&#x7A0B;&#x9000;&#x51FA;&#x7684;&#x540E;&#x679C;&#x4E4B;&#x4E00;&#xFF0C;&#x5982;&#x679C;&#x67D0;&#x8FDB;&#x7A0B;&#x7EC4;&#x6210;&#x4E3A;&#x5B64;&#x513F;&#xFF0C;&#x4E14;&#x8BE5;&#x7EC4;&#x4E2D;&#x5B58;&#x5728;&#x4EFB;&#x4F55;&#x5DF2;&#x505C;&#x6B62;&#x8FDB;&#x7A0B;&#xFF08;stopped processes&#xFF09;&#xFF0C;&#x5219;&#x7EC4;&#x4E2D;&#x6240;&#x6709;&#x8FDB;&#x7A0B;&#x90FD;&#x5C06;&#x6536;&#x5230;SIGHUP&#x4FE1;&#x53F7;&#xFF0C;&#x968F;&#x4E4B;&#x4E3A;SIGCONT&#x4FE1;&#x53F7;&#x3002;34.7.4&#x8282;&#x5C06;&#x6DF1;&#x5165;&#x8BA8;&#x8BBA;&#x8FD9;&#x4E00;&#x70B9;&#x3002;</li>
<li>&#x79FB;&#x9664;&#x8BE5;&#x8FDB;&#x7A0B;&#x901A;&#x8FC7;mlock()&#x6216;mlockall()&#xFF08;50.2&#x8282;&#xFF09;&#x6240;&#x5EFA;&#x7ACB;&#x7684;&#x4EFB;&#x4F55;&#x5185;&#x5B58;&#x9501;&#x3002;</li>
<li>&#x53D6;&#x6D88;&#x8BE5;&#x8FDB;&#x7A0B;&#x8C03;&#x7528;mmap()&#x6240;&#x521B;&#x5EFA;&#x7684;&#x4EFB;&#x4F55;&#x5185;&#x5B58;&#x6620;&#x5C04;&#xFF08;mapping&#xFF09;&#x3002;</li>
</ul>
<h2 id="&#x9000;&#x51FA;&#x5904;&#x7406;&#x7A0B;&#x5E8F;"><a href="#&#x9000;&#x51FA;&#x5904;&#x7406;&#x7A0B;&#x5E8F;" class="headerlink" title="&#x9000;&#x51FA;&#x5904;&#x7406;&#x7A0B;&#x5E8F;"></a>&#x9000;&#x51FA;&#x5904;&#x7406;&#x7A0B;&#x5E8F;</h2><p>&#x6709;&#x65F6;&#xFF0C;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x9700;&#x8981;&#x5728;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#x65F6;&#x81EA;&#x52A8;&#x6267;&#x884C;&#x4E00;&#x4E9B;&#x64CD;&#x4F5C;&#x3002;&#x8BD5;&#x4EE5;&#x4E00;&#x4E2A;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5E93;&#x4E3A;&#x4F8B;&#xFF0C;&#x5982;&#x679C;&#x8FDB;&#x7A0B;&#x4F7F;&#x7528;&#x4E86;&#x8BE5;&#x7A0B;&#x5E8F;&#x5E93;&#xFF0C;&#x90A3;&#x4E48;&#x5728;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#x524D;&#x8BE5;&#x5E93;&#x9700;&#x8981;&#x81EA;&#x52A8;&#x6267;&#x884C;&#x4E00;&#x4E9B;&#x6E05;&#x7406;&#x52A8;&#x4F5C;&#x3002;&#x56E0;&#x4E3A;&#x5E93;&#x672C;&#x8EAB;&#x5BF9;&#x4E8E;&#x8FDB;&#x7A0B;&#x4F55;&#x65F6;&#x4EE5;&#x53CA;&#x5982;&#x4F55;&#x9000;&#x51FA;&#x5E76;&#x65E0;&#x63A7;&#x5236;&#x6743;&#xFF0C;&#x4E5F;&#x65E0;&#x6CD5;&#x8981;&#x6C42;&#x4E3B;&#x7A0B;&#x5E8F;&#x5728;&#x9000;&#x51FA;&#x524D;&#x8C03;&#x7528;&#x5E93;&#x4E2D;&#x7279;&#x5B9A;&#x7684;&#x6E05;&#x7406;&#x51FD;&#x6570;&#xFF0C;&#x6545;&#x800C;&#x4E5F;&#x4E0D;&#x80FD;&#x4FDD;&#x8BC1;&#x4E00;&#x5B9A;&#x4F1A;&#x6267;&#x884C;&#x6E05;&#x7406;&#x52A8;&#x4F5C;&#x3002;&#x89E3;&#x51B3;&#x8FD9;&#x4E00;&#x95EE;&#x9898;&#x7684;&#x65B9;&#x6CD5;&#x4E4B;&#x4E00;&#x662F;&#x4F7F;&#x7528;&#x9000;&#x51FA;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#xFF08;exit handler&#xFF09;&#x3002;&#x8001;&#x7248; System V &#x624B;&#x518C;&#x5219;&#x4F7F;&#x7528;&#x672F;&#x8BED;&#x201C;&#x7A0B;&#x5E8F;&#x7EC8;&#x6B62;&#x8FC7;&#x7A0B;&#x201D;&#xFF08;program termination routine&#xFF09;&#x3002;</p>
<p>&#x9000;&#x51FA;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x662F;&#x4E00;&#x4E2A;&#x7531;&#x7A0B;&#x5E8F;&#x8BBE;&#x8BA1;&#x8005;&#x63D0;&#x4F9B;&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x53EF;&#x4E8E;&#x8FDB;&#x7A0B;&#x751F;&#x547D;&#x5468;&#x671F;&#x7684;&#x4EFB;&#x610F;&#x65F6;&#x70B9;&#x6CE8;&#x518C;&#xFF0C;&#x5E76;&#x5728;&#x8BE5;&#x8FDB;&#x7A0B;&#x8C03;&#x7528;exit()&#x6B63;&#x5E38;&#x7EC8;&#x6B62;&#x65F6;&#x81EA;&#x52A8;&#x6267;&#x884C;&#x3002;&#x5982;&#x679C;&#x7A0B;&#x5E8F;&#x76F4;&#x63A5;&#x8C03;&#x7528;_exit()&#x6216;&#x56E0;&#x4FE1;&#x53F7;&#x800C;&#x5F02;&#x5E38;&#x7EC8;&#x6B62;&#xFF0C;&#x5219;&#x4E0D;&#x4F1A;&#x8C03;&#x7528;&#x9000;&#x51FA;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x3002;</p>
<p>TODO.</p>
<h2 id="fork-&#x3001;stdio&#x7F13;&#x51B2;&#x533A;&#x4EE5;&#x53CA;-exit-&#x4E4B;&#x95F4;&#x7684;&#x4EA4;&#x4E92;"><a href="#fork-&#x3001;stdio&#x7F13;&#x51B2;&#x533A;&#x4EE5;&#x53CA;-exit-&#x4E4B;&#x95F4;&#x7684;&#x4EA4;&#x4E92;" class="headerlink" title="fork()&#x3001;stdio&#x7F13;&#x51B2;&#x533A;&#x4EE5;&#x53CA;_exit()&#x4E4B;&#x95F4;&#x7684;&#x4EA4;&#x4E92;"></a>fork()&#x3001;stdio&#x7F13;&#x51B2;&#x533A;&#x4EE5;&#x53CA;_exit()&#x4E4B;&#x95F4;&#x7684;&#x4EA4;&#x4E92;</h2><pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;unistd.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Hello world\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">write</span><span class="token punctuation">(</span>STDOUT_FILENO<span class="token punctuation">,</span><span class="token string">&quot;Ciao\n&quot;</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
      <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;fork&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>Hello world
Ciao</code></pre><p>&#x4EE5;&#x4E0A;&#x7A0B;&#x5E8F;&#x5F97;&#x5230;&#x4E86;&#x9884;&#x671F;&#x7684;&#x7ED3;&#x679C;&#x3002;<br>&#x4E0D;&#x8FC7;&#xFF0C;&#x5F53;&#x91CD;&#x5B9A;&#x5411;&#x6807;&#x51C6;&#x8F93;&#x51FA;&#x5230;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x65F6;&#xFF0C;&#x7ED3;&#x679C;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre class="line-numbers language-bash"><code class="language-bash">./a.out <span class="token operator">&gt;</span>b
<span class="token function">cat</span> b<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<pre><code>Ciao
Hello world
Hello world</code></pre><p>&#x4EE5;&#x4E0A;&#x8F93;&#x51FA;&#x4E2D;&#x6709;&#x4E24;&#x4EF6;&#x602A;&#x4E8B;&#xFF1A;printf()&#x7684;&#x8F93;&#x51FA;&#x884C;&#x51FA;&#x73B0;&#x4E86;&#x4E24;&#x6B21;&#xFF0C;&#x4E14;write()&#x7684;&#x8F93;&#x51FA;&#x5148;&#x4E8E;printf()&#x3002;</p>
<p>&#x8981;&#x7406;&#x89E3;&#x4E3A;&#x4EC0;&#x4E48;printf()&#x7684;&#x8F93;&#x51FA;&#x6D88;&#x606F;&#x51FA;&#x73B0;&#x4E86;&#x4E24;&#x6B21;&#xFF0C;&#x9996;&#x5148;&#x8981;&#x8BB0;&#x4F4F;&#xFF0C;&#x662F;&#x5728;&#x8FDB;&#x7A0B;&#x7684;&#x7528;&#x6237;&#x7A7A;&#x95F4;&#x5185;&#x5B58;&#x4E2D;&#xFF08;&#x53C2;&#x8003; 13.2&#x8282;&#xFF09;&#x7EF4;&#x62A4; stdio &#x7F13;&#x51B2;&#x533A;&#x7684;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x901A;&#x8FC7;fork()&#x521B;&#x5EFA;&#x5B50;&#x8FDB;&#x7A0B;&#x65F6;&#x4F1A;&#x590D;&#x5236;&#x8FD9;&#x4E9B;&#x7F13;&#x51B2;&#x533A;&#x3002;&#x5F53;&#x6807;&#x51C6;&#x8F93;&#x51FA;&#x5B9A;&#x5411;&#x5230;&#x7EC8;&#x7AEF;&#x65F6;&#xFF0C;&#x56E0;&#x4E3A;&#x7F3A;&#x7701;&#x4E3A;&#x884C;&#x7F13;&#x51B2;&#xFF0C;&#x6240;&#x4EE5;&#x4F1A;&#x7ACB;&#x5373;&#x663E;&#x793A;&#x51FD;&#x6570;printf()&#x8F93;&#x51FA;&#x7684;&#x5305;&#x542B;&#x6362;&#x884C;&#x7B26;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002;&#x4E0D;&#x8FC7;&#xFF0C;&#x5F53;&#x6807;&#x51C6;&#x8F93;&#x51FA;&#x91CD;&#x5B9A;&#x5411;&#x5230;&#x6587;&#x4EF6;&#x65F6;&#xFF0C;&#x7531;&#x4E8E;&#x7F3A;&#x7701;&#x4E3A;&#x5757;&#x7F13;&#x51B2;&#xFF0C;&#x6240;&#x4EE5;&#x5728;&#x672C;&#x4F8B;&#x4E2D;&#xFF0C;&#x5F53;&#x8C03;&#x7528; fork()&#x65F6;&#xFF0C;printf()&#x8F93;&#x51FA;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x4ECD;&#x5728;&#x7236;&#x8FDB;&#x7A0B;&#x7684; stdio &#x7F13;&#x51B2;&#x533A;&#x4E2D;&#xFF0C;&#x5E76;&#x968F;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x521B;&#x5EFA;&#x800C;&#x4EA7;&#x751F;&#x4E00;&#x4EFD;&#x526F;&#x672C;&#x3002;&#x7236;&#x3001;&#x5B50;&#x8FDB;&#x7A0B;&#x8C03;&#x7528;exit()&#x65F6;&#x4F1A;&#x5237;&#x65B0;&#x5404;&#x81EA;&#x7684; stdio &#x7F13;&#x51B2;&#x533A;&#xFF0C;&#x4ECE;&#x800C;&#x5BFC;&#x81F4;&#x91CD;&#x590D;&#x7684;&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#x3002;</p>
<p>&#x53EF;&#x4EE5;&#x91C7;&#x7528;&#x4EE5;&#x4E0B;&#x4EFB;&#x4E00;&#x65B9;&#x6CD5;&#x6765;&#x907F;&#x514D;&#x91CD;&#x590D;&#x7684;&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#x3002;</p>
<ul>
<li>&#x4F5C;&#x4E3A;&#x9488;&#x5BF9; stdio &#x7F13;&#x51B2;&#x533A;&#x95EE;&#x9898;&#x7684;&#x7279;&#x5B9A;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#xFF0C;&#x53EF;&#x4EE5;&#x5728;&#x8C03;&#x7528; fork()&#x4E4B;&#x524D;&#x4F7F;&#x7528;&#x51FD;&#x6570; fflush()&#x6765;&#x5237;&#x65B0;stdio&#x7F13;&#x51B2;&#x533A;&#x3002;&#x4F5C;&#x4E3A;&#x53E6;&#x4E00;&#x79CD;&#x9009;&#x62E9;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;setvbuf()&#x548C;setbuf()&#x6765;&#x5173;&#x95ED;stdio&#x6D41;&#x7684;&#x7F13;&#x51B2;&#x529F;&#x80FD;&#x3002;</li>
<li>&#x5B50;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x8C03;&#x7528;_exit()&#x800C;&#x975E; exit()&#xFF0C;&#x4EE5;&#x4FBF;&#x4E0D;&#x518D;&#x5237;&#x65B0;stdio&#x7F13;&#x51B2;&#x533A;&#x3002;&#x8FD9;&#x4E00;&#x6280;&#x672F;&#x4F8B;&#x8BC1;&#x4E86;&#x4E00;&#x4E2A;&#x66F4;&#x4E3A;&#x901A;&#x7528;&#x7684;&#x539F;&#x5219;&#xFF1A;&#x5728;&#x521B;&#x5EFA;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x5E94;&#x7528;&#x4E2D;&#xFF0C;&#x5178;&#x578B;&#x60C5;&#x51B5;&#x4E0B;&#x4EC5;&#x6709;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#xFF08;&#x4E00;&#x822C;&#x4E3A;&#x7236;&#x8FDB;&#x7A0B;&#xFF09;&#x5E94;&#x901A;&#x8FC7;&#x8C03;&#x7528; exit()&#x7EC8;&#x6B62;&#xFF0C;&#x800C;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x5E94;&#x8C03;&#x7528;_exit()&#x7EC8;&#x6B62;&#xFF0C;&#x4ECE;&#x800C;&#x786E;&#x4FDD;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x8C03;&#x7528;&#x9000;&#x51FA;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x5E76;&#x5237;&#x65B0;stdio&#x7F13;&#x51B2;&#x533A;&#xFF0C;&#x8FD9;&#x4E5F;&#x7B97;&#x662F;&#x4F17;&#x671B;&#x6240;&#x5F52;&#x5427;&#x3002;</li>
</ul>
<p>&#x7A0B;&#x5E8F;&#x6E05;&#x5355;&#x4E2D;write()&#x7684;&#x8F93;&#x51FA;&#x5E76;&#x672A;&#x51FA;&#x73B0;&#x4E24;&#x6B21;&#xFF0C;&#x8FD9;&#x662F;&#x56E0;&#x4E3A;write()&#x4F1A;&#x5C06;&#x6570;&#x636E;&#x76F4;&#x63A5;&#x4F20;&#x7ED9;&#x5185;&#x6838;&#x7F13;&#x51B2;&#x533A;&#xFF0C;fork()&#x4E0D;&#x4F1A;&#x590D;&#x5236;&#x8FD9;&#x4E00;&#x7F13;&#x51B2;&#x533A;&#x3002;</p>
<p>&#x7A0B;&#x5E8F;&#x8F93;&#x51FA;&#x91CD;&#x5B9A;&#x5411;&#x5230;&#x6587;&#x4EF6;&#x65F6;&#x51FA;&#x7684;&#x7B2C;&#x4E8C;&#x4EF6;&#x602A;&#x4E8B;&#xFF0C;&#x539F;&#x56E0;&#x73B0;&#x5728;&#x4E5F;&#x6E05;&#x695A;&#x4E86;&#x3002;write()&#x7684;&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#x5148;&#x4E8E;printf()&#x800C;&#x51FA;&#x73B0;&#xFF0C;&#x662F;&#x56E0;&#x4E3A;write()&#x4F1A;&#x5C06;&#x6570;&#x636E;&#x7ACB;&#x5373;&#x4F20;&#x7ED9;&#x5185;&#x6838;&#x9AD8;&#x901F;&#x7F13;&#x5B58;&#xFF0C;&#x800C;printf()&#x7684;&#x8F93;&#x51FA;&#x5219;&#x9700;&#x8981;&#x7B49;&#x5230;&#x8C03;&#x7528;exit ()&#x5237;&#x65B0;stdio&#x7F13;&#x51B2;&#x533A;&#x65F6;&#x3002;&#xFF08;&#x5982;13.7&#x8282;&#x6240;&#x8FF0;&#xFF0C;&#x901A;&#x5E38;&#xFF0C;&#x5728;&#x6DF7;&#x5408;&#x4F7F;&#x7528;stdio&#x51FD;&#x6570;&#x548C;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5BF9;&#x540C;&#x4E00;&#x6587;&#x4EF6;&#x8FDB;&#x884C;I/O&#x5904;&#x7406;&#x65F6;&#xFF0C;&#x9700;&#x8981;&#x7279;&#x522B;&#x8C28;&#x614E;&#x3002;&#xFF09;</p>
<h1 id="&#x8FDB;&#x7A0B;&#xFF1A;&#x76D1;&#x63A7;&#x5B50;&#x8FDB;&#x7A0B;"><a href="#&#x8FDB;&#x7A0B;&#xFF1A;&#x76D1;&#x63A7;&#x5B50;&#x8FDB;&#x7A0B;" class="headerlink" title="&#x8FDB;&#x7A0B;&#xFF1A;&#x76D1;&#x63A7;&#x5B50;&#x8FDB;&#x7A0B;"></a>&#x8FDB;&#x7A0B;&#xFF1A;&#x76D1;&#x63A7;&#x5B50;&#x8FDB;&#x7A0B;</h1><h2 id="&#x7B49;&#x5F85;&#x5B50;&#x8FDB;&#x7A0B;"><a href="#&#x7B49;&#x5F85;&#x5B50;&#x8FDB;&#x7A0B;" class="headerlink" title="&#x7B49;&#x5F85;&#x5B50;&#x8FDB;&#x7A0B;"></a>&#x7B49;&#x5F85;&#x5B50;&#x8FDB;&#x7A0B;</h2><p>&#x5BF9;&#x4E8E;&#x8BB8;&#x591A;&#x9700;&#x8981;&#x521B;&#x5EFA;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x5E94;&#x7528;&#x6765;&#x8BF4;&#xFF0C;&#x7236;&#x8FDB;&#x7A0B;&#x80FD;&#x591F;&#x76D1;&#x6D4B;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x7EC8;&#x6B62;&#x65F6;&#x95F4;&#x548C;&#x8FC7;&#x7A0B;&#x662F;&#x5F88;&#x6709;&#x5FC5;&#x8981;&#x7684;&#x3002;wait()&#x4EE5;&#x53CA;&#x82E5;&#x5E72;&#x76F8;&#x5173;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x63D0;&#x4F9B;&#x4E86;&#x8FD9;&#x4E00;&#x529F;&#x80FD;&#x3002;</p>
<h3 id="&#x7CFB;&#x7EDF;&#x8C03;&#x7528;wait"><a href="#&#x7CFB;&#x7EDF;&#x8C03;&#x7528;wait" class="headerlink" title="&#x7CFB;&#x7EDF;&#x8C03;&#x7528;wait()"></a>&#x7CFB;&#x7EDF;&#x8C03;&#x7528;wait()</h3><p>&#x7CFB;&#x7EDF;&#x8C03;&#x7528;wait()&#x7B49;&#x5F85;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x7684;&#x4EFB;&#x4E00;&#x5B50;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#xFF0C;&#x540C;&#x65F6;&#x5728;&#x53C2;&#x6570;status&#x6240;&#x6307;&#x5411;&#x7684;&#x7F13;&#x51B2;&#x533A;&#x4E2D;&#x8FD4;&#x56DE;&#x8BE5;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x7EC8;&#x6B62;&#x72B6;&#x6001;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;wait.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">wait</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x7CFB;&#x7EDF;&#x8C03;&#x7528;wait()&#x6267;&#x884C;&#x5982;&#x4E0B;&#x52A8;&#x4F5C;&#x3002;</p>
<ul>
<li>&#x5982;&#x679C;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x5E76;&#x65E0;&#x4E4B;&#x524D;&#x672A;&#x88AB;&#x7B49;&#x5F85;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#xFF0C;&#x8C03;&#x7528;&#x5C06;&#x4E00;&#x76F4;&#x963B;&#x585E;&#xFF0C;&#x76F4;&#x81F3;&#x67D0;&#x4E2A;&#x5B50;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#x3002;&#x5982;&#x679C;&#x8C03;&#x7528;&#x65F6;&#x5DF2;&#x6709;&#x5B50;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#xFF0C;wait()&#x5219;&#x7ACB;&#x5373;&#x8FD4;&#x56DE;&#x3002;</li>
<li>&#x5982;&#x679C;status&#x975E;&#x7A7A;&#xFF0C;&#x90A3;&#x4E48;&#x5173;&#x4E8E;&#x5B50;&#x8FDB;&#x7A0B;&#x5982;&#x4F55;&#x7EC8;&#x6B62;&#x7684;&#x4FE1;&#x606F;&#x5219;&#x4F1A;&#x901A;&#x8FC7;status&#x6307;&#x5411;&#x7684;&#x6574;&#x578B;&#x53D8;&#x91CF;&#x8FD4;&#x56DE;&#x3002;26.1.3&#x8282;&#x5C06;&#x8BA8;&#x8BBA;&#x81EA;status&#x8FD4;&#x56DE;&#x7684;&#x4FE1;&#x606F;&#x3002;</li>
<li>&#x5185;&#x6838;&#x5C06;&#x4F1A;&#x4E3A;&#x7236;&#x8FDB;&#x7A0B;&#x4E0B;&#x6240;&#x6709;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x8FD0;&#x884C;&#x603B;&#x91CF;&#x8FFD;&#x52A0;&#x8FDB;&#x7A0B;CPU&#x65F6;&#x95F4;&#xFF08;10.7&#x8282;&#xFF09;&#x4EE5;&#x53CA;&#x8D44;&#x6E90;&#x4F7F;&#x7528;&#x6570;&#x636E;&#x3002;</li>
<li>&#x5C06;&#x7EC8;&#x6B62;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;ID&#x4F5C;&#x4E3A;wait()&#x7684;&#x7ED3;&#x679C;&#x8FD4;&#x56DE;&#x3002;</li>
</ul>
<p>&#x51FA;&#x9519;&#x65F6;&#xFF0C;wait()&#x8FD4;&#x56DE;-1&#x3002;&#x53EF;&#x80FD;&#x7684;&#x9519;&#x8BEF;&#x539F;&#x56E0;&#x4E4B;&#x4E00;&#x662F;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x5E76;&#x65E0;&#x4E4B;&#x524D;&#x672A;&#x88AB;&#x7B49;&#x5F85;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#xFF0C;&#x6B64;&#x65F6;&#x4F1A;&#x5C06;errno&#x7F6E;&#x4E3A;ECHILD&#x3002;&#x6362;&#x8A00;&#x4E4B;&#xFF0C;&#x53EF;&#x4F7F;&#x7528;&#x5982;&#x4E0B;&#x4EE3;&#x7801;&#x4E2D;&#x7684;&#x5FAA;&#x73AF;&#x6765;&#x7B49;&#x5F85;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x7684;&#x6240;&#x6709;&#x5B50;&#x8FDB;&#x7A0B;&#x9000;&#x51FA;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">while</span><span class="token punctuation">(</span>childPid <span class="token operator">=</span> <span class="token function">wait</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">continue</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>errno <span class="token operator">!=</span> ECHILD<span class="token punctuation">)</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;wait&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="&#x7CFB;&#x7EDF;&#x8C03;&#x7528;waitpid"><a href="#&#x7CFB;&#x7EDF;&#x8C03;&#x7528;waitpid" class="headerlink" title="&#x7CFB;&#x7EDF;&#x8C03;&#x7528;waitpid()"></a>&#x7CFB;&#x7EDF;&#x8C03;&#x7528;waitpid()</h3><p>&#x7CFB;&#x7EDF;&#x8C03;&#x7528;wait()&#x5B58;&#x5728;&#x8BF8;&#x591A;&#x9650;&#x5236;&#xFF0C;&#x800C;&#x8BBE;&#x8BA1;waitpid()&#x5219;&#x610F;&#x5728;&#x7A81;&#x7834;&#x8FD9;&#x4E9B;&#x9650;&#x5236;&#x3002;</p>
<ul>
<li>&#x5982;&#x679C;&#x7236;&#x8FDB;&#x7A0B;&#x5DF2;&#x7ECF;&#x521B;&#x5EFA;&#x4E86;&#x591A;&#x4E2A;&#x5B50;&#x8FDB;&#x7A0B;&#xFF0C;&#x4F7F;&#x7528; wait()&#x5C06;&#x65E0;&#x6CD5;&#x7B49;&#x5F85;&#x67D0;&#x4E2A;&#x7279;&#x5B9A;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x5B8C;&#x6210;&#xFF0C;&#x53EA;&#x80FD;&#x6309;&#x987A;&#x5E8F;&#x7B49;&#x5F85;&#x4E0B;&#x4E00;&#x4E2A;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x7EC8;&#x6B62;&#x3002;</li>
<li>&#x5982;&#x679C;&#x6CA1;&#x6709;&#x5B50;&#x8FDB;&#x7A0B;&#x9000;&#x51FA;&#xFF0C;wait()&#x603B;&#x662F;&#x4FDD;&#x6301;&#x963B;&#x585E;&#x3002;&#x6709;&#x65F6;&#x5019;&#x4F1A;&#x5E0C;&#x671B;&#x6267;&#x884C;&#x975E;&#x963B;&#x585E;&#x7684;&#x7B49;&#x5F85;&#xFF1A;&#x662F;&#x5426;&#x6709;&#x5B50;&#x8FDB;&#x7A0B;&#x9000;&#x51FA;&#xFF0C;&#x7ACB;&#x5224;&#x53EF;&#x77E5;&#x3002;</li>
<li>&#x4F7F;&#x7528;wait()&#x53EA;&#x80FD;&#x53D1;&#x73B0;&#x90A3;&#x4E9B;&#x5DF2;&#x7ECF;&#x7EC8;&#x6B62;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x3002;&#x5BF9;&#x4E8E;&#x5B50;&#x8FDB;&#x7A0B;&#x56E0;&#x67D0;&#x4E2A;&#x4FE1;&#x53F7;&#xFF08;&#x5982;SIGSTOP&#x6216;SIG TTIN&#xFF09;&#x800C;&#x505C;&#x6B62;&#xFF0C;&#x6216;&#x662F;&#x5DF2;&#x505C;&#x6B62;&#x5B50;&#x8FDB;&#x7A0B;&#x6536;&#x5230;SIGCONT&#x4FE1;&#x53F7;&#x540E;&#x6062;&#x590D;&#x6267;&#x884C;&#x7684;&#x60C5;&#x51B5;&#x5C31;&#x65E0;&#x80FD;&#x4E3A;&#x529B;&#x4E86;&#x3002;</li>
</ul>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;sys/wait.h&gt;</span></span>

pid_t <span class="token function">waitpid</span><span class="token punctuation">(</span>pid_t pid<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">*</span> status<span class="token punctuation">,</span><span class="token keyword">int</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x6210;&#x529F;&#x8FD4;&#x56DE;&#x5B50;&#x8FDB;&#x7A0B;id&#xFF0C;&#x5931;&#x8D25;&#x8FD4;&#x56DE;-1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>waitpid()&#x4E0E; wait()&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x4EE5;&#x53CA;&#x53C2;&#x6570; status &#x7684;&#x610F;&#x4E49;&#x76F8;&#x540C;&#x3002;<br>&#x53C2;&#x6570;pid&#x7528;&#x6765;&#x8868;&#x793A;&#x9700;&#x8981;&#x7B49;&#x5F85;&#x7684;&#x5177;&#x4F53;&#x5B50;&#x8FDB;&#x7A0B;&#xFF0C;&#x610F;&#x4E49;&#x5982;&#x4E0B;&#xFF1A;</p>
<ul>
<li>&#x5982;&#x679C;pid&#x5927;&#x4E8E;0&#xFF0C;&#x8868;&#x793A;&#x7B49;&#x5F85;&#x8FDB;&#x7A0B;ID&#x4E3A;pid&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x3002;</li>
<li>&#x5982;&#x679C;pid&#x7B49;&#x4E8E;0&#xFF0C;&#x5219;&#x7B49;&#x5F85;&#x4E0E;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#xFF08;&#x7236;&#x8FDB;&#x7A0B;&#xFF09;&#x540C;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7EC4;&#xFF08;process group&#xFF09;&#x7684;&#x6240;&#x6709;&#x5B50;&#x8FDB;&#x7A0B;&#x3002;34.2&#x8282;&#x5C06;&#x63CF;&#x8FF0;&#x8FDB;&#x7A0B;&#x7EC4;&#x7684;&#x6982;&#x5FF5;&#x3002;</li>
<li>&#x5982;&#x679C;pid&#x5C0F;&#x4E8E;-1&#xFF0C;&#x5219;&#x4F1A;&#x7B49;&#x5F85;&#x8FDB;&#x7A0B;&#x7EC4;&#x6807;&#x8BC6;&#x7B26;&#x4E0E;pid&#x7EDD;&#x5BF9;&#x503C;&#x76F8;&#x7B49;&#x7684;&#x6240;&#x6709;&#x5B50;&#x8FDB;&#x7A0B;&#x3002;</li>
<li>&#x5982;&#x679C;pid&#x7B49;&#x4E8E;-1&#xFF0C;&#x5219;&#x7B49;&#x5F85;&#x4EFB;&#x610F;&#x5B50;&#x8FDB;&#x7A0B;&#x3002;wait(&amp;status)&#x7684;&#x8C03;&#x7528;&#x4E0E;waitpid(-1, &amp;status, 0)&#x7B49;&#x4EF7;&#x3002;</li>
</ul>
<p>&#x53C2;&#x6570;options&#x662F;&#x4E00;&#x4E2A;&#x4F4D;&#x63A9;&#x7801;&#xFF08;bit mask&#xFF09;&#xFF0C;&#x53EF;&#x4EE5;&#x5305;&#x542B;&#xFF08;&#x6309;&#x4F4D;&#x6216;&#x64CD;&#x4F5C;&#xFF09;0&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x5982;&#x4E0B;&#x6807;&#x5FD7;&#xFF08;&#x5747;&#x5728;SUSv3&#x4E2D;&#x52A0;&#x4EE5;&#x89C4;&#x8303;&#xFF09;&#x3002;<br><code>WUNTRACED</code>&#x9664;&#x4E86;&#x8FD4;&#x56DE;&#x7EC8;&#x6B62;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x4FE1;&#x606F;&#x5916;&#xFF0C;&#x8FD8;&#x8FD4;&#x56DE;&#x56E0;&#x4FE1;&#x53F7;&#x800C;&#x505C;&#x6B62;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x4FE1;&#x606F;&#x3002;<br><code>WCONTINUED (&#x81EA;Linux2.6.10&#x4EE5;&#x6765;)</code>&#x8FD4;&#x56DE;&#x90A3;&#x4E9B;&#x56E0;&#x6536;&#x5230;SIGCONT&#x4FE1;&#x53F7;&#x800C;&#x6062;&#x590D;&#x6267;&#x884C;&#x7684;&#x5DF2;&#x505C;&#x6B62;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x72B6;&#x6001;&#x4FE1;&#x606F;&#x3002;<br><code>WNOHANG</code>&#x5982;&#x679C;&#x53C2;&#x6570;pid&#x6240;&#x6307;&#x5B9A;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x5E76;&#x672A;&#x53D1;&#x751F;&#x72B6;&#x6001;&#x6539;&#x53D8;&#xFF0C;&#x5219;&#x7ACB;&#x5373;&#x8FD4;&#x56DE;&#xFF0C;&#x800C;&#x4E0D;&#x4F1A;&#x963B;&#x585E;&#xFF0C;&#x4EA6;&#x5373;poll&#xFF08;&#x8F6E;&#x8BE2;&#xFF09;&#x3002;&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;waitpid()&#x8FD4;&#x56DE;0&#x3002;&#x5982;&#x679C;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x5E76;&#x65E0;&#x4E0E;pid&#x5339;&#x914D;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#xFF0C;&#x5219;waitpid()&#x62A5;&#x9519;&#xFF0C;&#x5C06;&#x9519;&#x8BEF;&#x53F7;&#x7F6E;&#x4E3A;ECHILD&#x3002;</p>
<h3 id="&#x7B49;&#x5F85;&#x72B6;&#x6001;&#x503C;"><a href="#&#x7B49;&#x5F85;&#x72B6;&#x6001;&#x503C;" class="headerlink" title="&#x7B49;&#x5F85;&#x72B6;&#x6001;&#x503C;"></a>&#x7B49;&#x5F85;&#x72B6;&#x6001;&#x503C;</h3><p>&#x7531;wait()&#x548C;waitpid()&#x8FD4;&#x56DE;&#x7684;status&#x7684;&#x503C;&#xFF0C;&#x53EF;&#x7528;&#x6765;&#x533A;&#x5206;&#x4EE5;&#x4E0B;&#x5B50;&#x8FDB;&#x7A0B;&#x4E8B;&#x4EF6;&#x3002;</p>
<ul>
<li>&#x5B50;&#x8FDB;&#x7A0B;&#x8C03;&#x7528;_exit()&#xFF08;&#x6216;exit()&#xFF09;&#x800C;&#x7EC8;&#x6B62;&#xFF0C;&#x5E76;&#x6307;&#x5B9A;&#x4E00;&#x4E2A;&#x6574;&#x578B;&#x503C;&#x4F5C;&#x4E3A;&#x9000;&#x51FA;&#x72B6;&#x6001;&#x3002;</li>
<li>&#x5B50;&#x8FDB;&#x7A0B;&#x6536;&#x5230;&#x672A;&#x5904;&#x7406;&#x4FE1;&#x53F7;&#x800C;&#x7EC8;&#x6B62;&#x3002;</li>
<li>&#x5B50;&#x8FDB;&#x7A0B;&#x56E0;&#x4E3A;&#x4FE1;&#x53F7;&#x800C;&#x505C;&#x6B62;&#xFF0C;&#x5E76;&#x4EE5;WUNTRACED&#x6807;&#x5FD7;&#x8C03;&#x7528;waitpid()&#x3002;</li>
<li>&#x5B50;&#x8FDB;&#x7A0B;&#x56E0;&#x6536;&#x5230;&#x4FE1;&#x53F7;SIGCONT&#x800C;&#x6062;&#x590D;&#xFF0C;&#x5E76;&#x4EE5;WCONTINUED&#x6807;&#x5FD7;&#x8C03;&#x7528;waitpid()&#x3002;</li>
</ul>
<p>&#x6B64;&#x5904;&#x7528;&#x672F;&#x8BED;&#x201C;&#x7B49;&#x5F85;&#x72B6;&#x6001;&#x201D;&#xFF08;wait status&#xFF09;&#x6765;&#x6DB5;&#x76D6;&#x4E0A;&#x8FF0;&#x6240;&#x6709;&#x60C5;&#x51B5;&#xFF0C;&#x800C;&#x4F7F;&#x7528;&#x201C;&#x7EC8;&#x6B62;&#x72B6;&#x6001;&#x201D;&#xFF08;termination status&#xFF09;&#x7684;&#x79F0;&#x8C13;&#x6765;&#x6307;&#x4EE3;&#x524D;&#x4E24;&#x79CD;&#x60C5;&#x51B5;&#x3002;&#xFF08;&#x5728;shell&#x4E2D;&#xFF0C;&#x53EF;&#x901A;&#x8FC7;&#x8BFB;&#x53D6;$?&#x53D8;&#x91CF;&#x503C;&#x6765;&#x83B7;&#x53D6;&#x4E0A;&#x6B21;&#x6267;&#x884C;&#x547D;&#x4EE4;&#x7684;&#x7EC8;&#x6B62;&#x72B6;&#x6001;&#x3002;&#xFF09;</p>
<h3 id="&#x4ECE;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x4E2D;&#x7EC8;&#x6B62;&#x8FDB;&#x7A0B;"><a href="#&#x4ECE;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x4E2D;&#x7EC8;&#x6B62;&#x8FDB;&#x7A0B;" class="headerlink" title="&#x4ECE;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x4E2D;&#x7EC8;&#x6B62;&#x8FDB;&#x7A0B;"></a>&#x4ECE;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x4E2D;&#x7EC8;&#x6B62;&#x8FDB;&#x7A0B;</h3><p>&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#x67D0;&#x4E9B;&#x4FE1;&#x53F7;&#x4F1A;&#x7EC8;&#x6B62;&#x8FDB;&#x7A0B;&#x3002;&#x6709;&#x65F6;&#xFF0C;&#x53EF;&#x80FD;&#x5E0C;&#x671B;&#x5728;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#x4E4B;&#x524D;&#x6267;&#x884C;&#x4E00;&#x4E9B;&#x6E05;&#x7406;&#x6B65;&#x9AA4;&#x3002;&#x4E3A;&#x6B64;&#xFF0C;&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#xFF08;handler&#xFF09;&#x6765;&#x6355;&#x83B7;&#x8FD9;&#x4E9B;&#x4FE1;&#x53F7;&#xFF0C;&#x968F;&#x5373;&#x6267;&#x884C;&#x6E05;&#x7406;&#x6B65;&#x9AA4;&#xFF0C;&#x518D;&#x7EC8;&#x6B62;&#x8FDB;&#x7A0B;&#x3002;&#x5982;&#x679C;&#x8FD9;&#x4E48;&#x505A;&#xFF0C;&#x9700;&#x8981;&#x7262;&#x8BB0;&#x7684;&#x662F;&#xFF1A;&#x901A;&#x8FC7;wait()&#x548C;waitpid()&#x8C03;&#x7528;&#xFF0C;&#x7236;&#x8FDB;&#x7A0B;&#x4F9D;&#x7136;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x7EC8;&#x6B62;&#x72B6;&#x6001;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x5982;&#x679C;&#x5728;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x4E2D;&#x8C03;&#x7528;_exit(EXIT_SUCCESS)&#xFF0C;&#x7236;&#x8FDB;&#x7A0B;&#x4F1A;&#x8BA4;&#x4E3A;&#x5B50;&#x8FDB;&#x7A0B;&#x662F;&#x6B63;&#x5E38;&#x7EC8;&#x6B62;&#x3002;</p>
<p>&#x5982;&#x679C;&#x9700;&#x8981;&#x901A;&#x77E5;&#x7236;&#x8FDB;&#x7A0B;&#x81EA;&#x5DF1;&#x56E0;&#x67D0;&#x4E2A;&#x4FE1;&#x53F7;&#x800C;&#x7EC8;&#x6B62;&#xFF0C;&#x90A3;&#x4E48;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x5E94;&#x9996;&#x5148;&#x5C06;&#x81EA;&#x5DF1;&#x5E9F;&#x9664;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x6B21;&#x53D1;&#x51FA;&#x76F8;&#x540C;&#x4FE1;&#x53F7;&#xFF0C;&#x8BE5;&#x4FE1;&#x53F7;&#x8FD9;&#x6B21;&#x5C06;&#x7EC8;&#x6B62;&#x8FD9;&#x4E00;&#x5B50;&#x8FDB;&#x7A0B;&#x3002;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x9700;&#x5305;&#x542B;&#x5982;&#x4E0B;&#x4EE3;&#x7801;:</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">handler</span><span class="token punctuation">(</span><span class="token keyword">int</span> sig<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">signal</span><span class="token punctuation">(</span>sig<span class="token punctuation">,</span>SIG_DFL<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">raise</span><span class="token punctuation">(</span>sig<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="&#x7CFB;&#x7EDF;&#x8C03;&#x7528;waitid"><a href="#&#x7CFB;&#x7EDF;&#x8C03;&#x7528;waitid" class="headerlink" title="&#x7CFB;&#x7EDF;&#x8C03;&#x7528;waitid()"></a>&#x7CFB;&#x7EDF;&#x8C03;&#x7528;waitid()</h3><p>&#x4E0E; waitpid()&#x7C7B;&#x4F3C;&#xFF0C;waitid()&#x8FD4;&#x56DE;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x72B6;&#x6001;&#x3002;&#x4E0D;&#x8FC7;&#xFF0C;waitid()&#x63D0;&#x4F9B;&#x4E86; waitpid()&#x6240;&#x6CA1;&#x6709;&#x7684;&#x6269;&#x5C55;&#x529F;&#x80FD;&#x3002;&#x8BE5;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x6E90;&#x4E8E;&#x7CFB;&#x7EDF;V&#xFF08;System V&#xFF09;&#xFF0C;&#x4E0D;&#x8FC7;&#x73B0;&#x5728;&#x5DF2;&#x83B7;SUSv3&#x91C7;&#x7528;&#xFF0C;&#x5E76;&#x4ECE;&#x7248;&#x672C;2.6.9&#x5F00;&#x59CB;&#xFF0C;&#x5C06;&#x5176;&#x52A0;&#x5165;Linux&#x5185;&#x6838;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;sys/wait.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">waitid</span><span class="token punctuation">(</span>idtype_t idtype<span class="token punctuation">,</span> id_t id<span class="token punctuation">,</span> siginfo_t <span class="token operator">*</span>infop<span class="token punctuation">,</span> <span class="token keyword">int</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x53C2;&#x6570;idtype&#x548C;id&#x6307;&#x5B9A;&#x9700;&#x8981;&#x7B49;&#x5F85;&#x54EA;&#x4E9B;&#x5B50;&#x8FDB;&#x7A0B;&#xFF0C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#x3002;</p>
<ul>
<li>&#x5982;&#x679C;idtype&#x4E3A;P_ALL&#xFF0C;&#x5219;&#x7B49;&#x5F85;&#x4EFB;&#x4F55;&#x5B50;&#x8FDB;&#x7A0B;&#xFF0C;&#x540C;&#x65F6;&#x5FFD;&#x7565;id&#x503C;&#x3002;</li>
<li>&#x5982;&#x679C;idtype&#x4E3A;P_PID&#xFF0C;&#x5219;&#x7B49;&#x5F85;&#x8FDB;&#x7A0B;ID&#x4E3A;id&#x8FDB;&#x7A0B;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x3002;</li>
<li>&#x5982;&#x679C;idtype&#x4E3A;P_PGID&#xFF0C;&#x5219;&#x7B49;&#x5F85;&#x8FDB;&#x7A0B;&#x7EC4;ID&#x4E3A;id&#x5404;&#x8FDB;&#x7A0B;&#x7684;&#x6240;&#x6709;&#x5B50;&#x8FDB;&#x7A0B;&#x3002;</li>
</ul>
<p>waitpid()&#x4E0E; waitid()&#x6700;&#x663E;&#x8457;&#x7684;&#x533A;&#x522B;&#x5728;&#x4E8E;&#xFF0C;&#x5BF9;&#x4E8E;&#x5E94;&#x8BE5;&#x7B49;&#x5F85;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x4E8B;&#x4EF6;&#xFF0C;waitid()&#x53EF;&#x4EE5;&#x66F4;&#x4E3A;&#x7CBE;&#x786E;&#x5730;&#x63A7;&#x5236;&#x3002;&#x53EF;&#x901A;&#x8FC7;&#x5728;options&#x4E2D;&#x6307;&#x5B9A;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x5982;&#x4E0B;&#x6807;&#x8BC6;&#xFF08;&#x6309;&#x4F4D;&#x6216;&#x8FD0;&#x7B97;&#xFF09;&#x6765;&#x5B9E;&#x73B0;&#x8FD9;&#x79CD;&#x63A7;&#x5236;&#x3002;<br><code>WEXITED</code>&#x7B49;&#x5F85;&#x5DF2;&#x7EC8;&#x6B62;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#xFF0C;&#x800C;&#x65E0;&#x8BBA;&#x5176;&#x662F;&#x5426;&#x6B63;&#x5E38;&#x8FD4;&#x56DE;&#x3002;<br><code>WSTOPPED</code>&#x7B49;&#x5F85;&#x5DF2;&#x901A;&#x8FC7;&#x4FE1;&#x53F7;&#x800C;&#x505C;&#x6B62;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x3002;<br><code>WCONTINUED</code>&#x7B49;&#x5F85;&#x7ECF;&#x7531;&#x4FE1;&#x53F7;SIGCONT&#x800C;&#x6062;&#x590D;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x3002;</p>
<p>&#x4EE5;&#x4E0B;&#x9644;&#x52A0;&#x6807;&#x8BC6;&#x4E5F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x6309;&#x4F4D;&#x6216;&#x8FD0;&#x7B97;&#x52A0;&#x5165;options&#x4E2D;&#x3002;<br><code>WNOHANG</code>&#x4E0E;&#x5176;&#x5728;waitpid()&#x4E2D;&#x7684;&#x610F;&#x4E49;&#x76F8;&#x540C;&#x3002;&#x5982;&#x679C;&#x5339;&#x914D;id&#x503C;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x4E2D;&#x5E76;&#x65E0;&#x72B6;&#x6001;&#x4FE1;&#x606F;&#x9700;&#x8981;&#x8FD4;&#x56DE;&#xFF0C;&#x5219;&#x7ACB;&#x5373;&#x8FD4;&#x56DE;&#xFF08;&#x4E00;&#x4E2A;&#x8F6E;&#x8BE2;&#xFF09;&#x3002;&#x6B64;&#x65F6;&#xFF0C;waitid()&#x8FD4;&#x56DE; 0&#x3002;&#x5982;&#x679C;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x5E76;&#x65E0;&#x5B50;&#x8FDB;&#x7A0B;&#x4E0E; id &#x7684;&#x503C;&#x76F8;&#x5339;&#x914D;&#xFF0C;&#x5219;waitid&#x8C03;&#x7528;&#x5931;&#x8D25;&#xFF0C;&#x4E14;&#x9519;&#x8BEF;&#x53F7;&#x4E3A;ECHILD&#x3002;<br><code>WNOWAIT</code>&#x901A;&#x5E38;&#xFF0C;&#x4E00;&#x65E6;&#x901A;&#x8FC7;waitid()&#x6765;&#x7B49;&#x5F85;&#x5B50;&#x8FDB;&#x7A0B;&#xFF0C;&#x90A3;&#x4E48;&#x5FC5;&#x7136;&#x4F1A;&#x53BB;&#x5904;&#x7406;&#x6240;&#x8C13;&#x201C;&#x72B6;&#x6001;&#x4E8B;&#x4EF6;&#x201D;&#x3002;&#x4E0D;&#x8FC7;&#xFF0C;&#x5982;&#x679C;&#x6307;&#x5B9A;&#x4E86;WNOWAIT&#xFF0C;&#x5219;&#x4F1A;&#x8FD4;&#x56DE;&#x5B50;&#x8FDB;&#x7A0B;&#x72B6;&#x6001;&#xFF0C;&#x4F46;&#x5B50;&#x8FDB;&#x7A0B;&#x4F9D;&#x7136;&#x5904;&#x4E8E;&#x53EF;&#x7B49;&#x5F85;&#x7684;&#xFF08;waitable&#xFF09;&#x72B6;&#x6001;&#xFF0C;&#x7A0D;&#x540E;&#x53EF;&#x518D;&#x6B21;&#x7B49;&#x5F85;&#x5E76;&#x83B7;&#x53D6;&#x76F8;&#x540C;&#x4FE1;&#x606F;&#x3002;</p>
<p>&#x6267;&#x884C;&#x6210;&#x529F;&#xFF0C;waitid()&#x8FD4;&#x56DE;0&#xFF0C;&#x4E14;&#x4F1A;&#x66F4;&#x65B0;&#x6307;&#x9488;infop&#x6240;&#x6307;&#x5411;&#x7684;siginfo_t&#x7ED3;&#x6784;&#xFF0C;&#x4EE5;&#x5305;&#x542B;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x76F8;&#x5173;&#x4FE1;&#x606F;&#x3002;&#x4EE5;&#x4E0B;&#x662F;&#x7ED3;&#x6784;<strong>siginfo_t</strong>&#x7684;&#x5B57;&#x6BB5;&#x60C5;&#x51B5;&#x3002;<br><code>si_code</code>&#x8BE5;&#x5B57;&#x6BB5;&#x5305;&#x542B;&#x4EE5;&#x4E0B;&#x503C;&#x4E4B;&#x4E00;&#xFF1A;CLD_EXITED&#xFF0C;&#x8868;&#x793A;&#x5B50;&#x8FDB;&#x7A0B;&#x5DF2;&#x901A;&#x8FC7;&#x8C03;&#x7528;_exit()&#x800C;&#x7EC8;&#x6B62;&#xFF1B;CLD_KILLED&#xFF0C;&#x8868;&#x793A;&#x5B50;&#x8FDB;&#x7A0B;&#x4E3A;&#x67D0;&#x4E2A;&#x4FE1;&#x53F7;&#x6240;&#x6740;&#xFF1B;CLD_STOPPED&#xFF0C;&#x8868;&#x793A;&#x5B50;&#x8FDB;&#x7A0B;&#x56E0;&#x67D0;&#x4E2A;&#x4FE1;&#x53F7;&#x800C;&#x505C;&#x6B62;&#xFF1B;CLD_CONTINUED&#xFF0C;&#x8868;&#x793A;&#xFF08;&#x4E4B;&#x524D;&#x505C;&#x6B62;&#x7684;&#xFF09;&#x5B50;&#x8FDB;&#x7A0B;&#x56E0;&#x63A5;&#x6536;&#x5230;&#xFF08;SIGCONT&#xFF09;&#x4FE1;&#x53F7;&#x800C;&#x6062;&#x590D;&#x6267;&#x884C;&#x3002;<br><code>si_pid</code>&#x8BE5;&#x5B57;&#x6BB5;&#x5305;&#x542B;&#x72B6;&#x6001;&#x53D1;&#x751F;&#x53D8;&#x5316;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x8FDB;&#x7A0B;ID&#x3002;<br><code>si_signo</code>&#x603B;&#x662F;&#x5C06;&#x8BE5;&#x5B57;&#x6BB5;&#x7F6E;&#x4E3A;SIGCHLD&#x3002;<br><code>si_status</code>&#x8BE5;&#x5B57;&#x6BB5;&#x8981;&#x4E48;&#x5305;&#x542B;&#x4F20;&#x9012;&#x7ED9;_exit()&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x9000;&#x51FA;&#x72B6;&#x6001;&#xFF0C;&#x8981;&#x4E48;&#x5305;&#x542B;&#x5BFC;&#x81F4;&#x5B50;&#x8FDB;&#x7A0B;&#x505C;&#x6B62;&#x3001;&#x7EE7;&#x7EED;&#x6216;&#x7EC8;&#x6B62;&#x7684;&#x4FE1;&#x53F7;&#x503C;&#x3002;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8BFB;&#x53D6;si_code&#x503C;&#x6765;&#x5224;&#x5B9A;&#x5177;&#x4F53;&#x5305;&#x542B;&#x7684;&#x662F;&#x54EA;&#x4E00;&#x79CD;&#x7C7B;&#x578B;&#x7684;&#x4FE1;&#x606F;&#x3002;<br><code>si_uid</code>&#x8BE5;&#x5B57;&#x6BB5;&#x5305;&#x542B;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x771F;&#x6B63;&#x7528;&#x6237;ID&#x3002;&#x5927;&#x90E8;&#x5206;&#x5176;&#x4ED6;UNIX&#x5B9E;&#x73B0;&#x4E0D;&#x4F1A;&#x8BBE;&#x7F6E;&#x8BE5;&#x5B57;&#x6BB5;&#x3002;</p>
<p>waitid()&#x64CD;&#x4F5C;&#x7684;&#x4E00;&#x5904;&#x7EC6;&#x8282;&#x9700;&#x8981;&#x8FDB;&#x4E00;&#x6B65;&#x6F84;&#x6E05;&#x3002;&#x5982;&#x679C;&#x5728;options&#x4E2D;&#x6307;&#x5B9A;&#x4E86;WNOHANG&#xFF0C;&#x90A3;&#x4E48;waitid()&#x8FD4;&#x56DE;0&#x610F;&#x5473;&#x7740;&#x4EE5;&#x4E0B;&#x4E24;&#x79CD;&#x60C5;&#x51B5;&#x4E4B;&#x4E00;&#xFF1A;&#x5728;&#x8C03;&#x7528;&#x65F6;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x72B6;&#x6001;&#x5DF2;&#x7ECF;&#x6539;&#x53D8;&#xFF08;&#x5173;&#x4E8E;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x76F8;&#x5173;&#x4FE1;&#x606F;&#x4FDD;&#x5B58;&#x5728;infop&#x6307;&#x9488;&#x6240;&#x6307;&#x5411;&#x7684;&#x7ED3;&#x6784; siginfo_t&#x4E2D;&#xFF09;&#xFF0C;&#x6216;&#x8005;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x72B6;&#x6001;&#x6709;&#x6240;&#x6539;&#x53D8;&#x3002;&#x5BF9;&#x4E8E;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x5B50;&#x8FDB;&#x7A0B;&#x6539;&#x53D8;&#x72B6;&#x6001;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x4E00;&#x4E9B;UNIX&#x5B9E;&#x73B0;&#xFF08;&#x5305;&#x62EC;Linux&#xFF09;&#x4F1A;&#x5C06;siginfo_t&#x7ED3;&#x6784;&#x5185;&#x5BB9;&#x6E05;0&#x3002;&#x8FD9;&#x4E5F;&#x662F;&#x533A;&#x5206;&#x4E24;&#x79CD;&#x60C5;&#x51B5;&#x7684;&#x65B9;&#x6CD5;&#x4E4B;&#x4E00;&#xFF1A;&#x68C0;&#x67E5;si_pid&#x7684;&#x503C;&#x662F;&#x5426;&#x4E3A;0&#x3002;&#x4E0D;&#x5E78;&#x7684;&#x662F;&#xFF0C;SUSv3&#x5E76;&#x672A;&#x89C4;&#x8303;&#x8FD9;&#x4E00;&#x884C;&#x4E3A;&#xFF0C;&#x4E00;&#x4E9B;UNIX&#x5B9E;&#x73B0;&#x6B64;&#x65F6;&#x4F1A;&#x4FDD;&#x6301;&#x7ED3;&#x6784;siginfo_t&#x539F;&#x5C01;&#x4E0D;&#x52A8;&#x3002;&#xFF08;&#x672A;&#x6765;&#x9488;&#x5BF9;SUSv4&#x7684;&#x52D8;&#x8BEF;&#x8868;&#x53EF;&#x80FD;&#x4F1A;&#x589E;&#x52A0;&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#x5C06;si_pid&#x548C;si_signo&#x7F6E;0&#x7684;&#x8981;&#x6C42;&#x3002;&#xFF09;&#x533A;&#x5206;&#x8FD9;&#x4E24;&#x79CD;&#x60C5;&#x51B5;&#x552F;&#x4E00;&#x53EF;&#x79FB;&#x690D;&#x7684;&#x65B9;&#x6CD5;&#x662F;&#xFF1A;&#x5728;&#x8C03;&#x7528;waitid()&#x4E4B;&#x524D;&#x5C31;&#x5C06;&#x7ED3;&#x6784;siginfo_t&#x7684;&#x5185;&#x5BB9;&#x7F6E;&#x4E3A;0.</p>
<h3 id="&#x7CFB;&#x7EDF;&#x8C03;&#x7528;wait3-&#x548C;wait4"><a href="#&#x7CFB;&#x7EDF;&#x8C03;&#x7528;wait3-&#x548C;wait4" class="headerlink" title="&#x7CFB;&#x7EDF;&#x8C03;&#x7528;wait3()&#x548C;wait4()"></a>&#x7CFB;&#x7EDF;&#x8C03;&#x7528;wait3()&#x548C;wait4()</h3><p>TODO.</p>
<h2 id="&#x5B64;&#x513F;&#x8FDB;&#x7A0B;&#x4E0E;&#x50F5;&#x5C38;&#x8FDB;&#x7A0B;"><a href="#&#x5B64;&#x513F;&#x8FDB;&#x7A0B;&#x4E0E;&#x50F5;&#x5C38;&#x8FDB;&#x7A0B;" class="headerlink" title="&#x5B64;&#x513F;&#x8FDB;&#x7A0B;&#x4E0E;&#x50F5;&#x5C38;&#x8FDB;&#x7A0B;"></a>&#x5B64;&#x513F;&#x8FDB;&#x7A0B;&#x4E0E;&#x50F5;&#x5C38;&#x8FDB;&#x7A0B;</h2><p>&#x7236;&#x8FDB;&#x7A0B;&#x4E0E;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;&#x4E00;&#x822C;&#x90FD;&#x4E0D;&#x76F8;&#x540C;&#xFF0C;&#x7236;&#x3001;&#x5B50;&#x8FDB;&#x7A0B;&#x95F4;&#x4E92;&#x6709;&#x957F;&#x77ED;&#x3002;&#x8FD9;&#x5C31;&#x5F15;&#x51FA;&#x4E86;&#x4E0B;&#x9762;&#x4E24;&#x4E2A;&#x95EE;&#x9898;&#x3002;</p>
<ul>
<li>&#x8C01;&#x4F1A;&#x662F;&#x5B64;&#x513F;&#xFF08;orphan&#xFF09;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x7236;&#x8FDB;&#x7A0B;&#xFF1F;&#x8FDB;&#x7A0B;ID&#x4E3A;1&#x7684;&#x4F17;&#x8FDB;&#x7A0B;&#x4E4B;&#x7956;&#x2014;&#x2014;init&#x4F1A;&#x63A5;&#x7BA1;&#x5B64;&#x513F;&#x8FDB;&#x7A0B;&#x3002;&#x6362;&#x8A00;&#x4E4B;&#xFF0C;&#x67D0;&#x4E00;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x7236;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#x540E;&#xFF0C;&#x5BF9; getppid()&#x7684;&#x8C03;&#x7528;&#x5C06;&#x8FD4;&#x56DE; 1&#x3002;&#x8FD9;&#x662F;&#x5224;&#x5B9A;&#x67D0;&#x4E00;&#x5B50;&#x8FDB;&#x7A0B;&#x4E4B;&#x201C;&#x751F;&#x7236;&#x201D;&#x662F;&#x5426;&#x201C;&#x5728;&#x4E16;&#x201D;&#x7684;&#x65B9;&#x6CD5;&#x4E4B;&#x4E00;&#xFF08;&#x524D;&#x63D0;&#x662F;&#x5047;&#x8BBE;&#x8BE5;&#x5B50;&#x8FDB;&#x7A0B;&#x7531;init&#x4E4B;&#x5916;&#x7684;&#x8FDB;&#x7A0B;&#x521B;&#x5EFA;&#xFF09;&#x3002;</li>
<li>&#x5728;&#x7236;&#x8FDB;&#x7A0B;&#x6267;&#x884C; wait()&#x4E4B;&#x524D;&#xFF0C;&#x5176;&#x5B50;&#x8FDB;&#x7A0B;&#x5C31;&#x5DF2;&#x7ECF;&#x7EC8;&#x6B62;&#xFF0C;&#x8FD9;&#x5C06;&#x4F1A;&#x53D1;&#x751F;&#x4EC0;&#x4E48;&#xFF1F;&#x6B64;&#x5904;&#x7684;&#x8981;&#x70B9;&#x5728;&#x4E8E;&#xFF0C;&#x5373;&#x4F7F;&#x5B50;&#x8FDB;&#x7A0B;&#x5DF2;&#x7ECF;&#x7ED3;&#x675F;&#xFF0C;&#x7CFB;&#x7EDF;&#x4ECD;&#x7136;&#x5141;&#x8BB8;&#x5176;&#x7236;&#x8FDB;&#x7A0B;&#x5728;&#x4E4B;&#x540E;&#x7684;&#x67D0;&#x4E00;&#x65F6;&#x523B;&#x53BB;&#x6267;&#x884C; wait()&#xFF0C;&#x4EE5;&#x786E;&#x5B9A;&#x8BE5;&#x5B50;&#x8FDB;&#x7A0B;&#x662F;&#x5982;&#x4F55;&#x7EC8;&#x6B62;&#x7684;&#x3002;&#x5185;&#x6838;&#x901A;&#x8FC7;&#x5C06;&#x5B50;&#x8FDB;&#x7A0B;&#x8F6C;&#x4E3A;&#x50F5;&#x5C38;&#x8FDB;&#x7A0B;&#xFF08;zombie&#xFF09;&#x6765;&#x5904;&#x7406;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x3002;&#x8FD9;&#x4E5F;&#x610F;&#x5473;&#x7740;&#x5C06;&#x91CA;&#x653E;&#x5B50;&#x8FDB;&#x7A0B;&#x6240;&#x628A;&#x6301;&#x7684;&#x5927;&#x90E8;&#x5206;&#x8D44;&#x6E90;&#xFF0C;&#x4EE5;&#x4FBF;&#x4F9B;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x91CD;&#x65B0;&#x4F7F;&#x7528;&#x3002;&#x8BE5;&#x8FDB;&#x7A0B;&#x6240;&#x552F;&#x4E00;&#x4FDD;&#x7559;&#x7684;&#x662F;&#x5185;&#x6838;&#x8FDB;&#x7A0B;&#x8868;&#x4E2D;&#x7684;&#x4E00;&#x6761;&#x8BB0;&#x5F55;&#xFF0C;&#x5176;&#x4E2D;&#x5305;&#x542B;&#x4E86;&#x5B50;&#x8FDB;&#x7A0B;ID&#x3001;&#x7EC8;&#x6B62;&#x72B6;&#x6001;&#x3001;&#x8D44;&#x6E90;&#x4F7F;&#x7528;&#x6570;&#x636E;&#x7B49;&#x4FE1;&#x606F;&#x3002;</li>
</ul>
<p>&#x81F3;&#x4E8E;&#x50F5;&#x5C38;&#x8FDB;&#x7A0B;&#x540D;&#x79F0;&#x7684;&#x7531;&#x6765;&#xFF0C;&#x5219;&#x6E90;&#x4E8E; UNIX &#x7CFB;&#x7EDF;&#x5BF9;&#x7535;&#x5F71;&#x60C5;&#x8282;&#x7684;&#x6548;&#x4EFF;&#x2014;&#x2014;&#x65E0;&#x6CD5;&#x901A;&#x8FC7;&#x4FE1;&#x53F7;&#x6765;&#x6740;&#x6B7B;&#x50F5;&#x5C38;&#x8FDB;&#x7A0B;&#xFF0C;&#x5373;&#x4FBF;&#x662F;&#xFF08;&#x94F6;&#x5F39;&#xFF09;SIGKILL&#x3002;&#x8FD9;&#x5C31;&#x786E;&#x4FDD;&#x4E86;&#x7236;&#x8FDB;&#x7A0B;&#x603B;&#x662F;&#x53EF;&#x4EE5;&#x6267;&#x884C;wait()&#x65B9;&#x6CD5;&#x3002;</p>
<p>&#x5F53;&#x7236;&#x8FDB;&#x7A0B;&#x6267;&#x884C; wait()&#x540E;&#xFF0C;&#x7531;&#x4E8E;&#x4E0D;&#x518D;&#x9700;&#x8981;&#x5B50;&#x8FDB;&#x7A0B;&#x6240;&#x5269;&#x4F59;&#x7684;&#x6700;&#x540E;&#x4FE1;&#x606F;&#xFF0C;&#x6545;&#x800C;&#x5185;&#x6838;&#x5C06;&#x5220;&#x9664;&#x50F5;&#x5C38;&#x8FDB;&#x7A0B;&#x3002;&#x53E6;&#x4E00;&#x65B9;&#x9762;&#xFF0C;&#x5982;&#x679C;&#x7236;&#x8FDB;&#x7A0B;&#x672A;&#x6267;&#x884C;wait()&#x968F;&#x5373;&#x9000;&#x51FA;&#xFF0C;&#x90A3;&#x4E48;init&#x8FDB;&#x7A0B;&#x5C06;&#x63A5;&#x7BA1;&#x5B50;&#x8FDB;&#x7A0B;&#x5E76;&#x81EA;&#x52A8;&#x8C03;&#x7528;wait()&#xFF0C;&#x4ECE;&#x800C;&#x4ECE;&#x7CFB;&#x7EDF;&#x4E2D;&#x79FB;&#x9664;&#x50F5;&#x5C38;&#x8FDB;&#x7A0B;&#x3002;</p>
<p>&#x5982;&#x679C;&#x7236;&#x8FDB;&#x7A0B;&#x521B;&#x5EFA;&#x4E86;&#x67D0;&#x4E00;&#x5B50;&#x8FDB;&#x7A0B;&#xFF0C;&#x4F46;&#x5E76;&#x672A;&#x6267;&#x884C; wait()&#xFF0C;&#x90A3;&#x4E48;&#x5728;&#x5185;&#x6838;&#x7684;&#x8FDB;&#x7A0B;&#x8868;&#x4E2D;&#x5C06;&#x4E3A;&#x8BE5;&#x5B50;&#x8FDB;&#x7A0B;&#x6C38;&#x4E45;&#x4FDD;&#x7559;&#x4E00;&#x6761;&#x8BB0;&#x5F55;&#x3002;&#x5982;&#x679C;&#x5B58;&#x5728;&#x5927;&#x91CF;&#x6B64;&#x7C7B;&#x50F5;&#x5C38;&#x8FDB;&#x7A0B;&#xFF0C;&#x5B83;&#x4EEC;&#x52BF;&#x5FC5;&#x5C06;&#x586B;&#x6EE1;&#x5185;&#x6838;&#x8FDB;&#x7A0B;&#x8868;&#xFF0C;&#x4ECE;&#x800C;&#x963B;&#x788D;&#x65B0;&#x8FDB;&#x7A0B;&#x7684;&#x521B;&#x5EFA;&#x3002;&#x65E2;&#x7136;&#x65E0;&#x6CD5;&#x7528;&#x4FE1;&#x53F7;&#x6740;&#x6B7B;&#x50F5;&#x5C38;&#x8FDB;&#x7A0B;&#xFF0C;&#x90A3;&#x4E48;&#x4ECE;&#x7CFB;&#x7EDF;&#x4E2D;&#x5C06;&#x5176;&#x79FB;&#x9664;&#x7684;&#x552F;&#x4E00;&#x65B9;&#x6CD5;&#x5C31;&#x662F;&#x6740;&#x6389;&#x5B83;&#x4EEC;&#x7684;&#x7236;&#x8FDB;&#x7A0B;&#xFF08;&#x6216;&#x7B49;&#x5F85;&#x5176;&#x7236;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#xFF09;&#xFF0C;&#x6B64;&#x65F6;init&#x8FDB;&#x7A0B;&#x5C06;&#x63A5;&#x7BA1;&#x548C;&#x7B49;&#x5F85;&#x8FD9;&#x4E9B;&#x50F5;&#x5C38;&#x8FDB;&#x7A0B;&#xFF0C;&#x4ECE;&#x800C;&#x4ECE;&#x7CFB;&#x7EDF;&#x4E2D;&#x5C06;&#x5B83;&#x4EEC;&#x6E05;&#x7406;&#x6389;&#x3002;</p>
<p>&#x5728;&#x8BBE;&#x8BA1;&#x957F;&#x751F;&#x547D;&#x5468;&#x671F;&#x7684;&#x7236;&#x8FDB;&#x7A0B;&#xFF08;&#x4F8B;&#x5982;&#xFF1A;&#x4F1A;&#x521B;&#x5EFA;&#x4F17;&#x591A;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x7F51;&#x7EDC;&#x670D;&#x52A1;&#x5668;&#x548C;Shell&#xFF09;&#x65F6;&#xFF0C;&#x8FD9;&#x4E9B;&#x8BED;&#x4E49;&#x5177;&#x6709;&#x91CD;&#x8981;&#x610F;&#x4E49;&#x3002;&#x6362;&#x53E5;&#x8BDD;&#x8BF4;&#xFF0C;&#x5728;&#x6B64;&#x7C7B;&#x5E94;&#x7528;&#x4E2D;&#xFF0C;&#x7236;&#x8FDB;&#x7A0B;&#x5E94;&#x6267;&#x884C; wait()&#x65B9;&#x6CD5;&#xFF0C;&#x4EE5;&#x786E;&#x4FDD;&#x7CFB;&#x7EDF;&#x603B;&#x662F;&#x80FD;&#x591F;&#x6E05;&#x7406;&#x90A3;&#x4E9B;&#x6B7B;&#x53BB;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#xFF0C;&#x907F;&#x514D;&#x4F7F;&#x5176;&#x6210;&#x4E3A;&#x957F;&#x5BFF;&#x50F5;&#x5C38;&#x3002;&#x7236;&#x8FDB;&#x7A0B;&#x5728;&#x5904;&#x7406;SIGCHLD&#x4FE1;&#x53F7;&#x65F6;&#xFF0C;&#x5BF9;wait()&#x7684;&#x8C03;&#x7528;&#x65E2;&#x53EF;&#x540C;&#x6B65;&#xFF0C;&#x4E5F;&#x53EF;&#x5F02;&#x6B65;&#x3002;</p>
<h2 id="SIGCHLD&#x4FE1;&#x53F7;"><a href="#SIGCHLD&#x4FE1;&#x53F7;" class="headerlink" title="SIGCHLD&#x4FE1;&#x53F7;"></a>SIGCHLD&#x4FE1;&#x53F7;</h2><p>&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x7EC8;&#x6B62;&#x5C5E;&#x5F02;&#x6B65;&#x4E8B;&#x4EF6;&#x3002;&#x7236;&#x8FDB;&#x7A0B;&#x65E0;&#x6CD5;&#x9884;&#x77E5;&#x5176;&#x5B50;&#x8FDB;&#x7A0B;&#x4F55;&#x65F6;&#x7EC8;&#x6B62;&#x3002;&#xFF08;&#x5373;&#x4F7F;&#x7236;&#x8FDB;&#x7A0B;&#x5411;&#x5B50;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;SIGKILL&#x4FE1;&#x53F7;&#xFF0C;&#x5B50;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#x7684;&#x786E;&#x5207;&#x65F6;&#x95F4;&#x8FD8;&#x4F9D;&#x8D56;&#x4E8E;&#x7CFB;&#x7EDF;&#x7684;&#x8C03;&#x5EA6;&#xFF1A;&#x5B50;&#x8FDB;&#x7A0B;&#x4E0B;&#x4E00;&#x6B21;&#x5728;&#x4F55;&#x65F6;&#x4F7F;&#x7528;CPU&#x3002;&#xFF09;&#x4E4B;&#x524D;&#x5DF2;&#x7ECF;&#x8BBA;&#x53CA;&#xFF0C;&#x7236;&#x8FDB;&#x7A0B;&#x5E94;&#x4F7F;&#x7528;wait()&#xFF08;&#x6216;&#x7C7B;&#x4F3C;&#x8C03;&#x7528;&#xFF09;&#x6765;&#x9632;&#x6B62;&#x50F5;&#x5C38;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x7D2F;&#x79EF;&#xFF0C;&#x4EE5;&#x53CA;&#x91C7;&#x7528;&#x5982;&#x4E0B;&#x4E24;&#x79CD;&#x65B9;&#x6CD5;&#x6765;&#x907F;&#x514D;&#x8FD9;&#x4E00;&#x95EE;&#x9898;&#x3002;</p>
<p>&#x7236;&#x8FDB;&#x7A0B;&#x8C03;&#x7528;&#x4E0D;&#x5E26;WNOHANG&#x6807;&#x5FD7;&#x7684;wait()&#xFF0C;&#x6216;waitpid()&#x65B9;&#x6CD5;&#xFF0C;&#x6B64;&#x65F6;&#x5982;&#x679C;&#x5C1A;&#x65E0;&#x5DF2;&#x7ECF;&#x7EC8;&#x6B62;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#xFF0C;&#x90A3;&#x4E48;&#x8C03;&#x7528;&#x5C06;&#x4F1A;&#x963B;&#x585E;&#x3002;</p>
<ul>
<li>&#x7236;&#x8FDB;&#x7A0B;&#x5468;&#x671F;&#x6027;&#x5730;&#x8C03;&#x7528;&#x5E26;&#x6709;WNOHANG&#x6807;&#x5FD7;&#x7684;waitpid()&#xFF0C;&#x6267;&#x884C;&#x9488;&#x5BF9;&#x5DF2;&#x7EC8;&#x6B62;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x975E;&#x963B;&#x585E;&#x5F0F;&#x68C0;&#x67E5;&#xFF08;&#x8F6E;&#x8BE2;&#xFF09;&#x3002;</li>
<li>&#x8FD9;&#x4E24;&#x79CD;&#x65B9;&#x6CD5;&#x4F7F;&#x7528;&#x8D77;&#x6765;&#x90FD;&#x6709;&#x6240;&#x4E0D;&#x4FBF;&#x3002;&#x4E00;&#x65B9;&#x9762;&#xFF0C;&#x53EF;&#x80FD;&#x5E76;&#x4E0D;&#x5E0C;&#x671B;&#x7236;&#x8FDB;&#x7A0B;&#x4EE5;&#x963B;&#x585E;&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x7B49;&#x5F85;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x7EC8;&#x6B62;&#x3002;&#x53E6;&#x4E00;&#x65B9;&#x9762;&#xFF0C;&#x53CD;&#x590D;&#x8C03;&#x7528;&#x975E;&#x963B;&#x585E;&#x7684;waitpid()&#x4F1A;&#x9020;&#x6210;CPU&#x8D44;&#x6E90;&#x7684;&#x6D6A;&#x8D39;&#xFF0C;&#x5E76;&#x589E;&#x52A0;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x8BBE;&#x8BA1;&#x7684;&#x590D;&#x6742;&#x5EA6;&#x3002;&#x4E3A;&#x4E86;&#x89C4;&#x907F;&#x8FD9;&#x4E9B;&#x95EE;&#x9898;&#xFF0C;&#x53EF;&#x4EE5;&#x91C7;&#x7528;&#x9488;&#x5BF9;SIGCHLD&#x4FE1;&#x53F7;&#x7684;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x3002;</li>
</ul>
<h2 id="&#x4E3A;SIGCHLD&#x5EFA;&#x7ACB;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x7A0B;&#x5E8F;"><a href="#&#x4E3A;SIGCHLD&#x5EFA;&#x7ACB;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x7A0B;&#x5E8F;" class="headerlink" title="&#x4E3A;SIGCHLD&#x5EFA;&#x7ACB;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x7A0B;&#x5E8F;"></a>&#x4E3A;SIGCHLD&#x5EFA;&#x7ACB;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x7A0B;&#x5E8F;</h2><p>&#x65E0;&#x8BBA;&#x4E00;&#x4E2A;&#x5B50;&#x8FDB;&#x7A0B;&#x4E8E;&#x4F55;&#x65F6;&#x7EC8;&#x6B62;&#xFF0C;&#x7CFB;&#x7EDF;&#x90FD;&#x4F1A;&#x5411;&#x5176;&#x7236;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;SIGCHLD&#x4FE1;&#x53F7;&#x3002;&#x5BF9;&#x8BE5;&#x4FE1;&#x53F7;&#x7684;&#x9ED8;&#x8BA4;&#x5904;&#x7406;&#x662F;&#x5C06;&#x5176;&#x5FFD;&#x7565;&#xFF0C;&#x4E0D;&#x8FC7;&#x4E5F;&#x53EF;&#x4EE5;&#x5B89;&#x88C5;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x6765;&#x6355;&#x83B7;&#x5B83;&#x3002;&#x5728;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x4E2D;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; wait()&#xFF08;&#x6216;&#x7C7B;&#x4F3C;&#x65B9;&#x6CD5;&#xFF09;&#x6765;&#x6536;&#x62FE;&#x50F5;&#x5C38;&#x8FDB;&#x7A0B;&#x3002;&#x4E0D;&#x8FC7;&#xFF0C;&#x4F7F;&#x7528;&#x8FD9;&#x4E00;&#x65B9;&#x6CD5;&#x65F6;&#x9700;&#x8981;&#x638C;&#x63E1;&#x4E00;&#x4E9B;&#x7A8D;&#x95E8;&#x3002;</p>
<p>&#x5F53;&#x8C03;&#x7528;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x65F6;&#xFF0C;&#x4F1A;&#x6682;&#x65F6;&#x5C06;&#x5F15;&#x53D1;&#x8C03;&#x7528;&#x7684;&#x4FE1;&#x53F7;&#x963B;&#x585E;&#x8D77;&#x6765;&#xFF08;&#x9664;&#x975E;&#x4E3A; sigaction()&#x6307;&#x5B9A;&#x4E86; SA_NODEFER&#x6807;&#x5FD7;&#xFF09;&#xFF0C;&#x4E14;&#x4E0D;&#x4F1A;&#x5BF9; SIGCHLD &#x4E4B;&#x6D41;&#x7684;&#x6807;&#x51C6;&#x4FE1;&#x53F7;&#x8FDB;&#x884C;&#x6392;&#x961F;&#x5904;&#x7406;&#x3002;&#x8FD9;&#x6837;&#x4E00;&#x6765;&#xFF0C;&#x5F53;SIGCHILD&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x6B63;&#x5728;&#x4E3A;&#x4E00;&#x4E2A;&#x7EC8;&#x6B62;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x8FD0;&#x884C;&#x65F6;&#xFF0C;&#x5982;&#x679C;&#x76F8;&#x7EE7;&#x6709;&#x4E24;&#x4E2A;&#x5B50;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#xFF0C;&#x5373;&#x4F7F;&#x4EA7;&#x751F;&#x4E86;&#x4E24;&#x6B21; SIGCHLD &#x4FE1;&#x53F7;&#xFF0C;&#x7236;&#x8FDB;&#x7A0B;&#x4E5F;&#x53EA;&#x80FD;&#x6355;&#x83B7;&#x5230;&#x4E00;&#x4E2A;&#x3002;&#x7ED3;&#x679C;&#x662F;&#xFF0C;&#x5982;&#x679C;&#x7236;&#x8FDB;&#x7A0B;&#x7684;SIGCHLD&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x6BCF;&#x6B21;&#x53EA;&#x8C03;&#x7528;&#x4E00;&#x6B21;wait()&#xFF0C;&#x90A3;&#x4E48;&#x4E00;&#x4E9B;&#x50F5;&#x5C38;&#x5B50;&#x8FDB;&#x7A0B;&#x53EF;&#x80FD;&#x4F1A;&#x6210;&#x4E3A;&#x201C;&#x6F0F;&#x7F51;&#x4E4B;&#x9C7C;&#x201D;&#x3002;</p>
<p>&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x662F;&#xFF1A;&#x5728;SIGCHLD&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x5185;&#x90E8;&#x5FAA;&#x73AF;&#x4EE5;WNOHANG&#x6807;&#x5FD7;&#x6765;&#x8C03;&#x7528;waitpid()&#xFF0C;&#x76F4;&#x81F3;&#x518D;&#x65E0;&#x5176;&#x4ED6;&#x7EC8;&#x6B62;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x9700;&#x8981;&#x5904;&#x7406;&#x4E3A;&#x6B62;&#x3002;&#x901A;&#x5E38;SIGCHLD&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x90FD;&#x7B80;&#x5355;&#x5730;&#x7531;&#x4EE5;&#x4E0B;&#x4EE3;&#x7801;&#x7EC4;&#x6210;&#xFF0C;&#x4EC5;&#x4EC5;&#x6355;&#x83B7;&#x5DF2;&#x7EC8;&#x6B62;&#x5B50;&#x8FDB;&#x7A0B;&#x800C;&#x4E0D;&#x5173;&#x5FC3;&#x5176;&#x9000;&#x51FA;&#x72B6;&#x6001;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">waitpid</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">,</span>WNOHANG<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">continue</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x4E0A;&#x8FF0;&#x5FAA;&#x73AF;&#x4F1A;&#x4E00;&#x76F4;&#x6301;&#x7EED;&#x4E0B;&#x53BB;&#xFF0C;&#x76F4;&#x81F3;waitpid()&#x8FD4;&#x56DE;0&#xFF0C;&#x8868;&#x660E;&#x518D;&#x65E0;&#x50F5;&#x5C38;&#x5B50;&#x8FDB;&#x7A0B;&#x5B58;&#x5728;&#xFF0C;&#x6216;-1&#xFF0C;&#x8868;&#x793A;&#x6709;&#x9519;&#x8BEF;&#x53D1;&#x751F;&#xFF08;&#x53EF;&#x80FD;&#x662F;ECHILD&#xFF0C;&#x610F;&#x5373;&#x518D;&#x65E0;&#x66F4;&#x591A;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#xFF09;&#x3002;</p>
<h3 id="SIGCHLD&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x7684;&#x8BBE;&#x8BA1;&#x95EE;&#x9898;"><a href="#SIGCHLD&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x7684;&#x8BBE;&#x8BA1;&#x95EE;&#x9898;" class="headerlink" title="SIGCHLD&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x7684;&#x8BBE;&#x8BA1;&#x95EE;&#x9898;"></a>SIGCHLD&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x7684;&#x8BBE;&#x8BA1;&#x95EE;&#x9898;</h3><p>&#x5047;&#x8BBE;&#x521B;&#x5EFA;SIGCHLD&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x8BE5;&#x8FDB;&#x7A0B;&#x5DF2;&#x7ECF;&#x6709;&#x5B50;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#x3002;&#x90A3;&#x4E48;&#x5185;&#x6838;&#x4F1A;&#x7ACB;&#x5373;&#x4E3A;&#x7236;&#x8FDB;&#x7A0B;&#x4EA7;&#x751F;SIGCHLD&#x4FE1;&#x53F7;&#x5417;&#xFF1F;SUSv3&#x5BF9;&#x8FD9;&#x4E00;&#x70B9;&#x5E76;&#x672A;&#x89C4;&#x5B9A;&#x3002;&#x4E00;&#x4E9B;&#x6E90;&#x81EA;&#x7CFB;&#x7EDF;V&#xFF08;System V&#xFF09;&#x7684;&#x5B9E;&#x73B0;&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#x4F1A;&#x4EA7;&#x751F;SIGCHLD&#x4FE1;&#x53F7;&#xFF1B;&#x800C;&#x53E6;&#x4E00;&#x4E9B;&#x7CFB;&#x7EDF;&#xFF0C;&#x5305;&#x62EC;Linux&#xFF0C;&#x5219;&#x4E0D;&#x8FD9;&#x4E48;&#x505A;&#x3002;&#x4E3A;&#x4FDD;&#x969C;&#x53EF;&#x79FB;&#x690D;&#x6027;&#xFF0C;&#x5E94;&#x7528;&#x5E94;&#x5728;&#x521B;&#x5EFA;&#x4EFB;&#x4F55;&#x5B50;&#x8FDB;&#x7A0B;&#x4E4B;&#x524D;&#x5C31;&#x8BBE;&#x7F6E;&#x597D;SIGCHLD&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#xFF0C;&#x5C06;&#x8FD9;&#x4E00;&#x9690;&#x60A3;&#x6D88;&#x89E3;&#x4E8E;&#x65E0;&#x5F62;&#x3002;&#xFF08;&#x65E0;&#x7591;&#xFF0C;&#x8FD9;&#x4E5F;&#x662F;&#x987A;&#x5176;&#x81EA;&#x7136;&#x7684;&#x5904;&#x4E8B;&#x4E4B;&#x9053;&#x3002;&#xFF09;</p>
<h3 id="&#x5411;&#x5DF2;&#x505C;&#x6B62;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;SIGCHLD&#x4FE1;&#x53F7;"><a href="#&#x5411;&#x5DF2;&#x505C;&#x6B62;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;SIGCHLD&#x4FE1;&#x53F7;" class="headerlink" title="&#x5411;&#x5DF2;&#x505C;&#x6B62;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;SIGCHLD&#x4FE1;&#x53F7;"></a>&#x5411;&#x5DF2;&#x505C;&#x6B62;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;SIGCHLD&#x4FE1;&#x53F7;</h3><p>&#x6B63;&#x5982;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; waitpid()&#x6765;&#x76D1;&#x6D4B;&#x5DF2;&#x505C;&#x6B62;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x4E00;&#x6837;&#xFF0C;&#x5F53;&#x4FE1;&#x53F7;&#x5BFC;&#x81F4;&#x5B50;&#x8FDB;&#x7A0B;&#x505C;&#x6B62;&#x65F6;&#xFF0C;&#x7236;&#x8FDB;&#x7A0B;&#x4E5F;&#x5C31;&#x6709;&#x53EF;&#x80FD;&#x6536;&#x5230; SIGCHLD &#x4FE1;&#x53F7;&#x3002;&#x8C03;&#x7528; sigaction()&#x8BBE;&#x7F6E; SIGCHLD &#x4FE1;&#x53F7;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x65F6;&#xFF0C;&#x5982;&#x4F20;&#x5165; SA_NOCLDSTOP &#x6807;&#x5FD7;&#x5373;&#x53EF;&#x63A7;&#x5236;&#x8FD9;&#x4E00;&#x884C;&#x4E3A;&#x3002;&#x82E5;&#x672A;&#x4F7F;&#x7528;&#x8BE5;&#x6807;&#x5FD7;&#xFF0C;&#x7CFB;&#x7EDF;&#x4F1A;&#x5728;&#x5B50;&#x8FDB;&#x7A0B;&#x505C;&#x6B62;&#x65F6;&#x5411;&#x7236;&#x8FDB;&#x7A0B;&#x53D1;&#x9001; SIGCHLD &#x4FE1;&#x53F7;&#xFF1B;&#x53CD;&#x4E4B;&#xFF0C;&#x5982;&#x679C;&#x4F7F;&#x7528;&#x4E86;&#x8FD9;&#x4E00;&#x6807;&#x5FD7;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x4E0D;&#x4F1A;&#x56E0;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x505C;&#x6B62;&#x800C;&#x53D1;&#x51FA;SIGCHLD&#x4FE1;&#x53F7;&#x3002;</p>
<h3 id="&#x5FFD;&#x7565;&#x7EC8;&#x6B62;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;"><a href="#&#x5FFD;&#x7565;&#x7EC8;&#x6B62;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;" class="headerlink" title="&#x5FFD;&#x7565;&#x7EC8;&#x6B62;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;"></a>&#x5FFD;&#x7565;&#x7EC8;&#x6B62;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;</h3><p>&#x66F4;&#x6709;&#x53EF;&#x80FD;&#x50CF;&#x8FD9;&#x6837;&#x5904;&#x7406;&#x7EC8;&#x6B62;&#x5B50;&#x8FDB;&#x7A0B;&#xFF1A;&#x5C06;&#x5BF9;SIGCHLD&#x7684;&#x5904;&#x7F6E;&#xFF08;disposition&#xFF09;&#x663E;&#x5F0F;&#x7F6E;&#x4E3A;SIG_ IGN&#xFF0C;&#x7CFB;&#x7EDF;&#x4ECE;&#x800C;&#x4F1A;&#x5C06;&#x5176;&#x540E;&#x7EC8;&#x6B62;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x7ACB;&#x5373;&#x5220;&#x9664;&#xFF0C;&#x6BCB;&#x5EB8;&#x8F6C;&#x4E3A;&#x50F5;&#x5C38;&#x8FDB;&#x7A0B;&#x3002;&#x8FD9;&#x65F6;&#xFF0C;&#x4F1A;&#x5C06;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x72B6;&#x6001;&#x5F03;&#x4E4B;&#x4E0D;&#x95EE;&#xFF0C;&#x6545;&#x800C;&#x6240;&#x6709;&#x540E;&#x7EED;&#x7684;wait()&#xFF08;&#x6216;&#x7C7B;&#x4F3C;&#xFF09;&#x8C03;&#x7528;&#x4E0D;&#x4F1A;&#x8FD4;&#x56DE;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x4EFB;&#x4F55;&#x4FE1;&#x606F;&#x3002;<br>TODO.</p>
<h1 id="&#x7A0B;&#x5E8F;&#x7684;&#x6267;&#x884C;"><a href="#&#x7A0B;&#x5E8F;&#x7684;&#x6267;&#x884C;" class="headerlink" title="&#x7A0B;&#x5E8F;&#x7684;&#x6267;&#x884C;"></a>&#x7A0B;&#x5E8F;&#x7684;&#x6267;&#x884C;</h1><h2 id="&#x6267;&#x884C;&#x65B0;&#x7A0B;&#x5E8F;&#xFF1A;execve"><a href="#&#x6267;&#x884C;&#x65B0;&#x7A0B;&#x5E8F;&#xFF1A;execve" class="headerlink" title="&#x6267;&#x884C;&#x65B0;&#x7A0B;&#x5E8F;&#xFF1A;execve()"></a>&#x6267;&#x884C;&#x65B0;&#x7A0B;&#x5E8F;&#xFF1A;execve()</h2><p>&#x7CFB;&#x7EDF;&#x8C03;&#x7528;execve()&#x53EF;&#x4EE5;&#x5C06;&#x65B0;&#x7A0B;&#x5E8F;&#x52A0;&#x8F7D;&#x5230;&#x67D0;&#x4E00;&#x8FDB;&#x7A0B;&#x7684;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#x3002;&#x5728;&#x8FD9;&#x4E00;&#x64CD;&#x4F5C;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x5C06;&#x4E22;&#x5F03;&#x65E7;&#x6709;&#x7A0B;&#x5E8F;&#xFF0C;&#x800C;&#x8FDB;&#x7A0B;&#x7684;&#x6808;&#x3001;&#x6570;&#x636E;&#x4EE5;&#x53CA;&#x5806;&#x6BB5;&#x4F1A;&#x88AB;&#x65B0;&#x7A0B;&#x5E8F;&#x7684;&#x76F8;&#x5E94;&#x90E8;&#x4EF6;&#x6240;&#x66FF;&#x6362;&#x3002;&#x5728;&#x6267;&#x884C;&#x4E86;&#x5404;&#x79CD;C&#x8BED;&#x8A00;&#x51FD;&#x6570;&#x5E93;&#x7684;&#x8FD0;&#x884C;&#x65F6;&#x542F;&#x52A8;&#x4EE3;&#x7801;&#x4EE5;&#x53CA;&#x7A0B;&#x5E8F;&#x7684;&#x521D;&#x59CB;&#x5316;&#x4EE3;&#x7801;&#x540E;&#xFF0C;&#x4F8B;&#x5982;&#xFF0C;C++&#x9759;&#x6001;&#x6784;&#x9020;&#x51FD;&#x6570;&#xFF0C;&#x6216;&#x8005;&#x4EE5;gcc constructor&#x5C5E;&#x6027;&#x58F0;&#x660E;&#x7684;C&#x8BED;&#x8A00;&#x51FD;&#x6570;&#xFF0C;&#x65B0;&#x7A0B;&#x5E8F;&#x4F1A;&#x4ECE;main()&#x51FD;&#x6570;&#x5904;&#x5F00;&#x59CB;&#x6267;&#x884C;&#x3002;</p>
<p>&#x7531;fork()&#x751F;&#x6210;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x5BF9; execve()&#x7684;&#x8C03;&#x7528;&#x6700;&#x4E3A;&#x9891;&#x7E41;&#xFF0C;&#x4E0D;&#x4EE5;fork()&#x8C03;&#x7528;&#x4E3A;&#x5148;&#x5BFC;&#x800C;&#x5355;&#x72EC;&#x8C03;&#x7528;execve()&#x7684;&#x505A;&#x6CD5;&#x5728;&#x5E94;&#x7528;&#x4E2D;&#x5B9E;&#x5C5E;&#x7F55;&#x89C1;&#x3002;</p>
<p>&#x57FA;&#x4E8E;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;execve()&#xFF0C;&#x8FD8;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x7CFB;&#x5217;&#x51A0;&#x4EE5;exec&#x6765;&#x547D;&#x540D;&#x7684;&#x4E0A;&#x5C42;&#x5E93;&#x51FD;&#x6570;&#xFF0C;&#x867D;&#x7136;&#x63A5;&#x53E3;&#x65B9;&#x5F0F;&#x5404;&#x5F02;&#xFF0C;&#x4F46;&#x529F;&#x80FD;&#x76F8;&#x540C;&#x3002;&#x901A;&#x5E38;&#x5C06;&#x8C03;&#x7528;&#x8FD9;&#x4E9B;&#x51FD;&#x6570;&#x52A0;&#x8F7D;&#x4E00;&#x4E2A;&#x65B0;&#x7A0B;&#x5E8F;&#x7684;&#x8FC7;&#x7A0B;&#x79F0;&#x4F5C;exec&#x64CD;&#x4F5C;&#xFF0C;&#x6216;&#x662F;&#x7B80;&#x5355;&#x5730;&#x4EE5;exec()&#x6765;&#x8868;&#x793A;&#x3002;&#x4E0B;&#x9762;&#x5C06;&#x5148;&#x63CF;&#x8FF0;execve()&#xFF0C;&#x7136;&#x540E;&#x518D;&#x5BF9;&#x76F8;&#x5173;&#x5E93;&#x51FD;&#x6570;&#x8FDB;&#x884C;&#x8BF4;&#x660E;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;unistd.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">execve</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> filename<span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span> <span class="token keyword">const</span> argv<span class="token punctuation">[</span> <span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span> <span class="token keyword">const</span> envp<span class="token punctuation">[</span> <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x53C2;&#x6570;pathname&#x5305;&#x542B;&#x51C6;&#x5907;&#x8F7D;&#x5165;&#x5F53;&#x524D;&#x8FDB;&#x7A0B;&#x7A7A;&#x95F4;&#x7684;&#x65B0;&#x7A0B;&#x5E8F;&#x7684;&#x8DEF;&#x5F84;&#x540D;&#xFF0C;&#x65E2;&#x53EF;&#x4EE5;&#x662F;&#x7EDD;&#x5BF9;&#x8DEF;&#x5F84;&#xFF08;&#x51A0;&#x4E4B;&#x4EE5;/&#xFF09;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x662F;&#x76F8;&#x5BF9;&#x4E8E;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x5F53;&#x524D;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;&#xFF08;current working directory&#xFF09;&#x7684;&#x76F8;&#x5BF9;&#x8DEF;&#x5F84;&#x3002;</p>
<p>&#x53C2;&#x6570;argv&#x5219;&#x6307;&#x5B9A;&#x4E86;&#x4F20;&#x9012;&#x7ED9;&#x65B0;&#x8FDB;&#x7A0B;&#x7684;&#x547D;&#x4EE4;&#x884C;&#x53C2;&#x6570;&#x3002;&#x8BE5;&#x6570;&#x7EC4;&#x5BF9;&#x5E94;&#x4E8E;C&#x8BED;&#x8A00;main()&#x51FD;&#x6570;&#x7684;&#x7B2C;2&#x4E2A;&#x53C2;&#x6570;&#xFF08;argv&#xFF09;&#xFF0C;&#x4E14;&#x683C;&#x5F0F;&#x4E5F;&#x4E0E;&#x4E4B;&#x76F8;&#x540C;&#xFF1A;&#x662F;&#x7531;&#x5B57;&#x7B26;&#x4E32;&#x6307;&#x9488;&#x6240;&#x7EC4;&#x6210;&#x7684;&#x5217;&#x8868;&#xFF0C;&#x4EE5;NULL&#x7ED3;&#x675F;&#x3002;argv[0]&#x7684;&#x503C;&#x5219;&#x5BF9;&#x5E94;&#x4E8E;&#x547D;&#x4EE4;&#x540D;&#x3002;&#x901A;&#x5E38;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x8BE5;&#x503C;&#x4E0E;pathname&#x4E2D;&#x7684;basename&#xFF08;&#x8DEF;&#x5F84;&#x540D;&#x7684;&#x6700;&#x540E;&#x90E8;&#x5206;&#xFF09;&#x76F8;&#x540C;&#x3002;</p>
<p>&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x53C2;&#x6570;envp&#x6307;&#x5B9A;&#x4E86;&#x65B0;&#x7A0B;&#x5E8F;&#x7684;&#x73AF;&#x5883;&#x5217;&#x8868;&#x3002;&#x53C2;&#x6570;envp&#x5BF9;&#x5E94;&#x4E8E;&#x65B0;&#x7A0B;&#x5E8F;&#x7684;environ&#x6570;&#x7EC4;&#xFF1A;&#x4E5F;&#x662F;&#x7531;&#x5B57;&#x7B26;&#x4E32;&#x6307;&#x9488;&#x7EC4;&#x6210;&#x7684;&#x5217;&#x8868;&#xFF0C;&#x4EE5;NULL&#x7ED3;&#x675F;&#xFF0C;&#x6240;&#x6307;&#x5411;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x683C;&#x5F0F;&#x4E3A;name=value&#x3002;</p>
<p>&#x8C03;&#x7528;execve()&#x4E4B;&#x540E;&#xFF0C;&#x56E0;&#x4E3A;&#x540C;&#x4E00;&#x8FDB;&#x7A0B;&#x4F9D;&#x7136;&#x5B58;&#x5728;&#xFF0C;&#x6240;&#x4EE5;&#x8FDB;&#x7A0B;ID&#x4ECD;&#x4FDD;&#x6301;&#x4E0D;&#x53D8;&#x3002;&#x8FD8;&#x6709;&#x5C11;&#x91CF;&#x5176;&#x4ED6;&#x7684;&#x8FDB;&#x7A0B;&#x5C5E;&#x6027;&#x4E5F;&#x672A;&#x53D1;&#x751F;&#x53D8;&#x5316;&#x3002;<br>&#x5982;&#x679C;&#x5BF9;pathname&#x6240;&#x6307;&#x5B9A;&#x7684;&#x7A0B;&#x5E8F;&#x6587;&#x4EF6;&#x8BBE;&#x7F6E;&#x4E86;set-user-ID&#xFF08;set-group-ID&#xFF09;&#x6743;&#x9650;&#x4F4D;&#xFF0C;&#x90A3;&#x4E48;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x4F1A;&#x5728;&#x6267;&#x884C;&#x6B64;&#x6587;&#x4EF6;&#x65F6;&#x5C06;&#x8FDB;&#x7A0B;&#x7684;&#x6709;&#x6548;&#xFF08;effective&#xFF09;&#x7528;&#x6237;&#xFF08;&#x7EC4;&#xFF09;ID&#x7F6E;&#x4E3A;&#x7A0B;&#x5E8F;&#x6587;&#x4EF6;&#x7684;&#x5C5E;&#x4E3B;&#xFF08;&#x7EC4;&#xFF09;ID&#x3002;&#x5229;&#x7528;&#x8FD9;&#x4E00;&#x673A;&#x5236;&#xFF0C;&#x53EF;&#x4EE4;&#x7528;&#x6237;&#x5728;&#x8FD0;&#x884C;&#x7279;&#x5B9A;&#x7A0B;&#x5E8F;&#x65F6;&#x4E34;&#x65F6;&#x83B7;&#x53D6;&#x7279;&#x6743;&#x3002;</p>
<p>&#x65E0;&#x8BBA;&#x662F;&#x5426;&#x66F4;&#x6539;&#x4E86;&#x6709;&#x6548;ID&#xFF0C;&#x4E5F;&#x4E0D;&#x7BA1;&#x8FD9;&#x4E00;&#x53D8;&#x5316;&#x662F;&#x5426;&#x751F;&#x6548;&#xFF0C;execve()&#x90FD;&#x4F1A;&#x4EE5;&#x8FDB;&#x7A0B;&#x7684;&#x6709;&#x6548;&#x7528;&#x6237;ID&#x53BB;&#x8986;&#x76D6;&#x5DF2;&#x4FDD;&#x5B58;&#x7684;&#xFF08;saved&#xFF09;set-user-ID&#xFF0C;&#x4EE5;&#x8FDB;&#x7A0B;&#x7684;&#x6709;&#x6548;&#x7EC4;ID&#x53BB;&#x8986;&#x76D6;&#x5DF2;&#x4FDD;&#x5B58;&#x7684;&#xFF08;saved&#xFF09;set-group-ID&#x3002;</p>
<p>&#x7531;&#x4E8E;&#x662F;&#x5C06;&#x8C03;&#x7528;&#x7A0B;&#x5E8F;&#x53D6;&#x800C;&#x4EE3;&#x4E4B;&#xFF0C;&#x5BF9;execve()&#x7684;&#x6210;&#x529F;&#x8C03;&#x7528;&#x5C06;&#x6C38;&#x4E0D;&#x8FD4;&#x56DE;&#xFF0C;&#x800C;&#x4E14;&#x4E5F;&#x65E0;&#x9700;&#x68C0;&#x67E5;execve()&#x7684;&#x8FD4;&#x56DE;&#x503C;&#xFF0C;&#x56E0;&#x4E3A;&#x8BE5;&#x503C;&#x603B;&#x662F;&#x96F7;&#x6253;&#x4E0D;&#x52A8;&#x5730;&#x7B49;&#x4E8E;-1&#x3002;&#x5B9E;&#x9645;&#x4E0A;&#xFF0C;&#x4E00;&#x65E6;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#xFF0C;&#x5C31;&#x8868;&#x660E;&#x53D1;&#x751F;&#x4E86;&#x9519;&#x8BEF;&#x3002;&#x901A;&#x5E38;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;errno&#x6765;&#x5224;&#x65AD;&#x51FA;&#x9519;&#x539F;&#x56E0;&#x3002;&#x53EF;&#x80FD;&#x81EA;errno&#x8FD4;&#x56DE;&#x7684;&#x9519;&#x8BEF;&#x5982;&#x4E0B;&#xFF1A;<br><code>EACCES</code>&#x53C2;&#x6570;pathname&#x6CA1;&#x6709;&#x6307;&#x5411;&#x4E00;&#x4E2A;&#x5E38;&#x89C4;&#xFF08;regular&#xFF09;&#x6587;&#x4EF6;&#xFF0C;&#x672A;&#x5BF9;&#x8BE5;&#x6587;&#x4EF6;&#x8D4B;&#x4E88;&#x53EF;&#x6267;&#x884C;&#x6743;&#x9650;&#xFF0C;&#x6216;&#x8005;&#x56E0;&#x4E3A;pathname&#x4E2D;&#x67D0;&#x4E00;&#x7EA7;&#x76EE;&#x5F55;&#x4E0D;&#x53EF;&#x641C;&#x7D22;&#xFF08;not searchable&#xFF09;&#xFF08;&#x5373;&#xFF0C;&#x5173;&#x95ED;&#x4E86;&#x8BE5;&#x76EE;&#x5F55;&#x7684;&#x53EF;&#x6267;&#x884C;&#x6743;&#x9650;&#xFF09;&#x3002;&#x8FD8;&#x6709;&#x4E00;&#x79CD;&#x53EF;&#x80FD;&#xFF0C;&#x662F;&#x4EE5;MS_NOEXEC&#x6807;&#x5FD7;&#xFF08;14.8.1&#x8282;&#xFF09;&#x6765;&#x6302;&#x8F7D;&#xFF08;mount&#xFF09;&#x6587;&#x4EF6;&#x6240;&#x5728;&#x7684;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#xFF0C;&#x4ECE;&#x800C;&#x5BFC;&#x81F4;&#x8FD9;&#x4E00;&#x9519;&#x8BEF;&#x3002;<br><code>ENOENT</code>pathname&#x6240;&#x6307;&#x4EE3;&#x7684;&#x6587;&#x4EF6;&#x5E76;&#x4E0D;&#x5B58;&#x5728;&#x3002;<br><code>ENOEXEC</code>&#x5C3D;&#x7BA1;&#x5BF9;pathname&#x6240;&#x6307;&#x4EE3;&#x6587;&#x4EF6;&#x8D4B;&#x4E88;&#x4E86;&#x53EF;&#x6267;&#x884C;&#x6743;&#x9650;&#xFF0C;&#x4F46;&#x7CFB;&#x7EDF;&#x5374;&#x65E0;&#x6CD5;&#x8BC6;&#x522B;&#x5176;&#x6587;&#x4EF6;&#x683C;&#x5F0F;&#x3002;&#x4E00;&#x4E2A;&#x811A;&#x672C;&#x6587;&#x4EF6;&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x5305;&#x542B;&#x7528;&#x4E8E;&#x6307;&#x5B9A;&#x811A;&#x672C;&#x89E3;&#x91CA;&#x5668;&#xFF08;interpreter&#xFF09;&#xFF08;&#x4EE5;&#x5B57;&#x7B26;#!&#x5F00;&#x5934;&#xFF09;&#x7684;&#x8D77;&#x59CB;&#x884C;&#xFF0C;&#x5C31;&#x53EF;&#x80FD;&#x5BFC;&#x81F4;&#x8FD9;&#x4E00;&#x9519;&#x8BEF;&#x3002;<br><code>ETXTBSY</code>&#x5B58;&#x5728;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x8FDB;&#x7A0B;&#x5DF2;&#x7ECF;&#x4EE5;&#x5199;&#x5165;&#x65B9;&#x5F0F;&#x6253;&#x5F00;pathname&#x6240;&#x6307;&#x4EE3;&#x7684;&#x6587;&#x4EF6;&#x3002;<br><code>E2BIG</code>&#x53C2;&#x6570;&#x5217;&#x8868;&#x548C;&#x73AF;&#x5883;&#x5217;&#x8868;&#x6240;&#x9700;&#x7A7A;&#x95F4;&#x603B;&#x548C;&#x8D85;&#x51FA;&#x4E86;&#x5141;&#x8BB8;&#x7684;&#x6700;&#x5927;&#x503C;&#x3002;</p>
<p>&#x5F53;&#x4E0A;&#x8FF0;&#x4EFB;&#x4E00;&#x6761;&#x4EF6;&#x4F5C;&#x7528;&#x4E8E;&#x6267;&#x884C;&#x811A;&#x672C;&#x7684;&#x811A;&#x672C;&#x89E3;&#x91CA;&#x5668;&#xFF0C;&#x6216;&#x662F;&#x6267;&#x884C;&#x7A0B;&#x5E8F;&#x7684;ELF&#x89E3;&#x91CA;&#x5668;&#x65F6;&#xFF0C;&#x540C;&#x6837;&#x4F1A;&#x4EA7;&#x751F;&#x76F8;&#x5E94;&#x9519;&#x8BEF;&#x3002;</p>
<p><strong>&#x4F8B;1:</strong></p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;unistd.h&gt;</span></span>

<span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">char</span> <span class="token operator">*</span> argv<span class="token punctuation">[</span> <span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;ls&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;-al&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;/etc/passwd&quot;</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span> envp<span class="token punctuation">[</span> <span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;PATH=/bin&quot;</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token function">execve</span><span class="token punctuation">(</span><span class="token string">&quot;/bin/ls&quot;</span><span class="token punctuation">,</span>argv<span class="token punctuation">,</span>envp<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>-rw-r--r-- 1 root root 2416 Aug 10  2018 /etc/passwd</code></pre><p>&#x8BE5;&#x7A0B;&#x5E8F;&#x9996;&#x5148;&#x4E3A;&#x65B0;&#x7A0B;&#x5E8F;&#x521B;&#x5EFA;&#x53C2;&#x6570;&#x5217;&#x8868;&#x548C;&#x73AF;&#x5883;&#x5217;&#x8868;&#xFF0C;&#x63A5;&#x7740;&#x8C03;&#x7528;execve()&#x6765;&#x6267;&#x884C;&#x7531;&#x547D;&#x4EE4;&#x884C;&#x53C2;&#x6570;&#xFF08;argv[1]&#xFF09;&#x6240;&#x6307;&#x5B9A;&#x7684;&#x7A0B;&#x5E8F;&#x8DEF;&#x5F84;&#x540D;&#x3002;<br>&#x8FD9;&#x4E2A;&#x7ED3;&#x679C;&#x548C;&#x5728;&#x7EC8;&#x7AEF;&#x6267;&#x884C;<code>ls -al /etc/passwd</code>&#x7684;&#x6548;&#x679C;&#x662F;&#x4E00;&#x6837;&#x7684;&#x3002;</p>
<h2 id="exec-&#x5E93;&#x51FD;&#x6570;"><a href="#exec-&#x5E93;&#x51FD;&#x6570;" class="headerlink" title="exec()&#x5E93;&#x51FD;&#x6570;"></a>exec()&#x5E93;&#x51FD;&#x6570;</h2><p>&#x672C;&#x8282;&#x6240;&#x8BA8;&#x8BBA;&#x7684;&#x5E93;&#x51FD;&#x6570;&#x4E3A;&#x6267;&#x884C; exec()&#x63D0;&#x4F9B;&#x4E86;&#x591A;&#x79CD; API &#x9009;&#x62E9;&#x3002;&#x6240;&#x6709;&#x8FD9;&#x4E9B;&#x51FD;&#x6570;&#x5747;&#x6784;&#x5EFA;&#x4E8E; execve()&#x8C03;&#x7528;&#x4E4B;&#x4E0A;&#xFF0C;&#x53EA;&#x662F;&#x5728;&#x4E3A;&#x65B0;&#x7A0B;&#x5E8F;&#x6307;&#x5B9A;&#x7A0B;&#x5E8F;&#x540D;&#x3001;&#x53C2;&#x6570;&#x5217;&#x8868;&#x4EE5;&#x53CA;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x7684;&#x65B9;&#x5F0F;&#x4E0A;&#x6709;&#x6240;&#x4E0D;&#x540C;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">execle</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>path<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>arg<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
           <span class="token comment" spellcheck="true">/*,(char *)NULL,char *const envp[] */</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">execlp</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>file<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>arg<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
           <span class="token comment" spellcheck="true">/*,(char *)NULL */</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">execvp</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>file<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token keyword">const</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">execv</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>path<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token keyword">const</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">execl</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>path<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>arg<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
          <span class="token comment" spellcheck="true">/*,(char *)NULL */</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<div class="table-wrapper"><table>
<thead>
<tr>
<th align="left">&#x51FD;&#x3000;&#x3000;&#x6570;</th>
<th align="center">&#x5BF9;&#x7A0B;&#x5E8F;&#x6587;&#x4EF6;&#x7684;&#x63CF;&#x8FF0;&#xFF08;-, p&#xFF09;</th>
<th align="center">&#x5BF9;&#x53C2;&#x6570;&#x7684;&#x63CF;&#x8FF0;&#xFF08;v, l&#xFF09;</th>
<th align="center">&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x6765;&#x6E90;&#xFF08;e, -&#xFF09;</th>
</tr>
</thead>
<tbody><tr>
<td align="left">execve()</td>
<td align="center">&#x8DEF;&#x5F84;&#x540D;</td>
<td align="center">&#x6570;&#x7EC4;</td>
<td align="center">envp &#x53C2;&#x6570;</td>
</tr>
<tr>
<td align="left">execle()</td>
<td align="center">&#x8DEF;&#x5F84;&#x540D;</td>
<td align="center">&#x5217;&#x8868;</td>
<td align="center">envp &#x53C2;&#x6570;</td>
</tr>
<tr>
<td align="left">execlp()</td>
<td align="center">&#x6587;&#x4EF6;&#x540D;+PATH</td>
<td align="center">&#x5217;&#x8868;</td>
<td align="center">&#x8C03;&#x7528;&#x8005;&#x7684;environ</td>
</tr>
<tr>
<td align="left">execvp()</td>
<td align="center">&#x6587;&#x4EF6;&#x540D;+PATH</td>
<td align="center">&#x6570;&#x7EC4;</td>
<td align="center">&#x8C03;&#x7528;&#x8005;&#x7684;environ</td>
</tr>
<tr>
<td align="left">execv()</td>
<td align="center">&#x8DEF;&#x5F84;&#x540D;</td>
<td align="center">&#x6570;&#x7EC4;</td>
<td align="center">&#x8C03;&#x7528;&#x8005;&#x7684;environ</td>
</tr>
<tr>
<td align="left">excel()</td>
<td align="center">&#x8DEF;&#x5F84;&#x540D;</td>
<td align="center">&#x5217;&#x8868;</td>
<td align="center">&#x8C03;&#x7528;&#x8005;&#x7684;environ</td>
</tr>
</tbody></table></div>
<h3 id="&#x73AF;&#x5883;&#x53D8;&#x91CF;PATH"><a href="#&#x73AF;&#x5883;&#x53D8;&#x91CF;PATH" class="headerlink" title="&#x73AF;&#x5883;&#x53D8;&#x91CF;PATH"></a>&#x73AF;&#x5883;&#x53D8;&#x91CF;PATH</h3><p>&#x51FD;&#x6570;execvp()&#x548C;execlp()&#x5141;&#x8BB8;&#x8C03;&#x7528;&#x8005;&#x53EA;&#x63D0;&#x4F9B;&#x6B32;&#x6267;&#x884C;&#x7A0B;&#x5E8F;&#x7684;&#x6587;&#x4EF6;&#x540D;&#x3002;&#x4E8C;&#x8005;&#x5747;&#x4F7F;&#x7528;&#x73AF;&#x5883;&#x53D8;&#x91CF;PATH&#x6765;&#x641C;&#x7D22;&#x6587;&#x4EF6;&#x3002;PATH&#x7684;&#x503C;&#x662F;&#x4E00;&#x4E2A;&#x4EE5;&#x5192;&#x53F7;&#xFF08;&#xFF1A;&#xFF09;&#x5206;&#x9694;&#xFF0C;&#x7531;&#x591A;&#x4E2A;&#x76EE;&#x5F55;&#x540D;&#xFF0C;&#x4E5F;&#x5C06;&#x5176;&#x79F0;&#x4E3A;&#x8DEF;&#x5F84;&#x524D;&#x7F00;&#xFF08;path prefixes&#xFF09;&#x7EC4;&#x6210;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002;&#x4E0B;&#x4F8B;&#x4E2D;&#x7684;PATH&#x5305;&#x542B;5&#x4E2A;&#x76EE;&#x5F55;&#xFF1A;</p>
<pre><code>$ echo PATH
/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/local/games:/snap/bin</code></pre><p>&#x5BF9;&#x4E8E;&#x4E00;&#x4E2A;&#x767B;&#x5F55;shell&#x800C;&#x8A00;&#xFF0C;&#x5176;PATH&#x503C;&#x5C06;&#x7531;&#x7CFB;&#x7EDF;&#x7EA7;&#x548C;&#x7279;&#x5B9A;&#x7528;&#x6237;&#x7684;shell&#x542F;&#x52A8;&#x811A;&#x672C;&#x6765;&#x8BBE;&#x7F6E;&#x3002;&#x7531;&#x4E8E;&#x5B50;&#x8FDB;&#x7A0B;&#x7EE7;&#x627F;&#x5176;&#x7236;&#x8FDB;&#x7A0B;&#x7684;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#xFF0C;shell&#x6267;&#x884C;&#x6BCF;&#x4E2A;&#x547D;&#x4EE4;&#x65F6;&#x6240;&#x521B;&#x5EFA;&#x7684;&#x8FDB;&#x7A0B;&#x4E5F;&#x5C31;&#x7EE7;&#x627F;&#x4E86;shell&#x7684;PATH&#x3002;</p>
<p>&#x5982;&#x679C;&#x6CA1;&#x6709;&#x5B9A;&#x4E49;&#x53D8;&#x91CF;PATH&#xFF0C;&#x90A3;&#x4E48;execvp()&#x548C;execlp()&#x4F1A;&#x91C7;&#x7528;&#x9ED8;&#x8BA4;&#x7684;&#x8DEF;&#x5F84;&#x5217;&#x8868;&#xFF1A;.:/usr/bin:/bin&#x3002;</p>
<h3 id="&#x5C06;&#x7A0B;&#x5E8F;&#x53C2;&#x6570;&#x6307;&#x5B9A;&#x4E3A;&#x5217;&#x8868;"><a href="#&#x5C06;&#x7A0B;&#x5E8F;&#x53C2;&#x6570;&#x6307;&#x5B9A;&#x4E3A;&#x5217;&#x8868;" class="headerlink" title="&#x5C06;&#x7A0B;&#x5E8F;&#x53C2;&#x6570;&#x6307;&#x5B9A;&#x4E3A;&#x5217;&#x8868;"></a>&#x5C06;&#x7A0B;&#x5E8F;&#x53C2;&#x6570;&#x6307;&#x5B9A;&#x4E3A;&#x5217;&#x8868;</h3><p>&#x5982;&#x679C;&#x5728;&#x7F16;&#x7A0B;&#x65F6;&#x5DF2;&#x77E5;&#x67D0;&#x4E2A;exec()&#x7684;&#x53C2;&#x6570;&#x4E2A;&#x6570;&#xFF0C;&#x8C03;&#x7528;execle()&#x3001;execlp()&#x6216;&#x8005;execl()&#x65F6;&#x5C31;&#x53EF;&#x4EE5;&#x5C06;&#x53C2;&#x6570;&#x4F5C;&#x4E3A;&#x5217;&#x8868;&#x4F20;&#x5165;&#x3002;&#x8F83;&#x4E4B;&#x4E8E;&#x5C06;&#x53C2;&#x6570;&#x88C5;&#x914D;&#x4E8E;&#x4E00;&#x4E2A;argv&#x5411;&#x91CF;&#x4E2D;&#xFF0C;&#x4EE3;&#x7801;&#x8981;&#x5C11;&#x4E00;&#x4E9B;&#xFF0C;&#x4FBF;&#x4E8E;&#x4F7F;&#x7528;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;entering main process---\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">execl</span><span class="token punctuation">(</span><span class="token string">&quot;/bin/ls&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;ls&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;-l&quot;</span><span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;exiting main process ----\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;entering main process---\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> ret<span class="token punctuation">;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;ls&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;-l&quot;</span><span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    ret <span class="token operator">=</span> <span class="token function">execvp</span><span class="token punctuation">(</span><span class="token string">&quot;ls&quot;</span><span class="token punctuation">,</span>argv<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>ret <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">&quot;execl error&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;exiting main process ----\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="&#x5C06;&#x8C03;&#x7528;&#x8005;&#x7684;&#x73AF;&#x5883;&#x4F20;&#x9012;&#x7ED9;&#x65B0;&#x7A0B;&#x5E8F;"><a href="#&#x5C06;&#x8C03;&#x7528;&#x8005;&#x7684;&#x73AF;&#x5883;&#x4F20;&#x9012;&#x7ED9;&#x65B0;&#x7A0B;&#x5E8F;" class="headerlink" title="&#x5C06;&#x8C03;&#x7528;&#x8005;&#x7684;&#x73AF;&#x5883;&#x4F20;&#x9012;&#x7ED9;&#x65B0;&#x7A0B;&#x5E8F;"></a>&#x5C06;&#x8C03;&#x7528;&#x8005;&#x7684;&#x73AF;&#x5883;&#x4F20;&#x9012;&#x7ED9;&#x65B0;&#x7A0B;&#x5E8F;</h3><p>&#x51FD;&#x6570;execlp()&#x3001;execvp()&#x3001;execl()&#x548C;execv()&#x4E0D;&#x5141;&#x8BB8;&#x5F00;&#x53D1;&#x8005;&#x663E;&#x5F0F;&#x6307;&#x5B9A;&#x73AF;&#x5883;&#x5217;&#x8868;&#xFF0C;&#x65B0;&#x7A0B;&#x5E8F;&#x7684;&#x73AF;&#x5883;&#x7EE7;&#x627F;&#x81EA;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x3002;</p>
<h3 id="&#x6267;&#x884C;&#x7531;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x6307;&#x4EE3;&#x7684;&#x7A0B;&#x5E8F;&#xFF1A;fexecve"><a href="#&#x6267;&#x884C;&#x7531;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x6307;&#x4EE3;&#x7684;&#x7A0B;&#x5E8F;&#xFF1A;fexecve" class="headerlink" title="&#x6267;&#x884C;&#x7531;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x6307;&#x4EE3;&#x7684;&#x7A0B;&#x5E8F;&#xFF1A;fexecve()"></a>&#x6267;&#x884C;&#x7531;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x6307;&#x4EE3;&#x7684;&#x7A0B;&#x5E8F;&#xFF1A;fexecve()</h3><p>glibc&#x81EA;&#x7248;&#x672C;2.3.2&#x5F00;&#x59CB;&#x63D0;&#x4F9B;&#x51FD;&#x6570;fexecve()&#xFF0C;&#x5176;&#x884C;&#x4E3A;&#x4E0E;execve()&#x7C7B;&#x4F3C;&#xFF0C;&#x53EA;&#x662F;&#x6307;&#x5B9A;&#x5C06;&#x8981;&#x6267;&#x884C;&#x7684;&#x7A0B;&#x5E8F;&#x662F;&#x4EE5;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;fd&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x800C;&#x975E;&#x901A;&#x8FC7;&#x8DEF;&#x5F84;&#x540D;&#x3002;&#x6709;&#x4E9B;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x9700;&#x8981;&#x6253;&#x5F00;&#x67D0;&#x4E2A;&#x7A0B;&#x5E8F;&#x6587;&#x4EF6;&#xFF0C;&#x901A;&#x8FC7;&#x6267;&#x884C;&#x6821;&#x9A8C;&#x548C;&#xFF08;checksum&#xFF09;&#x6765;&#x9A8C;&#x8BC1;&#x6587;&#x4EF6;&#x5185;&#x5BB9;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x8FD0;&#x884C;&#x8BE5;&#x7A0B;&#x5E8F;&#xFF0C;&#x8FD9;&#x4E00;&#x573A;&#x666F;&#x5C31;&#x8F83;&#x4E3A;&#x9002;&#x5B9C;&#x4F7F;&#x7528;&#x51FD;&#x6570;fexecve()&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">define</span> _GNU_SOURCE</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;unistd.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">fexecve</span><span class="token punctuation">(</span><span class="token keyword">int</span> fd<span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token keyword">const</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token keyword">const</span> envp<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x5F53;&#x7136;&#xFF0C;&#x5373;&#x4FBF;&#x6CA1;&#x6709;fexecve()&#x51FD;&#x6570;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x8C03;&#x7528;open()&#x6765;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#xFF0C;&#x8BFB;&#x53D6;&#x5E76;&#x9A8C;&#x8BC1;&#x5176;&#x5185;&#x5BB9;&#xFF0C;&#x5E76;&#x6700;&#x7EC8;&#x8FD0;&#x884C;&#x3002;&#x7136;&#x800C;&#xFF0C;&#x5728;&#x6253;&#x5F00;&#x4E0E;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x4E4B;&#x95F4;&#xFF0C;&#x5B58;&#x5728;&#x5C06;&#x8BE5;&#x6587;&#x4EF6;&#x66FF;&#x6362;&#x7684;&#x53EF;&#x80FD;&#x6027;&#xFF08;&#x6301;&#x6709;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x5E76;&#x4E0D;&#x80FD;&#x963B;&#x6B62;&#x521B;&#x5EFA;&#x540C;&#x540D;&#x65B0;&#x6587;&#x4EF6;&#xFF09;&#xFF0C;&#x6700;&#x7EC8;&#x9020;&#x6210;&#x9A8C;&#x8BC1;&#x8005;&#x5E76;&#x975E;&#x6267;&#x884C;&#x8005;&#x7684;&#x60C5;&#x51B5;&#x3002;</p>
<h2 id="&#x89E3;&#x91CA;&#x5668;&#x811A;&#x672C;"><a href="#&#x89E3;&#x91CA;&#x5668;&#x811A;&#x672C;" class="headerlink" title="&#x89E3;&#x91CA;&#x5668;&#x811A;&#x672C;"></a>&#x89E3;&#x91CA;&#x5668;&#x811A;&#x672C;</h2><p>&#x6240;&#x8C13;&#x89E3;&#x91CA;&#x5668;&#xFF08;interpreter&#xFF09;&#xFF0C;&#x5C31;&#x662F;&#x80FD;&#x591F;&#x8BFB;&#x53D6;&#x5E76;&#x6267;&#x884C;&#x6587;&#x672C;&#x683C;&#x5F0F;&#x547D;&#x4EE4;&#x7684;&#x7A0B;&#x5E8F;&#x3002;&#xFF08;&#x76F8;&#x5F62;&#x4E4B;&#x4E0B;&#xFF0C;&#x7F16;&#x8BD1;&#x5668;&#x5219;&#x662F;&#x5C06;&#x8F93;&#x5165;&#x6E90;&#x4EE3;&#x7801;&#x8BD1;&#x4E3A;&#x53EF;&#x5728;&#x771F;&#x5B9E;&#x6216;&#x865A;&#x62DF;&#x673A;&#x5668;&#x4E0A;&#x6267;&#x884C;&#x7684;&#x673A;&#x5668;&#x8BED;&#x8A00;&#x3002;&#xFF09;&#x5404;&#x79CD; UNIX shell&#xFF0C;&#x4EE5;&#x53CA;&#x8BF8;&#x5982;awk&#x3001;sed&#x3001;perl&#x3001;python&#x548C; ruby &#x4E4B;&#x7C7B;&#x7684;&#x7A0B;&#x5E8F;&#x90FD;&#x5C5E;&#x4E8E;&#x89E3;&#x91CA;&#x5668;&#x3002;&#x9664;&#x4E86;&#x80FD;&#x591F;&#x4EA4;&#x4E92;&#x5F0F;&#x5730;&#x8BFB;&#x53D6;&#x548C;&#x6267;&#x884C;&#x547D;&#x4EE4;&#x4E4B;&#x5916;&#xFF0C;&#x89E3;&#x91CA;&#x5668;&#x901A;&#x5E38;&#x8FD8;&#x5177;&#x5907;&#x8FD9;&#x6837;&#x4E00;&#x79CD;&#x80FD;&#x529B;&#xFF1A;&#x4ECE;&#x88AB;&#x79F0;&#x4E3A;&#x811A;&#x672C;&#xFF08;script&#xFF09;&#x7684;&#x6587;&#x672C;&#x6587;&#x4EF6;&#x4E2D;&#x8BFB;&#x53D6;&#x548C;&#x6267;&#x884C;&#x547D;&#x4EE4;&#x3002;<br>UNIX &#x5185;&#x6838;&#x8FD0;&#x884C;&#x89E3;&#x91CA;&#x5668;&#x811A;&#x672C;&#x7684;&#x65B9;&#x5F0F;&#x4E0E;&#x4E8C;&#x8FDB;&#x5236;&#xFF08;binary&#xFF09;&#x7A0B;&#x5E8F;&#x65E0;&#x5F02;&#xFF0C;&#x524D;&#x63D0;&#x662F;&#x811A;&#x672C;&#x5FC5;&#x987B;&#x6EE1;&#x8DB3;&#x4E0B;&#x9762;&#x4E24;&#x70B9;&#x8981;&#x6C42;&#xFF1A;&#x9996;&#x5148;&#xFF0C;&#x5FC5;&#x987B;&#x8D4B;&#x4E88;&#x811A;&#x672C;&#x6587;&#x4EF6;&#x53EF;&#x6267;&#x884C;&#x6743;&#x9650;&#xFF1B;&#x5176;&#x6B21;&#xFF0C;&#x6587;&#x4EF6;&#x7684;&#x8D77;&#x59CB;&#x884C;&#xFF08;initial line&#xFF09;&#x5FC5;&#x987B;&#x6307;&#x5B9A;&#x8FD0;&#x884C;&#x811A;&#x672C;&#x89E3;&#x91CA;&#x5668;&#x7684;&#x8DEF;&#x5F84;&#x540D;&#x3002;</p>
<h2 id="&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x4E0E;exec"><a href="#&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x4E0E;exec" class="headerlink" title="&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x4E0E;exec()"></a>&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x4E0E;exec()</h2><p>&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x7531;exec()&#x7684;&#x8C03;&#x7528;&#x7A0B;&#x5E8F;&#x6240;&#x6253;&#x5F00;&#x7684;&#x6240;&#x6709;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x5728;exec()&#x7684;&#x6267;&#x884C;&#x8FC7;&#x7A0B;&#x4E2D;&#x4F1A;&#x4FDD;&#x6301;&#x6253;&#x5F00;&#x72B6;&#x6001;&#xFF0C;&#x4E14;&#x5728;&#x65B0;&#x7A0B;&#x5E8F;&#x4E2D;&#x4F9D;&#x7136;&#x6709;&#x6548;&#x3002;&#x8FD9;&#x901A;&#x5E38;&#x5F88;&#x5B9E;&#x7528;&#xFF0C;&#x56E0;&#x4E3A;&#x8C03;&#x7528;&#x7A0B;&#x5E8F;&#x53EF;&#x80FD;&#x4F1A;&#x4EE5;&#x7279;&#x5B9A;&#x7684;&#x63CF;&#x8FF0;&#x7B26;&#x6765;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#xFF0C;&#x800C;&#x5728;&#x65B0;&#x7A0B;&#x5E8F;&#x4E2D;&#x8FD9;&#x4E9B;&#x6587;&#x4EF6;&#x5C06;&#x81EA;&#x52A8;&#x6709;&#x6548;&#xFF0C;&#x65E0;&#x9700;&#x518D;&#x53BB;&#x4E86;&#x89E3;&#x6587;&#x4EF6;&#x540D;&#x6216;&#x662F;&#x628A;&#x5B83;&#x4EEC;&#x91CD;&#x65B0;&#x6253;&#x5F00;&#x3002;</p>
<p>shell&#x5229;&#x7528;&#x8FD9;&#x4E00;&#x7279;&#x6027;&#x4E3A;&#x5176;&#x6240;&#x6267;&#x884C;&#x7684;&#x7A0B;&#x5E8F;&#x5904;&#x7406;I/O&#x91CD;&#x5B9A;&#x5411;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x5047;&#x8BBE;&#x952E;&#x5165;&#x5982;&#x4E0B;&#x7684;shell&#x547D;&#x4EE4;&#xFF1A;</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">ls</span> /tmp <span class="token operator">&gt;</span> dir.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>shell&#x8FD0;&#x884C;&#x8BE5;&#x547D;&#x4EE4;&#x65F6;&#xFF0C;&#x6267;&#x884C;&#x4E86;&#x4EE5;&#x4E0B;&#x6B65;&#x9AA4;&#x3002;<br>1&#xFF0E; &#x8C03;&#x7528;fork()&#x521B;&#x5EFA;&#x5B50;&#x8FDB;&#x7A0B;&#xFF0C;&#x5B50;&#x8FDB;&#x7A0B;&#x4F1A;&#x4E5F;&#x8FD0;&#x884C;shell&#x7684;&#x4E00;&#x4EFD;&#x62F7;&#x8D1D;&#xFF08;&#x56E0;&#x6B64;&#x547D;&#x4EE4;&#x884C;&#x4E5F;&#x6709;&#x4E00;&#x4EFD;&#x62F7;&#x8D1D;&#xFF09;&#x3002;<br>2&#xFF0E; &#x5B50;shell&#x4EE5;&#x63CF;&#x8FF0;&#x7B26;1&#xFF08;&#x6807;&#x51C6;&#x8F93;&#x51FA;&#xFF09;&#x6253;&#x5F00;&#x6587;&#x4EF6;dir.txt&#x7528;&#x4E8E;&#x8F93;&#x51FA;&#x3002;<br>3&#xFF0E; &#x5B50;shell&#x6267;&#x884C;&#x7A0B;&#x5E8F;ls&#x3002;ls&#x5C06;&#x5176;&#x7ED3;&#x679C;&#x8F93;&#x51FA;&#x5230;&#x6807;&#x51C6;&#x8F93;&#x51FA;&#xFF0C;&#x4EA6;&#x5373;&#x6587;&#x4EF6;dir.txt&#x4E2D;&#x3002;</p>
<p>&#x6B64;&#x5904;&#x5BF9;shell&#x5904;&#x7406;I/O&#x91CD;&#x5B9A;&#x5411;&#x7684;&#x89E3;&#x91CA;&#x6709;&#x6240;&#x7B80;&#x5316;&#x3002;&#x7279;&#x522B;&#x662F;&#xFF0C;&#x67D0;&#x4E9B;&#x547D;&#x4EE4;&#xFF0C;&#x5373;&#x6240;&#x8C13;shell&#x5185;&#x5EFA;&#x547D;&#x4EE4;&#xFF0C;&#x662F;&#x7531;shell&#x76F4;&#x63A5;&#x8FD0;&#x884C;&#x7684;&#xFF0C;&#x5E76;&#x672A;&#x8C03;&#x7528;fork()&#x6216;&#x8005;exec()&#x3002;&#x5728;&#x5904;&#x7406;I/O&#x91CD;&#x5B9A;&#x5411;&#x65F6;&#xFF0C;&#x9488;&#x5BF9;&#x8FD9;&#x6837;&#x7684;&#x547D;&#x4EE4;&#x5FC5;&#x987B;&#x8FDB;&#x884C;&#x7279;&#x6B8A;&#x5904;&#x7406;&#x3002;<br>&#x5C06;&#x67D0;&#x4E00; shell &#x547D;&#x4EE4;&#x5B9E;&#x73B0;&#x4E3A;&#x5185;&#x5EFA;&#x547D;&#x4EE4;&#xFF0C;&#x4E0D;&#x5916;&#x4E4E;&#x5982;&#x4E0B;&#x4E24;&#x4E2A;&#x76EE;&#x7684;&#xFF1A;&#x6548;&#x7387;&#x4EE5;&#x53CA;&#x4F1A;&#x5BF9; shell &#x4EA7;&#x751F;&#x526F;&#x4F5C;&#x7528;&#xFF08;side effect&#xFF09;&#x3002;&#x4E00;&#x4E9B;&#x9891;&#x7E41;&#x4F7F;&#x7528;&#x7684;&#x547D;&#x4EE4;&#xFF08;&#x5982;pwd&#x3001;echo&#x548C;test&#xFF09;&#x903B;&#x8F91;&#x90FD;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x653E;&#x5728;shell&#x5185;&#x90E8;&#x5B9E;&#x73B0;&#x6548;&#x7387;&#x4F1A;&#x66F4;&#x9AD8;&#x3002;&#x5C06;&#x5176;&#x4ED6;&#x547D;&#x4EE4;&#x5185;&#x7F6E;&#x4E8E; shell&#x5B9E;&#x73B0;&#xFF0C;&#x5219;&#x662F;&#x5E0C;&#x671B;&#x547D;&#x4EE4;&#x5BF9;shell&#x672C;&#x8EAB;&#x80FD;&#x4EA7;&#x751F;&#x526F;&#x4F5C;&#x7528;&#xFF1A;&#x66F4;&#x6539;shell&#x6240;&#x5B58;&#x50A8;&#x7684;&#x4FE1;&#x606F;&#xFF0C;&#x4FEE;&#x6539;shell&#x8FDB;&#x7A0B;&#x7684;&#x5C5E;&#x6027;&#xFF0C;&#x4EA6;&#x6216;&#x662F;&#x5F71;&#x54CD;shell&#x8FDB;&#x7A0B;&#x7684;&#x8FD0;&#x884C;&#x3002;&#x4F8B;&#x5982;&#xFF0C;cd&#x547D;&#x4EE4;&#x5FC5;&#x987B;&#x6539;&#x53D8;shell&#x81EA;&#x8EAB;&#x7684;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;&#xFF0C;&#x6545;&#x800C;&#x4E0D;&#x5E94;&#x5728;&#x4E00;&#x4E2A;&#x72EC;&#x7ACB;&#x8FDB;&#x7A0B;&#x4E2D;&#x6267;&#x884C;&#x3002;&#x4EA7;&#x751F;&#x526F;&#x4F5C;&#x7528;&#x7684;&#x5185;&#x5EFA;&#x547D;&#x4EE4;&#x8FD8;&#x5305;&#x62EC;exec&#x3001;exit&#x3001;read&#x3001;set&#x3001;source&#x3001;ulimit&#x3001;umask&#x3001;wait&#x4EE5;&#x53CA;shell&#x7684;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;&#xFF08;job-control&#xFF09;&#x547D;&#x4EE4;&#xFF08;jobs&#x3001;fg&#x548C;bg&#xFF09;&#x3002;&#x60F3;&#x4E86;&#x89E3;shell&#x652F;&#x6301;&#x7684;&#x5168;&#x5957;&#x5185;&#x5EFA;&#x547D;&#x4EE4;&#xFF0C;&#x53EF;&#x53C2;&#x8003;shell&#x624B;&#x518C;&#x9875;&#xFF08;manual page&#xFF09;&#x6587;&#x6863;&#x3002;</p>
<h3 id="&#x6267;&#x884C;&#x65F6;&#x5173;&#x95ED;&#xFF08;close-on-exec&#xFF09;&#x6807;&#x5FD7;&#xFF08;FD-CLOEXEC&#xFF09;"><a href="#&#x6267;&#x884C;&#x65F6;&#x5173;&#x95ED;&#xFF08;close-on-exec&#xFF09;&#x6807;&#x5FD7;&#xFF08;FD-CLOEXEC&#xFF09;" class="headerlink" title="&#x6267;&#x884C;&#x65F6;&#x5173;&#x95ED;&#xFF08;close-on-exec&#xFF09;&#x6807;&#x5FD7;&#xFF08;FD_CLOEXEC&#xFF09;"></a>&#x6267;&#x884C;&#x65F6;&#x5173;&#x95ED;&#xFF08;close-on-exec&#xFF09;&#x6807;&#x5FD7;&#xFF08;FD_CLOEXEC&#xFF09;</h3><p>&#x5728;&#x6267;&#x884C; exec()&#x4E4B;&#x524D;&#xFF0C;&#x7A0B;&#x5E8F;&#x6709;&#x65F6;&#x9700;&#x8981;&#x786E;&#x4FDD;&#x5173;&#x95ED;&#x67D0;&#x4E9B;&#x7279;&#x5B9A;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x3002;&#x5C24;&#x5176;&#x662F;&#x5728;&#x7279;&#x6743;&#x8FDB;&#x7A0B;&#x4E2D;&#x8C03;&#x7528;exec()&#x6765;&#x542F;&#x52A8;&#x4E00;&#x4E2A;&#x672A;&#x77E5;&#x7A0B;&#x5E8F;&#x65F6;&#xFF08;&#x5E76;&#x975E;&#x81EA;&#x5DF1;&#x7F16;&#x5199;&#xFF09;&#xFF0C;&#x4EA6;&#x6216;&#x662F;&#x542F;&#x52A8;&#x7A0B;&#x5E8F;&#x5E76;&#x4E0D;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x8FD9;&#x4E9B;&#x5DF2;&#x6253;&#x5F00;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x65F6;&#xFF0C;&#x4ECE;&#x5B89;&#x5168;&#x7F16;&#x7A0B;&#x7684;&#x89D2;&#x5EA6;&#x51FA;&#x53D1;&#xFF0C;&#x5E94;&#x5F53;&#x5728;&#x52A0;&#x8F7D;&#x65B0;&#x7A0B;&#x5E8F;&#x4E4B;&#x524D;&#x786E;&#x4FDD;&#x5173;&#x95ED;&#x90A3;&#x4E9B;&#x4E0D;&#x5FC5;&#x8981;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x3002;&#x5BF9;&#x6240;&#x6709;&#x6B64;&#x7C7B;&#x63CF;&#x8FF0;&#x7B26;&#x65BD;&#x4EE5;close()&#x8C03;&#x7528;&#x5C31;&#x53EF;&#x8FBE;&#x5230;&#x8FD9;&#x4E00;&#x76EE;&#x7684;&#xFF0C;&#x7136;&#x800C;&#x8FD9;&#x4E00;&#x505A;&#x6CD5;&#x5B58;&#x5728;&#x5982;&#x4E0B;&#x5C40;&#x9650;&#x6027;&#x3002;</p>
<ul>
<li>&#x67D0;&#x4E9B;&#x63CF;&#x8FF0;&#x7B26;&#x53EF;&#x80FD;&#x662F;&#x7531;&#x5E93;&#x51FD;&#x6570;&#x6253;&#x5F00;&#x7684;&#x3002;&#x4F46;&#x5E93;&#x51FD;&#x6570;&#x65E0;&#x6CD5;&#x4F7F;&#x4E3B;&#x7A0B;&#x5E8F;&#x5728;&#x6267;&#x884C;exec()&#x4E4B;&#x524D;&#x5173;&#x95ED;&#x76F8;&#x5E94;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x3002;&#x4F5C;&#x4E3A;&#x57FA;&#x672C;&#x539F;&#x5219;&#xFF0C;&#x5E93;&#x51FD;&#x6570;&#x5E94;&#x603B;&#x662F;&#x4E3A;&#x5176;&#x6253;&#x5F00;&#x7684;&#x6587;&#x4EF6;&#x8BBE;&#x7F6E;&#x6267;&#x884C;&#x65F6;&#x5173;&#x95ED;&#xFF08;close-on-exec&#xFF09;&#x6807;&#x5FD7;&#xFF0C;&#x7A0D;&#x540E;&#x5C06;&#x4ECB;&#x7ECD;&#x6240;&#x4F7F;&#x7528;&#x7684;&#x6280;&#x672F;&#x3002;</li>
<li>&#x5982;&#x679C;exec()&#x56E0;&#x67D0;&#x79CD;&#x539F;&#x56E0;&#x800C;&#x8C03;&#x7528;&#x5931;&#x8D25;&#xFF0C;&#x53EF;&#x80FD;&#x8FD8;&#x9700;&#x8981;&#x4F7F;&#x63CF;&#x8FF0;&#x7B26;&#x4FDD;&#x6301;&#x6253;&#x5F00;&#x72B6;&#x6001;&#x3002;&#x5982;&#x679C;&#x8FD9;&#x4E9B;&#x63CF;&#x8FF0;&#x7B26;&#x5DF2;&#x7136;&#x5173;&#x95ED;&#xFF0C;&#x5C06;&#x5B83;&#x4EEC;&#x91CD;&#x65B0;&#x6253;&#x5F00;&#x5E76;&#x6307;&#x5411;&#x76F8;&#x540C;&#x6587;&#x4EF6;&#x7684;&#x96BE;&#x5EA6;&#x5F88;&#x5927;&#xFF0C;&#x57FA;&#x672C;&#x4E0A;&#x4E0D;&#x592A;&#x53EF;&#x80FD;&#x3002;</li>
</ul>
<p>&#x4E3A;&#x6B64;&#xFF0C;&#x5185;&#x6838;&#x4E3A;&#x6BCF;&#x4E2A;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x63D0;&#x4F9B;&#x4E86;&#x6267;&#x884C;&#x65F6;&#x5173;&#x95ED;&#x6807;&#x5FD7;&#x3002;&#x5982;&#x679C;&#x8BBE;&#x7F6E;&#x4E86;&#x8FD9;&#x4E00;&#x6807;&#x5FD7;&#xFF0C;&#x90A3;&#x4E48;&#x5728;&#x6210;&#x529F;&#x6267;&#x884C;exec()&#x65F6;&#xFF0C;&#x4F1A;&#x81EA;&#x52A8;&#x5173;&#x95ED;&#x8BE5;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#xFF0C;&#x5982;&#x679C;&#x8C03;&#x7528;exec()&#x5931;&#x8D25;&#xFF0C;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x5219;&#x4F1A;&#x4FDD;&#x6301;&#x6253;&#x5F00;&#x72B6;&#x6001;&#x3002;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;fcntl()&#x6765;&#x8BBF;&#x95EE;&#x6267;&#x884C;&#x65F6;&#x5173;&#x95ED;&#x6807;&#x5FD7;&#x3002;fcntl()&#x7684;F_GETFD&#x64CD;&#x4F5C;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x6807;&#x5FD7;&#x7684;&#x4E00;&#x4EFD;&#x62F7;&#x8D1D;&#xFF1A;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">int</span> flags<span class="token punctuation">;</span>
flags<span class="token operator">=</span><span class="token function">fcntl</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span>F_GETFD<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>flags<span class="token operator">==</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;fcntl&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x83B7;&#x53D6;&#x8FD9;&#x4E9B;&#x6807;&#x5FD7;&#x540E;&#xFF0C;&#x53EF;&#x4EE5;&#x5BF9;FD_CLOEXEC&#x4F4D;&#x8FDB;&#x884C;&#x4FEE;&#x6539;&#xFF0C;&#x518D;&#x8C03;&#x7528;fcntl()&#x7684;F_SETFD&#x64CD;&#x4F5C;&#x4EE4;&#x5176;&#x751F;&#x6548;&#xFF1A;</p>
<pre class="line-numbers language-c"><code class="language-c">flags <span class="token operator">|</span><span class="token operator">=</span> FD_CLOEXEC<span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">fcntl</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span>F_SETFD<span class="token punctuation">,</span>flags<span class="token punctuation">)</span><span class="token operator">==</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;fcntl&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x5F53;&#x4F7F;&#x7528; dup()&#x3001;dup2()&#x6216;fcntl()&#x4E3A;&#x4E00;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x521B;&#x5EFA;&#x526F;&#x672C;&#x65F6;&#xFF0C;&#x603B;&#x662F;&#x4F1A;&#x6E05;&#x9664;&#x526F;&#x672C;&#x63CF;&#x8FF0;&#x7B26;&#x7684;&#x6267;&#x884C;&#x65F6;&#x5173;&#x95ED;&#x6807;&#x5FD7;&#x3002;&#xFF08;&#x8FD9;&#x4E00;&#x73B0;&#x8C61;&#x65E2;&#x6709;&#x5176;&#x5386;&#x53F2;&#x6E0A;&#x6E90;&#xFF0C;&#x4E5F;&#x987A;&#x5E94;&#x4E86; SUSv3 &#x7684;&#x8981;&#x6C42;&#x3002;&#xFF09;</p>
<h2 id="&#x4FE1;&#x53F7;&#x4E0E;exec"><a href="#&#x4FE1;&#x53F7;&#x4E0E;exec" class="headerlink" title="&#x4FE1;&#x53F7;&#x4E0E;exec()"></a>&#x4FE1;&#x53F7;&#x4E0E;exec()</h2><p>exec()&#x5728;&#x6267;&#x884C;&#x65F6;&#x4F1A;&#x5C06;&#x73B0;&#x6709;&#x8FDB;&#x7A0B;&#x7684;&#x6587;&#x672C;&#x6BB5;&#x4E22;&#x5F03;&#x3002;&#x8BE5;&#x6587;&#x672C;&#x6BB5;&#x53EF;&#x80FD;&#x5305;&#x542B;&#x4E86;&#x7531;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x521B;&#x5EFA;&#x7684;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x7A0B;&#x5E8F;&#x3002;&#x65E2;&#x7136;&#x5904;&#x7406;&#x5668;&#x5DF2;&#x7ECF;&#x4E0D;&#x77E5;&#x6240;&#x8E2A;&#xFF0C;&#x5185;&#x6838;&#x5C31;&#x4F1A;&#x5C06;&#x5BF9;&#x6240;&#x6709;&#x5DF2;&#x8BBE;&#x4FE1;&#x53F7;&#x7684;&#x5904;&#x7F6E;&#x91CD;&#x7F6E;&#x4E3A;SIG_DFL&#x3002;&#x800C;&#x5BF9;&#x6240;&#x6709;&#x5176;&#x4ED6;&#x4FE1;&#x53F7;&#xFF08;&#x5373;&#x5C06;&#x5904;&#x7F6E;&#x7F6E;&#x4E3A;SIG_IGN&#x6216;SIG_DFL&#x7684;&#x4FE1;&#x53F7;&#xFF09;&#x7684;&#x5904;&#x7F6E;&#x5219;&#x4FDD;&#x6301;&#x4E0D;&#x53D8;&#x3002;&#x8FD9;&#x4E5F;&#x7B26;&#x5408;SUSv3&#x7684;&#x8981;&#x6C42;&#x3002;</p>
<p>&#x4E0D;&#x8FC7;&#xFF0C;&#x906D;&#x5FFD;&#x7565;&#x7684; SIGCHLD &#x4FE1;&#x53F7;&#x5C5E;&#x4E8E; SUSv3 &#x4E2D;&#x7684;&#x7279;&#x4F8B;&#x3002;&#xFF08;&#x4E4B;&#x524D;&#x66FE;&#x5728; 26.3.3 &#x8282;&#x63D0;&#x53CA;&#xFF0C;&#x5FFD;&#x7565;SIGCHLD&#x80FD;&#x591F;&#x963B;&#x6B62;&#x50F5;&#x5C38;&#x8FDB;&#x7A0B;&#x7684;&#x4EA7;&#x751F;&#xFF09;&#x3002;&#x81F3;&#x4E8E;&#x8C03;&#x7528; exec()&#x4E4B;&#x540E;&#xFF0C;&#x662F;&#x7EE7;&#x7EED;&#x8BA9;&#x906D;&#x5FFD;&#x7565;&#x7684; SIGCHLD &#x4FE1;&#x53F7;&#x4FDD;&#x6301;&#x88AB;&#x5FFD;&#x7565;&#x72B6;&#x6001;&#xFF0C;&#x8FD8;&#x662F;&#x5C06;&#x5BF9;&#x5176;&#x5904;&#x7F6E;&#x91CD;&#x7F6E;&#x4E3A; SIG_DFL&#xFF0C;SUSv3 &#x5BF9;&#x6B64;&#x4E0D;&#x7F6E;&#x53EF;&#x5426;&#x3002;Linux &#x7684;&#x64CD;&#x4F5C;&#x53D6;&#x5176;&#x524D;&#x8005;&#xFF0C;&#x800C;&#x5176;&#x4ED6;&#x4E00;&#x4E9B;UNIX&#x5B9E;&#x73B0;&#xFF08;&#x5982;&#xFF1A;Solaris&#xFF09;&#x5219;&#x91C7;&#x7528;&#x540E;&#x8005;&#x3002;&#x8FD9;&#x5C31;&#x610F;&#x5473;&#x7740;&#xFF0C;&#x5BF9;&#x4E8E;&#x5FFD;&#x7565;SIGCHLD &#x7684;&#x7A0B;&#x5E8F;&#x800C;&#x8A00;&#xFF0C;&#x8981;&#x6700;&#x5927;&#x9650;&#x5EA6;&#x7684;&#x4FDD;&#x8BC1;&#x53EF;&#x79FB;&#x690D;&#x6027;&#xFF0C;&#x5C31;&#x5E94;&#x8BE5;&#x5728;&#x8C03;&#x7528; exec()&#x4E4B;&#x524D;&#x6267;&#x884C; signal&#xFF08;SIGCHLD&#xFF0C;SIG_DFL&#xFF09;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x7A0B;&#x5E8F;&#x4E5F;&#x4E0D;&#x5E94;&#x5F53;&#x5047;&#x8BBE;&#x5BF9;SIGCHLD&#x5904;&#x7F6E;&#x7684;&#x521D;&#x59CB;&#x8BBE;&#x7F6E;&#x662F;SIG_DFL&#x4E4B;&#x5916;&#x7684;&#x5176;&#x4ED6;&#x503C;&#x3002;</p>
<p>&#x8001;&#x7A0B;&#x5E8F;&#x7684;&#x6570;&#x636E;&#x6BB5;&#x3001;&#x5806;&#x4EE5;&#x53CA;&#x6808;&#x6089;&#x6570;&#x88AB;&#x6BC1;&#xFF0C;&#x8FD9;&#x4E5F;&#x610F;&#x5473;&#x7740;&#x901A;&#x8FC7;sigaltstack()&#xFF08;21.3&#x8282;&#xFF09;&#x6240;&#x521B;&#x5EFA;&#x7684;&#x4EFB;&#x4F55;&#x5907;&#x9009;&#x4FE1;&#x53F7;&#x6808;&#x90FD;&#x4F1A;&#x4E22;&#x5931;&#x3002;&#x7531;&#x4E8E; exec()&#x5728;&#x8C03;&#x7528;&#x671F;&#x95F4;&#x4E0D;&#x4F1A;&#x4FDD;&#x62A4;&#x5907;&#x9009;&#x4FE1;&#x53F7;&#x6808;&#xFF0C;&#x6545;&#x800C;&#x4E5F;&#x4F1A;&#x5C06;&#x6240;&#x6709;&#x4FE1;&#x53F7;&#x7684;SA_ONSTACK&#x4F4D;&#x6E05;&#x9664;&#x6389;&#x3002;</p>
<p>&#x5728;&#x8C03;&#x7528; exec()&#x671F;&#x95F4;&#xFF0C;&#x8FDB;&#x7A0B;&#x4FE1;&#x53F7;&#x63A9;&#x7801;&#x4EE5;&#x53CA;&#x6302;&#x8D77;&#xFF08;pending&#xFF09;&#x4FE1;&#x53F7;&#x7684;&#x8BBE;&#x7F6E;&#x5747;&#x5F97;&#x4EE5;&#x4FDD;&#x5B58;&#x3002;&#x8FD9;&#x4E00;&#x7279;&#x6027;&#x5141;&#x8BB8;&#x5BF9;&#x65B0;&#x7A0B;&#x5E8F;&#x7684;&#x4FE1;&#x53F7;&#x8FDB;&#x884C;&#x963B;&#x585E;&#x548C;&#x6392;&#x961F;&#x5904;&#x7406;&#x3002;&#x4E0D;&#x8FC7;&#xFF0C;SUSv3 &#x6307;&#x51FA;&#xFF0C;&#x8BB8;&#x591A;&#x73B0;&#x6709;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x7F16;&#x5199;&#x90FD;&#x57FA;&#x4E8E;&#x5982;&#x4E0B;&#x7684;&#x9519;&#x8BEF;&#x5047;&#x8BBE;&#xFF1A;&#x7A0B;&#x5E8F;&#x542F;&#x52A8;&#x65F6;&#x5C06;&#x5BF9;&#x67D0;&#x4E9B;&#x7279;&#x5B9A;&#x4FE1;&#x53F7;&#x7684;&#x5904;&#x7F6E;&#x7F6E;&#x4E3A; SIG_DFL&#xFF0C;&#x53C8;&#x6216;&#x8005;&#x5E76;&#x672A;&#x963B;&#x585E;&#x8FD9;&#x4E9B;&#x4FE1;&#x53F7;&#x3002;&#xFF08;&#x7279;&#x522B;&#x662F;&#xFF0C;C&#x8BED;&#x8A00;&#x6807;&#x51C6;&#x5BF9;&#x4FE1;&#x53F7;&#x7684;&#x89C4;&#x8303;&#x5F88;&#x5F31;&#xFF0C;&#x5BF9;&#x4FE1;&#x53F7;&#x963B;&#x585E;&#x4E5F;&#x672A;&#x7F6E;&#x4E00;&#x8BCD;&#xFF0C;&#x6240;&#x4EE5;&#x4E3A;&#x975E; UNIX&#x7CFB;&#x7EDF;&#x6240;&#x7F16;&#x5199;&#x7684;C&#x7A0B;&#x5E8F;&#x4E5F;&#x4E0D;&#x53EF;&#x80FD;&#x53BB;&#x89E3;&#x9664;&#x5BF9;&#x4FE1;&#x53F7;&#x7684;&#x963B;&#x585E;&#x3002;&#xFF09;&#x4E3A;&#x6B64;&#xFF0C;SUSv3&#x5EFA;&#x8BAE;&#xFF0C;&#x5728;&#x8C03;&#x7528; exec()&#x6267;&#x884C;&#x4EFB;&#x4F55;&#x7A0B;&#x5E8F;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x4E0D;&#x5E94;&#x5F53;&#x963B;&#x585E;&#x6216;&#x5FFD;&#x7565;&#x4FE1;&#x53F7;&#x3002;&#x8FD9;&#x91CC;&#x7684;&#x201C;&#x4EFB;&#x4F55;&#x7A0B;&#x5E8F;&#x201D;&#x662F;&#x6307;&#x5E76;&#x975E;&#x7531; exec()&#x7684;&#x8C03;&#x7528;&#x8005;&#x6240;&#x7F16;&#x5199;&#x7684;&#x7A0B;&#x5E8F;&#x3002;&#x81F3;&#x4E8E;&#x8BF4;&#x5982;&#x679C;&#x6267;&#x884C;&#x548C;&#x88AB;&#x6267;&#x884C;&#x7684;&#x7A0B;&#x5E8F;&#x5747;&#x51FA;&#x81EA;&#x4E00;&#x4EBA;&#x4E4B;&#x624B;&#xFF0C;&#x53C8;&#x6216;&#x8005;&#x5BF9;&#x8FD0;&#x884C;&#x7A0B;&#x5E8F;&#x5904;&#x7406;&#x4FE1;&#x53F7;&#x7684;&#x624B;&#x6CD5;&#x77E5;&#x6839;&#x77E5;&#x5E95;&#xFF0C;&#x90A3;&#x81EA;&#x7136;&#x53C8;&#x53E6;&#x5F53;&#x522B;&#x8BBA;&#x3002;</p>
<h2 id="&#x6267;&#x884C;shell&#x547D;&#x4EE4;&#xFF1A;system"><a href="#&#x6267;&#x884C;shell&#x547D;&#x4EE4;&#xFF1A;system" class="headerlink" title="&#x6267;&#x884C;shell&#x547D;&#x4EE4;&#xFF1A;system()"></a>&#x6267;&#x884C;shell&#x547D;&#x4EE4;&#xFF1A;system()</h2><p>&#x7A0B;&#x5E8F;&#x53EF;&#x901A;&#x8FC7;&#x8C03;&#x7528;system()&#x51FD;&#x6570;&#x6765;&#x6267;&#x884C;&#x4EFB;&#x610F;&#x7684;shell&#x547D;&#x4EE4;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdlib.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>command<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x51FD;&#x6570;system()&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5B50;&#x8FDB;&#x7A0B;&#x6765;&#x8FD0;&#x884C;shell&#xFF0C;&#x5E76;&#x4EE5;&#x4E4B;&#x6267;&#x884C;&#x547D;&#x4EE4;command&#x3002;<br>system()&#x7684;&#x4E3B;&#x8981;&#x4F18;&#x70B9;&#x5728;&#x4E8E;&#x7B80;&#x4FBF;&#x3002;</p>
<ul>
<li>&#x65E0;&#x9700;&#x5904;&#x7406;&#x5BF9;fork()&#x3001;exec()&#x3001;wait()&#x548C;exit()&#x7684;&#x8C03;&#x7528;&#x7EC6;&#x8282;&#x3002;</li>
<li>system()&#x4F1A;&#x4EE3;&#x4E3A;&#x5904;&#x7406;&#x9519;&#x8BEF;&#x548C;&#x4FE1;&#x53F7;&#x3002;</li>
<li>&#x56E0;&#x4E3A;system()&#x4F7F;&#x7528;shell&#x6765;&#x6267;&#x884C;&#x547D;&#x4EE4;&#xFF08;command&#xFF09;&#xFF0C;&#x6240;&#x4EE5;&#x4F1A;&#x5728;&#x6267;&#x884C;command&#x4E4B;&#x524D;&#x5BF9;&#x5176;&#x8FDB;&#x884C;&#x6240;&#x6709;&#x7684;&#x5E38;&#x89C4;shell&#x5904;&#x7406;&#x3001;&#x66FF;&#x6362;&#x4EE5;&#x53CA;&#x91CD;&#x5B9A;&#x5411;&#x64CD;&#x4F5C;&#x3002;&#x4E3A;&#x5E94;&#x7528;&#x589E;&#x52A0;&#x201C;&#x6267;&#x884C;&#x4E00;&#x6761;shell&#x547D;&#x4EE4;&#x201D;&#x7684;&#x529F;&#x80FD;&#x4E0D;&#x8FC7;&#x662F;&#x4E3E;&#x624B;&#x4E4B;&#x52B3;&#x3002;&#xFF08;&#x8BB8;&#x591A;&#x4EA4;&#x4E92;&#x5F0F;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4EE5;&#x201C;&#xFF01;command&#x201D;&#x7684;&#x5F62;&#x5F0F;&#x63D0;&#x4F9B;&#x4E86;&#x8FD9;&#x4E00;&#x529F;&#x80FD;&#x3002;&#xFF09;</li>
</ul>
<p>&#x4F46;&#x8FD9;&#x4E9B;&#x4F18;&#x70B9;&#x662F;&#x4EE5;&#x4F4E;&#x6548;&#x7387;&#x4E3A;&#x4EE3;&#x4EF7;&#x7684;&#x3002;&#x4F7F;&#x7528;system()&#x8FD0;&#x884C;&#x547D;&#x4EE4;&#x9700;&#x8981;&#x521B;&#x5EFA;&#x81F3;&#x5C11;&#x4E24;&#x4E2A;&#x8FDB;&#x7A0B;&#x3002;&#x4E00;&#x4E2A;&#x7528;&#x4E8E;&#x8FD0;&#x884C; shell&#xFF0C;&#x53E6;&#x5916;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x5219;&#x7528;&#x4E8E; shell &#x6240;&#x6267;&#x884C;&#x7684;&#x547D;&#x4EE4;&#xFF08;&#x6267;&#x884C;&#x6BCF;&#x4E2A;&#x547D;&#x4EE4;&#x90FD;&#x4F1A;&#x8C03;&#x7528;&#x4E00;&#x6B21;exec()&#xFF09;&#x3002;&#x5982;&#x679C;&#x5BF9;&#x6548;&#x7387;&#x6216;&#x8005;&#x901F;&#x5EA6;&#x6709;&#x6240;&#x8981;&#x6C42;&#xFF0C;&#x6700;&#x597D;&#x8FD8;&#x662F;&#x76F4;&#x63A5;&#x8C03;&#x7528;fork()&#x548C;exec()&#x6765;&#x6267;&#x884C;&#x65E2;&#x5B9A;&#x7A0B;&#x5E8F;&#x3002;</p>
<p>system()&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x5982;&#x4E0B;&#x3002;</p>
<ul>
<li>&#x5F53;command&#x4E3A;NULL&#x6307;&#x9488;&#x65F6;&#xFF0C;&#x5982;&#x679C;shell&#x53EF;&#x7528;&#x5219;system()&#x8FD4;&#x56DE;&#x975E;0&#x503C;&#xFF0C;&#x82E5;&#x4E0D;&#x53EF;&#x7528;&#x5219;&#x8FD4;&#x56DE;0&#x3002;&#x8FD9;&#x79CD;&#x8FD4;&#x56DE;&#x503C;&#x65B9;&#x5F0F;&#x6E90;&#x4E8E;C&#x8BED;&#x8A00;&#x6807;&#x51C6;&#xFF0C;&#x56E0;&#x4E3A;&#x5E76;&#x672A;&#x4E0E;&#x4EFB;&#x4F55;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x7ED1;&#x5B9A;&#xFF0C;&#x6240;&#x4EE5;&#x5982;&#x679C;system()&#x8FD0;&#x884C;&#x5728;&#x975E; UNIX &#x7CFB;&#x7EDF;&#x4E0A;&#xFF0C;&#x90A3;&#x4E48;&#x8BE5;&#x7CFB;&#x7EDF;&#x53EF;&#x80FD;&#x662F;&#x6CA1;&#x6709;shell&#x7684;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x5373;&#x4FBF;&#x6240;&#x6709;UNIX&#x5B9E;&#x73B0;&#x90FD;&#x6709; shell&#xFF0C;&#x5982;&#x679C;&#x7A0B;&#x5E8F;&#x5728;&#x8C03;&#x7528;system()&#x4E4B;&#x524D;&#x53C8;&#x8C03;&#x7528;&#x4E86;chroot()&#xFF0C;&#x90A3;&#x4E48;shell&#x4F9D;&#x7136;&#x53EF;&#x80FD;&#x65E0;&#x6548;&#x3002;&#x82E5;command&#x4E0D;&#x4E3A;NULL&#xFF0C;&#x5219;system()&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x7531;&#x672C;&#x5217;&#x8868;&#x4E2D;&#x7684;&#x4F59;&#x4E0B;&#x89C4;&#x5219;&#x51B3;&#x5B9A;&#x3002;</li>
<li>&#x5982;&#x679C;&#x65E0;&#x6CD5;&#x521B;&#x5EFA;&#x5B50;&#x8FDB;&#x7A0B;&#x6216;&#x662F;&#x65E0;&#x6CD5;&#x83B7;&#x53D6;&#x5176;&#x7EC8;&#x6B62;&#x72B6;&#x6001;&#xFF0C;&#x90A3;&#x4E48;system()&#x8FD4;&#x56DE;-1&#x3002;</li>
<li>&#x82E5;&#x5B50;&#x8FDB;&#x7A0B;&#x4E0D;&#x80FD;&#x6267;&#x884C;shell&#xFF0C;&#x5219;system()&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x4F1A;&#x4E0E;&#x5B50;shell&#x8C03;&#x7528;_exit(127)&#x7EC8;&#x6B62;&#x65F6;&#x4E00;&#x6837;&#x3002;</li>
<li>&#x5982;&#x679C;&#x6240;&#x6709;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x90FD;&#x6210;&#x529F;&#xFF0C;system()&#x4F1A;&#x8FD4;&#x56DE;&#x6267;&#x884C;command&#x7684;&#x5B50;shell&#x7684;&#x7EC8;&#x6B62;&#x72B6;&#x6001;&#x3002;shell &#x7684;&#x7EC8;&#x6B62;&#x72B6;&#x6001;&#x662F;&#x5176;&#x6267;&#x884C;&#x6700;&#x540E;&#x4E00;&#x6761;&#x547D;&#x4EE4;&#x65F6;&#x7684;&#x9000;&#x51FA;&#x72B6;&#x6001;&#xFF1B;&#x5982;&#x679C;&#x547D;&#x4EE4;&#x4E3A;&#x4FE1;&#x53F7;&#x6240;&#x6740;&#xFF0C;&#x5927;&#x591A;&#x6570;shell &#x4F1A;&#x4EE5;&#x503C; 128+n &#x9000;&#x51FA;&#xFF0C;&#x5176;&#x4E2D; n &#x4E3A;&#x4FE1;&#x53F7;&#x7F16;&#x53F7;.</li>
</ul>
<p>&#x5E94;&#x7528;&#x9700;&#x8981;&#x52A0;&#x8F7D;&#x5176;&#x4ED6;&#x7A0B;&#x5E8F;&#x65F6;&#xFF0C;&#x4E3A;&#x786E;&#x4FDD;&#x5B89;&#x5168;&#x8FC7;&#x5173;&#xFF0C;&#x5E94;&#x5F53;&#x76F4;&#x63A5;&#x8C03;&#x7528;fork()&#x548C;exec()&#x7CFB;&#x51FD;&#x6570;&#xFF08;execlp()&#x548C;execvp()&#x9664;&#x5916;&#xFF09;&#x4E4B;&#x4E00;&#x3002;</p>
<h1 id="&#x8BE6;&#x8FF0;&#x8FDB;&#x7A0B;&#x521B;&#x5EFA;&#x548C;&#x7A0B;&#x5E8F;&#x6267;&#x884C;"><a href="#&#x8BE6;&#x8FF0;&#x8FDB;&#x7A0B;&#x521B;&#x5EFA;&#x548C;&#x7A0B;&#x5E8F;&#x6267;&#x884C;" class="headerlink" title="&#x8BE6;&#x8FF0;&#x8FDB;&#x7A0B;&#x521B;&#x5EFA;&#x548C;&#x7A0B;&#x5E8F;&#x6267;&#x884C;"></a>&#x8BE6;&#x8FF0;&#x8FDB;&#x7A0B;&#x521B;&#x5EFA;&#x548C;&#x7A0B;&#x5E8F;&#x6267;&#x884C;</h1><h2 id="&#x8FDB;&#x7A0B;&#x8BB0;&#x8D26;"><a href="#&#x8FDB;&#x7A0B;&#x8BB0;&#x8D26;" class="headerlink" title="&#x8FDB;&#x7A0B;&#x8BB0;&#x8D26;"></a>&#x8FDB;&#x7A0B;&#x8BB0;&#x8D26;</h2><p>&#x6253;&#x5F00;&#x8FDB;&#x7A0B;&#x8BB0;&#x8D26;&#x529F;&#x80FD;&#x540E;&#xFF0C;&#x5185;&#x6838;&#x4F1A;&#x5728;&#x6BCF;&#x4E2A;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#x65F6;&#x5C06;&#x4E00;&#x6761;&#x8BB0;&#x8D26;&#x4FE1;&#x606F;&#x5199;&#x5165;&#x7CFB;&#x7EDF;&#x7EA7;&#x7684;&#x8FDB;&#x7A0B;&#x8BB0;&#x8D26;&#x6587;&#x4EF6;&#x3002;&#x8FD9;&#x6761;&#x8D26;&#x5355;&#x8BB0;&#x5F55;&#x5305;&#x542B;&#x4E86;&#x5185;&#x6838;&#x4E3A;&#x8BE5;&#x8FDB;&#x7A0B;&#x6240;&#x7EF4;&#x62A4;&#x7684;&#x591A;&#x79CD;&#x4FE1;&#x606F;&#xFF0C;&#x5305;&#x62EC;&#x7EC8;&#x6B62;&#x72B6;&#x6001;&#x4EE5;&#x53CA;&#x8FDB;&#x7A0B;&#x6D88;&#x8017;&#x7684;CPU&#x65F6;&#x95F4;&#x3002;&#x501F;&#x52A9;&#x4E8E;&#x6807;&#x51C6;&#x5DE5;&#x5177;&#xFF08;sa(8) &#x5BF9;&#x8D26;&#x5355;&#x6587;&#x4EF6;&#x8FDB;&#x884C;&#x6C47;&#x603B;&#xFF0C;lastcomm(1)&#x5219;&#x5C31;&#x5148;&#x524D;&#x6267;&#x884C;&#x7684;&#x547D;&#x4EE4;&#x5217;&#x51FA;&#x76F8;&#x5173;&#x4FE1;&#x606F;&#xFF09;&#x6216;&#x662F;&#x5B9A;&#x5236;&#x5E94;&#x7528;&#xFF0C;&#x53EF;&#x5BF9;&#x8BB0;&#x8D26;&#x6587;&#x4EF6;&#x8FDB;&#x884C;&#x5206;&#x6790;&#x3002;<br>&#x5185;&#x6838;2.6.10&#x4E4B;&#x524D;&#xFF0C;&#x5185;&#x6838;&#x4F1A;&#x4E3A;&#x57FA;&#x4E8E;NPTL&#x7EBF;&#x7A0B;&#x5B9E;&#x73B0;&#x6240;&#x521B;&#x5EFA;&#x7684;&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x5355;&#x72EC;&#x8BB0;&#x5F55;&#x4E00;&#x6761;&#x8FDB;&#x7A0B;&#x8BB0;&#x8D26;&#x4FE1;&#x606F;&#x3002;&#x81EA;&#x5185;&#x6838;2.6.10&#x5F00;&#x59CB;&#xFF0C;&#x53EA;&#x6709;&#x5F53;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x9000;&#x51FA;&#x65F6;&#x624D;&#x4F1A;&#x4E3A;&#x6574;&#x4E2A;&#x8FDB;&#x7A0B;&#x4FDD;&#x5B58;&#x4E00;&#x6761;&#x8D26;&#x5355;&#x8BB0;&#x5F55;&#x3002;&#x81F3;&#x4E8E;&#x66F4;&#x8001;&#x7684;LinuxThread&#x7EBF;&#x7A0B;&#x5B9E;&#x73B0;&#xFF0C;&#x5219;&#x4F1A;&#x4E3A;&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x5355;&#x72EC;&#x8BB0;&#x5F55;&#x4E00;&#x6761;&#x8FDB;&#x7A0B;&#x8BB0;&#x8D26;&#x4FE1;&#x606F;&#x3002;<br>&#x4ECE;&#x5386;&#x53F2;&#x4E0A;&#x770B;&#xFF0C;&#x8FDB;&#x7A0B;&#x8BB0;&#x8D26;&#x4E3B;&#x8981;&#x7528;&#x4E8E;&#x5728;&#x591A;&#x7528;&#x6237;UNIX&#x7CFB;&#x7EDF;&#x4E0A;&#x9488;&#x5BF9;&#x7528;&#x6237;&#x6240;&#x6D88;&#x8017;&#x7684;&#x7CFB;&#x7EDF;&#x8D44;&#x6E90;&#x8FDB;&#x884C;&#x8BA1;&#x8D39;&#x3002;&#x4E0D;&#x8FC7;&#xFF0C;&#x5982;&#x679C;&#x8FDB;&#x7A0B;&#x7684;&#x4FE1;&#x606F;&#x5E76;&#x672A;&#x7531;&#x5176;&#x7236;&#x8FDB;&#x7A0B;&#x8FDB;&#x884C;&#x76D1;&#x63A7;&#x548C;&#x62A5;&#x544A;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x8FDB;&#x7A0B;&#x8BB0;&#x8D26;&#x6765;&#x83B7;&#x53D6;&#x3002;<br>&#x867D;&#x7136;&#x5927;&#x90E8;&#x5206;UNIX&#x5B9E;&#x73B0;&#x90FD;&#x652F;&#x6301;&#x8FDB;&#x7A0B;&#x8BB0;&#x8D26;&#x529F;&#x80FD;&#xFF0C;&#x4F46;SUSv3&#x5E76;&#x672A;&#x5BF9;&#x5176;&#x8FDB;&#x884C;&#x89C4;&#x8303;&#x3002;&#x8D26;&#x5355;&#x8BB0;&#x5F55;&#x7684;&#x683C;&#x5F0F;&#x3001;&#x8BB0;&#x8D26;&#x6587;&#x4EF6;&#x7684;&#x4F4D;&#x7F6E;&#x4E5F;&#x968F;&#x7CFB;&#x7EDF;&#x5B9E;&#x73B0;&#x7684;&#x4E0D;&#x540C;&#x800C;&#x591A;&#x5C11;&#x5B58;&#x5728;&#x5DEE;&#x522B;&#x3002;<br>Linux&#x7CFB;&#x7EDF;&#x7684;&#x8FDB;&#x7A0B;&#x8BB0;&#x8D26;&#x529F;&#x80FD;&#x5C5E;&#x4E8E;&#x53EF;&#x9009;&#x5185;&#x6838;&#x7EC4;&#x4EF6;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;CONFIGBSD_PROCESS ACCT&#x9009;&#x9879;&#x8FDB;&#x884C;&#x914D;&#x7F6E;&#x3002;</p>
<h3 id="&#x6253;&#x5F00;&#x548C;&#x5173;&#x95ED;&#x8FDB;&#x7A0B;&#x8BB0;&#x8D26;&#x529F;&#x80FD;"><a href="#&#x6253;&#x5F00;&#x548C;&#x5173;&#x95ED;&#x8FDB;&#x7A0B;&#x8BB0;&#x8D26;&#x529F;&#x80FD;" class="headerlink" title="&#x6253;&#x5F00;&#x548C;&#x5173;&#x95ED;&#x8FDB;&#x7A0B;&#x8BB0;&#x8D26;&#x529F;&#x80FD;"></a>&#x6253;&#x5F00;&#x548C;&#x5173;&#x95ED;&#x8FDB;&#x7A0B;&#x8BB0;&#x8D26;&#x529F;&#x80FD;</h3><p>&#x7279;&#x6743;&#x8FDB;&#x7A0B;&#x53EF;&#x5229;&#x7528;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;acct()&#x6765;&#x6253;&#x5F00;&#x548C;&#x5173;&#x95ED;&#x8FDB;&#x7A0B;&#x8BB0;&#x8D26;&#x529F;&#x80FD;&#x3002;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5F88;&#x5C11;&#x4F7F;&#x7528;&#x8FD9;&#x4E00;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x3002;&#x4E00;&#x822C;&#x4F1A;&#x5C06;&#x76F8;&#x5E94;&#x547D;&#x4EE4;&#x7F6E;&#x4E8E;&#x7CFB;&#x7EDF;&#x542F;&#x52A8;&#x811A;&#x672C;&#x4E2D;&#xFF0C;&#x5728;&#x7CFB;&#x7EDF;&#x6BCF;&#x6B21;&#x91CD;&#x542F;&#x65F6;&#x5F00;&#x542F;&#x8FDB;&#x7A0B;&#x8BB0;&#x8D26;&#x529F;&#x80FD;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">define</span> _BSD_SOURCE</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;unistd.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">acct</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>acctfile<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x4E3A;&#x4E86;&#x6253;&#x5F00;&#x8FDB;&#x7A0B;&#x8D26;&#x5355;&#x529F;&#x80FD;&#xFF0C;&#x9700;&#x8981;&#x5728;&#x53C2;&#x6570;acctfile&#x4E2D;&#x6307;&#x5B9A;&#x4E00;&#x4E2A;&#x73B0;&#x6709;&#x5E38;&#x89C4;&#x6587;&#x4EF6;&#x7684;&#x8DEF;&#x5F84;&#x540D;&#x3002;&#x8BB0;&#x8D26;&#x6587;&#x4EF6;&#x901A;&#x5E38;&#x7684;&#x8DEF;&#x5F84;&#x540D;&#x662F;/var/log/pacct&#x6216;/usr/account/pacct&#x3002;&#x82E5;&#x60F3;&#x5173;&#x95ED;&#x8FDB;&#x7A0B;&#x8BB0;&#x8D26;&#x529F;&#x80FD;&#xFF0C;&#x5219;&#x6307;&#x5B9A;acctfile&#x4E3A;NULL&#x5373;&#x53EF;&#x3002;</p>
<p>&#x7A0B;&#x5E8F;&#x6E05;&#x5355;&#x4E2D;&#x7A0B;&#x5E8F;&#x4F7F;&#x7528;acct()&#x6765;&#x5F00;&#x5173;&#x8FDB;&#x7A0B;&#x7684;&#x8BB0;&#x8D26;&#x529F;&#x80FD;&#x3002;&#x8BE5;&#x7A0B;&#x5E8F;&#x7684;&#x4F5C;&#x7528;&#x7C7B;&#x4F3C;&#x4E8E;shell&#x547D;&#x4EE4;accton(8)&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">define</span> _BSD_SOURCE</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string.h&gt;</span></span>

<span class="token keyword">int</span>
<span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>argc <span class="token operator">&gt;</span> <span class="token number">2</span> <span class="token operator">||</span> <span class="token punctuation">(</span>argc <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token function">strcmp</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;--help&quot;</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%s [file]\n&quot;</span><span class="token punctuation">,</span> argv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">acct</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;acct&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Process accounting %s\n&quot;</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">&quot;disabled&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;enabled&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">exit</span><span class="token punctuation">(</span>EXIT_SUCCESS<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>acctProcess accounting disabled</code></pre><h3 id="&#x8FDB;&#x7A0B;&#x8D26;&#x5355;&#x8BB0;&#x5F55;"><a href="#&#x8FDB;&#x7A0B;&#x8D26;&#x5355;&#x8BB0;&#x5F55;" class="headerlink" title="&#x8FDB;&#x7A0B;&#x8D26;&#x5355;&#x8BB0;&#x5F55;"></a>&#x8FDB;&#x7A0B;&#x8D26;&#x5355;&#x8BB0;&#x5F55;</h3><p>&#x4E00;&#x65E6;&#x6253;&#x5F00;&#x8FDB;&#x7A0B;&#x8BB0;&#x8D26;&#x529F;&#x80FD;&#xFF0C;&#x6BCF;&#x5F53;&#x4E00;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#x65F6;&#xFF0C;&#x5C31;&#x4F1A;&#x6709;&#x4E00;&#x6761;acct&#x8BB0;&#x5F55;&#x5199;&#x5165;&#x8BB0;&#x8D26;&#x6587;&#x4EF6;&#x3002;acct&#x7ED3;&#x6784;&#x5B9A;&#x4E49;&#x4E8E;&#x5934;&#x6587;&#x4EF6;&lt;sys/acct.h&gt;&#x4E2D;&#xFF0C;&#x5177;&#x4F53;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">struct</span> acct<span class="token punctuation">{</span>
    <span class="token keyword">char</span> ac_flag<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* Accounting flags. */</span>
    u_int16_t ac_uid<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* Accounting user ID. */</span>
    u_int16_t ac_gid<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* Accounting group ID. */</span>
    u_int16_t ac_tty<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* Controlling tty. */</span>
    u_int32_t ac_btime<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* Beginning time. */</span>
    comp_t ac_utime<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* Accounting user time. */</span>
    comp_t ac_stime<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* Accounting system time. */</span>
    comp_t ac_etime<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* Accounting elapsed time. */</span>
    comp_t ac_mem<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* Accounting average memory usage. */</span>
    comp_t ac_io<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* Accounting chars transferred. */</span>
    comp_t ac_rw<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* Accounting blocks read or written. */</span>
    comp_t ac_minflt<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* Accounting minor pagefaults. */</span>
    comp_t ac_majflt<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* Accounting major pagefaults. */</span>
    comp_t ac_swaps<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* Accounting number of swaps. */</span>
    u_int32_t ac_exitcode<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* Accounting process exitcode. */</span>
    <span class="token keyword">char</span> ac_comm<span class="token punctuation">[</span>ACCT_COMM<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* Accounting command name. */</span>
    <span class="token keyword">char</span> ac_pad<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* Accounting padding bytes. */</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="&#x7CFB;&#x7EDF;&#x8C03;&#x7528;clone"><a href="#&#x7CFB;&#x7EDF;&#x8C03;&#x7528;clone" class="headerlink" title="&#x7CFB;&#x7EDF;&#x8C03;&#x7528;clone()"></a>&#x7CFB;&#x7EDF;&#x8C03;&#x7528;clone()</h2><p>&#x7C7B;&#x4F3C;&#x4E8E;fork()&#x548C;vfork()&#xFF0C;Linux&#x7279;&#x6709;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;clone()&#x4E5F;&#x80FD;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x8FDB;&#x7A0B;&#x3002;&#x4E0E;&#x524D;&#x4E24;&#x8005;&#x4E0D;&#x540C;&#x7684;&#x662F;&#xFF0C;&#x540E;&#x8005;&#x5728;&#x8FDB;&#x7A0B;&#x521B;&#x5EFA;&#x671F;&#x95F4;&#x5BF9;&#x6B65;&#x9AA4;&#x7684;&#x63A7;&#x5236;&#x66F4;&#x4E3A;&#x7CBE;&#x51C6;&#x3002;clone()&#x4E3B;&#x8981;&#x7528;&#x4E8E;&#x7EBF;&#x7A0B;&#x5E93;&#x7684;&#x5B9E;&#x73B0;&#x3002;&#x7531;&#x4E8E;clone()&#x6709;&#x635F;&#x4E8E;&#x7A0B;&#x5E8F;&#x7684;&#x53EF;&#x79FB;&#x690D;&#x6027;&#xFF0C;&#x6545;&#x800C;&#x5E94;&#x907F;&#x514D;&#x5728;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E2D;&#x76F4;&#x63A5;&#x4F7F;&#x7528;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">define</span> _GNU_SOURCE</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;sched.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">clone</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>func<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">void</span> <span class="token operator">*</span>child_slack<span class="token punctuation">,</span><span class="token keyword">int</span> flags<span class="token punctuation">,</span><span class="token keyword">void</span> <span class="token operator">*</span>func_arg<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token comment" spellcheck="true">/* pid_t *ptid, struct user_desc *tls,pid_t *ctid*/</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x5982;&#x540C;fork()&#xFF0C;&#x7531;clone()&#x521B;&#x5EFA;&#x7684;&#x65B0;&#x8FDB;&#x7A0B;&#x51E0;&#x8FD1;&#x4E8E;&#x7236;&#x8FDB;&#x7A0B;&#x7684;&#x7FFB;&#x7248;&#x3002;<br>&#x4F46;&#x4E0E;fork()&#x4E0D;&#x540C;&#x7684;&#x662F;&#xFF0C;&#x514B;&#x9686;&#x751F;&#x6210;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x7EE7;&#x7EED;&#x8FD0;&#x884C;&#x65F6;&#x4E0D;&#x4EE5;&#x8C03;&#x7528;&#x5904;&#x4E3A;&#x8D77;&#x70B9;&#xFF0C;&#x8F6C;&#x800C;&#x53BB;&#x8C03;&#x7528;&#x4EE5;&#x53C2;&#x6570;func&#x6240;&#x6307;&#x5B9A;&#x7684;&#x51FD;&#x6570;&#xFF0C;func&#x53C8;&#x79F0;&#x4E3A;&#x5B50;&#x51FD;&#x6570;&#xFF08;child function&#xFF09;&#x3002;&#x8C03;&#x7528;&#x5B50;&#x51FD;&#x6570;&#x65F6;&#x7684;&#x53C2;&#x6570;&#x7531; func_arg&#x6307;&#x5B9A;&#x3002;&#x7ECF;&#x8FC7;&#x9002;&#x5F53;&#x8F6C;&#x6362;&#xFF0C;&#x5B50;&#x51FD;&#x6570;&#x53EF;&#x5BF9;&#x8BE5;&#x53C2;&#x6570;&#x7684;&#x542B;&#x4E49;&#x81EA;&#x7531;&#x89E3;&#x8BFB;&#xFF0C;&#x4F8B;&#x5982;&#xFF0C;&#x53EF;&#x4EE5;&#x4F5C;&#x4E3A;&#x6574;&#x578B;&#x503C;&#xFF08;int&#xFF09;&#xFF0C;&#x4E5F;&#x53EF;&#x89C6;&#x4E3A;&#x6307;&#x5411;&#x7ED3;&#x6784;&#x7684;&#x6307;&#x9488;&#x3002;&#xFF08;&#x4E4B;&#x6240;&#x4EE5;&#x53EF;&#x4EE5;&#x4F5C;&#x4E3A;&#x6307;&#x9488;&#x5904;&#x7406;&#xFF0C;&#x662F;&#x56E0;&#x4E3A;&#x514B;&#x9686;&#x4EA7;&#x751F;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x5BF9;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x7684;&#x5185;&#x5B58;&#x65E2;&#x53EF;&#x83B7;&#x53D6;&#xFF0C;&#x4E5F;&#x53EF;&#x5171;&#x4EAB;&#x3002;&#xFF09;<br>&#x5BF9;&#x4E8E;&#x5185;&#x6838;&#x800C;&#x8A00;&#xFF0C;fork()&#x3001;vfork()&#x4EE5;&#x53CA;clone()&#x6700;&#x7EC8;&#x5747;&#x7531;&#x540C;&#x4E00;&#x51FD;&#x6570;&#x5B9E;&#x73B0;&#xFF08;kernel/fork.c&#x4E2D;&#x7684;do_fork()&#xFF09;&#x3002;&#x5728;&#x8FD9;&#x4E00;&#x5C42;&#x6B21;&#x4E0A;&#xFF0C;clone&#x4E0E;fork&#x66F4;&#x4E3A;&#x63A5;&#x8FD1;&#xFF1A;sys_clone()&#x5E76;&#x6CA1;&#x6709;func&#x548C;func_arg&#x53C2;&#x6570;&#xFF0C;&#x4E14;&#x8C03;&#x7528;&#x540E;sys_clone()&#x5728;&#x5B50;&#x8FDB;&#x7A0B;&#x4E2D;&#x8FD4;&#x56DE;&#x7684;&#x65B9;&#x5F0F;&#x4E5F;&#x4E0E;fork()&#x76F8;&#x540C;&#x3002;&#x6B63;&#x6587;&#x6240;&#x8FF0;&#x7684;clone()&#x662F;&#x7531;glibc&#x4E3A;sys_clone()&#x63D0;&#x4F9B;&#x7684;&#x5C01;&#x88C5;&#x51FD;&#x6570;&#x3002;<br>&#x5F53;&#x51FD;&#x6570;func&#x8FD4;&#x56DE;&#xFF08;&#x6B64;&#x65F6;&#x5176;&#x8FD4;&#x56DE;&#x503C;&#x5373;&#x4E3A;&#x8FDB;&#x7A0B;&#x7684;&#x9000;&#x51FA;&#x72B6;&#x6001;&#xFF09;&#x6216;&#x662F;&#x8C03;&#x7528;exit()&#xFF08;&#x6216;_exit()&#xFF09;&#x4E4B;&#x540E;&#xFF0C;&#x514B;&#x9686;&#x4EA7;&#x751F;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x5C31;&#x4F1A;&#x7EC8;&#x6B62;&#x3002;&#x7167;&#x4F8B;&#xFF0C;&#x7236;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;wait()&#x4E00;&#x7C7B;&#x51FD;&#x6570;&#x6765;&#x7B49;&#x5F85;&#x514B;&#x9686;&#x5B50;&#x8FDB;&#x7A0B;&#x3002;<br>&#x56E0;&#x4E3A;&#x514B;&#x9686;&#x4EA7;&#x751F;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x53EF;&#x80FD;&#xFF08;&#x7C7B;&#x4F3C;vfork()&#xFF09;&#x5171;&#x4EAB;&#x7236;&#x8FDB;&#x7A0B;&#x7684;&#x5185;&#x5B58;&#xFF0C;&#x6240;&#x4EE5;&#x5B83;&#x4E0D;&#x80FD;&#x4F7F;&#x7528;&#x7236;&#x8FDB;&#x7A0B;&#x7684;&#x6808;&#x3002;&#x76F8;&#x53CD;&#xFF0C;&#x8C03;&#x7528;&#x8005;&#x5FC5;&#x987B;&#x5206;&#x914D;&#x4E00;&#x5757;&#x5927;&#x5C0F;&#x9002;&#x4E2D;&#x7684;&#x5185;&#x5B58;&#x7A7A;&#x95F4;&#x4F9B;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x6808;&#x4F7F;&#x7528;&#xFF0C;&#x540C;&#x65F6;&#x5C06;&#x8FD9;&#x5757;&#x5185;&#x5B58;&#x7684;&#x6307;&#x9488;&#x7F6E;&#x4E8E;&#x53C2;&#x6570;child_stack&#x4E2D;&#x3002;&#x5728;&#x5927;&#x591A;&#x6570;&#x786C;&#x4EF6;&#x67B6;&#x6784;&#x4E2D;&#xFF0C;&#x6808;&#x7A7A;&#x95F4;&#x7684;&#x589E;&#x957F;&#x65B9;&#x5411;&#x662F;&#x5411;&#x4E0B;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x53C2;&#x6570;child_stack&#x5E94;&#x5F53;&#x6307;&#x5411;&#x6240;&#x5206;&#x914D;&#x5185;&#x5B58;&#x5757;&#x7684;&#x9AD8;&#x7AEF;&#x3002;<br>&#x6808;&#x589E;&#x957F;&#x65B9;&#x5411;&#x5BF9;&#x67B6;&#x6784;&#x7684;&#x4F9D;&#x8D56;&#x662F;clone()&#x8BBE;&#x8BA1;&#x7684;&#x4E00;&#x5904;&#x7F3A;&#x9677;&#x3002;Interl IA-64&#x67B6;&#x6784;&#x5C31;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x6B3E;&#x7ECF;&#x8FC7;&#x6539;&#x5584;&#x7684;&#x514B;&#x9686;API&#xFF0C;&#x79F0;&#x4E3A;clone2()&#x3002;&#x8BE5;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5BF9;&#x5B50;&#x8FDB;&#x7A0B;&#x6808;&#x8303;&#x56F4;&#x7684;&#x5B9A;&#x4E49;&#x65B9;&#x5F0F;&#x4E0D;&#x4F9D;&#x8D56;&#x4E8E;&#x6808;&#x7684;&#x589E;&#x957F;&#x65B9;&#x5411;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x63D0;&#x4F9B;&#x6808;&#x7684;&#x8D77;&#x59CB;&#x5730;&#x5740;&#x4EE5;&#x53CA;&#x5927;&#x5C0F;&#x5373;&#x53EF;&#x3002;<br>&#x51FD;&#x6570;clone()&#x7684;&#x53C2;&#x6570;flags&#x670D;&#x52A1;&#x4E8E;&#x53CC;&#x91CD;&#x76EE;&#x7684;&#x3002;&#x9996;&#x5148;&#xFF0C;&#x5176;&#x4F4E;&#x5B57;&#x8282;&#x4E2D;&#x5B58;&#x653E;&#x7740;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x7EC8;&#x6B62;&#x4FE1;&#x53F7;&#xFF08;terminateion signal&#xFF09;&#xFF0C;&#x5B50;&#x8FDB;&#x7A0B;&#x9000;&#x51FA;&#x65F6;&#x5176;&#x7236;&#x8FDB;&#x7A0B;&#x5C06;&#x6536;&#x5230;&#x8FD9;&#x4E00;&#x4FE1;&#x53F7;&#x3002;&#xFF08;&#x5982;&#x679C;&#x514B;&#x9686;&#x4EA7;&#x751F;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x56E0;&#x4FE1;&#x53F7;&#x800C;&#x7EC8;&#x6B62;&#xFF0C;&#x7236;&#x8FDB;&#x7A0B;&#x4F9D;&#x7136;&#x4F1A;&#x6536;&#x5230;SIGCHLD&#x4FE1;&#x53F7;&#x3002;&#xFF09;&#x8BE5;&#x5B57;&#x8282;&#x4E5F;&#x53EF;&#x80FD;&#x4E3A;0&#xFF0C;&#x8FD9;&#x65F6;&#x5C06;&#x4E0D;&#x4F1A;&#x4EA7;&#x751F;&#x4EFB;&#x4F55;&#x4FE1;&#x53F7;&#x3002;&#xFF08;&#x501F;&#x52A9;&#x4E8E;Linux&#x7279;&#x6709;&#x7684;/proc/PID/stat&#x6587;&#x4EF6;&#xFF0C;&#x53EF;&#x4EE5;&#x5224;&#x5B9A;&#x4EFB;&#x4F55;&#x8FDB;&#x7A0B;&#x7684;&#x7EC8;&#x6B62;&#x4FE1;&#x53F7;&#xFF0C;&#x8BE6;&#x60C5;&#x8BF7;&#x53C2;&#x9605;proc(5)&#x624B;&#x518C;&#x9875;&#x3002;&#xFF09;<br>&#x5BF9;&#x4E8E;fork()&#x548C;vfork()&#x800C;&#x8A00;&#xFF0C;&#x5C31;&#x65E0;&#x4ECE;&#x9009;&#x62E9;&#x7EC8;&#x6B62;&#x4FE1;&#x53F7;&#xFF0C;&#x53EA;&#x80FD;&#x662F;SIGCHLD&#x3002;</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th align="left">&#x6807;&#x3000;&#x3000;&#x5FD7;</th>
<th align="center">&#x8BBE;&#x7F6E;&#x540E;&#x7684;&#x6548;&#x679C;</th>
</tr>
</thead>
<tbody><tr>
<td align="left">CLONE_CHILD_CLEARTID</td>
<td align="center">&#x5F53;&#x5B50;&#x8FDB;&#x7A0B;&#x8C03;&#x7528;exec()&#x6216;_exit()&#x65F6;&#xFF0C;&#x6E05;&#x9664;ctid&#xFF08;&#x4ECE;&#x7248;&#x672C;2.6&#x5F00;&#x59CB;&#xFF09;</td>
</tr>
<tr>
<td align="left">CLONE_CHILD_SETTID</td>
<td align="center">&#x5C06;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x7EBF;&#x7A0B;ID&#x5199;&#x5165;ctid&#xFF08;&#x4ECE;2.6&#x7248;&#x672C;&#x5F00;&#x59CB;&#xFF09;</td>
</tr>
<tr>
<td align="left">CLONE_FILES</td>
<td align="center">&#x7236;&#x3001;&#x5B50;&#x8FDB;&#x7A0B;&#x5171;&#x4EAB;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x8868;</td>
</tr>
<tr>
<td align="left">CLONE_FS</td>
<td align="center">&#x7236;&#x3001;&#x5B50;&#x8FDB;&#x7A0B;&#x5171;&#x4EAB;&#x4E0E;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x76F8;&#x5173;&#x7684;&#x5C5E;&#x6027;</td>
</tr>
<tr>
<td align="left">CLONE_IO</td>
<td align="center">&#x5B50;&#x8FDB;&#x7A0B;&#x5171;&#x4EAB;&#x7236;&#x8FDB;&#x7A0B;&#x7684;I/O&#x4E0A;&#x4E0B;&#x6587;&#x73AF;&#x5883;&#xFF08;&#x4ECE;2.6.25&#x7248;&#x672C;&#x5F00;&#x59CB;&#xFF09;</td>
</tr>
<tr>
<td align="left">CLONE_NEWIPC</td>
<td align="center">&#x5B50;&#x8FDB;&#x7A0B;&#x83B7;&#x5F97;&#x65B0;&#x7684;System V IPC&#x547D;&#x540D;&#x7A7A;&#x95F4;&#xFF08;&#x4ECE;2.6.19&#x5F00;&#x59CB;&#xFF09;</td>
</tr>
<tr>
<td align="left">CLONE_NEWNET</td>
<td align="center">&#x5B50;&#x8FDB;&#x7A0B;&#x83B7;&#x5F97;&#x65B0;&#x7684;&#x7F51;&#x7EDC;&#x547D;&#x540D;&#x7A7A;&#x95F4;&#xFF08;&#x4ECE;2.4.24&#x7248;&#x672C;&#x5F00;&#x59CB;&#xFF09;</td>
</tr>
<tr>
<td align="left">CLONE_NEWNS</td>
<td align="center">&#x5B50;&#x8FDB;&#x7A0B;&#x83B7;&#x5F97;&#x7236;&#x8FDB;&#x7A0B;&#x6302;&#x8F7D;&#xFF08;mount&#xFF09;&#x547D;&#x540D;&#x7A7A;&#x95F4;&#x7684;&#x526F;&#x672C;&#xFF08;&#x4ECE;2.4.19&#x7248;&#x672C;&#x5F00;&#x59CB;&#xFF09;</td>
</tr>
<tr>
<td align="left">CLONE_NEWPID</td>
<td align="center">&#x5B50;&#x8FDB;&#x7A0B;&#x83B7;&#x5F97;&#x65B0;&#x7684;&#x8FDB;&#x7A0B;ID&#x547D;&#x540D;&#x7A7A;&#x95F4;&#xFF08;&#x4ECE;2.6.23&#x7248;&#x672C;&#x5F00;&#x59CB;&#xFF09;</td>
</tr>
<tr>
<td align="left">CLONE_NEWUSER</td>
<td align="center">&#x5B50;&#x8FDB;&#x7A0B;&#x83B7;&#x5F97;&#x65B0;&#x7684;&#x7528;&#x6237;ID&#x547D;&#x540D;&#x7A7A;&#x95F4;&#xFF08;&#x4ECE;2.6.23&#x7248;&#x672C;&#x5F00;&#x59CB;&#xFF09;</td>
</tr>
<tr>
<td align="left">CLONE_NEWUTS</td>
<td align="center">&#x5B50;&#x8FDB;&#x7A0B;&#x83B7;&#x5F97;&#x65B0;&#x7684;UTS&#xFF08;utsname()&#xFF09;&#x547D;&#x540D;&#x7A7A;&#x95F4;&#xFF08;&#x4ECE;2.6.19&#x7248;&#x672C;&#x5F00;&#x59CB;&#xFF09;</td>
</tr>
<tr>
<td align="left">CLONE_PARENT</td>
<td align="center">&#x5C06;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x7236;&#x8FDB;&#x7A0B;&#x7F6E;&#x4E3A;&#x8C03;&#x7528;&#x8005;&#x7684;&#x7236;&#x8FDB;&#x7A0B;&#xFF08;&#x4ECE;2.4&#x7248;&#x672C;&#x5F00;&#x59CB;&#xFF09;</td>
</tr>
<tr>
<td align="left">CLONE_PARENT_SETTID</td>
<td align="center">&#x5C06;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x7EBF;&#x7A0B;ID&#x5199;&#x5165;ptid&#xFF08;&#x4ECE;2.6&#x7248;&#x672C;&#x5F00;&#x59CB;&#xFF09;</td>
</tr>
<tr>
<td align="left">CLONE_PID</td>
<td align="center">&#x6807;&#x5FD7;&#x5DF2;&#x5E9F;&#x6B62;&#xFF0C;&#x4EC5;&#x7528;&#x4E8E;&#x7CFB;&#x7EDF;&#x542F;&#x52A8;&#x8FDB;&#x7A0B;&#xFF08;&#x76F4;&#x81F3;2.4&#x7248;&#x672C;&#x4E3A;&#x6B62;&#xFF09;</td>
</tr>
<tr>
<td align="left">CLONE_PTRACE</td>
<td align="center">&#x5982;&#x679C;&#x6B63;&#x5728;&#x8DDF;&#x8E2A;&#x7236;&#x8FDB;&#x7A0B;&#xFF0C;&#x90A3;&#x4E48;&#x5B50;&#x8FDB;&#x7A0B;&#x4E5F;&#x7167;&#x6B64;&#x529E;&#x7406;</td>
</tr>
<tr>
<td align="left">CLONE_SETTLS</td>
<td align="center">tls&#x63CF;&#x8FF0;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x7EBF;&#x7A0B;&#x672C;&#x5730;&#x5B58;&#x50A8;&#xFF08;&#x4ECE;2.6&#x5F00;&#x59CB;&#xFF09;</td>
</tr>
<tr>
<td align="left">CLONE_SIGHAND</td>
<td align="center">&#x7236;&#x3001;&#x5B50;&#x8FDB;&#x7A0B;&#x5171;&#x4EAB;&#x5BF9;&#x4FE1;&#x53F7;&#x7684;&#x5904;&#x7F6E;&#x8BBE;&#x7F6E;</td>
</tr>
<tr>
<td align="left">CLONE_SYSVSEM</td>
<td align="center">&#x7236;&#x3001;&#x5B50;&#x8FDB;&#x7A0B;&#x5171;&#x4EAB;&#x4FE1;&#x53F7;&#x91CF;&#x8FD8;&#x539F;&#xFF08;undo&#xFF09;&#x503C;&#xFF08;&#x4ECE;2.6&#x7248;&#x672C;&#x5F00;&#x59CB;&#xFF09;</td>
</tr>
<tr>
<td align="left">CLONE_THREAD</td>
<td align="center">&#x5C06;&#x5B50;&#x8FDB;&#x7A0B;&#x7F6E;&#x4E8E;&#x7236;&#x8FDB;&#x7A0B;&#x6240;&#x5C5E;&#x7684;&#x7EBF;&#x7A0B;&#x7EC4;&#x4E2D;&#xFF08;&#x4ECE;2.4&#x5F00;&#x59CB;&#xFF09;</td>
</tr>
<tr>
<td align="left">CLONE_UNTRACED</td>
<td align="center">&#x4E0D;&#x5F3A;&#x5236;&#x5BF9;&#x5B50;&#x8FDB;&#x7A0B;&#x8BBE;&#x7F6E;CLONE_PTRACE&#xFF08;&#x4ECE;2.6&#x7248;&#x672C;&#x5F00;&#x59CB;&#xFF09;</td>
</tr>
<tr>
<td align="left">CLONE_VFORK</td>
<td align="center">&#x6302;&#x8D77;&#x7236;&#x8FDB;&#x7A0B;&#x76F4;&#x81F3;&#x5B50;&#x8FDB;&#x7A0B;&#x8C03;&#x7528;exec()&#x6216;_exit()</td>
</tr>
<tr>
<td align="left">CLONE_VM</td>
<td align="center">&#x7236;&#x3001;&#x5B50;&#x8FDB;&#x7A0B;&#x5171;&#x4EAB;&#x865A;&#x62DF;&#x5185;&#x5B58;</td>
</tr>
</tbody></table></div>
<p>clone()&#x7684;&#x4F59;&#x4E0B;&#x53C2;&#x6570;&#x5206;&#x522B;&#x662F;&#xFF1A;ptid&#x3001;tls&#x548C;ctid&#x3002;&#x8FD9;&#x4E9B;&#x53C2;&#x6570;&#x4E0E;&#x7EBF;&#x7A0B;&#x7684;&#x5B9E;&#x73B0;&#x76F8;&#x5173;&#xFF0C;&#x5C24;&#x5176;&#x662F;&#x5728;&#x9488;&#x5BF9;&#x7EBF;&#x7A0B;ID&#x4EE5;&#x53CA;&#x7EBF;&#x7A0B;&#x672C;&#x5730;&#x5B58;&#x50A8;&#x7684;&#x4F7F;&#x7528;&#x65B9;&#x9762;&#x3002;</p>
<h2 id="clone-&#x7684;flags&#x53C2;&#x6570;"><a href="#clone-&#x7684;flags&#x53C2;&#x6570;" class="headerlink" title="clone()&#x7684;flags&#x53C2;&#x6570;"></a>clone()&#x7684;flags&#x53C2;&#x6570;</h2><p>clone()&#x7684;flags&#x53C2;&#x6570;&#x662F;&#x5404;&#x79CD;&#x4F4D;&#x63A9;&#x7801;&#x7684;&#x7EC4;&#x5408;&#xFF08;&#x201C;&#x6216;&#x201D;&#x64CD;&#x4F5C;&#xFF09;&#xFF0C;&#x4E0B;&#x9762;&#x5C06;&#x5BF9;&#x5B83;&#x4EEC;&#x4E00;&#x4E00;&#x8BF4;&#x660E;&#x3002;<br>&#x5171;&#x4EAB;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x8868;&#xFF1A;CLONE_FILES<br>&#x5982;&#x679C;&#x6307;&#x5B9A;&#x4E86;CLONE_FILES&#x6807;&#x5FD7;&#xFF0C;&#x7236;&#x3001;&#x5B50;&#x8FDB;&#x7A0B;&#x4F1A;&#x5171;&#x4EAB;&#x540C;&#x4E00;&#x4E2A;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x8868;&#x3002;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x65E0;&#x8BBA;&#x54EA;&#x4E2A;&#x8FDB;&#x7A0B;&#x5BF9;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x7684;&#x5206;&#x914D;&#x548C;&#x91CA;&#x653E;&#xFF08;open()&#x3001;close()&#x3001;dup()&#x3001;pipe()&#x3001;socket()&#x7B49;&#xFF09;&#xFF0C;&#x90FD;&#x4F1A;&#x5F71;&#x54CD;&#x5230;&#x53E6;&#x4E00;&#x8FDB;&#x7A0B;&#x3002;&#x5982;&#x679C;&#x672A;&#x8BBE;&#x7F6E;CLONE_FILES&#xFF0C;&#x90A3;&#x4E48;&#x4E5F;&#x5C31;&#x4E0D;&#x4F1A;&#x5171;&#x4EAB;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x8868;&#xFF0C;&#x5B50;&#x8FDB;&#x7A0B;&#x83B7;&#x53D6;&#x7684;&#x662F;&#x7236;&#x8FDB;&#x7A0B;&#x8C03;&#x7528;clone()&#x65F6;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x8868;&#x7684;&#x4E00;&#x4EFD;&#x62F7;&#x8D1D;&#x3002;&#x8FD9;&#x4E9B;&#x63CF;&#x8FF0;&#x7B26;&#x526F;&#x672C;&#x4E0E;&#x5176;&#x7236;&#x8FDB;&#x7A0B;&#x4E2D;&#x7684;&#x76F8;&#x5E94;&#x63CF;&#x8FF0;&#x7B26;&#x5747;&#x6307;&#x5411;&#x76F8;&#x540C;&#x7684;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#xFF08;&#x548C;fork()&#x548C;vfork()&#x7684;&#x60C5;&#x51B5;&#x4E00;&#x6837;&#xFF09;&#x3002;</p>
<p>POSIX&#x7EBF;&#x7A0B;&#x89C4;&#x8303;&#x8981;&#x6C42;&#x8FDB;&#x7A0B;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x7EBF;&#x7A0B;&#x5171;&#x4EAB;&#x76F8;&#x540C;&#x7684;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x3002;</p>
<p>&#x5171;&#x4EAB;&#x4E0E;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x76F8;&#x5173;&#x7684;&#x4FE1;&#x606F;&#xFF1A;CLONE_FS<br>&#x5982;&#x679C;&#x6307;&#x5B9A;&#x4E86;CLONE_FS&#x6807;&#x5FD7;&#xFF0C;&#x90A3;&#x4E48;&#x7236;&#x3001;&#x5B50;&#x8FDB;&#x7A0B;&#x5C06;&#x5171;&#x4EAB;&#x4E0E;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x76F8;&#x5173;&#x7684;&#x4FE1;&#x606F;&#xFF08;file system- related information&#xFF09;&#xFF1A;&#x6743;&#x9650;&#x63A9;&#x7801;&#xFF08;umask&#xFF09;&#x3001;&#x6839;&#x76EE;&#x5F55;&#x4EE5;&#x53CA;&#x5F53;&#x524D;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;&#x3002;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x65E0;&#x8BBA;&#x5728;&#x54EA;&#x4E2A;&#x8FDB;&#x7A0B;&#x4E2D;&#x8C03;&#x7528;umask ()&#x3001;chdir()&#x6216;&#x8005;chroot()&#xFF0C;&#x90FD;&#x5C06;&#x5F71;&#x54CD;&#x5230;&#x53E6;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x3002;&#x5982;&#x679C;&#x672A;&#x8BBE;&#x7F6E;CLONE_FS&#xFF0C;&#x90A3;&#x4E48;&#x7236;&#x3001;&#x5B50;&#x8FDB;&#x7A0B;&#x5BF9;&#x6B64;&#x7C7B;&#x4FE1;&#x606F;&#x5219;&#x4F1A;&#x5404;&#x6301;&#x4E00;&#x4EFD;&#xFF08;&#x4E0E;fork()&#x548C;vfork()&#x7684;&#x60C5;&#x51B5;&#x76F8;&#x540C;&#xFF09;&#x3002;</p>
<p>POSIX&#x7EBF;&#x7A0B;&#x89C4;&#x8303;&#x8981;&#x6C42;&#x5B9E;&#x73B0;CLONE_FS&#x6807;&#x5FD7;&#x6240;&#x63D0;&#x4F9B;&#x7684;&#x5C5E;&#x6027;&#x5171;&#x4EAB;&#x3002;</p>
<p>&#x5171;&#x4EAB;&#x5BF9;&#x4FE1;&#x53F7;&#x7684;&#x5904;&#x7F6E;&#x8BBE;&#x7F6E;&#xFF1A;CLONE_SIGHAND<br>&#x5982;&#x679C;&#x8BBE;&#x7F6E;&#x4E86;CLONE_SIGHAND&#xFF0C;&#x90A3;&#x4E48;&#x7236;&#x3001;&#x5B50;&#x8FDB;&#x7A0B;&#x5C06;&#x5171;&#x4EAB;&#x540C;&#x4E00;&#x4E2A;&#x4FE1;&#x53F7;&#x5904;&#x7F6E;&#x8868;&#x3002;&#x65E0;&#x8BBA;&#x5728;&#x54EA;&#x4E2A;&#x8FDB;&#x7A0B;&#x4E2D;&#x8C03;&#x7528;sigaction()&#x6216;signal()&#x6765;&#x6539;&#x53D8;&#x5BF9;&#x4FE1;&#x53F7;&#x5904;&#x7F6E;&#x7684;&#x8BBE;&#x7F6E;&#xFF0C;&#x90FD;&#x4F1A;&#x5F71;&#x54CD;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x5BF9;&#x4FE1;&#x53F7;&#x7684;&#x5904;&#x7F6E;&#x3002;&#x82E5;&#x672A;&#x8BBE;&#x7F6E;CLONE_SIGHAND&#xFF0C;&#x5219;&#x4E0D;&#x5171;&#x4EAB;&#x5BF9;&#x4FE1;&#x53F7;&#x7684;&#x5904;&#x7F6E;&#x8BBE;&#x7F6E;&#xFF0C;&#x5B50;&#x8FDB;&#x7A0B;&#x53EA;&#x662F;&#x83B7;&#x53D6;&#x7236;&#x8FDB;&#x7A0B;&#x4FE1;&#x53F7;&#x5904;&#x7F6E;&#x8868;&#x7684;&#x4E00;&#x4EFD;&#x526F;&#x672C;&#xFF08;&#x5982;&#x540C;fork()&#x548C;vfork()&#xFF09;&#x3002;CLONE_SIGHAND&#x4E0D;&#x4F1A;&#x5F71;&#x54CD;&#x5230;&#x8FDB;&#x7A0B;&#x7684;&#x4FE1;&#x53F7;&#x63A9;&#x7801;&#x4EE5;&#x53CA;&#x5BF9;&#x6302;&#x8D77;&#xFF08;pending&#xFF09;&#x4FE1;&#x53F7;&#x7684;&#x8BBE;&#x7F6E;&#xFF0C;&#x7236;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x6B64;&#x7C7B;&#x8BBE;&#x7F6E;&#x662F;&#x7EDD;&#x4E0D;&#x76F8;&#x540C;&#x7684;&#x3002;&#x4ECE;Linux 2.6&#x5F00;&#x59CB;&#xFF0C;&#x5982;&#x679C;&#x8BBE;&#x7F6E;&#x4E86;CLONE_SIGHAND&#xFF0C;&#x5C31;&#x5FC5;&#x987B;&#x540C;&#x65F6;&#x8BBE;&#x7F6E;CLONE_VM&#x3002;</p>
<p>POSIX&#x7EBF;&#x7A0B;&#x89C4;&#x8303;&#x8981;&#x6C42;&#x5171;&#x4EAB;&#x5BF9;&#x4FE1;&#x53F7;&#x7684;&#x5904;&#x7F6E;&#x8BBE;&#x7F6E;&#x3002;</p>
<p>&#x5171;&#x4EAB;&#x7236;&#x8FDB;&#x7A0B;&#x7684;&#x865A;&#x62DF;&#x5185;&#x5B58;&#xFF1A;CLONE_VM<br>&#x5982;&#x679C;&#x8BBE;&#x7F6E;&#x4E86;CLONE_VM&#x6807;&#x5FD7;&#xFF0C;&#x7236;&#x3001;&#x5B50;&#x8FDB;&#x7A0B;&#x4F1A;&#x5171;&#x4EAB;&#x540C;&#x4E00;&#x4EFD;&#x865A;&#x62DF;&#x5185;&#x5B58;&#x9875;&#xFF08;&#x5982;&#x540C;vfork()&#xFF09;&#x3002;&#x65E0;&#x8BBA;&#x54EA;&#x4E2A;&#x8FDB;&#x7A0B;&#x66F4;&#x65B0;&#x4E86;&#x5185;&#x5B58;&#xFF0C;&#x6216;&#x662F;&#x8C03;&#x7528;&#x4E86;mmap()&#x3001;munmap()&#xFF0C;&#x53E6;&#x4E00;&#x8FDB;&#x7A0B;&#x540C;&#x6837;&#x4F1A;&#x89C2;&#x5BDF;&#x5230;&#x8FD9;&#x4E9B;&#x53D8;&#x5316;&#x3002;&#x5982;&#x679C;&#x672A;&#x8BBE;&#x7F6E;CLONE_VM&#xFF0C;&#x90A3;&#x4E48;&#x5B50;&#x8FDB;&#x7A0B;&#x5F97;&#x5230;&#x7684;&#x662F;&#x5BF9;&#x7236;&#x8FDB;&#x7A0B;&#x865A;&#x62DF;&#x5185;&#x5B58;&#x7684;&#x62F7;&#x8D1D;&#xFF08;&#x5982;&#x540C;fork()&#xFF09;&#x3002;</p>
<p>&#x5171;&#x4EAB;&#x540C;&#x4E00;&#x865A;&#x62DF;&#x5185;&#x5B58;&#x662F;&#x7EBF;&#x7A0B;&#x7684;&#x5173;&#x952E;&#x5C5E;&#x6027;&#x4E4B;&#x4E00;&#xFF0C;POSIX&#x7EBF;&#x7A0B;&#x6807;&#x51C6;&#x5BF9;&#x6B64;&#x4E5F;&#x6709;&#x8981;&#x6C42;&#x3002;</p>
<p>&#x7EBF;&#x7A0B;&#x7EC4;&#xFF1A;CLONE_THREAD<br>&#x82E5;&#x8BBE;&#x7F6E;&#x4E86;CLONE_THREAD&#xFF0C;&#x5219;&#x4F1A;&#x5C06;&#x5B50;&#x8FDB;&#x7A0B;&#x7F6E;&#x4E8E;&#x7236;&#x8FDB;&#x7A0B;&#x7684;&#x7EBF;&#x7A0B;&#x7EC4;&#x4E2D;&#x3002;&#x5982;&#x679C;&#x672A;&#x8BBE;&#x7F6E;&#x8BE5;&#x6807;&#x5FD7;&#xFF0C;&#x90A3;&#x4E48;&#x4F1A;&#x5C06;&#x5B50;&#x8FDB;&#x7A0B;&#x7F6E;&#x4E8E;&#x65B0;&#x7684;&#x7EBF;&#x7A0B;&#x7EC4;&#x4E2D;&#x3002;</p>
<p>POSIX&#x6807;&#x51C6;&#x89C4;&#x5B9A;&#xFF0C;&#x8FDB;&#x7A0B;&#x7684;&#x6240;&#x6709;&#x7EBF;&#x7A0B;&#x5171;&#x4EAB;&#x540C;&#x4E00;&#x8FDB;&#x7A0B;ID&#xFF08;&#x5373;&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x8C03;&#x7528;getpid()&#x90FD;&#x5E94;&#x8FD4;&#x56DE;&#x76F8;&#x540C;&#x503C;&#xFF09;&#xFF0C;Linux&#x4ECE;2.4&#x7248;&#x672C;&#x5F00;&#x59CB;&#x5F15;&#x5165;&#x4E86;&#x7EBF;&#x7A0B;&#x7EC4;&#xFF08;threads group&#xFF09;&#xFF0C;&#x4EE5;&#x6EE1;&#x8DB3;&#x8FD9;&#x4E00;&#x9700;&#x6C42;&#x3002;&#x5982;&#x56FE;28-1 &#x6240;&#x793A;&#xFF0C;&#x7EBF;&#x7A0B;&#x7EC4;&#x5C31;&#x662F;&#x5171;&#x4EAB;&#x540C;&#x4E00;&#x7EBF;&#x7A0B;&#x7EC4;&#x6807;&#x8BC6;&#xFF08;TGID&#xFF09;&#xFF08;thread group identifier&#xFF09;&#x7684;&#x4E00;&#x7EC4;KSE&#x3002;&#x5728;&#x5BF9;CLONE_THREAD&#x7684;&#x540E;&#x7EED;&#x8BA8;&#x8BBA;&#x4E2D;&#xFF0C;&#x4F1A;&#x5C06;KSE&#x89C6;&#x540C;&#x7EBF;&#x7A0B;&#x770B;&#x5F85;&#x3002;</p>
<p>&#x59CB;&#x4E8E;Linux2.4&#xFF0C;getpid()&#x6240;&#x8FD4;&#x56DE;&#x7684;&#x5C31;&#x662F;&#x8C03;&#x7528;&#x8005;&#x7684;TGID&#x3002;&#x6362;&#x8A00;&#x4E4B;&#xFF0C;TGID&#x548C;&#x8FDB;&#x7A0B;ID&#x662F;&#x4E00;&#x56DE;&#x4E8B;&#x3002;</p>
<p>&#x5728;2.2&#x4EE5;&#x53CA;&#x66F4;&#x65E9;&#x7684;Linux&#x7CFB;&#x7EDF;&#x4E2D;&#xFF0C;&#x5BF9;clone()&#x7684;&#x5B9E;&#x73B0;&#x5E76;&#x4E0D;&#x652F;&#x6301;CLONE_THREAD&#x3002;&#x76F8;&#x53CD;&#xFF0C;LinuxThreads&#x66FE;&#x5C06;POSIX&#x7EBF;&#x7A0B;&#x5B9E;&#x73B0;&#x4E3A;&#x5171;&#x4EAB;&#x4E86;&#x591A;&#x79CD;&#x5C5E;&#x6027;&#xFF08;&#x4F8B;&#x5982;&#xFF0C;&#x865A;&#x62DF;&#x5185;&#x5B58;&#xFF09;&#x3001;&#x8FDB;&#x7A0B;ID&#x53C8;&#x5404;&#x4E0D;&#x76F8;&#x540C;&#x7684;&#x8FDB;&#x7A0B;&#x3002;&#x8003;&#x8651;&#x5230;&#x517C;&#x5BB9;&#x6027;&#x56E0;&#x7D20;&#xFF0C;&#x5373;&#x4FBF;&#x662F;&#x5728;&#x5F53;&#x524D;&#x7684;Linux&#x5185;&#x6838;&#x4E2D;&#xFF0C;LinuxThreads&#x5B9E;&#x73B0;&#x4E5F;&#x672A;&#x63D0;&#x4F9B;CLONE_THREAD&#xFF0C;&#x56E0;&#x4E3A;&#x6309;&#x6B64;&#x65B9;&#x5F0F;&#x5B9E;&#x73B0;&#x7684;&#x7EBF;&#x7A0B;&#x5C31;&#x53EF;&#x4EE5;&#x7EE7;&#x7EED;&#x62E5;&#x6709;&#x4E0D;&#x540C;&#x7684;&#x8FDB;&#x7A0B;ID&#x3002;</p>
<p>&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x7EC4;&#x5185;&#x7684;&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x90FD;&#x62E5;&#x6709;&#x4E00;&#x4E2A;&#x552F;&#x4E00;&#x7684;&#x7EBF;&#x7A0B;&#x6807;&#x8BC6;&#x7B26;&#xFF08;thread identifier&#xFF0C;TID&#xFF09;&#xFF0C;&#x7528;&#x4EE5;&#x6807;&#x8BC6;&#x81EA;&#x8EAB;&#x3002;</p>
<p>Linux 2.4&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;gettid()&#xFF0C;&#x7EBF;&#x7A0B;&#x53EF;&#x901A;&#x8FC7;&#x8BE5;&#x8C03;&#x7528;&#x6765;&#x83B7;&#x53D6;&#x81EA;&#x5DF1;&#x7684;&#x7EBF;&#x7A0B;ID&#xFF08;&#x4E0E;&#x7EBF;&#x7A0B;&#x8C03;&#x7528;clone()&#x65F6;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x76F8;&#x540C;&#xFF09;&#x3002;&#x7EBF;&#x7A0B;ID&#x4E0E;&#x8FDB;&#x7A0B;ID&#x90FD;&#x4F7F;&#x7528;&#x76F8;&#x540C;&#x7684;&#x6570;&#x636E;&#x7C7B;&#x578B;pid_t&#x6765;&#x8868;&#x793A;&#x3002;&#x7EBF;&#x7A0B;ID&#x5728;&#x6574;&#x4E2A;&#x7CFB;&#x7EDF;&#x4E2D;&#x662F;&#x552F;&#x4E00;&#x7684;&#xFF0C;&#x4E14;&#x9664;&#x4E86;&#x7EBF;&#x7A0B;&#x62C5;&#x5F53;&#x8FDB;&#x7A0B;&#x4E2D;&#x7EBF;&#x7A0B;&#x7EC4;&#x9996;&#x7EBF;&#x7A0B;&#x7684;&#x60C5;&#x51B5;&#x4E4B;&#x5916;&#xFF0C;&#x5185;&#x6838;&#x80FD;&#x591F;&#x4FDD;&#x8BC1;&#x7CFB;&#x7EDF;&#x4E2D;&#x4E0D;&#x4F1A;&#x51FA;&#x73B0;&#x7EBF;&#x7A0B;ID&#x4E0E;&#x8FDB;&#x7A0B;ID&#x76F8;&#x540C;&#x7684;&#x60C5;&#x51B5;&#x3002;</p>
<p>&#x7EBF;&#x7A0B;&#x7EC4;&#x4E2D;&#x9996;&#x4E2A;&#x7EBF;&#x7A0B;&#x7684;&#x7EBF;&#x7A0B;ID&#x4E0E;&#x5176;&#x7EBF;&#x7A0B;&#x7EC4;ID&#x76F8;&#x540C;&#xFF0C;&#x4E5F;&#x5C06;&#x8BE5;&#x7EBF;&#x7A0B;&#x79F0;&#x4E4B;&#x4E3A;&#x7EBF;&#x7A0B;&#x7EC4;&#x9996;&#x7EBF;&#x7A0B;&#xFF08;thread group leader&#xFF09;&#x3002;</p>
<p>&#x7EBF;&#x7A0B;&#x7EC4;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x7EBF;&#x7A0B;&#x62E5;&#x6709;&#x540C;&#x4E00;&#x7236;&#x8FDB;&#x7A0B;ID&#xFF0C;&#x5373;&#x4E0E;&#x7EBF;&#x7A0B;&#x7EC4;&#x9996;&#x7EBF;&#x7A0B;ID&#x76F8;&#x540C;&#x3002;&#x4EC5;&#x5F53;&#x7EBF;&#x7A0B;&#x7EC4;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x7EBF;&#x7A0B;&#x90FD;&#x7EC8;&#x6B62;&#x540E;&#xFF0C;&#x5176;&#x7236;&#x8FDB;&#x7A0B;&#x624D;&#x4F1A;&#x6536;&#x5230;SIGCHLD&#x4FE1;&#x53F7;&#xFF08;&#x6216;&#x5176;&#x4ED6;&#x7EC8;&#x6B62;&#x4FE1;&#x53F7;&#xFF09;&#x3002;&#x8FD9;&#x4E9B;&#x884C;&#x4E3A;&#x7B26;&#x5408;POSIX&#x7EBF;&#x7A0B;&#x89C4;&#x8303;&#x7684;&#x8981;&#x6C42;&#x3002;</p>
<p>&#x5F53;&#x4E00;&#x4E2A;&#x8BBE;&#x7F6E;&#x4E86;CLONE_THREAD&#x7684;&#x7EBF;&#x7A0B;&#x7EC8;&#x6B62;&#x65F6;&#xFF0C;&#x5E76;&#x6CA1;&#x6709;&#x4FE1;&#x53F7;&#x4F1A;&#x53D1;&#x9001;&#x7ED9;&#x8BE5;&#x7EBF;&#x7A0B;&#x7684;&#x521B;&#x5EFA;&#x8005;&#xFF08;&#x5373;&#x8C03;&#x7528;clone()&#x521B;&#x5EFA;&#x7EC8;&#x6B62;&#x7EBF;&#x7A0B;&#x7684;&#x7EBF;&#x7A0B;&#xFF09;&#x3002;&#x76F8;&#x5E94;&#x7684;&#xFF0C;&#x4E5F;&#x4E0D;&#x53EF;&#x80FD;&#x8C03;&#x7528; wait()&#xFF08;&#x6216;&#x7C7B;&#x4F3C;&#x51FD;&#x6570;&#xFF09;&#x6765;&#x7B49;&#x5F85;&#x4E00;&#x4E2A;&#x4EE5; CLONE_THREAD&#x6807;&#x5FD7;&#x521B;&#x5EFA;&#x7684;&#x7EBF;&#x7A0B;&#x3002;&#x8FD9;&#x4E0E;POSIX&#x7684;&#x8981;&#x6C42;&#x4E00;&#x81F4;&#x3002;POSIX&#x7EBF;&#x7A0B;&#x4E0E;&#x8FDB;&#x7A0B;&#x4E0D;&#x540C;&#xFF0C;&#x4E0D;&#x80FD;&#x4F7F;&#x7528;wait()&#x7B49;&#x5F85;&#xFF0C;&#x76F8;&#x53CD;&#xFF0C;&#x5FC5;&#x987B;&#x8C03;&#x7528;pthread_join()&#x6765;&#x52A0;&#x5165;&#x3002;&#x4E3A;&#x68C0;&#x6D4B;&#x4EE5;CLONE_THREAD&#x6807;&#x5FD7;&#x521B;&#x5EFA;&#x7684;&#x7EBF;&#x7A0B;&#x662F;&#x5426;&#x7EC8;&#x6B62;&#xFF0C;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x4E00;&#x79CD;&#x7279;&#x6B8A;&#x7684;&#x540C;&#x6B65;&#x539F;&#x8BED;&#x2014;&#x2014;futex&#xFF08;&#x53C2;&#x8003;&#x4E0B;&#x6587;&#x5BF9;CLONE_PARENT_SETTID&#x6807;&#x5FD7;&#x7684;&#x8BA8;&#x8BBA;&#xFF09;&#x3002;</p>
<p>&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x7EC4;&#x4E2D;&#x7684;&#x4EFB;&#x4E00;&#x7EBF;&#x7A0B;&#x8C03;&#x7528;&#x4E86;exec()&#xFF0C;&#x90A3;&#x4E48;&#x9664;&#x4E86;&#x9996;&#x7EBF;&#x7A0B;&#x4E4B;&#x5916;&#x7684;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x90FD;&#x4F1A;&#x7EC8;&#x6B62;&#xFF08;&#x8FD9;&#x4E00;&#x884C;&#x4E3A;&#x4E5F;&#x7B26;&#x5408; POSIX &#x7EBF;&#x7A0B;&#x89C4;&#x8303;&#x7684;&#x8981;&#x6C42;&#xFF09;&#xFF0C;&#x65B0;&#x8FDB;&#x7A0B;&#x5C06;&#x5728;&#x9996;&#x7EBF;&#x7A0B;&#x4E2D;&#x6267;&#x884C;&#x3002;&#x6362;&#x8A00;&#x4E4B;&#xFF0C;&#x65B0;&#x7A0B;&#x5E8F;&#x4E2D;&#x7684; gettid()&#x8C03;&#x7528;&#x5C06;&#x4F1A;&#x8FD4;&#x56DE;&#x9996;&#x7EBF;&#x7A0B;&#x7684;&#x7EBF;&#x7A0B;ID&#x3002;&#x8C03;&#x7528;exec()&#x671F;&#x95F4;&#xFF0C;&#x4F1A;&#x5C06;&#x8BE5;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;&#x7ED9;&#x5176;&#x7236;&#x8FDB;&#x7A0B;&#x7684;&#x7EC8;&#x6B62;&#x4FE1;&#x53F7;&#x91CD;&#x7F6E;&#x4E3A;SIGCHLD&#x3002;</p>
<p>&#x5982;&#x679C;&#x7EBF;&#x7A0B;&#x7EC4;&#x4E2D;&#x7684;&#x67D0;&#x4E2A;&#x7EBF;&#x7A0B;&#x8C03;&#x7528;fork()&#x6216;vfork()&#x521B;&#x5EFA;&#x4E86;&#x5B50;&#x8FDB;&#x7A0B;&#xFF0C;&#x90A3;&#x4E48;&#x7EC4;&#x4E2D;&#x7684;&#x4EFB;&#x4F55;&#x7EBF;&#x7A0B;&#x90FD;&#x53EF;&#x4F7F;&#x7528;wait()&#x6216;&#x7C7B;&#x4F3C;&#x51FD;&#x6570;&#x6765;&#x76D1;&#x63A7;&#x8BE5;&#x5B50;&#x8FDB;&#x7A0B;&#x3002;</p>
<p>&#x4ECE;Linux2.6&#x5F00;&#x59CB;&#xFF0C;&#x5982;&#x679C;&#x8BBE;&#x7F6E;&#x4E86;CLONE_THREAD&#xFF0C;&#x540C;&#x65F6;&#x4E5F;&#x5FC5;&#x987B;&#x8BBE;&#x7F6E;CLONE_SIGHAND&#x3002;&#x8FD9;&#x4E5F;&#x4E0E;POSIX&#x7EBF;&#x7A0B;&#x6807;&#x51C6;&#x7684;&#x6DF1;&#x5165;&#x8981;&#x6C42;&#x76F8;&#x5951;&#x5408;&#xFF0C;&#x8BE6;&#x7EC6;&#x5185;&#x5BB9;&#x53EF;&#x53C2;&#x8003;33.2&#x8282;&#x5173;&#x4E8E;POSIX&#x7EBF;&#x7A0B;&#x4E0E;&#x4FE1;&#x53F7;&#x4EA4;&#x4E92;&#x7684;&#x76F8;&#x5173;&#x8BA8;&#x8BBA;&#x3002;&#xFF08;&#x5185;&#x6838;&#x9488;&#x5BF9;CLONE_THREAD&#x7EBF;&#x7A0B;&#x7EC4;&#x7684;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5BF9;&#x5E94;&#x4E8E;POSIX&#x6807;&#x51C6;&#x5BF9;&#x8FDB;&#x7A0B;&#x4E2D;&#x7EBF;&#x7A0B;&#x5982;&#x4F55;&#x5904;&#x7406;&#x4FE1;&#x53F7;&#x7684;&#x89C4;&#x8303;&#x3002;&#xFF09;</p>
<p>&#x7EBF;&#x7A0B;&#x5E93;&#x652F;&#x6301;&#xFF1A;CLONE_PARENT_SETTID&#x3001;CLONE_CHILD_SETTID&#x548C;CLONE_CHILD_CLEARTID<br>&#x4E3A;&#x5B9E;&#x73B0;POSIX&#x7EBF;&#x7A0B;&#xFF0C;Linux 2.6&#x63D0;&#x4F9B;&#x4E86;&#x5BF9;CLONE_PARENT_SETTID&#x3001;CLONE_CHILD_SETTID&#x548C;CLONE_CHILD_CLEARTID&#x7684;&#x652F;&#x6301;&#x3002;&#x8FD9;&#x4E9B;&#x6807;&#x5FD7;&#x4F1A;&#x5F71;&#x54CD;clone()&#x5BF9;&#x53C2;&#x6570;ptid&#x548C;ctid&#x7684;&#x5904;&#x7406;&#x3002;NPTL&#x7684;&#x7EBF;&#x7A0B;&#x5B9E;&#x73B0;&#x4F7F;&#x7528;&#x4E86;CLONE_CHILD_SETTID&#x548C;CLONE_CHILD_CLEARTID&#x3002;</p>
<p>&#x5982;&#x679C;&#x8BBE;&#x7F6E;&#x4E86;CLONE_PARENT_SETTID&#xFF0C;&#x5185;&#x6838;&#x4F1A;&#x5C06;&#x5B50;&#x7EBF;&#x7A0B;&#x7684;&#x7EBF;&#x7A0B;ID&#x5199;&#x5165;ptid&#x6240;&#x6307;&#x5411;&#x7684;&#x4F4D;&#x7F6E;&#x3002;&#x5728;&#x5BF9;&#x7236;&#x8FDB;&#x7A0B;&#x7684;&#x5185;&#x5B58;&#x8FDB;&#x884C;&#x590D;&#x5236;&#x4E4B;&#x524D;&#xFF0C;&#x4F1A;&#x5C06;&#x7EBF;&#x7A0B;ID&#x590D;&#x5236;&#x5230;ptid&#x6240;&#x6307;&#x4F4D;&#x7F6E;&#x3002;&#x8FD9;&#x4E5F;&#x610F;&#x5473;&#x7740;&#xFF0C;&#x5373;&#x4F7F;&#x6CA1;&#x6709;&#x8BBE;&#x7F6E;CLONE_VM&#xFF0C;&#x7236;&#x3001;&#x5B50;&#x8FDB;&#x7A0B;&#x5747;&#x80FD;&#x5728;&#x6B64;&#x4F4D;&#x7F6E;&#x83B7;&#x5F97;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x7EBF;&#x7A0B;ID&#x3002;&#xFF08;&#x5982;&#x4E0A;&#x6240;&#x8FF0;&#xFF0C;&#x521B;&#x5EFA;POSIX&#x7EBF;&#x7A0B;&#x65F6;&#x603B;&#x662F;&#x6307;&#x5B9A;&#x4E86;CLONE_VM&#x6807;&#x5FD7;&#x3002;&#xFF09;</p>
<p>CLONE_PARENT_SETTID&#x4E4B;&#x6240;&#x4EE5;&#x5B58;&#x5728;&#xFF0C;&#x610F;&#x5728;&#x4E3A;&#x7EBF;&#x7A0B;&#x5B9E;&#x73B0;&#x83B7;&#x53D6;&#x65B0;&#x7EBF;&#x7A0B;ID&#x63D0;&#x4F9B;&#x4E00;&#x79CD;&#x53EF;&#x9760;&#x7684;&#x624B;&#x6BB5;&#x3002;&#x6CE8;&#x610F;&#xFF0C;&#x901A;&#x8FC7;clone()&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x5E76;&#x4E0D;&#x8DB3;&#x4EE5;&#x83B7;&#x53D6;&#x65B0;&#x7EBF;&#x7A0B;&#x7684;&#x7EBF;&#x7A0B;ID&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c">tid<span class="token operator">=</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>&#x95EE;&#x9898;&#x5728;&#x4E8E;&#xFF0C;&#x56E0;&#x4E3A;&#x8D4B;&#x503C;&#x64CD;&#x4F5C;&#x53EA;&#x80FD;&#x5728;clone()&#x8FD4;&#x56DE;&#x540E;&#x624D;&#x4F1A;&#x53D1;&#x751F;&#xFF0C;&#x6240;&#x4EE5;&#x4EE5;&#x4E0A;&#x4EE3;&#x7801;&#x4F1A;&#x5BFC;&#x81F4;&#x5404;&#x79CD;&#x7ADE;&#x4E89;&#x6761;&#x4EF6;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x5047;&#x8BBE;&#x65B0;&#x7EBF;&#x7A0B;&#x7EC8;&#x6B62;&#xFF0C;&#x800C;&#x5728;&#x5B8C;&#x6210;&#x5BF9;tid&#x7684;&#x8D4B;&#x503C;&#x524D;&#x5C31;&#x8C03;&#x7528;&#x4E86;&#x7EC8;&#x6B62;&#x4FE1;&#x53F7;&#x7684;&#x5904;&#x7406;&#x5668;&#x7A0B;&#x5E8F;&#x3002;&#x6B64;&#x65F6;&#xFF0C;&#x5904;&#x7406;&#x5668;&#x7A0B;&#x5E8F;&#x65E0;&#x6CD5;&#x6709;&#x6548;&#x8BBF;&#x95EE;tid&#x3002;&#xFF08;&#x5728;&#x7EBF;&#x7A0B;&#x5E93;&#x5185;&#x90E8;&#xFF0C;&#x53EF;&#x80FD;&#x4F1A;&#x5C06;tid&#x7F6E;&#x4E8E;&#x4E00;&#x4E2A;&#x7528;&#x4EE5;&#x8DDF;&#x8E2A;&#x6240;&#x6709;&#x7EBF;&#x7A0B;&#x72B6;&#x6001;&#x7684;&#x5168;&#x5C40;&#x7ED3;&#x6784;&#x4E2D;&#x3002;&#xFF09;&#x7A0B;&#x5E8F;&#x901A;&#x5E38;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x76F4;&#x63A5;&#x8C03;&#x7528;clone()&#x6765;&#x89C4;&#x907F;&#x8FD9;&#x79CD;&#x7ADE;&#x4E89;&#x6761;&#x4EF6;&#x3002;&#x4E0D;&#x8FC7;&#xFF0C;&#x7EBF;&#x7A0B;&#x5E93;&#x65E0;&#x6CD5;&#x63A7;&#x5236;&#x5176;&#x8C03;&#x7528;&#x8005;&#x7A0B;&#x5E8F;&#x7684;&#x884C;&#x4E3A;&#x3002;&#x4F7F;&#x7528;CLONE_PARENT_SETTID&#x53EF;&#x4EE5;&#x4FDD;&#x8BC1;&#x5728;clone()&#x8FD4;&#x56DE;&#x4E4B;&#x524D;&#x5C31;&#x5C06;&#x65B0;&#x7EBF;&#x7A0B;&#x7684;ID&#x8D4B;&#x503C;&#x7ED9;ptid&#x6307;&#x9488;&#xFF0C;&#x4ECE;&#x800C;&#x4F7F;&#x7EBF;&#x7A0B;&#x5E93;&#x907F;&#x514D;&#x4E86;&#x8FD9;&#x79CD;&#x7ADE;&#x4E89;&#x6761;&#x4EF6;&#x3002;</p>
<p>&#x5982;&#x679C;&#x8BBE;&#x7F6E;&#x4E86;CLONE_CHILD_SETTID&#xFF0C;&#x90A3;&#x4E48;clone()&#x4F1A;&#x5C06;&#x5B50;&#x7EBF;&#x7A0B;&#x7684;&#x7EBF;&#x7A0B;ID&#x5199;&#x5165;&#x6307;&#x9488;ctid&#x6240;&#x6307;&#x5411;&#x7684;&#x4F4D;&#x7F6E;&#x3002;&#x5BF9;ctid&#x7684;&#x8BBE;&#x7F6E;&#x53EA;&#x4F1A;&#x53D1;&#x751F;&#x5728;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x5185;&#x5B58;&#x4E2D;&#xFF0C;&#x4E0D;&#x8FC7;&#x5982;&#x679C;&#x8BBE;&#x7F6E;&#x4E86;CLONE_VM&#xFF0C;&#x8FD8;&#x662F;&#x4F1A;&#x5F71;&#x54CD;&#x5230;&#x7236;&#x8FDB;&#x7A0B;&#x3002;&#x867D;&#x7136;NPTL&#x5E76;&#x4E0D;&#x9700;&#x8981;CLONE_CHILD_SETTID&#xFF0C;&#x4F46;&#x8FD9;&#x4E00;&#x6807;&#x8BC6;&#x8FD8;&#x662F;&#x80FD;&#x7ED9;&#x5176;&#x4ED6;&#x7684;&#x7EBF;&#x7A0B;&#x5E93;&#x5B9E;&#x73B0;&#x5E26;&#x6765;&#x7075;&#x6D3B;&#x6027;&#x3002;</p>
<p>&#x5982;&#x679C;&#x8BBE;&#x7F6E;&#x4E86;CLONE_CHILD_CLEARTID&#x6807;&#x5FD7;&#xFF0C;&#x90A3;&#x4E48;clone()&#x4F1A;&#x5728;&#x5B50;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#x65F6;&#x5C06;ctid&#x6240;&#x6307;&#x5411;&#x7684;&#x5185;&#x5B58;&#x5185;&#x5BB9;&#x6E05;&#x96F6;&#x3002;</p>
<p>&#x501F;&#x52A9;&#x4E8E;&#x53C2;&#x6570;ctid&#x6240;&#x63D0;&#x4F9B;&#x7684;&#x673A;&#x5236;&#xFF08;&#x7A0D;&#x540E;&#x63CF;&#x8FF0;&#xFF09;&#xFF0C;NPTL&#x7EBF;&#x7A0B;&#x5B9E;&#x73B0;&#x53EF;&#x4EE5;&#x83B7;&#x5F97;&#x7EBF;&#x7A0B;&#x7EC8;&#x6B62;&#x7684;&#x901A;&#x77E5;&#x3002;&#x51FD;&#x6570;pthread_join()&#x6B63;&#x9700;&#x8981;&#x8FD9;&#x6837;&#x7684;&#x901A;&#x77E5;&#xFF0C;POSIX&#x7EBF;&#x7A0B;&#x5229;&#x7528;&#x8BE5;&#x51FD;&#x6570;&#x6765;&#x7B49;&#x5F85;&#x53E6;&#x4E00;&#x7EBF;&#x7A0B;&#x7684;&#x7EC8;&#x6B62;&#x3002;</p>
<p>&#x4F7F;&#x7528;pthread_create()&#x521B;&#x5EFA;&#x7EBF;&#x7A0B;&#x65F6;&#xFF0C;NPTL&#x4F1A;&#x8C03;&#x7528;clone()&#xFF0C;&#x5176;ptid&#x548C;ctid&#x5747;&#x6307;&#x5411;&#x540C;&#x4E00;&#x4F4D;&#x7F6E;&#x3002;&#xFF08;&#x8FD9;&#x6B63;&#x662F;NPTL&#x4E0D;&#x9700;&#x8981;CLONE_CHILD_SETTID&#x7684;&#x539F;&#x56E0;&#x6240;&#x5728;&#x3002;&#xFF09;&#x8BBE;&#x7F6E;&#x4E86;CLONE_PARENT_SETTID&#x6807;&#x5FD7;&#xFF0C;&#x5C31;&#x4F1A;&#x4EE5;&#x65B0;&#x7684;&#x7EBF;&#x7A0B;ID&#x5BF9;&#x8BE5;&#x4F4D;&#x7F6E;&#x8FDB;&#x884C;&#x521D;&#x59CB;&#x5316;&#x3002;&#x5F53;&#x5B50;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#xFF0C;ctid&#x906D;&#x6E05;&#x9664;&#x65F6;&#xFF0C;&#x8FDB;&#x7A0B;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x7EBF;&#x7A0B;&#x90FD;&#x4F1A;&#x76EE;&#x7779;&#x8FD9;&#x4E00;&#x53D8;&#x5316;&#xFF08;&#x56E0;&#x4E3A;&#x8BBE;&#x7F6E;&#x4E86;CLONE_VM&#xFF09;&#x3002;</p>
<p>&#x5185;&#x6838;&#x5C06;ctid&#x6307;&#x5411;&#x7684;&#x4F4D;&#x7F6E;&#x89C6;&#x540C;futex&#x2014;&#x2014;&#x4E00;&#x79CD;&#x6709;&#x6548;&#x7684;&#x540C;&#x6B65;&#x673A;&#x5236;&#x6765;&#x5904;&#x7406;&#x3002;&#xFF08;&#x5173;&#x4E8E;futex&#x7684;&#x66F4;&#x591A;&#x5185;&#x5BB9;&#x8BF7;&#x53C2;&#x8003;futex(2)&#x624B;&#x518C;&#x9875;&#x3002;&#xFF09;&#x6267;&#x884C;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;futex()&#x6765;&#x76D1;&#x6D4B;ctid&#x6240;&#x6307;&#x4F4D;&#x7F6E;&#x7684;&#x5185;&#x5BB9;&#x53D8;&#x5316;&#xFF0C;&#x5C31;&#x53EF;&#x83B7;&#x5F97;&#x7EBF;&#x7A0B;&#x7EC8;&#x6B62;&#x7684;&#x901A;&#x77E5;&#x3002;&#xFF08;&#x8FD9;&#x6B63;&#x662F;pthread_join()&#x6240;&#x505A;&#x7684;&#x5E55;&#x540E;&#x5DE5;&#x4F5C;&#x3002;&#xFF09;&#x5185;&#x6838;&#x5728;&#x6E05;&#x9664;ctid&#x7684;&#x540C;&#x65F6;&#xFF0C;&#x4E5F;&#x4F1A;&#x5524;&#x9192;&#x90A3;&#x4E9B;&#x8C03;&#x7528;&#x4E86;futex()&#x6765;&#x76D1;&#x63A7;&#x8BE5;&#x5730;&#x5740;&#x5185;&#x5BB9;&#x53D8;&#x5316;&#x7684;&#x4EFB;&#x4E00;&#x5185;&#x6838;&#x8C03;&#x5EA6;&#x5B9E;&#x4F53;&#xFF08;&#x5373;&#x7EBF;&#x7A0B;&#xFF09;&#x3002;&#xFF08;&#x5728;POSIX&#x7EBF;&#x7A0B;&#x7684;&#x5C42;&#x9762;&#x4E0A;&#xFF0C;&#x8FD9;&#x4F1A;&#x5BFC;&#x81F4;pthread_join()&#x8C03;&#x7528;&#x53BB;&#x89E3;&#x9664;&#x963B;&#x585E;&#x3002;&#xFF09;</p>
<p>&#x7EBF;&#x7A0B;&#x672C;&#x5730;&#x5B58;&#x50A8;&#xFF1A;CLONE_SETTLS<br>&#x5982;&#x679C;&#x8BBE;&#x7F6E;&#x4E86;CLONE_SETTLS&#xFF0C;&#x90A3;&#x4E48;&#x53C2;&#x6570;tls&#x6240;&#x6307;&#x5411;&#x7684;user_desc&#x7ED3;&#x6784;&#x4F1A;&#x5BF9;&#x8BE5;&#x7EBF;&#x7A0B;&#x6240;&#x4F7F;&#x7528;&#x7684;&#x7EBF;&#x7A0B;&#x672C;&#x5730;&#x5B58;&#x50A8;&#x7F13;&#x51B2;&#x533A;&#x52A0;&#x4EE5;&#x63CF;&#x8FF0;&#x3002;&#x4E3A;&#x4E86;&#x652F;&#x6301;NPTL&#x5BF9;&#x7EBF;&#x7A0B;&#x672C;&#x5730;&#x5B58;&#x50A8;&#x7684;&#x5B9E;&#x73B0;&#xFF0C;Linux 2.6&#x5F00;&#x59CB;&#x52A0;&#x5165;&#x8FD9;&#x4E00;&#x6807;&#x5FD7;&#xFF08;31.4&#x8282;&#xFF09;&#x3002;&#x5173;&#x4E8E;user_desc&#x7ED3;&#x6784;&#x7684;&#x8BE6;&#x60C5;&#xFF0C;&#x53EF;&#x53C2;&#x8003;2.6&#x5185;&#x6838;&#x4EE3;&#x7801;&#x4E2D;&#x5BF9;&#x8BE5;&#x7ED3;&#x6784;&#x7684;&#x5B9A;&#x4E49;&#x548C;&#x4F7F;&#x7528;&#xFF0C;&#x4EE5;&#x53CA;set_thread_area(2)&#x624B;&#x518C;&#x9875;&#x3002;</p>
<p>&#x5171;&#x4EAB;System V&#x4FE1;&#x53F7;&#x91CF;&#x7684;&#x64A4;&#x9500;&#x503C;&#xFF1A;CLONE_SYSVSEM<br>&#x5982;&#x679C;&#x8BBE;&#x7F6E;&#x4E86;CLONE_SYSVSEM&#xFF0C;&#x7236;&#x3001;&#x5B50;&#x8FDB;&#x7A0B;&#x5C06;&#x5171;&#x4EAB;&#x540C;&#x4E00;&#x4E2A;System V&#x4FE1;&#x53F7;&#x91CF;&#x64A4;&#x9500;&#x503C;&#x5217;&#x8868;&#xFF08;47.8&#x8282;&#xFF09;&#x3002;&#x5982;&#x679C;&#x672A;&#x8BBE;&#x7F6E;&#x8BE5;&#x6807;&#x5FD7;&#xFF0C;&#x7236;&#x3001;&#x5B50;&#x8FDB;&#x7A0B;&#x5404;&#x81EA;&#x6301;&#x6709;&#x53D6;&#x6D88;&#x5217;&#x8868;&#xFF0C;&#x4E14;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x5217;&#x8868;&#x521D;&#x59CB;&#x4E3A;&#x7A7A;&#x3002;</p>
<p>&#x6BCF;&#x8FDB;&#x7A0B;&#x6302;&#x8F7D;&#x547D;&#x540D;&#x7A7A;&#x95F4;&#xFF1A;CLONE_NEWNS<br>Linux&#x4ECE;&#x5185;&#x6838;2.4.19&#x5F00;&#x59CB;&#x652F;&#x6301;&#x6BCF;&#x8FDB;&#x7A0B;&#x6302;&#x8F7D;&#xFF08;mount&#xFF09;&#x547D;&#x540D;&#x7A7A;&#x95F4;&#x7684;&#x6982;&#x5FF5;&#x3002;&#x6302;&#x8F7D;&#x547D;&#x540D;&#x7A7A;&#x95F4;&#x662F;&#x7531;&#x5BF9;mount()&#x548C;umount()&#x7684;&#x8C03;&#x7528;&#x6765;&#x7EF4;&#x62A4;&#x7684;&#x4E00;&#x7EC4;&#x6302;&#x8F7D;&#x70B9;&#x3002;&#x6302;&#x8F7D;&#x547D;&#x540D;&#x7A7A;&#x95F4;&#x4F1A;&#x5F71;&#x54CD;&#x5C06;&#x8DEF;&#x5F84;&#x540D;&#x89E3;&#x6790;&#x4E3A;&#x771F;&#x5B9E;&#x6587;&#x4EF6;&#x7684;&#x8FC7;&#x7A0B;&#xFF0C;&#x4E5F;&#x4F1A;&#x6CE2;&#x53CA;&#x8BF8;&#x5982;chdir()&#x548C;chroot()&#x4E4B;&#x7C7B;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x3002;</p>
<p>&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x7236;&#x3001;&#x5B50;&#x8FDB;&#x7A0B;&#x5171;&#x4EAB;&#x540C;&#x4E00;&#x6302;&#x8F7D;&#x547D;&#x540D;&#x7A7A;&#x95F4;&#xFF0C;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x8C03;&#x7528;mount()&#x6216;umount()&#x5BF9;&#x547D;&#x540D;&#x7A7A;&#x95F4;&#x6240;&#x505A;&#x7684;&#x6539;&#x53D8;&#xFF0C;&#x4E5F;&#x4F1A;&#x4E3A;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x6240;&#x89C1;&#xFF08;&#x5982;&#x540C;fork()&#x548C;vfork()&#xFF09;&#x3002;&#x7279;&#x6743;&#x7EA7;&#xFF08;CAP_SYS_ADMIN&#xFF09;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x6307;&#x5B9A;CONE_NEWNS&#x6807;&#x5FD7;&#xFF0C;&#x4EE5;&#x4FBF;&#x5B50;&#x8FDB;&#x7A0B;&#x53BB;&#x83B7;&#x53D6;&#x5BF9;&#x7236;&#x8FDB;&#x7A0B;&#x6302;&#x8F7D;&#x547D;&#x540D;&#x7A7A;&#x95F4;&#x7684;&#x4E00;&#x4EFD;&#x62F7;&#x8D1D;&#x3002;&#x8FD9;&#x6837;&#x4E00;&#x6765;&#xFF0C;&#x8FDB;&#x7A0B;&#x5BF9;&#x547D;&#x540D;&#x7A7A;&#x95F4;&#x7684;&#x4FEE;&#x6539;&#x5C31;&#x4E0D;&#x4F1A;&#x4E3A;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x6240;&#x89C1;&#x3002;&#xFF08;&#x65E9;&#x671F;&#x7684;2.4.x&#x5185;&#x6838;&#x4EE5;&#x53CA;&#x66F4;&#x8001;&#x7684;&#x7248;&#x672C;&#x8BA4;&#x4E3A;&#xFF0C;&#x7CFB;&#x7EDF;&#x7684;&#x6240;&#x6709;&#x8FDB;&#x7A0B;&#x5171;&#x4EAB;&#x540C;&#x4E00;&#x4E2A;&#x7CFB;&#x7EDF;&#x7EA7;&#x6302;&#x8F7D;&#x547D;&#x540D;&#x7A7A;&#x95F4;&#x3002;&#xFF09;</p>
<p>&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x6BCF;&#x8FDB;&#x7A0B;&#x6302;&#x8F7D;&#x547D;&#x540D;&#x7A7A;&#x95F4;&#x6765;&#x521B;&#x5EFA;&#x7C7B;&#x4F3C;&#x4E8E;chroot()&#x76D1;&#x7981;&#x533A;&#xFF08;jail&#xFF09;&#x7684;&#x73AF;&#x5883;&#xFF0C;&#x800C;&#x4E14;&#x66F4;&#x52A0;&#x5B89;&#x5168;&#x3001;&#x7075;&#x6D3B;&#xFF0C;&#x4F8B;&#x5982;&#xFF0C;&#x53EF;&#x4EE5;&#x5411;&#x906D;&#x5230;&#x76D1;&#x7981;&#x7684;&#x8FDB;&#x7A0B;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;&#x6302;&#x8F7D;&#x70B9;&#xFF0C;&#x800C;&#x8BE5;&#x70B9;&#x5BF9;&#x4E8E;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x662F;&#x4E0D;&#x53EF;&#x89C1;&#x7684;&#x3002;&#x8BBE;&#x7F6E;&#x865A;&#x62DF;&#x670D;&#x52A1;&#x5668;&#x73AF;&#x5883;&#x65F6;&#x4E5F;&#x4F1A;&#x7528;&#x5230;&#x6302;&#x8F7D;&#x547D;&#x540D;&#x7A7A;&#x95F4;&#x3002;</p>
<p>&#x5728;&#x540C;&#x4E00;clone()&#x8C03;&#x7528;&#x4E2D;&#x540C;&#x65F6;&#x6307;&#x5B9A;CLONE_NEWNS&#x548C;CLONE_FS&#x7EAF;&#x5C5E;&#x65E0;&#x804A;&#xFF0C;&#x4E5F;&#x4E0D;&#x5141;&#x8BB8;&#x8FD9;&#x6837;&#x505A;&#x3002;</p>
<p>&#x5C06;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x7236;&#x8FDB;&#x7A0B;&#x7F6E;&#x4E3A;&#x8C03;&#x7528;&#x8005;&#x7684;&#x7236;&#x8FDB;&#x7A0B;&#xFF1A;CLONE_PARENT<br>&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5F53;&#x8C03;&#x7528;clone()&#x521B;&#x5EFA;&#x65B0;&#x8FDB;&#x7A0B;&#x65F6;&#xFF0C;&#x65B0;&#x8FDB;&#x7A0B;&#x7684;&#x7236;&#x8FDB;&#x7A0B;&#xFF08;&#x7531;getppid()&#x8FD4;&#x56DE;&#xFF09;&#x5C31;&#x662F;&#x8C03;&#x7528;clone()&#x7684;&#x8FDB;&#x7A0B;&#xFF08;&#x540C;fork()&#x548C;vfork()&#xFF09;&#x3002;&#x5982;&#x679C;&#x8BBE;&#x7F6E;&#x4E86;CLONE_PARENT&#xFF0C;&#x90A3;&#x4E48;&#x8C03;&#x7528;&#x8005;&#x7684;&#x7236;&#x8FDB;&#x7A0B;&#x5C31;&#x6210;&#x4E3A;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x7236;&#x8FDB;&#x7A0B;&#x3002;&#x6362;&#x8A00;&#x4E4B;&#xFF0C;CLONE_PARENT&#x7B49;&#x540C;&#x4E8E;&#x8FD9;&#x6837;&#x7684;&#x8BBE;&#x7F6E;&#xFF1A;&#x5B50;&#x8FDB;&#x7A0B;.PPID = &#x8C03;&#x7528;&#x8005;.PPID&#x3002;&#xFF08;&#x672A;&#x8BBE;&#x7F6E;CLONE_PARENT&#x7684;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x662F;&#xFF1A;&#x5B50;&#x8FDB;&#x7A0B;.PPID = &#x8C03;&#x7528;&#x8005;.PID&#x3002;&#xFF09;&#x5B50;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#x65F6;&#x4F1A;&#x5411;&#x7236;&#x8FDB;&#x7A0B;&#xFF08;&#x5B50;&#x8FDB;&#x7A0B;.PPID&#xFF09;&#x53D1;&#x51FA;&#x4FE1;&#x53F7;&#x3002;</p>
<p>Linux&#x4ECE;&#x7248;&#x672C;2.4&#x4E4B;&#x540E;&#x5F00;&#x59CB;&#x652F;&#x6301;CLONE_PARENT&#x3002;&#x5176;&#x8BBE;&#x8BA1;&#x521D;&#x8877;&#x610F;&#x56FE;&#x662F;&#x5BF9;POSIX&#x7EBF;&#x7A0B;&#x7684;&#x5B9E;&#x73B0;&#x63D0;&#x4F9B;&#x652F;&#x6301;&#xFF0C;&#x4E0D;&#x8FC7;&#x5185;&#x6838; 2.6 &#x627E;&#x51FA;&#x4E00;&#x79CD;&#x65E0;&#x9700;&#x6B64;&#x6807;&#x5FD7;&#x800C;&#x652F;&#x6301;&#x7EBF;&#x7A0B;&#xFF08;&#x4E4B;&#x524D;&#x6240;&#x8FF0;&#x7684; CLONE_THREAD&#xFF09;&#x7684;&#x65B0;&#x65B9;&#x6CD5;&#x3002;</p>
<p>&#x5C06;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x8FDB;&#x7A0B;ID&#x7F6E;&#x4E3A;&#x4E0E;&#x7236;&#x8FDB;&#x7A0B;&#x76F8;&#x540C;&#xFF1A;CLONE_PID&#xFF08;&#x5DF2;&#x5E9F;&#x6B62;&#xFF09;<br>&#x5982;&#x679C;&#x8BBE;&#x7F6E;&#x4E86;CLONE_PID&#xFF0C;&#x90A3;&#x4E48;&#x5B50;&#x8FDB;&#x7A0B;&#x5C31;&#x62E5;&#x6709;&#x4E0E;&#x7236;&#x8FDB;&#x7A0B;&#x76F8;&#x540C;&#x7684;&#x8FDB;&#x7A0B;ID&#x3002;&#x82E5;&#x672A;&#x8BBE;&#x7F6E;&#x6B64;&#x6807;&#x5FD7;&#xFF0C;&#x90A3;&#x4E48;&#x7236;&#x3001;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x8FDB;&#x7A0B;ID&#x5219;&#x4E0D;&#x540C;&#xFF08;&#x5982;&#x540C;fork()&#x548C;vfork()&#xFF09;&#x3002;&#x53EA;&#x6709;&#x7CFB;&#x7EDF;&#x5F15;&#x5BFC;&#x8FDB;&#x7A0B;&#xFF08;&#x8FDB;&#x7A0B;ID&#x4E3A;0&#xFF09;&#x53EF;&#x80FD;&#x4F1A;&#x4F7F;&#x7528;&#x8BE5;&#x6807;&#x5FD7;&#xFF0C;&#x7528;&#x4E8E;&#x521D;&#x59CB;&#x5316;&#x591A;&#x5904;&#x7406;&#x5668;&#x7CFB;&#x7EDF;&#x3002;</p>
<p>CLONE_PID&#x7684;&#x8BBE;&#x8BA1;&#x521D;&#x8877;&#x5E76;&#x975E;&#x4F9B;&#x7528;&#x6237;&#x7EA7;&#x5E94;&#x7528;&#x4F7F;&#x7528;&#x3002;Linux 2.6&#x5DF2;&#x5C06;&#x5176;&#x79FB;&#x9664;&#xFF0C;&#x5E76;&#x4EE5;CLONE_IDLETASK&#x53D6;&#x800C;&#x4EE3;&#x4E4B;&#xFF0C;&#x5C06;&#x65B0;&#x8FDB;&#x7A0B;&#x7684;ID&#x7F6E;&#x4E3A;0&#x3002;CLONE_IDLETASK&#x4EC5;&#x4F9B;&#x5185;&#x6838;&#x5185;&#x90E8;&#x4F7F;&#x7528;&#xFF08;&#x5373;&#x4F7F;&#x5728;clone()&#x7684;&#x53C2;&#x6570;&#x4E2D;&#x6307;&#x5B9A;&#xFF0C;&#x7CFB;&#x7EDF;&#x4E5F;&#x4F1A;&#x5BF9;&#x5176;&#x89C6;&#x800C;&#x4E0D;&#x89C1;&#xFF09;&#x3002;&#x4F7F;&#x7528;&#x6B64;&#x6807;&#x5FD7;&#x53EF;&#x4E3A;&#x6BCF;&#x9897;CPU&#x521B;&#x5EFA;&#x9690;&#x8EAB;&#x7684;&#x7A7A;&#x95F2;&#x8FDB;&#x7A0B;&#xFF08;idle process&#xFF09;&#xFF0C;&#x5728;&#x591A;&#x5904;&#x7406;&#x5668;&#x7CFB;&#x7EDF;&#x4E2D;&#x53EF;&#x80FD;&#x5B58;&#x5728;&#x6709;&#x591A;&#x4E2A;&#x5B9E;&#x4F8B;&#x3002;</p>
<p>&#x8FDB;&#x7A0B;&#x8DDF;&#x8E2A;&#xFF1A;CLONE_PTRACE&#x548C;CLONE_UNTRACED<br>&#x5982;&#x679C;&#x8BBE;&#x7F6E;&#x4E86;CLONE_PTRACE&#x4E14;&#x6B63;&#x5728;&#x8DDF;&#x8E2A;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#xFF0C;&#x90A3;&#x4E48;&#x4E5F;&#x4F1A;&#x5BF9;&#x5B50;&#x8FDB;&#x7A0B;&#x8FDB;&#x884C;&#x8DDF;&#x8E2A;&#x3002;&#x5173;&#x4E8E;&#x8FDB;&#x7A0B;&#x8DDF;&#x8E2A;&#xFF08;&#x7531;&#x8C03;&#x8BD5;&#x5668;&#x548C;strace&#x547D;&#x4EE4;&#x4F7F;&#x7528;&#xFF09;&#x7684;&#x7EC6;&#x8282;&#xFF0C;&#x8BF7;&#x53C2;&#x8003;ptrace(2)&#x624B;&#x518C;&#x9875;&#x3002;</p>
<p>&#x4ECE;&#x5185;&#x6838;2.6&#x5F00;&#x59CB;&#xFF0C;&#x5373;&#x53EF;&#x8BBE;&#x7F6E;CLONE_UNTRACED&#x6807;&#x5FD7;&#xFF0C;&#x8FD9;&#x4E5F;&#x610F;&#x5473;&#x7740;&#x8DDF;&#x8E2A;&#x8FDB;&#x7A0B;&#x4E0D;&#x80FD;&#x5F3A;&#x5236;&#x5C06;&#x5176;&#x5B50;&#x8FDB;&#x7A0B;&#x8BBE;&#x7F6E;&#x4E3A;CLONE_PTRACE&#x3002;CLONE_UNTRACED&#x6807;&#x5FD7;&#x4F9B;&#x5185;&#x6838;&#x521B;&#x5EFA;&#x5185;&#x6838;&#x7EBF;&#x7A0B;&#x65F6;&#x5185;&#x90E8;&#x4F7F;&#x7528;&#x3002;</p>
<p>&#x6302;&#x8D77;&#xFF08;suspending&#xFF09;&#x7236;&#x8FDB;&#x7A0B;&#x76F4;&#x81F3;&#x5B50;&#x8FDB;&#x7A0B;&#x9000;&#x51FA;&#x6216;&#x8C03;&#x7528;exec()&#xFF1A;CLONE_VFORK<br>&#x5982;&#x679C;&#x8BBE;&#x7F6E;&#x4E86;CLONE_VFORK&#xFF0C;&#x7236;&#x8FDB;&#x7A0B;&#x5C06;&#x4E00;&#x76F4;&#x6302;&#x8D77;&#xFF0C;&#x76F4;&#x81F3;&#x5B50;&#x8FDB;&#x7A0B;&#x8C03;&#x7528;exec()&#x6216;_exit()&#x6765;&#x91CA;&#x653E;&#x865A;&#x62DF;&#x5185;&#x5B58;&#x8D44;&#x6E90;&#xFF08;&#x5982;&#x540C;vfork()&#xFF09;&#x4E3A;&#x6B62;&#x3002;</p>
<p>&#x652F;&#x6301;&#x5BB9;&#x5668;&#xFF08;container&#xFF09;&#x7684;clone()&#x65B0;&#x6807;&#x5FD7;<br>Linux&#x4ECE;2.6.19&#x7248;&#x672C;&#x5F00;&#x59CB;&#x7ED9;clone()&#x52A0;&#x5165;&#x4E86;&#x4E00;&#x4E9B;&#x65B0;&#x6807;&#x5FD7;&#xFF1A;CLONE_IO&#x3001;CLONE_NEWIPC&#x3001;CLONET_NEWNET&#x3001;CLONE_NEWPID&#x3001;CLONE_NEWUSER&#x548C;CLONE_NEWUTS&#x3002;&#xFF08;&#x53C2;&#x8003;clone(2)&#x624B;&#x518C;&#x9875;&#x53EF;&#x83B7;&#x5F97;&#x6709;&#x5173;&#x8FD9;&#x4E9B;&#x6807;&#x5FD7;&#x7684;&#x8BE6;&#x7EC6;&#x8BF4;&#x660E;&#x3002;&#xFF09;</p>
<p>&#x8FD9;&#x4E9B;&#x6807;&#x5FD7;&#x4E2D;&#x7684;&#x5927;&#x90E8;&#x5206;&#x90FD;&#x662F;&#x4E3A;&#x5BB9;&#x5668;&#xFF08;container&#xFF09;&#x7684;&#x5B9E;&#x73B0;&#x63D0;&#x4F9B;&#x652F;&#x6301;&#xFF08;[Bhattiprolu et al., 2008]&#xFF09;&#x3002;&#x5BB9;&#x5668;&#x662F;&#x8F7B;&#x91CF;&#x7EA7;&#x865A;&#x62DF;&#x5316;&#x7684;&#x4E00;&#x79CD;&#x5F62;&#x5F0F;&#xFF0C;&#x5C06;&#x8FD0;&#x884C;&#x4E8E;&#x540C;&#x4E00;&#x5185;&#x6838;&#x7684;&#x8FDB;&#x7A0B;&#x7EC4;&#x4ECE;&#x73AF;&#x5883;&#x4E0A;&#x5F7C;&#x6B64;&#x9694;&#x79BB;&#xFF0C;&#x5982;&#x540C;&#x8FD0;&#x884C;&#x5728;&#x4E0D;&#x540C;&#x673A;&#x5668;&#x4E0A;&#x4E00;&#x6837;&#x3002;&#x5BB9;&#x5668;&#x53EF;&#x4EE5;&#x5D4C;&#x5957;&#xFF0C;&#x4E00;&#x4E2A;&#x5BB9;&#x5668;&#x53EF;&#x4EE5;&#x5305;&#x542B;&#x53E6;&#x4E00;&#x4E2A;&#x5BB9;&#x5668;&#x3002;&#x4E0E;&#x5B8C;&#x5168;&#x865A;&#x62DF;&#x5316;&#x5C06;&#x6BCF;&#x4E2A;&#x865A;&#x62DF;&#x73AF;&#x5883;&#x8FD0;&#x884C;&#x4E8E;&#x4E0D;&#x540C;&#x5185;&#x6838;&#x7684;&#x624B;&#x6CD5;&#x76F8;&#x6BD4;&#xFF0C;&#x5BB9;&#x5668;&#x7684;&#x8FD0;&#x4F5C;&#x65B9;&#x5F0F;&#x53EF;&#x8C13;&#x662F;&#x5927;&#x76F8;&#x5F84;&#x5EAD;&#x3002;</p>
<p>&#x4E3A;&#x5B9E;&#x73B0;&#x5BB9;&#x5668;&#xFF0C;&#x5185;&#x6838;&#x5F00;&#x53D1;&#x8005;&#x4E0D;&#x5F97;&#x4E0D;&#x4E3A;&#x5185;&#x6838;&#x4E2D;&#x7684;&#x5404;&#x79CD;&#x5168;&#x5C40;&#x7CFB;&#x7EDF;&#x8D44;&#x6E90;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;&#x95F4;&#x63A5;&#x5C42;&#xFF0C;&#x4EE5;&#x4FBF;&#x6BCF;&#x4E2A;&#x5BB9;&#x5668;&#x80FD;&#x4E3A;&#x8FD9;&#x4E9B;&#x8D44;&#x6E90;&#x63D0;&#x4F9B;&#x5404;&#x81EA;&#x7684;&#x5B9E;&#x4F8B;&#x3002;&#x8FD9;&#x4E9B;&#x8D44;&#x6E90;&#x5305;&#x62EC;&#xFF1A;&#x8FDB;&#x7A0B;ID&#x3001;&#x7F51;&#x7EDC;&#x534F;&#x8BAE;&#x6808;&#x3001;uname()&#x8FD4;&#x56DE;&#x7684;ID&#x3001;System V IPC&#x5BF9;&#x8C61;&#x3001;&#x7528;&#x6237;&#x548C;&#x7EC4;ID&#x547D;&#x540D;&#x7A7A;&#x95F4;&#x2026;&#x2026;</p>
<p>&#x5BB9;&#x5668;&#x7684;&#x7528;&#x9014;&#x5F88;&#x591A;&#xFF0C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#x3002;</p>
<ul>
<li>&#x63A7;&#x5236;&#x7CFB;&#x7EDF;&#x7684;&#x8D44;&#x6E90;&#x5206;&#x914D;&#xFF0C;&#x8BF8;&#x5982;&#x7F51;&#x7EDC;&#x5E26;&#x5BBD;&#x6216;CPU&#x65F6;&#x95F4;&#xFF08;&#x4F8B;&#x5982;&#xFF0C;&#x6388;&#x4E88;&#x5BB9;&#x5668;&#x67D0;&#x7532;75%&#x7684;CPU&#x65F6;&#x95F4;&#xFF0C;&#x67D0;&#x4E59;&#x5219;&#x83B7;&#x53D6;25%&#xFF09;&#x3002;</li>
<li>&#x5728;&#x5355;&#x53F0;&#x4E3B;&#x673A;&#x4E0A;&#x63D0;&#x4F9B;&#x591A;&#x4E2A;&#x8F7B;&#x91CF;&#x7EA7;&#x865A;&#x62DF;&#x670D;&#x52A1;&#x5668;&#x3002;</li>
<li>&#x51BB;&#x7ED3;&#x67D0;&#x4E2A;&#x5BB9;&#x5668;&#xFF0C;&#x4EE5;&#x6B64;&#x6765;&#x6302;&#x8D77;&#x8BE5;&#x5BB9;&#x5668;&#x4E2D;&#x6240;&#x6709;&#x8FDB;&#x7A0B;&#x7684;&#x6267;&#x884C;&#xFF0C;&#x5E76;&#x4E8E;&#x7A0D;&#x540E;&#x91CD;&#x542F;&#xFF0C;&#x53EF;&#x80FD;&#x662F;&#x5728;&#x8FC1;&#x79FB;&#x5230;&#x53E6;&#x4E00;&#x53F0;&#x673A;&#x5668;&#x4E4B;&#x540E;&#x3002;</li>
<li>&#x5141;&#x8BB8;&#x8F6C;&#x50A8;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x72B6;&#x6001;&#x4FE1;&#x606F;&#xFF0C;&#x8BB0;&#x5F55;&#x4E8E;&#x68C0;&#x67E5;&#x70B9;&#xFF08;checkpointed&#xFF09;&#xFF0C;&#x5E76;&#x4E8E;&#x4E4B;&#x540E;&#x518D;&#x884C;&#x6062;&#x590D;&#xFF08;&#x6216;&#x8BB8;&#x5728;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5D29;&#x6E83;&#x4E4B;&#x540E;&#xFF0C;&#x4EA6;&#x6216;&#x662F;&#x8BA1;&#x5212;&#x5185;&#x3001;&#x5916;&#x7684;&#x7CFB;&#x7EDF;&#x505C;&#x673A;&#x540E;&#xFF09;&#xFF0C;&#x4ECE;&#x68C0;&#x67E5;&#x70B9;&#x5F00;&#x59CB;&#x7EE7;&#x7EED;&#x8FD0;&#x884C;&#x3002;</li>
</ul>
<h3 id="clone-&#x6807;&#x5FD7;&#x7684;&#x4F7F;&#x7528;"><a href="#clone-&#x6807;&#x5FD7;&#x7684;&#x4F7F;&#x7528;" class="headerlink" title="clone()&#x6807;&#x5FD7;&#x7684;&#x4F7F;&#x7528;"></a>clone()&#x6807;&#x5FD7;&#x7684;&#x4F7F;&#x7528;</h3><p>&#x5927;&#x4F53;&#x4E0A;&#x8BF4;&#x6765;&#xFF0C;fork()&#x76F8;&#x5F53;&#x4E8E;&#x4EC5;&#x8BBE;&#x7F6E;flags&#x4E3A;SIGCHLD&#x7684;clone()&#x8C03;&#x7528;&#xFF0C;&#x800C;vfork()&#x5219;&#x5BF9;&#x5E94;&#x4E8E;&#x8BBE;&#x7F6E;&#x5982;&#x4E0B;flags&#x7684;clone()&#xFF1A;</p>
<pre class="line-numbers language-c"><code class="language-c">CLPNE_VM <span class="token operator">|</span> CLONE_VFORK <span class="token operator">|</span> SIGCHILD<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>LinuxThreads&#x7EBF;&#x7A0B;&#x5B9E;&#x73B0;&#x4F7F;&#x7528;clone()&#xFF08;&#x4EC5;&#x7528;&#x5230;&#x524D;4&#x4E2A;&#x53C2;&#x6570;&#xFF09;&#x6765;&#x521B;&#x5EFA;&#x7EBF;&#x7A0B;&#xFF0C;&#x5BF9;flags&#x7684;&#x8BBE;&#x7F6E;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre class="line-numbers language-c"><code class="language-c">CLPNE_VM <span class="token operator">|</span> CLONE_FILES <span class="token operator">|</span> CLONE_FS <span class="token operator">|</span> CLONE_SIGHAND<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>NPTL&#x7EBF;&#x7A0B;&#x5B9E;&#x73B0;&#x5219;&#x4F7F;&#x7528;clone()&#xFF08;&#x4F7F;&#x7528;&#x4E86;&#x6240;&#x6709;7&#x4E2A;&#x53C2;&#x6570;&#xFF09;&#x6765;&#x521B;&#x5EFA;&#x7EBF;&#x7A0B;&#xFF0C;&#x5BF9;flags&#x7684;&#x8BBE;&#x7F6E;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre class="line-numbers language-c"><code class="language-c">CLPNE_VM <span class="token operator">|</span> CLONE_FILES <span class="token operator">|</span> CLONE_FS <span class="token operator">|</span> CLONE_SIGHAND <span class="token operator">|</span> CLONE_THREAD <span class="token operator">|</span> CLONE_SETTLS <span class="token operator">|</span> CLONE_PARENT_SETTID <span class="token operator">|</span> CLONE_CHILD_CLEARTID <span class="token operator">|</span> CLONE_SYSVSEM<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="&#x56E0;&#x514B;&#x9686;&#x751F;&#x6210;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x800C;&#x5BF9;waitpid-&#x8FDB;&#x884C;&#x7684;&#x6269;&#x5C55;"><a href="#&#x56E0;&#x514B;&#x9686;&#x751F;&#x6210;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x800C;&#x5BF9;waitpid-&#x8FDB;&#x884C;&#x7684;&#x6269;&#x5C55;" class="headerlink" title="&#x56E0;&#x514B;&#x9686;&#x751F;&#x6210;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x800C;&#x5BF9;waitpid()&#x8FDB;&#x884C;&#x7684;&#x6269;&#x5C55;"></a>&#x56E0;&#x514B;&#x9686;&#x751F;&#x6210;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x800C;&#x5BF9;waitpid()&#x8FDB;&#x884C;&#x7684;&#x6269;&#x5C55;</h3><p>&#x4E3A;&#x7B49;&#x5F85;&#x7531;clone()&#x4EA7;&#x751F;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#xFF0C;waitpid()&#x3001;wait3()&#x548C;wait4()&#x7684;&#x4F4D;&#x63A9;&#x7801;&#x53C2;&#x6570;options&#x53EF;&#x4EE5;&#x5305;&#x542B;&#x5982;&#x4E0B;&#x9644;&#x52A0;&#xFF08;Linux&#x7279;&#x6709;&#xFF09;&#x503C;&#x3002;<br><strong>WCLONE<br>&#x4E00;&#x7ECF;&#x8BBE;&#x7F6E;&#xFF0C;&#x53EA;&#x4F1A;&#x7B49;&#x5F85;&#x514B;&#x9686;&#x5B50;&#x8FDB;&#x7A0B;&#x3002;&#x5982;&#x672A;&#x8BBE;&#x7F6E;&#xFF0C;&#x53EA;&#x4F1A;&#x7B49;&#x5F85;&#x975E;&#x514B;&#x9686;&#x5B50;&#x8FDB;&#x7A0B;&#x3002;&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x514B;&#x9686;&#x5B50;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#x65F6;&#x53D1;&#x9001;&#x7ED9;&#x5176;&#x7236;&#x8FDB;&#x7A0B;&#x7684;&#x4FE1;&#x53F7;&#x5E76;&#x975E;SIGCHLD&#x3002;&#x5982;&#x679C;&#x540C;&#x65F6;&#x8FD8;&#x6307;&#x5B9A;&#x4E86;</strong>WALL&#xFF0C;&#x90A3;&#x4E48;&#x5C06;&#x5FFD;&#x7565;__WCLONE&#x3002;</p>
<p>__WALL&#xFF08;&#x81EA;Linux2.4&#x4E4B;&#x540E;&#xFF09;<br>&#x7B49;&#x5F85;&#x6240;&#x6709;&#x5B50;&#x8FDB;&#x7A0B;&#xFF0C;&#x65E0;&#x8BBA;&#x7C7B;&#x578B;&#xFF08;&#x514B;&#x9686;&#x3001;&#x975E;&#x514B;&#x9686;&#x901A;&#x5403;&#xFF09;&#x3002;</p>
<p><strong>WNOTHREAD&#xFF08;&#x81EA;Linux2.4&#x4E4B;&#x540E;&#xFF09;<br>&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x7B49;&#x5F85;&#xFF08;wait&#xFF09;&#x7C7B;&#x8C03;&#x7528;&#x6240;&#x7B49;&#x5F85;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#xFF0C;&#x5176;&#x7236;&#x8FDB;&#x7A0B;&#x7684;&#x8303;&#x56F4;&#x904D;&#x53CA;&#x4E0E;&#x8C03;&#x7528;&#x8005;&#x96B6;&#x5C5E;&#x540C;&#x4E00;&#x7EBF;&#x7A0B;&#x7EC4;&#x7684;&#x4EFB;&#x4F55;&#x8FDB;&#x7A0B;&#x3002;&#x6307;&#x5B9A;</strong>WNOTHREAD&#x6807;&#x5FD7;&#x5219;&#x9650;&#x5236;&#x8C03;&#x7528;&#x8005;&#x53EA;&#x80FD;&#x7B49;&#x5F85;&#x81EA;&#x5DF1;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x3002;</p>
<p>waitid()&#x4E0D;&#x80FD;&#x4F7F;&#x7528;&#x4E0A;&#x8FF0;&#x6807;&#x5FD7;&#x3002;</p>
<h2 id="&#x8FDB;&#x7A0B;&#x7684;&#x521B;&#x5EFA;&#x901F;&#x5EA6;"><a href="#&#x8FDB;&#x7A0B;&#x7684;&#x521B;&#x5EFA;&#x901F;&#x5EA6;" class="headerlink" title="&#x8FDB;&#x7A0B;&#x7684;&#x521B;&#x5EFA;&#x901F;&#x5EA6;"></a>&#x8FDB;&#x7A0B;&#x7684;&#x521B;&#x5EFA;&#x901F;&#x5EA6;</h2><div class="amp-img-wrapper"><amp-img src="https://pagepig.oss-cn-hangzhou.aliyuncs.com/20191208183506.png" width="1096" height="584" layout="responsive"></amp-img></div>
<h2 id="exec-&#x548C;fork-&#x5BF9;&#x8FDB;&#x7A0B;&#x5C5E;&#x6027;&#x7684;&#x5F71;&#x54CD;"><a href="#exec-&#x548C;fork-&#x5BF9;&#x8FDB;&#x7A0B;&#x5C5E;&#x6027;&#x7684;&#x5F71;&#x54CD;" class="headerlink" title="exec()&#x548C;fork()&#x5BF9;&#x8FDB;&#x7A0B;&#x5C5E;&#x6027;&#x7684;&#x5F71;&#x54CD;"></a>exec()&#x548C;fork()&#x5BF9;&#x8FDB;&#x7A0B;&#x5C5E;&#x6027;&#x7684;&#x5F71;&#x54CD;</h2><p>TODO.</p>
<h1 id="&#x7EBF;&#x7A0B;&#xFF1A;&#x4ECB;&#x7ECD;"><a href="#&#x7EBF;&#x7A0B;&#xFF1A;&#x4ECB;&#x7ECD;" class="headerlink" title="&#x7EBF;&#x7A0B;&#xFF1A;&#x4ECB;&#x7ECD;"></a>&#x7EBF;&#x7A0B;&#xFF1A;&#x4ECB;&#x7ECD;</h1><p>&#x542F;&#x52A8;&#x7A0B;&#x5E8F;&#x65F6;&#xFF0C;&#x4EA7;&#x751F;&#x7684;&#x8FDB;&#x7A0B;&#x53EA;&#x6709;&#x5355;&#x6761;&#x7EBF;&#x7A0B;&#xFF0C;&#x79F0;&#x4E4B;&#x4E3A;&#x521D;&#x59CB;&#xFF08;initial&#xFF09;&#x6216;&#x4E3B;&#xFF08;main&#xFF09;&#x7EBF;&#x7A0B;&#x3002;</p>
<h2 id="&#x6982;&#x8FF0;"><a href="#&#x6982;&#x8FF0;" class="headerlink" title="&#x6982;&#x8FF0;"></a>&#x6982;&#x8FF0;</h2><p>&#x4E0E;&#x8FDB;&#x7A0B;&#xFF08;process&#xFF09;&#x7C7B;&#x4F3C;&#xFF0C;&#x7EBF;&#x7A0B;&#xFF08;thread&#xFF09;&#x662F;&#x5141;&#x8BB8;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5E76;&#x53D1;&#x6267;&#x884C;&#x591A;&#x4E2A;&#x4EFB;&#x52A1;&#x7684;&#x4E00;&#x79CD;&#x673A;&#x5236;&#x3002;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x5305;&#x542B;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x3002;&#x540C;&#x4E00;&#x7A0B;&#x5E8F;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x7EBF;&#x7A0B;&#x5747;&#x4F1A;&#x72EC;&#x7ACB;&#x6267;&#x884C;&#x76F8;&#x540C;&#x7A0B;&#x5E8F;&#xFF0C;&#x4E14;&#x5171;&#x4EAB;&#x540C;&#x4E00;&#x4EFD;&#x5168;&#x5C40;&#x5185;&#x5B58;&#x533A;&#x57DF;&#xFF0C;&#x5176;&#x4E2D;&#x5305;&#x62EC;&#x521D;&#x59CB;&#x5316;&#x6570;&#x636E;&#x6BB5;&#xFF08;initialized data&#xFF09;&#x3001;&#x672A;&#x521D;&#x59CB;&#x5316;&#x6570;&#x636E;&#x6BB5;&#xFF08;uninitialized data&#xFF09;&#xFF0C;&#x4EE5;&#x53CA;&#x5806;&#x5185;&#x5B58;&#x6BB5;&#xFF08;heap segment&#xFF09;&#x3002;&#xFF08;&#x4F20;&#x7EDF;&#x610F;&#x4E49;&#x4E0A;&#x7684;UNIX&#x8FDB;&#x7A0B;&#x53EA;&#x662F;&#x591A;&#x7EBF;&#x7A0B;&#x7A0B;&#x5E8F;&#x7684;&#x4E00;&#x4E2A;&#x7279;&#x4F8B;&#xFF0C;&#x8BE5;&#x8FDB;&#x7A0B;&#x53EA;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x3002;&#xFF09;<br></p><div class="amp-img-wrapper"><amp-img src="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1581557048006.png?x-oss-process=image/resize,m_lfit,h_450" width="400" height="450" layout="responsive"></amp-img></div>
<p>&#x540C;&#x4E00;&#x8FDB;&#x7A0B;&#x4E2D;&#x7684;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x53EF;&#x4EE5;&#x5E76;&#x53D1;&#x6267;&#x884C;&#x3002;&#x5728;&#x591A;&#x5904;&#x7406;&#x5668;&#x73AF;&#x5883;&#x4E0B;&#xFF0C;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x53EF;&#x4EE5;&#x540C;&#x65F6;&#x5E76;&#x884C;&#x3002;&#x5982;&#x679C;&#x4E00;&#x7EBF;&#x7A0B;&#x56E0;&#x7B49;&#x5F85;I/O&#x64CD;&#x4F5C;&#x800C;&#x906D;&#x963B;&#x585E;&#xFF0C;&#x90A3;&#x4E48;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x4F9D;&#x7136;&#x53EF;&#x4EE5;&#x7EE7;&#x7EED;&#x8FD0;&#x884C;&#x3002;</p>
<p>&#x5BF9;&#x4E8E;&#x67D0;&#x4E9B;&#x5E94;&#x7528;&#x800C;&#x8A00;&#xFF0C;&#x7EBF;&#x7A0B;&#x8981;&#x4F18;&#x4E8E;&#x8FDB;&#x7A0B;&#x3002;&#x4F20;&#x7EDF;UNIX&#x901A;&#x8FC7;&#x521B;&#x5EFA;&#x591A;&#x4E2A;&#x8FDB;&#x7A0B;&#x6765;&#x5B9E;&#x73B0;&#x5E76;&#x884C;&#x4EFB;&#x52A1;&#x3002;&#x4EE5;&#x7F51;&#x7EDC;&#x670D;&#x52A1;&#x5668;&#x7684;&#x8BBE;&#x8BA1;&#x4E3A;&#x4F8B;&#xFF0C;&#x670D;&#x52A1;&#x5668;&#x8FDB;&#x7A0B;&#xFF08;&#x7236;&#x8FDB;&#x7A0B;&#xFF09;&#x5728;&#x63A5;&#x53D7;&#x5BA2;&#x6237;&#x7AEF;&#x7684;&#x8FDE;&#x63A5;&#x540E;&#xFF0C;&#x4F1A;&#x8C03;&#x7528; fork()&#x6765;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5355;&#x72EC;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#xFF0C;&#x4EE5;&#x5904;&#x7406;&#x4E0E;&#x5BA2;&#x6237;&#x7AEF;&#x7684;&#x901A;&#x4FE1;&#x3002;&#x91C7;&#x7528;&#x8FD9;&#x79CD;&#x8BBE;&#x8BA1;&#xFF0C;&#x670D;&#x52A1;&#x5668;&#x5C31;&#x80FD;&#x540C;&#x65F6;&#x4E3A;&#x591A;&#x4E2A;&#x5BA2;&#x6237;&#x7AEF;&#x63D0;&#x4F9B;&#x670D;&#x52A1;&#x3002;&#x867D;&#x7136;&#x8FD9;&#x79CD;&#x65B9;&#x6CD5;&#x5728;&#x5F88;&#x591A;&#x60C5;&#x5883;&#x4E0B;&#x90FD;&#x5C61;&#x8BD5;&#x4E0D;&#x723D;&#xFF0C;&#x4F46;&#x5BF9;&#x4E8E;&#x67D0;&#x4E9B;&#x5E94;&#x7528;&#x6765;&#x8BF4;&#x4E5F;&#x786E;&#x5B9E;&#x5B58;&#x5728;&#x5982;&#x4E0B;&#x4E00;&#x4E9B;&#x9650;&#x5236;&#x3002;</p>
<ul>
<li>&#x8FDB;&#x7A0B;&#x95F4;&#x7684;&#x4FE1;&#x606F;&#x96BE;&#x4EE5;&#x5171;&#x4EAB;&#x3002;&#x7531;&#x4E8E;&#x9664;&#x53BB;&#x53EA;&#x8BFB;&#x4EE3;&#x7801;&#x6BB5;&#x5916;&#xFF0C;&#x7236;&#x5B50;&#x8FDB;&#x7A0B;&#x5E76;&#x672A;&#x5171;&#x4EAB;&#x5185;&#x5B58;&#xFF0C;&#x56E0;&#x6B64;&#x5FC5;&#x987B;&#x91C7;&#x7528;&#x4E00;&#x4E9B;&#x8FDB;&#x7A0B;&#x95F4;&#x901A;&#x4FE1;&#xFF08;inter-process communication&#xFF0C;&#x7B80;&#x79F0;IPC&#xFF09;&#x65B9;&#x5F0F;&#xFF0C;&#x5728;&#x8FDB;&#x7A0B;&#x95F4;&#x8FDB;&#x884C;&#x4FE1;&#x606F;&#x4EA4;&#x6362;&#x3002;</li>
<li>&#x8C03;&#x7528; fork()&#x6765;&#x521B;&#x5EFA;&#x8FDB;&#x7A0B;&#x7684;&#x4EE3;&#x4EF7;&#x76F8;&#x5BF9;&#x8F83;&#x9AD8;&#x3002;&#x5373;&#x4FBF;&#x5229;&#x7528;&#x5199;&#x65F6;&#x590D;&#x5236;&#xFF08;copy-on-write&#xFF09;&#x6280;&#x672F;&#xFF0C;&#x4ECD;&#x7136;&#x9700;&#x8981;&#x590D;&#x5236;&#x8BF8;&#x5982;&#x5185;&#x5B58;&#x9875;&#x8868;&#xFF08;page table&#xFF09;&#x548C;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x8868;&#xFF08;file descriptor table&#xFF09;&#x4E4B;&#x7C7B;&#x7684;&#x591A;&#x79CD;&#x8FDB;&#x7A0B;&#x5C5E;&#x6027;&#xFF0C;&#x8FD9;&#x610F;&#x5473;&#x7740;fork()&#x8C03;&#x7528;&#x5728;&#x65F6;&#x95F4;&#x4E0A;&#x7684;&#x5F00;&#x9500;&#x4F9D;&#x7136;&#x4E0D;&#x83F2;&#x3002;</li>
</ul>
<p>&#x7EBF;&#x7A0B;&#x89E3;&#x51B3;&#x4E86;&#x4E0A;&#x8FF0;&#x4E24;&#x4E2A;&#x95EE;&#x9898;&#x3002;</p>
<ul>
<li>&#x7EBF;&#x7A0B;&#x4E4B;&#x95F4;&#x80FD;&#x591F;&#x65B9;&#x4FBF;&#x3001;&#x5FEB;&#x901F;&#x5730;&#x5171;&#x4EAB;&#x4FE1;&#x606F;&#x3002;&#x53EA;&#x9700;&#x5C06;&#x6570;&#x636E;&#x590D;&#x5236;&#x5230;&#x5171;&#x4EAB;&#xFF08;&#x5168;&#x5C40;&#x6216;&#x5806;&#xFF09;&#x53D8;&#x91CF;&#x4E2D;&#x5373;&#x53EF;&#x3002;&#x4E0D;&#x8FC7;&#xFF0C;&#x8981;&#x907F;&#x514D;&#x51FA;&#x73B0;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x8BD5;&#x56FE;&#x540C;&#x65F6;&#x4FEE;&#x6539;&#x540C;&#x4E00;&#x4EFD;&#x4FE1;&#x606F;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x8FD9;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x540C;&#x6B65;&#x6280;&#x672F;&#x3002;</li>
<li>&#x521B;&#x5EFA;&#x7EBF;&#x7A0B;&#x6BD4;&#x521B;&#x5EFA;&#x8FDB;&#x7A0B;&#x901A;&#x5E38;&#x8981;&#x5FEB;10&#x500D;&#x751A;&#x81F3;&#x66F4;&#x591A;&#x3002;&#xFF08;&#x5728; Linux &#x4E2D;&#xFF0C;&#x662F;&#x901A;&#x8FC7;&#x7CFB;&#x7EDF;&#x8C03;&#x7528; clone()&#x6765;&#x5B9E;&#x73B0;&#x7EBF;&#x7A0B;&#x7684;&#xFF09;&#x7EBF;&#x7A0B;&#x7684;&#x521B;&#x5EFA;&#x4E4B;&#x6240;&#x4EE5;&#x8F83;&#x5FEB;&#xFF0C;&#x662F;&#x56E0;&#x4E3A;&#x8C03;&#x7528; fork()&#x521B;&#x5EFA;&#x5B50;&#x8FDB;&#x7A0B;&#x65F6;&#x6240;&#x9700;&#x590D;&#x5236;&#x7684;&#x8BF8;&#x591A;&#x5C5E;&#x6027;&#xFF0C;&#x5728;&#x7EBF;&#x7A0B;&#x95F4;&#x672C;&#x6765;&#x5C31;&#x662F;&#x5171;&#x4EAB;&#x7684;&#x3002;&#x7279;&#x522B;&#x662F;&#xFF0C;&#x65E2;&#x65E0;&#x9700;&#x91C7;&#x7528;&#x5199;&#x65F6;&#x590D;&#x5236;&#x6765;&#x590D;&#x5236;&#x5185;&#x5B58;&#x9875;&#xFF0C;&#x4E5F;&#x65E0;&#x9700;&#x590D;&#x5236;&#x9875;&#x8868;&#x3002;</li>
</ul>
<p>&#x9664;&#x4E86;&#x5168;&#x5C40;&#x5185;&#x5B58;&#x4E4B;&#x5916;&#xFF0C;&#x7EBF;&#x7A0B;&#x8FD8;&#x5171;&#x4EAB;&#x4E86;&#x4E00;&#x5E72;&#x5176;&#x4ED6;&#x5C5E;&#x6027;&#xFF08;&#x8FD9;&#x4E9B;&#x5C5E;&#x6027;&#x5BF9;&#x4E8E;&#x8FDB;&#x7A0B;&#x800C;&#x8A00;&#x662F;&#x5168;&#x5C40;&#x6027;&#x7684;&#xFF0C;&#x800C;&#x5E76;&#x975E;&#x9488;&#x5BF9;&#x67D0;&#x4E2A;&#x7279;&#x5B9A;&#x7EBF;&#x7A0B;&#xFF09;&#xFF0C;&#x5305;&#x62EC;&#x4EE5;&#x4E0B;&#x5185;&#x5BB9;&#x3002;</p>
<ul>
<li>&#x8FDB;&#x7A0B;ID&#xFF08;process ID&#xFF09;&#x548C;&#x7236;&#x8FDB;&#x7A0B;ID&#x3002;</li>
<li>&#x8FDB;&#x7A0B;&#x7EC4;ID&#x4E0E;&#x4F1A;&#x8BDD;ID&#xFF08;session ID&#xFF09;&#x3002;</li>
<li>&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x3002;</li>
<li>&#x8FDB;&#x7A0B;&#x51ED;&#x8BC1;&#xFF08;process credential&#xFF09;&#xFF08;&#x7528;&#x6237;ID&#x548C;&#x7EC4;ID &#xFF09;&#x3002;</li>
<li>&#x6253;&#x5F00;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x3002;</li>
<li>&#x7531;fcntl()&#x521B;&#x5EFA;&#x7684;&#x8BB0;&#x5F55;&#x9501;&#xFF08;record lock&#xFF09;&#x3002;</li>
<li>&#x4FE1;&#x53F7;&#xFF08;signal&#xFF09;&#x5904;&#x7F6E;&#x3002;</li>
<li>&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x7684;&#x76F8;&#x5173;&#x4FE1;&#x606F;&#xFF1A;&#x6587;&#x4EF6;&#x6743;&#x9650;&#x63A9;&#x7801;&#xFF08;umask&#xFF09;&#x3001;&#x5F53;&#x524D;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;&#x548C;&#x6839;&#x76EE;&#x5F55;&#x3002;</li>
<li>&#x95F4;&#x9694;&#x5B9A;&#x65F6;&#x5668;&#xFF08;setitimer()&#xFF09;&#x548C;POSIX&#x5B9A;&#x65F6;&#x5668;&#xFF08;timer_create()&#xFF09;&#x3002;</li>
<li>&#x7CFB;&#x7EDF;V&#xFF08;system V&#xFF09;&#x4FE1;&#x53F7;&#x91CF;&#x64A4;&#x9500;&#xFF08;undo&#xFF0C;semadj&#xFF09;&#x503C;&#xFF08;47.8&#x8282;&#xFF09;&#x3002;</li>
<li>&#x8D44;&#x6E90;&#x9650;&#x5236;&#xFF08;resource limit&#xFF09;&#x3002;</li>
<li>CPU&#x65F6;&#x95F4;&#x6D88;&#x8017;&#xFF08;&#x7531;times()&#x8FD4;&#x56DE;&#xFF09;&#x3002;</li>
<li>&#x8D44;&#x6E90;&#x6D88;&#x8017;&#xFF08;&#x7531;getrusage()&#x8FD4;&#x56DE;&#xFF09;&#x3002;</li>
<li>nice&#x503C;&#xFF08;&#x7531;setpriority()&#x548C;nice()&#x8BBE;&#x7F6E;&#xFF09;&#x3002;</li>
</ul>
<p>&#x5404;&#x7EBF;&#x7A0B;&#x6240;&#x72EC;&#x6709;&#x7684;&#x5C5E;&#x6027;&#xFF0C;&#x5982;&#x4E0B;&#x5217;&#x51FA;&#x4E86;&#x5176;&#x4E2D;&#x4E00;&#x90E8;&#x5206;&#x3002;</p>
<ul>
<li>&#x7EBF;&#x7A0B;ID&#xFF08;thread ID&#xFF0C;29.5&#x8282;&#xFF09;&#x3002;</li>
<li>&#x4FE1;&#x53F7;&#x63A9;&#x7801;&#xFF08;signal mask&#xFF09;&#x3002;</li>
<li>&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;&#xFF08;31.3&#x8282;&#xFF09;&#x3002;</li>
<li>&#x5907;&#x9009;&#x4FE1;&#x53F7;&#x6808;&#xFF08;sigaltstack()&#xFF09;&#x3002;</li>
<li>errno&#x53D8;&#x91CF;&#x3002;</li>
<li>&#x6D6E;&#x70B9;&#x578B;&#xFF08;floating-point&#xFF09;&#x73AF;&#x5883;&#xFF08;&#x89C1;fenv(3)&#xFF09;&#x3002;</li>
<li>&#x5B9E;&#x65F6;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#xFF08;real-time scheduling policy&#xFF09;&#x548C;&#x4F18;&#x5148;&#x7EA7;&#xFF08;35.2&#x8282;&#x548C;35.3&#x8282;&#xFF09;&#x3002;</li>
<li>CPU&#x4EB2;&#x548C;&#x529B;&#xFF08;affinity&#xFF0C;Linux&#x6240;&#x7279;&#x6709;&#xFF0C;35.4&#x8282;&#x5C06;&#x52A0;&#x4EE5;&#x63CF;&#x8FF0;&#xFF09;&#x3002;</li>
<li>&#x80FD;&#x529B;&#xFF08;capability&#xFF0C;Linux&#x6240;&#x7279;&#x6709;&#xFF0C;&#x7B2C;39&#x7AE0;&#x5C06;&#x52A0;&#x4EE5;&#x63CF;&#x8FF0;&#xFF09;&#x3002;</li>
<li>&#x6808;&#xFF0C;&#x672C;&#x5730;&#x53D8;&#x91CF;&#x548C;&#x51FD;&#x6570;&#x7684;&#x8C03;&#x7528;&#x94FE;&#x63A5;&#xFF08;linkage&#xFF09;&#x4FE1;&#x606F;&#x3002;</li>
</ul>
<h2 id="Pthreads-API&#x7684;&#x8BE6;&#x7EC6;&#x80CC;&#x666F;"><a href="#Pthreads-API&#x7684;&#x8BE6;&#x7EC6;&#x80CC;&#x666F;" class="headerlink" title="Pthreads API&#x7684;&#x8BE6;&#x7EC6;&#x80CC;&#x666F;"></a>Pthreads API&#x7684;&#x8BE6;&#x7EC6;&#x80CC;&#x666F;</h2><p>20&#x4E16;&#x7EAA;80&#x5E74;&#x4EE3;&#x672B;&#x3001;90&#x5E74;&#x4EE3;&#x521D;&#xFF0C;&#x5B58;&#x5728;&#x7740;&#x6570;&#x79CD;&#x4E0D;&#x540C;&#x7684;&#x7EBF;&#x7A0B;&#x63A5;&#x53E3;&#x3002;1995&#x5E74;POSIX.1c&#x5BF9;POSIX&#x7EBF;&#x7A0B;API&#x8FDB;&#x884C;&#x4E86;&#x6807;&#x51C6;&#x5316;&#xFF0C;&#x8BE5;&#x6807;&#x51C6;&#x540E;&#x6765;&#x4E3A;SUSv3&#x6240;&#x63A5;&#x7EB3;&#x3002;</p>
<p>&#x6709;&#x51E0;&#x4E2A;&#x6982;&#x5FF5;&#x8D2F;&#x7A7F;&#x6574;&#x4E2A;Pthreads API&#xFF0C;&#x5728;&#x6DF1;&#x5165;&#x63A2;&#x8BA8;API&#x4E4B;&#x524D;&#xFF0C;&#x5C06;&#x7B80;&#x5355;&#x4E88;&#x4EE5;&#x4ECB;&#x7ECD;&#x3002;</p>
<h3 id="&#x7EBF;&#x7A0B;&#x6570;&#x636E;&#x7C7B;&#x578B;&#xFF08;Pthreads-data-type&#xFF09;"><a href="#&#x7EBF;&#x7A0B;&#x6570;&#x636E;&#x7C7B;&#x578B;&#xFF08;Pthreads-data-type&#xFF09;" class="headerlink" title="&#x7EBF;&#x7A0B;&#x6570;&#x636E;&#x7C7B;&#x578B;&#xFF08;Pthreads data type&#xFF09;"></a>&#x7EBF;&#x7A0B;&#x6570;&#x636E;&#x7C7B;&#x578B;&#xFF08;Pthreads data type&#xFF09;</h3><p>Pthreads API&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x5E72;&#x6570;&#x636E;&#x7C7B;&#x578B;&#xFF0C;&#x4E0B;&#x8868;&#x5217;&#x51FA;&#x4E86;&#x5176;&#x4E2D;&#x7684;&#x4E00;&#x90E8;&#x5206;&#x3002;</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th align="left">&#x6570; &#x636E; &#x7C7B; &#x578B;</th>
<th align="center">&#x63CF;&#x3000;&#x3000;&#x8FF0;</th>
</tr>
</thead>
<tbody><tr>
<td align="left">pthread_t</td>
<td align="center">&#x7EBF;&#x7A0B;ID</td>
</tr>
<tr>
<td align="left">pthread_mutex_t</td>
<td align="center">&#x4E92;&#x65A5;&#x5BF9;&#x8C61;&#xFF08;Mutex&#xFF09;</td>
</tr>
<tr>
<td align="left">pthread_mutexattr_t</td>
<td align="center">&#x4E92;&#x65A5;&#x5C5E;&#x6027;&#x5BF9;&#x8C61;</td>
</tr>
<tr>
<td align="left">pthread_cond_t</td>
<td align="center">&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#xFF08;condition variable&#xFF09;</td>
</tr>
<tr>
<td align="left">pthread_condattr_t</td>
<td align="center">&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#x7684;&#x5C5E;&#x6027;&#x5BF9;&#x8C61;</td>
</tr>
<tr>
<td align="left">pthread_key_t</td>
<td align="center">&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;&#x7684;&#x952E;&#xFF08;Key&#xFF09;</td>
</tr>
<tr>
<td align="left">pthread_once_t</td>
<td align="center">&#x4E00;&#x6B21;&#x6027;&#x521D;&#x59CB;&#x5316;&#x63A7;&#x5236;&#x4E0A;&#x4E0B;&#x6587;&#xFF08;control context&#xFF09;</td>
</tr>
<tr>
<td align="left">pthread_attr_t</td>
<td align="center">&#x7EBF;&#x7A0B;&#x7684;&#x5C5E;&#x6027;&#x5BF9;&#x8C61;</td>
</tr>
</tbody></table></div>
<p>SUSv3&#x5E76;&#x672A;&#x89C4;&#x5B9A;&#x5982;&#x4F55;&#x5B9E;&#x73B0;&#x8FD9;&#x4E9B;&#x6570;&#x636E;&#x7C7B;&#x578B;&#xFF0C;&#x53EF;&#x79FB;&#x690D;&#x7684;&#x7A0B;&#x5E8F;&#x5E94;&#x5C06;&#x5176;&#x89C6;&#x4E3A;&#x201C;&#x4E0D;&#x900F;&#x660E;&#x201D;&#x6570;&#x636E;&#x3002;&#x4EA6;&#x5373;&#xFF0C;&#x7A0B;&#x5E8F;&#x5E94;&#x907F;&#x514D;&#x5BF9;&#x6B64;&#x7C7B;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x53D8;&#x91CF;&#x7684;&#x7ED3;&#x6784;&#x6216;&#x5185;&#x5BB9;&#x4EA7;&#x751F;&#x4EFB;&#x4F55;&#x4F9D;&#x8D56;&#x3002;&#x5C24;&#x5176;&#x662F;&#xFF0C;&#x4E0D;&#x80FD;&#x4F7F;&#x7528;C&#x8BED;&#x8A00;&#x7684;&#x6BD4;&#x8F83;&#x64CD;&#x4F5C;&#x7B26;&#xFF08;==&#xFF09;&#x53BB;&#x6BD4;&#x8F83;&#x8FD9;&#x4E9B;&#x7C7B;&#x578B;&#x7684;&#x53D8;&#x91CF;&#x3002;</p>
<h3 id="&#x7EBF;&#x7A0B;&#x548C;errno"><a href="#&#x7EBF;&#x7A0B;&#x548C;errno" class="headerlink" title="&#x7EBF;&#x7A0B;&#x548C;errno"></a>&#x7EBF;&#x7A0B;&#x548C;errno</h3><p>&#x5728;&#x4F20;&#x7EDF;UNIX&#x3000;API&#x4E2D;&#xFF0C;errno&#x662F;&#x4E00;&#x5168;&#x5C40;&#x6574;&#x578B;&#x53D8;&#x91CF;&#x3002;&#x7136;&#x800C;&#xFF0C;&#x8FD9;&#x65E0;&#x6CD5;&#x6EE1;&#x8DB3;&#x591A;&#x7EBF;&#x7A0B;&#x7A0B;&#x5E8F;&#x7684;&#x9700;&#x8981;&#x3002;&#x5982;&#x679C;&#x7EBF;&#x7A0B;&#x8C03;&#x7528;&#x7684;&#x51FD;&#x6570;&#x901A;&#x8FC7;&#x5168;&#x5C40;errno&#x8FD4;&#x56DE;&#x9519;&#x8BEF;&#x65F6;&#xFF0C;&#x4F1A;&#x4E0E;&#x5176;&#x4ED6;&#x53D1;&#x8D77;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x5E76;&#x68C0;&#x67E5;errno&#x7684;&#x7EBF;&#x7A0B;&#x6DF7;&#x6DC6;&#x5728;&#x4E00;&#x8D77;&#x3002;&#x6362;&#x8A00;&#x4E4B;&#xFF0C;&#x8FD9;&#x5C06;&#x5F15;&#x53D1;&#x7ADE;&#x4E89;&#x6761;&#x4EF6;&#xFF08;race condition&#xFF09;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x5728;&#x591A;&#x7EBF;&#x7A0B;&#x7A0B;&#x5E8F;&#x4E2D;&#xFF0C;&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x90FD;&#x6709;&#x5C5E;&#x4E8E;&#x81EA;&#x5DF1;&#x7684;errno&#x3002;&#x5728;Linux&#x4E2D;&#xFF0C;&#x7EBF;&#x7A0B;&#x7279;&#x6709;errno&#x7684;&#x5B9E;&#x73B0;&#x65B9;&#x5F0F;&#x4E0E;&#x5927;&#x591A;&#x6570;UNIX&#x5B9E;&#x73B0;&#x76F8;&#x7C7B;&#x4F3C;&#xFF1A;&#x5C06; errno &#x5B9A;&#x4E49;&#x4E3A;&#x4E00;&#x4E2A;&#x5B8F;&#xFF0C;&#x53EF;&#x5C55;&#x5F00;&#x4E3A;&#x51FD;&#x6570;&#x8C03;&#x7528;&#xFF0C;&#x8BE5;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x53EF;&#x4FEE;&#x6539;&#x7684;&#x5DE6;&#x503C;&#xFF08;lvalue&#xFF09;&#xFF0C;&#x4E14;&#x4E3A;&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x6240;&#x72EC;&#x6709;&#x3002;&#xFF08;&#x56E0;&#x4E3A;&#x5DE6;&#x503C;&#x53EF;&#x4EE5;&#x4FEE;&#x6539;&#xFF0C;&#x591A;&#x7EBF;&#x7A0B;&#x7A0B;&#x5E8F;&#x4F9D;&#x7136;&#x80FD;&#x4EE5;errno=value&#x7684;&#x65B9;&#x5F0F;&#x5BF9;errno&#x8D4B;&#x503C;&#x3002;&#xFF09;</p>
<p>&#x4E00;&#x8A00;&#x4EE5;&#x853D;&#x4E4B;&#xFF0C;errno&#x673A;&#x5236;&#x5728;&#x4FDD;&#x7559;&#x4F20;&#x7EDF;UNIX API&#x62A5;&#x9519;&#x65B9;&#x5F0F;&#x7684;&#x540C;&#x65F6;&#xFF0C;&#x4E5F;&#x9002;&#x5E94;&#x4E86;&#x591A;&#x7EBF;&#x7A0B;&#x73AF;&#x5883;&#x3002;</p>
<p>&#x6700;&#x521D;&#x7684;POSIX.1&#x6807;&#x51C6;&#x6CBF;&#x88AD;K&amp;R&#x7684;C&#x8BED;&#x8A00;&#x7528;&#x6CD5;&#xFF0C;&#x5141;&#x8BB8;&#x7A0B;&#x5E8F;&#x5C06;errno&#x58F0;&#x660E;&#x4E3A;extern int errno&#x3002;SUSv3&#x5374;&#x4E0D;&#x5141;&#x8BB8;&#x8FD9;&#x4E00;&#x505A;&#x6CD5;&#xFF08;&#x8FD9;&#x4E00;&#x53D8;&#x5316;&#x5B9E;&#x9645;&#x53D1;&#x751F;&#x4E8E;1995&#x5E74;&#x7684;POSIX.1c&#x6807;&#x51C6;&#x4E4B;&#x4E2D;&#xFF09;&#x3002;&#x5982;&#x4ECA;&#xFF0C;&#x9700;&#x8981;&#x58F0;&#x660E;errno&#x7684;&#x7A0B;&#x5E8F;&#x5FC5;&#x987B;&#x5305;&#x542B;&lt;errno.h&gt;&#xFF0C;&#x4EE5;&#x542F;&#x7528;&#x5BF9;errno&#x7684;&#x7EBF;&#x7A0B;&#x7EA7;&#x5B9E;&#x73B0;&#x3002;</p>
<h3 id="Pthreads&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x503C;"><a href="#Pthreads&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x503C;" class="headerlink" title="Pthreads&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x503C;"></a>Pthreads&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x503C;</h3><p>&#x4ECE;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x548C;&#x5E93;&#x51FD;&#x6570;&#x4E2D;&#x8FD4;&#x56DE;&#x72B6;&#x6001;&#xFF0C;&#x4F20;&#x7EDF;&#x7684;&#x505A;&#x6CD5;&#x662F;&#xFF1A;&#x8FD4;&#x56DE;0&#x8868;&#x793A;&#x6210;&#x529F;&#xFF0C;&#x8FD4;&#x56DE;-1&#x8868;&#x793A;&#x5931;&#x8D25;&#xFF0C;&#x5E76;&#x8BBE;&#x7F6E;errno&#x4EE5;&#x6807;&#x8BC6;&#x9519;&#x8BEF;&#x539F;&#x56E0;&#x3002;Pthreads API&#x5219;&#x53CD;&#x5176;&#x9053;&#x800C;&#x884C;&#x4E4B;&#x3002;&#x6240;&#x6709;Pthreads&#x51FD;&#x6570;&#x5747;&#x4EE5;&#x8FD4;&#x56DE;0&#x8868;&#x793A;&#x6210;&#x529F;&#xFF0C;&#x8FD4;&#x56DE;&#x4E00;&#x6B63;&#x503C;&#x8868;&#x793A;&#x5931;&#x8D25;&#x3002;&#x8FD9;&#x4E00;&#x5931;&#x8D25;&#x65F6;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#xFF0C;&#x4E0E;&#x4F20;&#x7EDF;UNIX&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x7F6E;&#x4E8E;errno&#x4E2D;&#x7684;&#x503C;&#x542B;&#x4E49;&#x76F8;&#x540C;&#x3002;</p>
<h3 id="&#x7F16;&#x8BD1;Pthreads&#x7A0B;&#x5E8F;"><a href="#&#x7F16;&#x8BD1;Pthreads&#x7A0B;&#x5E8F;" class="headerlink" title="&#x7F16;&#x8BD1;Pthreads&#x7A0B;&#x5E8F;"></a>&#x7F16;&#x8BD1;Pthreads&#x7A0B;&#x5E8F;</h3><p>&#x5728;Linux&#x5E73;&#x53F0;&#x4E0A;&#xFF0C;&#x5728;&#x7F16;&#x8BD1;&#x8C03;&#x7528;&#x4E86;Pthreads API&#x7684;&#x7A0B;&#x5E8F;&#x65F6;&#xFF0C;&#x9700;&#x8981;&#x8BBE;&#x7F6E;cc -pthread&#x7684;&#x7F16;&#x8BD1;&#x9009;&#x9879;&#x3002;&#x4F7F;&#x7528;&#x8BE5;&#x9009;&#x9879;&#x7684;&#x6548;&#x679C;&#x5982;&#x4E0B;&#x3002;</p>
<ul>
<li>&#x5B9A;&#x4E49;_REENTRANT&#x9884;&#x5904;&#x7406;&#x5B8F;&#x3002;&#x8FD9;&#x4F1A;&#x516C;&#x5F00;&#x5BF9;&#x5C11;&#x6570;&#x53EF;&#x91CD;&#x5165;&#xFF08;reentrant&#xFF09;&#x51FD;&#x6570;&#x7684;&#x58F0;&#x660E;&#x3002;</li>
<li>&#x7A0B;&#x5E8F;&#x4F1A;&#x4E0E;&#x5E93;libpthread&#x8FDB;&#x884C;&#x94FE;&#x63A5;&#xFF08;&#x7B49;&#x4EF7;&#x4E8E;-lpthread&#xFF09;&#x3002;</li>
</ul>
<h2 id="&#x521B;&#x5EFA;&#x7EBF;&#x7A0B;"><a href="#&#x521B;&#x5EFA;&#x7EBF;&#x7A0B;" class="headerlink" title="&#x521B;&#x5EFA;&#x7EBF;&#x7A0B;"></a>&#x521B;&#x5EFA;&#x7EBF;&#x7A0B;</h2><p>&#x542F;&#x52A8;&#x7A0B;&#x5E8F;&#x65F6;&#xFF0C;&#x4EA7;&#x751F;&#x7684;&#x8FDB;&#x7A0B;&#x53EA;&#x6709;&#x5355;&#x6761;&#x7EBF;&#x7A0B;&#xFF0C;&#x79F0;&#x4E4B;&#x4E3A;&#x521D;&#x59CB;&#xFF08;initial&#xFF09;&#x6216;&#x4E3B;&#xFF08;main&#xFF09;&#x7EBF;&#x7A0B;&#x3002;<br>&#x51FD;&#x6570;pthread_create()&#x8D1F;&#x8D23;&#x521B;&#x5EFA;&#x4E00;&#x6761;&#x65B0;&#x7EBF;&#x7A0B;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;pthread.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">pthread_create</span><span class="token punctuation">(</span>pthread_t <span class="token operator">*</span>thread<span class="token punctuation">,</span><span class="token keyword">const</span> pthread_attr_t <span class="token operator">*</span>attr<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">*</span>start<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">void</span> <span class="token operator">*</span>arg<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x65B0;&#x7EBF;&#x7A0B;&#x901A;&#x8FC7;&#x8C03;&#x7528;&#x5E26;&#x6709;&#x53C2;&#x6570;arg&#x7684;&#x51FD;&#x6570;start&#xFF08;&#x5373;start(arg)&#xFF09;&#x800C;&#x5F00;&#x59CB;&#x6267;&#x884C;&#x3002;&#x8C03;&#x7528;pthread_create()&#x7684;&#x7EBF;&#x7A0B;&#x4F1A;&#x7EE7;&#x7EED;&#x6267;&#x884C;&#x8BE5;&#x8C03;&#x7528;&#x4E4B;&#x540E;&#x7684;&#x8BED;&#x53E5;&#x3002;&#xFF08;&#x8FD9;&#x4E00;&#x884C;&#x4E3A;&#x4E0E;glibc&#x5E93;&#x5BF9;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;clone()&#x7684;&#x5305;&#x88C5;&#x51FD;&#x6570;&#x884C;&#x4E3A;&#x76F8;&#x540C;&#x3002;&#xFF09;</p>
<p>&#x5C06;&#x53C2;&#x6570;arg&#x58F0;&#x660E;&#x4E3A;void*&#x7C7B;&#x578B;&#xFF0C;&#x610F;&#x5473;&#x7740;&#x53EF;&#x4EE5;&#x5C06;&#x6307;&#x5411;&#x4EFB;&#x610F;&#x5BF9;&#x8C61;&#x7684;&#x6307;&#x9488;&#x4F20;&#x9012;&#x7ED9;start()&#x51FD;&#x6570;&#x3002;&#x4E00;&#x822C;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;arg&#x6307;&#x5411;&#x4E00;&#x4E2A;&#x5168;&#x5C40;&#x6216;&#x5806;&#x53D8;&#x91CF;&#xFF0C;&#x4E5F;&#x53EF;&#x5C06;&#x5176;&#x7F6E;&#x4E3A;NULL&#x3002;&#x5982;&#x679C;&#x9700;&#x8981;&#x5411;start()&#x4F20;&#x9012;&#x591A;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x53EF;&#x4EE5;&#x5C06;arg&#x6307;&#x5411;&#x4E00;&#x4E2A;&#x7ED3;&#x6784;&#xFF0C;&#x8BE5;&#x7ED3;&#x6784;&#x7684;&#x5404;&#x4E2A;&#x5B57;&#x6BB5;&#x5219;&#x5BF9;&#x5E94;&#x4E8E;&#x5F85;&#x4F20;&#x9012;&#x7684;&#x53C2;&#x6570;&#x3002;&#x901A;&#x8FC7;&#x5BA1;&#x614E;&#x7684;&#x7C7B;&#x578B;&#x5F3A;&#x5236;&#x8F6C;&#x6362;&#xFF0C;arg&#x751A;&#x81F3;&#x53EF;&#x4EE5;&#x4F20;&#x9012;int&#x7C7B;&#x578B;&#x7684;&#x503C;&#x3002;</p>
<p>&#x4E25;&#x683C;&#x8BF4;&#x6765;&#xFF0C;&#x5BF9;&#x4E8E;int&#x4E0E;void<em>&#x4E4B;&#x95F4;&#x76F8;&#x4E92;&#x5F3A;&#x5236;&#x8F6C;&#x6362;&#x7684;&#x540E;&#x679C;&#xFF0C;C&#x8BED;&#x8A00;&#x6807;&#x51C6;&#x5E76;&#x672A;&#x52A0;&#x4EE5;&#x5B9A;&#x4E49;&#x3002;&#x4E0D;&#x8FC7;&#xFF0C;&#x5927;&#x90E8;&#x5206;C&#x8BED;&#x8A00;&#x7F16;&#x8BD1;&#x5668;&#x5141;&#x8BB8;&#x8FD9;&#x6837;&#x7684;&#x64CD;&#x4F5C;&#xFF0C;&#x5E76;&#x4E14;&#x4E5F;&#x80FD;&#x8FBE;&#x6210;&#x9884;&#x671F;&#x7684;&#x76EE;&#x7684;&#xFF0C;&#x5373;int j == (int) ((void</em>) j)&#x3002;</p>
<p>start()&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x7C7B;&#x578B;&#x4E3A;void*&#xFF0C;&#x5BF9;&#x5176;&#x4F7F;&#x7528;&#x65B9;&#x5F0F;&#x4E0E;&#x53C2;&#x6570;arg&#x76F8;&#x540C;&#x3002;&#x5BF9;&#x540E;&#x7EED;pthread_join()&#x51FD;&#x6570;&#x7684;&#x63CF;&#x8FF0;&#x4E2D;&#xFF0C;&#x5C06;&#x8BBA;&#x53CA;&#x5BF9;&#x8BE5;&#x8FD4;&#x56DE;&#x503C;&#x7684;&#x4F7F;&#x7528;&#x65B9;&#x5F0F;&#x3002;</p>
<p>&#x5C06;&#x7ECF;&#x5F3A;&#x5236;&#x8F6C;&#x6362;&#x7684;&#x6574;&#x578B;&#x6570;&#x4F5C;&#x4E3A;&#x7EBF;&#x7A0B;start&#x51FD;&#x6570;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x65F6;&#xFF0C;&#x5FC5;&#x987B;&#x5C0F;&#x5FC3;&#x8C28;&#x614E;&#x3002;&#x539F;&#x56E0;&#x5728;&#x4E8E;&#xFF0C;&#x53D6;&#x6D88;&#x7EBF;&#x7A0B;&#x65F6;&#x7684;&#x8FD4;&#x56DE;&#x503C;PTHREAD_CANCELED&#xFF0C;&#x901A;&#x5E38;&#x662F;&#x7531;&#x5B9E;&#x73B0;&#x6240;&#x5B9A;&#x4E49;&#x7684;&#x6574;&#x578B;&#x503C;&#xFF0C;&#x518D;&#x7ECF;&#x5F3A;&#x5236;&#x8F6C;&#x6362;&#x4E3A;void*&#x3002;&#x82E5;&#x7EBF;&#x7A0B;&#x67D0;&#x7532;&#x7684;start&#x51FD;&#x6570;&#x5C06;&#x6B64;&#x6574;&#x578B;&#x503C;&#x8FD4;&#x56DE;&#x7ED9;&#x6B63;&#x5728;&#x6267;&#x884C;pthread_join()&#x64CD;&#x4F5C;&#x7684;&#x7EBF;&#x7A0B;&#x67D0;&#x4E59;&#xFF0C;&#x67D0;&#x4E59;&#x4F1A;&#x8BEF;&#x8BA4;&#x4E3A;&#x67D0;&#x7532;&#x906D;&#x5230;&#x4E86;&#x53D6;&#x6D88;&#x3002;&#x5E94;&#x7528;&#x5982;&#x679C;&#x91C7;&#x7528;&#x4E86;&#x7EBF;&#x7A0B;&#x53D6;&#x6D88;&#x6280;&#x672F;&#x5E76;&#x9009;&#x62E9;&#x5C06;start&#x51FD;&#x6570;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x5F3A;&#x5236;&#x8F6C;&#x6362;&#x4E3A;&#x6574;&#x578B;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x5FC5;&#x987B;&#x786E;&#x4FDD;&#x7EBF;&#x7A0B;&#x6B63;&#x5E38;&#x7ED3;&#x675F;&#x65F6;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x4E0E;&#x5F53;&#x524D; Pthreads &#x5B9E;&#x73B0;&#x4E2D;&#x7684;PTHREAD_CANCELED&#x4E0D;&#x540C;&#x3002;&#x5982;&#x6B32;&#x4FDD;&#x8BC1;&#x7A0B;&#x5E8F;&#x7684;&#x53EF;&#x79FB;&#x690D;&#x6027;&#xFF0C;&#x5219;&#x5728;&#x4EFB;&#x4F55;&#x5C06;&#x8981;&#x8FD0;&#x884C;&#x8BE5;&#x5E94;&#x7528;&#x7684;&#x5B9E;&#x73B0;&#x4E2D;&#xFF0C;&#x6B63;&#x5E38;&#x9000;&#x51FA;&#x7EBF;&#x7A0B;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x5E94;&#x4E0D;&#x540C;&#x4E8E;&#x76F8;&#x5E94;&#x7684;PTHREAD_CANCELED&#x503C;&#x3002;</p>
<p>&#x53C2;&#x6570;thread&#x6307;&#x5411;pthread_t&#x7C7B;&#x578B;&#x7684;&#x7F13;&#x51B2;&#x533A;&#xFF0C;&#x5728;pthread_create()&#x8FD4;&#x56DE;&#x524D;&#xFF0C;&#x4F1A;&#x5728;&#x6B64;&#x4FDD;&#x5B58;&#x4E00;&#x4E2A;&#x8BE5;&#x7EBF;&#x7A0B;&#x7684;&#x552F;&#x4E00;&#x6807;&#x8BC6;&#x3002;&#x540E;&#x7EED;&#x7684;Pthreads&#x51FD;&#x6570;&#x5C06;&#x4F7F;&#x7528;&#x8BE5;&#x6807;&#x8BC6;&#x6765;&#x5F15;&#x7528;&#x6B64;&#x7EBF;&#x7A0B;&#x3002;</p>
<p>SUSv3&#x660E;&#x786E;&#x6307;&#x51FA;&#xFF0C;&#x5728;&#x65B0;&#x7EBF;&#x7A0B;&#x5F00;&#x59CB;&#x6267;&#x884C;&#x4E4B;&#x524D;&#xFF0C;&#x5B9E;&#x73B0;&#x65E0;&#x9700;&#x5BF9;thread&#x53C2;&#x6570;&#x6240;&#x6307;&#x5411;&#x7684;&#x7F13;&#x51B2;&#x533A;&#x8FDB;&#x884C;&#x521D;&#x59CB;&#x5316;&#xFF0C;&#x5373;&#x65B0;&#x7EBF;&#x7A0B;&#x53EF;&#x80FD;&#x4F1A;&#x5728;pthread_create()&#x8FD4;&#x56DE;&#x7ED9;&#x8C03;&#x7528;&#x8005;&#x4E4B;&#x524D;&#x5DF2;&#x7ECF;&#x5F00;&#x59CB;&#x8FD0;&#x884C;&#x3002;&#x5982;&#x65B0;&#x7EBF;&#x7A0B;&#x9700;&#x8981;&#x83B7;&#x53D6;&#x81EA;&#x5DF1;&#x7684;&#x7EBF;&#x7A0B;ID&#xFF0C;&#x5219;&#x53EA;&#x80FD;&#x4F7F;&#x7528;pthread_self()&#x65B9;&#x6CD5;&#x3002;</p>
<p>&#x53C2;&#x6570;attr&#x662F;&#x6307;&#x5411;pthread_attr_t&#x5BF9;&#x8C61;&#x7684;&#x6307;&#x9488;&#xFF0C;&#x8BE5;&#x5BF9;&#x8C61;&#x6307;&#x5B9A;&#x4E86;&#x65B0;&#x7EBF;&#x7A0B;&#x7684;&#x5404;&#x79CD;&#x5C5E;&#x6027;&#x3002;&#x5982;&#x679C;&#x5C06;attr&#x8BBE;&#x7F6E;&#x4E3A;NULL&#xFF0C;&#x90A3;&#x4E48;&#x521B;&#x5EFA;&#x65B0;&#x7EBF;&#x7A0B;&#x65F6;&#x5C06;&#x4F7F;&#x7528;&#x5404;&#x79CD;&#x9ED8;&#x8BA4;&#x5C5E;&#x6027;&#xFF0C;&#x672C;&#x4E66;&#x7684;&#x5927;&#x90E8;&#x5206;&#x793A;&#x4F8B;&#x7A0B;&#x5E8F;&#x90FD;&#x91C7;&#x7528;&#x8FD9;&#x4E00;&#x505A;&#x6CD5;&#x3002;</p>
<p>&#x8C03;&#x7528;pthread_create()&#x540E;&#xFF0C;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x65E0;&#x4ECE;&#x786E;&#x5B9A;&#x7CFB;&#x7EDF;&#x63A5;&#x7740;&#x4F1A;&#x8C03;&#x5EA6;&#x54EA;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x6765;&#x4F7F;&#x7528;CPU&#x8D44;&#x6E90;&#xFF08;&#x5728;&#x591A;&#x5904;&#x7406;&#x5668;&#x7CFB;&#x7EDF;&#x4E2D;&#xFF0C;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x53EF;&#x80FD;&#x4F1A;&#x5728;&#x4E0D;&#x540C;CPU&#x4E0A;&#x540C;&#x65F6;&#x6267;&#x884C;&#xFF09;&#x3002;&#x7A0B;&#x5E8F;&#x5982;&#x9690;&#x542B;&#x4E86;&#x5BF9;&#x7279;&#x5B9A;&#x8C03;&#x5EA6;&#x987A;&#x5E8F;&#x7684;&#x4F9D;&#x8D56;&#xFF0C;&#x5219;&#x65E0;&#x7591;&#x4F1A;&#x5BF9;&#x7ADE;&#x4E89;&#x6761;&#x4EF6;&#x6253;&#x5F00;&#x65B9;&#x4FBF;&#x4E4B;&#x95E8;&#x3002;&#x5982;&#x679C;&#x5BF9;&#x6267;&#x884C;&#x987A;&#x5E8F;&#x786E;&#x6709;&#x5F3A;&#x5236;&#x8981;&#x6C42;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x5FC5;&#x987B;&#x91C7;&#x7528;&#x540C;&#x6B65;&#x6280;&#x672F;&#x3002;</p>
<h2 id="&#x7EC8;&#x6B62;&#x7EBF;&#x7A0B;"><a href="#&#x7EC8;&#x6B62;&#x7EBF;&#x7A0B;" class="headerlink" title="&#x7EC8;&#x6B62;&#x7EBF;&#x7A0B;"></a>&#x7EC8;&#x6B62;&#x7EBF;&#x7A0B;</h2><p>&#x53EF;&#x4EE5;&#x5982;&#x4E0B;&#x65B9;&#x5F0F;&#x7EC8;&#x6B62;&#x7EBF;&#x7A0B;&#x7684;&#x8FD0;&#x884C;&#x3002;</p>
<ul>
<li>&#x7EBF;&#x7A0B;start&#x51FD;&#x6570;&#x6267;&#x884C;return&#x8BED;&#x53E5;&#x5E76;&#x8FD4;&#x56DE;&#x6307;&#x5B9A;&#x503C;&#x3002;</li>
<li>&#x7EBF;&#x7A0B;&#x8C03;&#x7528;pthread_exit()&#x3002;</li>
<li>&#x8C03;&#x7528;pthread_cancel()&#x53D6;&#x6D88;&#x7EBF;&#x7A0B;&#x3002;</li>
<li>&#x4EFB;&#x610F;&#x7EBF;&#x7A0B;&#x8C03;&#x7528;&#x4E86;exit()&#xFF0C;&#x6216;&#x8005;&#x4E3B;&#x7EBF;&#x7A0B;&#x6267;&#x884C;&#x4E86;return&#x8BED;&#x53E5;&#xFF08;&#x5728;main()&#x51FD;&#x6570;&#x4E2D;&#xFF09;&#xFF0C;&#x90FD;&#x4F1A;&#x5BFC;&#x81F4;&#x8FDB;&#x7A0B;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x7EBF;&#x7A0B;&#x7ACB;&#x5373;&#x7EC8;&#x6B62;&#x3002;</li>
</ul>
<p>pthread_exit()&#x51FD;&#x6570;&#x5C06;&#x7EC8;&#x6B62;&#x8C03;&#x7528;&#x7EBF;&#x7A0B;&#xFF0C;&#x4E14;&#x5176;&#x8FD4;&#x56DE;&#x503C;&#x53EF;&#x7531;&#x53E6;&#x4E00;&#x7EBF;&#x7A0B;&#x901A;&#x8FC7;&#x8C03;&#x7528;pthread_join()&#x6765;&#x83B7;&#x53D6;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;pthread.h&gt;</span></span>

<span class="token keyword">void</span> <span class="token function">pthread_exit</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token operator">*</span> retval<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x8C03;&#x7528;pthread_exit()&#x76F8;&#x5F53;&#x4E8E;&#x5728;&#x7EBF;&#x7A0B;&#x7684;start&#x51FD;&#x6570;&#x4E2D;&#x6267;&#x884C;return&#xFF0C;&#x4E0D;&#x540C;&#x4E4B;&#x5904;&#x5728;&#x4E8E;&#xFF0C;&#x53EF;&#x5728;&#x7EBF;&#x7A0B;start&#x51FD;&#x6570;&#x6240;&#x8C03;&#x7528;&#x7684;&#x4EFB;&#x610F;&#x51FD;&#x6570;&#x4E2D;&#x8C03;&#x7528;pthread_exit() &#x3002;<br>&#x53C2;&#x6570;retval&#x6307;&#x5B9A;&#x4E86;&#x7EBF;&#x7A0B;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x3002;Retval&#x6240;&#x6307;&#x5411;&#x7684;&#x5185;&#x5BB9;&#x4E0D;&#x5E94;&#x5206;&#x914D;&#x4E8E;&#x7EBF;&#x7A0B;&#x6808;&#x4E2D;&#xFF0C;&#x56E0;&#x4E3A;&#x7EBF;&#x7A0B;&#x7EC8;&#x6B62;&#x540E;&#xFF0C;&#x5C06;&#x65E0;&#x6CD5;&#x786E;&#x5B9A;&#x7EBF;&#x7A0B;&#x6808;&#x7684;&#x5185;&#x5BB9;&#x662F;&#x5426;&#x6709;&#x6548;&#x3002;&#xFF08;&#x4F8B;&#x5982;&#xFF0C;&#x7CFB;&#x7EDF;&#x53EF;&#x80FD;&#x4F1A;&#x7ACB;&#x523B;&#x5C06;&#x8BE5;&#x8FDB;&#x7A0B;&#x865A;&#x62DF;&#x5185;&#x5B58;&#x7684;&#x8FD9;&#x7247;&#x533A;&#x57DF;&#x91CD;&#x65B0;&#x5206;&#x914D;&#xFF0C;&#x4F9B;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x7EBF;&#x7A0B;&#x6808;&#x4F7F;&#x7528;&#x3002;&#xFF09;&#x51FA;&#x4E8E;&#x540C;&#x6837;&#x7684;&#x7406;&#x7531;&#xFF0C;&#x4E5F;&#x4E0D;&#x5E94;&#x5728;&#x7EBF;&#x7A0B;&#x6808;&#x4E2D;&#x5206;&#x914D;&#x7EBF;&#x7A0B;start&#x51FD;&#x6570;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x3002;<br>&#x5982;&#x679C;&#x4E3B;&#x7EBF;&#x7A0B;&#x8C03;&#x7528;&#x4E86;pthread_exit()&#xFF0C;&#x800C;&#x975E;&#x8C03;&#x7528;exit()&#x6216;&#x662F;&#x6267;&#x884C;return&#x8BED;&#x53E5;&#xFF0C;&#x90A3;&#x4E48;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x5C06;&#x7EE7;&#x7EED;&#x8FD0;&#x884C;&#x3002;</p>
<h2 id="&#x7EBF;&#x7A0B;ID&#xFF08;Thread-ID&#xFF09;"><a href="#&#x7EBF;&#x7A0B;ID&#xFF08;Thread-ID&#xFF09;" class="headerlink" title="&#x7EBF;&#x7A0B;ID&#xFF08;Thread ID&#xFF09;"></a>&#x7EBF;&#x7A0B;ID&#xFF08;Thread ID&#xFF09;</h2><p>&#x8FDB;&#x7A0B;&#x5185;&#x90E8;&#x7684;&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x90FD;&#x6709;&#x4E00;&#x4E2A;&#x552F;&#x4E00;&#x6807;&#x8BC6;&#xFF0C;&#x79F0;&#x4E3A;&#x7EBF;&#x7A0B;ID&#x3002;&#x7EBF;&#x7A0B;ID&#x4F1A;&#x8FD4;&#x56DE;&#x7ED9;pthread_create()&#x7684;&#x8C03;&#x7528;&#x8005;&#xFF0C;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;pthread_self()&#x6765;&#x83B7;&#x53D6;&#x81EA;&#x5DF1;&#x7684;&#x7EBF;&#x7A0B;ID&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;pthread.h&gt;</span></span>

pthread_t <span class="token function">pthread_self</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x7EBF;&#x7A0B;ID&#x5728;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E2D;&#x975E;&#x5E38;&#x6709;&#x7528;&#xFF0C;&#x539F;&#x56E0;&#x5982;&#x4E0B;&#x3002;</p>
<ul>
<li>&#x4E0D;&#x540C;&#x7684;Pthreads&#x51FD;&#x6570;&#x5229;&#x7528;&#x7EBF;&#x7A0B;ID&#x6765;&#x6807;&#x8BC6;&#x8981;&#x64CD;&#x4F5C;&#x7684;&#x76EE;&#x6807;&#x7EBF;&#x7A0B;&#x3002;&#x8FD9;&#x4E9B;&#x51FD;&#x6570;&#x5305;&#x62EC;pthread_ join()&#x3001;pthread_detach()&#x3001;pthread_cancel()&#x548C;pthread_kill()&#x7B49;&#x3002;</li>
<li>&#x5728;&#x4E00;&#x4E9B;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E2D;&#xFF0C;&#x4EE5;&#x7279;&#x5B9A;&#x7EBF;&#x7A0B;&#x7684;&#x7EBF;&#x7A0B;ID&#x4F5C;&#x4E3A;&#x52A8;&#x6001;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x7684;&#x6807;&#x7B7E;&#xFF0C;&#x8FD9;&#x9887;&#x6709;&#x7528;&#x5904;&#xFF0C;&#x65E2;&#x53EF;&#x7528;&#x6765;&#x8BC6;&#x522B;&#x67D0;&#x4E2A;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x7684;&#x521B;&#x5EFA;&#x8005;&#x6216;&#x5C5E;&#x4E3B;&#x7EBF;&#x7A0B;&#xFF0C;&#x53C8;&#x53EF;&#x4EE5;&#x786E;&#x5B9A;&#x968F;&#x540E;&#x5BF9;&#x8BE5;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x6267;&#x884C;&#x64CD;&#x4F5C;&#x7684;&#x5177;&#x4F53;&#x7EBF;&#x7A0B;&#x3002;</li>
</ul>
<p>&#x51FD;&#x6570;pthread_equal()&#x53EF;&#x68C0;&#x67E5;&#x4E24;&#x4E2A;&#x7EBF;&#x7A0B;&#x7684;ID&#x662F;&#x5426;&#x76F8;&#x540C;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;pthread.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">pthread_equal</span><span class="token punctuation">(</span>pthread_t l1<span class="token punctuation">,</span>pthread_t l2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//&#x76F8;&#x7B49;&#x8FD4;&#x56DE;&#x975E;0&#x6570;&#xFF0C;&#x4E0D;&#x76F8;&#x7B49;&#x8FD4;&#x56DE;0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x4F8B;&#x5982;&#xFF0C;&#x4E3A;&#x4E86;&#x68C0;&#x67E5;&#x8C03;&#x7528;&#x7EBF;&#x7A0B;&#x7684;&#x7EBF;&#x7A0B;ID&#x4E0E;&#x4FDD;&#x5B58;&#x4E8E;&#x53D8;&#x91CF;t1&#x4E2D;&#x7684;&#x7EBF;&#x7A0B;ID&#x662F;&#x5426;&#x4E00;&#x81F4;&#xFF0C;&#x53EF;&#x4EE5;&#x7F16;&#x5199;&#x5982;&#x4E0B;&#x4EE3;&#x7801;&#xFF1A;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">pthread_equal</span><span class="token punctuation">(</span>tid<span class="token punctuation">,</span><span class="token function">pthread_self</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;tid matches self\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x56E0;&#x4E3A;&#x5FC5;&#x987B;&#x5C06;pthread_t&#x4F5C;&#x4E3A;&#x4E00;&#x79CD;&#x4E0D;&#x900F;&#x660E;&#x7684;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x52A0;&#x4EE5;&#x5BF9;&#x5F85;&#xFF0C;&#x6240;&#x4EE5;&#x51FD;&#x6570;pthread_equal()&#x662F;&#x5FC5;&#x987B;&#x7684;&#x3002;Linux&#x5C06;pthread_t&#x5B9A;&#x4E49;&#x4E3A;&#x65E0;&#x7B26;&#x53F7;&#x957F;&#x6574;&#x578B;&#xFF08;unsigned long&#xFF09;&#xFF0C;&#x4F46;&#x5728;&#x5176;&#x4ED6;&#x5B9E;&#x73B0;&#x4E2D;&#xFF0C;&#x5219;&#x6709;&#x53EF;&#x80FD;&#x662F;&#x4E00;&#x4E2A;&#x6307;&#x9488;&#x6216;&#x7ED3;&#x6784;&#x3002;&#x5728;NPTL&#x4E2D;&#xFF0C;pthread_t&#x5B9E;&#x9645;&#x4E0A;&#x662F;&#x4E00;&#x4E2A;&#x7ECF;&#x5F3A;&#x5236;&#x8F6C;&#x5316;&#x800C;&#x4E3A;&#x65E0;&#x7B26;&#x53F7;&#x957F;&#x6574;&#x578B;&#x7684;&#x6307;&#x9488;&#x3002;</p>
<p>SUSv3&#x5E76;&#x672A;&#x8981;&#x6C42;&#x5C06;pthread_t&#x5B9E;&#x73B0;&#x4E3A;&#x4E00;&#x4E2A;&#x6807;&#x91CF;&#xFF08;scalar&#xFF09;&#x7C7B;&#x578B;&#xFF0C;&#x8BE5;&#x7C7B;&#x578B;&#x4E5F;&#x53EF;&#x4EE5;&#x662F;&#x4E00;&#x4E2A;&#x7ED3;&#x6784;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x4E0B;&#x5217;&#x663E;&#x793A;&#x7EBF;&#x7A0B;ID&#x7684;&#x4EE3;&#x7801;&#x5B9E;&#x4F8B;&#x5E76;&#x4E0D;&#x5177;&#x6709;&#x53EF;&#x79FB;&#x690D;&#x6027;&#xFF08;&#x5C3D;&#x7BA1;&#x8BE5;&#x5B9E;&#x4F8B;&#x5728;&#x5305;&#x62EC;Linux&#x5728;&#x5185;&#x7684;&#x8BB8;&#x591A;&#x5B9E;&#x73B0;&#x4E0A;&#x5747;&#x53EF;&#x6B63;&#x5E38;&#x8FD0;&#x884C;&#xFF0C;&#x800C;&#x4E14;&#x6709;&#x65F6;&#x5728;&#x8C03;&#x8BD5;&#x7A0B;&#x5E8F;&#x65F6;&#x8FD8;&#x5F88;&#x5B9E;&#x7528;&#xFF09;&#x3002;<br>&#x5728;Linux&#x7684;&#x7EBF;&#x7A0B;&#x5B9E;&#x73B0;&#x4E2D;&#xFF0C;&#x7EBF;&#x7A0B;ID&#x5728;&#x6240;&#x6709;&#x8FDB;&#x7A0B;&#x4E2D;&#x90FD;&#x662F;&#x552F;&#x4E00;&#x7684;&#x3002;&#x4E0D;&#x8FC7;&#x5728;&#x5176;&#x4ED6;&#x5B9E;&#x73B0;&#x4E2D;&#x5219;&#x672A;&#x5FC5;&#x5982;&#x6B64;&#xFF0C;SUSv3&#x7279;&#x522B;&#x6307;&#x51FA;&#xFF0C;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x82E5;&#x4F7F;&#x7528;&#x7EBF;&#x7A0B;ID&#x6765;&#x6807;&#x8BC6;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x7684;&#x7EBF;&#x7A0B;&#xFF0C;&#x5176;&#x53EF;&#x79FB;&#x690D;&#x6027;&#x5C06;&#x65E0;&#x6CD5;&#x5F97;&#x5230;&#x4FDD;&#x8BC1;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x5728;&#x5BF9;&#x5DF2;&#x7EC8;&#x6B62;&#x7EBF;&#x7A0B;&#x65BD;&#x4EE5;pthread_join()&#xFF0C;&#x6216;&#x8005;&#x5728;&#x5DF2;&#x5206;&#x79BB;&#xFF08;detached&#xFF09;&#x7EBF;&#x7A0B;&#x9000;&#x51FA;&#x540E;&#xFF0C;&#x5B9E;&#x73B0;&#x53EF;&#x4EE5;&#x590D;&#x7528;&#x8BE5;&#x7EBF;&#x7A0B;&#x7684;&#x7EBF;&#x7A0B;ID&#x3002;</p>
<p>POSIX&#x7EBF;&#x7A0B;ID&#x4E0E;Linux&#x4E13;&#x6709;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;gettid()&#x6240;&#x8FD4;&#x56DE;&#x7684;&#x7EBF;&#x7A0B;ID&#x5E76;&#x4E0D;&#x76F8;&#x540C;&#x3002;POSIX&#x7EBF;&#x7A0B;ID&#x7531;&#x7EBF;&#x7A0B;&#x5E93;&#x5B9E;&#x73B0;&#x6765;&#x8D1F;&#x8D23;&#x5206;&#x914D;&#x548C;&#x7EF4;&#x62A4;&#x3002;gettid()&#x8FD4;&#x56DE;&#x7684;&#x7EBF;&#x7A0B;ID&#x662F;&#x4E00;&#x4E2A;&#x7531;&#x5185;&#x6838;&#xFF08;Kernel&#xFF09;&#x5206;&#x914D;&#x7684;&#x6570;&#x5B57;&#xFF0C;&#x7C7B;&#x4F3C;&#x4E8E;&#x8FDB;&#x7A0B;ID&#xFF08;process ID&#xFF09;&#x3002;&#x867D;&#x7136;&#x5728;Linux NPTL&#x7EBF;&#x7A0B;&#x5B9E;&#x73B0;&#x4E2D;&#xFF0C;&#x6BCF;&#x4E2A;POSIX&#x7EBF;&#x7A0B;&#x90FD;&#x5BF9;&#x5E94;&#x4E00;&#x4E2A;&#x552F;&#x4E00;&#x7684;&#x5185;&#x6838;&#x7EBF;&#x7A0B;ID&#xFF0C;&#x4F46;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E00;&#x822C;&#x65E0;&#x9700;&#x4E86;&#x89E3;&#x5185;&#x6838;&#x7EBF;&#x7A0B;ID&#xFF08;&#x51B5;&#x4E14;&#xFF0C;&#x5982;&#x679C;&#x7A0B;&#x5E8F;&#x4F9D;&#x8D56;&#x4E8E;&#x8FD9;&#x4E00;&#x4FE1;&#x606F;&#xFF0C;&#x4E5F;&#x5C06;&#x65E0;&#x6CD5;&#x79FB;&#x690D;&#xFF09;&#x3002;</p>
<h2 id="&#x8FDE;&#x63A5;&#xFF08;joining&#xFF09;&#x5DF2;&#x7EC8;&#x6B62;&#x7684;&#x7EBF;&#x7A0B;"><a href="#&#x8FDE;&#x63A5;&#xFF08;joining&#xFF09;&#x5DF2;&#x7EC8;&#x6B62;&#x7684;&#x7EBF;&#x7A0B;" class="headerlink" title="&#x8FDE;&#x63A5;&#xFF08;joining&#xFF09;&#x5DF2;&#x7EC8;&#x6B62;&#x7684;&#x7EBF;&#x7A0B;"></a>&#x8FDE;&#x63A5;&#xFF08;joining&#xFF09;&#x5DF2;&#x7EC8;&#x6B62;&#x7684;&#x7EBF;&#x7A0B;</h2><p>&#x51FD;&#x6570;pthread_join()&#x7B49;&#x5F85;&#x7531;thread&#x6807;&#x8BC6;&#x7684;&#x7EBF;&#x7A0B;&#x7EC8;&#x6B62;&#x3002;&#xFF08;&#x5982;&#x679C;&#x7EBF;&#x7A0B;&#x5DF2;&#x7ECF;&#x7EC8;&#x6B62;&#xFF0C;pthread_join()&#x4F1A;&#x7ACB;&#x5373;&#x8FD4;&#x56DE;&#xFF09;&#x3002;&#x8FD9;&#x79CD;&#x64CD;&#x4F5C;&#x88AB;&#x79F0;&#x4E3A;&#x8FDE;&#x63A5;(joining)&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;pthread.h&gt;</span> </span>

<span class="token keyword">int</span> <span class="token function">pthread_join</span><span class="token punctuation">(</span>pthread_t thread<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token operator">*</span><span class="token operator">*</span>retval<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x82E5; retval &#x4E3A;&#x4E00;&#x975E;&#x7A7A;&#x6307;&#x9488;&#xFF0C;&#x5C06;&#x4F1A;&#x4FDD;&#x5B58;&#x7EBF;&#x7A0B;&#x7EC8;&#x6B62;&#x65F6;&#x8FD4;&#x56DE;&#x503C;&#x7684;&#x62F7;&#x8D1D;&#xFF0C;&#x8BE5;&#x8FD4;&#x56DE;&#x503C;&#x4EA6;&#x5373;&#x7EBF;&#x7A0B;&#x8C03;&#x7528;return&#x6216;pthred_exit()&#x65F6;&#x6240;&#x6307;&#x5B9A;&#x7684;&#x503C;&#x3002;<br>&#x5982;&#x5411;pthread_join()&#x4F20;&#x5165;&#x4E00;&#x4E2A;&#x4E4B;&#x524D;&#x5DF2;&#x7136;&#x8FDE;&#x63A5;&#x8FC7;&#x7684;&#x7EBF;&#x7A0B;ID&#xFF0C;&#x5C06;&#x4F1A;&#x5BFC;&#x81F4;&#x65E0;&#x6CD5;&#x9884;&#x77E5;&#x7684;&#x884C;&#x4E3A;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x76F8;&#x540C;&#x7684;&#x7EBF;&#x7A0B;ID&#x5728;&#x53C2;&#x4E0E;&#x4E00;&#x6B21;&#x8FDE;&#x63A5;&#x540E;&#x6070;&#x597D;&#x4E3A;&#x53E6;&#x4E00;&#x65B0;&#x5EFA;&#x7EBF;&#x7A0B;&#x6240;&#x91CD;&#x7528;&#xFF0C;&#x518D;&#x5EA6;&#x8FDE;&#x63A5;&#x7684;&#x53EF;&#x80FD;&#x5C31;&#x662F;&#x8FD9;&#x4E2A;&#x65B0;&#x7EBF;&#x7A0B;&#x3002;<br>&#x82E5;&#x7EBF;&#x7A0B;&#x5E76;&#x672A;&#x5206;&#x79BB;&#xFF0C;&#x5219;&#x5FC5;&#x987B;&#x4F7F;&#x7528;ptherad_join()&#x6765;&#x8FDB;&#x884C;&#x8FDE;&#x63A5;&#x3002;&#x5982;&#x679C;&#x672A;&#x80FD;&#x8FDE;&#x63A5;&#xFF0C;&#x90A3;&#x4E48;&#x7EBF;&#x7A0B;&#x7EC8;&#x6B62;&#x65F6;&#x5C06;&#x4EA7;&#x751F;&#x50F5;&#x5C38;&#x7EBF;&#x7A0B;&#xFF0C;&#x4E0E;&#x50F5;&#x5C38;&#x8FDB;&#x7A0B;&#xFF08;zombie process&#xFF09;&#x7684;&#x6982;&#x5FF5;&#x76F8;&#x7C7B;&#x4F3C;&#x3002;&#x9664;&#x4E86;&#x6D6A;&#x8D39;&#x7CFB;&#x7EDF;&#x8D44;&#x6E90;&#x4EE5;&#x5916;&#xFF0C;&#x50F5;&#x5C38;&#x7EBF;&#x7A0B;&#x82E5;&#x7D2F;&#x79EF;&#x8FC7;&#x591A;&#xFF0C;&#x5E94;&#x7528;&#x5C06;&#x518D;&#x4E5F;&#x65E0;&#x6CD5;&#x521B;&#x5EFA;&#x65B0;&#x7684;&#x7EBF;&#x7A0B;&#x3002;</p>
<p>pthread_join()&#x6267;&#x884C;&#x7684;&#x529F;&#x80FD;&#x7C7B;&#x4F3C;&#x4E8E;&#x9488;&#x5BF9;&#x8FDB;&#x7A0B;&#x7684;waitpid()&#x8C03;&#x7528;&#xFF0C;&#x4E0D;&#x8FC7;&#x4E8C;&#x8005;&#x4E4B;&#x95F4;&#x5B58;&#x5728;&#x4E00;&#x4E9B;&#x663E;&#x8457;&#x5DEE;&#x522B;&#x3002;</p>
<ul>
<li>&#x7EBF;&#x7A0B;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x7CFB;&#x662F;&#x5BF9;&#x7B49;&#x7684;&#xFF08;peers&#xFF09;&#x3002;&#x8FDB;&#x7A0B;&#x4E2D;&#x7684;&#x4EFB;&#x610F;&#x7EBF;&#x7A0B;&#x5747;&#x53EF;&#x4EE5;&#x8C03;&#x7528;pthread_join()&#x4E0E;&#x8BE5;&#x8FDB;&#x7A0B;&#x7684;&#x4EFB;&#x4F55;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x8FDE;&#x63A5;&#x8D77;&#x6765;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x5982;&#x679C;&#x7EBF;&#x7A0B;A&#x521B;&#x5EFA;&#x7EBF;&#x7A0B;B&#xFF0C;&#x7EBF;&#x7A0B;B&#x518D;&#x521B;&#x5EFA;&#x7EBF;&#x7A0B;C&#xFF0C;&#x90A3;&#x4E48;&#x7EBF;&#x7A0B;A&#x53EF;&#x4EE5;&#x8FDE;&#x63A5;&#x7EBF;&#x7A0B;C&#xFF0C;&#x7EBF;&#x7A0B;C&#x4E5F;&#x53EF;&#x4EE5;&#x8FDE;&#x63A5;&#x7EBF;&#x7A0B;A&#x3002;&#x8FD9;&#x4E0E;&#x8FDB;&#x7A0B;&#x95F4;&#x7684;&#x5C42;&#x6B21;&#x5173;&#x7CFB;&#x4E0D;&#x540C;&#xFF0C;&#x7236;&#x8FDB;&#x7A0B;&#x5982;&#x679C;&#x4F7F;&#x7528;fork()&#x521B;&#x5EFA;&#x4E86;&#x5B50;&#x8FDB;&#x7A0B;&#xFF0C;&#x90A3;&#x4E48;&#x5B83;&#x4E5F;&#x662F;&#x552F;&#x4E00;&#x80FD;&#x591F;&#x5BF9;&#x5B50;&#x8FDB;&#x7A0B;&#x8C03;&#x7528;wait()&#x7684;&#x8FDB;&#x7A0B;&#x3002;&#x8C03;&#x7528;pthread_create()&#x521B;&#x5EFA;&#x7684;&#x65B0;&#x7EBF;&#x7A0B;&#x4E0E;&#x53D1;&#x8D77;&#x8C03;&#x7528;&#x7684;&#x7EBF;&#x7A0B;&#x4E4B;&#x95F4;&#xFF0C;&#x5C31;&#x6CA1;&#x6709;&#x8FD9;&#x6837;&#x7684;&#x5173;&#x7CFB;&#x3002;</li>
<li>&#x65E0;&#x6CD5;&#x201C;&#x8FDE;&#x63A5;&#x4EFB;&#x610F;&#x7EBF;&#x7A0B;&#x201D;&#xFF08;&#x5BF9;&#x4E8E;&#x8FDB;&#x7A0B;&#xFF0C;&#x5219;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8C03;&#x7528;waitpid(-1, &amp;status, options)&#x505A;&#x5230;&#x8FD9;&#x4E00;&#x70B9;&#xFF09;&#xFF0C;&#x4E5F;&#x4E0D;&#x80FD;&#x4EE5;&#x975E;&#x963B;&#x585E;&#xFF08;nonblocking&#xFF09;&#x65B9;&#x5F0F;&#x8FDB;&#x884C;&#x8FDE;&#x63A5;&#xFF08;&#x7C7B;&#x4F3C;&#x4E8E;&#x8BBE;&#x7F6E;WHOHANG&#x6807;&#x5FD7;&#x7684;waitpid()&#xFF09;&#x3002;&#x4F7F;&#x7528;&#x6761;&#x4EF6;&#xFF08;condition&#xFF09;&#x53D8;&#x91CF;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x7C7B;&#x4F3C;&#x7684;&#x529F;&#x80FD;.</li>
</ul>
<p>&#x9650;&#x5236;pthread_join()&#x53EA;&#x80FD;&#x8FDE;&#x63A5;&#x7279;&#x5B9A;&#x7EBF;&#x7A0B;ID&#xFF0C;&#x8FD9;&#x6837;&#x505A;&#x662F;&#x201C;&#x522B;&#x6709;&#x7528;&#x5FC3;&#x201D;&#x7684;&#x3002;&#x5176;&#x7528;&#x610F;&#x5728;&#x4E8E;&#xFF0C;&#x7A0B;&#x5E8F;&#x5E94;&#x53EA;&#x80FD;&#x8FDE;&#x63A5;&#x5B83;&#x6240;&#x201C;&#x77E5;&#x9053;&#x7684;&#x201D;&#x7EBF;&#x7A0B;&#x3002;&#x7EBF;&#x7A0B;&#x4E4B;&#x95F4;&#x5E76;&#x65E0;&#x5C42;&#x6B21;&#x5173;&#x7CFB;&#xFF0C;&#x5982;&#x679C;&#x542C;&#x4EFB;&#x201C;&#x4E0E;&#x4EFB;&#x610F;&#x7EBF;&#x7A0B;&#x8FDE;&#x63A5;&#x201D;&#x7684;&#x64CD;&#x4F5C;&#x53D1;&#x751F;&#xFF0C;&#x90A3;&#x4E48;&#x6240;&#x8C13;&#x201C;&#x4EFB;&#x610F;&#x201D;&#x7EBF;&#x7A0B;&#x5C31;&#x53EF;&#x4EE5;&#x5305;&#x62EC;&#x7531;&#x5E93;&#x51FD;&#x6570;&#x79C1;&#x81EA;&#x521B;&#x5EFA;&#x7684;&#x7EBF;&#x7A0B;&#xFF0C;&#x4ECE;&#x800C;&#x5E26;&#x6765;&#x95EE;&#x9898;&#x3002;&#x7ED3;&#x679C;&#x662F;&#xFF0C;&#x51FD;&#x6570;&#x5E93;&#x5728;&#x83B7;&#x53D6;&#x7EBF;&#x7A0B;&#x8FD4;&#x56DE;&#x72B6;&#x6001;&#x65F6;&#x5C06;&#x4E0D;&#x518D;&#x80FD;&#x4E0E;&#x8BE5;&#x7EBF;&#x7A0B;&#x8FDE;&#x63A5; &#xFF0C;&#x53EA;&#x4F1A;&#x4E00;&#x9519;&#x518D;&#x9519;&#xFF0C;&#x8BD5;&#x56FE;&#x8FDE;&#x63A5;&#x4E00;&#x4E2A;&#x5DF2;&#x7136;&#x8FDE;&#x63A5;&#x8FC7;&#x7684;&#x7EBF;&#x7A0B;ID&#x3002;&#x6362;&#x8A00;&#x4E4B;&#xFF0C;&#x201C;&#x8FDE;&#x63A5;&#x4EFB;&#x610F;&#x7EBF;&#x7A0B;&#x201D;&#x7684;&#x64CD;&#x4F5C;&#x4E0E;&#x6A21;&#x5757;&#x5316;&#x7684;&#x7A0B;&#x5E8F;&#x8BBE;&#x8BA1;&#x7406;&#x5FF5;&#x80CC;&#x9053;&#x800C;&#x9A70;&#x3002;</p>
<h2 id="&#x7EBF;&#x7A0B;&#x7684;&#x5206;&#x79BB;"><a href="#&#x7EBF;&#x7A0B;&#x7684;&#x5206;&#x79BB;" class="headerlink" title="&#x7EBF;&#x7A0B;&#x7684;&#x5206;&#x79BB;"></a>&#x7EBF;&#x7A0B;&#x7684;&#x5206;&#x79BB;</h2><p>&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x7EBF;&#x7A0B;&#x662F;&#x53EF;&#x8FDE;&#x63A5;&#x7684;(joinable)&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x5F53;&#x7EBF;&#x7A0B;&#x9000;&#x51FA;&#x65F6;&#xFF0C;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8C03;&#x7528;pthread_join()&#x83B7;&#x53D6;&#x5176;&#x8FD4;&#x56DE;&#x72B6;&#x6001;&#x3002;&#x6709;&#x65F6;&#xFF0C;&#x7A0B;&#x5E8F;&#x5458;&#x5E76;&#x4E0D;&#x5173;&#x5FC3;&#x7EBF;&#x7A0B;&#x7684;&#x8FD4;&#x56DE;&#x72B6;&#x6001;&#xFF0C;&#x53EA;&#x662F;&#x5E0C;&#x671B;&#x7CFB;&#x7EDF;&#x5728;&#x7EBF;&#x7A0B;&#x7EC8;&#x6B62;&#x65F6;&#x80FD;&#x591F;&#x81EA;&#x52A8;&#x6E05;&#x7406;&#x5E76;&#x79FB;&#x9664;&#x4E4B;&#x3002;&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x53EF;&#x4EE5;&#x8C03;&#x7528;pthread_detach()&#x5E76;&#x5411;thread&#x53C2;&#x6570;&#x4F20;&#x5165;&#x6307;&#x5B9A;&#x7EBF;&#x7A0B;&#x7684;&#x6807;&#x8BC6;&#x7B26;&#xFF0C;&#x5C06;&#x8BE5;&#x7EBF;&#x7A0B;&#x6807;&#x8BB0;&#x4E3A;&#x5904;&#x4E8E;&#x5206;&#x79BB;&#xFF08;detached&#xFF09;&#x72B6;&#x6001;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;pthread.h&gt;</span>  </span>

<span class="token keyword">int</span> <span class="token function">pthread_detach</span><span class="token punctuation">(</span>pthread_t pthread<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x5982;&#x4E0B;&#x4F8B;&#x6240;&#x793A;&#xFF0C;&#x4F7F;&#x7528;pthread_detach()&#xFF0C;&#x7EBF;&#x7A0B;&#x53EF;&#x4EE5;&#x81EA;&#x884C;&#x5206;&#x79BB;&#xFF1A;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token function">pthread_detach</span><span class="token punctuation">(</span><span class="token function">pthread_self</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>&#x4E00;&#x65E6;&#x7EBF;&#x7A0B;&#x5904;&#x4E8E;&#x5206;&#x79BB;&#x72B6;&#x6001;&#xFF0C;&#x5C31;&#x4E0D;&#x80FD;&#x518D;&#x4F7F;&#x7528;pthread_join()&#x6765;&#x83B7;&#x53D6;&#x5176;&#x72B6;&#x6001;&#xFF0C;&#x4E5F;&#x65E0;&#x6CD5;&#x4F7F;&#x5176;&#x91CD;&#x8FD4;&#x201C;&#x53EF;&#x8FDE;&#x63A5;&#x201D;&#x72B6;&#x6001;&#x3002;<br>&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x8C03;&#x7528;&#x4E86;exit()&#xFF0C;&#x6216;&#x662F;&#x4E3B;&#x7EBF;&#x7A0B;&#x6267;&#x884C;return&#x8BED;&#x53E5;&#x65F6;&#xFF0C;&#x5373;&#x4FBF;&#x906D;&#x5230;&#x5206;&#x79BB;&#x7684;&#x7EBF;&#x7A0B;&#x4E5F;&#x8FD8;&#x662F;&#x4F1A;&#x53D7;&#x5230;&#x5F71;&#x54CD;&#x3002;&#x6B64;&#x65F6;&#xFF0C;&#x4E0D;&#x7BA1;&#x7EBF;&#x7A0B;&#x5904;&#x4E8E;&#x53EF;&#x8FDE;&#x63A5;&#x72B6;&#x6001;&#x8FD8;&#x662F;&#x5DF2;&#x5206;&#x79BB;&#x72B6;&#x6001;&#xFF0C;&#x8FDB;&#x7A0B;&#x7684;&#x6240;&#x6709;&#x7EBF;&#x7A0B;&#x4F1A;&#x7ACB;&#x5373;&#x7EC8;&#x6B62;&#x3002;&#x6362;&#x8A00;&#x4E4B;&#xFF0C;pthread_detach()&#x53EA;&#x662F;&#x63A7;&#x5236;&#x7EBF;&#x7A0B;&#x7EC8;&#x6B62;&#x4E4B;&#x540E;&#x6240;&#x53D1;&#x751F;&#x7684;&#x4E8B;&#x60C5;&#xFF0C;&#x800C;&#x975E;&#x4F55;&#x65F6;&#x6216;&#x5982;&#x4F55;&#x7EC8;&#x6B62;&#x7EBF;&#x7A0B;&#x3002;</p>
<h2 id="&#x7EBF;&#x7A0B;&#x5C5E;&#x6027;"><a href="#&#x7EBF;&#x7A0B;&#x5C5E;&#x6027;" class="headerlink" title="&#x7EBF;&#x7A0B;&#x5C5E;&#x6027;"></a>&#x7EBF;&#x7A0B;&#x5C5E;&#x6027;</h2><p>&#x524D;&#x9762;&#x5DF2;&#x7136;&#x63D0;&#x53CA;pthread_create()&#x4E2D;&#x7C7B;&#x578B;&#x4E3A;pthread_attr_t&#x7684;attr&#x53C2;&#x6570;&#xFF0C;&#x53EF;&#x5229;&#x7528;&#x5176;&#x5728;&#x521B;&#x5EFA;&#x7EBF;&#x7A0B;&#x65F6;&#x6307;&#x5B9A;&#x65B0;&#x7EBF;&#x7A0B;&#x7684;&#x5C5E;&#x6027;&#x3002;</p>
<h2 id="&#x7EBF;&#x7A0B;VS&#x8FDB;&#x7A0B;"><a href="#&#x7EBF;&#x7A0B;VS&#x8FDB;&#x7A0B;" class="headerlink" title="&#x7EBF;&#x7A0B;VS&#x8FDB;&#x7A0B;"></a>&#x7EBF;&#x7A0B;VS&#x8FDB;&#x7A0B;</h2><p>&#x5C06;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5B9E;&#x73B0;&#x4E3A;&#x4E00;&#x7EC4;&#x7EBF;&#x7A0B;&#x8FD8;&#x662F;&#x8FDB;&#x7A0B;&#xFF1F;&#x672C;&#x8282;&#x5C06;&#x7B80;&#x5355;&#x8003;&#x8651;&#x4E00;&#x4E0B;&#x53EF;&#x80FD;&#x5F71;&#x54CD;&#x8FD9;&#x4E00;&#x51B3;&#x5B9A;&#x7684;&#x90E8;&#x5206;&#x56E0;&#x7D20;&#x3002;&#x5148;&#x4ECE;&#x591A;&#x7EBF;&#x7A0B;&#x65B9;&#x6CD5;&#x7684;&#x4F18;&#x70B9;&#x5F00;&#x59CB;&#x3002;</p>
<ul>
<li>&#x7EBF;&#x7A0B;&#x95F4;&#x7684;&#x6570;&#x636E;&#x5171;&#x4EAB;&#x5F88;&#x7B80;&#x5355;&#x3002;&#x76F8;&#x5F62;&#x4E4B;&#x4E0B;&#xFF0C;&#x8FDB;&#x7A0B;&#x95F4;&#x7684;&#x6570;&#x636E;&#x5171;&#x4EAB;&#x9700;&#x8981;&#x66F4;&#x591A;&#x7684;&#x6295;&#x5165;&#x3002;&#xFF08;&#x4F8B;&#x5982;&#xFF0C;&#x521B;&#x5EFA;&#x5171;&#x4EAB;&#x5185;&#x5B58;&#x6BB5;&#x6216;&#x8005;&#x4F7F;&#x7528;&#x7BA1;&#x9053;pipe&#xFF09;&#x3002;</li>
<li>&#x521B;&#x5EFA;&#x7EBF;&#x7A0B;&#x8981;&#x5FEB;&#x4E8E;&#x521B;&#x5EFA;&#x8FDB;&#x7A0B;&#x3002;&#x7EBF;&#x7A0B;&#x95F4;&#x7684;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;&#xFF08;context-switch&#xFF09;&#xFF0C;&#x5176;&#x6D88;&#x8017;&#x65F6;&#x95F4;&#x4E00;&#x822C;&#x4E5F;&#x6BD4;&#x8FDB;&#x7A0B;&#x8981;&#x77ED;&#x3002;</li>
</ul>
<p>&#x7EBF;&#x7A0B;&#x76F8;&#x5BF9;&#x4E8E;&#x8FDB;&#x7A0B;&#x7684;&#x4E00;&#x4E9B;&#x7F3A;&#x70B9;&#x5982;&#x4E0B;&#x6240;&#x793A;&#x3002;</p>
<ul>
<li>&#x591A;&#x7EBF;&#x7A0B;&#x7F16;&#x7A0B;&#x65F6;&#xFF0C;&#x9700;&#x8981;&#x786E;&#x4FDD;&#x8C03;&#x7528;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#xFF08;thread-safe&#xFF09;&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x6216;&#x8005;&#x4EE5;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x8C03;&#x7528;&#x51FD;&#x6570;&#x3002;&#xFF08;31.1&#x8282;&#x5C06;&#x8BA8;&#x8BBA;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#x6982;&#x5FF5;&#x3002;&#xFF09;&#x591A;&#x8FDB;&#x7A0B;&#x5E94;&#x7528;&#x5219;&#x65E0;&#x9700;&#x5173;&#x6CE8;&#x8FD9;&#x4E9B;&#x3002;</li>
<li>&#x67D0;&#x4E2A;&#x7EBF;&#x7A0B;&#x4E2D;&#x7684;bug&#xFF08;&#x4F8B;&#x5982;&#xFF0C;&#x901A;&#x8FC7;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#x7684;&#x6307;&#x9488;&#x6765;&#x4FEE;&#x6539;&#x5185;&#x5B58;&#xFF09;&#x53EF;&#x80FD;&#x4F1A;&#x5371;&#x53CA;&#x8BE5;&#x8FDB;&#x7A0B;&#x7684;&#x6240;&#x6709;&#x7EBF;&#x7A0B;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x4EEC;&#x5171;&#x4EAB;&#x7740;&#x76F8;&#x540C;&#x7684;&#x5730;&#x5740;&#x7A7A;&#x95F4;&#x548C;&#x5176;&#x4ED6;&#x5C5E;&#x6027;&#x3002;&#x76F8;&#x6BD4;&#x4E4B;&#x4E0B;&#xFF0C;&#x8FDB;&#x7A0B;&#x95F4;&#x7684;&#x9694;&#x79BB;&#x66F4;&#x5F7B;&#x5E95;&#x3002;</li>
<li>&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x90FD;&#x5728;&#x4E89;&#x7528;&#x5BBF;&#x4E3B;&#x8FDB;&#x7A0B;&#xFF08;host&#x3000;process&#xFF09;&#x4E2D;&#x6709;&#x9650;&#x7684;&#x865A;&#x62DF;&#x5730;&#x5740;&#x7A7A;&#x95F4;&#x3002;&#x7279;&#x522B;&#x662F;&#xFF0C;&#x4E00;&#x65E6;&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x6808;&#x4EE5;&#x53CA;&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;&#xFF08;&#x6216;&#x7EBF;&#x7A0B;&#x672C;&#x5730;&#x5B58;&#x50A8;&#xFF09;&#x6D88;&#x8017;&#x6389;&#x8FDB;&#x7A0B;&#x865A;&#x62DF;&#x5730;&#x5740;&#x7A7A;&#x95F4;&#x7684;&#x4E00;&#x90E8;&#x5206;&#xFF0C;&#x5219;&#x540E;&#x7EED;&#x7EBF;&#x7A0B;&#x5C06;&#x65E0;&#x7F18;&#x4F7F;&#x7528;&#x8FD9;&#x4E9B;&#x533A;&#x57DF;&#x3002;&#x867D;&#x7136;&#x6709;&#x6548;&#x5730;&#x5740;&#x7A7A;&#x95F4;&#x5F88;&#x5927;&#xFF08;&#x4F8B;&#x5982;&#xFF0C;&#x5728;x86-32&#x5E73;&#x53F0;&#x4E0A;&#x901A;&#x5E38;&#x6709;3GB&#xFF09;&#xFF0C;&#x4F46;&#x5F53;&#x8FDB;&#x7A0B;&#x5206;&#x914D;&#x5927;&#x91CF;&#x7EBF;&#x7A0B;&#xFF0C;&#x4EA6;&#x6216;&#x7EBF;&#x7A0B;&#x4F7F;&#x7528;&#x5927;&#x91CF;&#x5185;&#x5B58;&#x65F6;&#xFF0C;&#x8FD9;&#x4E00;&#x56E0;&#x7D20;&#x7684;&#x9650;&#x5236;&#x4F5C;&#x7528;&#x4E5F;&#x5C31;&#x7A81;&#x663E;&#x51FA;&#x6765;&#x3002;&#x4E0E;&#x4E4B;&#x76F8;&#x53CD;&#xFF0C;&#x6BCF;&#x4E2A;&#x8FDB;&#x7A0B;&#x90FD;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5168;&#x90E8;&#x7684;&#x6709;&#x6548;&#x865A;&#x62DF;&#x5185;&#x5B58;&#xFF0C;&#x4EC5;&#x53D7;&#x5236;&#x4E8E;&#x5B9E;&#x9645;&#x5185;&#x5B58;&#x548C;&#x4EA4;&#x6362;&#xFF08;swap&#xFF09;&#x7A7A;&#x95F4;&#x3002;</li>
</ul>
<p>&#x5F71;&#x54CD;&#x9009;&#x62E9;&#x7684;&#x8FD8;&#x6709;&#x5982;&#x4E0B;&#x51E0;&#x70B9;&#x3002;</p>
<ul>
<li>&#x5728;&#x591A;&#x7EBF;&#x7A0B;&#x5E94;&#x7528;&#x4E2D;&#x5904;&#x7406;&#x4FE1;&#x53F7;&#xFF0C;&#x9700;&#x8981;&#x5C0F;&#x5FC3;&#x8BBE;&#x8BA1;&#x3002;&#xFF08;&#x4F5C;&#x4E3A;&#x901A;&#x5219;&#xFF0C;&#x4E00;&#x822C;&#x5EFA;&#x8BAE;&#x5728;&#x591A;&#x7EBF;&#x7A0B;&#x7A0B;&#x5E8F;&#x4E2D;&#x907F;&#x514D;&#x4F7F;&#x7528;&#x4FE1;&#x53F7;&#x3002;&#xFF09;</li>
<li>&#x5728;&#x591A;&#x7EBF;&#x7A0B;&#x5E94;&#x7528;&#x4E2D;&#xFF0C;&#x6240;&#x6709;&#x7EBF;&#x7A0B;&#x5FC5;&#x987B;&#x8FD0;&#x884C;&#x540C;&#x4E00;&#x4E2A;&#x7A0B;&#x5E8F;&#xFF08;&#x5C3D;&#x7BA1;&#x53EF;&#x80FD;&#x662F;&#x4F4D;&#x4E8E;&#x4E0D;&#x540C;&#x51FD;&#x6570;&#x4E2D;&#xFF09;&#x3002;&#x5BF9;&#x4E8E;&#x591A;&#x8FDB;&#x7A0B;&#x5E94;&#x7528;&#xFF0C;&#x4E0D;&#x540C;&#x7684;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x8FD0;&#x884C;&#x4E0D;&#x540C;&#x7684;&#x7A0B;&#x5E8F;&#x3002;</li>
<li>&#x9664;&#x4E86;&#x6570;&#x636E;&#xFF0C;&#x7EBF;&#x7A0B;&#x8FD8;&#x53EF;&#x4EE5;&#x5171;&#x4EAB;&#x67D0;&#x4E9B;&#x5176;&#x4ED6;&#x4FE1;&#x606F;&#xFF08;&#x4F8B;&#x5982;&#xFF0C;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x3001;&#x4FE1;&#x53F7;&#x5904;&#x7F6E;&#x3001;&#x5F53;&#x524D;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;&#xFF0C;&#x4EE5;&#x53CA;&#x7528;&#x6237;ID&#x548C;&#x7EC4;ID&#xFF09;&#x3002;&#x4F18;&#x52A3;&#x4E4B;&#x5224;&#xFF0C;&#x89C6;&#x5E94;&#x7528;&#x800C;&#x5B9A;&#x3002;</li>
</ul>
<h1 id="&#x7EBF;&#x7A0B;&#xFF1A;&#x7EBF;&#x7A0B;&#x540C;&#x6B65;"><a href="#&#x7EBF;&#x7A0B;&#xFF1A;&#x7EBF;&#x7A0B;&#x540C;&#x6B65;" class="headerlink" title="&#x7EBF;&#x7A0B;&#xFF1A;&#x7EBF;&#x7A0B;&#x540C;&#x6B65;"></a>&#x7EBF;&#x7A0B;&#xFF1A;&#x7EBF;&#x7A0B;&#x540C;&#x6B65;</h1><h2 id="&#x4FDD;&#x62A4;&#x5BF9;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#x7684;&#x8BBF;&#x95EE;&#xFF1A;&#x4E92;&#x65A5;&#x91CF;"><a href="#&#x4FDD;&#x62A4;&#x5BF9;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#x7684;&#x8BBF;&#x95EE;&#xFF1A;&#x4E92;&#x65A5;&#x91CF;" class="headerlink" title="&#x4FDD;&#x62A4;&#x5BF9;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#x7684;&#x8BBF;&#x95EE;&#xFF1A;&#x4E92;&#x65A5;&#x91CF;"></a>&#x4FDD;&#x62A4;&#x5BF9;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#x7684;&#x8BBF;&#x95EE;&#xFF1A;&#x4E92;&#x65A5;&#x91CF;</h2><p>&#x7EBF;&#x7A0B;&#x7684;&#x4E3B;&#x8981;&#x4F18;&#x52BF;&#x5728;&#x4E8E;&#xFF0C;&#x80FD;&#x591F;&#x901A;&#x8FC7;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x6765;&#x5171;&#x4EAB;&#x4FE1;&#x606F;&#x3002;&#x4E0D;&#x8FC7;&#xFF0C;&#x8FD9;&#x79CD;&#x4FBF;&#x6377;&#x7684;&#x5171;&#x4EAB;&#x662F;&#x6709;&#x4EE3;&#x4EF7;&#x7684;&#xFF1A;&#x5FC5;&#x987B;&#x786E;&#x4FDD;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x4E0D;&#x4F1A;&#x540C;&#x65F6;&#x4FEE;&#x6539;&#x540C;&#x4E00;&#x53D8;&#x91CF;&#xFF0C;&#x6216;&#x8005;&#x67D0;&#x4E00;&#x7EBF;&#x7A0B;&#x4E0D;&#x4F1A;&#x8BFB;&#x53D6;&#x6B63;&#x7531;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x4FEE;&#x6539;&#x7684;&#x53D8;&#x91CF;&#x3002;&#x672F;&#x8BED;&#x4E34;&#x754C;&#x533A;&#xFF08;critical section&#xFF09;&#x662F;&#x6307;&#x8BBF;&#x95EE;&#x67D0;&#x4E00;&#x5171;&#x4EAB;&#x8D44;&#x6E90;&#x7684;&#x4EE3;&#x7801;&#x7247;&#x6BB5;&#xFF0C;&#x5E76;&#x4E14;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x7684;&#x6267;&#x884C;&#x5E94;&#x4E3A;&#x539F;&#x5B50;&#xFF08;atomic&#xFF09;&#x64CD;&#x4F5C;&#xFF0C;&#x4EA6;&#x5373;&#xFF0C;&#x540C;&#x65F6;&#x8BBF;&#x95EE;&#x540C;&#x4E00;&#x5171;&#x4EAB;&#x8D44;&#x6E90;&#x7684;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x4E0D;&#x5E94;&#x4E2D;&#x65AD;&#x8BE5;&#x7247;&#x6BB5;&#x7684;&#x6267;&#x884C;&#x3002;</p>
<p>&#x4EE5;&#x975E;&#x539F;&#x5B50;&#x65B9;&#x5F0F;&#x8BBF;&#x95EE;&#x4F1A;&#x53D1;&#x751F;&#x5982;&#x4E0B;&#x95EE;&#x9898;&#x3002;<br></p><div class="amp-img-wrapper"><amp-img src="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1581562108617.png?x-oss-process=image/resize,m_lfit,h_450" width="457" height="450" layout="responsive"></amp-img></div><br>&#x8FD9;&#x4E00;&#x884C;&#x4E3A;&#x7684;&#x4E0D;&#x786E;&#x5B9A;&#x6027;&#xFF0C;&#x5B9E;&#x5E94;&#x5F52;&#x548E;&#x4E8E;&#x5185;&#x6838;CPU&#x8C03;&#x5EA6;&#x51B3;&#x5B9A;&#x7684;&#x96BE;&#x4EE5;&#x9884;&#x89C1;&#x3002;&#x82E5;&#x5728;&#x590D;&#x6742;&#x7A0B;&#x5E8F;&#x4E2D;&#x53D1;&#x751F;&#x8FD9;&#x4E00;&#x4E0D;&#x786E;&#x5B9A;&#x884C;&#x4E3A;&#xFF0C;&#x5219;&#x610F;&#x5473;&#x7740;&#x6B64;&#x7C7B;&#x9519;&#x8BEF;&#x5C06;&#x5076;&#x5C14;&#x53D1;&#x4F5C;&#xFF0C;&#x96BE;&#x4EE5;&#x91CD;&#x73B0;&#xFF0C;&#x56E0;&#x6B64;&#x4E5F;&#x5F88;&#x96BE;&#x53D1;&#x73B0;&#x3002;
<p>&#x4E3A;&#x907F;&#x514D;&#x7EBF;&#x7A0B;&#x66F4;&#x65B0;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#x65F6;&#x6240;&#x51FA;&#x73B0;&#x95EE;&#x9898;&#xFF0C;&#x5FC5;&#x987B;&#x4F7F;&#x7528;&#x4E92;&#x65A5;&#x91CF;&#xFF08;mutex&#x662F;mutual exclusion&#x7684;&#x7F29;&#x5199;&#xFF09;&#x6765;&#x786E;&#x4FDD;&#x540C;&#x65F6;&#x4EC5;&#x6709;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;&#x67D0;&#x9879;&#x5171;&#x4EAB;&#x8D44;&#x6E90;&#x3002;&#x66F4;&#x4E3A;&#x5168;&#x9762;&#x7684;&#x8BF4;&#x6CD5;&#x662F;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4E92;&#x65A5;&#x91CF;&#x6765;&#x4FDD;&#x8BC1;&#x5BF9;&#x4EFB;&#x610F;&#x5171;&#x4EAB;&#x8D44;&#x6E90;&#x7684;&#x539F;&#x5B50;&#x8BBF;&#x95EE;&#xFF0C;&#x800C;&#x4FDD;&#x62A4;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#x662F;&#x5176;&#x6700;&#x5E38;&#x89C1;&#x7684;&#x7528;&#x6CD5;&#x3002;</p>
<p>&#x4E92;&#x65A5;&#x91CF;&#x6709;&#x4E24;&#x79CD;&#x72B6;&#x6001;&#xFF1A;&#x5DF2;&#x9501;&#x5B9A;&#xFF08;locked&#xFF09;&#x548C;&#x672A;&#x9501;&#x5B9A;&#xFF08;unlocked&#xFF09;&#x3002;&#x4EFB;&#x4F55;&#x65F6;&#x5019;&#xFF0C;&#x81F3;&#x591A;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x53EF;&#x4EE5;&#x9501;&#x5B9A;&#x8BE5;&#x4E92;&#x65A5;&#x91CF;&#x3002;&#x8BD5;&#x56FE;&#x5BF9;&#x5DF2;&#x7ECF;&#x9501;&#x5B9A;&#x7684;&#x67D0;&#x4E00;&#x4E92;&#x65A5;&#x91CF;&#x518D;&#x6B21;&#x52A0;&#x9501;&#xFF0C;&#x5C06;&#x53EF;&#x80FD;&#x963B;&#x585E;&#x7EBF;&#x7A0B;&#x6216;&#x8005;&#x62A5;&#x9519;&#x5931;&#x8D25;&#xFF0C;&#x5177;&#x4F53;&#x53D6;&#x51B3;&#x4E8E;&#x52A0;&#x9501;&#x65F6;&#x4F7F;&#x7528;&#x7684;&#x65B9;&#x6CD5;&#x3002;</p>
<p>&#x4E00;&#x65E6;&#x7EBF;&#x7A0B;&#x9501;&#x5B9A;&#x4E92;&#x65A5;&#x91CF;&#xFF0C;&#x968F;&#x5373;&#x6210;&#x4E3A;&#x8BE5;&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x6240;&#x6709;&#x8005;&#x3002;&#x53EA;&#x6709;&#x6240;&#x6709;&#x8005;&#x624D;&#x80FD;&#x7ED9;&#x4E92;&#x65A5;&#x91CF;&#x89E3;&#x9501;&#x3002;&#x8FD9;&#x4E00;&#x5C5E;&#x6027;&#x6539;&#x5584;&#x4E86;&#x4F7F;&#x7528;&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x4EE3;&#x7801;&#x7ED3;&#x6784;&#xFF0C;&#x4E5F;&#x987E;&#x53CA;&#x5230;&#x5BF9;&#x4E92;&#x65A5;&#x91CF;&#x5B9E;&#x73B0;&#x7684;&#x4F18;&#x5316;&#x3002;&#x56E0;&#x4E3A;&#x6240;&#x6709;&#x6743;&#x7684;&#x5173;&#x7CFB;&#xFF0C;&#x6709;&#x65F6;&#x4F1A;&#x4F7F;&#x7528;&#x672F;&#x8BED;&#x83B7;&#x53D6;&#xFF08;acquire&#xFF09;&#x548C;&#x91CA;&#x653E;&#xFF08;release&#xFF09;&#x6765;&#x66FF;&#x4EE3;&#x52A0;&#x9501;&#x548C;&#x89E3;&#x9501;&#x3002;<br>&#x4E00;&#x822C;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5BF9;&#x6BCF;&#x4E00;&#x5171;&#x4EAB;&#x8D44;&#x6E90;&#xFF08;&#x53EF;&#x80FD;&#x7531;&#x591A;&#x4E2A;&#x76F8;&#x5173;&#x53D8;&#x91CF;&#x7EC4;&#x6210;&#xFF09;&#x4F1A;&#x4F7F;&#x7528;&#x4E0D;&#x540C;&#x7684;&#x4E92;&#x65A5;&#x91CF;&#xFF0C;&#x6BCF;&#x4E00;&#x7EBF;&#x7A0B;&#x5728;&#x8BBF;&#x95EE;&#x540C;&#x4E00;&#x8D44;&#x6E90;&#x65F6;&#x5C06;&#x91C7;&#x7528;&#x5982;&#x4E0B;&#x534F;&#x8BAE;&#x3002;</p>
<ul>
<li>&#x9488;&#x5BF9;&#x5171;&#x4EAB;&#x8D44;&#x6E90;&#x9501;&#x5B9A;&#x4E92;&#x65A5;&#x91CF;&#x3002;</li>
<li>&#x8BBF;&#x95EE;&#x5171;&#x4EAB;&#x8D44;&#x6E90;&#x3002;</li>
<li>&#x5BF9;&#x4E92;&#x65A5;&#x91CF;&#x89E3;&#x9501;&#x3002;</li>
</ul>
<p>&#x5982;&#x679C;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x8BD5;&#x56FE;&#x6267;&#x884C;&#x8FD9;&#x4E00;&#x4EE3;&#x7801;&#x5757;&#xFF08;&#x4E00;&#x4E2A;&#x4E34;&#x754C;&#x533A;&#xFF09;&#xFF0C;&#x4E8B;&#x5B9E;&#x4E0A;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x80FD;&#x591F;&#x6301;&#x6709;&#x8BE5;&#x4E92;&#x65A5;&#x91CF;&#xFF08;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x5C06;&#x906D;&#x5230;&#x963B;&#x585E;&#xFF09;&#xFF0C;&#x5373;&#x540C;&#x65F6;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x80FD;&#x591F;&#x8FDB;&#x5165;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x533A;&#x57DF;&#x3002;<br></p><div class="amp-img-wrapper"><amp-img src="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1581562386463.png?x-oss-process=image/resize,m_lfit,h_450" width="553" height="450" layout="responsive"></amp-img></div><br>&#x6700;&#x540E;&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x4F7F;&#x7528;&#x4E92;&#x65A5;&#x9501;&#x4EC5;&#x662F;&#x4E00;&#x79CD;&#x5EFA;&#x8BAE;&#xFF0C;&#x800C;&#x975E;&#x5F3A;&#x5236;&#x3002;&#x4EA6;&#x5373;&#xFF0C;&#x7EBF;&#x7A0B;&#x53EF;&#x4EE5;&#x8003;&#x8651;&#x4E0D;&#x4F7F;&#x7528;&#x4E92;&#x65A5;&#x91CF;&#x800C;&#x4EC5;&#x8BBF;&#x95EE;&#x76F8;&#x5E94;&#x7684;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#x3002;&#x4E3A;&#x4E86;&#x5B89;&#x5168;&#x5730;&#x5904;&#x7406;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#xFF0C;&#x6240;&#x6709;&#x7EBF;&#x7A0B;&#x5728;&#x4F7F;&#x7528;&#x4E92;&#x65A5;&#x91CF;&#x65F6;&#x5FC5;&#x987B;&#x4E92;&#x76F8;&#x534F;&#x8C03;&#xFF0C;&#x9075;&#x5B88;&#x65E2;&#x5B9A;&#x7684;&#x9501;&#x5B9A;&#x89C4;&#x5219;&#x3002;
<h3 id="&#x9759;&#x6001;&#x5206;&#x914D;&#x7684;&#x4E92;&#x65A5;&#x91CF;"><a href="#&#x9759;&#x6001;&#x5206;&#x914D;&#x7684;&#x4E92;&#x65A5;&#x91CF;" class="headerlink" title="&#x9759;&#x6001;&#x5206;&#x914D;&#x7684;&#x4E92;&#x65A5;&#x91CF;"></a>&#x9759;&#x6001;&#x5206;&#x914D;&#x7684;&#x4E92;&#x65A5;&#x91CF;</h3><p>&#x4E92;&#x65A5;&#x91CF;&#x65E2;&#x53EF;&#x4EE5;&#x50CF;&#x9759;&#x6001;&#x53D8;&#x91CF;&#x90A3;&#x6837;&#x5206;&#x914D;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x52A8;&#x6001;&#x521B;&#x5EFA;&#xFF08;&#x4F8B;&#x5982;&#xFF0C;&#x901A;&#x8FC7;malloc()&#x5728;&#x4E00;&#x5757;&#x5185;&#x5B58;&#x4E2D;&#x5206;&#x914D;&#xFF09;&#x3002;&#x52A8;&#x6001;&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x521B;&#x5EFA;&#x7A0D;&#x5FAE;&#x6709;&#x4E9B;&#x590D;&#x6742;&#xFF0C;&#x5C06;&#x5EF6;&#x540E;&#x8BA8;&#x8BBA;&#x3002;</p>
<p>&#x4E92;&#x65A5;&#x91CF;&#x662F;&#x5C5E;&#x4E8E;pthread_mutex_t&#x7C7B;&#x578B;&#x7684;&#x53D8;&#x91CF;&#x3002;&#x5728;&#x4F7F;&#x7528;&#x4E4B;&#x524D;&#x5FC5;&#x987B;&#x5BF9;&#x5176;&#x521D;&#x59CB;&#x5316;&#x3002;&#x5BF9;&#x4E8E;&#x9759;&#x6001;&#x5206;&#x914D;&#x7684;&#x4E92;&#x65A5;&#x91CF;&#x800C;&#x8A00;&#xFF0C;&#x53EF;&#x5982;&#x4E0B;&#x4F8B;&#x6240;&#x793A;&#xFF0C;&#x5C06;PTHREAD_MUTEX_INITIALIZER&#x8D4B;&#x7ED9;&#x4E92;&#x65A5;&#x91CF;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c">pthread_mutex_t mtx<span class="token operator">=</span>PTHREAD_MUTEX_INITIALIZER<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="&#x52A0;&#x9501;&#x548C;&#x89E3;&#x9501;&#x4E92;&#x65A5;&#x91CF;"><a href="#&#x52A0;&#x9501;&#x548C;&#x89E3;&#x9501;&#x4E92;&#x65A5;&#x91CF;" class="headerlink" title="&#x52A0;&#x9501;&#x548C;&#x89E3;&#x9501;&#x4E92;&#x65A5;&#x91CF;"></a>&#x52A0;&#x9501;&#x548C;&#x89E3;&#x9501;&#x4E92;&#x65A5;&#x91CF;</h3><p>&#x521D;&#x59CB;&#x5316;&#x4E4B;&#x540E;&#xFF0C;&#x4E92;&#x65A5;&#x91CF;&#x5904;&#x4E8E;&#x672A;&#x9501;&#x5B9A;&#x72B6;&#x6001;&#x3002;&#x51FD;&#x6570;pthread_mutex_lock()&#x53EF;&#x4EE5;&#x9501;&#x5B9A;&#x67D0;&#x4E00;&#x4E92;&#x65A5;&#x91CF;&#xFF0C;&#x800C;&#x51FD;&#x6570;pthread_mutex_unlock()&#x5219;&#x53EF;&#x4EE5;&#x5C06;&#x4E00;&#x4E2A;&#x4E92;&#x65A5;&#x91CF;&#x89E3;&#x9501;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;pthread.h&gt;</span> </span>

<span class="token keyword">int</span> <span class="token function">pthread_mutex_lock</span><span class="token punctuation">(</span>pthread_mutex_t <span class="token operator">*</span>mutex<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">pthread_mutex_unlock</span><span class="token punctuation">(</span>pthread_mutex_t <span class="token operator">*</span>mutex<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x8981;&#x9501;&#x5B9A;&#x4E92;&#x65A5;&#x91CF;&#xFF0C;&#x5728;&#x8C03;&#x7528;pthread_mutex_lock()&#x65F6;&#x9700;&#x8981;&#x6307;&#x5B9A;&#x4E92;&#x65A5;&#x91CF;&#x3002;&#x5982;&#x679C;&#x4E92;&#x65A5;&#x91CF;&#x5F53;&#x524D;&#x5904;&#x4E8E;&#x672A;&#x9501;&#x5B9A;&#x72B6;&#x6001;&#xFF0C;&#x8BE5;&#x8C03;&#x7528;&#x5C06;&#x9501;&#x5B9A;&#x4E92;&#x65A5;&#x91CF;&#x5E76;&#x7ACB;&#x5373;&#x8FD4;&#x56DE;&#x3002;&#x5982;&#x679C;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x5DF2;&#x7ECF;&#x9501;&#x5B9A;&#x4E86;&#x8FD9;&#x4E00;&#x4E92;&#x65A5;&#x91CF;&#xFF0C;&#x90A3;&#x4E48;pthread_mutex_lock()&#x8C03;&#x7528;&#x4F1A;&#x4E00;&#x76F4;&#x5835;&#x585E;&#xFF0C;&#x76F4;&#x81F3;&#x8BE5;&#x4E92;&#x65A5;&#x91CF;&#x88AB;&#x89E3;&#x9501;&#xFF0C;&#x5230;&#x90A3;&#x65F6;&#xFF0C;&#x8C03;&#x7528;&#x5C06;&#x9501;&#x5B9A;&#x4E92;&#x65A5;&#x91CF;&#x5E76;&#x8FD4;&#x56DE;&#x3002;</p>
<p>&#x5982;&#x679C;&#x53D1;&#x8D77;pthread_mutex_lock()&#x8C03;&#x7528;&#x7684;&#x7EBF;&#x7A0B;&#x81EA;&#x8EAB;&#x4E4B;&#x524D;&#x5DF2;&#x7136;&#x5C06;&#x76EE;&#x6807;&#x4E92;&#x65A5;&#x91CF;&#x9501;&#x5B9A;&#xFF0C;&#x5BF9;&#x4E8E;&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x9ED8;&#x8BA4;&#x7C7B;&#x578B;&#x800C;&#x8A00;&#xFF0C;&#x53EF;&#x80FD;&#x4F1A;&#x4EA7;&#x751F;&#x4E24;&#x79CD;&#x540E;&#x679C;&#x2014;&#x2014;&#x89C6;&#x5177;&#x4F53;&#x5B9E;&#x73B0;&#x800C;&#x5B9A;&#xFF1A;&#x7EBF;&#x7A0B;&#x9677;&#x5165;&#x6B7B;&#x9501;&#xFF08;deadlock&#xFF09;&#xFF0C;&#x56E0;&#x8BD5;&#x56FE;&#x9501;&#x5B9A;&#x5DF2;&#x4E3A;&#x81EA;&#x5DF1;&#x6240;&#x6301;&#x6709;&#x7684;&#x4E92;&#x65A5;&#x91CF;&#x800C;&#x906D;&#x5230;&#x963B;&#x585E;&#xFF1B;&#x6216;&#x8005;&#x8C03;&#x7528;&#x5931;&#x8D25;&#xFF0C;&#x8FD4;&#x56DE;EDEADLK&#x9519;&#x8BEF;&#x3002;&#x5728;Linux&#x4E0A;&#xFF0C;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#x7EBF;&#x7A0B;&#x4F1A;&#x53D1;&#x751F;&#x6B7B;&#x9501;&#x3002;<br>&#x51FD;&#x6570;pthread_mutex_unlock()&#x5C06;&#x89E3;&#x9501;&#x4E4B;&#x524D;&#x5DF2;&#x906D;&#x8C03;&#x7528;&#x7EBF;&#x7A0B;&#x9501;&#x5B9A;&#x7684;&#x4E92;&#x65A5;&#x91CF;&#x3002;&#x4EE5;&#x4E0B;&#x884C;&#x4E3A;&#x5747;&#x5C5E;&#x9519;&#x8BEF;&#xFF1A;&#x5BF9;&#x5904;&#x4E8E;&#x672A;&#x9501;&#x5B9A;&#x72B6;&#x6001;&#x7684;&#x4E92;&#x65A5;&#x91CF;&#x8FDB;&#x884C;&#x89E3;&#x9501;&#xFF0C;&#x6216;&#x8005;&#x89E3;&#x9501;&#x7531;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x9501;&#x5B9A;&#x7684;&#x4E92;&#x65A5;&#x91CF;&#x3002;</p>
<p>&#x5982;&#x679C;&#x6709;&#x4E0D;&#x6B62;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x5728;&#x7B49;&#x5F85;&#x83B7;&#x53D6;&#x7531;&#x51FD;&#x6570;pthread_mutex_unlock()&#x89E3;&#x9501;&#x7684;&#x4E92;&#x65A5;&#x91CF;&#xFF0C;&#x5219;&#x65E0;&#x6CD5;&#x5224;&#x65AD;&#x7A76;&#x7ADF;&#x54EA;&#x4E2A;&#x7EBF;&#x7A0B;&#x5C06;&#x5982;&#x613F;&#x4EE5;&#x507F;&#x3002;</p>
<h3 id="pthread-mutex-trylock-&#x548C;pthread-mutex-timedlock"><a href="#pthread-mutex-trylock-&#x548C;pthread-mutex-timedlock" class="headerlink" title="pthread_mutex_trylock()&#x548C;pthread_mutex_timedlock()"></a>pthread_mutex_trylock()&#x548C;pthread_mutex_timedlock()</h3><p>Pthreads API&#x63D0;&#x4F9B;&#x4E86;pthread_mutex_lock()&#x51FD;&#x6570;&#x7684;&#x4E24;&#x4E2A;&#x53D8;&#x4F53;&#xFF1A;pthread_mutex_trylock()&#x548C;pthread_mutex_timedlock()&#x3002;&#x53EF;&#x53C2;&#x8003;&#x624B;&#x518C;&#x9875;&#xFF08;manual page&#xFF09;&#x83B7;&#x53D6;&#x8FD9;&#x4E9B;&#x51FD;&#x6570;&#x7684;&#x539F;&#x578B;&#x3002;</p>
<p>&#x5982;&#x679C;&#x4FE1;&#x53F7;&#x91CF;&#x5DF2;&#x7136;&#x9501;&#x5B9A;&#xFF0C;&#x5BF9;&#x5176;&#x6267;&#x884C;&#x51FD;&#x6570;pthread_mutex_trylock()&#x4F1A;&#x5931;&#x8D25;&#x5E76;&#x8FD4;&#x56DE;EBUSY&#x9519;&#x8BEF;&#xFF0C;&#x9664;&#x6B64;&#x4E4B;&#x5916;&#xFF0C;&#x8BE5;&#x51FD;&#x6570;&#x4E0E;pthread_mutex_lock()&#x884C;&#x4E3A;&#x76F8;&#x540C;&#x3002;<br>&#x9664;&#x4E86;&#x8C03;&#x7528;&#x8005;&#x53EF;&#x4EE5;&#x6307;&#x5B9A;&#x4E00;&#x4E2A;&#x9644;&#x52A0;&#x53C2;&#x6570; abstime&#xFF08;&#x8BBE;&#x7F6E;&#x7EBF;&#x7A0B;&#x7B49;&#x5F85;&#x83B7;&#x53D6;&#x4E92;&#x65A5;&#x91CF;&#x65F6;&#x4F11;&#x7720;&#x7684;&#x65F6;&#x95F4;&#x9650;&#x5236;&#xFF09;&#x5916;&#xFF0C;&#x51FD;&#x6570;pthread_mutex_timedlock()&#x4E0E;pthread_mutex_lock()&#x6CA1;&#x6709;&#x5DEE;&#x522B;&#x3002;&#x5982;&#x679C;&#x53C2;&#x6570;abstime&#x6307;&#x5B9A;&#x7684;&#x65F6;&#x95F4;&#x95F4;&#x9694;&#x671F;&#x6EE1;&#xFF0C;&#x800C;&#x8C03;&#x7528;&#x7EBF;&#x7A0B;&#x53C8;&#x6CA1;&#x6709;&#x83B7;&#x5F97;&#x5BF9;&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x6240;&#x6709;&#x6743;&#xFF0C;&#x90A3;&#x4E48;&#x51FD;&#x6570;pthread_mutex_timedlock()&#x8FD4;&#x56DE;ETIMEDOUT&#x9519;&#x8BEF;&#x3002;</p>
<p>&#x51FD;&#x6570;pthread_mutex_trylock() &#x548C; pthread_mutex_timedlock()&#x6BD4;pthread_mutex_lock()&#x7684;&#x4F7F;&#x7528;&#x9891;&#x7387;&#x8981;&#x4F4E;&#x5F88;&#x591A;&#x3002;&#x5728;&#x5927;&#x591A;&#x6570;&#x7ECF;&#x8FC7;&#x826F;&#x597D;&#x8BBE;&#x8BA1;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E2D;&#xFF0C;&#x7EBF;&#x7A0B;&#x5BF9;&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x6301;&#x6709;&#x65F6;&#x95F4;&#x5E94;&#x5C3D;&#x53EF;&#x80FD;&#x77ED;&#xFF0C;&#x4EE5;&#x907F;&#x514D;&#x59A8;&#x788D;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x7684;&#x5E76;&#x53D1;&#x6267;&#x884C;&#x3002;&#x8FD9;&#x4E5F;&#x4FDD;&#x8BC1;&#x4E86;&#x906D;&#x5835;&#x585E;&#x7684;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x53EF;&#x4EE5;&#x5F88;&#x5FEB;&#x83B7;&#x53D6;&#x5BF9;&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x9501;&#x5B9A;&#x3002;&#x82E5;&#x67D0;&#x4E00;&#x7EBF;&#x7A0B;&#x4F7F;&#x7528;pthread_mutex_trylock()&#x5468;&#x671F;&#x6027;&#x5730;&#x8F6E;&#x8BE2;&#x662F;&#x5426;&#x53EF;&#x4EE5;&#x5BF9;&#x4E92;&#x65A5;&#x91CF;&#x52A0;&#x9501;&#xFF0C;&#x5219;&#x6709;&#x53EF;&#x80FD;&#x8981;&#x627F;&#x62C5;&#x8FD9;&#x6837;&#x7684;&#x98CE;&#x9669;&#xFF1A;&#x5F53;&#x961F;&#x5217;&#x4E2D;&#x7684;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x901A;&#x8FC7;&#x8C03;&#x7528;pthread_mutex_lock()&#x76F8;&#x7EE7;&#x83B7;&#x5F97;&#x5BF9;&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x8BBF;&#x95EE;&#x65F6;&#xFF0C;&#x8BE5;&#x7EBF;&#x7A0B;&#x5C06;&#x59CB;&#x7EC8;&#x4E0E;&#x6B64;&#x4E92;&#x65A5;&#x91CF;&#x65E0;&#x7F18;&#x3002;</p>
<h3 id="&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x6027;&#x80FD;"><a href="#&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x6027;&#x80FD;" class="headerlink" title="&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x6027;&#x80FD;"></a>&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x6027;&#x80FD;</h3><p>&#x4F7F;&#x7528;&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x5F00;&#x9500;&#x6709;&#x591A;&#x5927;&#xFF1F;&#x524D;&#x9762;&#x5DF2;&#x7ECF;&#x5C55;&#x793A;&#x4E86;&#x9012;&#x589E;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#x7A0B;&#x5E8F;&#x7684;&#x4E24;&#x4E2A;&#x4E0D;&#x540C;&#x7248;&#x672C;&#xFF1A;&#x6CA1;&#x6709;&#x4F7F;&#x7528;&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x7A0B;&#x5E8F;&#x6E05;&#x5355; 30-1 &#x548C;&#x4F7F;&#x7528;&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x7A0B;&#x5E8F;&#x6E05;&#x5355;30-2&#x3002;&#x5728;x86-32&#x67B6;&#x6784;&#x7684;Linux 2.6.31&#xFF08;&#x542B;NPTL&#xFF09;&#x7CFB;&#x7EDF;&#x4E0B;&#x8FD0;&#x884C;&#x8FD9;&#x4E24;&#x4E2A;&#x7A0B;&#x5E8F;&#xFF0C;&#x5982;&#x4EE4;&#x5355;&#x4E00;&#x7EBF;&#x7A0B;&#x5FAA;&#x73AF;1000&#x4E07;&#x6B21;&#xFF0C;&#x524D;&#x8005;&#x5171;&#x82B1;&#x8D39;&#x4E86;0.35&#x79D2;&#xFF08;&#x5E76;&#x4EA7;&#x751F;&#x9519;&#x8BEF;&#x7ED3;&#x679C;&#xFF09;&#xFF0C;&#x800C;&#x540E;&#x8005;&#x5219;&#x9700;&#x8981;3.1&#x79D2;&#x3002;</p>
<p>&#x4E4D;&#x770B;&#x8D77;&#x6765;&#xFF0C;&#x4EE3;&#x4EF7;&#x6781;&#x9AD8;&#x3002;&#x4E0D;&#x8FC7;&#xFF0C;&#x8003;&#x8651;&#x4E00;&#x4E0B;&#x524D;&#x8005;&#x6267;&#x884C;&#x7684;&#x4E3B;&#x5FAA;&#x73AF;&#x3002;&#x5728;&#x8BE5;&#x7248;&#x672C;&#x4E2D;&#xFF0C;&#x51FD;&#x6570;threadFunc()&#x4E8E;for&#x5FAA;&#x73AF;&#x4E2D;&#xFF0C;&#x5148;&#x9012;&#x589E;&#x5FAA;&#x73AF;&#x63A7;&#x5236;&#x53D8;&#x91CF;&#xFF0C;&#x518D;&#x5C06;&#x5176;&#x4E0E;&#x53E6;&#x4E00;&#x53D8;&#x91CF;&#x8FDB;&#x884C;&#x6BD4;&#x8F83;&#xFF0C;&#x968F;&#x540E;&#x6267;&#x884C;&#x4E24;&#x4E2A;&#x590D;&#x5236;&#x64CD;&#x4F5C;&#x548C;&#x4E00;&#x4E2A;&#x9012;&#x589E;&#x64CD;&#x4F5C;&#xFF0C;&#x6700;&#x540E;&#x8FD4;&#x56DE;&#x5FAA;&#x73AF;&#x8D77;&#x59CB;&#x5904;&#x5F00;&#x59CB;&#x4E0B;&#x4E00;&#x6B21;&#x5FAA;&#x73AF;&#x3002;&#x800C;&#x540E;&#x8005;&#x2014;&#x2014;&#x4F7F;&#x7528;&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x7248;&#x672C;&#x6267;&#x884C;&#x4E86;&#x76F8;&#x540C;&#x6B65;&#x9AA4;&#xFF0C;&#x4E0D;&#x8FC7;&#x5728;&#x6BCF;&#x6B21;&#x5FAA;&#x73AF;&#x7684;&#x524D;&#x540E;&#x591A;&#x4E86;&#x52A0;&#x9501;&#x548C;&#x89E3;&#x9501;&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x5DE5;&#x4F5C;&#x3002;&#x6362;&#x8A00;&#x4E4B;&#xFF0C;&#x5BF9;&#x4E92;&#x65A5;&#x91CF;&#x52A0;&#x9501;&#x548C;&#x89E3;&#x9501;&#x7684;&#x5F00;&#x9500;&#x7565;&#x4F4E;&#x4E8E;&#x7B2C;1&#x4E2A;&#x7A0B;&#x5E8F;&#x7684;10&#x6B21;&#x5FAA;&#x73AF;&#x64CD;&#x4F5C;&#x3002;&#x6210;&#x672C;&#x76F8;&#x5BF9;&#x6BD4;&#x8F83;&#x4F4E;&#x5EC9;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x5728;&#x901A;&#x5E38;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x7EBF;&#x7A0B;&#x4F1A;&#x82B1;&#x8D39;&#x66F4;&#x591A;&#x65F6;&#x95F4;&#x53BB;&#x505A;&#x5176;&#x4ED6;&#x5DE5;&#x4F5C;&#xFF0C;&#x5BF9;&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x52A0;&#x9501;&#x548C;&#x89E3;&#x9501;&#x64CD;&#x4F5C;&#x76F8;&#x5BF9;&#x8981;&#x5C11;&#x5F97;&#x591A;&#xFF0C;&#x56E0;&#x6B64;&#x4F7F;&#x7528;&#x4E92;&#x65A5;&#x91CF;&#x5BF9;&#x4E8E;&#x5927;&#x90E8;&#x5206;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x6027;&#x80FD;&#x5E76;&#x65E0;&#x663E;&#x8457;&#x5F71;&#x54CD;&#x3002;</p>
<p>&#x8FDB;&#x800C;&#x8A00;&#x4E4B;&#xFF0C;&#x5728;&#x76F8;&#x540C;&#x7CFB;&#x7EDF;&#x4E0A;&#x8FD0;&#x884C;&#x4E00;&#x4E9B;&#x7B80;&#x5355;&#x7684;&#x6D4B;&#x8BD5;&#x7A0B;&#x5E8F;&#xFF0C;&#x7ED3;&#x679C;&#x663E;&#x793A;&#xFF0C;&#x5982;&#x5C06;&#x4F7F;&#x7528;&#x51FD;&#x6570; fcntl()&#x52A0;&#x9501;&#x3001;&#x89E3;&#x9501;&#x4E00;&#x7247;&#x6587;&#x4EF6;&#x533A;&#x57DF;&#x7684;&#x4EE3;&#x7801;&#x5FAA;&#x73AF;2000&#x4E07;&#x6B21;&#xFF0C;&#x9700;&#x8017;&#x65F6;44&#x79D2;&#xFF0C;&#x800C;&#x5C06;&#x5BF9;&#x7CFB;&#x7EDF;V&#x4FE1;&#x53F7;&#x91CF;&#xFF08;semaphore&#xFF09;&#x7684;&#x9012;&#x589E;&#x548C;&#x9012;&#x51CF;&#x4EE3;&#x7801;&#x5FAA;&#x73AF;2000&#x4E07;&#x6B21;&#xFF0C;&#x5219;&#x9700;&#x8981;28&#x79D2;&#x3002;&#x6587;&#x4EF6;&#x9501;&#x548C;&#x4FE1;&#x53F7;&#x91CF;&#x7684;&#x95EE;&#x9898;&#x5728;&#x4E8E;&#xFF0C;&#x5176;&#x9501;&#x5B9A;&#x548C;&#x89E3;&#x9501;&#x603B;&#x662F;&#x9700;&#x8981;&#x53D1;&#x8D77;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF08;system call&#xFF09;&#xFF0C;&#x800C;&#x6BCF;&#x4E2A;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x7684;&#x5F00;&#x9500;&#x867D;&#x5C0F;&#xFF0C;&#x4F46;&#x9887;&#x4E3A;&#x53EF;&#x89C2;&#x3002;&#x4E0E;&#x4E4B;&#x76F8;&#x53CD;&#xFF0C;&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x5B9E;&#x73B0;&#x91C7;&#x7528;&#x4E86;&#x673A;&#x5668;&#x8BED;&#x8A00;&#x7EA7;&#x7684;&#x539F;&#x5B50;&#x64CD;&#x4F5C;&#xFF08;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#x6267;&#x884C;&#xFF0C;&#x5BF9;&#x6240;&#x6709;&#x7EBF;&#x7A0B;&#x53EF;&#x89C1;&#xFF09;&#xFF0C;&#x53EA;&#x6709;&#x53D1;&#x751F;&#x9501;&#x7684;&#x4E89;&#x7528;&#x65F6;&#x624D;&#x4F1A;&#x6267;&#x884C;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x3002;</p>
<h3 id="&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x6B7B;&#x9501;"><a href="#&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x6B7B;&#x9501;" class="headerlink" title="&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x6B7B;&#x9501;"></a>&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x6B7B;&#x9501;</h3><p>&#x6709;&#x65F6;&#xFF0C;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x9700;&#x8981;&#x540C;&#x65F6;&#x8BBF;&#x95EE;&#x4E24;&#x4E2A;&#x6216;&#x66F4;&#x591A;&#x4E0D;&#x540C;&#x7684;&#x5171;&#x4EAB;&#x8D44;&#x6E90;&#xFF0C;&#x800C;&#x6BCF;&#x4E2A;&#x8D44;&#x6E90;&#x53C8;&#x90FD;&#x7531;&#x4E0D;&#x540C;&#x7684;&#x4E92;&#x65A5;&#x91CF;&#x7BA1;&#x7406;&#x3002;&#x5F53;&#x8D85;&#x8FC7;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x52A0;&#x9501;&#x540C;&#x4E00;&#x7EC4;&#x4E92;&#x65A5;&#x91CF;&#x65F6;&#xFF0C;&#x5C31;&#x6709;&#x53EF;&#x80FD;&#x53D1;&#x751F;&#x6B7B;&#x9501;&#x3002;&#x4E0B;&#x56FE;&#x5C55;&#x793A;&#x4E86;&#x4E00;&#x4E2A;&#x6B7B;&#x9501;&#x7684;&#x4F8B;&#x5B50;&#xFF0C;&#x5176;&#x4E2D;&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x90FD;&#x6210;&#x529F;&#x5730;&#x9501;&#x4F4F;&#x4E00;&#x4E2A;&#x4E92;&#x65A5;&#x91CF;&#xFF0C;&#x63A5;&#x7740;&#x8BD5;&#x56FE;&#x5BF9;&#x5DF2;&#x4E3A;&#x53E6;&#x4E00;&#x7EBF;&#x7A0B;&#x9501;&#x5B9A;&#x7684;&#x4E92;&#x65A5;&#x91CF;&#x52A0;&#x9501;&#x3002;&#x4E24;&#x4E2A;&#x7EBF;&#x7A0B;&#x5C06;&#x65E0;&#x9650;&#x671F;&#x5730;&#x7B49;&#x5F85;&#x4E0B;&#x53BB;&#x3002;<br></p><div class="amp-img-wrapper"><amp-img src="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1581564274718.png?x-oss-process=image/resize,m_lfit,h_450" width="700" height="167" layout="responsive"></amp-img></div><br>&#x8981;&#x907F;&#x514D;&#x6B64;&#x7C7B;&#x6B7B;&#x9501;&#x95EE;&#x9898;&#xFF0C;&#x6700;&#x7B80;&#x5355;&#x7684;&#x65B9;&#x6CD5;&#x662F;&#x5B9A;&#x4E49;&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x5C42;&#x7EA7;&#x5173;&#x7CFB;&#x3002;&#x5F53;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x5BF9;&#x4E00;&#x7EC4;&#x4E92;&#x65A5;&#x91CF;&#x64CD;&#x4F5C;&#x65F6;&#xFF0C;&#x603B;&#x662F;&#x5E94;&#x8BE5;&#x4EE5;&#x76F8;&#x540C;&#x987A;&#x5E8F;&#x5BF9;&#x8BE5;&#x7EC4;&#x4E92;&#x65A5;&#x91CF;&#x8FDB;&#x884C;&#x9501;&#x5B9A;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x5728;&#x4E0A;&#x56FE;&#x6240;&#x793A;&#x573A;&#x666F;&#x4E2D;&#xFF0C;&#x5982;&#x679C;&#x4E24;&#x4E2A;&#x7EBF;&#x7A0B;&#x603B;&#x662F;&#x5148;&#x9501;&#x5B9A;mutex1&#x518D;&#x9501;&#x5B9A;mutex2&#xFF0C;&#x6B7B;&#x9501;&#x5C31;&#x4E0D;&#x4F1A;&#x51FA;&#x73B0;&#x3002;&#x6709;&#x65F6;&#xFF0C;&#x4E92;&#x65A5;&#x91CF;&#x95F4;&#x7684;&#x5C42;&#x7EA7;&#x5173;&#x7CFB;&#x903B;&#x8F91;&#x6E05;&#x6670;&#x3002;&#x4E0D;&#x8FC7;&#xFF0C;&#x5373;&#x4FBF;&#x6CA1;&#x6709;&#xFF0C;&#x4F9D;&#x7136;&#x53EF;&#x4EE5;&#x8BBE;&#x8BA1;&#x51FA;&#x6240;&#x6709;&#x7EBF;&#x7A0B;&#x90FD;&#x5FC5;&#x987B;&#x9075;&#x5FAA;&#x7684;&#x5F3A;&#x5236;&#x5C42;&#x7EA7;&#x987A;&#x5E8F;&#x3002;
<p>&#x53E6;&#x4E00;&#x79CD;&#x65B9;&#x6848;&#x7684;&#x4F7F;&#x7528;&#x9891;&#x7387;&#x8F83;&#x4F4E;&#xFF0C;&#x5C31;&#x662F;&#x201C;&#x5C1D;&#x8BD5;&#x4E00;&#x4E0B;&#xFF0C;&#x7136;&#x540E;&#x6062;&#x590D;&#x201D;&#x3002;&#x5728;&#x8FD9;&#x79CD;&#x65B9;&#x6848;&#x4E2D;&#xFF0C;&#x7EBF;&#x7A0B;&#x5148;&#x4F7F;&#x7528;&#x51FD;&#x6570;pthread_mutex_lock()&#x9501;&#x5B9A;&#x7B2C;1&#x4E2A;&#x4E92;&#x65A5;&#x91CF;&#xFF0C;&#x7136;&#x540E;&#x4F7F;&#x7528;&#x51FD;&#x6570;pthread_mutex_trylock()&#x6765;&#x9501;&#x5B9A;&#x5176;&#x4F59;&#x4E92;&#x65A5;&#x91CF;&#x3002;&#x5982;&#x679C;&#x4EFB;&#x4E00;pthread_mutex_trylock()&#x8C03;&#x7528;&#x5931;&#x8D25;&#xFF08;&#x8FD4;&#x56DE;EBUSY&#xFF09;&#xFF0C;&#x90A3;&#x4E48;&#x8BE5;&#x7EBF;&#x7A0B;&#x5C06;&#x91CA;&#x653E;&#x6240;&#x6709;&#x4E92;&#x65A5;&#x91CF;&#xFF0C;&#x4E5F;&#x8BB8;&#x7ECF;&#x8FC7;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;&#x95F4;&#x9694;&#xFF0C;&#x4ECE;&#x5934;&#x518D;&#x8BD5;&#x3002;&#x8F83;&#x4E4B;&#x4E8E;&#x6309;&#x9501;&#x7684;&#x5C42;&#x7EA7;&#x5173;&#x7CFB;&#x6765;&#x89C4;&#x907F;&#x6B7B;&#x9501;&#xFF0C;&#x8FD9;&#x79CD;&#x65B9;&#x6CD5;&#x6548;&#x7387;&#x8981;&#x4F4E;&#x4E00;&#x4E9B;&#xFF0C;&#x56E0;&#x4E3A;&#x53EF;&#x80FD;&#x9700;&#x8981;&#x5386;&#x7ECF;&#x591A;&#x6B21;&#x5FAA;&#x73AF;&#x3002;&#x53E6;&#x4E00;&#x65B9;&#x9762;&#xFF0C;&#x7531;&#x4E8E;&#x65E0;&#x9700;&#x53D7;&#x5236;&#x4E8E;&#x4E25;&#x683C;&#x7684;&#x4E92;&#x65A5;&#x91CF;&#x5C42;&#x7EA7;&#x5173;&#x7CFB;&#xFF0C;&#x8BE5;&#x65B9;&#x6CD5;&#x4E5F;&#x66F4;&#x4E3A;&#x7075;&#x6D3B;&#x3002;[Butenhof, 1996]&#x4E2D;&#x8F7D;&#x6709;&#x8FD9;&#x4E00;&#x65B9;&#x6848;&#x7684;&#x8303;&#x4F8B;&#x3002;</p>
<h3 id="&#x52A8;&#x6001;&#x521D;&#x59CB;&#x5316;&#x4E92;&#x65A5;&#x91CF;"><a href="#&#x52A8;&#x6001;&#x521D;&#x59CB;&#x5316;&#x4E92;&#x65A5;&#x91CF;" class="headerlink" title="&#x52A8;&#x6001;&#x521D;&#x59CB;&#x5316;&#x4E92;&#x65A5;&#x91CF;"></a>&#x52A8;&#x6001;&#x521D;&#x59CB;&#x5316;&#x4E92;&#x65A5;&#x91CF;</h3><p>&#x9759;&#x6001;&#x521D;&#x59CB;&#x503C;PTHREAD_MUTEX_INITIALIZER&#xFF0C;&#x53EA;&#x80FD;&#x7528;&#x4E8E;&#x5BF9;&#x5982;&#x4E0B;&#x4E92;&#x65A5;&#x91CF;&#x8FDB;&#x884C;&#x521D;&#x59CB;&#x5316;&#xFF1A;&#x7ECF;&#x7531;&#x9759;&#x6001;&#x5206;&#x914D;&#x4E14;&#x643A;&#x5E26;&#x9ED8;&#x8BA4;&#x5C5E;&#x6027;&#x3002;&#x5176;&#x4ED6;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5FC5;&#x987B;&#x8C03;&#x7528;pthread_mutex_init()&#x5BF9;&#x4E92;&#x65A5;&#x91CF;&#x8FDB;&#x884C;&#x52A8;&#x6001;&#x521D;&#x59CB;&#x5316;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;pthread.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">pthread_mutex_init</span><span class="token punctuation">(</span>pthread_mutex_t <span class="token operator">*</span>restrict mutex<span class="token punctuation">,</span><span class="token keyword">const</span> pthread_mutexattr_t <span class="token operator">*</span>restrict attr<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x53C2;&#x6570;mutex&#x6307;&#x5B9A;&#x51FD;&#x6570;&#x6267;&#x884C;&#x521D;&#x59CB;&#x5316;&#x64CD;&#x4F5C;&#x7684;&#x76EE;&#x6807;&#x4E92;&#x65A5;&#x91CF;&#x3002;&#x53C2;&#x6570; attr &#x662F;&#x6307;&#x5411;pthread_mutexattr_t&#x7C7B;&#x578B;&#x5BF9;&#x8C61;&#x7684;&#x6307;&#x9488;&#xFF0C;&#x8BE5;&#x5BF9;&#x8C61;&#x5728;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x4E4B;&#x524D;&#x5DF2;&#x7ECF;&#x8FC7;&#x4E86;&#x521D;&#x59CB;&#x5316;&#x5904;&#x7406;&#xFF0C;&#x7528;&#x4E8E;&#x5B9A;&#x4E49;&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x5C5E;&#x6027;&#x3002;&#xFF08;&#x4E0B;&#x8282;&#x4F1A;&#x4ECB;&#x7ECD;&#x66F4;&#x591A;&#x4E92;&#x65A5;&#x91CF;&#x5C5E;&#x6027;&#x3002;&#xFF09;&#x82E5;&#x5C06;attr&#x53C2;&#x6570;&#x7F6E;&#x4E3A;NULL&#xFF0C;&#x5219;&#x8BE5;&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x5404;&#x79CD;&#x5C5E;&#x6027;&#x4F1A;&#x53D6;&#x9ED8;&#x8BA4;&#x503C;&#x3002;</p>
<p>SUSv3&#x89C4;&#x5B9A;&#xFF0C;&#x521D;&#x59CB;&#x5316;&#x4E00;&#x4E2A;&#x4E1A;&#x5DF2;&#x521D;&#x59CB;&#x5316;&#x7684;&#x4E92;&#x65A5;&#x91CF;&#x5C06;&#x5BFC;&#x81F4;&#x672A;&#x5B9A;&#x4E49;&#x7684;&#x884C;&#x4E3A;&#xFF0C;&#x5E94;&#x5F53;&#x907F;&#x514D;&#x8FD9;&#x4E00;&#x884C;&#x4E3A;&#x3002;</p>
<p>&#x5728;&#x5982;&#x4E0B;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5FC5;&#x987B;&#x4F7F;&#x7528;&#x51FD;&#x6570;pthread_mutex_init()&#xFF0C;&#x800C;&#x975E;&#x9759;&#x6001;&#x521D;&#x59CB;&#x5316;&#x4E92;&#x65A5;&#x91CF;&#x3002;</p>
<ul>
<li>&#x52A8;&#x6001;&#x5206;&#x914D;&#x4E8E;&#x5806;&#x4E2D;&#x7684;&#x4E92;&#x65A5;&#x91CF;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x52A8;&#x6001;&#x521B;&#x5EFA;&#x9488;&#x5BF9;&#x67D0;&#x4E00;&#x7ED3;&#x6784;&#x7684;&#x94FE;&#x8868;&#xFF0C;&#x8868;&#x4E2D;&#x6BCF;&#x4E2A;&#x7ED3;&#x6784;&#x90FD;&#x5305;&#x542B;&#x4E00;&#x4E2A;pthread_mutex_t&#x7C7B;&#x578B;&#x7684;&#x5B57;&#x6BB5;&#x6765;&#x5B58;&#x653E;&#x4E92;&#x65A5;&#x91CF;&#xFF0C;&#x501F;&#x4EE5;&#x4FDD;&#x62A4;&#x5BF9;&#x8BE5;&#x7ED3;&#x6784;&#x7684;&#x8BBF;&#x95EE;&#x3002;</li>
<li>&#x4E92;&#x65A5;&#x91CF;&#x662F;&#x5728;&#x6808;&#x4E2D;&#x5206;&#x914D;&#x7684;&#x81EA;&#x52A8;&#x53D8;&#x91CF;&#x3002;</li>
<li>&#x521D;&#x59CB;&#x5316;&#x7ECF;&#x7531;&#x9759;&#x6001;&#x5206;&#x914D;&#xFF0C;&#x4E14;&#x4E0D;&#x4F7F;&#x7528;&#x9ED8;&#x8BA4;&#x5C5E;&#x6027;&#x7684;&#x4E92;&#x65A5;&#x91CF;&#x3002;</li>
</ul>
<p>&#x5F53;&#x4E0D;&#x518D;&#x9700;&#x8981;&#x7ECF;&#x7531;&#x81EA;&#x52A8;&#x6216;&#x52A8;&#x6001;&#x5206;&#x914D;&#x7684;&#x4E92;&#x65A5;&#x91CF;&#x65F6;&#xFF0C;&#x5E94;&#x4F7F;&#x7528; pthread_mutex_destroy()&#x5C06;&#x5176;&#x9500;&#x6BC1;&#x3002;&#xFF08;&#x5BF9;&#x4E8E;&#x4F7F;&#x7528;PTHREAD_MUTEX_INITIALIZER&#x9759;&#x6001;&#x521D;&#x59CB;&#x5316;&#x7684;&#x4E92;&#x65A5;&#x91CF;&#xFF0C;&#x65E0;&#x9700;&#x8C03;&#x7528;pthread_mutex_destroy()&#x3002;&#xFF09;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;pthread.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">pthread_mutex_destroy</span><span class="token punctuation">(</span>pthread_mutex_t <span class="token operator">*</span>mutex<span class="token punctuation">)</span><span class="token punctuation">;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x53EA;&#x6709;&#x5F53;&#x4E92;&#x65A5;&#x91CF;&#x5904;&#x4E8E;&#x672A;&#x9501;&#x5B9A;&#x72B6;&#x6001;&#xFF0C;&#x4E14;&#x540E;&#x7EED;&#x4E5F;&#x65E0;&#x4EFB;&#x4F55;&#x7EBF;&#x7A0B;&#x4F01;&#x56FE;&#x9501;&#x5B9A;&#x5B83;&#x65F6;&#xFF0C;&#x5C06;&#x5176;&#x9500;&#x6BC1;&#x624D;&#x662F;&#x5B89;&#x5168;&#x7684;&#x3002;&#x82E5;&#x4E92;&#x65A5;&#x91CF;&#x9A7B;&#x7559;&#x4E8E;&#x52A8;&#x6001;&#x5206;&#x914D;&#x7684;&#x4E00;&#x7247;&#x5185;&#x5B58;&#x533A;&#x57DF;&#x4E2D;&#xFF0C;&#x5E94;&#x5728;&#x91CA;&#x653E;&#xFF08;free&#xFF09;&#x6B64;&#x5185;&#x5B58;&#x533A;&#x57DF;&#x524D;&#x5C06;&#x5176;&#x9500;&#x6BC1;&#x3002;&#x5BF9;&#x4E8E;&#x81EA;&#x52A8;&#x5206;&#x914D;&#x7684;&#x4E92;&#x65A5;&#x91CF;&#xFF0C;&#x4E5F;&#x5E94;&#x5728;&#x5BBF;&#x4E3B;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x524D;&#x5C06;&#x5176;&#x9500;&#x6BC1;&#x3002;</p>
<p>&#x7ECF;&#x7531;pthread_mutex_destroy()&#x9500;&#x6BC1;&#x7684;&#x4E92;&#x65A5;&#x91CF;&#xFF0C;&#x53EF;&#x8C03;&#x7528;pthread_mutex_init()&#x5BF9;&#x5176;&#x91CD;&#x65B0;&#x521D;&#x59CB;&#x5316;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;pthread.h&gt;</span>  </span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span>  </span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;unistd.h&gt;</span></span>

pthread_mutex_t mutex <span class="token punctuation">;</span>  
<span class="token keyword">void</span> <span class="token operator">*</span><span class="token function">print_msg</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>arg<span class="token punctuation">)</span><span class="token punctuation">{</span>  
        <span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>  
        <span class="token function">pthread_mutex_lock</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>mutex<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//mutex&#x52A0;&#x9501;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">20</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>  
                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;output : %d\n&quot;</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">}</span>  
        <span class="token function">pthread_mutex_unlock</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>mutex<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//mutex&#x89E3;&#x9501;</span>
<span class="token punctuation">}</span>  
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">*</span> argv<span class="token punctuation">)</span>
<span class="token punctuation">{</span>  
        pthread_t id1<span class="token punctuation">;</span>  
        pthread_t id2<span class="token punctuation">;</span>  
        <span class="token function">pthread_mutex_init</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>mutex<span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token function">pthread_create</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>id1<span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">,</span>print_msg<span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token function">pthread_create</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>id2<span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">,</span>print_msg<span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token function">pthread_join</span><span class="token punctuation">(</span>id1<span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//&#x5B88;&#x62A4;thread1&#x7ED3;&#x675F;</span>
        <span class="token function">pthread_join</span><span class="token punctuation">(</span>id2<span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//&#x5B88;&#x62A4;thread2&#x7ED3;&#x675F;</span>
        <span class="token function">pthread_mutex_destroy</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>mutex<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-bash"><code class="language-bash">g++ main.cpp -pthread<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre><code>output : 0
output : 1
output : 2
output : 3
output : 4
output : 5
output : 6
...</code></pre><p>&#x7A0B;&#x5E8F;&#x6E05;&#x5355;&#x4F7F;&#x7528;&#x4E86;&#x4E00;&#x4E2A;&#x4E92;&#x65A5;&#x91CF;&#x6765;&#x4FDD;&#x62A4;&#x5BF9;&#x53D8;&#x91CF;i&#x7684;&#x8BBF;&#x95EE;&#x3002;</p>
<h3 id="&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x5C5E;&#x6027;"><a href="#&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x5C5E;&#x6027;" class="headerlink" title="&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x5C5E;&#x6027;"></a>&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x5C5E;&#x6027;</h3><p>&#x5982;&#x524D;&#x6240;&#x8FF0;&#xFF0C;&#x53EF;&#x4EE5;&#x5728;pthread_mutex_init()&#x51FD;&#x6570;&#x7684;arg&#x53C2;&#x6570;&#x4E2D;&#x6307;&#x5B9A;pthread_mutexattr_t&#x7C7B;&#x578B;&#x5BF9;&#x8C61;&#xFF0C;&#x5BF9;&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x5C5E;&#x6027;&#x8FDB;&#x884C;&#x5B9A;&#x4E49;&#x3002;</p>
<h3 id="&#x4E92;&#x65A5;&#x91CF;&#x7C7B;&#x578B;"><a href="#&#x4E92;&#x65A5;&#x91CF;&#x7C7B;&#x578B;" class="headerlink" title="&#x4E92;&#x65A5;&#x91CF;&#x7C7B;&#x578B;"></a>&#x4E92;&#x65A5;&#x91CF;&#x7C7B;&#x578B;</h3><p>&#x524D;&#x9762;&#x51E0;&#x9875;&#x5BF9;&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x884C;&#x4E3A;&#x505A;&#x4E86;&#x82E5;&#x5E72;&#x8BBA;&#x8FF0;&#x3002;</p>
<ul>
<li>&#x540C;&#x4E00;&#x7EBF;&#x7A0B;&#x4E0D;&#x5E94;&#x5BF9;&#x540C;&#x4E00;&#x4E92;&#x65A5;&#x91CF;&#x52A0;&#x9501;&#x4E24;&#x6B21;&#x3002;</li>
<li>&#x7EBF;&#x7A0B;&#x5E94;&#x4E3A;&#x81EA;&#x5DF1;&#x6240;&#x62E5;&#x6709;&#x7684;&#x4E92;&#x65A5;&#x91CF;&#x89E3;&#x9501;&#xFF08;&#x4EA6;&#x5373;&#xFF0C;&#x5C1A;&#x672A;&#x9501;&#x5B9A;&#x4E92;&#x65A5;&#x91CF;&#xFF09;&#x3002;</li>
<li>&#x7EBF;&#x7A0B;&#x4E0D;&#x5E94;&#x5BF9;&#x4E00;&#x5C1A;&#x672A;&#x9501;&#x5B9A;&#x7684;&#x4E92;&#x65A5;&#x91CF;&#x505A;&#x89E3;&#x9501;&#x52A8;&#x4F5C;&#x3002;</li>
</ul>
<p>&#x51C6;&#x786E;&#x5730;&#x8BF4;&#xFF0C;&#x4E0A;&#x8FF0;&#x60C5;&#x51B5;&#x7684;&#x7ED3;&#x679C;&#x5C06;&#x53D6;&#x51B3;&#x4E8E;&#x4E92;&#x65A5;&#x91CF;&#x7C7B;&#x578B;&#xFF08;type&#xFF09;&#x3002;SUSv3&#x5B9A;&#x4E49;&#x4E86;&#x4EE5;&#x4E0B;&#x4E92;&#x65A5;&#x91CF;&#x7C7B;&#x578B;&#x3002;</p>
<p><code>PTHREAD_MUTEX_NORMAL</code><br>&#x8BE5;&#x7C7B;&#x578B;&#x7684;&#x4E92;&#x65A5;&#x91CF;&#x4E0D;&#x5177;&#x6709;&#x6B7B;&#x9501;&#x68C0;&#x6D4B;&#xFF08;&#x81EA;&#x68C0;&#xFF09;&#x529F;&#x80FD;&#x3002;&#x5982;&#x7EBF;&#x7A0B;&#x8BD5;&#x56FE;&#x5BF9;&#x5DF2;&#x7531;&#x81EA;&#x5DF1;&#x9501;&#x5B9A;&#x7684;&#x4E92;&#x65A5;&#x91CF;&#x52A0;&#x9501;&#xFF0C;&#x5219;&#x53D1;&#x751F;&#x6B7B;&#x9501;&#x3002;&#x4E92;&#x65A5;&#x91CF;&#x5904;&#x4E8E;&#x672A;&#x9501;&#x5B9A;&#x72B6;&#x6001;&#xFF0C;&#x6216;&#x8005;&#x5DF2;&#x7531;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x9501;&#x5B9A;&#xFF0C;&#x5BF9;&#x5176;&#x89E3;&#x9501;&#x4F1A;&#x5BFC;&#x81F4;&#x4E0D;&#x786E;&#x5B9A;&#x7684;&#x7ED3;&#x679C;&#x3002;&#xFF08;&#x5728;Linux&#x4E0A;&#xFF0C;&#x5BF9;&#x8FD9;&#x7C7B;&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x4E0A;&#x8FF0;&#x4E24;&#x79CD;&#x64CD;&#x4F5C;&#x90FD;&#x4F1A;&#x6210;&#x529F;&#x3002;&#xFF09;</p>
<p><code>PTHREAD_MUTEX_ERRORCHECK</code><br>&#x5BF9;&#x6B64;&#x7C7B;&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x6240;&#x6709;&#x64CD;&#x4F5C;&#x90FD;&#x4F1A;&#x6267;&#x884C;&#x9519;&#x8BEF;&#x68C0;&#x67E5;&#x3002;&#x6240;&#x6709;&#x4E0A;&#x8FF0;3&#x79CD;&#x60C5;&#x51B5;&#x90FD;&#x4F1A;&#x5BFC;&#x81F4;&#x76F8;&#x5173;Pthreads&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x9519;&#x8BEF;&#x3002;&#x8FD9;&#x7C7B;&#x4E92;&#x65A5;&#x91CF;&#x8FD0;&#x884C;&#x8D77;&#x6765;&#x6BD4;&#x4E00;&#x822C;&#x7C7B;&#x578B;&#x8981;&#x6162;&#xFF0C;&#x4E0D;&#x8FC7;&#x53EF;&#x5C06;&#x5176;&#x4F5C;&#x4E3A;&#x8C03;&#x8BD5;&#x5DE5;&#x5177;&#xFF0C;&#x4EE5;&#x53D1;&#x73B0;&#x7A0B;&#x5E8F;&#x5728;&#x54EA;&#x91CC;&#x8FDD;&#x53CD;&#x4E86;&#x4E92;&#x65A5;&#x91CF;&#x4F7F;&#x7528;&#x7684;&#x57FA;&#x672C;&#x539F;&#x5219;&#x3002;</p>
<p><code>PTHREAD_MUTEX_RECURSIVE</code><br>&#x9012;&#x5F52;&#x4E92;&#x65A5;&#x91CF;&#x7EF4;&#x62A4;&#x6709;&#x4E00;&#x4E2A;&#x9501;&#x8BA1;&#x6570;&#x5668;&#x3002;&#x5F53;&#x7EBF;&#x7A0B;&#x7B2C;1&#x6B21;&#x53D6;&#x5F97;&#x4E92;&#x65A5;&#x91CF;&#x65F6;&#xFF0C;&#x4F1A;&#x5C06;&#x9501;&#x8BA1;&#x6570;&#x5668;&#x7F6E;1&#x3002;&#x540E;&#x7EED;&#x7531;&#x540C;&#x4E00;&#x7EBF;&#x7A0B;&#x6267;&#x884C;&#x7684;&#x6BCF;&#x6B21;&#x52A0;&#x9501;&#x64CD;&#x4F5C;&#x4F1A;&#x9012;&#x589E;&#x9501;&#x8BA1;&#x6570;&#x5668;&#x7684;&#x6570;&#x503C;&#xFF0C;&#x800C;&#x89E3;&#x9501;&#x64CD;&#x4F5C;&#x5219;&#x9012;&#x51CF;&#x8BA1;&#x6570;&#x5668;&#x8BA1;&#x6570;&#x3002;&#x53EA;&#x6709;&#x5F53;&#x9501;&#x8BA1;&#x6570;&#x5668;&#x503C;&#x964D;&#x81F3;0&#x65F6;&#xFF0C;&#x624D;&#x4F1A;&#x91CA;&#x653E;&#xFF08;release&#xFF0C;&#x4EA6;&#x5373;&#x53EF;&#x4E3A;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x6240;&#x7528;&#xFF09;&#x8BE5;&#x4E92;&#x65A5;&#x91CF;&#x3002;&#x89E3;&#x9501;&#x65F6;&#x5982;&#x76EE;&#x6807;&#x4E92;&#x65A5;&#x91CF;&#x5904;&#x4E8E;&#x672A;&#x9501;&#x5B9A;&#x72B6;&#x6001;&#xFF0C;&#x6216;&#x662F;&#x5DF2;&#x7531;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x9501;&#x5B9A;&#xFF0C;&#x64CD;&#x4F5C;&#x90FD;&#x4F1A;&#x5931;&#x8D25;&#x3002;</p>
<p>Linux&#x7684;&#x7EBF;&#x7A0B;&#x5B9E;&#x73B0;&#x9488;&#x5BF9;&#x4EE5;&#x4E0A;&#x5404;&#x79CD;&#x7C7B;&#x578B;&#x7684;&#x4E92;&#x65A5;&#x91CF;&#x63D0;&#x4F9B;&#x4E86;&#x975E;&#x6807;&#x51C6;&#x7684;&#x9759;&#x6001;&#x521D;&#x59CB;&#x503C;&#xFF08;&#x4F8B;&#x5982;&#xFF0C;PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP&#xFF09;&#xFF0C;&#x4EE5;&#x4FBF;&#x5BF9;&#x90A3;&#x4E9B;&#x901A;&#x8FC7;&#x9759;&#x6001;&#x5206;&#x914D;&#x7684;&#x4E92;&#x65A5;&#x91CF;&#x8FDB;&#x884C;&#x521D;&#x59CB;&#x5316;&#xFF0C;&#x800C;&#x65E0;&#x9700;&#x4F7F;&#x7528;pthread_mutex_init()&#x51FD;&#x6570;&#x3002;&#x4E0D;&#x8FC7;&#xFF0C;&#x4E3A;&#x4FDD;&#x8BC1;&#x7A0B;&#x5E8F;&#x7684;&#x53EF;&#x79FB;&#x690D;&#x6027;&#xFF0C;&#x5E94;&#x8BE5;&#x907F;&#x514D;&#x4F7F;&#x7528;&#x8FD9;&#x4E9B;&#x521D;&#x59CB;&#x503C;&#x3002;</p>
<p>&#x9664;&#x4E86;&#x4E0A;&#x8FF0;&#x7C7B;&#x578B;&#xFF0C;SUSv3&#x8FD8;&#x5B9A;&#x4E49;&#x4E86;PTHREAD_MUTEX_DEFAULT&#x7C7B;&#x578B;&#x3002;&#x4F7F;&#x7528;PTHREAD_MUTEX_INITIALIZER&#x521D;&#x59CB;&#x5316;&#x7684;&#x4E92;&#x65A5;&#x91CF;&#xFF0C;&#x6216;&#x662F;&#x7ECF;&#x8C03;&#x7528;&#x53C2;&#x6570;attr&#x4E3A;NULL&#x7684;pthread_mutex_init()&#x51FD;&#x6570;&#x6240;&#x521B;&#x5EFA;&#x7684;&#x4E92;&#x65A5;&#x91CF;&#xFF0C;&#x90FD;&#x5C5E;&#x4E8E;&#x6B64;&#x7C7B;&#x578B;&#x3002;&#x81F3;&#x4E8E;&#x8BE5;&#x7C7B;&#x578B;&#x4E92;&#x65A5;&#x91CF;&#x5728;&#x672C;&#x8282;&#x5F00;&#x59CB;&#x5904;3&#x4E2A;&#x573A;&#x666F;&#x4E2D;&#x7684;&#x884C;&#x4E3A;&#xFF0C;&#x89C4;&#x8303;&#x6709;&#x610F;&#x672A;&#x4F5C;&#x5B9A;&#x4E49;&#xFF0C;&#x610F;&#x5728;&#x4E3A;&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x9AD8;&#x6548;&#x5B9E;&#x73B0;&#x4FDD;&#x7559;&#x6700;&#x5927;&#x7684;&#x7075;&#x6D3B;&#x6027;&#x3002;Linux&#x4E0A;&#xFF0C;PTHREAD_MUTEX_DEFAULT&#x7C7B;&#x578B;&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x884C;&#x4E3A;&#x4E0E;PTHREAD_MUTEX_NORMAL&#x7C7B;&#x578B;&#x76F8;&#x4EFF;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c">s<span class="token operator">=</span><span class="token function">pthread_mutexattr_settype</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>mtxAttr<span class="token punctuation">,</span>PTHREAD_MUTEX_ERRORCHECK<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span>s <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token function">errExitEN</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span><span class="token string">&quot;pthread_mutexattr_settype&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

s<span class="token operator">=</span><span class="token function">pthread_mutex_init</span><span class="token punctuation">(</span>mtx<span class="token punctuation">,</span><span class="token operator">&amp;</span>mtxAttr<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token function">errExitEN</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span><span class="token string">&quot;pthread_mutex_init&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

s<span class="token operator">=</span><span class="token function">pthread_mutexattr_destroy</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>mtxAttr<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token function">errExitEN</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span><span class="token string">&quot;pthread_mutexattr_destroy&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="&#x901A;&#x77E5;&#x72B6;&#x6001;&#x7684;&#x6539;&#x53D8;&#xFF1A;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#xFF08;Condition-Variable&#xFF09;"><a href="#&#x901A;&#x77E5;&#x72B6;&#x6001;&#x7684;&#x6539;&#x53D8;&#xFF1A;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#xFF08;Condition-Variable&#xFF09;" class="headerlink" title="&#x901A;&#x77E5;&#x72B6;&#x6001;&#x7684;&#x6539;&#x53D8;&#xFF1A;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#xFF08;Condition Variable&#xFF09;"></a>&#x901A;&#x77E5;&#x72B6;&#x6001;&#x7684;&#x6539;&#x53D8;&#xFF1A;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#xFF08;Condition Variable&#xFF09;</h2><p>&#x4E92;&#x65A5;&#x91CF;&#x9632;&#x6B62;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x540C;&#x65F6;&#x8BBF;&#x95EE;&#x540C;&#x4E00;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#x3002;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#x5141;&#x8BB8;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x5C31;&#x67D0;&#x4E2A;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#xFF08;&#x6216;&#x5176;&#x4ED6;&#x5171;&#x4EAB;&#x8D44;&#x6E90;&#xFF09;&#x7684;&#x72B6;&#x6001;&#x53D8;&#x5316;&#x901A;&#x77E5;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#xFF0C;&#x5E76;&#x8BA9;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x7B49;&#x5F85;&#xFF08;&#x5835;&#x585E;&#x4E8E;&#xFF09;&#x8FD9;&#x4E00;&#x901A;&#x77E5;&#x3002;<br>&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#x603B;&#x662F;&#x7ED3;&#x5408;&#x4E92;&#x65A5;&#x91CF;&#x4F7F;&#x7528;&#x3002;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#x5C31;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#x7684;&#x72B6;&#x6001;&#x6539;&#x53D8;&#x53D1;&#x51FA;&#x901A;&#x77E5;&#xFF0C;&#x800C;&#x4E92;&#x65A5;&#x91CF;&#x5219;&#x63D0;&#x4F9B;&#x5BF9;&#x8BE5;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#x8BBF;&#x95EE;&#x7684;&#x4E92;&#x65A5;&#xFF08;mutual exclusion&#xFF09;&#x3002;&#x8FD9;&#x91CC;&#x4F7F;&#x7528;&#x7684;&#x672F;&#x8BED;&#x201C;&#x4FE1;&#x53F7;&#x201D;&#xFF08;signal&#xFF09;&#xFF0C;&#x4E0E;&#x7B2C;20&#x7AE0;&#x81F3;&#x7B2C;22&#x7AE0;&#x6240;&#x8FF0;&#x4FE1;&#x53F7;&#xFF08;signal&#xFF09;&#x65E0;&#x5173;&#xFF0C;&#x800C;&#x662F;&#x53D1;&#x51FA;&#x4FE1;&#x53F7;&#x7684;&#x610F;&#x601D;&#x3002;</p>
<h3 id="&#x7531;&#x9759;&#x6001;&#x5206;&#x914D;&#x7684;&#x6761;&#x4EF6;&#x53D8;&#x91CF;"><a href="#&#x7531;&#x9759;&#x6001;&#x5206;&#x914D;&#x7684;&#x6761;&#x4EF6;&#x53D8;&#x91CF;" class="headerlink" title="&#x7531;&#x9759;&#x6001;&#x5206;&#x914D;&#x7684;&#x6761;&#x4EF6;&#x53D8;&#x91CF;"></a>&#x7531;&#x9759;&#x6001;&#x5206;&#x914D;&#x7684;&#x6761;&#x4EF6;&#x53D8;&#x91CF;</h3><p>&#x5982;&#x540C;&#x4E92;&#x65A5;&#x91CF;&#x4E00;&#x6837;&#xFF0C;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#x7684;&#x5206;&#x914D;&#xFF0C;&#x6709;&#x9759;&#x6001;&#x548C;&#x52A8;&#x6001;&#x4E4B;&#x5206;&#x3002;<br>&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#x7684;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x662F;pthread_count_t&#x3002;&#x7C7B;&#x4F3C;&#x4E8E;&#x4E92;&#x65A5;&#x91CF;&#xFF0C;&#x4F7F;&#x7528;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#x524D;&#x5FC5;&#x987B;&#x5BF9;&#x5176;&#x521D;&#x59CB;&#x5316;&#x3002;&#x5BF9;&#x4E8E;&#x7ECF;&#x7531;&#x9759;&#x6001;&#x5206;&#x914D;&#x7684;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#xFF0C;&#x5C06;&#x5176;&#x8D4B;&#x503C;&#x4E3A;PTHREAD_COND_INITALIZER&#x5373;&#x5B8C;&#x6210;&#x521D;&#x59CB;&#x5316;&#x64CD;&#x4F5C;&#x3002;&#x53EF;&#x53C2;&#x8003;&#x4E0B;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#xFF1A;</p>
<pre class="line-numbers language-c"><code class="language-c">pthread_count_t count<span class="token operator">=</span>PTHREAD_COND_INITALIZER<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="&#x901A;&#x77E5;&#x548C;&#x7B49;&#x5F85;&#x6761;&#x4EF6;&#x53D8;&#x91CF;"><a href="#&#x901A;&#x77E5;&#x548C;&#x7B49;&#x5F85;&#x6761;&#x4EF6;&#x53D8;&#x91CF;" class="headerlink" title="&#x901A;&#x77E5;&#x548C;&#x7B49;&#x5F85;&#x6761;&#x4EF6;&#x53D8;&#x91CF;"></a>&#x901A;&#x77E5;&#x548C;&#x7B49;&#x5F85;&#x6761;&#x4EF6;&#x53D8;&#x91CF;</h2><p>&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#x7684;&#x4E3B;&#x8981;&#x64CD;&#x4F5C;&#x662F;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#xFF08;signal&#xFF09;&#x548C;&#x7B49;&#x5F85;&#xFF08;wait&#xFF09;&#x3002;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x64CD;&#x4F5C;&#x5373;&#x901A;&#x77E5;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x5904;&#x4E8E;&#x7B49;&#x5F85;&#x72B6;&#x6001;&#x7684;&#x7EBF;&#x7A0B;&#xFF0C;&#x67D0;&#x4E2A;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#x7684;&#x72B6;&#x6001;&#x5DF2;&#x7ECF;&#x6539;&#x53D8;&#x3002;&#x7B49;&#x5F85;&#x64CD;&#x4F5C;&#x662F;&#x6307;&#x5728;&#x6536;&#x5230;&#x4E00;&#x4E2A;&#x901A;&#x77E5;&#x524D;&#x4E00;&#x76F4;&#x5904;&#x4E8E;&#x963B;&#x585E;&#x72B6;&#x6001;&#x3002;<br>&#x51FD;&#x6570;pthread_cond_signal()&#x548C;pthread_cond_broadcast()&#x5747;&#x53EF;&#x9488;&#x5BF9;&#x7531;&#x53C2;&#x6570;cond&#x6240;&#x6307;&#x5B9A;&#x7684;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#x800C;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x3002;pthread_cond_wait()&#x51FD;&#x6570;&#x5C06;&#x963B;&#x585E;&#x4E00;&#x7EBF;&#x7A0B;&#xFF0C;&#x76F4;&#x81F3;&#x6536;&#x5230;&#x6761;&#x4EF6;&#x53D8;&#x91CF; cond&#x7684;&#x901A;&#x77E5;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;pthread.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">pthread_cond_signal</span><span class="token punctuation">(</span>pthread_cond_t <span class="token operator">*</span>cond<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">pthread_cond_broadcast</span><span class="token punctuation">(</span>pthread_cond_t <span class="token operator">*</span>cond<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">pthread_cond_wait</span><span class="token punctuation">(</span>pthread_cond_t <span class="token operator">*</span>cond<span class="token punctuation">,</span>pthread_mutex_t <span class="token operator">*</span>mutex<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x51FD;&#x6570;pthread_cond_signal()&#x548C;pthread_cond_broadcast()&#x4E4B;&#x95F4;&#x7684;&#x5DEE;&#x522B;&#x5728;&#x4E8E;&#xFF0C;&#x4E8C;&#x8005;&#x5BF9;&#x963B;&#x585E;&#x4E8E;pthread_cond_wait()&#x7684;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x5904;&#x7406;&#x65B9;&#x5F0F;&#x4E0D;&#x540C;&#x3002;pthread_cond_signal()&#x51FD;&#x6570;&#x53EA;&#x4FDD;&#x8BC1;&#x5524;&#x9192;&#x81F3;&#x5C11;&#x4E00;&#x6761;&#x906D;&#x5230;&#x963B;&#x585E;&#x7684;&#x7EBF;&#x7A0B;&#xFF0C;&#x800C;pthread_cond_broadcast()&#x5219;&#x4F1A;&#x5524;&#x9192;&#x6240;&#x6709;&#x906D;&#x963B;&#x585E;&#x7684;&#x7EBF;&#x7A0B;&#x3002;<br>&#x4F7F;&#x7528;&#x51FD;&#x6570;pthread_cond_broadcast()&#x603B;&#x80FD;&#x4EA7;&#x751F;&#x6B63;&#x786E;&#x7ED3;&#x679C;&#xFF08;&#x56E0;&#x4E3A;&#x6240;&#x6709;&#x7EBF;&#x7A0B;&#x5E94;&#x90FD;&#x80FD;&#x5904;&#x7406;&#x591A;&#x4F59;&#x548C;&#x865A;&#x5047;&#x7684;&#x5524;&#x9192;&#x52A8;&#x4F5C;&#xFF09;&#xFF0C;&#x4F46;&#x51FD;&#x6570;pthread_cond_signal()&#x4F1A;&#x66F4;&#x4E3A;&#x9AD8;&#x6548;&#x3002;&#x4E0D;&#x8FC7;&#xFF0C;&#x53EA;&#x6709;&#x5F53;&#x4EC5;&#x9700;&#x5524;&#x9192;&#x4E00;&#x6761;&#xFF08;&#x4E14;&#x65E0;&#x8BBA;&#x662F;&#x5176;&#x4E2D;&#x54EA;&#x6761;&#xFF09;&#x7B49;&#x5F85;&#x7EBF;&#x7A0B;&#x6765;&#x5904;&#x7406;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#x7684;&#x72B6;&#x6001;&#x53D8;&#x5316;&#x65F6;&#xFF0C;&#x624D;&#x5E94;&#x4F7F;&#x7528; pthread_cond_signal()&#x3002;&#x5E94;&#x7528;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x7684;&#x5178;&#x578B;&#x60C5;&#x51B5;&#x662F;&#xFF0C;&#x6240;&#x6709;&#x7B49;&#x5F85;&#x7EBF;&#x7A0B;&#x90FD;&#x5728;&#x6267;&#x884C;&#x5B8C;&#x5168;&#x76F8;&#x540C;&#x7684;&#x4EFB;&#x52A1;&#x3002;&#x57FA;&#x4E8E;&#x8FD9;&#x4E9B;&#x5047;&#x8BBE;&#xFF0C;&#x51FD;&#x6570;pthread_cond_signal()&#x4F1A;&#x6BD4;pthread_cond_broadcast()&#x66F4;&#x5177;&#x6548;&#x7387;&#xFF0C;&#x56E0;&#x4E3A;&#x8FD9;&#x53EF;&#x4EE5;&#x907F;&#x514D;&#x53D1;&#x751F;&#x5982;&#x4E0B;&#x60C5;&#x51B5;&#x3002;<br>1&#xFF0E; &#x540C;&#x65F6;&#x5524;&#x9192;&#x6240;&#x6709;&#x7B49;&#x5F85;&#x7EBF;&#x7A0B;&#x3002;<br>2&#xFF0E; &#x67D0;&#x4E00;&#x7EBF;&#x7A0B;&#x9996;&#x5148;&#x83B7;&#x5F97;&#x8C03;&#x5EA6;&#x3002;&#x6B64;&#x7EBF;&#x7A0B;&#x68C0;&#x67E5;&#x4E86;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#x7684;&#x72B6;&#x6001;&#xFF08;&#x5728;&#x76F8;&#x5173;&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x4FDD;&#x62A4;&#x4E4B;&#x4E0B;&#xFF09;&#xFF0C;&#x53D1;&#x73B0;&#x8FD8;&#x6709;&#x4EFB;&#x52A1;&#x9700;&#x8981;&#x5B8C;&#x6210;&#x3002;&#x8BE5;&#x7EBF;&#x7A0B;&#x6267;&#x884C;&#x4E86;&#x6240;&#x9700;&#x5DE5;&#x4F5C;&#xFF0C;&#x5E76;&#x6539;&#x53D8;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#x72B6;&#x6001;&#xFF0C;&#x4EE5;&#x8868;&#x660E;&#x4EFB;&#x52A1;&#x5B8C;&#x6210;&#xFF0C;&#x6700;&#x540E;&#x91CA;&#x653E;&#x5BF9;&#x76F8;&#x5173;&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x9501;&#x5B9A;&#x3002;<br>3&#xFF0E; &#x5269;&#x4F59;&#x7684;&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x8F6E;&#x6D41;&#x9501;&#x5B9A;&#x4E92;&#x65A5;&#x91CF;&#x5E76;&#x68C0;&#x6D4B;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#x7684;&#x72B6;&#x6001;&#x3002;&#x4E0D;&#x8FC7;&#xFF0C;&#x7531;&#x4E8E;&#x7B2C;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x6240;&#x505A;&#x7684;&#x5DE5;&#x4F5C;&#xFF0C;&#x4F59;&#x4E0B;&#x7684;&#x7EBF;&#x7A0B;&#x53D1;&#x73B0;&#x65E0;&#x4E8B;&#x53EF;&#x505A;&#xFF0C;&#x968F;&#x5373;&#x89E3;&#x9501;&#x4E92;&#x65A5;&#x91CF;&#x8F6C;&#x800C;&#x4F11;&#x7720;&#xFF08;&#x5373;&#x518D;&#x6B21;&#x8C03;&#x7528; pthread_cond_wait()&#xFF09;&#x3002;</p>
<p>&#x76F8;&#x5F62;&#x4E4B;&#x4E0B;&#xFF0C;&#x51FD;&#x6570;pthread_cond_broadcast()&#x6240;&#x5904;&#x7406;&#x7684;&#x60C5;&#x51B5;&#x662F;&#xFF1A;&#x5904;&#x4E8E;&#x7B49;&#x5F85;&#x72B6;&#x6001;&#x7684;&#x6240;&#x6709;&#x7EBF;&#x7A0B;&#x6267;&#x884C;&#x7684;&#x4EFB;&#x52A1;&#x4E0D;&#x540C;&#xFF08;&#x5373;&#x5404;&#x7EBF;&#x7A0B;&#x5173;&#x8054;&#x4E8E;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#x7684;&#x5224;&#x5B9A;&#x6761;&#x4EF6;&#x4E0D;&#x540C;&#xFF09;&#x3002;</p>
<p>&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#x5E76;&#x4E0D;&#x4FDD;&#x5B58;&#x72B6;&#x6001;&#x4FE1;&#x606F;&#xFF0C;&#x53EA;&#x662F;&#x4F20;&#x9012;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x72B6;&#x6001;&#x4FE1;&#x606F;&#x7684;&#x4E00;&#x79CD;&#x901A;&#x8BAF;&#x673A;&#x5236;&#x3002;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x65F6;&#x82E5;&#x65E0;&#x4EFB;&#x4F55;&#x7EBF;&#x7A0B;&#x5728;&#x7B49;&#x5F85;&#x8BE5;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#xFF0C;&#x8FD9;&#x4E2A;&#x4FE1;&#x53F7;&#x4E5F;&#x5C31;&#x4F1A;&#x4E0D;&#x4E86;&#x4E86;&#x4E4B;&#x3002;&#x7EBF;&#x7A0B;&#x5982;&#x5728;&#x6B64;&#x540E;&#x7B49;&#x5F85;&#x8BE5;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#xFF0C;&#x53EA;&#x6709;&#x5F53;&#x518D;&#x6B21;&#x6536;&#x5230;&#x6B64;&#x53D8;&#x91CF;&#x7684;&#x4E0B;&#x4E00;&#x4FE1;&#x53F7;&#x65F6;&#xFF0C;&#x65B9;&#x53EF;&#x89E3;&#x9664;&#x963B;&#x585E;&#x72B6;&#x6001;&#x3002;</p>
<p>&#x51FD;&#x6570;pthread_cond_timedwait()&#x4E0E;&#x51FD;&#x6570;pthread_cond_wait()&#x51E0;&#x8FD1;&#x76F8;&#x540C;&#xFF0C;&#x552F;&#x4E00;&#x7684;&#x533A;&#x522B;&#x5728;&#x4E8E;&#xFF0C;&#x7531;&#x53C2;&#x6570;abstime&#x6765;&#x6307;&#x5B9A;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x7B49;&#x5F85;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#x901A;&#x77E5;&#x65F6;&#x4F11;&#x7720;&#x65F6;&#x95F4;&#x7684;&#x4E0A;&#x9650;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;pthread.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">pthread_cond_timedwait</span><span class="token punctuation">(</span>pthread_cond_t <span class="token operator">*</span>cond<span class="token punctuation">,</span>pthread_mutex_t <span class="token operator">*</span>mutex<span class="token punctuation">,</span><span class="token keyword">const</span> <span class="token keyword">struct</span> timespec <span class="token operator">*</span>abstime<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x53C2;&#x6570;abstime&#x662F;&#x4E00;&#x4E2A;timespec&#x7C7B;&#x578B;&#x7684;&#x7ED3;&#x6784;&#xFF0C;&#x7528;&#x4EE5;&#x6307;&#x5B9A;&#x81EA;Epoch&#x4EE5;&#x6765;&#x4EE5;&#x79D2;&#x548C;&#x7EB3;&#x79D2;&#xFF08;nanosecond&#xFF09;&#x4E3A;&#x5355;&#x4F4D;&#x8868;&#x793A;&#x7684;&#x7EDD;&#x5BF9;&#xFF08;absolute&#xFF09;&#x65F6;&#x95F4;&#x3002;&#x5982;&#x679C;abstime&#x6307;&#x5B9A;&#x7684;&#x65F6;&#x95F4;&#x95F4;&#x9694;&#x5230;&#x671F;&#x4E14;&#x65E0;&#x76F8;&#x5173;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#x7684;&#x901A;&#x77E5;&#xFF0C;&#x5219;&#x8FD4;&#x56DE;ETIMEOUT&#x9519;&#x8BEF;&#x3002;</p>
<p><strong>&#x4F8B;1:</strong></p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;pthread.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;unistd.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;string.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdlib.h&gt;</span></span>

<span class="token keyword">static</span> pthread_mutex_t mtx<span class="token operator">=</span>PTHREAD_MUTEX_INITIALIZER<span class="token punctuation">;</span>
<span class="token keyword">static</span> pthread_cond_t cond<span class="token operator">=</span>PTHREAD_COND_INITIALIZER<span class="token punctuation">;</span>

<span class="token keyword">struct</span> node <span class="token punctuation">{</span>
    <span class="token keyword">int</span> n_number<span class="token punctuation">;</span>
    <span class="token keyword">struct</span> node <span class="token operator">*</span>n_next<span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token operator">*</span>head<span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/*[thread_func]*/</span>

<span class="token comment" spellcheck="true">/*&#x91CA;&#x653E;&#x8282;&#x70B9;&#x5185;&#x5B58;*/</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">cleanup_handler</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token operator">*</span>arg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Clean up handler of second thread.\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">free</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token function">pthread_mutex_unlock</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>mtx<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token operator">*</span><span class="token function">thread_func</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>arg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">struct</span> node<span class="token operator">*</span>p<span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">;</span>
    <span class="token function">pthread_cleanup_push</span><span class="token punctuation">(</span>cleanup_handler<span class="token punctuation">,</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">pthread_mutex_lock</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>mtx<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//&#x8FD9;&#x4E2A;mutex_lock&#x4E3B;&#x8981;&#x662F;&#x7528;&#x6765;&#x4FDD;&#x62A4;wait&#x7B49;&#x5F85;&#x4E34;&#x754C;&#x65F6;&#x671F;&#x7684;&#x60C5;&#x51B5;&#xFF0C;</span>
    <span class="token comment" spellcheck="true">//&#x5F53;&#x5728;wait&#x4E3A;&#x653E;&#x5165;&#x961F;&#x5217;&#x65F6;&#xFF0C;&#x8FD9;&#x65F6;&#xFF0C;&#x5DF2;&#x7ECF;&#x5B58;&#x5728;Head&#x6761;&#x4EF6;&#x7B49;&#x5F85;&#x6FC0;&#x6D3B;</span>
    <span class="token comment" spellcheck="true">//&#x7684;&#x6761;&#x4EF6;&#xFF0C;&#x6B64;&#x65F6;&#x53EF;&#x80FD;&#x4F1A;&#x6F0F;&#x6389;&#x8FD9;&#x79CD;&#x5904;&#x7406;</span>
    <span class="token comment" spellcheck="true">//&#x8FD9;&#x4E2A;while&#x8981;&#x7279;&#x522B;&#x8BF4;&#x660E;&#x4E00;&#x4E0B;&#xFF0C;&#x5355;&#x4E2A;pthread_cond_wait&#x529F;&#x80FD;&#x5F88;&#x5B8C;&#x5584;&#xFF0C;</span>
    <span class="token comment" spellcheck="true">//&#x4E3A;&#x4F55;&#x8FD9;&#x91CC;&#x8981;&#x6709;&#x4E00;&#x4E2A;while(head==NULL)&#x5462;&#xFF1F;&#x56E0;&#x4E3A;pthread_cond_wait</span>
    <span class="token comment" spellcheck="true">//&#x91CC;&#x7684;&#x7EBF;&#x7A0B;&#x53EF;&#x80FD;&#x4F1A;&#x88AB;&#x610F;&#x5916;&#x5524;&#x9192;&#xFF0C;&#x5982;&#x679C;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;head==NULL&#xFF0C;</span>
    <span class="token comment" spellcheck="true">//&#x5219;&#x4E0D;&#x662F;&#x6211;&#x4EEC;&#x60F3;&#x8981;&#x7684;&#x60C5;&#x51B5;&#x3002;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#xFF0C;</span>
    <span class="token comment" spellcheck="true">//&#x5E94;&#x8BE5;&#x8BA9;&#x7EBF;&#x7A0B;&#x7EE7;&#x7EED;&#x8FDB;&#x5165;pthread_cond_wait</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>head<span class="token operator">==</span><span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">pthread_cond_wait</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>cond<span class="token punctuation">,</span><span class="token operator">&amp;</span>mtx<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment" spellcheck="true">//pthread_cond_wait&#x4F1A;&#x5148;&#x89E3;&#x9664;&#x4E4B;&#x524D;&#x7684;pthread_mutex_lock&#x9501;&#x5B9A;&#x7684;mtx&#xFF0C;</span>
        <span class="token comment" spellcheck="true">//&#x7136;&#x540E;&#x963B;&#x585E;&#x5728;&#x7B49;&#x5F85;&#x961F;&#x5217;&#x91CC;&#x4F11;&#x7720;&#xFF0C;&#x76F4;&#x5230;&#x518D;&#x6B21;&#x88AB;&#x5524;&#x9192;</span>
        <span class="token comment" spellcheck="true">//&#xFF08;&#x5927;&#x591A;&#x6570;&#x60C5;&#x51B5;&#x4E0B;&#x662F;&#x7B49;&#x5F85;&#x7684;&#x6761;&#x4EF6;&#x6210;&#x7ACB;&#x800C;&#x88AB;&#x5524;&#x9192;&#xFF0C;&#x5524;&#x9192;&#x540E;&#xFF0C;</span>
        <span class="token comment" spellcheck="true">//&#x8BE5;&#x8FDB;&#x7A0B;&#x4F1A;&#x5148;&#x9501;&#x5B9A;&#x5148;pthread_mutex_lock(&amp;mtx);&#xFF0C;</span>
        <span class="token comment" spellcheck="true">//&#x518D;&#x8BFB;&#x53D6;&#x8D44;&#x6E90;&#x7528;&#x8FD9;&#x4E2A;&#x6D41;&#x7A0B;&#x662F;&#x6BD4;&#x8F83;&#x6E05;&#x695A;&#x7684;</span>
        <span class="token comment" spellcheck="true">/*block--&gt;unlock--&gt;wait()return--&gt;lock*/</span>
        p<span class="token operator">=</span>head<span class="token punctuation">;</span>
        head<span class="token operator">=</span>head<span class="token operator">-&gt;</span>n_next<span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Got%dfromfrontofqueue\n&quot;</span><span class="token punctuation">,</span>p<span class="token operator">-&gt;</span>n_number<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">free</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">pthread_mutex_unlock</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>mtx<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//&#x4E34;&#x754C;&#x533A;&#x6570;&#x636E;&#x64CD;&#x4F5C;&#x5B8C;&#x6BD5;&#xFF0C;&#x91CA;&#x653E;&#x4E92;&#x65A5;&#x9501;</span>

    <span class="token function">pthread_cleanup_pop</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    pthread_t tid<span class="token punctuation">;</span>
    <span class="token keyword">int</span> i<span class="token punctuation">;</span>
    <span class="token keyword">struct</span> node <span class="token operator">*</span>p<span class="token punctuation">;</span>
    <span class="token function">pthread_create</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>tid<span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">,</span>thread_func<span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//&#x5B50;&#x7EBF;&#x7A0B;&#x4F1A;&#x4E00;&#x76F4;&#x7B49;&#x5F85;&#x8D44;&#x6E90;&#xFF0C;&#x7C7B;&#x4F3C;&#x751F;&#x4EA7;&#x8005;&#x548C;&#x6D88;&#x8D39;&#x8005;&#xFF0C;</span>
    <span class="token comment" spellcheck="true">//&#x4F46;&#x662F;&#x8FD9;&#x91CC;&#x7684;&#x6D88;&#x8D39;&#x8005;&#x53EF;&#x4EE5;&#x662F;&#x591A;&#x4E2A;&#x6D88;&#x8D39;&#x8005;&#xFF0C;</span>
    <span class="token comment" spellcheck="true">//&#x800C;&#x4E0D;&#x4EC5;&#x4EC5;&#x652F;&#x6301;&#x666E;&#x901A;&#x7684;&#x5355;&#x4E2A;&#x6D88;&#x8D39;&#x8005;&#xFF0C;&#x8FD9;&#x4E2A;&#x6A21;&#x578B;&#x867D;&#x7136;&#x7B80;&#x5355;&#xFF0C;</span>
    <span class="token comment" spellcheck="true">//&#x4F46;&#x662F;&#x5F88;&#x5F3A;&#x5927;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">10</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        p<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">struct</span> node<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> node<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        p<span class="token operator">-&gt;</span>n_number<span class="token operator">=</span>i<span class="token punctuation">;</span>
        <span class="token function">pthread_mutex_lock</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>mtx<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//&#x9700;&#x8981;&#x64CD;&#x4F5C;head&#x8FD9;&#x4E2A;&#x4E34;&#x754C;&#x8D44;&#x6E90;&#xFF0C;&#x5148;&#x52A0;&#x9501;&#xFF0C;</span>
        p<span class="token operator">-&gt;</span>n_next<span class="token operator">=</span>head<span class="token punctuation">;</span>
        head<span class="token operator">=</span>p<span class="token punctuation">;</span>
        <span class="token function">pthread_cond_signal</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>cond<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">pthread_mutex_unlock</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>mtx<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//&#x89E3;&#x9501;</span>
        <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;thread1wannaendthecancelthread2.\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">pthread_cancel</span><span class="token punctuation">(</span>tid<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//&#x5173;&#x4E8E;pthread_cancel&#xFF0C;&#x6709;&#x4E00;&#x70B9;&#x989D;&#x5916;&#x7684;&#x8BF4;&#x660E;&#xFF0C;&#x5B83;&#x662F;&#x4ECE;&#x5916;&#x90E8;&#x7EC8;&#x6B62;&#x5B50;&#x7EBF;&#x7A0B;&#xFF0C;</span>
    <span class="token comment" spellcheck="true">//&#x5B50;&#x7EBF;&#x7A0B;&#x4F1A;&#x5728;&#x6700;&#x8FD1;&#x7684;&#x53D6;&#x6D88;&#x70B9;&#xFF0C;&#x9000;&#x51FA;&#x7EBF;&#x7A0B;&#xFF0C;&#x800C;&#x5728;&#x6211;&#x4EEC;&#x7684;&#x4EE3;&#x7801;&#x91CC;&#xFF0C;&#x6700;&#x8FD1;&#x7684;</span>
    <span class="token comment" spellcheck="true">//&#x53D6;&#x6D88;&#x70B9;&#x80AF;&#x5B9A;&#x5C31;&#x662F;pthread_cond_wait()&#x4E86;&#x3002;</span>
    <span class="token function">pthread_join</span><span class="token punctuation">(</span>tid<span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Alldone--exiting\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-bash"><code class="language-bash">g++ main.cpp -pthread<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre><code>Got0fromfrontofqueue
Got1fromfrontofqueue
Got2fromfrontofqueue
Got3fromfrontofqueue
Got4fromfrontofqueue
Got5fromfrontofqueue
Got6fromfrontofqueue
Got7fromfrontofqueue
Got8fromfrontofqueue
Got9fromfrontofqueue
thread1wannaendthecancelthread2.
Clean up handler of second thread.
Alldone--exiting</code></pre><h3 id="&#x6D4B;&#x8BD5;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#x7684;&#x5224;&#x65AD;&#x6761;&#x4EF6;&#xFF08;predicate&#xFF09;"><a href="#&#x6D4B;&#x8BD5;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#x7684;&#x5224;&#x65AD;&#x6761;&#x4EF6;&#xFF08;predicate&#xFF09;" class="headerlink" title="&#x6D4B;&#x8BD5;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#x7684;&#x5224;&#x65AD;&#x6761;&#x4EF6;&#xFF08;predicate&#xFF09;"></a>&#x6D4B;&#x8BD5;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#x7684;&#x5224;&#x65AD;&#x6761;&#x4EF6;&#xFF08;predicate&#xFF09;</h3><p>&#x6BCF;&#x4E2A;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#x90FD;&#x6709;&#x4E0E;&#x4E4B;&#x76F8;&#x5173;&#x7684;&#x5224;&#x65AD;&#x6761;&#x4EF6;&#xFF0C;&#x6D89;&#x53CA;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x5728;&#x4E0A;&#x4E00;&#x8282;&#x7684;&#x4EE3;&#x7801;&#x4E2D;&#xFF0C;&#x4E0E;cond&#x76F8;&#x5173;&#x7684;&#x5224;&#x65AD;&#x662F;(avail == 0)&#x3002;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x5C55;&#x793A;&#x4E86;&#x4E00;&#x4E2A;&#x901A;&#x7528;&#x7684;&#x8BBE;&#x8BA1;&#x539F;&#x5219;&#xFF1A;&#x5FC5;&#x987B;&#x7531;&#x4E00;&#x4E2A;while&#x5FAA;&#x73AF;&#xFF0C;&#x800C;&#x4E0D;&#x662F;if&#x8BED;&#x53E5;&#xFF0C;&#x6765;&#x63A7;&#x5236;&#x5BF9;pthread_cond_wait()&#x7684;&#x8C03;&#x7528;&#x3002;&#x8FD9;&#x662F;&#x56E0;&#x4E3A;&#xFF0C;&#x5F53;&#x4EE3;&#x7801;&#x4ECE;pthread_cond_wait()&#x8FD4;&#x56DE;&#x65F6;&#xFF0C;&#x5E76;&#x4E0D;&#x80FD;&#x786E;&#x5B9A;&#x5224;&#x65AD;&#x6761;&#x4EF6;&#x7684;&#x72B6;&#x6001;&#xFF0C;&#x6240;&#x4EE5;&#x5E94;&#x8BE5;&#x7ACB;&#x5373;&#x91CD;&#x65B0;&#x68C0;&#x67E5;&#x5224;&#x65AD;&#x6761;&#x4EF6;&#xFF0C;&#x5728;&#x6761;&#x4EF6;&#x4E0D;&#x6EE1;&#x8DB3;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x7EE7;&#x7EED;&#x4F11;&#x7720;&#x7B49;&#x5F85;&#x3002;</p>
<p>&#x4ECE;pthread_cond_wait()&#x8FD4;&#x56DE;&#x65F6;&#xFF0C;&#x4E4B;&#x6240;&#x4EE5;&#x4E0D;&#x80FD;&#x5BF9;&#x5224;&#x65AD;&#x6761;&#x4EF6;&#x7684;&#x72B6;&#x6001;&#x505A;&#x4EFB;&#x4F55;&#x5047;&#x8BBE;&#xFF0C;&#x5176;&#x7406;&#x7531;&#x5982;&#x4E0B;&#x3002;</p>
<ul>
<li>&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x53EF;&#x80FD;&#x4F1A;&#x7387;&#x5148;&#x9192;&#x6765;&#x3002;&#x4E5F;&#x8BB8;&#x6709;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x5728;&#x7B49;&#x5F85;&#x83B7;&#x53D6;&#x4E0E;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#x76F8;&#x5173;&#x7684;&#x4E92;&#x65A5;&#x91CF;&#x3002;&#x5373;&#x4F7F;&#x5C31;&#x4E92;&#x65A5;&#x91CF;&#x53D1;&#x51FA;&#x901A;&#x77E5;&#x7684;&#x7EBF;&#x7A0B;&#x5C06;&#x5224;&#x65AD;&#x6761;&#x4EF6;&#x7F6E;&#x4E3A;&#x9884;&#x671F;&#x72B6;&#x6001;&#xFF0C;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x4F9D;&#x7136;&#x6709;&#x53EF;&#x80FD;&#x7387;&#x5148;&#x83B7;&#x53D6;&#x4E92;&#x65A5;&#x91CF;&#x5E76;&#x6539;&#x53D8;&#x76F8;&#x5173;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#x7684;&#x72B6;&#x6001;&#xFF0C;&#x8FDB;&#x800C;&#x6539;&#x53D8;&#x5224;&#x65AD;&#x6761;&#x4EF6;&#x7684;&#x72B6;&#x6001;&#x3002;</li>
<li>&#x8BBE;&#x8BA1;&#x65F6;&#x8BBE;&#x7F6E;&#x201C;&#x5BBD;&#x677E;&#x7684;&#x201D;&#x5224;&#x65AD;&#x6761;&#x4EF6;&#x6216;&#x8BB8;&#x66F4;&#x4E3A;&#x7B80;&#x5355;&#x3002;&#x6709;&#x65F6;&#xFF0C;&#x7528;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#x6765;&#x8868;&#x5F81;&#x53EF;&#x80FD;&#x6027;&#x800C;&#x975E;&#x786E;&#x5B9A;&#x6027;&#xFF0C;&#x5728;&#x8BBE;&#x8BA1;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x65F6;&#x4F1A;&#x66F4;&#x4E3A;&#x7B80;&#x5355;&#x3002;&#x6362;&#x8A00;&#x4E4B;&#xFF0C;&#x5C31;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x610F;&#x5473;&#x7740;&#x201C;&#x53EF;&#x80FD;&#x6709;&#x4E9B;&#x4E8B;&#x60C5;&#x201D;&#x9700;&#x8981;&#x63A5;&#x6536;&#x4FE1;&#x53F7;&#x7684;&#x7EBF;&#x7A0B;&#x53BB;&#x54CD;&#x5E94;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x201C;&#x4E00;&#x5B9A;&#x6709;&#x4E00;&#x4E9B;&#x4E8B;&#x60C5;&#x201D;&#x8981;&#x505A;&#x3002;&#x4F7F;&#x7528;&#x8FD9;&#x79CD;&#x65B9;&#x6CD5;&#xFF0C;&#x53EF;&#x4EE5;&#x57FA;&#x4E8E;&#x5224;&#x65AD;&#x6761;&#x4EF6;&#x7684;&#x8FD1;&#x4F3C;&#x60C5;&#x51B5;&#x6765;&#x53D1;&#x9001;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#x901A;&#x77E5;&#xFF0C;&#x63A5;&#x6536;&#x4FE1;&#x53F7;&#x7684;&#x7EBF;&#x7A0B;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x518D;&#x6B21;&#x68C0;&#x67E5;&#x5224;&#x65AD;&#x6761;&#x4EF6;&#x6765;&#x786E;&#x5B9A;&#x662F;&#x5426;&#x771F;&#x7684;&#x9700;&#x8981;&#x505A;&#x4E9B;&#x4EC0;&#x4E48;&#x3002;</li>
<li>&#x53EF;&#x80FD;&#x4F1A;&#x53D1;&#x751F;&#x865A;&#x5047;&#x5524;&#x9192;&#x7684;&#x60C5;&#x51B5;&#x3002;&#x5728;&#x4E00;&#x4E9B;&#x5B9E;&#x73B0;&#x4E2D;&#xFF0C;&#x5373;&#x4F7F;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x771F;&#x5730;&#x5C31;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#x53D1;&#x51FA;&#x4FE1;&#x53F7;&#xFF0C;&#x7B49;&#x5F85;&#x6B64;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#x7684;&#x7EBF;&#x7A0B;&#x4ECD;&#x6709;&#x53EF;&#x80FD;&#x9192;&#x6765;&#x3002;&#x5728;&#x4E00;&#x4E9B;&#x591A;&#x5904;&#x7406;&#x5668;&#x7CFB;&#x7EDF;&#x4E0A;&#xFF0C;&#x4E3A;&#x786E;&#x4FDD;&#x9AD8;&#x6548;&#x5B9E;&#x73B0;&#x800C;&#x91C7;&#x7528;&#x7684;&#x6280;&#x672F;&#x4F1A;&#x5BFC;&#x81F4;&#x6B64;&#x7C7B;&#xFF08;&#x4E0D;&#x5E38;&#x89C1;&#x7684;&#xFF09;&#x865A;&#x5047;&#x5524;&#x9192;&#x3002;SUSv3&#x5BF9;&#x6B64;&#x4E88;&#x4EE5;&#x660E;&#x786E;&#x8BA4;&#x53EF;&#x3002;</li>
</ul>
<h2 id="&#x52A8;&#x6001;&#x5206;&#x914D;&#x7684;&#x6761;&#x4EF6;&#x53D8;&#x91CF;"><a href="#&#x52A8;&#x6001;&#x5206;&#x914D;&#x7684;&#x6761;&#x4EF6;&#x53D8;&#x91CF;" class="headerlink" title="&#x52A8;&#x6001;&#x5206;&#x914D;&#x7684;&#x6761;&#x4EF6;&#x53D8;&#x91CF;"></a>&#x52A8;&#x6001;&#x5206;&#x914D;&#x7684;&#x6761;&#x4EF6;&#x53D8;&#x91CF;</h2><p>&#x4F7F;&#x7528;&#x51FD;&#x6570; pthread_cond_init()&#x5BF9;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#x8FDB;&#x884C;&#x52A8;&#x6001;&#x521D;&#x59CB;&#x5316;&#x3002;&#x9700;&#x8981;&#x4F7F;&#x7528; pthread_cond_init()&#x7684;&#x60C5;&#x5F62;&#x7C7B;&#x4F3C;&#x4E8E;&#x4F7F;&#x7528; pthread_mutex_init()&#x6765;&#x52A8;&#x6001;&#x521D;&#x59CB;&#x5316;&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x60C5;&#x51B5;&#x3002;&#x4EA6;&#x5373;&#xFF0C;&#x5BF9;&#x81EA;&#x52A8;&#x6216;&#x52A8;&#x6001;&#x5206;&#x914D;&#x7684;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#x8FDB;&#x884C;&#x521D;&#x59CB;&#x5316;&#x65F6;&#xFF0C;&#x6216;&#x662F;&#x5BF9;&#x672A;&#x91C7;&#x7528;&#x9ED8;&#x8BA4;&#x5C5E;&#x6027;&#x7ECF;&#x7531;&#x9759;&#x6001;&#x5206;&#x914D;&#x7684;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#x8FDB;&#x884C;&#x521D;&#x59CB;&#x5316;&#x65F6;&#xFF0C;&#x5FC5;&#x987B;&#x4F7F;&#x7528;pthread_cond_init()&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;pthread.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">pthread_cond_init</span><span class="token punctuation">(</span>pthread_cond_t <span class="token operator">*</span>cond<span class="token punctuation">,</span> <span class="token keyword">const</span> pthread_condattr_t <span class="token operator">*</span>attr<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x53C2;&#x6570;cond&#x8868;&#x793A;&#x5C06;&#x8981;&#x521D;&#x59CB;&#x5316;&#x7684;&#x76EE;&#x6807;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#x3002;&#x7C7B;&#x4F3C;&#x4E8E;&#x4E92;&#x65A5;&#x91CF;&#xFF0C;&#x53EF;&#x4EE5;&#x6307;&#x5B9A;&#x4E4B;&#x524D;&#x7ECF;&#x7531;&#x521D;&#x59CB;&#x5316;&#x5904;&#x7406;&#x7684; attr &#x53C2;&#x6570;&#x6765;&#x5224;&#x5B9A;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#x7684;&#x5C5E;&#x6027;&#x3002;&#x5BF9;&#x4E8E; attr &#x6240;&#x6307;&#x5411;&#x7684; pthread_condattr_t &#x7C7B;&#x578B;&#x5BF9;&#x8C61;&#xFF0C;&#x53EF;&#x4F7F;&#x7528;&#x591A;&#x4E2A;Pthreads&#x51FD;&#x6570;&#x5BF9;&#x5176;&#x4E2D;&#x5C5E;&#x6027;&#x8FDB;&#x884C;&#x521D;&#x59CB;&#x5316;&#x3002;&#x82E5;&#x5C06;attr&#x7F6E;&#x4E3A;NULL&#xFF0C;&#x5219;&#x4F7F;&#x7528;&#x4E00;&#x7EC4;&#x7F3A;&#x7701;&#x5C5E;&#x6027;&#x6765;&#x8BBE;&#x7F6E;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#x3002;</p>
<p>SUSv3&#x89C4;&#x5B9A;&#xFF0C;&#x5BF9;&#x4E1A;&#x5DF2;&#x521D;&#x59CB;&#x5316;&#x7684;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#x8FDB;&#x884C;&#x518D;&#x6B21;&#x521D;&#x59CB;&#x5316;&#xFF0C;&#x5C06;&#x5BFC;&#x81F4;&#x672A;&#x5B9A;&#x4E49;&#x7684;&#x884C;&#x4E3A;&#x3002;&#x5E94;&#x5F53;&#x907F;&#x514D;&#x8FD9;&#x4E00;&#x505A;&#x6CD5;&#x3002;</p>
<p>&#x5F53;&#x4E0D;&#x518D;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x7ECF;&#x7531;&#x81EA;&#x52A8;&#x6216;&#x52A8;&#x6001;&#x5206;&#x914D;&#x7684;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#x65F6;&#xFF0C;&#x5E94;&#x8C03;&#x7528;pthread_cond_destroy()&#x51FD;&#x6570;&#x4E88;&#x4EE5;&#x9500;&#x6BC1;&#x3002;&#x5BF9;&#x4E8E;&#x4F7F;&#x7528;PTHREAD_COND_INITIALIZER&#x8FDB;&#x884C;&#x9759;&#x6001;&#x521D;&#x59CB;&#x5316;&#x7684;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#xFF0C;&#x65E0;&#x9700;&#x8C03;&#x7528;pthread_cond_destroy()&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;pthread.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">pthread_cond_destroy</span><span class="token punctuation">(</span>pthread_cond_t <span class="token operator">*</span>cond<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x5BF9;&#x67D0;&#x4E2A;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#x800C;&#x8A00;&#xFF0C;&#x4EC5;&#x5F53;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x7EBF;&#x7A0B;&#x5728;&#x7B49;&#x5F85;&#x5B83;&#x65F6;&#xFF0C;&#x5C06;&#x5176;&#x9500;&#x6BC1;&#x624D;&#x662F;&#x5B89;&#x5168;&#x7684;&#x3002;&#x5982;&#x679C;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#x9A7B;&#x7559;&#x4E8E;&#x67D0;&#x7247;&#x52A8;&#x6001;&#x521B;&#x5EFA;&#x7684;&#x5185;&#x5B58;&#x533A;&#x57DF;&#xFF0C;&#x90A3;&#x4E48;&#x5E94;&#x5728;&#x91CA;&#x653E;&#x8BE5;&#x5185;&#x5B58;&#x533A;&#x57DF;&#x524D;&#x5C31;&#x5C06;&#x5176;&#x9500;&#x6BC1;&#x3002;&#x7ECF;&#x7531;&#x81EA;&#x52A8;&#x5206;&#x914D;&#x7684;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#x5E94;&#x5728;&#x5BBF;&#x4E3B;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x524D;&#x4E88;&#x4EE5;&#x9500;&#x6BC1;&#x3002;</p>
<p>&#x7ECF;pthread_cond_destroy()&#x9500;&#x6BC1;&#x7684;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#xFF0C;&#x4E4B;&#x540E;&#x53EF;&#x4EE5;&#x8C03;&#x7528;pthread_cond_init()&#x5BF9;&#x5176;&#x8FDB;&#x884C;&#x91CD;&#x65B0;&#x521D;&#x59CB;&#x5316;&#x3002;                                </p>
<h1 id="&#x7EBF;&#x7A0B;&#xFF1A;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x548C;&#x6BCF;&#x7EBF;&#x7A0B;&#x5B58;&#x50A8;"><a href="#&#x7EBF;&#x7A0B;&#xFF1A;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x548C;&#x6BCF;&#x7EBF;&#x7A0B;&#x5B58;&#x50A8;" class="headerlink" title="&#x7EBF;&#x7A0B;&#xFF1A;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x548C;&#x6BCF;&#x7EBF;&#x7A0B;&#x5B58;&#x50A8;"></a>&#x7EBF;&#x7A0B;&#xFF1A;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x548C;&#x6BCF;&#x7EBF;&#x7A0B;&#x5B58;&#x50A8;</h1><h2 id="&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#xFF08;&#x518D;&#x8BBA;&#x53EF;&#x91CD;&#x5165;&#x6027;&#xFF09;"><a href="#&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#xFF08;&#x518D;&#x8BBA;&#x53EF;&#x91CD;&#x5165;&#x6027;&#xFF09;" class="headerlink" title="&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#xFF08;&#x518D;&#x8BBA;&#x53EF;&#x91CD;&#x5165;&#x6027;&#xFF09;"></a>&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#xFF08;&#x518D;&#x8BBA;&#x53EF;&#x91CD;&#x5165;&#x6027;&#xFF09;</h2><p>&#x82E5;&#x51FD;&#x6570;&#x53EF;&#x540C;&#x65F6;&#x4F9B;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x8C03;&#x7528;&#xFF0C;&#x5219;&#x79F0;&#x4E4B;&#x4E3A;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x51FD;&#x6570;&#xFF1B;&#x53CD;&#x4E4B;&#xFF0C;&#x5982;&#x679C;&#x51FD;&#x6570;&#x4E0D;&#x662F;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#xFF0C;&#x5219;&#x4E0D;&#x80FD;&#x5E76;&#x53D1;&#x8C03;&#x7528;&#x3002;</p>
<p>&#x5B9E;&#x73B0;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x6709;&#x591A;&#x79CD;&#x65B9;&#x5F0F;&#x3002;&#x5176;&#x4E00;&#x662F;&#x5C06;&#x51FD;&#x6570;&#x4E0E;&#x4E92;&#x65A5;&#x91CF;&#x5173;&#x8054;&#x4F7F;&#x7528;&#xFF08;&#x5982;&#x679C;&#x51FD;&#x6570;&#x5E93;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x51FD;&#x6570;&#x90FD;&#x5171;&#x4EAB;&#x540C;&#x6837;&#x7684;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#xFF0C;&#x90A3;&#x4E48;&#x6216;&#x8BB8;&#x5E94;&#x5C06;&#x6240;&#x6709;&#x51FD;&#x6570;&#x90FD;&#x4E0E;&#x8BE5;&#x4E92;&#x65A5;&#x91CF;&#x76F8;&#x5173;&#x8054;&#xFF09;&#xFF0C;&#x5728;&#x8C03;&#x7528;&#x51FD;&#x6570;&#x65F6;&#x5C06;&#x5176;&#x9501;&#x5B9A;&#xFF0C;&#x5728;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x65F6;&#x89E3;&#x9501;&#x3002;&#x8FD9;&#x4E00;&#x65B9;&#x6CD5;&#x7684;&#x4F18;&#x70B9;&#x5728;&#x4E8E;&#x7B80;&#x5355;&#x3002;&#x53E6;&#x4E00;&#x65B9;&#x9762;&#xFF0C;&#x8FD9;&#x4E5F;&#x610F;&#x5473;&#x7740;&#x540C;&#x65F6;&#x53EA;&#x80FD;&#x6709;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x6267;&#x884C;&#x8BE5;&#x51FD;&#x6570;&#xFF0C;&#x4EA6;&#x5373;&#xFF0C;&#x5BF9;&#x8BE5;&#x51FD;&#x6570;&#x7684;&#x8BBF;&#x95EE;&#x662F;&#x4E32;&#x884C;&#x7684;&#xFF08;serialized&#xFF09;&#x3002;&#x5982;&#x679C;&#x5404;&#x7EBF;&#x7A0B;&#x5728;&#x6267;&#x884C;&#x6B64;&#x51FD;&#x6570;&#x65F6;&#x90FD;&#x8017;&#x8D39;&#x4E86;&#x76F8;&#x5F53;&#x591A;&#x7684;&#x65F6;&#x95F4;&#xFF0C;&#x90A3;&#x4E48;&#x4E32;&#x884C;&#x5316;&#x4F1A;&#x5BFC;&#x81F4;&#x5E76;&#x53D1;&#x80FD;&#x529B;&#x7684;&#x4E27;&#x5931;&#xFF0C;&#x6240;&#x6709;&#x7EBF;&#x7A0B;&#x5C06;&#x4E0D;&#x518D;&#x5E76;&#x53D1;&#x6267;&#x884C;&#x3002;</p>
<p>&#x53E6;&#x4E00;&#x79CD;&#x66F4;&#x4E3A;&#x590D;&#x6742;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x662F;&#xFF1A;&#x5C06;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#x4E0E;&#x4E92;&#x65A5;&#x91CF;&#x5173;&#x8054;&#x8D77;&#x6765;&#x3002;&#x8FD9;&#x9700;&#x8981;&#x7A0B;&#x5E8F;&#x5458;&#x4EEC;&#x786E;&#x8BA4;&#x51FD;&#x6570;&#x7684;&#x54EA;&#x4E9B;&#x90E8;&#x5206;&#x662F;&#x4F7F;&#x7528;&#x4E86;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#x7684;&#x4E34;&#x754C;&#x533A;&#xFF0C;&#x4E14;&#x4EC5;&#x5728;&#x6267;&#x884C;&#x5230;&#x4E34;&#x754C;&#x533A;&#x65F6;&#x53BB;&#x83B7;&#x53D6;&#x548C;&#x91CA;&#x653E;&#x4E92;&#x65A5;&#x91CF;&#x3002;&#x8FD9;&#x5C06;&#x5141;&#x8BB8;&#x591A;&#x7EBF;&#x7A0B;&#x540C;&#x65F6;&#x6267;&#x884C;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x5E76;&#x5B9E;&#x73B0;&#x5E76;&#x884C;&#xFF0C;&#x9664;&#x975E;&#x51FA;&#x73B0;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x9700;&#x8981;&#x540C;&#x65F6;&#x6267;&#x884C;&#x540C;&#x4E00;&#x4E34;&#x754C;&#x533A;&#x7684;&#x60C5;&#x51B5;&#x3002;</p>
<h3 id="&#x975E;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#x51FD;&#x6570;"><a href="#&#x975E;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#x51FD;&#x6570;" class="headerlink" title="&#x975E;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#x51FD;&#x6570;"></a>&#x975E;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#x51FD;&#x6570;</h3><p>&#x4E3A;&#x4FBF;&#x4E8E;&#x5F00;&#x53D1;&#x591A;&#x7EBF;&#x7A0B;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#xFF0C;&#x9664;&#x4E0B;&#x8868;&#x6240;&#x5217;&#x51FD;&#x6570;&#x4EE5;&#x5916;&#xFF0C;SUSv3&#x4E2D;&#x7684;&#x6240;&#x6709;&#x51FD;&#x6570;&#x90FD;&#x9700;&#x5B9E;&#x73B0;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x3002;</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th align="left">&#x51FD;&#x6570;</th>
<th align="left">&#x51FD;&#x6570;</th>
<th align="left">&#x51FD;&#x6570;</th>
<th align="left">&#x51FD;&#x6570;</th>
</tr>
</thead>
<tbody><tr>
<td align="left">asctime()</td>
<td align="left">fcvt()</td>
<td align="left">getpwnam()</td>
<td align="left">nl_langinfo()</td>
</tr>
<tr>
<td align="left">basename()</td>
<td align="left">ftw()</td>
<td align="left">getpwuid()</td>
<td align="left">ptsname()</td>
</tr>
<tr>
<td align="left">catgets()</td>
<td align="left">gcvt()</td>
<td align="left">getservbyname()</td>
<td align="left">putc_unlocked()</td>
</tr>
<tr>
<td align="left">crypt()</td>
<td align="left">getc_unlocked()</td>
<td align="left">getservbyport()</td>
<td align="left">putchar_unlocked()</td>
</tr>
<tr>
<td align="left">ctime()</td>
<td align="left">getchar_unlocked()</td>
<td align="left">getservent()</td>
<td align="left">putenv()</td>
</tr>
<tr>
<td align="left">dbm_clearerr()</td>
<td align="left">getdate()</td>
<td align="left">getutxent()</td>
<td align="left">pututxline()</td>
</tr>
<tr>
<td align="left">dbm_close()</td>
<td align="left">getenv()</td>
<td align="left">getutxid()</td>
<td align="left">rand()</td>
</tr>
<tr>
<td align="left">dbm_delete()</td>
<td align="left">getgrent()</td>
<td align="left">getutxline()</td>
<td align="left">()</td>
</tr>
<tr>
<td align="left">dbm_error()</td>
<td align="left">getgrgid()</td>
<td align="left">gmtime()</td>
<td align="left">setenv()</td>
</tr>
<tr>
<td align="left">dbm_fetch()</td>
<td align="left">getgrnam()</td>
<td align="left">hcreate()</td>
<td align="left">setgrent()</td>
</tr>
<tr>
<td align="left">dbm_firstkey()</td>
<td align="left">gethostbyaddr()</td>
<td align="left">hdestroy()</td>
<td align="left">setkey()</td>
</tr>
<tr>
<td align="left">dbm_nextkey()</td>
<td align="left">gethostbyname()</td>
<td align="left">hsearch()</td>
<td align="left">setpwent()</td>
</tr>
<tr>
<td align="left">dbm_open()</td>
<td align="left">gethostent()</td>
<td align="left">inet_ntoa()</td>
<td align="left">setutxent()</td>
</tr>
<tr>
<td align="left">dbm_store()</td>
<td align="left">getlogin()</td>
<td align="left">l64a()</td>
<td align="left">strerror()</td>
</tr>
<tr>
<td align="left">dirname()</td>
<td align="left">getnetbyaddr()</td>
<td align="left">lgamma()</td>
<td align="left">strtok()</td>
</tr>
<tr>
<td align="left">dlerror()</td>
<td align="left">getnetbyname()</td>
<td align="left">lgammaf()</td>
<td align="left">ttyname()</td>
</tr>
<tr>
<td align="left">drand48()</td>
<td align="left">getnetent()</td>
<td align="left">lgammal()</td>
<td align="left">unsetenv()</td>
</tr>
<tr>
<td align="left">ecvt()</td>
<td align="left">getopt()</td>
<td align="left">localeconv()</td>
<td align="left">wcstombs()</td>
</tr>
<tr>
<td align="left">encrypt()</td>
<td align="left">getprotobyname()</td>
<td align="left">localtime()</td>
<td align="left">wctomb()</td>
</tr>
<tr>
<td align="left">endgrent()</td>
<td align="left">getprotobynumber()</td>
<td align="left">lrand48()</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">endpwent()</td>
<td align="left">getprotoent()</td>
<td align="left">mrand48()</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">endutxent()</td>
<td align="left">getpwent()</td>
<td align="left">nftw()</td>
<td align="left"></td>
</tr>
</tbody></table></div>
<h3 id="&#x53EF;&#x91CD;&#x5165;&#x548C;&#x4E0D;&#x53EF;&#x91CD;&#x5165;&#x51FD;&#x6570;"><a href="#&#x53EF;&#x91CD;&#x5165;&#x548C;&#x4E0D;&#x53EF;&#x91CD;&#x5165;&#x51FD;&#x6570;" class="headerlink" title="&#x53EF;&#x91CD;&#x5165;&#x548C;&#x4E0D;&#x53EF;&#x91CD;&#x5165;&#x51FD;&#x6570;"></a>&#x53EF;&#x91CD;&#x5165;&#x548C;&#x4E0D;&#x53EF;&#x91CD;&#x5165;&#x51FD;&#x6570;</h3><p>&#x8F83;&#x4E4B;&#x4E8E;&#x5BF9;&#x6574;&#x4E2A;&#x51FD;&#x6570;&#x4F7F;&#x7528;&#x4E92;&#x65A5;&#x91CF;&#xFF0C;&#x4F7F;&#x7528;&#x4E34;&#x754C;&#x533A;&#x5B9E;&#x73B0;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x867D;&#x7136;&#x6709;&#x660E;&#x663E;&#x6539;&#x8FDB;&#xFF0C;&#x4F46;&#x7531;&#x4E8E;&#x5B58;&#x5728;&#x5BF9;&#x4E92;&#x65A5;&#x91CF;&#x7684;&#x52A0;&#x9501;&#x548C;&#x89E3;&#x9501;&#x5F00;&#x9500;&#xFF0C;&#x6240;&#x4EE5;&#x591A;&#x5C11;&#x8FD8;&#x662F;&#x6709;&#x4E9B;&#x4F4E;&#x6548;&#x3002;&#x53EF;&#x91CD;&#x5165;&#x51FD;&#x6570;&#x5219;&#x65E0;&#x9700;&#x4F7F;&#x7528;&#x4E92;&#x65A5;&#x91CF;&#x5373;&#x53EF;&#x5B9E;&#x73B0;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x3002;&#x5176;&#x8981;&#x8BC0;&#x5728;&#x4E8E;&#x907F;&#x514D;&#x5BF9;&#x5168;&#x5C40;&#x548C;&#x9759;&#x6001;&#x53D8;&#x91CF;&#x7684;&#x4F7F;&#x7528;&#x3002;&#x9700;&#x8981;&#x8FD4;&#x56DE;&#x7ED9;&#x8C03;&#x7528;&#x8005;&#x7684;&#x4EFB;&#x4F55;&#x4FE1;&#x606F;&#xFF0C;&#x4EA6;&#x6216;&#x662F;&#x9700;&#x8981;&#x5728;&#x5BF9;&#x51FD;&#x6570;&#x7684;&#x5386;&#x6B21;&#x8C03;&#x7528;&#x95F4;&#x52A0;&#x4EE5;&#x7EF4;&#x62A4;&#x7684;&#x4FE1;&#x606F;&#xFF0C;&#x90FD;&#x5B58;&#x50A8;&#x4E8E;&#x7531;&#x8C03;&#x7528;&#x8005;&#x5206;&#x914D;&#x7684;&#x7F13;&#x51B2;&#x533A;&#x5185;&#x3002;&#x4E0D;&#x8FC7;&#xFF0C;&#x5E76;&#x975E;&#x6240;&#x6709;&#x51FD;&#x6570;&#x90FD;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x4E3A;&#x53EF;&#x91CD;&#x5165;&#xFF0C;&#x901A;&#x5E38;&#x7684;&#x539F;&#x56E0;&#x5982;&#x4E0B;&#x3002;</p>
<ul>
<li>&#x6839;&#x636E;&#x5176;&#x6027;&#x8D28;&#xFF0C;&#x6709;&#x4E9B;&#x51FD;&#x6570;&#x5FC5;&#x987B;&#x8BBF;&#x95EE;&#x5168;&#x5C40;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x3002;malloc &#x51FD;&#x6570;&#x5E93;&#x4E2D;&#x7684;&#x51FD;&#x6570;&#x5C31;&#x662F;&#x8FD9;&#x65B9;&#x9762;&#x7684;&#x5178;&#x8303;&#x3002;&#x8FD9;&#x4E9B;&#x51FD;&#x6570;&#x4E3A;&#x5806;&#x4E2D;&#x7684;&#x7A7A;&#x95F2;&#x5757;&#x7EF4;&#x62A4;&#x6709;&#x4E00;&#x4E2A;&#x5168;&#x5C40;&#x94FE;&#x8868;&#x3002;malloc &#x5E93;&#x51FD;&#x6570;&#x7684;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x662F;&#x901A;&#x8FC7;&#x4F7F;&#x7528;&#x4E92;&#x65A5;&#x91CF;&#x6765;&#x5B9E;&#x73B0;&#x7684;&#x3002;</li>
<li>&#x4E00;&#x4E9B;&#x51FD;&#x6570;&#xFF08;&#x5728;&#x53D1;&#x660E;&#x7EBF;&#x7A0B;&#x4E4B;&#x524D;&#x5C31;&#x5DF2;&#x95EE;&#x4E16;&#xFF09;&#x7684;&#x63A5;&#x53E3;&#x672C;&#x8EAB;&#x5C31;&#x5B9A;&#x4E49;&#x4E3A;&#x4E0D;&#x53EF;&#x91CD;&#x5165;&#xFF0C;&#x8981;&#x4E48;&#x8FD4;&#x56DE;&#x6307;&#x9488;&#xFF0C;&#x6307;&#x5411;&#x7531;&#x51FD;&#x6570;&#x81EA;&#x8EAB;&#x9759;&#x6001;&#x5206;&#x914D;&#x7684;&#x5B58;&#x50A8;&#x7A7A;&#x95F4;&#xFF0C;&#x8981;&#x4E48;&#x5229;&#x7528;&#x9759;&#x6001;&#x5B58;&#x50A8;&#x5BF9;&#x8BE5;&#x51FD;&#x6570;&#xFF08;&#x6216;&#x76F8;&#x5173;&#x51FD;&#x6570;&#xFF09;&#x5386;&#x6B21;&#x8C03;&#x7528;&#x95F4;&#x7684;&#x4FE1;&#x606F;&#x52A0;&#x4EE5;&#x7EF4;&#x62A4;&#x3002;&#x4E0A;&#x8868; &#x6240;&#x5217;&#x51FD;&#x6570;&#x5927;&#x591A;&#x5C5E;&#x4E8E;&#x6B64;&#x7C7B;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x51FD;&#x6570;asctime()&#xFF08;10.2.3&#x8282;&#xFF09;&#x5C31;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x6307;&#x9488;&#xFF0C;&#x6307;&#x5411;&#x7ECF;&#x7531;&#x9759;&#x6001;&#x5206;&#x914D;&#x7684;&#x7F13;&#x51B2;&#x533A;&#xFF0C;&#x5176;&#x5185;&#x5BB9;&#x4E3A;&#x65E5;&#x671F;&#x548C;&#x65F6;&#x95F4;&#x5B57;&#x7B26;&#x4E32;&#x3002;</li>
</ul>
<p>&#x5BF9;&#x4E8E;&#x4E00;&#x4E9B;&#x63A5;&#x53E3;&#x4E0D;&#x53EF;&#x91CD;&#x5165;&#x7684;&#x51FD;&#x6570;&#xFF0C;SUSv3&#x4E3A;&#x5176;&#x5B9A;&#x4E49;&#x4E86;&#x4EE5;&#x540E;&#x7F00;_r&#x7ED3;&#x5C3E;&#x7684;&#x53EF;&#x91CD;&#x5165;&#x201C;&#x66FF;&#x8EAB;&#x201D;&#x3002;&#x8FD9;&#x4E9B;&#x201C;&#x66FF;&#x8EAB;&#x201D;&#x51FD;&#x6570;&#x8981;&#x6C42;&#x7531;&#x8C03;&#x7528;&#x8005;&#x6765;&#x5206;&#x914D;&#x7F13;&#x51B2;&#x533A;&#xFF0C;&#x5E76;&#x5C06;&#x7F13;&#x5B58;&#x533A;&#x5730;&#x5740;&#x4F20;&#x7ED9;&#x51FD;&#x6570;&#x7528;&#x4EE5;&#x8FD4;&#x56DE;&#x7ED3;&#x679C;&#x3002;&#x8FD9;&#x4F7F;&#x5F97;&#x8C03;&#x7528;&#x7EBF;&#x7A0B;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5C40;&#x90E8;&#xFF08;&#x6808;&#xFF09;&#x53D8;&#x91CF;&#x6765;&#x5B58;&#x653E;&#x51FD;&#x6570;&#x7ED3;&#x679C;&#x3002;&#x51FA;&#x4E8E;&#x8FD9;&#x4E00;&#x76EE;&#x7684;&#xFF0C;SUSv3&#x5B9A;&#x4E49;&#x4E86;&#x5982;&#x4E0B;&#x51FD;&#x6570;&#xFF1A;asctime_r()&#x3001;ctime_r()&#x3001;getgrgid_r()&#x3001;getgrnam_r()&#x3001;getlogin_r()&#x3001;getpwnam_r()&#x3001;getpwuid_r()&#x3001;gmtime_r()&#x3001;localtime_r()&#x3001;rand_r()&#x3001;readdir_r()&#x3001;strerror_r()&#x3001;strtok_r()&#x548C;ttyname_r()&#x3002;</p>
<h2 id="&#x4E00;&#x6B21;&#x6027;&#x521D;&#x59CB;&#x5316;"><a href="#&#x4E00;&#x6B21;&#x6027;&#x521D;&#x59CB;&#x5316;" class="headerlink" title="&#x4E00;&#x6B21;&#x6027;&#x521D;&#x59CB;&#x5316;"></a>&#x4E00;&#x6B21;&#x6027;&#x521D;&#x59CB;&#x5316;</h2><p>&#x591A;&#x7EBF;&#x7A0B;&#x7A0B;&#x5E8F;&#x6709;&#x65F6;&#x6709;&#x8FD9;&#x6837;&#x7684;&#x9700;&#x6C42;&#xFF1A;&#x4E0D;&#x7BA1;&#x521B;&#x5EFA;&#x4E86;&#x591A;&#x5C11;&#x7EBF;&#x7A0B;&#xFF0C;&#x6709;&#x4E9B;&#x521D;&#x59CB;&#x5316;&#x52A8;&#x4F5C;&#x53EA;&#x80FD;&#x53D1;&#x751F;&#x4E00;&#x6B21;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x53EF;&#x80FD;&#x9700;&#x8981;&#x6267;&#x884C; pthread_mutex_init()&#x5BF9;&#x5E26;&#x6709;&#x7279;&#x6B8A;&#x5C5E;&#x6027;&#x7684;&#x4E92;&#x65A5;&#x91CF;&#x8FDB;&#x884C;&#x521D;&#x59CB;&#x5316;&#xFF0C;&#x800C;&#x4E14;&#x5FC5;&#x987B;&#x53EA;&#x80FD;&#x521D;&#x59CB;&#x5316;&#x4E00;&#x6B21;&#x3002;&#x5982;&#x679C;&#x7531;&#x4E3B;&#x7EBF;&#x7A0B;&#x6765;&#x521B;&#x5EFA;&#x65B0;&#x7EBF;&#x7A0B;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x4E00;&#x70B9;&#x6613;&#x5982;&#x53CD;&#x638C;&#xFF1A;&#x53EF;&#x4EE5;&#x5728;&#x521B;&#x5EFA;&#x4F9D;&#x8D56;&#x4E8E;&#x8BE5;&#x521D;&#x59CB;&#x5316;&#x7684;&#x7EBF;&#x7A0B;&#x4E4B;&#x524D;&#x8FDB;&#x884C;&#x521D;&#x59CB;&#x5316;&#x3002;&#x4E0D;&#x8FC7;&#xFF0C;&#x5BF9;&#x4E8E;&#x5E93;&#x51FD;&#x6570;&#x800C;&#x8A00;&#xFF0C;&#x8FD9;&#x6837;&#x5904;&#x7406;&#x5C31;&#x4E0D;&#x53EF;&#x884C;&#xFF0C;&#x56E0;&#x4E3A;&#x8C03;&#x7528;&#x8005;&#x5728;&#x521D;&#x6B21;&#x8C03;&#x7528;&#x5E93;&#x51FD;&#x6570;&#x4E4B;&#x524D;&#x53EF;&#x80FD;&#x5DF2;&#x7ECF;&#x521B;&#x5EFA;&#x4E86;&#x8FD9;&#x4E9B;&#x7EBF;&#x7A0B;&#x3002;&#x6545;&#x800C;&#x9700;&#x8981;&#x8FD9;&#x6837;&#x7684;&#x5E93;&#x51FD;&#x6570;&#xFF1A;&#x65E0;&#x8BBA;&#x9996;&#x6B21;&#x4E3A;&#x4EFB;&#x4F55;&#x7EBF;&#x7A0B;&#x6240;&#x8C03;&#x7528;&#xFF0C;&#x90FD;&#x4F1A;&#x6267;&#x884C;&#x521D;&#x59CB;&#x5316;&#x52A8;&#x4F5C;&#x3002;</p>
<p>&#x5E93;&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x51FD;&#x6570;pthread_once()&#x5B9E;&#x73B0;&#x4E00;&#x6B21;&#x6027;&#x521D;&#x59CB;&#x5316;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;pthread.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">pthread_once</span><span class="token punctuation">(</span>pthread_once_t <span class="token operator">*</span>once_control<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>init<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">)</span>&#xFF1B;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x5229;&#x7528;&#x53C2;&#x6570; once_control &#x7684;&#x72B6;&#x6001;&#xFF0C;&#x51FD;&#x6570; pthread_once()&#x53EF;&#x4EE5;&#x786E;&#x4FDD;&#x65E0;&#x8BBA;&#x6709;&#x591A;&#x5C11;&#x7EBF;&#x7A0B;&#x5BF9;pthread_once()&#x8C03;&#x7528;&#x4E86;&#x591A;&#x5C11;&#x6B21;&#xFF0C;&#x4E5F;&#x53EA;&#x4F1A;&#x6267;&#x884C;&#x4E00;&#x6B21;&#x7531;init&#x6307;&#x5411;&#x7684;&#x8C03;&#x7528;&#x8005;&#x5B9A;&#x4E49;&#x51FD;&#x6570;&#x3002;<br>init&#x51FD;&#x6570;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x53C2;&#x6570;&#xFF0C;&#x5F62;&#x5F0F;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">/* do somethings */</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x53E6;&#x5916;&#xFF0C;&#x53C2;&#x6570; once_control &#x5FC5;&#x987B;&#x662F;&#x4E00;&#x6307;&#x9488;&#xFF0C;&#x6307;&#x5411;&#x521D;&#x59CB;&#x5316;&#x4E3A; PTHREAD_ONCE_INIT &#x7684;&#x9759;&#x6001;&#x53D8;&#x91CF;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c">pthread_once_t once_var<span class="token operator">=</span>PTHREAD_ONCE_INIT<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>&#x8C03;&#x7528;&#x51FD;&#x6570;pthread_once()&#x65F6;&#x8981;&#x6307;&#x5B9A;&#x4E00;&#x4E2A;&#x6307;&#x9488;&#xFF0C;&#x6307;&#x5411;&#x7C7B;&#x578B;&#x4E3A;pthread_once_t&#x7684;&#x7279;&#x5B9A;&#x53D8;&#x91CF;&#xFF0C;&#x5BF9;&#x8BE5;&#x51FD;&#x6570;&#x7684;&#x9996;&#x6B21;&#x8C03;&#x7528;&#x5C06;&#x4FEE;&#x6539;once_control&#x6240;&#x6307;&#x5411;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x4EE5;&#x4FBF;&#x5BF9;&#x5176;&#x540E;&#x7EED;&#x8C03;&#x7528;&#x4E0D;&#x4F1A;&#x518D;&#x6B21;&#x6267;&#x884C;init&#x3002;</p>
<p>&#x5E38;&#x5E38;&#x5C06;Pthread_once()&#x548C;&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;&#x7ED3;&#x5408;&#x4F7F;&#x7528;.</p>
<p>Pthreads &#x7684;&#x65E9;&#x671F;&#x7248;&#x672C;&#x4E0D;&#x80FD;&#x5BF9;&#x4E92;&#x65A5;&#x91CF;&#x8FDB;&#x884C;&#x9759;&#x6001;&#x521D;&#x59CB;&#x5316;&#xFF0C;&#x53EA;&#x80FD;&#x4F7F;&#x7528; pthread_mutex_init()&#xFF08;[Butenbof&#xFF0C;1996]&#xFF09;&#xFF0C;&#x8FD9;&#x4E5F;&#x662F;&#x51FD;&#x6570; pthread_once()&#x5B58;&#x5728;&#x7684;&#x4E3B;&#x8981;&#x539F;&#x56E0;&#x3002;&#x968F;&#x7740;&#x9759;&#x6001;&#x5206;&#x914D;&#x4E92;&#x65A5;&#x91CF;&#x529F;&#x80FD;&#x7684;&#x95EE;&#x4E16;&#xFF0C;&#x5E93;&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x7ECF;&#x9759;&#x6001;&#x5206;&#x914D;&#x7684;&#x4E92;&#x65A5;&#x91CF;&#x548C;&#x4E00;&#x4E2A;&#x9759;&#x6001;&#x5E03;&#x5C14;&#x578B;&#xFF08;Boolean&#xFF09;&#x53D8;&#x91CF;&#x6765;&#x5B9E;&#x73B0;&#x4E00;&#x6B21;&#x6027;&#x521D;&#x59CB;&#x5316;&#x3002;&#x867D;&#x7136;&#x5982;&#x6B64;&#xFF0C;&#x51FA;&#x4E8E;&#x65B9;&#x4FBF;&#x7684;&#x8003;&#x8651;&#xFF0C;&#x51FD;&#x6570;pthread_once()&#x5F97;&#x4EE5;&#x4FDD;&#x7559;&#x3002;</p>
<h2 id="&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;"><a href="#&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;" class="headerlink" title="&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;"></a>&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;</h2><p>&#x5728;&#x5355;&#x7EBF;&#x7A0B;&#x7A0B;&#x5E8F;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x7ECF;&#x5E38;&#x8981;&#x4F7F;&#x7528;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x6765;&#x5B9E;&#x73B0;&#x591A;&#x4E2A;&#x51FD;&#x6570;&#x95F4;&#x5171;&#x4EAB;&#x6570;&#x636E;&#x3002;&#x5728;&#x591A;&#x7EBF;&#x7A0B;&#x73AF;&#x5883;&#x4E0B;&#xFF0C;&#x7531;&#x4E8E;&#x6570;&#x636E;&#x7A7A;&#x95F4;&#x662F;&#x5171;&#x4EAB;&#x7684;&#xFF0C;&#x56E0;&#x6B64;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x4E5F;&#x4E3A;&#x6240;&#x6709;&#x7EBF;&#x7A0B;&#x6240;&#x5171;&#x6709;&#x3002;&#x4F46;&#x6709;&#x65F6;&#x5728;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x8BBE;&#x8BA1;&#x4E2D;&#x6709;&#x5FC5;&#x8981;&#x63D0;&#x4F9B;&#x7EBF;&#x7A0B;&#x79C1;&#x6709;&#x7684;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#xFF0C;&#x4EC5;&#x5728;&#x67D0;&#x4E2A;&#x7EBF;&#x7A0B;&#x4E2D;&#x6709;&#x6548;&#xFF0C;&#x4F46;&#x53EF;&#x4EE5;&#x8DE8;&#x591A;&#x4E2A;&#x51FD;&#x6570;&#x8BBF;&#x95EE;&#xFF0C;&#x8FD9;&#x6837;&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x8BBF;&#x95EE;&#x5B83;&#x81EA;&#x5DF1;&#x72EC;&#x7ACB;&#x7684;&#x6570;&#x636E;&#x7A7A;&#x95F4;&#xFF0C;&#x800C;&#x4E0D;&#x7528;&#x62C5;&#x5FC3;&#x548C;&#x5176;&#x5B83;&#x7EBF;&#x7A0B;&#x7684;&#x540C;&#x6B65;&#x8BBF;&#x95EE;&#x3002;<br>&#x8FD9;&#x6837;&#x5728;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x5185;&#x90E8;&#x7684;&#x5404;&#x4E2A;&#x51FD;&#x6570;&#x90FD;&#x80FD;&#x8BBF;&#x95EE;&#x3001;&#x4F46;&#x5176;&#x5B83;&#x7EBF;&#x7A0B;&#x4E0D;&#x80FD;&#x8BBF;&#x95EE;&#x7684;&#x53D8;&#x91CF;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x7EBF;&#x7A0B;&#x5C40;&#x90E8;&#x9759;&#x6001;&#x53D8;&#x91CF;(Static memory local to a thread) &#x540C;&#x65F6;&#x4E5F;&#x53EF;&#x79F0;&#x4E4B;&#x4E3A;&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;&#xFF08;Thread-Specific Data &#x6216; TSD&#xFF09;&#xFF0C;&#x6216;&#x8005;&#x7EBF;&#x7A0B;&#x5C40;&#x90E8;&#x5B58;&#x50A8;&#xFF08;Thread-Local Storage &#x6216; TLS&#xFF09;&#x3002;</p>
<p>&#x5B9E;&#x73B0;&#x51FD;&#x6570;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x6700;&#x4E3A;&#x6709;&#x6548;&#x7684;&#x65B9;&#x5F0F;&#x5C31;&#x662F;&#x4F7F;&#x5176;&#x53EF;&#x91CD;&#x5165;&#xFF0C;&#x5E94;&#x4EE5;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x6765;&#x5B9E;&#x73B0;&#x6240;&#x6709;&#x65B0;&#x7684;&#x51FD;&#x6570;&#x5E93;&#x3002;&#x4E0D;&#x8FC7;&#xFF0C;&#x5BF9;&#x4E8E;&#x5DF2;&#x6709;&#x7684;&#x4E0D;&#x53EF;&#x91CD;&#x5165;&#x51FD;&#x6570;&#x5E93;&#xFF08;&#x53EF;&#x80FD;&#x95EE;&#x4E16;&#x4E8E;&#x7EBF;&#x7A0B;&#x6D41;&#x884C;&#x4E4B;&#x524D;&#xFF09;&#x6765;&#x8BF4;&#xFF0C;&#x91C7;&#x7528;&#x8FD9;&#x79CD;&#x65B9;&#x6CD5;&#x901A;&#x5E38;&#x9700;&#x8981;&#x4FEE;&#x6539;&#x51FD;&#x6570;&#x63A5;&#x53E3;&#xFF0C;&#x8FD9;&#x4E5F;&#x610F;&#x5473;&#x7740;&#xFF0C;&#x9700;&#x8981;&#x4FEE;&#x6539;&#x6240;&#x6709;&#x4F7F;&#x7528;&#x6B64;&#x7C7B;&#x51FD;&#x6570;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x3002;</p>
<p>&#x4F7F;&#x7528;&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;&#x6280;&#x672F;&#xFF0C;&#x53EF;&#x4EE5;&#x65E0;&#x9700;&#x4FEE;&#x6539;&#x51FD;&#x6570;&#x63A5;&#x53E3;&#x800C;&#x5B9E;&#x73B0;&#x5DF2;&#x6709;&#x51FD;&#x6570;&#x7684;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x3002;&#x8F83;&#x4E4B;&#x4E8E;&#x53EF;&#x91CD;&#x5165;&#x51FD;&#x6570;&#xFF0C;&#x91C7;&#x7528;&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;&#x7684;&#x51FD;&#x6570;&#x6548;&#x7387;&#x53EF;&#x80FD;&#x8981;&#x7565;&#x4F4E;&#x4E00;&#x4E9B;&#xFF0C;&#x4E0D;&#x8FC7;&#x5BF9;&#x4E8E;&#x4F7F;&#x7528;&#x4E86;&#x8FD9;&#x4E9B;&#x8C03;&#x7528;&#x7684;&#x7A0B;&#x5E8F;&#x800C;&#x8A00;&#xFF0C;&#x5219;&#x7701;&#x53BB;&#x4E86;&#x4FEE;&#x6539;&#x7A0B;&#x5E8F;&#x4E4B;&#x52B3;&#x3002;</p>
<p>&#x5982;&#x56FE;31-1&#x6240;&#x793A;&#xFF0C;&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;&#x4F7F;&#x51FD;&#x6570;&#x5F97;&#x4EE5;&#x4E3A;&#x6BCF;&#x4E2A;&#x8C03;&#x7528;&#x7EBF;&#x7A0B;&#x5206;&#x522B;&#x7EF4;&#x62A4;&#x4E00;&#x4EFD;&#x53D8;&#x91CF;&#x7684;&#x526F;&#x672C;&#xFF08;copy&#xFF09;&#x3002;&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;&#x662F;&#x957F;&#x671F;&#x5B58;&#x5728;&#x7684;&#x3002;&#x5728;&#x540C;&#x4E00;&#x7EBF;&#x7A0B;&#x5BF9;&#x76F8;&#x540C;&#x51FD;&#x6570;&#x7684;&#x5386;&#x6B21;&#x8C03;&#x7528;&#x95F4;&#xFF0C;&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x7684;&#x53D8;&#x91CF;&#x4F1A;&#x6301;&#x7EED;&#x5B58;&#x5728;&#xFF0C;&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x5411;&#x6BCF;&#x4E2A;&#x8C03;&#x7528;&#x7EBF;&#x7A0B;&#x8FD4;&#x56DE;&#x5404;&#x81EA;&#x7684;&#x7ED3;&#x679C;&#x7F13;&#x51B2;&#x533A;&#xFF08;&#x5982;&#x679C;&#x9700;&#x8981;&#x7684;&#x8BDD;&#xFF09;&#x3002;<br></p><div class="amp-img-wrapper"><amp-img src="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1581571062046.png?x-oss-process=image/resize,m_lfit,h_450" width="418" height="450" layout="responsive"></amp-img></div>
<h3 id="&#x5E93;&#x51FD;&#x6570;&#x89C6;&#x89D2;&#x4E0B;&#x7684;&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;"><a href="#&#x5E93;&#x51FD;&#x6570;&#x89C6;&#x89D2;&#x4E0B;&#x7684;&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;" class="headerlink" title="&#x5E93;&#x51FD;&#x6570;&#x89C6;&#x89D2;&#x4E0B;&#x7684;&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;"></a>&#x5E93;&#x51FD;&#x6570;&#x89C6;&#x89D2;&#x4E0B;&#x7684;&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;</h3><p>&#x8981;&#x4E86;&#x89E3;&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;&#x76F8;&#x5173;API&#x7684;&#x4F7F;&#x7528;&#xFF0C;&#x9700;&#x8981;&#x4ECE;&#x4F7F;&#x7528;&#x8FD9;&#x4E00;&#x6280;&#x672F;&#x7684;&#x5E93;&#x51FD;&#x6570;&#x89D2;&#x5EA6;&#x6765;&#x8003;&#x8651;&#x5982;&#x4E0B;&#x95EE;&#x9898;&#x3002;</p>
<ul>
<li>&#x8BE5;&#x51FD;&#x6570;&#x5FC5;&#x987B;&#x4E3A;&#x6BCF;&#x4E2A;&#x8C03;&#x7528;&#x8005;&#x7EBF;&#x7A0B;&#x5206;&#x914D;&#x5355;&#x72EC;&#x7684;&#x5B58;&#x50A8;&#xFF0C;&#x4E14;&#x53EA;&#x9700;&#x5728;&#x7EBF;&#x7A0B;&#x521D;&#x6B21;&#x8C03;&#x7528;&#x6B64;&#x51FD;&#x6570;&#x65F6;&#x5206;&#x914D;&#x4E00;&#x6B21;&#x5373;&#x53EF;&#x3002;</li>
<li>&#x5728;&#x540C;&#x4E00;&#x7EBF;&#x7A0B;&#x5BF9;&#x6B64;&#x51FD;&#x6570;&#x7684;&#x540E;&#x7EED;&#x6240;&#x6709;&#x8C03;&#x7528;&#x4E2D;&#xFF0C;&#x8BE5;&#x51FD;&#x6570;&#x90FD;&#x9700;&#x8981;&#x83B7;&#x53D6;&#x521D;&#x6B21;&#x8C03;&#x7528;&#x65F6;&#x7EBF;&#x7A0B;&#x5206;&#x914D;&#x7684;&#x5B58;&#x50A8;&#x5757;&#x5730;&#x5740;&#x3002;&#x7531;&#x4E8E;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x7ED3;&#x675F;&#x65F6;&#x4F1A;&#x91CA;&#x653E;&#x81EA;&#x52A8;&#x53D8;&#x91CF;&#xFF0C;&#x6545;&#x800C;&#x51FD;&#x6570;&#x4E0D;&#x5E94;&#x5229;&#x7528;&#x81EA;&#x52A8;&#x53D8;&#x91CF;&#x5B58;&#x653E;&#x5B58;&#x50A8;&#x5757;&#x6307;&#x9488;&#xFF0C;&#x4E5F;&#x4E0D;&#x80FD;&#x5C06;&#x6307;&#x9488;&#x5B58;&#x653E;&#x4E8E;&#x9759;&#x6001;&#x53D8;&#x91CF;&#x4E2D;&#xFF0C;&#x56E0;&#x4E3A;&#x9759;&#x6001;&#x53D8;&#x91CF;&#x5728;&#x8FDB;&#x7A0B;&#x4E2D;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#x3002;Pthreads API&#x63D0;&#x4F9B;&#x4E86;&#x51FD;&#x6570;&#x6765;&#x5904;&#x7406;&#x8FD9;&#x4E00;&#x60C5;&#x51B5;&#x3002;</li>
<li>&#x4E0D;&#x540C;&#xFF08;&#x65E0;&#x76F8;&#x4E92;&#x4F9D;&#x8D56;&#x5173;&#x7CFB;&#xFF09;&#x51FD;&#x6570;&#x5404;&#x81EA;&#x53EF;&#x80FD;&#x90FD;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;&#x3002;&#x6BCF;&#x4E2A;&#x51FD;&#x6570;&#x90FD;&#x9700;&#x8981;&#x65B9;&#x6CD5;&#x6765;&#x6807;&#x8BC6;&#x5176;&#x81EA;&#x8EAB;&#x7684;&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;&#xFF08;&#x952E;&#xFF09;&#xFF0C;&#x4EE5;&#x4FBF;&#x4E0E;&#x5176;&#x4ED6;&#x51FD;&#x6570;&#x6240;&#x4F7F;&#x7528;&#x7684;&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;&#x6709;&#x6240;&#x533A;&#x5206;&#x3002;</li>
<li>&#x5F53;&#x7EBF;&#x7A0B;&#x9000;&#x51FA;&#x65F6;&#xFF0C;&#x51FD;&#x6570;&#x65E0;&#x6CD5;&#x63A7;&#x5236;&#x5C06;&#x8981;&#x53D1;&#x751F;&#x7684;&#x60C5;&#x51B5;&#x3002;&#x8FD9;&#x65F6;&#xFF0C;&#x7EBF;&#x7A0B;&#x53EF;&#x80FD;&#x4F1A;&#x6267;&#x884C;&#x8BE5;&#x51FD;&#x6570;&#x4E4B;&#x5916;&#x7684;&#x4EE3;&#x7801;&#x3002;&#x4E0D;&#x8FC7;&#xFF0C;&#x4E00;&#x5B9A;&#x5B58;&#x5728;&#x67D0;&#x4E9B;&#x673A;&#x5236;&#xFF08;&#x89E3;&#x6784;&#x5668;&#xFF09;&#xFF0C;&#x5728;&#x7EBF;&#x7A0B;&#x9000;&#x51FA;&#x65F6;&#x4F1A;&#x81EA;&#x52A8;&#x91CA;&#x653E;&#x4E3A;&#x8BE5;&#x7EBF;&#x7A0B;&#x6240;&#x5206;&#x914D;&#x7684;&#x5B58;&#x50A8;&#x3002;&#x82E5;&#x975E;&#x5982;&#x6B64;&#xFF0C;&#x968F;&#x7740;&#x6301;&#x7EED;&#x4E0D;&#x65AD;&#x5730;&#x521B;&#x5EFA;&#x7EBF;&#x7A0B;&#xFF0C;&#x8C03;&#x7528;&#x51FD;&#x6570;&#x548C;&#x7EC8;&#x6B62;&#x7EBF;&#x7A0B;&#xFF0C;&#x5C06;&#x4F1A;&#x5F15;&#x53D1;&#x5185;&#x5B58;&#x6CC4;&#x9732;&#x3002;</li>
</ul>
<h3 id="&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;API&#x6982;&#x8FF0;"><a href="#&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;API&#x6982;&#x8FF0;" class="headerlink" title="&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;API&#x6982;&#x8FF0;"></a>&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;API&#x6982;&#x8FF0;</h3><p>&#x8981;&#x4F7F;&#x7528;&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;&#xFF0C;&#x5E93;&#x51FD;&#x6570;&#x6267;&#x884C;&#x7684;&#x4E00;&#x822C;&#x6B65;&#x9AA4;&#x5982;&#x4E0B;&#x3002;<br>1&#xFF0E; &#x51FD;&#x6570;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x952E;&#xFF08;key&#xFF09;&#xFF0C;&#x7528;&#x4EE5;&#x5C06;&#x4E0D;&#x540C;&#x51FD;&#x6570;&#x4F7F;&#x7528;&#x7684;&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;&#x9879;&#x533A;&#x5206;&#x5F00;&#x6765;&#x3002;&#x8C03;&#x7528;&#x51FD;&#x6570;pthread_key_create()&#x53EF;&#x521B;&#x5EFA;&#x6B64;&#x201C;&#x952E;&#x201D;&#xFF0C;&#x4E14;&#x53EA;&#x9700;&#x5728;&#x9996;&#x4E2A;&#x8C03;&#x7528;&#x8BE5;&#x51FD;&#x6570;&#x7684;&#x7EBF;&#x7A0B;&#x4E2D;&#x521B;&#x5EFA;&#x4E00;&#x6B21;&#xFF0C;&#x51FD;&#x6570;pthread_once()&#x7684;&#x4F7F;&#x7528;&#x6B63;&#x662F;&#x51FA;&#x4E8E;&#x8FD9;&#x4E00;&#x76EE;&#x7684;&#x3002;&#x952E;&#x5728;&#x521B;&#x5EFA;&#x65F6;&#x5E76;&#x672A;&#x5206;&#x914D;&#x4EFB;&#x4F55;&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;&#x5757;&#x3002;<br>2&#xFF0E; &#x8C03;&#x7528;pthread_key_create()&#x8FD8;&#x6709;&#x53E6;&#x4E00;&#x4E2A;&#x76EE;&#x7684;&#xFF0C;&#x5373;&#x5141;&#x8BB8;&#x8C03;&#x7528;&#x8005;&#x6307;&#x5B9A;&#x4E00;&#x4E2A;&#x81EA;&#x5B9A;&#x4E49;&#x89E3;&#x6784;&#x51FD;&#x6570;&#xFF0C;&#x7528;&#x4E8E;&#x91CA;&#x653E;&#x4E3A;&#x8BE5;&#x952E;&#x6240;&#x5206;&#x914D;&#x7684;&#x5404;&#x4E2A;&#x5B58;&#x50A8;&#x5757;&#xFF08;&#x53C2;&#x89C1;&#x4E0B;&#x4E00;&#x6B65;&#xFF09;&#x3002;&#x5F53;&#x4F7F;&#x7528;&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;&#x7684;&#x7EBF;&#x7A0B;&#x7EC8;&#x6B62;&#x65F6;&#xFF0C;Pthreads API&#x4F1A;&#x81EA;&#x52A8;&#x8C03;&#x7528;&#x6B64;&#x89E3;&#x6784;&#x51FD;&#x6570;&#xFF0C;&#x540C;&#x65F6;&#x5C06;&#x8BE5;&#x7EBF;&#x7A0B;&#x7684;&#x6570;&#x636E;&#x5757;&#x6307;&#x9488;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x4F20;&#x5165;&#x3002;<br>3&#xFF0E; &#x51FD;&#x6570;&#x4F1A;&#x4E3A;&#x6BCF;&#x4E2A;&#x8C03;&#x7528;&#x8005;&#x7EBF;&#x7A0B;&#x521B;&#x5EFA;&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;&#x5757;&#x3002;&#x8FD9;&#x4E00;&#x5206;&#x914D;&#x901A;&#x8FC7;&#x8C03;&#x7528;malloc()&#xFF08;&#x6216;&#x7C7B;&#x4F3C;&#x51FD;&#x6570;&#xFF09;&#x5B8C;&#x6210;&#xFF0C;&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x53EA;&#x5206;&#x914D;&#x4E00;&#x6B21;&#xFF0C;&#x4E14;&#x53EA;&#x4F1A;&#x5728;&#x7EBF;&#x7A0B;&#x521D;&#x6B21;&#x8C03;&#x7528;&#x6B64;&#x51FD;&#x6570;&#x65F6;&#x5206;&#x914D;&#x3002;<br>4&#xFF0E; &#x4E3A;&#x4E86;&#x4FDD;&#x5B58;&#x4E0A;&#x4E00;&#x6B65;&#x6240;&#x5206;&#x914D;&#x5B58;&#x50A8;&#x5757;&#x7684;&#x5730;&#x5740;&#xFF0C;&#x51FD;&#x6570;&#x4F1A;&#x4F7F;&#x7528;&#x4E24;&#x4E2A;Pthreads&#x51FD;&#x6570;&#xFF1A;pthread_setspecific()&#x548C;pthread_getspecific()&#x3002;&#x8C03;&#x7528;&#x51FD;&#x6570;pthread_setspecific()&#x5B9E;&#x9645;&#x4E0A;&#x662F;&#x5BF9;Pthreads&#x5B9E;&#x73B0;&#x53D1;&#x8D77;&#x8FD9;&#x6837;&#x7684;&#x8BF7;&#x6C42;&#xFF1A;&#x4FDD;&#x5B58;&#x8BE5;&#x6307;&#x9488;&#xFF0C;&#x5E76;&#x8BB0;&#x5F55;&#x5176;&#x4E0E;&#x7279;&#x5B9A;&#x952E;&#xFF08;&#x8BE5;&#x51FD;&#x6570;&#x7684;&#x952E;&#xFF09;&#x4EE5;&#x53CA;&#x7279;&#x5B9A;&#x7EBF;&#x7A0B;&#xFF08;&#x8C03;&#x7528;&#x8005;&#x7EBF;&#x7A0B;&#xFF09;&#x7684;&#x5173;&#x8054;&#x6027;&#x3002;&#x8C03;&#x7528;pthread_getspecific()&#x6240;&#x6267;&#x884C;&#x7684;&#x662F;&#x4E92;&#x8865;&#x64CD;&#x4F5C;&#xFF1A;&#x8FD4;&#x56DE;&#x4E4B;&#x524D;&#x6240;&#x4FDD;&#x5B58;&#x7684;&#x3001;&#x4E0E;&#x7ED9;&#x5B9A;&#x952E;&#x4EE5;&#x53CA;&#x8C03;&#x7528;&#x7EBF;&#x7A0B;&#x76F8;&#x5173;&#x8054;&#x7684;&#x6307;&#x9488;&#x3002;&#x5982;&#x679C;&#x8FD8;&#x6CA1;&#x6709;&#x6307;&#x9488;&#x4E0E;&#x7279;&#x5B9A;&#x7684;&#x952E;&#x53CA;&#x7EBF;&#x7A0B;&#x76F8;&#x5173;&#x8054;&#xFF0C;&#x90A3;&#x4E48;pthread_getspecific()&#x8FD4;&#x56DE;NULL&#x3002;&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x8FD9;&#x4E00;&#x70B9;&#x6765;&#x5224;&#x65AD;&#x81EA;&#x8EAB;&#x662F;&#x5426;&#x662F;&#x521D;&#x6B21;&#x4E3A;&#x67D0;&#x4E2A;&#x7EBF;&#x7A0B;&#x6240;&#x8C03;&#x7528;&#xFF0C;&#x82E5;&#x4E3A;&#x521D;&#x6B21;&#xFF0C;&#x5219;&#x5FC5;&#x987B;&#x4E3A;&#x8BE5;&#x7EBF;&#x7A0B;&#x5206;&#x914D;&#x7A7A;&#x95F4;&#x3002;#</p>
<h3 id="&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;API&#x8BE6;&#x8FF0;"><a href="#&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;API&#x8BE6;&#x8FF0;" class="headerlink" title="&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;API&#x8BE6;&#x8FF0;"></a>&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;API&#x8BE6;&#x8FF0;</h3><p>&#x8C03;&#x7528;pthread_key_create()&#x51FD;&#x6570;&#x4E3A;&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x952E;&#xFF0C;&#x5E76;&#x901A;&#x8FC7;key&#x6240;&#x6307;&#x5411;&#x7684;&#x7F13;&#x51B2;&#x533A;&#x8FD4;&#x56DE;&#x7ED9;&#x8C03;&#x7528;&#x8005;&#x3002;</p>
<p>&#x56E0;&#x4E3A;&#x8FDB;&#x7A0B;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x7EBF;&#x7A0B;&#x90FD;&#x53EF;&#x4F7F;&#x7528;&#x8FD4;&#x56DE;&#x7684;&#x952E;&#xFF0C;&#x6240;&#x4EE5;&#x53C2;&#x6570;key&#x5E94;&#x6307;&#x5411;&#x4E00;&#x4E2A;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;pthread.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">pthread_key_create</span><span class="token punctuation">(</span>pthread_key_t <span class="token operator">*</span>key<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>destructor<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x53C2;&#x6570;destructor&#x6307;&#x5411;&#x4E00;&#x4E2A;&#x81EA;&#x5B9A;&#x4E49;&#x51FD;&#x6570;&#xFF0C;&#x5176;&#x683C;&#x5F0F;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">dest</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>valure<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">/* Release storage pointed to by &apos;value&apos;*/</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x53EA;&#x8981;&#x7EBF;&#x7A0B;&#x7EC8;&#x6B62;&#x65F6;&#x4E0E;key&#x7684;&#x5173;&#x8054;&#x503C;&#x4E0D;&#x4E3A;NULL&#xFF0C;Pthreads API&#x4F1A;&#x81EA;&#x52A8;&#x6267;&#x884C;&#x89E3;&#x6784;&#x51FD;&#x6570;&#xFF0C;&#x5E76;&#x5C06;&#x4E0E;key&#x7684;&#x5173;&#x8054;&#x503C;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x4F20;&#x5165;&#x89E3;&#x6784;&#x51FD;&#x6570;&#x3002;&#x4F20;&#x5165;&#x7684;&#x503C;&#x901A;&#x5E38;&#x662F;&#x4E0E;&#x8BE5;&#x952E;&#x5173;&#x8054;&#xFF0C;&#x4E14;&#x6307;&#x5411;&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;&#x5757;&#x7684;&#x6307;&#x9488;&#x3002;&#x5982;&#x679C;&#x65E0;&#x9700;&#x89E3;&#x6784;&#xFF0C;&#x90A3;&#x4E48;&#x53EF;&#x5C06;destructor&#x8BBE;&#x7F6E;&#x4E3A;NULL&#x3002;</p>
<p>&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x6709;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;&#x5757;&#xFF0C;&#x90A3;&#x4E48;&#x5BF9;&#x5404;&#x4E2A;&#x89E3;&#x6784;&#x51FD;&#x6570;&#x7684;&#x8C03;&#x7528;&#x987A;&#x5E8F;&#x662F;&#x4E0D;&#x786E;&#x5B9A;&#x7684;&#x3002;&#x5BF9;&#x6BCF;&#x4E2A;&#x89E3;&#x6784;&#x51FD;&#x6570;&#x7684;&#x8BBE;&#x8BA1;&#x5E94;&#x76F8;&#x4E92;&#x72EC;&#x7ACB;&#x3002;</p>
<p>&#x89C2;&#x5BDF;&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;&#x7684;&#x5B9E;&#x73B0;&#x6709;&#x52A9;&#x4E8E;&#x7406;&#x89E3;&#x5B83;&#x4EEC;&#x7684;&#x4F7F;&#x7528;&#x65B9;&#x6CD5;&#x3002;&#x5178;&#x578B;&#x7684;&#x5B9E;&#x73B0;&#xFF08;NPTL&#x5373;&#x5728;&#x6B64;&#x5217;&#xFF09;&#x4F1A;&#x5305;&#x542B;&#x4EE5;&#x4E0B;&#x6570;&#x7EC4;&#x3002;</p>
<ul>
<li>&#x4E00;&#x4E2A;&#x5168;&#x5C40;&#xFF08;&#x8FDB;&#x7A0B;&#x8303;&#x56F4;&#xFF09;&#x6570;&#x7EC4;&#xFF0C;&#x5B58;&#x653E;&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;&#x7684;&#x952E;&#x4FE1;&#x606F;&#x3002;</li>
<li>&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x6570;&#x7EC4;&#xFF0C;&#x5B58;&#x6709;&#x4E3A;&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x5206;&#x914D;&#x7684;&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;&#x5757;&#x7684;&#x6307;&#x9488;&#xFF08;&#x901A;&#x8FC7;&#x8C03;&#x7528;pthread_ setspecific()&#x6765;&#x5B58;&#x50A8;&#x6307;&#x9488;&#xFF09;&#x3002;</li>
</ul>
<p>&#x5728;&#x8FD9;&#x4E00;&#x5B9E;&#x73B0;&#x4E2D;&#xFF0C;pthread_key_create()&#x8FD4;&#x56DE;&#x7684;pthread_key_t&#x7C7B;&#x578B;&#x503C;&#x53EA;&#x662F;&#x5BF9;&#x5168;&#x5C40;&#x6570;&#x7EC4;&#x7684;&#x7D22;&#x5F15;&#xFF08;index&#xFF09;&#xFF0C;&#x6807;&#x8BB0;&#x4E3A;pthread_keys&#xFF0C;&#x5176;&#x683C;&#x5F0F;&#x5982;&#x56FE;&#x6240;&#x793A;&#x3002;&#x6570;&#x7EC4;&#x7684;&#x6BCF;&#x4E2A;&#x5143;&#x7D20;&#x90FD;&#x662F;&#x4E00;&#x4E2A;&#x5305;&#x542B;&#x4E24;&#x4E2A;&#x5B57;&#x6BB5;&#xFF08;field&#xFF09;&#x7684;&#x7ED3;&#x6784;&#x3002;&#x7B2C;&#x4E00;&#x4E2A;&#x5B57;&#x6BB5;&#x6807;&#x8BB0;&#x8BE5;&#x6570;&#x7EC4;&#x5143;&#x7D20;&#x662F;&#x5426;&#x5728;&#x7528;&#xFF08;&#x5373;&#x5DF2;&#x7531;&#x4E4B;&#x524D;&#x5BF9;pthread_key_create()&#x7684;&#x8C03;&#x7528;&#x5206;&#x914D;&#xFF09;&#x3002;&#x7B2C;&#x4E8C;&#x4E2A;&#x5B57;&#x6BB5;&#x7528;&#x4E8E;&#x5B58;&#x653E;&#x9488;&#x5BF9;&#x6B64;&#x952E;&#x3001;&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;&#x5757;&#x7684;&#x89E3;&#x6784;&#x51FD;&#x6570;&#x6307;&#x9488;&#xFF08;&#x662F;&#x51FD;&#x6570;pthread_key_crate()&#x4E2D;&#x53C2;&#x6570;destructor&#x7684;&#x4E00;&#x4EFD;&#x62F7;&#x8D1D;&#xFF09;&#x3002;<br></p><div class="amp-img-wrapper"><amp-img src="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1581571816214.png?x-oss-process=image/resize,m_lfit,h_450" width="444" height="408" layout="responsive"></amp-img></div>
<p>&#x51FD;&#x6570;pthread_setspecific()&#x8981;&#x6C42;Pthreads API&#x5C06;value&#x7684;&#x526F;&#x672C;&#x5B58;&#x50A8;&#x4E8E;&#x4E00;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x4E2D;&#xFF0C;&#x5E76;&#x5C06;value&#x4E0E;&#x8C03;&#x7528;&#x7EBF;&#x7A0B;&#x4EE5;&#x53CA;key&#x76F8;&#x5173;&#x8054;&#xFF08;key&#x7531;&#x4E4B;&#x524D;&#x5BF9;pthread_key_create()&#x7684;&#x8C03;&#x7528;&#x8FD4;&#x56DE;&#xFF09;&#x3002;Pthread_getspecific()&#x51FD;&#x6570;&#x6267;&#x884C;&#x7684;&#x64CD;&#x4F5C;&#x4E0E;&#x4E4B;&#x76F8;&#x53CD;&#xFF0C;&#x8FD4;&#x56DE;&#x4E4B;&#x524D;&#x4E0E;&#x672C;&#x7EBF;&#x7A0B;&#x53CA;&#x7ED9;&#x5B9A;key&#x76F8;&#x5173;&#x7684;&#x503C;&#xFF08;value&#xFF09;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;pthread.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">pthread_setspecific</span><span class="token punctuation">(</span>pthread_key_t key<span class="token punctuation">,</span><span class="token keyword">const</span> <span class="token keyword">void</span> <span class="token operator">*</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token operator">*</span><span class="token function">pthread_getspecific</span><span class="token punctuation">(</span>pthread_key_t key<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x51FD;&#x6570;pthread_setspecific()&#x7684;&#x53C2;&#x6570;value&#x901A;&#x5E38;&#x662F;&#x4E00;&#x6307;&#x9488;&#xFF0C;&#x6307;&#x5411;&#x7531;&#x8C03;&#x7528;&#x8005;&#x5206;&#x914D;&#x7684;&#x4E00;&#x5757;&#x5185;&#x5B58;&#x3002;&#x5F53;&#x7EBF;&#x7A0B;&#x7EC8;&#x6B62;&#x65F6;&#xFF0C;&#x4F1A;&#x5C06;&#x8BE5;&#x6307;&#x9488;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x4F20;&#x9012;&#x7ED9;&#x4E0E;key&#x5BF9;&#x5E94;&#x7684;&#x89E3;&#x6784;&#x51FD;&#x6570;&#x3002;<br>&#x53C2;&#x6570; value &#x4E5F;&#x53EF;&#x4EE5;&#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x6307;&#x5411;&#x5185;&#x5B58;&#x533A;&#x57DF;&#x7684;&#x6307;&#x9488;&#xFF0C;&#x800C;&#x662F;&#x4EFB;&#x4F55;&#x53EF;&#x4EE5;&#x8D4B;&#x503C;&#xFF08;&#x901A;&#x8FC7;&#x5F3A;&#x5236;&#x8F6C;&#x6362;&#xFF09;&#x7ED9; void*&#x7684;&#x6807;&#x91CF;&#x503C;&#x3002;&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5148;&#x524D;&#x5BF9; pthread_key_create()&#x51FD;&#x6570;&#x7684;&#x8C03;&#x7528;&#x5E94;&#x5C06;destructor&#x6307;&#x5B9A;&#x4E3A;NULL&#x3002;</p>
<p>&#x5F53;&#x7EBF;&#x7A0B;&#x521A;&#x521A;&#x521B;&#x5EFA;&#x65F6;&#xFF0C;&#x4F1A;&#x5C06;&#x6240;&#x6709;&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;&#x7684;&#x6307;&#x9488;&#x90FD;&#x521D;&#x59CB;&#x5316;&#x4E3A;NULL&#x3002;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x5F53;&#x7EBF;&#x7A0B;&#x521D;&#x6B21;&#x8C03;&#x7528;&#x5E93;&#x51FD;&#x6570;&#x65F6;&#xFF0C;&#x5FC5;&#x987B;&#x4F7F;&#x7528;pthread_getspecific()&#x51FD;&#x6570;&#x6765;&#x68C0;&#x67E5;&#x8BE5;&#x7EBF;&#x7A0B;&#x662F;&#x5426;&#x5DF2;&#x6709;&#x4E0E;key&#x5BF9;&#x5E94;&#x7684;&#x5173;&#x8054;&#x503C;&#x3002;&#x5982;&#x679C;&#x6CA1;&#x6709;&#xFF0C;&#x90A3;&#x4E48;&#x6B64;&#x51FD;&#x6570;&#x4F1A;&#x5206;&#x914D;&#x4E00;&#x5757;&#x5185;&#x5B58;&#x5E76;&#x901A;&#x8FC7;pthread_setspecific()&#x4FDD;&#x5B58;&#x6307;&#x5411;&#x8BE5;&#x5185;&#x5B58;&#x5757;&#x7684;&#x6307;&#x9488;&#x3002;</p>
<h3 id="&#x4F7F;&#x7528;&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;API"><a href="#&#x4F7F;&#x7528;&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;API" class="headerlink" title="&#x4F7F;&#x7528;&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;API"></a>&#x4F7F;&#x7528;&#x7EBF;&#x7A0B;&#x7279;&#x6709;&#x6570;&#x636E;API</h3><p>TODO.<br>&#x53C2;&#x8003;&#x94FE;&#x63A5;&#xFF1A;<a href="https://www.jianshu.com/p/61c2d33877f4" target="_blank" rel="noopener">https://www.jianshu.com/p/61c2d33877f4</a></p>
<h1 id="&#x7EBF;&#x7A0B;&#xFF1A;&#x7EBF;&#x7A0B;&#x53D6;&#x6D88;"><a href="#&#x7EBF;&#x7A0B;&#xFF1A;&#x7EBF;&#x7A0B;&#x53D6;&#x6D88;" class="headerlink" title="&#x7EBF;&#x7A0B;&#xFF1A;&#x7EBF;&#x7A0B;&#x53D6;&#x6D88;"></a>&#x7EBF;&#x7A0B;&#xFF1A;&#x7EBF;&#x7A0B;&#x53D6;&#x6D88;</h1><p>&#x5728;&#x901A;&#x5E38;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x7A0B;&#x5E8F;&#x4E2D;&#x7684;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x4F1A;&#x5E76;&#x53D1;&#x6267;&#x884C;&#xFF0C;&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x5404;&#x53F8;&#x5176;&#x804C;&#xFF0C;&#x76F4;&#x81F3;&#x5176;&#x51B3;&#x610F;&#x9000;&#x51FA;&#xFF0C;&#x968F;&#x5373;&#x4F1A;&#x8C03;&#x7528;&#x51FD;&#x6570;pthread_exit()&#x6216;&#x8005;&#x4ECE;&#x7EBF;&#x7A0B;&#x542F;&#x52A8;&#x51FD;&#x6570;&#x4E2D;&#x8FD4;&#x56DE;&#x3002;</p>
<p>&#x6709;&#x65F6;&#x5019;&#xFF0C;&#x9700;&#x8981;&#x5C06;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x53D6;&#x6D88;&#xFF08;cancel&#xFF09;&#x3002;&#x4EA6;&#x5373;&#xFF0C;&#x5411;&#x7EBF;&#x7A0B;&#x53D1;&#x9001;&#x4E00;&#x4E2A;&#x8BF7;&#x6C42;&#xFF0C;&#x8981;&#x6C42;&#x5176;&#x7ACB;&#x5373;&#x9000;&#x51FA;&#x3002;&#x6BD4;&#x5982;&#xFF0C;&#x4E00;&#x7EC4;&#x7EBF;&#x7A0B;&#x6B63;&#x5728;&#x6267;&#x884C;&#x4E00;&#x4E2A;&#x8FD0;&#x7B97;&#xFF0C;&#x4E00;&#x65E6;&#x67D0;&#x4E2A;&#x7EBF;&#x7A0B;&#x68C0;&#x6D4B;&#x5230;&#x9519;&#x8BEF;&#x53D1;&#x751F;&#xFF0C;&#x9700;&#x8981;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x9000;&#x51FA;&#xFF0C;&#x53D6;&#x6D88;&#x7EBF;&#x7A0B;&#x7684;&#x529F;&#x80FD;&#x8FD9;&#x65F6;&#x5C31;&#x6D3E;&#x4E0A;&#x7528;&#x573A;&#x3002;&#x8FD8;&#x6709;&#x4E00;&#x79CD;&#x60C5;&#x51B5;&#xFF0C;&#x4E00;&#x4E2A;&#x7531;&#x56FE;&#x5F62;&#x7528;&#x6237;&#x754C;&#x9762;&#xFF08;GUI&#xFF09;&#x9A71;&#x52A8;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x53EF;&#x80FD;&#x4F1A;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;&#x201C;&#x53D6;&#x6D88;&#x201D;&#x6309;&#x94AE;&#xFF0C;&#x4EE5;&#x4FBF;&#x7528;&#x6237;&#x53EF;&#x4EE5;&#x7EC8;&#x6B62;&#x540E;&#x53F0;&#x67D0;&#x4E00;&#x7EBF;&#x7A0B;&#x6B63;&#x5728;&#x6267;&#x884C;&#x7684;&#x4EFB;&#x52A1;&#x3002;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x4E3B;&#x7EBF;&#x7A0B;&#xFF08;&#x63A7;&#x5236;&#x56FE;&#x5F62;&#x7528;&#x6237;&#x754C;&#x9762;&#xFF09;&#x9700;&#x8981;&#x8BF7;&#x6C42;&#x540E;&#x53F0;&#x7EBF;&#x7A0B;&#x9000;&#x51FA;&#x3002;</p>
<h2 id="&#x53D6;&#x6D88;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;"><a href="#&#x53D6;&#x6D88;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;" class="headerlink" title="&#x53D6;&#x6D88;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;"></a>&#x53D6;&#x6D88;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;</h2><p>&#x51FD;&#x6570;pthread_cancel()&#x5411;&#x7531;thread&#x6307;&#x5B9A;&#x7684;&#x7EBF;&#x7A0B;&#x53D1;&#x9001;&#x4E00;&#x4E2A;&#x53D6;&#x6D88;&#x8BF7;&#x6C42;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;pthread.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">pthread_cancel</span><span class="token punctuation">(</span>pthread_t thread<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x53D1;&#x51FA;&#x53D6;&#x6D88;&#x8BF7;&#x6C42;&#x540E;&#xFF0C;&#x51FD;&#x6570;pthread_cancel()&#x5F53;&#x5373;&#x8FD4;&#x56DE;&#xFF0C;&#x4E0D;&#x4F1A;&#x7B49;&#x5F85;&#x76EE;&#x6807;&#x7EBF;&#x7A0B;&#x7684;&#x9000;&#x51FA;&#x3002;</p>
<p>&#x51C6;&#x786E;&#x5730;&#x8BF4;&#xFF0C;&#x76EE;&#x6807;&#x7EBF;&#x7A0B;&#x4F1A;&#x53D1;&#x751F;&#x4EC0;&#x4E48;&#xFF1F;&#x4F55;&#x65F6;&#x53D1;&#x751F;&#xFF1F;&#x8FD9;&#x4E9B;&#x90FD;&#x53D6;&#x51B3;&#x4E8E;&#x7EBF;&#x7A0B;&#x53D6;&#x6D88;&#x72B6;&#x6001;&#xFF08;state&#xFF09;&#x548C;&#x7C7B;&#x578B;&#xFF08;type&#xFF09;&#x3002;</p>
<h2 id="&#x53D6;&#x6D88;&#x72B6;&#x6001;&#x53CA;&#x7C7B;&#x578B;"><a href="#&#x53D6;&#x6D88;&#x72B6;&#x6001;&#x53CA;&#x7C7B;&#x578B;" class="headerlink" title="&#x53D6;&#x6D88;&#x72B6;&#x6001;&#x53CA;&#x7C7B;&#x578B;"></a>&#x53D6;&#x6D88;&#x72B6;&#x6001;&#x53CA;&#x7C7B;&#x578B;</h2><p>&#x51FD;&#x6570;pthread_setcancelstate()&#x548C;pthread_setcanceltype()&#x4F1A;&#x8BBE;&#x5B9A;&#x6807;&#x5FD7;&#xFF0C;&#x5141;&#x8BB8;&#x7EBF;&#x7A0B;&#x5BF9;&#x53D6;&#x6D88;&#x8BF7;&#x6C42;&#x7684;&#x54CD;&#x5E94;&#x8FC7;&#x7A0B;&#x52A0;&#x4EE5;&#x63A7;&#x5236;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;pthread.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">pthread_setcancelstate</span><span class="token punctuation">(</span><span class="token keyword">int</span> state<span class="token punctuation">,</span>   <span class="token keyword">int</span> <span class="token operator">*</span>oldstate<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">pthread_setcanceltype</span><span class="token punctuation">(</span><span class="token keyword">int</span> type<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span>oldtype<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x51FD;&#x6570;pthread_setcancelstate()&#x4F1A;&#x5C06;&#x8C03;&#x7528;&#x7EBF;&#x7A0B;&#x7684;&#x53D6;&#x6D88;&#x6027;&#x72B6;&#x6001;&#x7F6E;&#x4E3A;&#x53C2;&#x6570;state&#x6240;&#x7ED9;&#x5B9A;&#x7684;&#x503C;&#x3002;&#x8BE5;&#x53C2;&#x6570;&#x7684;&#x503C;&#x5982;&#x4E0B;&#x3002;</p>
<p><code>PTHREAD_CANCEL_DISABLE</code><br>&#x7EBF;&#x7A0B;&#x4E0D;&#x53EF;&#x53D6;&#x6D88;&#x3002;&#x5982;&#x679C;&#x6B64;&#x7C7B;&#x7EBF;&#x7A0B;&#x6536;&#x5230;&#x53D6;&#x6D88;&#x8BF7;&#x6C42;&#xFF0C;&#x5219;&#x4F1A;&#x5C06;&#x8BF7;&#x6C42;&#x6302;&#x8D77;&#xFF0C;&#x76F4;&#x81F3;&#x5C06;&#x7EBF;&#x7A0B;&#x7684;&#x53D6;&#x6D88;&#x72B6;&#x6001;&#x7F6E;&#x4E3A;&#x542F;&#x7528;&#x3002;</p>
<p><code>PTHREAD_CANCEL_ENABLE</code><br>&#x7EBF;&#x7A0B;&#x53EF;&#x4EE5;&#x53D6;&#x6D88;&#x3002;&#x8FD9;&#x662F;&#x65B0;&#x5EFA;&#x7EBF;&#x7A0B;&#x53D6;&#x6D88;&#x6027;&#x72B6;&#x6001;&#x7684;&#x9ED8;&#x8BA4;&#x503C;&#x3002;</p>
<p>&#x7EBF;&#x7A0B;&#x7684;&#x524D;&#x4E00;&#x53D6;&#x6D88;&#x6027;&#x72B6;&#x6001;&#x5C06;&#x8FD4;&#x56DE;&#x81F3;&#x53C2;&#x6570;oldstate&#x6240;&#x6307;&#x5411;&#x7684;&#x4F4D;&#x7F6E;&#x3002;</p>
<p>&#x5982;&#x679C;&#x5BF9;&#x524D;&#x4E00;&#x72B6;&#x6001;&#x6CA1;&#x6709;&#x5174;&#x8DA3;&#xFF0C;Linux&#x5141;&#x8BB8;&#x5C06;oldstate&#x7F6E;&#x4E3A;NULL&#x3002;&#x5728;&#x5F88;&#x591A;&#x5176;&#x4ED6;&#x7684;&#x7CFB;&#x7EDF;&#x5B9E;&#x73B0;&#x4E2D;&#xFF0C;&#x60C5;&#x51B5;&#x4E5F;&#x662F;&#x5982;&#x6B64;&#x3002;&#x4E0D;&#x8FC7;&#xFF0C;SUSv3&#x5E76;&#x6CA1;&#x6709;&#x89C4;&#x8303;&#x8FD9;&#x4E00;&#x7279;&#x6027;&#xFF0C;&#x6240;&#x4EE5;&#x8981;&#x4FDD;&#x8BC1;&#x5E94;&#x7528;&#x7684;&#x53EF;&#x79FB;&#x690D;&#x6027;&#xFF0C;&#x5C31;&#x4E0D;&#x80FD;&#x4F9D;&#x8D56;&#x8FD9;&#x4E00;&#x7279;&#x6027;&#x3002;&#x5E94;&#x8BE5;&#x603B;&#x662F;&#x4E3A;oldstate&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x975E;NULL&#x7684;&#x503C;&#x3002;</p>
<p>&#x5982;&#x679C;&#x7EBF;&#x7A0B;&#x6267;&#x884C;&#x7684;&#x4EE3;&#x7801;&#x7247;&#x6BB5;&#x9700;&#x8981;&#x4E0D;&#x95F4;&#x65AD;&#x5730;&#x4E00;&#x6C14;&#x5475;&#x6210;&#xFF0C;&#x90A3;&#x4E48;&#x4E34;&#x65F6;&#x5C4F;&#x95ED;&#x7EBF;&#x7A0B;&#x7684;&#x53D6;&#x6D88;&#x6027;&#x72B6;&#x6001;&#xFF08;PTHREAD_CANCEL_DISABLE&#xFF09;&#x5C31;&#x53D8;&#x5F97;&#x5F88;&#x6709;&#x5FC5;&#x8981;&#x3002;</p>
<p>&#x5982;&#x679C;&#x7EBF;&#x7A0B;&#x7684;&#x53D6;&#x6D88;&#x6027;&#x72B6;&#x6001;&#x4E3A;&#x201C;&#x542F;&#x7528;&#x201D;&#xFF08;PTHREAD_CANCEL_ENABLE&#xFF09;&#xFF0C;&#x90A3;&#x4E48;&#x5BF9;&#x53D6;&#x6D88;&#x8BF7;&#x6C42;&#x7684;&#x5904;&#x7406;&#x5219;&#x53D6;&#x51B3;&#x4E8E;&#x7EBF;&#x7A0B;&#x7684;&#x53D6;&#x6D88;&#x6027;&#x7C7B;&#x578B;&#xFF0C;&#x8BE5;&#x7C7B;&#x578B;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8C03;&#x7528;&#x51FD;&#x6570;pthread_setcanceltype()&#x65F6;&#x7684;&#x53C2;&#x6570;type&#x7ED9;&#x5B9A;&#x3002;&#x53C2;&#x6570;type&#x6709;&#x5982;&#x4E0B;&#x503C;&#xFF1A;</p>
<p><code>PTHREAD_CANCEL_ASYNCHRONOUS</code><br>&#x53EF;&#x80FD;&#x4F1A;&#x5728;&#x4EFB;&#x4F55;&#x65F6;&#x70B9;&#xFF08;&#x4E5F;&#x8BB8;&#x662F;&#x7ACB;&#x5373;&#x53D6;&#x6D88;&#xFF0C;&#x4F46;&#x4E0D;&#x4E00;&#x5B9A;&#xFF09;&#x53D6;&#x6D88;&#x7EBF;&#x7A0B;&#x3002;&#x5F02;&#x6B65;&#x53D6;&#x6D88;&#x7684;&#x5E94;&#x7528;&#x573A;&#x666F;&#x5F88;&#x5C11;&#xFF0C;&#x5C06;&#x5EF6;&#x540E;&#x81F3;32.6&#x8282;&#x518D;&#x505A;&#x8BA8;&#x8BBA;&#x3002;</p>
<p><code>PTHREAD_CANCEL_DEFERED</code><br>&#x53D6;&#x6D88;&#x8BF7;&#x6C42;&#x4FDD;&#x6301;&#x6302;&#x8D77;&#x72B6;&#x6001;&#xFF0C;&#x76F4;&#x81F3;&#x5230;&#x8FBE;&#x53D6;&#x6D88;&#x70B9;&#xFF08;cancellation point&#xFF0C;&#x89C1;&#x4E0B;&#x8282;&#xFF09;&#x3002;&#x8FD9;&#x4E5F;&#x662F;&#x65B0;&#x5EFA;&#x7EBF;&#x7A0B;&#x7684;&#x7F3A;&#x7701;&#x7C7B;&#x578B;&#x3002;&#x540E;&#x7EED;&#x5404;&#x8282;&#x5C06;&#x4ECB;&#x7ECD;&#x5EF6;&#x8FDF;&#x53D6;&#x6D88;&#xFF08;deferred cancelability&#xFF09;&#x7684;&#x66F4;&#x591A;&#x7EC6;&#x8282;&#x3002;</p>
<p>&#x7EBF;&#x7A0B;&#x539F;&#x6709;&#x7684;&#x53D6;&#x6D88;&#x7C7B;&#x578B;&#x5C06;&#x8FD4;&#x56DE;&#x81F3;&#x53C2;&#x6570;oldtype&#x6240;&#x6307;&#x5411;&#x7684;&#x4F4D;&#x7F6E;&#x3002;</p>
<p>&#x4E0E;&#x51FD;&#x6570;pthread_setcancelstate()&#x7684;&#x53C2;&#x6570;oldstate&#x7C7B;&#x4F3C;&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x5173;&#x5FC3;&#x539F;&#x6709;&#x53D6;&#x6D88;&#x7C7B;&#x578B;&#xFF0C;&#x8BB8;&#x591A;&#x7CFB;&#x7EDF;&#x5B9E;&#x73B0;&#xFF08;&#x5305;&#x62EC;Linux&#xFF09;&#x5141;&#x8BB8;&#x5C06;oldtype&#x7F6E;&#x4E3A;NULL&#x3002;&#x540C;&#x6837;&#xFF0C;SUSv3&#x4E5F;&#x6CA1;&#x6709;&#x89C4;&#x8303;&#x8FD9;&#x4E00;&#x884C;&#x4E3A;&#xFF0C;&#x6240;&#x4EE5;&#x9700;&#x8981;&#x4FDD;&#x969C;&#x53EF;&#x79FB;&#x690D;&#x6027;&#x7684;&#x5E94;&#x7528;&#x4E0D;&#x5E94;&#x4F7F;&#x7528;&#x8FD9;&#x4E00;&#x7279;&#x6027;&#xFF0C;&#x5E94;&#x8BE5;&#x603B;&#x662F;&#x4E3A;oldtype&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x975E;NULL&#x503C;&#x3002;</p>
<p>&#x5F53;&#x67D0;&#x7EBF;&#x7A0B;&#x8C03;&#x7528;fork()&#x65F6;&#xFF0C;&#x5B50;&#x8FDB;&#x7A0B;&#x4F1A;&#x7EE7;&#x627F;&#x8C03;&#x7528;&#x7EBF;&#x7A0B;&#x7684;&#x53D6;&#x6D88;&#x6027;&#x7C7B;&#x578B;&#x53CA;&#x72B6;&#x6001;&#x3002;&#x800C;&#x5F53;&#x67D0;&#x7EBF;&#x7A0B;&#x8C03;&#x7528;exec()&#x65F6;&#xFF0C;&#x4F1A;&#x5C06;&#x65B0;&#x7A0B;&#x5E8F;&#x4E3B;&#x7EBF;&#x7A0B;&#x7684;&#x53D6;&#x6D88;&#x6027;&#x7C7B;&#x578B;&#x53CA;&#x72B6;&#x6001;&#x5206;&#x522B;&#x91CD;&#x7F6E;&#x4E3A;PTHREAD_CANCEL_NABLE&#x548C;PTHREAD_CANCEL_DEFERRED&#x3002;</p>
<h2 id="&#x53D6;&#x6D88;&#x70B9;"><a href="#&#x53D6;&#x6D88;&#x70B9;" class="headerlink" title="&#x53D6;&#x6D88;&#x70B9;"></a>&#x53D6;&#x6D88;&#x70B9;</h2><p>&#x82E5;&#x5C06;&#x7EBF;&#x7A0B;&#x7684;&#x53D6;&#x6D88;&#x6027;&#x72B6;&#x6001;&#x548C;&#x7C7B;&#x578B;&#x5206;&#x522B;&#x7F6E;&#x4E3A;&#x542F;&#x7528;&#x548C;&#x5EF6;&#x8FDF;&#xFF0C;&#x4EC5;&#x5F53;&#x7EBF;&#x7A0B;&#x62B5;&#x8FBE;&#x67D0;&#x4E2A;&#x53D6;&#x6D88;&#x70B9;&#xFF08;cancellation point&#xFF09;&#x65F6;&#xFF0C;&#x53D6;&#x6D88;&#x8BF7;&#x6C42;&#x624D;&#x4F1A;&#x8D77;&#x4F5C;&#x7528;&#x3002;&#x53D6;&#x6D88;&#x70B9;&#x5373;&#x662F;&#x5BF9;&#x7531;&#x5B9E;&#x73B0;&#x5B9A;&#x4E49;&#x7684;&#x4E00;&#x7EC4;&#x51FD;&#x6570;&#x4E4B;&#x4E00;&#x52A0;&#x4EE5;&#x8C03;&#x7528;&#x3002;</p>
<p>SUSv3&#x89C4;&#x5B9A;&#xFF0C;&#x5B9E;&#x73B0;&#x82E5;&#x63D0;&#x4F9B;&#x4E86;&#x4E0B;&#x8868;&#x6240;&#x5217;&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x5219;&#x8FD9;&#x4E9B;&#x51FD;&#x6570;&#x5FC5;&#x987B;&#x662F;&#x53D6;&#x6D88;&#x70B9;&#x3002;&#x5176;&#x4E2D;&#x7684;&#x5927;&#x90E8;&#x5206;&#x51FD;&#x6570;&#x90FD;&#x6709;&#x80FD;&#x529B;&#x5C06;&#x7EBF;&#x7A0B;&#x65E0;&#x9650;&#x671F;&#x5730;&#x5835;&#x585E;&#x8D77;&#x6765;&#x3002;</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th align="left">&#x51FD;&#x6570;</th>
<th align="left">&#x51FD;&#x6570;</th>
<th align="left">&#x51FD;&#x6570;</th>
</tr>
</thead>
<tbody><tr>
<td align="left">accept()</td>
<td align="left">nanosleep()</td>
<td align="left">sem_timedwait()</td>
</tr>
<tr>
<td align="left">aio_suspend()</td>
<td align="left">open()</td>
<td align="left">sem_wait()</td>
</tr>
<tr>
<td align="left">clock_nanosleep()</td>
<td align="left">pause()</td>
<td align="left">send()</td>
</tr>
<tr>
<td align="left">close()</td>
<td align="left">poll()</td>
<td align="left">sendmsg()</td>
</tr>
<tr>
<td align="left">connect()</td>
<td align="left">pread()</td>
<td align="left">sendto()</td>
</tr>
<tr>
<td align="left">creat()</td>
<td align="left">pselect()</td>
<td align="left">sigpause()</td>
</tr>
<tr>
<td align="left">fcntl(F_SETLKW)</td>
<td align="left">pthread_cond_timedwait()</td>
<td align="left">sigsuspend()</td>
</tr>
<tr>
<td align="left">fsync()</td>
<td align="left">pthread_cond_wait()</td>
<td align="left">sigtimedwait()</td>
</tr>
<tr>
<td align="left">fdatasync()</td>
<td align="left">pthread_join()</td>
<td align="left">sigwait()</td>
</tr>
<tr>
<td align="left">getmsg()</td>
<td align="left">pthread_testcancel()</td>
<td align="left">sigwaitinfo()</td>
</tr>
<tr>
<td align="left">getpmsg()</td>
<td align="left">putmsg()</td>
<td align="left">sleep()</td>
</tr>
<tr>
<td align="left">lockf(F_LOCK)</td>
<td align="left">putpmsg()</td>
<td align="left">system()</td>
</tr>
<tr>
<td align="left">mq_receive()</td>
<td align="left">pwrite()</td>
<td align="left">tcdrain()</td>
</tr>
<tr>
<td align="left">mq_send()</td>
<td align="left">read()</td>
<td align="left">usleep()</td>
</tr>
<tr>
<td align="left">mq_timedreceive()</td>
<td align="left">readv()</td>
<td align="left">wait()</td>
</tr>
<tr>
<td align="left">mq_timedsend()</td>
<td align="left">recv()</td>
<td align="left">waitid()</td>
</tr>
<tr>
<td align="left">msgrcv()</td>
<td align="left">recvfrom()</td>
<td align="left">waitpid()</td>
</tr>
<tr>
<td align="left">msgsnd()</td>
<td align="left">recvmsg()</td>
<td align="left">write()</td>
</tr>
<tr>
<td align="left">msync()</td>
<td align="left">select()</td>
<td align="left">writev()</td>
</tr>
</tbody></table></div>
<p>&#x9664;&#x4E0A;&#x8868;&#x6240;&#x5217;&#x51FD;&#x6570;&#x4E4B;&#x5916;&#xFF0C;SUSv3&#x8FD8;&#x6307;&#x5B9A;&#x4E86;&#x5927;&#x91CF;&#x51FD;&#x6570;&#xFF0C;&#x7CFB;&#x7EDF;&#x5B9E;&#x73B0;&#x53EF;&#x4EE5;&#x5C06;&#x5176;&#x5B9A;&#x4E49;&#x4E3A;&#x53D6;&#x6D88;&#x70B9;&#x3002;&#x5176;&#x4E2D;&#x5305;&#x62EC;stdio&#x51FD;&#x6570;&#x3001;dlopen API&#x3001;syslog API&#x3001;nftw()&#x3001;popen()&#x3001;semop()&#x3001;unlink()&#xFF0C;&#x4EE5;&#x53CA;&#x4ECE;&#x8BF8;&#x5982; utmp &#x4E4B;&#x7C7B;&#x7684;&#x7CFB;&#x7EDF;&#x6587;&#x4EF6;&#x4E2D;&#x83B7;&#x53D6;&#x4FE1;&#x606F;&#x7684;&#x5404;&#x79CD;&#x51FD;&#x6570;&#x3002;&#x53EF;&#x79FB;&#x690D;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5FC5;&#x987B;&#x6B63;&#x786E;&#x5904;&#x7406;&#x8FD9;&#x4E00;&#x60C5;&#x51B5;&#xFF1A;&#x7EBF;&#x7A0B;&#x5728;&#x8C03;&#x7528;&#x8FD9;&#x4E9B;&#x51FD;&#x6570;&#x65F6;&#x6709;&#x53EF;&#x80FD;&#x906D;&#x5230;&#x53D6;&#x6D88;&#x3002;</p>
<p>SUSv3&#x89C4;&#x5B9A;&#xFF0C;&#x9664;&#x4E86;&#x4E0A;&#x8FF0;&#x4E24;&#x7EC4;&#x5FC5;&#x987B;&#x6216;&#x53EF;&#x80FD;&#x662F;&#x53EF;&#x53D6;&#x6D88;&#x70B9;&#x7684;&#x51FD;&#x6570;&#x4E4B;&#x5916;&#xFF0C;&#x4E0D;&#x5F97;&#x5C06;&#x6807;&#x51C6;&#x4E2D;&#x7684;&#x4EFB;&#x4F55;&#x5176;&#x4ED6;&#x51FD;&#x6570;&#x89C6;&#x4E3A;&#x53D6;&#x6D88;&#x70B9;&#xFF08;&#x4EA6;&#x5373;&#xFF0C;&#x8C03;&#x7528;&#x8FD9;&#x4E9B;&#x51FD;&#x6570;&#x4E0D;&#x4F1A;&#x62DB;&#x81F4;&#x7EBF;&#x7A0B;&#x53D6;&#x6D88;&#xFF0C;&#x53EF;&#x79FB;&#x690D;&#x7A0B;&#x5E8F;&#x65E0;&#x9700;&#x52A0;&#x4EE5;&#x5904;&#x7406;&#xFF09;&#x3002;</p>
<p>SUSv4&#x5728;&#x5FC5;&#x987B;&#x7684;&#x53EF;&#x53D6;&#x6D88;&#x70B9;&#x51FD;&#x6570;&#x5217;&#x8868;&#x4E2D;&#x589E;&#x52A0;&#x4E86;openat()&#xFF0C;&#x5E76;&#x79FB;&#x9664;&#x4E86;&#x51FD;&#x6570;sigpause()&#xFF08;&#x5C06;&#x5176;&#x79FB;&#x81F3;&#x201C;&#x53EF;&#x80FD;&#x7684;&#x201D;&#x53D6;&#x6D88;&#x70B9;&#x51FD;&#x6570;&#x5217;&#x8868;&#x4E2D;&#xFF09;&#x548C;&#x51FD;&#x6570;usleep()&#xFF08;&#x5DF2;&#x4ECE;&#x6807;&#x51C6;&#x4E2D;&#x5220;&#x9664;&#xFF09;&#x3002;</p>
<p>&#x7CFB;&#x7EDF;&#x5B9E;&#x73B0;&#x53EF;&#x968F;&#x610F;&#x5C06;&#x6807;&#x51C6;&#x5E76;&#x672A;&#x89C4;&#x8303;&#x7684;&#x5176;&#x4ED6;&#x51FD;&#x6570;&#x6807;&#x8BB0;&#x4E3A;&#x53D6;&#x6D88;&#x70B9;&#x3002;&#x4EFB;&#x4F55;&#x53EF;&#x80FD;&#x9020;&#x6210;&#x5835;&#x585E;&#x7684;&#x51FD;&#x6570;&#xFF08;&#x6709;&#x53EF;&#x80FD;&#x662F;&#x56E0;&#x4E3A;&#x9700;&#x8981;&#x8BBF;&#x95EE;&#x6587;&#x4EF6;&#xFF09;&#x90FD;&#x662F;&#x53D6;&#x6D88;&#x70B9;&#x7684;&#x7406;&#x60F3;&#x5019;&#x9009;&#x5BF9;&#x8C61;&#x3002;&#x51FA;&#x4E8E;&#x8FD9;&#x4E00;&#x7406;&#x7531;&#xFF0C;glibc&#x5C06;&#x5176;&#x4E2D;&#x7684;&#x8BB8;&#x591A;&#x975E;&#x6807;&#x51C6;&#x51FD;&#x6570;&#x6807;&#x8BB0;&#x4E3A;&#x53D6;&#x6D88;&#x70B9;&#x3002;</p>
<p>&#x7EBF;&#x7A0B;&#x4E00;&#x65E6;&#x6536;&#x5230;&#x53D6;&#x6D88;&#x8BF7;&#x6C42;&#xFF0C;&#x4E14;&#x542F;&#x7528;&#x4E86;&#x53D6;&#x6D88;&#x6027;&#x72B6;&#x6001;&#x5E76;&#x5C06;&#x7C7B;&#x578B;&#x7F6E;&#x4E3A;&#x5EF6;&#x8FDF;&#xFF0C;&#x5219;&#x5176;&#x4F1A;&#x5728;&#x4E0B;&#x6B21;&#x62B5;&#x8FBE;&#x53D6;&#x6D88;&#x70B9;&#x65F6;&#x7EC8;&#x6B62;&#x3002;&#x5982;&#x679C;&#x8BE5;&#x7EBF;&#x7A0B;&#x5C1A;&#x672A;&#x5206;&#x79BB;&#xFF08;not detached&#xFF09;&#xFF0C;&#x90A3;&#x4E48;&#x4E3A;&#x9632;&#x6B62;&#x5176;&#x53D8;&#x4E3A;&#x50F5;&#x5C38;&#x7EBF;&#x7A0B;&#xFF0C;&#x5FC5;&#x987B;&#x7531;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x5BF9;&#x5176;&#x8FDB;&#x884C;&#x8FDE;&#x63A5;&#xFF08;join&#xFF09;&#x3002;&#x8FDE;&#x63A5;&#x4E4B;&#x540E;&#xFF0C;&#x8FD4;&#x56DE;&#x81F3;&#x51FD;&#x6570;pthread_join()&#x4E2D;&#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570;&#x7684;&#x5C06;&#x662F;&#x4E00;&#x4E2A;&#x7279;&#x6B8A;&#x503C;&#xFF1A;PTHREAD_CANCELED&#x3002;</p>
<h2 id="&#x7EBF;&#x7A0B;&#x53EF;&#x53D6;&#x6D88;&#x6027;&#x7684;&#x68C0;&#x6D4B;"><a href="#&#x7EBF;&#x7A0B;&#x53EF;&#x53D6;&#x6D88;&#x6027;&#x7684;&#x68C0;&#x6D4B;" class="headerlink" title="&#x7EBF;&#x7A0B;&#x53EF;&#x53D6;&#x6D88;&#x6027;&#x7684;&#x68C0;&#x6D4B;"></a>&#x7EBF;&#x7A0B;&#x53EF;&#x53D6;&#x6D88;&#x6027;&#x7684;&#x68C0;&#x6D4B;</h2><p>&#x7531;main()&#x521B;&#x5EFA;&#x7684;&#x7EBF;&#x7A0B;&#x4F1A;&#x6267;&#x884C;&#x5230;&#x5C5E;&#x4E8E;&#x53D6;&#x6D88;&#x70B9;&#x7684;&#x51FD;&#x6570;&#xFF08;sleep()&#x5C5E;&#x4E8E;&#x53D6;&#x6D88;&#x70B9;&#xFF0C;printf()&#x53EF;&#x80FD;&#x4E5F;&#x662F;&#xFF09;&#xFF0C;&#x56E0;&#x800C;&#x4F1A;&#x63A5;&#x53D7;&#x53D6;&#x6D88;&#x8BF7;&#x6C42;&#x3002;&#x4E0D;&#x8FC7;&#xFF0C;&#x5047;&#x8BBE;&#x7EBF;&#x7A0B;&#x6267;&#x884C;&#x7684;&#x662F;&#x4E00;&#x4E2A;&#x4E0D;&#x542B;&#x53D6;&#x6D88;&#x70B9;&#x7684;&#x5FAA;&#x73AF;&#xFF08;&#x8BA1;&#x7B97;&#x5BC6;&#x96C6;&#x578B;&#xFF3B;compute-bound&#xFF3D;&#x5FAA;&#x73AF;&#xFF09;&#xFF0C;&#x8FD9;&#x65F6;&#xFF0C;&#x7EBF;&#x7A0B;&#x6C38;&#x8FDC;&#x4E5F;&#x4E0D;&#x4F1A;&#x54CD;&#x5E94;&#x53D6;&#x6D88;&#x8BF7;&#x6C42;&#x3002;</p>
<p>&#x51FD;&#x6570;pthread_testcancel()&#x7684;&#x76EE;&#x7684;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x5C31;&#x662F;&#x4EA7;&#x751F;&#x4E00;&#x4E2A;&#x53D6;&#x6D88;&#x70B9;&#x3002;&#x7EBF;&#x7A0B;&#x5982;&#x679C;&#x5DF2;&#x6709;&#x5904;&#x4E8E;&#x6302;&#x8D77;&#x72B6;&#x6001;&#x7684;&#x53D6;&#x6D88;&#x8BF7;&#x6C42;&#xFF0C;&#x90A3;&#x4E48;&#x53EA;&#x8981;&#x8C03;&#x7528;&#x8BE5;&#x51FD;&#x6570;&#xFF0C;&#x7EBF;&#x7A0B;&#x5C31;&#x4F1A;&#x968F;&#x4E4B;&#x7EC8;&#x6B62;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;pthread.h&gt;</span></span>

<span class="token keyword">void</span> <span class="token function">pthread_testcancel</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x5F53;&#x7EBF;&#x7A0B;&#x6267;&#x884C;&#x7684;&#x4EE3;&#x7801;&#x672A;&#x5305;&#x542B;&#x53D6;&#x6D88;&#x70B9;&#x65F6;&#xFF0C;&#x53EF;&#x4EE5;&#x5468;&#x671F;&#x6027;&#x5730;&#x8C03;&#x7528;pthread_testcancel()&#xFF0C;&#x4EE5;&#x786E;&#x4FDD;&#x5BF9;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x5411;&#x5176;&#x53D1;&#x9001;&#x7684;&#x53D6;&#x6D88;&#x8BF7;&#x6C42;&#x505A;&#x51FA;&#x53CA;&#x65F6;&#x54CD;&#x5E94;&#x3002;</p>
<h2 id="&#x6E05;&#x7406;&#x51FD;&#x6570;&#xFF08;cleanup-handler&#xFF09;"><a href="#&#x6E05;&#x7406;&#x51FD;&#x6570;&#xFF08;cleanup-handler&#xFF09;" class="headerlink" title="&#x6E05;&#x7406;&#x51FD;&#x6570;&#xFF08;cleanup handler&#xFF09;"></a>&#x6E05;&#x7406;&#x51FD;&#x6570;&#xFF08;cleanup handler&#xFF09;</h2><p>&#x4E00;&#x65E6;&#x6709;&#x5904;&#x4E8E;&#x6302;&#x8D77;&#x72B6;&#x6001;&#x7684;&#x53D6;&#x6D88;&#x8BF7;&#x6C42;&#xFF0C;&#x7EBF;&#x7A0B;&#x5728;&#x6267;&#x884C;&#x5230;&#x53D6;&#x6D88;&#x70B9;&#x65F6;&#x5982;&#x679C;&#x53EA;&#x662F;&#x8349;&#x8349;&#x6536;&#x573A;&#xFF0C;&#x8FD9;&#x4F1A;&#x5C06;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#x4EE5;&#x53CA;Pthreads&#x5BF9;&#x8C61;&#xFF08;&#x4F8B;&#x5982;&#x4E92;&#x65A5;&#x91CF;&#xFF09;&#x7F6E;&#x4E8E;&#x4E00;&#x79CD;&#x4E0D;&#x4E00;&#x81F4;&#x72B6;&#x6001;&#xFF0C;&#x53EF;&#x80FD;&#x5BFC;&#x81F4;&#x8FDB;&#x7A0B;&#x4E2D;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x4EA7;&#x751F;&#x9519;&#x8BEF;&#x7ED3;&#x679C;&#x3001;&#x6B7B;&#x9501;&#xFF0C;&#x751A;&#x81F3;&#x9020;&#x6210;&#x7A0B;&#x5E8F;&#x5D29;&#x6E83;&#x3002;&#x4E3A;&#x89C4;&#x907F;&#x8FD9;&#x4E00;&#x95EE;&#x9898;&#xFF0C;&#x7EBF;&#x7A0B;&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x6E05;&#x7406;&#x51FD;&#x6570;&#xFF0C;&#x5F53;&#x7EBF;&#x7A0B;&#x906D;&#x53D6;&#x6D88;&#x65F6;&#x4F1A;&#x81EA;&#x52A8;&#x8FD0;&#x884C;&#x8FD9;&#x4E9B;&#x51FD;&#x6570;&#xFF0C;&#x5728;&#x7EBF;&#x7A0B;&#x7EC8;&#x6B62;&#x4E4B;&#x524D;&#x53EF;&#x6267;&#x884C;&#x8BF8;&#x5982;&#x4FEE;&#x6539;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#xFF0C;&#x89E3;&#x9501;&#x4E92;&#x65A5;&#x91CF;&#x7B49;&#x52A8;&#x4F5C;&#x3002;</p>
<p>&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x90FD;&#x53EF;&#x4EE5;&#x62E5;&#x6709;&#x4E00;&#x4E2A;&#x6E05;&#x7406;&#x51FD;&#x6570;&#x6808;&#x3002;&#x5F53;&#x7EBF;&#x7A0B;&#x906D;&#x53D6;&#x6D88;&#x65F6;&#xFF0C;&#x4F1A;&#x6CBF;&#x8BE5;&#x6808;&#x81EA;&#x9876;&#x5411;&#x4E0B;&#x4F9D;&#x6B21;&#x6267;&#x884C;&#x6E05;&#x7406;&#x51FD;&#x6570;&#xFF0C;&#x9996;&#x5148;&#x4F1A;&#x6267;&#x884C;&#x6700;&#x8FD1;&#x8BBE;&#x7F6E;&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x63A5;&#x7740;&#x662F;&#x6B21;&#x65B0;&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x4EE5;&#x6B64;&#x7C7B;&#x63A8;&#x3002;&#x5F53;&#x6267;&#x884C;&#x5B8C;&#x6240;&#x6709;&#x6E05;&#x7406;&#x51FD;&#x6570;&#x540E;&#xFF0C;&#x7EBF;&#x7A0B;&#x7EC8;&#x6B62;&#x3002;</p>
<p>&#x51FD;&#x6570; pthread_cleanup_push()&#x548C; pthread_cleanup_pop()&#x5206;&#x522B;&#x8D1F;&#x8D23;&#x5411;&#x8C03;&#x7528;&#x7EBF;&#x7A0B;&#x7684;&#x6E05;&#x7406;&#x51FD;&#x6570;&#x6808;&#x6DFB;&#x52A0;&#x548C;&#x79FB;&#x9664;&#x6E05;&#x7406;&#x51FD;&#x6570;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;pthread.h&gt;</span></span>

<span class="token keyword">void</span> <span class="token function">pthread_cleanup_push</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>rtn<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">)</span>&#xFF0C;<span class="token keyword">void</span> <span class="token operator">*</span>arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">pthread_cleanup_pop</span><span class="token punctuation">(</span><span class="token keyword">int</span> execute<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>pthread_cleanup_push()&#x4F1A;&#x5C06;&#x53C2;&#x6570;routine&#x6240;&#x542B;&#x7684;&#x51FD;&#x6570;&#x5730;&#x5740;&#x6DFB;&#x52A0;&#x5230;&#x8C03;&#x7528;&#x7EBF;&#x7A0B;&#x7684;&#x6E05;&#x7406;&#x51FD;&#x6570;&#x6808;&#x9876;&#x3002;&#x53C2;&#x6570;routine&#x662F;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x6307;&#x9488;&#xFF0C;&#x683C;&#x5F0F;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">routine</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>arg<span class="token punctuation">)</span>
<span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token comment" spellcheck="true">/* &#x6267;&#x884C;&#x6E05;&#x7406;&#x4EE3;&#x7801; */</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x6267;&#x884C;pthread_cleanup_push()&#x65F6;&#x7ED9;&#x5B9A;&#x7684; arg &#x503C;&#xFF0C;&#x4F1A;&#x4F5C;&#x4E3A;&#x8C03;&#x7528;&#x6E05;&#x7406;&#x51FD;&#x6570;&#x65F6;&#x7684;&#x53C2;&#x6570;&#x3002;&#x5176;&#x53C2;&#x6570;&#x7C7B;&#x578B;&#x4E3A;void*&#xFF0C;&#x5982;&#x679C;&#x5F3A;&#x5236;&#x88C5;&#x6362;&#x4F7F;&#x7528;&#x5F97;&#x5F53;&#xFF0C;&#x90A3;&#x4E48;&#x901A;&#x8FC7;&#x8BE5;&#x53C2;&#x6570;&#x53EF;&#x4EE5;&#x4F20;&#x5165;&#x5404;&#x79CD;&#x7C7B;&#x578B;&#x7684;&#x6570;&#x636E;&#x3002;</p>
<p>&#x901A;&#x5E38;&#xFF0C;&#x7EBF;&#x7A0B;&#x5982;&#x5728;&#x6267;&#x884C;&#x4E00;&#x6BB5;&#x7279;&#x6B8A;&#x4EE3;&#x7801;&#x65F6;&#x906D;&#x5230;&#x53D6;&#x6D88;&#xFF0C;&#x624D;&#x9700;&#x8981;&#x6267;&#x884C;&#x6E05;&#x7406;&#x52A8;&#x4F5C;&#x3002;&#x5982;&#x679C;&#x7EBF;&#x7A0B;&#x987A;&#x5229;&#x6267;&#x884C;&#x5B8C;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x800C;&#x672A;&#x906D;&#x53D6;&#x6D88;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x4E0D;&#x518D;&#x9700;&#x8981;&#x6E05;&#x7406;&#x3002;&#x6240;&#x4EE5;&#xFF0C;&#x6BCF;&#x4E2A;&#x5BF9;pthread_cleanup_push()&#x7684;&#x8C03;&#x7528;&#x90FD;&#x4F1A;&#x4F34;&#x968F;&#x7740;&#x5BF9; pthread_cleanup_pop()&#x7684;&#x8C03;&#x7528;&#x3002;&#x6B64;&#x51FD;&#x6570;&#x4ECE;&#x6E05;&#x7406;&#x51FD;&#x6570;&#x6808;&#x4E2D;&#x79FB;&#x9664;&#x6700;&#x9876;&#x5C42;&#x7684;&#x51FD;&#x6570;&#x3002;&#x5982;&#x679C;&#x53C2;&#x6570; execute &#x975E;&#x96F6;&#xFF0C;&#x90A3;&#x4E48;&#x65E0;&#x8BBA;&#x5982;&#x4F55;&#x90FD;&#x4F1A;&#x6267;&#x884C;&#x6E05;&#x7406;&#x51FD;&#x6570;&#x3002;&#x5728;&#x51FD;&#x6570;&#x672A;&#x906D;&#x53D6;&#x6D88;&#x800C;&#x53C8;&#x5E0C;&#x671B;&#x6267;&#x884C;&#x6E05;&#x7406;&#x52A8;&#x4F5C;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x8FD9;&#x4F1A;&#x975E;&#x5E38;&#x65B9;&#x4FBF;&#x3002;</p>
<p>&#x5C3D;&#x7BA1;&#x8FD9;&#x91CC;&#x628A;pthread_cleanup_push()&#x548C;pthread_cleanup_pop()&#x63CF;&#x8FF0;&#x4E3A;&#x51FD;&#x6570;&#xFF0C;SUSv3&#x5374;&#x5141;&#x8BB8;&#x5C06;&#x5B83;&#x4EEC;&#x5B9E;&#x73B0;&#x4E3A;&#x5B8F;&#xFF08;macro&#xFF09;&#xFF0C;&#x53EF;&#x5C55;&#x5F00;&#x4E3A;&#x5206;&#x522B;&#x7531;{&#x548C;}&#x6240;&#x5305;&#x88F9;&#x7684;&#x8BED;&#x53E5;&#x5E8F;&#x5217;&#x3002;&#x5E76;&#x975E;&#x6240;&#x6709;&#x7684; UNIX&#x90FD;&#x8FD9;&#x6837;&#x505A;&#xFF0C;&#x4E0D;&#x8FC7;&#x5305;&#x62EC;Linux&#x5728;&#x5185;&#x7684;&#x5F88;&#x591A;&#x7CFB;&#x7EDF;&#x90FD;&#x662F;&#x4F7F;&#x7528;&#x5B8F;&#x6765;&#x5B9E;&#x73B0;&#x7684;&#x3002;&#x8FD9;&#x610F;&#x5473;&#x7740;&#xFF0C;pthread_cleanup_push()&#x548C;&#x4E0E;&#x5176;&#x914D;&#x5BF9;&#x7684;pthread_cleanup_pop()&#x5C5E;&#x4E8E;&#x540C;&#x4E00;&#x4E2A;&#x8BED;&#x6CD5;&#x5757;&#xFF0C;&#x5FC5;&#x987B;&#x4E00;&#x4E00;&#x5BF9;&#x5E94;&#x3002;&#xFF08;&#x4E00;&#x65E6;&#x4EE5;&#x6B64;&#x65B9;&#x5F0F;&#x6765;&#x5B9E;&#x73B0;pthread_cleanup_push()&#x548C;pthread_cleanup_pop()&#xFF0C;&#x5728;&#x5BF9;&#x4E24;&#x8005;&#x7684;&#x8C03;&#x7528;&#x95F4;&#x6240;&#x58F0;&#x660E;&#x7684;&#x53D8;&#x91CF;&#xFF0C;&#x5176;&#x4F5C;&#x7528;&#x57DF;&#x5C06;&#x53D7;&#x9650;&#x4E8E;&#x8FD9;&#x4E00;&#x8BED;&#x6CD5;&#x5757;&#x3002;&#xFF09;&#x4F8B;&#x5982;&#xFF0C;&#x4EE5;&#x4E0B;&#x4EE3;&#x7801;&#x5C31;&#x4E0D;&#x6B63;&#x786E;&#xFF1A;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token function">pthread_cleanup_push</span><span class="token punctuation">(</span>func<span class="token punctuation">,</span>arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>cond<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">pthread_cleanup_pop</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x4E3A;&#x4FBF;&#x4E8E;&#x7F16;&#x7801;&#xFF0C;&#x82E5;&#x7EBF;&#x7A0B;&#x56E0;&#x8C03;&#x7528;pthread_exit()&#x800C;&#x7EC8;&#x6B62;&#xFF0C;&#x5219;&#x4E5F;&#x4F1A;&#x81EA;&#x52A8;&#x6267;&#x884C;&#x5C1A;&#x672A;&#x4ECE;&#x6E05;&#x7406;&#x51FD;&#x6570;&#x6808;&#x4E2D;&#x5F39;&#x51FA;&#xFF08;pop&#xFF09;&#x7684;&#x6E05;&#x7406;&#x51FD;&#x6570;&#x3002;&#x7EBF;&#x7A0B;&#x6B63;&#x5E38;&#x8FD4;&#x56DE;&#xFF08;return&#xFF09;&#x65F6;&#x4E0D;&#x4F1A;&#x6267;&#x884C;&#x6E05;&#x7406;&#x51FD;&#x6570;&#x3002;</p>
<h2 id="&#x5F02;&#x6B65;&#x53D6;&#x6D88;"><a href="#&#x5F02;&#x6B65;&#x53D6;&#x6D88;" class="headerlink" title="&#x5F02;&#x6B65;&#x53D6;&#x6D88;"></a>&#x5F02;&#x6B65;&#x53D6;&#x6D88;</h2><p>&#x5982;&#x679C;&#x8BBE;&#x5B9A;&#x7EBF;&#x7A0B;&#x4E3A;&#x53EF;&#x5F02;&#x6B65;&#x53D6;&#x6D88;&#x65F6;&#xFF08;&#x53D6;&#x6D88;&#x6027;&#x7C7B;&#x578B;&#x4E3A;PTHREAD_CANCEL_ASYNCHRONOUS&#xFF09;&#xFF0C;&#x53EF;&#x4EE5;&#x5728;&#x4EFB;&#x4F55;&#x65F6;&#x70B9;&#x5C06;&#x5176;&#x53D6;&#x6D88;&#xFF08;&#x4EA6;&#x5373;&#xFF0C;&#x6267;&#x884C;&#x4EFB;&#x4F55;&#x673A;&#x5668;&#x6307;&#x4EE4;&#x65F6;&#xFF09;&#xFF0C;&#x53D6;&#x6D88;&#x52A8;&#x4F5C;&#x4E0D;&#x4F1A;&#x62D6;&#x5EF6;&#x5230;&#x4E0B;&#x4E00;&#x4E2A;&#x53D6;&#x6D88;&#x70B9;&#x624D;&#x6267;&#x884C;&#x3002;</p>
<p>&#x5F02;&#x6B65;&#x53D6;&#x6D88;&#x7684;&#x95EE;&#x9898;&#x5728;&#x4E8E;&#xFF0C;&#x5C3D;&#x7BA1;&#x6E05;&#x7406;&#x51FD;&#x6570;&#x4F9D;&#x7136;&#x4F1A;&#x5F97;&#x4EE5;&#x6267;&#x884C;&#xFF0C;&#x4F46;&#x5904;&#x7406;&#x51FD;&#x6570;&#x5374;&#x65E0;&#x4ECE;&#x5F97;&#x77E5;&#x7EBF;&#x7A0B;&#x7684;&#x5177;&#x4F53;&#x72B6;&#x6001;&#x3002;&#x7A0B;&#x5E8F;&#x6E05;&#x5355;32-2&#x91C7;&#x7528;&#x4E86;&#x5EF6;&#x65F6;&#x53D6;&#x6D88;&#x7C7B;&#x578B;&#xFF0C;&#x53EA;&#x6709;&#x5728;&#x6267;&#x884C;&#x5230;pthread_cond_wait()&#x8FD9;&#x4E00;&#x552F;&#x4E00;&#x7684;&#x53D6;&#x6D88;&#x70B9;&#x65F6;&#xFF0C;&#x7EBF;&#x7A0B;&#x624D;&#x4F1A;&#x906D;&#x5230;&#x53D6;&#x6D88;&#x3002;&#x6B64;&#x65F6;&#x53EF;&#x77E5;&#xFF0C;&#x5DF2;&#x5C06;buf&#x521D;&#x59CB;&#x5316;&#x4E3A;&#x6307;&#x5411;&#x65B0;&#x5206;&#x914D;&#x7684;&#x5185;&#x5B58;&#x5757;&#xFF0C;&#x5E76;&#x4E14;&#x9501;&#x5B9A;&#x4E86;&#x4E92;&#x65A5;&#x91CF;mtx&#x3002;&#x4E0D;&#x8FC7;&#xFF0C;&#x8981;&#x662F;&#x91C7;&#x7528;&#x5F02;&#x6B65;&#x53D6;&#x6D88;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x5728;&#x4EFB;&#x610F;&#x70B9;&#x53D6;&#x6D88;&#x7EBF;&#x7A0B;&#xFF08;&#x4F8B;&#x5982;&#xFF0C;&#x8C03;&#x7528;malloc()&#x4E4B;&#x524D;&#xFF0C;&#x8C03;&#x7528;malloc()&#x4E0E;&#x9501;&#x5B9A;&#x4E92;&#x65A5;&#x91CF;&#x4E4B;&#x95F4;&#xFF0C;&#x6216;&#x8005;&#x9501;&#x5B9A;&#x4E92;&#x65A5;&#x91CF;&#x4E4B;&#x540E;&#xFF09;&#x3002;&#x6E05;&#x7406;&#x51FD;&#x6570;&#x65E0;&#x6CD5;&#x77E5;&#x9053;&#x5C06;&#x5728;&#x54EA;&#x91CC;&#x53D1;&#x751F;&#x53D6;&#x6D88;&#x52A8;&#x4F5C;&#xFF0C;&#x6216;&#x8005;&#x51C6;&#x786E;&#x5730;&#x6765;&#x8BF4;&#xFF0C;&#x6E05;&#x7406;&#x51FD;&#x6570;&#x4E0D;&#x6E05;&#x695A;&#x9700;&#x8981;&#x6267;&#x884C;&#x54EA;&#x4E9B;&#x6E05;&#x7406;&#x6B65;&#x9AA4;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x7EBF;&#x7A0B;&#x4E5F;&#x5F88;&#x53EF;&#x80FD;&#x5728;&#x5BF9;malloc()&#x7684;&#x8C03;&#x7528;&#x671F;&#x95F4;&#x88AB;&#x53D6;&#x6D88;&#xFF0C;&#x8FD9;&#x6781;&#x6709;&#x53EF;&#x80FD;&#x9020;&#x6210;&#x540E;&#x7EED;&#x7684;&#x6DF7;&#x4E71;&#xFF08;&#x89C1;7.1.3&#x8282;&#xFF09;&#x3002;</p>
<p>&#x4F5C;&#x4E3A;&#x4E00;&#x822C;&#x6027;&#x539F;&#x5219;&#xFF0C;&#x53EF;&#x5F02;&#x6B65;&#x53D6;&#x6D88;&#x7684;&#x7EBF;&#x7A0B;&#x4E0D;&#x5E94;&#x8BE5;&#x5206;&#x914D;&#x4EFB;&#x4F55;&#x8D44;&#x6E90;&#xFF0C;&#x4E5F;&#x4E0D;&#x80FD;&#x83B7;&#x53D6;&#x4E92;&#x65A5;&#x91CF;&#x6216;&#x9501;&#x3002;&#x8FD9;&#x5BFC;&#x81F4;&#x5927;&#x91CF;&#x5E93;&#x51FD;&#x6570;&#x65E0;&#x6CD5;&#x4F7F;&#x7528;&#xFF0C;&#x5176;&#x4E2D;&#x5C31;&#x5305;&#x62EC;Pthreads&#x51FD;&#x6570;&#x7684;&#x5927;&#x90E8;&#x5206;&#x3002;&#xFF08;SUSv3&#x4E2D;&#x6709;3&#x5904;&#x4F8B;&#x5916;pthread_cancel()&#x3001;pthread_setcancelstate()&#x4EE5;&#x53CA;pthread_setcanceltype()&#xFF0C;&#x89C4;&#x8303;&#x660E;&#x786E;&#x8981;&#x6C42;&#x5C06;&#x5B83;&#x4EEC;&#x5B9E;&#x73B0;&#x4E3A;&#x201C;&#x5F02;&#x6B65;&#x53D6;&#x6D88;&#x5B89;&#x5168;&#xFF08;async-cancel-safe&#xFF09;&#x201D;&#xFF0C;&#x4EA6;&#x5373;&#xFF0C;&#x5B9E;&#x73B0;&#x5FC5;&#x987B;&#x786E;&#x4FDD;&#x5728;&#x53EF;&#x5F02;&#x6B65;&#x53D6;&#x6D88;&#x7684;&#x7EBF;&#x7A0B;&#x4E2D;&#x53EF;&#x4EE5;&#x5B89;&#x5168;&#x8C03;&#x7528;&#x5B83;&#x4EEC;&#x3002;&#xFF09;&#x6362;&#x8A00;&#x4E4B;&#xFF0C;&#x5F02;&#x6B65;&#x53D6;&#x6D88;&#x529F;&#x80FD;&#x9C9C;&#x6709;&#x5E94;&#x7528;&#x573A;&#x666F;&#xFF0C;&#x5176;&#x4E2D;&#x4E4B;&#x4E00;&#x5C31;&#x662F;&#xFF1A;&#x53D6;&#x6D88;&#x5728;&#x6267;&#x884C;&#x8BA1;&#x7B97;&#x5BC6;&#x96C6;&#x578B;&#x5FAA;&#x73AF;&#x7684;&#x7EBF;&#x7A0B;&#x3002;</p>
<h1 id="&#x7EBF;&#x7A0B;&#xFF1A;&#x66F4;&#x591A;&#x7EC6;&#x8282;"><a href="#&#x7EBF;&#x7A0B;&#xFF1A;&#x66F4;&#x591A;&#x7EC6;&#x8282;" class="headerlink" title="&#x7EBF;&#x7A0B;&#xFF1A;&#x66F4;&#x591A;&#x7EC6;&#x8282;"></a>&#x7EBF;&#x7A0B;&#xFF1A;&#x66F4;&#x591A;&#x7EC6;&#x8282;</h1><h2 id="&#x7EBF;&#x7A0B;&#x6808;"><a href="#&#x7EBF;&#x7A0B;&#x6808;" class="headerlink" title="&#x7EBF;&#x7A0B;&#x6808;"></a>&#x7EBF;&#x7A0B;&#x6808;</h2><p>&#x521B;&#x5EFA;&#x7EBF;&#x7A0B;&#x65F6;&#xFF0C;&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x90FD;&#x6709;&#x4E00;&#x4E2A;&#x5C5E;&#x4E8E;&#x81EA;&#x5DF1;&#x7684;&#x7EBF;&#x7A0B;&#x6808;&#xFF0C;&#x4E14;&#x5927;&#x5C0F;&#x56FA;&#x5B9A;&#x3002;&#x5728;Linux/x86-32&#x67B6;&#x6784;&#x4E0A;&#xFF0C;&#x9664;&#x4E3B;&#x7EBF;&#x7A0B;&#x5916;&#x7684;&#x6240;&#x6709;&#x7EBF;&#x7A0B;&#xFF0C;&#x5176;&#x6808;&#x7684;&#x7F3A;&#x7701;&#x5927;&#x5C0F;&#x5747;&#x4E3A;2MB&#x3002;&#xFF08;&#x5728;&#x4E00;&#x4E9B;64&#x4F4D;&#x67B6;&#x6784;&#x4E0B;&#xFF0C;&#x9ED8;&#x8BA4;&#x5C3A;&#x5BF8;&#x8981;&#x5927;&#x4E00;&#x4E9B;&#xFF0C;&#x4F8B;&#x5982;&#xFF0C;IA-64&#x6709;32MB&#x3002;&#xFF09;&#x4E3A;&#x4E86;&#x5E94;&#x5BF9;&#x6808;&#x7684;&#x589E;&#x957F;&#xFF08;&#x53C2;&#x8003;&#x56FE;29-1&#xFF09;&#xFF0C;&#x4E3B;&#x7EBF;&#x7A0B;&#x6808;&#x7684;&#x7A7A;&#x95F4;&#x8981;&#x5927;&#x51FA;&#x8BB8;&#x591A;&#x3002;</p>
<p>&#x5076;&#x5C14;&#xFF0C;&#x4E5F;&#x9700;&#x8981;&#x6539;&#x53D8;&#x7EBF;&#x7A0B;&#x6808;&#x7684;&#x5927;&#x5C0F;&#x3002;&#x5728;&#x901A;&#x8FC7;&#x7EBF;&#x7A0B;&#x5C5E;&#x6027;&#x5BF9;&#x8C61;&#x521B;&#x5EFA;&#x7EBF;&#x7A0B;&#x65F6;&#xFF0C;&#x8C03;&#x7528;&#x51FD;&#x6570;pthread_attr_setstacksize()&#x6240;&#x8BBE;&#x7F6E;&#x7684;&#x7EBF;&#x7A0B;&#x5C5E;&#x6027;&#x51B3;&#x5B9A;&#x4E86;&#x7EBF;&#x7A0B;&#x6808;&#x7684;&#x5927;&#x5C0F;&#x3002;&#x800C;&#x4F7F;&#x7528;&#x4E0E;&#x4E4B;&#x76F8;&#x5173;&#x7684;&#x53E6;&#x4E00;&#x51FD;&#x6570;pthread_attr_setstack()&#xFF0C;&#x53EF;&#x4EE5;&#x540C;&#x65F6;&#x63A7;&#x5236;&#x7EBF;&#x7A0B;&#x6808;&#x7684;&#x5927;&#x5C0F;&#x548C;&#x4F4D;&#x7F6E;&#xFF0C;&#x4E0D;&#x8FC7;&#x8BBE;&#x7F6E;&#x6808;&#x7684;&#x5730;&#x5740;&#x5C06;&#x964D;&#x4F4E;&#x7A0B;&#x5E8F;&#x7684;&#x53EF;&#x79FB;&#x690D;&#x6027;&#x3002;&#x624B;&#x518C;&#x9875;&#xFF08;manual page&#xFF09;&#x63D0;&#x4F9B;&#x4E86;&#x5BF9;&#x8FD9;&#x4E9B;&#x51FD;&#x6570;&#x7684;&#x5177;&#x4F53;&#x8BF4;&#x660E;&#x3002;</p>
<p>&#x66F4;&#x5927;&#x7684;&#x7EBF;&#x7A0B;&#x6808;&#x53EF;&#x4EE5;&#x5BB9;&#x7EB3;&#x5927;&#x578B;&#x7684;&#x81EA;&#x52A8;&#x53D8;&#x91CF;&#x6216;&#x8005;&#x6DF1;&#x5EA6;&#x7684;&#x5D4C;&#x5957;&#x51FD;&#x6570;&#x8C03;&#x7528;&#xFF08;&#x4E5F;&#x8BB8;&#x662F;&#x9012;&#x5F52;&#x8C03;&#x7528;&#xFF09;&#xFF0C;&#x8FD9;&#x662F;&#x6539;&#x53D8;&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x6808;&#x5927;&#x5C0F;&#x7684;&#x539F;&#x56E0;&#x4E4B;&#x4E00;&#x3002;&#x800C;&#x53E6;&#x4E00;&#x65B9;&#x9762;&#xFF0C;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x53EF;&#x80FD;&#x5E0C;&#x671B;&#x51CF;&#x5C0F;&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x6808;&#xFF0C;&#x4EE5;&#x4FBF;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x521B;&#x5EFA;&#x66F4;&#x591A;&#x7684;&#x7EBF;&#x7A0B;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x5728; x86-32 &#x7CFB;&#x7EDF;&#x4E2D;&#xFF0C;&#x7528;&#x6237;&#xFF08;&#x6A21;&#x5F0F;&#xFF09;&#x53EF;&#x8BBF;&#x95EE;&#x7684;&#x865A;&#x62DF;&#x5730;&#x5740;&#x7A7A;&#x95F4;&#x662F;3GB&#xFF0C;&#x800C;2MB&#x7684;&#x7F3A;&#x7701;&#x6808;&#x5927;&#x5C0F;&#x5219;&#x610F;&#x5473;&#x7740;&#x6700;&#x591A;&#x53EA;&#x80FD;&#x521B;&#x5EFA; 1500 &#x4E2A;&#x7EBF;&#x7A0B;&#x3002;&#xFF08;&#x66F4;&#x4E3A;&#x51C6;&#x786E;&#x7684;&#x6700;&#x5927;&#x503C;&#x8FD8;&#x89C6;&#x4E4E;&#x6587;&#x672C;&#x6BB5;&#x3001;&#x6570;&#x636E;&#x6BB5;&#x3001;&#x5171;&#x4EAB;&#x51FD;&#x6570;&#x5E93;&#x7B49;&#x5BF9;&#x865A;&#x62DF;&#x5185;&#x5B58;&#x7684;&#x6D88;&#x8017;&#x91CF;&#x3002;&#xFF09;&#x7279;&#x5B9A;&#x67B6;&#x6784;&#x7684;&#x7CFB;&#x7EDF;&#x4E0A;&#xFF0C;&#x53EF;&#x91C7;&#x7528;&#x7684;&#x7EBF;&#x7A0B;&#x6808;&#x5927;&#x5C0F;&#x6700;&#x5C0F;&#x503C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8C03;&#x7528;sysconf(_SC_THREAD_STACK_MION)&#x6765;&#x786E;&#x5B9A;&#x3002;&#x5728;Linux/x86-32&#x4E0A;&#x7684;NPTL&#x5B9E;&#x73B0;&#x4E2D;&#xFF0C;&#x8BE5;&#x8C03;&#x7528;&#x8FD4;&#x56DE;16384&#x3002;</p>
<p>&#x5728;NPTL&#x7EBF;&#x7A0B;&#x5B9E;&#x73B0;&#x4E2D;&#xFF0C;&#x5982;&#x679C;&#x5BF9;&#x7EBF;&#x7A0B;&#x6808;&#x5C3A;&#x5BF8;&#x8D44;&#x6E90;&#x9650;&#x5236;&#xFF08;RLIMIT_STACK&#xFF09;&#x7684;&#x8BBE;&#x7F6E;&#x4E0D;&#x540C;&#x4E8E;unlimited&#xFF0C;&#x90A3;&#x4E48;&#x521B;&#x5EFA;&#x7EBF;&#x7A0B;&#x65F6;&#x4F1A;&#x4EE5;&#x5176;&#x4F5C;&#x4E3A;&#x9ED8;&#x8BA4;&#x503C;&#x3002;&#x5BF9;&#x8BE5;&#x9650;&#x5236;&#x7684;&#x8BBE;&#x7F6E;&#x5FC5;&#x987B;&#x5728;&#x8FD0;&#x884C;&#x7A0B;&#x5E8F;&#x4E4B;&#x524D;&#xFF0C;&#x901A;&#x5E38;&#x901A;&#x8FC7;&#x6267;&#x884C;shell&#x5185;&#x5EFA;&#x547D;&#x4EE4;ulimit&#x2013;s&#x5B8C;&#x6210;&#xFF08;&#x5728;C shell&#x4E0B;&#x547D;&#x4EE4;&#x4E3A;limit stacksize&#xFF09;&#x3002;&#x5728;&#x4E3B;&#x7A0B;&#x5E8F;&#x4E2D;&#x8C03;&#x7528;setrlimit()&#x6765;&#x8BBE;&#x7F6E;&#x9650;&#x5236;&#x7684;&#x529E;&#x6CD5;&#x53EF;&#x80FD;&#x884C;&#x4E0D;&#x901A;&#xFF0C;&#x56E0;&#x4E3A;NPTL&#x5728;&#x8C03;&#x7528;main()&#x4E4B;&#x524D;&#x7684;&#x8FD0;&#x884C;&#x65F6;&#x521D;&#x59CB;&#x5316;&#x671F;&#x95F4;&#x5C31;&#x5DF2;&#x7ECF;&#x786E;&#x5B9A;&#x4E86;&#x9ED8;&#x8BA4;&#x7684;&#x6808;&#x5927;&#x5C0F;&#x3002;</p>
<h2 id="&#x7EBF;&#x7A0B;&#x548C;&#x4FE1;&#x53F7;"><a href="#&#x7EBF;&#x7A0B;&#x548C;&#x4FE1;&#x53F7;" class="headerlink" title="&#x7EBF;&#x7A0B;&#x548C;&#x4FE1;&#x53F7;"></a>&#x7EBF;&#x7A0B;&#x548C;&#x4FE1;&#x53F7;</h2><p>UNIX&#x4FE1;&#x53F7;&#x6A21;&#x578B;&#x662F;&#x57FA;&#x4E8E;UNIX&#x8FDB;&#x7A0B;&#x6A21;&#x578B;&#x800C;&#x8BBE;&#x8BA1;&#x7684;&#xFF0C;&#x95EE;&#x4E16;&#x6BD4;Pthreads&#x8981;&#x65E9;&#x51E0;&#x5341;&#x5E74;&#x3002;&#x81EA;&#x7136;&#x800C;&#x7136;&#xFF0C;&#x4FE1;&#x53F7;&#x4E0E;&#x7EBF;&#x7A0B;&#x6A21;&#x578B;&#x4E4B;&#x95F4;&#x5B58;&#x5728;&#x4E00;&#x4E9B;&#x660E;&#x663E;&#x7684;&#x51B2;&#x7A81;&#x3002;&#x4E3B;&#x8981;&#x662F;&#x56E0;&#x4E3A;&#xFF0C;&#x4E00;&#x65B9;&#x9762;&#xFF0C;&#x9488;&#x5BF9;&#x5355;&#x7EBF;&#x7A0B;&#x8FDB;&#x7A0B;&#x8981;&#x4FDD;&#x6301;&#x4F20;&#x7EDF;&#x7684;&#x4FE1;&#x53F7;&#x8BED;&#x4E49;&#xFF08;Pthreads&#x4E0D;&#x5E94;&#x6539;&#x53D8;&#x4F20;&#x7EDF;&#x8FDB;&#x7A0B;&#x7684;&#x4FE1;&#x53F7;&#x8BED;&#x4E49;&#xFF09;&#xFF0C;&#x4E0E;&#x6B64;&#x540C;&#x65F6;&#xFF0C;&#x53C8;&#x9700;&#x8981;&#x5F00;&#x53D1;&#x51FA;&#x9002;&#x7528;&#x4E8E;&#x591A;&#x7EBF;&#x7A0B;&#x8FDB;&#x7A0B;&#x73AF;&#x5883;&#x7684;&#x65B0;&#x4FE1;&#x53F7;&#x6A21;&#x578B;&#x3002;</p>
<p>&#x4FE1;&#x53F7;&#x4E0E;&#x7EBF;&#x7A0B;&#x6A21;&#x578B;&#x4E4B;&#x95F4;&#x7684;&#x5DEE;&#x5F02;&#x610F;&#x5473;&#x7740;&#xFF0C;&#x5C06;&#x4E8C;&#x8005;&#x7ED3;&#x5408;&#x4F7F;&#x7528;&#xFF0C;&#x5C06;&#x4F1A;&#x975E;&#x5E38;&#x590D;&#x6742;&#xFF0C;&#x5E94;&#x5C3D;&#x53EF;&#x80FD;&#x52A0;&#x4EE5;&#x907F;&#x514D;&#x3002;&#x5C3D;&#x7BA1;&#x5982;&#x6B64;&#xFF0C;&#x6709;&#x7684;&#x65F6;&#x5019;&#x8FD8;&#x662F;&#x5FC5;&#x987B;&#x5728;&#x591A;&#x7EBF;&#x7A0B;&#x7A0B;&#x5E8F;&#x4E2D;&#x5904;&#x7406;&#x4FE1;&#x53F7;&#x95EE;&#x9898;&#x3002;&#x672C;&#x8282;&#x5C06;&#x8BA8;&#x8BBA;&#x4FE1;&#x53F7;&#x4E0E;&#x7EBF;&#x7A0B;&#x95F4;&#x7684;&#x4EA4;&#x4E92;&#xFF0C;&#x5E76;&#x63CF;&#x8FF0;&#x5728;&#x591A;&#x7EBF;&#x7A0B;&#x7A0B;&#x5E8F;&#x4E2D;&#x5904;&#x7406;&#x4FE1;&#x53F7;&#x7684;&#x5404;&#x79CD;&#x6709;&#x6548;&#x51FD;&#x6570;&#x3002;</p>
<h2 id="UNIX&#x4FE1;&#x53F7;&#x6A21;&#x578B;&#x5982;&#x4F55;&#x6620;&#x5C04;&#x5230;&#x7EBF;&#x7A0B;&#x4E2D;"><a href="#UNIX&#x4FE1;&#x53F7;&#x6A21;&#x578B;&#x5982;&#x4F55;&#x6620;&#x5C04;&#x5230;&#x7EBF;&#x7A0B;&#x4E2D;" class="headerlink" title="UNIX&#x4FE1;&#x53F7;&#x6A21;&#x578B;&#x5982;&#x4F55;&#x6620;&#x5C04;&#x5230;&#x7EBF;&#x7A0B;&#x4E2D;"></a>UNIX&#x4FE1;&#x53F7;&#x6A21;&#x578B;&#x5982;&#x4F55;&#x6620;&#x5C04;&#x5230;&#x7EBF;&#x7A0B;&#x4E2D;</h2><p>&#x8981;&#x4E86;&#x89E3;UNIX&#x4FE1;&#x53F7;&#x5982;&#x4F55;&#x6620;&#x5C04;&#x5230;Pthreads&#x6A21;&#x578B;&#xFF0C;&#x5C31;&#x9700;&#x8981;&#x4E86;&#x89E3;&#xFF0C;&#x4FE1;&#x53F7;&#x6A21;&#x578B;&#x7684;&#x54EA;&#x4E9B;&#x65B9;&#x9762;&#x5C5E;&#x4E8E;&#x8FDB;&#x7A0B;&#x5C42;&#x9762;&#xFF08;&#x7531;&#x8FDB;&#x7A0B;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x7EBF;&#x7A0B;&#x6240;&#x5171;&#x4EAB;&#xFF09;&#xFF0C;&#x54EA;&#x4E9B;&#x65B9;&#x9762;&#x662F;&#x5C5E;&#x4E8E;&#x8FDB;&#x7A0B;&#x4E2D;&#x7684;&#x5355;&#x4E2A;&#x7EBF;&#x7A0B;&#x5C42;&#x9762;&#x3002;&#x5982;&#x4E0B;&#x662F;&#x5BF9;&#x5176;&#x5173;&#x952E;&#x70B9;&#x7684;&#x6C47;&#x603B;&#x3002;</p>
<p>TODO.</p>
<h1 id="&#x8FDB;&#x7A0B;&#x7EC4;&#x3001;&#x4F1A;&#x8BDD;&#x548C;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;"><a href="#&#x8FDB;&#x7A0B;&#x7EC4;&#x3001;&#x4F1A;&#x8BDD;&#x548C;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;" class="headerlink" title="&#x8FDB;&#x7A0B;&#x7EC4;&#x3001;&#x4F1A;&#x8BDD;&#x548C;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;"></a>&#x8FDB;&#x7A0B;&#x7EC4;&#x3001;&#x4F1A;&#x8BDD;&#x548C;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;</h1><p>&#x8FDB;&#x7A0B;&#x7EC4;&#x548C;&#x4F1A;&#x8BDD;&#x5728;&#x8FDB;&#x7A0B;&#x4E4B;&#x95F4;&#x5F62;&#x6210;&#x4E86;&#x4E00;&#x79CD;&#x4E24;&#x7EA7;&#x5C42;&#x6B21;&#x5173;&#x7CFB;&#xFF1A;&#x8FDB;&#x7A0B;&#x7EC4;&#x662F;&#x4E00;&#x7EC4;&#x76F8;&#x5173;&#x8FDB;&#x7A0B;&#x7684;&#x96C6;&#x5408;&#xFF0C;&#x4F1A;&#x8BDD;&#x662F;&#x4E00;&#x7EC4;&#x76F8;&#x5173;&#x8FDB;&#x7A0B;&#x7EC4;&#x7684;&#x96C6;&#x5408;&#x3002;<br>&#x8FDB;&#x7A0B;&#x7EC4;&#x548C;&#x4F1A;&#x8BDD;&#x662F;&#x4E3A;&#x652F;&#x6301;shell&#x4F5C;&#x4E1A;&#x63A7;&#x5236;&#x800C;&#x5B9A;&#x4E49;&#x7684;&#x62BD;&#x8C61;&#x6982;&#x5FF5;&#xFF0C;&#x7528;&#x6237;&#x901A;&#x8FC7;shell&#x80FD;&#x591F;&#x4EA4;&#x4E92;&#x5F0F;&#x5730;&#x5728;&#x524D;&#x53F0;&#x6216;&#x540E;&#x53F0;&#x8FD0;&#x884C;&#x547D;&#x4EE4;&#x3002;&#x672F;&#x8BED;&#x201C;&#x4F5C;&#x4E1A;&#x201D;&#x901A;&#x5E38;&#x4E0E;&#x672F;&#x8BED;&#x201C;&#x8FDB;&#x7A0B;&#x7EC4;&#x201D;&#x4F5C;&#x4E3A;&#x540C;&#x4E49;&#x8BCD;&#x6765;&#x770B;&#x5F85;&#x3002;</p>
<h2 id="&#x6982;&#x8FF0;-1"><a href="#&#x6982;&#x8FF0;-1" class="headerlink" title="&#x6982;&#x8FF0;"></a>&#x6982;&#x8FF0;</h2><p>&#x8FDB;&#x7A0B;&#x7EC4;&#x7531;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x5171;&#x4EAB;&#x540C;&#x4E00;&#x8FDB;&#x7A0B;&#x7EC4;&#x6807;&#x8BC6;&#x7B26;&#xFF08;PGID&#xFF09;&#x7684;&#x8FDB;&#x7A0B;&#x7EC4;&#x6210;&#x3002;&#x8FDB;&#x7A0B;&#x7EC4;ID&#x662F;&#x4E00;&#x4E2A;&#x6570;&#x5B57;&#xFF0C;&#x5176;&#x7C7B;&#x578B;&#x4E0E;&#x8FDB;&#x7A0B;ID&#x4E00;&#x6837;&#xFF08;pid_t&#xFF09;&#x3002;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7EC4;&#x62E5;&#x6709;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7EC4;&#x9996;&#x8FDB;&#x7A0B;&#xFF0C;&#x8BE5;&#x8FDB;&#x7A0B;&#x662F;&#x521B;&#x5EFA;&#x8BE5;&#x7EC4;&#x7684;&#x8FDB;&#x7A0B;&#xFF0C;&#x5176;&#x8FDB;&#x7A0B;ID&#x4E3A;&#x8BE5;&#x8FDB;&#x7A0B;&#x7EC4;&#x7684;ID&#xFF0C;&#x65B0;&#x8FDB;&#x7A0B;&#x4F1A;&#x7EE7;&#x627F;&#x5176;&#x7236;&#x8FDB;&#x7A0B;&#x6240;&#x5C5E;&#x7684;&#x8FDB;&#x7A0B;&#x7EC4;ID&#x3002;</p>
<p>&#x8FDB;&#x7A0B;&#x7EC4;&#x62E5;&#x6709;&#x4E00;&#x4E2A;&#x751F;&#x547D;&#x5468;&#x671F;&#xFF0C;&#x5176;&#x5F00;&#x59CB;&#x65F6;&#x95F4;&#x4E3A;&#x9996;&#x8FDB;&#x7A0B;&#x521B;&#x5EFA;&#x7EC4;&#x7684;&#x65F6;&#x523B;&#xFF0C;&#x7ED3;&#x675F;&#x65F6;&#x95F4;&#x4E3A;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x6210;&#x5458;&#x8FDB;&#x7A0B;&#x9000;&#x51FA;&#x7EC4;&#x7684;&#x65F6;&#x523B;&#x3002;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x53EF;&#x80FD;&#x4F1A;&#x56E0;&#x4E3A;&#x7EC8;&#x6B62;&#x800C;&#x9000;&#x51FA;&#x8FDB;&#x7A0B;&#x7EC4;&#xFF0C;&#x4E5F;&#x53EF;&#x80FD;&#x4F1A;&#x56E0;&#x4E3A;&#x52A0;&#x5165;&#x4E86;&#x53E6;&#x5916;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7EC4;&#x800C;&#x9000;&#x51FA;&#x8FDB;&#x7A0B;&#x7EC4;&#x3002;&#x8FDB;&#x7A0B;&#x7EC4;&#x9996;&#x8FDB;&#x7A0B;&#x65E0;&#x9700;&#x662F;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x79BB;&#x5F00;&#x8FDB;&#x7A0B;&#x7EC4;&#x7684;&#x6210;&#x5458;&#x3002;</p>
<p>&#x4F1A;&#x8BDD;&#x662F;&#x4E00;&#x7EC4;&#x8FDB;&#x7A0B;&#x7EC4;&#x7684;&#x96C6;&#x5408;&#x3002;&#x8FDB;&#x7A0B;&#x7684;&#x4F1A;&#x8BDD;&#x6210;&#x5458;&#x5173;&#x7CFB;&#x662F;&#x7531;&#x5176;&#x4F1A;&#x8BDD;&#x6807;&#x8BC6;&#x7B26;&#xFF08;SID&#xFF09;&#x786E;&#x5B9A;&#x7684;&#xFF0C;&#x4F1A;&#x8BDD;&#x6807;&#x8BC6;&#x7B26;&#x4E0E;&#x8FDB;&#x7A0B;&#x7EC4;ID&#x4E00;&#x6837;&#xFF0C;&#x662F;&#x4E00;&#x4E2A;&#x7C7B;&#x578B;&#x4E3A;pid_t&#x7684;&#x6570;&#x5B57;&#x3002;&#x4F1A;&#x8BDD;&#x9996;&#x8FDB;&#x7A0B;&#x662F;&#x521B;&#x5EFA;&#x8BE5;&#x65B0;&#x4F1A;&#x8BDD;&#x7684;&#x8FDB;&#x7A0B;&#xFF0C;&#x5176;&#x8FDB;&#x7A0B;ID&#x4F1A;&#x6210;&#x4E3A;&#x4F1A;&#x8BDD; ID&#x3002;&#x65B0;&#x8FDB;&#x7A0B;&#x4F1A;&#x7EE7;&#x627F;&#x5176;&#x7236;&#x8FDB;&#x7A0B;&#x7684;&#x4F1A;&#x8BDD;ID&#x3002;</p>
<p>&#x4E00;&#x4E2A;&#x4F1A;&#x8BDD;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x8FDB;&#x7A0B;&#x5171;&#x4EAB;&#x5355;&#x4E2A;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x3002;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x4F1A;&#x5728;&#x4F1A;&#x8BDD;&#x9996;&#x8FDB;&#x7A0B;&#x9996;&#x6B21;&#x6253;&#x5F00;&#x4E00;&#x4E2A;&#x7EC8;&#x7AEF;&#x8BBE;&#x5907;&#x65F6;&#x88AB;&#x5EFA;&#x7ACB;&#x3002;&#x4E00;&#x4E2A;&#x7EC8;&#x7AEF;&#x6700;&#x591A;&#x53EF;&#x80FD;&#x4F1A;&#x6210;&#x4E3A;&#x4E00;&#x4E2A;&#x4F1A;&#x8BDD;&#x7684;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x3002;</p>
<p>&#x5728;&#x4EFB;&#x4E00;&#x65F6;&#x523B;&#xFF0C;&#x4F1A;&#x8BDD;&#x4E2D;&#x7684;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7EC4;&#x4F1A;&#x6210;&#x4E3A;&#x7EC8;&#x7AEF;&#x7684;&#x524D;&#x53F0;&#x8FDB;&#x7A0B;&#x7EC4;&#xFF0C;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x7EC4;&#x4F1A;&#x6210;&#x4E3A;&#x540E;&#x53F0;&#x8FDB;&#x7A0B;&#x7EC4;&#x3002;&#x53EA;&#x6709;&#x524D;&#x53F0;&#x8FDB;&#x7A0B;&#x7EC4;&#x4E2D;&#x7684;&#x8FDB;&#x7A0B;&#x624D;&#x80FD;&#x4ECE;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x4E2D;&#x8BFB;&#x53D6;&#x8F93;&#x5165;&#x3002;&#x5F53;&#x7528;&#x6237;&#x5728;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x4E2D;&#x8F93;&#x5165;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x4FE1;&#x53F7;&#x751F;&#x6210;&#x7EC8;&#x7AEF;&#x5B57;&#x7B26;&#x4E4B;&#x540E;&#xFF0C;&#x8BE5;&#x4FE1;&#x53F7;&#x4F1A;&#x88AB;&#x53D1;&#x9001;&#x5230;&#x524D;&#x53F0;&#x8FDB;&#x7A0B;&#x7EC4;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x6210;&#x5458;&#x3002;&#x8FD9;&#x4E9B;&#x5B57;&#x7B26;&#x5305;&#x62EC;&#x751F;&#x6210;SIGINT&#x7684;&#x4E2D;&#x65AD;&#x5B57;&#x7B26;&#xFF08;&#x901A;&#x5E38;&#x662F;Control-C&#xFF09;&#x3001;&#x751F;&#x6210;SIGQUIT&#x7684;&#x9000;&#x51FA;&#x5B57;&#x7B26;&#xFF08;&#x901A;&#x5E38;&#x662F;Control-\&#xFF09;&#x3001;&#x751F;&#x6210;SIGSTP&#x7684;&#x6302;&#x8D77;&#x5B57;&#x7B26;&#xFF08;&#x901A;&#x5E38;&#x662F;Control-Z&#xFF09;&#x3002;</p>
<p>&#x5F53;&#x5230;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x7684;&#x8FDE;&#x63A5;&#x5EFA;&#x7ACB;&#x8D77;&#x6765;&#xFF08;&#x5373;&#x6253;&#x5F00;&#xFF09;&#x4E4B;&#x540E;&#xFF0C;&#x4F1A;&#x8BDD;&#x9996;&#x8FDB;&#x7A0B;&#x4F1A;&#x6210;&#x4E3A;&#x8BE5;&#x7EC8;&#x7AEF;&#x7684;&#x63A7;&#x5236;&#x8FDB;&#x7A0B;&#x3002;&#x6210;&#x4E3A;&#x63A7;&#x5236;&#x8FDB;&#x7A0B;&#x7684;&#x4E3B;&#x8981;&#x6807;&#x5FD7;&#x662F;&#x5F53;&#x65AD;&#x5F00;&#x4E0E;&#x7EC8;&#x7AEF;&#x4E4B;&#x95F4;&#x7684;&#x8FDE;&#x63A5;&#x65F6;&#x5185;&#x6838;&#x4F1A;&#x5411;&#x8BE5;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;&#x4E00;&#x4E2A;SIGHUP&#x4FE1;&#x53F7;&#x3002;</p>
<p>&#x901A;&#x8FC7;&#x68C0;&#x67E5;Linux&#x7279;&#x6709;&#x7684;/proc/PID/stat&#x6587;&#x4EF6;&#xFF0C;&#x5C31;&#x80FD;&#x786E;&#x5B9A;&#x4EFB;&#x610F;&#x8FDB;&#x7A0B;&#x7684;&#x8FDB;&#x7A0B;&#x7EC4;ID&#x548C;&#x4F1A;&#x8BDD;ID&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x8FD8;&#x80FD;&#x786E;&#x5B9A;&#x8FDB;&#x7A0B;&#x7684;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x7684;&#x8BBE;&#x5907;ID&#xFF08;&#x4E00;&#x4E2A;&#x5341;&#x8FDB;&#x5236;&#x6570;&#x5B57;&#xFF0C;&#x5305;&#x542B;&#x4E3B;ID&#x548C;&#x8F85;ID&#xFF09;&#x548C;&#x63A7;&#x5236;&#x8BE5;&#x7EC8;&#x7AEF;&#x7684;&#x63A7;&#x5236;&#x8FDB;&#x7A0B;&#x7684;&#x8FDB;&#x7A0B;ID&#x3002;&#x66F4;&#x591A;&#x7EC6;&#x8282;&#x4FE1;&#x606F;&#x8BF7;&#x53C2;&#x8003;proc(5)&#x624B;&#x518C;&#x3002;</p>
<p>&#x4F1A;&#x8BDD;&#x548C;&#x8FDB;&#x7A0B;&#x7EC4;&#x7684;&#x4E3B;&#x8981;&#x7528;&#x9014;&#x662F;&#x7528;&#x4E8E;shell&#x4F5C;&#x4E1A;&#x63A7;&#x5236;&#x3002;&#x8BFB;&#x8005;&#x901A;&#x8FC7;&#x4E00;&#x4E2A;&#x5177;&#x4F53;&#x7684;&#x4F8B;&#x5B50;&#x5C31;&#x80FD;&#x591F;&#x5F04;&#x6E05;&#x695A;&#x8FD9;&#x4E9B;&#x6982;&#x5FF5;&#x4E86;&#x3002;&#x5982;&#x5BF9;&#x4E8E;&#x4EA4;&#x4E92;&#x5F0F;&#x767B;&#x5F55;&#x6765;&#x8BB2;&#xFF0C;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x662F;&#x7528;&#x6237;&#x767B;&#x5F55;&#x7684;&#x9014;&#x5F84;&#x3002;&#x767B;&#x5F55;shell&#x662F;&#x4F1A;&#x8BDD;&#x9996;&#x8FDB;&#x7A0B;&#x548C;&#x7EC8;&#x7AEF;&#x7684;&#x63A7;&#x5236;&#x8FDB;&#x7A0B;&#xFF0C;&#x4E5F;&#x662F;&#x5176;&#x81EA;&#x8EAB;&#x8FDB;&#x7A0B;&#x7EC4;&#x7684;&#x552F;&#x4E00;&#x6210;&#x5458;&#x3002;&#x4ECE;shell&#x4E2D;&#x53D1;&#x51FA;&#x7684;&#x6BCF;&#x4E2A;&#x547D;&#x4EE4;&#x6216;&#x901A;&#x8FC7;&#x7BA1;&#x9053;&#x8FDE;&#x63A5;&#x7684;&#x4E00;&#x7EC4;&#x547D;&#x4EE4;&#x90FD;&#x4F1A;&#x5BFC;&#x81F4;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x8FDB;&#x7A0B;&#x7684;&#x521B;&#x5EFA;&#xFF0C;&#x5E76;&#x4E14;shell&#x4F1A;&#x628A;&#x6240;&#x6709;&#x8FD9;&#x4E9B;&#x8FDB;&#x7A0B;&#x90FD;&#x653E;&#x5728;&#x4E00;&#x4E2A;&#x65B0;&#x8FDB;&#x7A0B;&#x7EC4;&#x4E2D;&#x3002;&#xFF08;&#x8FD9;&#x4E9B;&#x8FDB;&#x7A0B;&#x5728;&#x4E00;&#x5F00;&#x59CB;&#x662F;&#x5176;&#x8FDB;&#x7A0B;&#x7EC4;&#x4E2D;&#x7684;&#x552F;&#x4E00;&#x6210;&#x5458;&#xFF0C;&#x5B83;&#x4EEC;&#x521B;&#x5EFA;&#x7684;&#x6240;&#x6709;&#x5B50;&#x8FDB;&#x7A0B;&#x4F1A;&#x6210;&#x4E3A;&#x8BE5;&#x7EC4;&#x4E2D;&#x7684;&#x6210;&#x5458;&#x3002;&#xFF09;&#x5F53;&#x547D;&#x4EE4;&#x6216;&#x4EE5;&#x7BA1;&#x9053;&#x8FDE;&#x63A5;&#x7684;&#x4E00;&#x7EC4;&#x547D;&#x4EE4;&#x4EE5;&amp;&#x7B26;&#x53F7;&#x7ED3;&#x675F;&#x65F6;&#x4F1A;&#x5728;&#x540E;&#x53F0;&#x8FDB;&#x7A0B;&#x7EC4;&#x4E2D;&#x8FD0;&#x884C;&#x8FD9;&#x4E9B;&#x547D;&#x4EE4;&#xFF0C;&#x5426;&#x5219;&#x5C31;&#x4F1A;&#x5728;&#x524D;&#x53F0;&#x8FDB;&#x7A0B;&#x7EC4;&#x4E2D;&#x8FD0;&#x884C;&#x8FD9;&#x4E9B;&#x547D;&#x4EE4;&#x3002;&#x5728;&#x767B;&#x5F55;&#x4F1A;&#x8BDD;&#x4E2D;&#x521B;&#x5EFA;&#x7684;&#x6240;&#x6709;&#x8FDB;&#x7A0B;&#x90FD;&#x4F1A;&#x6210;&#x4E3A;&#x8BE5;&#x4F1A;&#x8BDD;&#x7684;&#x4E00;&#x90E8;&#x5206;&#x3002;</p>
<p>&#x5728;&#x7A97;&#x53E3;&#x73AF;&#x5883;&#x4E2D;&#xFF0C;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x662F;&#x4E00;&#x4E2A;&#x4F2A;&#x7EC8;&#x7AEF;&#x3002;&#x6BCF;&#x4E2A;&#x7EC8;&#x7AEF;&#x7A97;&#x53E3;&#x90FD;&#x6709;&#x4E00;&#x4E2A;&#x72EC;&#x7ACB;&#x7684;&#x4F1A;&#x8BDD;&#xFF0C;&#x7A97;&#x53E3;&#x7684;&#x542F;&#x52A8;shell&#x662F;&#x4F1A;&#x8BDD;&#x9996;&#x8FDB;&#x7A0B;&#x548C;&#x7EC8;&#x7AEF;&#x7684;&#x63A7;&#x5236;&#x8FDB;&#x7A0B;&#x3002;<br></p><div class="amp-img-wrapper"><amp-img src="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1581580294839.png?x-oss-process=image/resize,m_lfit,h_450" width="552" height="450" layout="responsive"></amp-img></div>
<h2 id="&#x7EC8;&#x7AEF;-terminal-&#x3001;tty&#x3001;shell&#x3001;&#x63A7;&#x5236;&#x53F0;&#xFF08;console&#xFF09;&#x3001;bash&#x4E4B;&#x95F4;&#x7684;&#x533A;&#x522B;&#x4E0E;&#x8054;&#x7CFB;"><a href="#&#x7EC8;&#x7AEF;-terminal-&#x3001;tty&#x3001;shell&#x3001;&#x63A7;&#x5236;&#x53F0;&#xFF08;console&#xFF09;&#x3001;bash&#x4E4B;&#x95F4;&#x7684;&#x533A;&#x522B;&#x4E0E;&#x8054;&#x7CFB;" class="headerlink" title="&#x7EC8;&#x7AEF;(terminal)&#x3001;tty&#x3001;shell&#x3001;&#x63A7;&#x5236;&#x53F0;&#xFF08;console&#xFF09;&#x3001;bash&#x4E4B;&#x95F4;&#x7684;&#x533A;&#x522B;&#x4E0E;&#x8054;&#x7CFB;"></a>&#x7EC8;&#x7AEF;(terminal)&#x3001;tty&#x3001;shell&#x3001;&#x63A7;&#x5236;&#x53F0;&#xFF08;console&#xFF09;&#x3001;bash&#x4E4B;&#x95F4;&#x7684;&#x533A;&#x522B;&#x4E0E;&#x8054;&#x7CFB;</h2><p><code>1&#x3001;&#x7EC8;&#x7AEF;&#xFF08;terminal&#xFF09;</code><br>&#x7EC8;&#x7AEF;&#xFF08;termimal&#xFF09;= tty&#xFF08;Teletypewriter&#xFF0C; &#x7535;&#x4F20;&#x6253;&#x5370;&#x673A;&#xFF09;&#xFF0C;&#x4F5C;&#x7528;&#x662F;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;&#x547D;&#x4EE4;&#x7684;&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x73AF;&#x5883;&#xFF0C;&#x5728;linux&#x4E0B;&#x4F7F;&#x7528;&#x7EC4;&#x5408;&#x952E;ctrl+alt+T&#x6253;&#x5F00;&#x7684;&#x5C31;&#x662F;&#x7EC8;&#x7AEF;&#xFF0C;&#x53EF;&#x4EE5;&#x8BA4;&#x4E3A;terminal&#x548C;tty&#x662F;&#x540C;&#x4E49;&#x8BCD;&#x3002;</p>
<p><code>2&#x3001;shell</code><br>shell&#x662F;&#x4E00;&#x4E2A;&#x547D;&#x4EE4;&#x884C;&#x89E3;&#x91CA;&#x5668;&#xFF0C;&#x662F;linux&#x5185;&#x6838;&#x7684;&#x4E00;&#x4E2A;&#x5916;&#x58F3;,&#x8D1F;&#x8D23;&#x5916;&#x754C;&#x4E0E;linux&#x5185;&#x6838;&#x7684;&#x4EA4;&#x4E92;&#x3002;shell&#x63A5;&#x6536;&#x7528;&#x6237;&#x6216;&#x8005;&#x5176;&#x4ED6;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x547D;&#x4EE4;, &#x7136;&#x540E;&#x5C06;&#x8FD9;&#x4E9B;&#x547D;&#x4EE4;&#x8F6C;&#x5316;&#x6210;&#x5185;&#x6838;&#x80FD;&#x7406;&#x89E3;&#x7684;&#x8BED;&#x8A00;&#x5E76;&#x4F20;&#x7ED9;&#x5185;&#x6838;, &#x5185;&#x6838;&#x6267;&#x884C;&#x547D;&#x4EE4;&#x5B8C;&#x6210;&#x540E;&#x5C06;&#x7ED3;&#x679C;&#x8FD4;&#x56DE;&#x7ED9;&#x7528;&#x6237;&#x6216;&#x8005;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x3002;&#x5F53;&#x4F60;&#x6253;&#x5F00;&#x4E00;&#x4E2A;terminal&#x65F6;&#xFF0C;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x4F1A;&#x5C06;terminal&#x548C;shell&#x5173;&#x8054;&#x8D77;&#x6765;&#xFF0C;&#x5F53;&#x6211;&#x4EEC;&#x5728;terminal&#x4E2D;&#x8F93;&#x5165;&#x547D;&#x4EE4;&#x540E;&#xFF0C;shell&#x5C31;&#x8D1F;&#x8D23;&#x89E3;&#x91CA;&#x547D;&#x4EE4;&#x3002;</p>
<p><code>3&#x3001;console</code><br>&#x5728;&#x8BA1;&#x7B97;&#x673A;&#x53D1;&#x5C55;&#x7684;&#x65E9;&#x671F;&#xFF0C;&#x8BA1;&#x7B97;&#x673A;&#x7684;&#x5916;&#x8868;&#x4E0A;&#x901A;&#x5E38;&#x4F1A;&#x5B58;&#x5728;&#x4E00;&#x4E2A;&#x9762;&#x677F;&#xFF0C;&#x9762;&#x677F;&#x5305;&#x542B;&#x5F88;&#x591A;&#x6309;&#x94AE;&#x548C;&#x6307;&#x793A;&#x706F;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x9762;&#x677F;&#x6765;&#x5BF9;&#x8BA1;&#x7B97;&#x673A;&#x8FDB;&#x884C;&#x5E95;&#x5C42;&#x7684;&#x7BA1;&#x7406;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x6307;&#x793A;&#x706F;&#x6765;&#x5F97;&#x77E5;&#x8BA1;&#x7B97;&#x673A;&#x7684;&#x8FD0;&#x884C;&#x72B6;&#x6001;&#xFF0C;&#x8FD9;&#x4E2A;&#x9762;&#x677F;&#x5C31;&#x53EB;console&#x3002;&#x5728;&#x73B0;&#x4EE3;&#x8BA1;&#x7B97;&#x673A;&#x4E0A;&#xFF0C;&#x5728;&#x7535;&#x8111;&#x5F00;&#x673A;&#x65F6;&#xFF08;&#x6BD4;&#x5982;ubuntu&#xFF09;&#x5C4F;&#x5E55;&#x4E0A;&#x4F1A;&#x6253;&#x5370;&#x51FA;&#x4E00;&#x4E9B;&#x65E5;&#x5FD7;&#x4FE1;&#x606F;&#xFF0C;&#x4F46;&#x5728;&#x7CFB;&#x7EDF;&#x542F;&#x52A8;&#x5B8C;&#x6210;&#x4E4B;&#x524D;&#xFF0C;terminal&#x4E0D;&#x80FD;&#x8FDE;&#x63A5;&#x5230;&#x4E3B;&#x673A;&#x4E0A;&#xFF0C;&#x6240;&#x4EE5;&#x4E3A;&#x4E86;&#x8BB0;&#x5F55;&#x4E3B;&#x673A;&#x7684;&#x91CD;&#x8981;&#x65E5;&#x5FD7;&#xFF08;&#x6BD4;&#x5982;&#x5F00;&#x5173;&#x673A;&#x65E5;&#x5FD7;&#xFF0C;&#x91CD;&#x8981;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x65E5;&#x5FD7;&#xFF09;&#xFF0C;&#x7CFB;&#x7EDF;&#x4E2D;&#x5C31;&#x591A;&#x4E86;&#x4E00;&#x4E2A;&#x540D;&#x4E3A;console&#x7684;&#x8BBE;&#x5907;&#xFF0C;&#x8FD9;&#x4E9B;&#x65E5;&#x5FD7;&#x4FE1;&#x606F;&#x5C31;&#x662F;&#x663E;&#x793A;&#x5728;console&#x4E0A;&#x3002;&#x4E00;&#x53F0;&#x7535;&#x8111;&#x6709;&#x4E14;&#x53EA;&#x6709;&#x4E00;&#x4E2A;console&#xFF0C;&#x4F46;&#x53EF;&#x4EE5;&#x6709;&#x591A;&#x4E2A;terminal&#x3002;&#x4E3E;&#x4E2A;&#x4F8B;&#x5B50;&#xFF0C;&#x7535;&#x89C6;&#x673A;&#x4E0A;&#x7684;&#x67D0;&#x4E2A;&#x533A;&#x57DF;&#x4E00;&#x822C;&#x90FD;&#x4F1A;&#x6709;&#x4E00;&#x4E9B;&#x6309;&#x94AE;&#xFF0C;&#x6BD4;&#x5982;&#x5F00;&#x673A;&#xFF0C;&#x8C03;&#x97F3;&#x91CF;&#x7B49;&#xFF0C;&#x8FD9;&#x4E2A;&#x533A;&#x57DF;&#x5C31;&#x53EF;&#x4EE5;&#x5F53;&#x505A;console&#xFF0C;&#x4E14;&#x8FD9;&#x4E2A;&#x533A;&#x57DF;&#x5728;&#x7535;&#x89C6;&#x4E0A;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#xFF0C;&#x9065;&#x63A7;&#x5668;&#x5C31;&#x53EF;&#x4EE5;&#x7C7B;&#x6BD4;&#x6210;terminal&#xFF0C;terminal&#x53EF;&#x4EE5;&#x6709;&#x591A;&#x4E2A;&#x3002;</p>
<p><code>4&#x3001;bash</code><br>linux&#x7CFB;&#x7EDF;&#x4E0A;&#x53EF;&#x4EE5;&#x5305;&#x542B;&#x591A;&#x79CD;&#x4E0D;&#x540C;&#x7684;shell(&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x547D;&#x4EE4; cat /etc/shells &#x67E5;&#x770B;)&#xFF0C;&#x6BD4;&#x8F83;&#x5E38;&#x89C1;&#x7684;&#x6709;Bourne shell (sh)&#x3001;C shell (csh) &#x548C; Korn shell (ksh)&#xFF0C;&#x4E09;&#x79CD;shell &#x90FD;&#x6709;&#x5B83;&#x4EEC;&#x7684;&#x4F18;&#x70B9;&#x548C;&#x7F3A;&#x70B9;&#x3002;Bourne shell &#x7684;&#x4F5C;&#x8005;&#x662F; Steven Bourne&#xFF0C;&#x5B83;&#x662F; UNIX &#x6700;&#x521D;&#x4F7F;&#x7528;&#x7684;shell &#x5E76;&#x4E14;&#x5728;&#x6BCF;&#x79CD; UNIX &#x4E0A;&#x90FD;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x3002;bash&#x7684;&#x5168;&#x79F0;&#x53EB;&#x505A;Bourne Again shell&#xFF0C;&#x4ECE;&#x540D;&#x5B57;&#x4E0A;&#x53EF;&#x4EE5;&#x770B;&#x51FA;bash&#x662F;Bourne shell&#x7684;&#x6269;&#x5C55;&#xFF0C;bash &#x4E0E; Bourne shell &#x5B8C;&#x5168;&#x5411;&#x540E;&#x517C;&#x5BB9;&#xFF0C;&#x5E76;&#x4E14;&#x5728; Bourne shell &#x7684;&#x57FA;&#x7840;&#x4E0A;&#x589E;&#x52A0;&#x548C;&#x589E;&#x5F3A;&#x4E86;&#x5F88;&#x591A;&#x7279;&#x6027;&#xFF0C;&#x5982;&#x547D;&#x4EE4;&#x8865;&#x5168;&#x3001;&#x547D;&#x4EE4;&#x7F16;&#x8F91;&#x548C;&#x547D;&#x4EE4;&#x5386;&#x53F2;&#x8868;&#x7B49;&#x529F;&#x80FD;&#xFF0C;&#x5B83;&#x8FD8;&#x5305;&#x542B;&#x4E86;&#x5F88;&#x591A; C shell &#x548C; Korn shell &#x4E2D;&#x7684;&#x4F18;&#x70B9;&#xFF0C;&#x6709;&#x7075;&#x6D3B;&#x548C;&#x5F3A;&#x5927;&#x7684;&#x7F16;&#x7A0B;&#x63A5;&#x53E3;&#xFF0C;&#x540C;&#x65F6;&#x53C8;&#x6709;&#x5F88;&#x53CB;&#x597D;&#x7684;&#x7528;&#x6237;&#x754C;&#x9762;&#x3002;&#x603B;&#x800C;&#x8A00;&#x4E4B;&#xFF0C;bash&#x662F;shell&#x7684;&#x4E00;&#x79CD;&#xFF0C;&#x662F;&#x589E;&#x5F3A;&#x7684;shell&#x3002;</p>
<h2 id="&#x8FDB;&#x7A0B;&#x7EC4;"><a href="#&#x8FDB;&#x7A0B;&#x7EC4;" class="headerlink" title="&#x8FDB;&#x7A0B;&#x7EC4;"></a>&#x8FDB;&#x7A0B;&#x7EC4;</h2><p>&#x6BCF;&#x4E2A;&#x8FDB;&#x7A0B;&#x90FD;&#x62E5;&#x6709;&#x4E00;&#x4E2A;&#x4EE5;&#x6570;&#x5B57;&#x8868;&#x793A;&#x7684;&#x8FDB;&#x7A0B;&#x7EC4;ID&#xFF0C;&#x8868;&#x793A;&#x8BE5;&#x8FDB;&#x7A0B;&#x6240;&#x5C5E;&#x7684;&#x8FDB;&#x7A0B;&#x7EC4;&#x3002;&#x65B0;&#x8FDB;&#x7A0B;&#x4F1A;&#x7EE7;&#x627F;&#x5176;&#x7236;&#x8FDB;&#x7A0B;&#x7684;&#x8FDB;&#x7A0B;&#x7EC4;ID&#xFF0C;&#x4F7F;&#x7528;getpgrp()&#x80FD;&#x591F;&#x83B7;&#x53D6;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7684;&#x8FDB;&#x7A0B;&#x7EC4;ID&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;unistd.h&gt;</span></span>
pid_t <span class="token function">getpgrp</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x5982;&#x679C;getpgrp()&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x4E0E;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x7684;&#x8FDB;&#x7A0B; ID &#x5339;&#x914D;&#x7684;&#x8BDD;&#x5C31;&#x8BF4;&#x660E;&#x8BE5;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x662F;&#x5176;&#x8FDB;&#x7A0B;&#x7EC4;&#x7684;&#x9996;&#x8FDB;&#x7A0B;&#x3002;</p>
<p>setpgid()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5C06;&#x8FDB;&#x7A0B;ID&#x4E3A;pid&#x7684;&#x8FDB;&#x7A0B;&#x7684;&#x8FDB;&#x7A0B;&#x7EC4; ID &#x4FEE;&#x6539;&#x4E3A;pgid&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;unistd.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">setpgid</span><span class="token punctuation">(</span>pid_t pid<span class="token punctuation">,</span>pid_t pgid<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x5982;&#x679C;&#x5C06;pid&#x7684;&#x503C;&#x8BBE;&#x7F6E;&#x4E3A;0&#xFF0C;&#x90A3;&#x4E48;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x7684;&#x8FDB;&#x7A0B;&#x7EC4;ID&#x5C31;&#x4F1A;&#x88AB;&#x6539;&#x53D8;&#x3002;&#x5982;&#x679C;&#x5C06;pgid&#x7684;&#x503C;&#x8BBE;&#x7F6E;&#x4E3A;0&#xFF0C;&#x90A3;&#x4E48; ID &#x4E3A;pid&#x7684;&#x8FDB;&#x7A0B;&#x7684;&#x8FDB;&#x7A0B;&#x7EC4; ID &#x4F1A;&#x88AB;&#x8BBE;&#x7F6E;&#x6210;pid&#x7684;&#x503C;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x4E0B;&#x9762;&#x7684;setpgid()&#x8C03;&#x7528;&#x662F;&#x7B49;&#x4EF7;&#x7684;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token function">setpgid</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">setpgid</span><span class="token punctuation">(</span><span class="token function">getpid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">setpgid</span><span class="token punctuation">(</span><span class="token function">getpid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">getpid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x5982;&#x679C;pid&#x548C;pgid&#x53C2;&#x6570;&#x6307;&#x5B9A;&#x4E86;&#x540C;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#xFF08;&#x5373;pgid&#x662F;0&#x6216;&#x8005;&#x4E0E; ID &#x4E3A;pid&#x7684;&#x8FDB;&#x7A0B;&#x7684;&#x8FDB;&#x7A0B;ID&#x5339;&#x914D;&#xFF09;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x4F1A;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x8FDB;&#x7A0B;&#x7EC4;&#xFF0C;&#x5E76;&#x4E14;&#x6307;&#x5B9A;&#x7684;&#x8FDB;&#x7A0B;&#x4F1A;&#x6210;&#x4E3A;&#x8FD9;&#x4E2A;&#x65B0;&#x7EC4;&#x7684;&#x9996;&#x8FDB;&#x7A0B;&#xFF08;&#x5373;&#x8FDB;&#x7A0B;&#x7684;&#x8FDB;&#x7A0B;&#x7EC4; ID &#x4E0E;&#x8FDB;&#x7A0B; ID &#x662F;&#x4E00;&#x6837;&#x7684;&#xFF09;&#x3002;&#x5982;&#x679C;&#x4E24;&#x4E2A;&#x53C2;&#x6570;&#x7684;&#x503C;&#x4E0D;&#x540C;&#xFF08;&#x5373;pgid&#x4E0D;&#x662F;0&#x6216;&#x8005;&#x4E0E; ID &#x4E3A;pid&#x7684;&#x8FDB;&#x7A0B;&#x7684;&#x8FDB;&#x7A0B; ID &#x4E0D;&#x5339;&#x914D;&#xFF09;&#xFF0C;&#x90A3;&#x4E48;setpgid()&#x8C03;&#x7528;&#x4F1A;&#x5C06;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x4ECE;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7EC4;&#x4E2D;&#x79FB;&#x5230;&#x53E6;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7EC4;&#x4E2D;&#x3002;</p>
<p>&#x901A;&#x5E38;&#x8C03;&#x7528;setpgid()&#xFF08;&#x4EE5;&#x53CA;setsid()&#xFF09;&#x51FD;&#x6570;&#x7684;&#x662F;shell&#x548C;login(1)&#x3002;&#x4E00;&#x4E2A;&#x7A0B;&#x5E8F;&#x5728;&#x4F7F;&#x81EA;&#x5DF1;&#x53D8;&#x6210;daemon&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x4E5F;&#x4F1A;&#x8C03;&#x7528;setsid()&#x3002;</p>
<p>&#x5728;&#x8C03;&#x7528;setpgid()&#x65F6;&#x5B58;&#x5728;&#x4EE5;&#x4E0B;&#x9650;&#x5236;&#x3002;</p>
<ul>
<li>pid&#x53C2;&#x6570;&#x53EF;&#x4EE5;&#x4EC5;&#x6307;&#x5B9A;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x6216;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x5B50;&#x8FDB;&#x7A0B;&#x3002;&#x8FDD;&#x53CD;&#x8FD9;&#x6761;&#x89C4;&#x5219;&#x4F1A;&#x5BFC;&#x81F4;ESRCH&#x9519;&#x8BEF;&#x3002;</li>
<li>&#x5728;&#x7EC4;&#x4E4B;&#x95F4;&#x79FB;&#x52A8;&#x8FDB;&#x7A0B;&#x65F6;&#xFF0C;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x3001;&#x7531;pid&#x6307;&#x5B9A;&#x7684;&#x8FDB;&#x7A0B;&#xFF08;&#x53EF;&#x80FD;&#x662F;&#x53E6;&#x5916;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#xFF0C;&#x4E5F;&#x53EF;&#x80FD;&#x5C31;&#x662F;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#xFF09;&#x4EE5;&#x53CA;&#x76EE;&#x6807;&#x8FDB;&#x7A0B;&#x7EC4;&#x5FC5;&#x987B;&#x8981;&#x5C5E;&#x4E8E;&#x540C;&#x4E00;&#x4E2A;&#x4F1A;&#x8BDD;&#x3002;&#x8FDD;&#x53CD;&#x8FD9;&#x6761;&#x89C4;&#x5219;&#x4F1A;&#x5BFC;&#x81F4;EPERM&#x9519;&#x8BEF;&#x3002;</li>
<li>pid&#x53C2;&#x6570;&#x6240;&#x6307;&#x5B9A;&#x7684;&#x8FDB;&#x7A0B;&#x4E0D;&#x80FD;&#x662F;&#x4F1A;&#x8BDD;&#x9996;&#x8FDB;&#x7A0B;&#x3002;&#x8FDD;&#x53CD;&#x8FD9;&#x6761;&#x89C4;&#x5219;&#x4F1A;&#x5BFC;&#x81F4;EPERM&#x9519;&#x8BEF;&#x3002;</li>
<li>&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x5728;&#x5176;&#x5B50;&#x8FDB;&#x7A0B;&#x5DF2;&#x7ECF;&#x6267;&#x884C;exec()&#x540E;&#x5C31;&#x65E0;&#x6CD5;&#x4FEE;&#x6539;&#x8BE5;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x8FDB;&#x7A0B;&#x7EC4; ID &#x4E86;&#x3002;&#x8FDD;&#x53CD;&#x8FD9;&#x6761;&#x89C4;&#x5219;&#x4F1A;&#x5BFC;&#x81F4;EACCES&#x9519;&#x8BEF;&#x3002;&#x4E4B;&#x6240;&#x4EE5;&#x4F1A;&#x6709;&#x8FD9;&#x6761;&#x7EA6;&#x675F;&#x6761;&#x4EF6;&#x7684;&#x539F;&#x56E0;&#x662F;&#x5728;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x5F00;&#x59CB;&#x6267;&#x884C;&#x4E4B;&#x540E;&#x518D;&#x4FEE;&#x6539;&#x5176;&#x8FDB;&#x7A0B;&#x7EC4; ID &#x7684;&#x8BDD;&#x4F1A;&#x4F7F;&#x7A0B;&#x5E8F;&#x53D8;&#x5F97;&#x6DF7;&#x4E71;&#x3002;</li>
</ul>
<h3 id="&#x5728;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;shell&#x4E2D;&#x4F7F;&#x7528;setpgid"><a href="#&#x5728;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;shell&#x4E2D;&#x4F7F;&#x7528;setpgid" class="headerlink" title="&#x5728;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;shell&#x4E2D;&#x4F7F;&#x7528;setpgid()"></a>&#x5728;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;shell&#x4E2D;&#x4F7F;&#x7528;setpgid()</h3><p>&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x5728;&#x5176;&#x5B50;&#x8FDB;&#x7A0B;&#x5DF2;&#x7ECF;&#x6267;&#x884C;exec()&#x4E4B;&#x540E;&#x5C31;&#x65E0;&#x6CD5;&#x4FEE;&#x6539;&#x8BE5;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x8FDB;&#x7A0B;&#x7EC4;ID&#x7684;&#x7EA6;&#x675F;&#x6761;&#x4EF6;&#x4F1A;&#x5F71;&#x54CD;&#x5230;&#x57FA;&#x4E8E;shell&#x7684;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;&#x7A0B;&#x5E8F;&#x8BBE;&#x8BA1;&#xFF0C;&#x5373;&#x9700;&#x8981;&#x6EE1;&#x8DB3;&#x4E0B;&#x5217;&#x6761;&#x4EF6;&#x3002;</p>
<ul>
<li>&#x4E00;&#x4E2A;&#x4EFB;&#x52A1;&#xFF08;&#x5373;&#x4E00;&#x4E2A;&#x547D;&#x4EE4;&#x6216;&#x4E00;&#x7EC4;&#x4EE5;&#x7BA1;&#x9053;&#x7B26;&#x8FDE;&#x63A5;&#x7684;&#x547D;&#x4EE4;&#xFF09;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x8FDB;&#x7A0B;&#x5FC5;&#x987B;&#x88AB;&#x653E;&#x7F6E;&#x5728;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7EC4;&#x4E2D;&#x3002;</li>
<li>&#x8FD9;&#x4E00;&#x6B65;&#x5141;&#x8BB8;shell&#x4F7F;&#x7528;killpg()&#xFF08;&#x6216;&#x4F7F;&#x7528;&#x8D1F;&#x7684;pid&#x503C;&#x6765;&#x8C03;&#x7528;kill()&#xFF09;&#x6765;&#x540C;&#x65F6;&#x5411;&#x8FDB;&#x7A0B;&#x7EC4;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x6210;&#x5458;&#x53D1;&#x9001;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;&#x4FE1;&#x53F7;&#x3002;&#x4E00;&#x822C;&#x6765;&#x8BB2;&#xFF0C;&#x8FD9;&#x4E00;&#x6B65;&#x9700;&#x8981;&#x5728;&#x53D1;&#x9001;&#x4EFB;&#x610F;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;&#x4FE1;&#x53F7;&#x524D;&#x5B8C;&#x6210;&#x3002;</li>
<li>&#x6BCF;&#x4E2A;&#x5B50;&#x8FDB;&#x7A0B;&#x5728;&#x6267;&#x884C;&#x7A0B;&#x5E8F;&#x4E4B;&#x524D;&#x5FC5;&#x987B;&#x8981;&#x88AB;&#x5206;&#x914D;&#x5230;&#x8FDB;&#x7A0B;&#x7EC4;&#x4E2D;&#xFF0C;&#x56E0;&#x4E3A;&#x7A0B;&#x5E8F;&#x672C;&#x8EAB;&#x662F;&#x4E0D;&#x6E05;&#x695A;&#x5982;&#x4F55;&#x64CD;&#x4F5C;&#x8FDB;&#x7A0B;&#x7EC4;ID&#x7684;&#x3002;</li>
</ul>
<p>&#x5BF9;&#x4E8E;&#x4EFB;&#x52A1;&#x4E2D;&#x7684;&#x5404;&#x4E2A;&#x8FDB;&#x7A0B;&#x6765;&#x8BB2;&#xFF0C;&#x7236;&#x8FDB;&#x7A0B;&#x548C;&#x5B50;&#x8FDB;&#x7A0B;&#x90FD;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;setpgid()&#x6765;&#x4FEE;&#x6539;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x8FDB;&#x7A0B;&#x7EC4;ID&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x7531;&#x4E8E;&#x5728;&#x7236;&#x8FDB;&#x7A0B;&#x6267;&#x884C;fork()&#x4E4B;&#x540E;&#x7236;&#x8FDB;&#x7A0B;&#x4E0E;&#x5B50;&#x8FDB;&#x7A0B;&#x4E4B;&#x95F4;&#x7684;&#x8C03;&#x5EA6;&#x987A;&#x5E8F;&#x662F;&#x65E0;&#x6CD5;&#x786E;&#x5B9A;&#x7684;&#xFF0C;&#x56E0;&#x6B64;&#x65E0;&#x6CD5;&#x4F9D;&#x9760;&#x7236;&#x8FDB;&#x7A0B;&#x5728;&#x5B50;&#x8FDB;&#x7A0B;&#x6267;&#x884C;exec()&#x4E4B;&#x524D;&#x6765;&#x6539;&#x53D8;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x8FDB;&#x7A0B;&#x7EC4;ID&#xFF0C;&#x540C;&#x6837;&#x4E5F;&#x65E0;&#x6CD5;&#x4F9D;&#x9760;&#x5B50;&#x8FDB;&#x7A0B;&#x5728;&#x7236;&#x8FDB;&#x7A0B;&#x5411;&#x5176;&#x53D1;&#x9001;&#x4EFB;&#x610F;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;&#x4FE1;&#x53F7;&#x4E4B;&#x524D;&#x4FEE;&#x6539;&#x5176;&#x8FDB;&#x7A0B;&#x7EC4;ID&#x3002;&#xFF08;&#x4F9D;&#x8D56;&#x8FD9;&#x4E9B;&#x884C;&#x4E3A;&#x4E2D;&#x7684;&#x4EFB;&#x610F;&#x4E00;&#x4E2A;&#x884C;&#x4E3A;&#x90FD;&#x4F1A;&#x5BFC;&#x81F4;&#x7ADE;&#x4E89;&#x6761;&#x4EF6;&#x3002;&#xFF09;&#x56E0;&#x6B64;&#xFF0C;&#x5728;&#x7F16;&#x5199;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;shell&#x7A0B;&#x5E8F;&#x65F6;&#x9700;&#x8981;&#x8BA9;&#x7236;&#x8FDB;&#x7A0B;&#x548C;&#x5B50;&#x8FDB;&#x7A0B;&#x5728;fork()&#x8C03;&#x7528;&#x4E4B;&#x540E;&#x7ACB;&#x5373;&#x8C03;&#x7528;setpgid()&#x6765;&#x5C06;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x8FDB;&#x7A0B;&#x7EC4;ID&#x8BBE;&#x7F6E;&#x4E3A;&#x540C;&#x6837;&#x7684;&#x503C;&#xFF0C;&#x5E76;&#x4E14;&#x7236;&#x8FDB;&#x7A0B;&#x9700;&#x8981;&#x5FFD;&#x7565;&#x5728;setpgid()&#x8C03;&#x7528;&#x4E2D;&#x51FA;&#x73B0;&#x7684;&#x6240;&#x6709;EACCES&#x9519;&#x8BEF;&#x3002;</p>
<h3 id="&#x83B7;&#x53D6;&#x548C;&#x4FEE;&#x6539;&#x8FDB;&#x7A0B;&#x7EC4;ID&#x7684;&#x5176;&#x4ED6;&#xFF08;&#x8FC7;&#x65F6;&#x7684;&#xFF09;&#x63A5;&#x53E3;"><a href="#&#x83B7;&#x53D6;&#x548C;&#x4FEE;&#x6539;&#x8FDB;&#x7A0B;&#x7EC4;ID&#x7684;&#x5176;&#x4ED6;&#xFF08;&#x8FC7;&#x65F6;&#x7684;&#xFF09;&#x63A5;&#x53E3;" class="headerlink" title="&#x83B7;&#x53D6;&#x548C;&#x4FEE;&#x6539;&#x8FDB;&#x7A0B;&#x7EC4;ID&#x7684;&#x5176;&#x4ED6;&#xFF08;&#x8FC7;&#x65F6;&#x7684;&#xFF09;&#x63A5;&#x53E3;"></a>&#x83B7;&#x53D6;&#x548C;&#x4FEE;&#x6539;&#x8FDB;&#x7A0B;&#x7EC4;ID&#x7684;&#x5176;&#x4ED6;&#xFF08;&#x8FC7;&#x65F6;&#x7684;&#xFF09;&#x63A5;&#x53E3;</h3><p>&#x8FD9;&#x91CC;&#x9700;&#x8981;&#x89E3;&#x91CA;&#x4E00;&#x4E0B;&#x4E3A;&#x4F55;getpgrp()&#x548C;setpgid()&#x4E24;&#x4E2A;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x540D;&#x79F0;&#x4E2D;&#x7684;&#x540E;&#x7F00;&#x4E0D;&#x540C;&#x3002;</p>
<p>&#x5728;&#x4E00;&#x5F00;&#x59CB;&#xFF0C;4.2BSD&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;getprgp(pid)&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x6765;&#x8FD4;&#x56DE;&#x8FDB;&#x7A0B;ID&#x4E3A;pid&#x7684;&#x8FDB;&#x7A0B;&#x7684;&#x8FDB;&#x7A0B;&#x7EC4;ID&#x3002;&#x5728;&#x5B9E;&#x8DF5;&#x4E2D;&#xFF0C;pid&#x51E0;&#x4E4E;&#x603B;&#x662F;&#x7528;&#x6765;&#x8868;&#x793A;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x3002;&#x7ED3;&#x679C;&#xFF0C;POSIX&#x59D4;&#x5458;&#x4F1A;&#x8BA4;&#x4E3A;&#x8FD9;&#x4E2A;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x8FC7;&#x4E8E;&#x590D;&#x6742;&#x4E86;&#xFF0C;&#x56E0;&#x6B64;&#x4ED6;&#x4EEC;&#x91C7;&#x7EB3;&#x4E86;System V getpgrp()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF0C;&#x8FD9;&#x4E2A;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x4E0D;&#x63A5;&#x6536;&#x4EFB;&#x4F55;&#x53C2;&#x6570;&#x5E76;&#x8FD4;&#x56DE;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x7684;&#x8FDB;&#x7A0B;&#x7EC4;ID&#x3002;</p>
<p>&#x4E3A;&#x4E86;&#x4FEE;&#x6539;&#x8FDB;&#x7A0B;&#x7EC4;ID&#xFF0C;4.2BSD&#x63D0;&#x4F9B;&#x4E86;setpgrp(pid,pgid)&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF0C;&#x5B83;&#x4E0E;setpgid()&#x7684;&#x884C;&#x4E3A;&#x662F;&#x76F8;&#x4F3C;&#x7684;&#x3002;&#x8FD9;&#x4E24;&#x4E2A;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x4E4B;&#x95F4;&#x6700;&#x4E3B;&#x8981;&#x7684;&#x5DEE;&#x522B;&#x5728;&#x4E8E;BSD setpgrp()&#x80FD;&#x591F;&#x7528;&#x6765;&#x5C06;&#x8FDB;&#x7A0B;&#x7EC4;ID&#x8BBE;&#x7F6E;&#x4E3A;&#x4EFB;&#x610F;&#x503C;&#x3002;&#xFF08;&#x524D;&#x9762;&#x66FE;&#x7ECF;&#x63D0;&#x53CA;&#x8FC7;&#x4E0D;&#x80FD;&#x4F7F;&#x7528;setpgid()&#x5C06;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x8FC1;&#x79FB;&#x81F3;&#x5176;&#x4ED6;&#x4F1A;&#x8BDD;&#x4E2D;&#x7684;&#x8FDB;&#x7A0B;&#x7EC4;&#x3002;&#xFF09;&#x8FD9;&#x4F1A;&#x5F15;&#x8D77;&#x4E00;&#x4E9B;&#x5B89;&#x5168;&#x95EE;&#x9898;&#xFF0C;&#x4F46;&#x5728;&#x5B9E;&#x73B0;&#x4EFB;&#x52A1;&#x63A7;&#x5236;&#x7A0B;&#x5E8F;&#x65F6;&#x4E5F;&#x66F4;&#x52A0;&#x7075;&#x6D3B;&#x3002;&#x7ED3;&#x679C;&#xFF0C;POSIX&#x59D4;&#x5458;&#x4F1A;&#x51B3;&#x5B9A;&#x7ED9;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x589E;&#x52A0;&#x989D;&#x5916;&#x7684;&#x9650;&#x5236;&#x6761;&#x4EF6;&#x5E76;&#x5C06;&#x5176;&#x547D;&#x540D;&#x4E3A;setpgid()&#x3002;</p>
<p>&#x66F4;&#x590D;&#x6742;&#x7684;&#x4E8B;&#x60C5;&#x662F;SUSv3&#x6307;&#x5B9A;&#x4E86;&#x4E00;&#x4E2A;getpgid(pid)&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF0C;&#x5B83;&#x4E0E;&#x8001;&#x5F0F;&#x7684;BSD getpgrp()&#x7684;&#x529F;&#x80FD;&#x662F;&#x4E00;&#x6837;&#x7684;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x5B83;&#x8FD8;&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x4E2A;&#x4ECE;System V&#x6F14;&#x5316;&#x800C;&#x6765;&#x7684;setpgrp()&#xFF0C;&#x5B83;&#x4E0D;&#x63A5;&#x53D7;&#x4EFB;&#x4F55;&#x53C2;&#x6570;&#xFF0C;&#x4E0E;setpgid(0, 0)&#x8C03;&#x7528;&#x51E0;&#x4E4E;&#x662F;&#x7B49;&#x4EF7;&#x7684;&#x3002;</p>
<p>&#x5C3D;&#x7BA1;&#x5BF9;&#x4E8E;&#x5B9E;&#x73B0;shell&#x4F5C;&#x4E1A;&#x63A7;&#x5236;&#x6765;&#x8BB2;&#xFF0C;&#x5229;&#x7528;&#x524D;&#x9762;&#x4ECB;&#x7ECD;&#x7684;setpgid()&#x548C;getpgrp()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5DF2;&#x7ECF;&#x8DB3;&#x591F;&#x4E86;&#x3002;&#x4F46;&#x4E0E;&#x5176;&#x4ED6;&#x5927;&#x591A;&#x6570;UNIX&#x5B9E;&#x73B0;&#x4E00;&#x6837;&#xFF0C;Linux&#x4E5F;&#x63D0;&#x4F9B;&#x4E86;getpgid(pid)&#x548C;setpgrp(void)&#x3002;&#x4E3A;&#x4E86;&#x5411;&#x540E;&#x517C;&#x5BB9;&#xFF0C;&#x5F88;&#x591A;&#x4ECE;BSD&#x6F14;&#x5316;&#x800C;&#x6765;&#x7684;&#x5B9E;&#x73B0;&#x4ECD;&#x7136;&#x63D0;&#x4F9B;&#x4E86;setprgp(pid, pgid)&#xFF0C;&#x5B83;&#x4E0E;setpgid(pid, pgid)&#x662F;&#x4E00;&#x6837;&#x7684;&#x3002;</p>
<p>&#x5728;&#x7F16;&#x8BD1;&#x7A0B;&#x5E8F;&#x65F6;&#x5982;&#x679C;&#x663E;&#x5F0F;&#x5730;&#x5B9A;&#x4E49;_BSD_SOURCE&#x7279;&#x6027;&#x6D4B;&#x8BD5;&#x5B8F;&#x7684;&#x8BDD;&#xFF0C;glibc&#x4F1A;&#x4F7F;&#x7528;&#x4ECE;BSD&#x6F14;&#x5316;&#x800C;&#x6765;&#x7684;setpgrp()&#x548C;getpgrp()&#x6765;&#x53D6;&#x4EE3;&#x9ED8;&#x8BA4;&#x7248;&#x672C;&#x3002;</p>
<h2 id="&#x4F1A;&#x8BDD;"><a href="#&#x4F1A;&#x8BDD;" class="headerlink" title="&#x4F1A;&#x8BDD;"></a>&#x4F1A;&#x8BDD;</h2><p>&#x4F1A;&#x8BDD;&#x662F;&#x4E00;&#x7EC4;&#x8FDB;&#x7A0B;&#x7EC4;&#x96C6;&#x5408;&#x3002;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7684;&#x4F1A;&#x8BDD;&#x6210;&#x5458;&#x5173;&#x7CFB;&#x662F;&#x7531;&#x5176;&#x4F1A;&#x8BDD;ID&#x6765;&#x5B9A;&#x4E49;&#x7684;&#xFF0C;&#x4F1A;&#x8BDD;ID&#x662F;&#x4E00;&#x4E2A;&#x6570;&#x5B57;&#x3002;&#x65B0;&#x8FDB;&#x7A0B;&#x4F1A;&#x7EE7;&#x627F;&#x5176;&#x7236;&#x8FDB;&#x7A0B;&#x7684;&#x4F1A;&#x8BDD;ID&#x3002;getsid()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x4F1A;&#x8FD4;&#x56DE;pid&#x6307;&#x5B9A;&#x7684;&#x8FDB;&#x7A0B;&#x7684;&#x4F1A;&#x8BDD;ID&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">define</span> _XOPEN_SOURCE 500</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;unistd.h&gt;</span></span>

pid_t <span class="token function">getsid</span><span class="token punctuation">(</span>pid_t pid<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x5982;&#x679C;pid&#x53C2;&#x6570;&#x7684;&#x503C;&#x4E3A;0&#xFF0C;&#x90A3;&#x4E48;getsid()&#x4F1A;&#x8FD4;&#x56DE;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x7684;&#x4F1A;&#x8BDD;ID&#x3002;</p>
<p>&#x5982;&#x679C;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x4E0D;&#x662F;&#x8FDB;&#x7A0B;&#x7EC4;&#x9996;&#x8FDB;&#x7A0B;&#xFF0C;&#x90A3;&#x4E48;setsid()&#x4F1A;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x4F1A;&#x8BDD;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;unistd.h&gt;</span></span>

pid_t <span class="token function">setsid</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>setsid()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x4F1A;&#x6309;&#x7167;&#x4E0B;&#x5217;&#x6B65;&#x9AA4;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x4F1A;&#x8BDD;&#x3002;</p>
<ul>
<li>&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x6210;&#x4E3A;&#x65B0;&#x4F1A;&#x8BDD;&#x7684;&#x9996;&#x8FDB;&#x7A0B;&#x548C;&#x8BE5;&#x4F1A;&#x8BDD;&#x4E2D;&#x65B0;&#x8FDB;&#x7A0B;&#x7EC4;&#x7684;&#x9996;&#x8FDB;&#x7A0B;&#x3002;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x7684;&#x8FDB;&#x7A0B;&#x7EC4;ID&#x548C;&#x4F1A;&#x8BDD;ID&#x4F1A;&#x88AB;&#x8BBE;&#x7F6E;&#x6210;&#x8BE5;&#x8FDB;&#x7A0B;&#x7684;&#x8FDB;&#x7A0B;ID&#x3002;</li>
<li>&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x6CA1;&#x6709;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x3002;&#x6240;&#x6709;&#x4E4B;&#x524D;&#x5230;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x7684;&#x8FDE;&#x63A5;&#x90FD;&#x4F1A;&#x88AB;&#x65AD;&#x5F00;&#x3002;</li>
</ul>
<p>&#x5982;&#x679C;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x662F;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7EC4;&#x9996;&#x8FDB;&#x7A0B;&#xFF0C;&#x90A3;&#x4E48;setsid()&#x8C03;&#x7528;&#x4F1A;&#x62A5;&#x51FA;EPERM&#x9519;&#x8BEF;&#x3002;&#x907F;&#x514D;&#x8FD9;&#x4E2A;&#x9519;&#x8BEF;&#x53D1;&#x751F;&#x7684;&#x6700;&#x7B80;&#x5355;&#x7684;&#x65B9;&#x5F0F;&#x662F;&#x6267;&#x884C;&#x4E00;&#x4E2A;fork()&#x5E76;&#x8BA9;&#x7236;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#x4EE5;&#x53CA;&#x8BA9;&#x5B50;&#x8FDB;&#x7A0B;&#x8C03;&#x7528;setsid()&#x3002;&#x7531;&#x4E8E;&#x5B50;&#x8FDB;&#x7A0B;&#x4F1A;&#x7EE7;&#x627F;&#x5176;&#x7236;&#x8FDB;&#x7A0B;&#x7684;&#x8FDB;&#x7A0B;&#x7EC4; ID &#x5E76;&#x63A5;&#x6536;&#x5C5E;&#x4E8E;&#x81EA;&#x5DF1;&#x7684;&#x552F;&#x4E00;&#x7684;&#x8FDB;&#x7A0B; ID&#xFF0C;&#x56E0;&#x6B64;&#x5B83;&#x65E0;&#x6CD5;&#x6210;&#x4E3A;&#x8FDB;&#x7A0B;&#x7EC4;&#x9996;&#x8FDB;&#x7A0B;&#x3002;</p>
<p>&#x7EA6;&#x675F;&#x8FDB;&#x7A0B;&#x7EC4;&#x9996;&#x8FDB;&#x7A0B;&#x5BF9;setsid()&#x7684;&#x8C03;&#x7528;&#x662F;&#x6709;&#x5FC5;&#x8981;&#x7684;&#x3002;&#x56E0;&#x4E3A;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x8FD9;&#x4E2A;&#x7EA6;&#x675F;&#x7684;&#x8BDD;&#xFF0C;&#x8FDB;&#x7A0B;&#x7EC4;&#x7EC4;&#x957F;&#x5C31;&#x80FD;&#x591F;&#x5C06;&#x5176;&#x81EA;&#x8EAB;&#x8FC1;&#x79FB;&#x81F3;&#x53E6;&#x4E00;&#x4E2A;&#xFF08;&#x65B0;&#x7684;&#xFF09;&#x4F1A;&#x8BDD;&#x4E2D;&#x4E86;&#xFF0C;&#x800C;&#x8BE5;&#x8FDB;&#x7A0B;&#x7EC4;&#x7684;&#x5176;&#x4ED6;&#x6210;&#x5458;&#x5219;&#x4ECD;&#x7136;&#x4F4D;&#x4E8E;&#x539F;&#x6765;&#x7684;&#x4F1A;&#x8BDD;&#x4E2D;&#x3002;&#xFF08;&#x4E0D;&#x4F1A;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x8FDB;&#x7A0B;&#x7EC4;&#xFF0C;&#x56E0;&#x4E3A;&#x6839;&#x636E;&#x5B9A;&#x4E49;&#xFF0C;&#x8FDB;&#x7A0B;&#x7EC4;&#x9996;&#x8FDB;&#x7A0B;&#x7684;&#x8FDB;&#x7A0B;&#x7EC4;ID&#x5DF2;&#x7ECF;&#x4E0E;&#x5176;&#x8FDB;&#x7A0B;ID&#x4E00;&#x6837;&#x4E86;&#x3002;&#xFF09;&#x8FD9;&#x4F1A;&#x7834;&#x574F;&#x4F1A;&#x8BDD;&#x548C;&#x8FDB;&#x7A0B;&#x7EC4;&#x4E4B;&#x95F4;&#x4E25;&#x683C;&#x7684;&#x4E24;&#x7EA7;&#x5C42;&#x6B21;&#xFF0C;&#x56E0;&#x6B64;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7EC4;&#x7684;&#x6240;&#x6709;&#x6210;&#x5458;&#x5FC5;&#x987B;&#x5C5E;&#x4E8E;&#x540C;&#x4E00;&#x4E2A;&#x4F1A;&#x8BDD;&#x3002;</p>
<p>&#x5F53;&#x4F7F;&#x7528;fork()&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x8FDB;&#x7A0B;&#x65F6;&#xFF0C;&#x5185;&#x6838;&#x4F1A;&#x786E;&#x4FDD;&#x5B83;&#x62E5;&#x6709;&#x4E00;&#x4E2A;&#x552F;&#x4E00;&#x7684;&#x8FDB;&#x7A0B;ID&#xFF0C;&#x5E76;&#x4E14;&#x8BE5;&#x8FDB;&#x7A0B;ID&#x4E0D;&#x4F1A;&#x4E0E;&#x4EFB;&#x610F;&#x5DF2;&#x6709;&#x8FDB;&#x7A0B;&#x7684;&#x8FDB;&#x7A0B;&#x7EC4;ID&#x548C;&#x4F1A;&#x8BDD;ID&#x76F8;&#x540C;&#x3002;&#x8FD9;&#x6837;&#xFF0C;&#x5373;&#x4F7F;&#x8FDB;&#x7A0B;&#x7EC4;&#x6216;&#x4F1A;&#x8BDD;&#x9996;&#x8FDB;&#x7A0B;&#x9000;&#x51FA;&#x4E4B;&#x540E;&#xFF0C;&#x65B0;&#x8FDB;&#x7A0B;&#x4E5F;&#x65E0;&#x6CD5;&#x590D;&#x7528;&#x9996;&#x8FDB;&#x7A0B;&#x7684;&#x8FDB;&#x7A0B;ID&#xFF0C;&#x4ECE;&#x800C;&#x4E5F;&#x65E0;&#x6CD5;&#x6210;&#x4E3A;&#x65E2;&#x6709;&#x4F1A;&#x8BDD;&#x548C;&#x8FDB;&#x7A0B;&#x7EC4;&#x7684;&#x9996;&#x8FDB;&#x7A0B;&#x3002;</p>
<p>&#x7A0B;&#x5E8F;&#x6E05;&#x5355;&#x6F14;&#x793A;&#x4E86;&#x4F7F;&#x7528;setsid()&#x6765;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x4F1A;&#x8BDD;&#x3002;&#x4E3A;&#x4E86;&#x68C0;&#x67E5;&#x8BE5;&#x8FDB;&#x7A0B;&#x5DF2;&#x7ECF;&#x4E0D;&#x518D;&#x62E5;&#x6709;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x4E86;&#xFF0C;&#x8FD9;&#x4E2A;&#x7A0B;&#x5E8F;&#x5C1D;&#x8BD5;&#x6253;&#x5F00;&#x4E00;&#x4E2A;&#x7279;&#x6B8A;&#x6587;&#x4EF6;/dev/tty&#xFF08;&#x4E0B;&#x4E00;&#x8282;&#x5C06;&#x4E88;&#x4EE5;&#x4ECB;&#x7ECD;&#xFF09;&#x3002;&#x5F53;&#x8FD0;&#x884C;&#x8FD9;&#x4E2A;&#x7A0B;&#x5E8F;&#x65F6;&#x4F1A;&#x770B;&#x5230;&#x4E0B;&#x9762;&#x7684;&#x7ED3;&#x679C;&#xFF1A;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">if</span> ! defined(_XOPEN_SOURCE) || _XOPEN_SOURCE &lt; 500</span>
<span class="token macro property">#<span class="token directive keyword">define</span> _XOPEN_SOURCE 500</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;fcntl.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;unistd.h&gt;</span></span>

<span class="token keyword">int</span>
<span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true">/* Exit if parent, or on error */</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;EXIT_SUCCESS\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">setsid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;setsid&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;PID=%ld, PGID=%ld, SID=%ld\n&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span> <span class="token function">getpid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span> <span class="token function">getpgrp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span> <span class="token function">getsid</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">/* Following should fail, since we don&apos;t have a controlling terminal */</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;/dev/tty&quot;</span><span class="token punctuation">,</span> O_RDWR<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Error:open /dev/tty\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>EXIT_SUCCESS
setsidPID=23910, PGID=23910, SID=4681
PID=23911, PGID=23911, SID=23911
Error:open /dev/tty</code></pre><p>&#x4ECE;&#x8F93;&#x51FA;&#x4E2D;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF0C;&#x8FDB;&#x7A0B;&#x6210;&#x529F;&#x5730;&#x5C06;&#x5176;&#x81EA;&#x8EAB;&#x8FC1;&#x79FB;&#x81F3;&#x4E86;&#x65B0;&#x4F1A;&#x8BDD;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x65B0;&#x8FDB;&#x7A0B;&#x7EC4;&#x4E2D;&#x3002;&#x7531;&#x4E8E;&#x8FD9;&#x4E2A;&#x4F1A;&#x8BDD;&#x6CA1;&#x6709;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#xFF0C;&#x56E0;&#x6B64;open()&#x8C03;&#x7528;&#x4F1A;&#x5931;&#x8D25;&#x3002;&#xFF08;&#x4ECE;&#x4E0A;&#x9762;&#x7A0B;&#x5E8F;&#x8F93;&#x51FA;&#x7684;&#x5012;&#x6570;&#x7B2C;&#x4E8C;&#x884C;&#x4E2D;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF0C;hell&#x63D0;&#x793A;&#x7B26;&#x4E0E;&#x7A0B;&#x5E8F;&#x8F93;&#x51FA;&#x6DF7;&#x6742;&#x5728;&#x4E00;&#x8D77;&#x4E86;&#xFF0C;&#x56E0;&#x4E3A;shell&#x6CE8;&#x610F;&#x5230;&#x7236;&#x8FDB;&#x7A0B;&#x5728;fork()&#x8C03;&#x7528;&#x4E4B;&#x540E;&#x5C31;&#x9000;&#x51FA;&#x4E86;&#xFF0C;&#x56E0;&#x6B64;&#x5728;&#x5B50;&#x8FDB;&#x7A0B;&#x7ED3;&#x675F;&#x4E4B;&#x524D;&#x5C31;&#x8F93;&#x51FA;&#x4E86;&#x4E0B;&#x4E00;&#x4E2A;&#x63D0;&#x793A;&#x7B26;&#x3002;&#xFF09;</p>
<h2 id="&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x548C;&#x63A7;&#x5236;&#x8FDB;&#x7A0B;"><a href="#&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x548C;&#x63A7;&#x5236;&#x8FDB;&#x7A0B;" class="headerlink" title="&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x548C;&#x63A7;&#x5236;&#x8FDB;&#x7A0B;"></a>&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x548C;&#x63A7;&#x5236;&#x8FDB;&#x7A0B;</h2><p>&#x4E00;&#x4E2A;&#x4F1A;&#x8BDD;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x8FDB;&#x7A0B;&#x53EF;&#x80FD;&#x4F1A;&#x62E5;&#x6709;&#x4E00;&#x4E2A;&#xFF08;&#x5355;&#x4E2A;&#xFF09;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x3002;&#x4F1A;&#x8BDD;&#x5728;&#x88AB;&#x521B;&#x5EFA;&#x51FA;&#x6765;&#x7684;&#x65F6;&#x5019;&#x662F;&#x6CA1;&#x6709;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x7684;&#xFF0C;&#x5F53;&#x4F1A;&#x8BDD;&#x9996;&#x8FDB;&#x7A0B;&#x9996;&#x6B21;&#x6253;&#x5F00;&#x4E00;&#x4E2A;&#x8FD8;&#x6CA1;&#x6709;&#x6210;&#x4E3A;&#x67D0;&#x4E2A;&#x4F1A;&#x8BDD;&#x7684;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x7684;&#x7EC8;&#x7AEF;&#x65F6;&#x4F1A;&#x5EFA;&#x7ACB;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#xFF0C;&#x9664;&#x975E;&#x5728;&#x8C03;&#x7528;open()&#x65F6;&#x6307;&#x5B9A;O_NOCTTY&#x6807;&#x8BB0;&#x3002;&#x4E00;&#x4E2A;&#x7EC8;&#x7AEF;&#x81F3;&#x591A;&#x53EA;&#x80FD;&#x6210;&#x4E3A;&#x4E00;&#x4E2A;&#x4F1A;&#x8BDD;&#x7684;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x3002;</p>
<p>SUSv3&#x5B9A;&#x4E49;&#x4E86;&#x51FD;&#x6570;tcgetsid(int fd)&#xFF08;&#x5728;&lt;termios.h&gt;&#x5934;&#x6587;&#x4EF6;&#x4E2D;&#x8FDB;&#x884C;&#x5B9A;&#x4E49;&#xFF09;&#xFF0C;&#x5B83;&#x8FD4;&#x56DE;&#x4E0E;&#x7531;fd&#x6307;&#x5B9A;&#x7684;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x76F8;&#x5173;&#x8054;&#x7684;&#x4F1A;&#x8BDD;&#x7684;ID&#x3002;glibc&#x63D0;&#x4F9B;&#x4E86;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#xFF08;&#x5B83;&#x662F;&#x4F7F;&#x7528;ioctl() TIOCGSID&#x64CD;&#x4F5C;&#x5B9E;&#x73B0;&#x7684;&#xFF09;&#x3002;</p>
<p>&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x4F1A;&#x88AB;&#x7531;fork()&#x521B;&#x5EFA;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x7EE7;&#x627F;&#x5E76;&#x4E14;&#x5728;exec()&#x8C03;&#x7528;&#x4E2D;&#x5F97;&#x5230;&#x4FDD;&#x6301;&#x3002;</p>
<p>&#x5F53;&#x4F1A;&#x8BDD;&#x9996;&#x8FDB;&#x7A0B;&#x6253;&#x5F00;&#x4E86;&#x4E00;&#x4E2A;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x4E4B;&#x540E;&#x5B83;&#x540C;&#x65F6;&#x4E5F;&#x6210;&#x4E3A;&#x4E86;&#x8BE5;&#x7EC8;&#x7AEF;&#x7684;&#x63A7;&#x5236;&#x8FDB;&#x7A0B;&#x3002;&#x5728;&#x53D1;&#x751F;&#x7EC8;&#x7AEF;&#x65AD;&#x5F00;&#x4E4B;&#x540E;&#xFF0C;&#x5185;&#x6838;&#x4F1A;&#x5411;&#x63A7;&#x5236;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;&#x4E00;&#x4E2A;SIGHUP&#x4FE1;&#x53F7;&#x6765;&#x901A;&#x77E5;&#x8FD9;&#x4E00;&#x4E8B;&#x4EF6;&#x7684;&#x53D1;&#x751F;&#x3002;</p>
<p>&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x62E5;&#x6709;&#x4E00;&#x4E2A;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#xFF0C;&#x90A3;&#x4E48;&#x6253;&#x5F00;&#x7279;&#x6B8A;&#x6587;&#x4EF6;/dev/tty&#x5C31;&#x80FD;&#x591F;&#x83B7;&#x53D6;&#x8BE5;&#x7EC8;&#x7AEF;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x3002;&#x8FD9;&#x5BF9;&#x4E8E;&#x4E00;&#x4E2A;&#x7A0B;&#x5E8F;&#x5728;&#x6807;&#x51C6;&#x8F93;&#x5165;&#x548C;&#x8F93;&#x51FA;&#x88AB;&#x91CD;&#x5B9A;&#x5411;&#x4E4B;&#x540E;&#x9700;&#x8981;&#x786E;&#x4FDD;&#x81EA;&#x5DF1;&#x786E;&#x5B9E;&#x5728;&#x4E0E;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x8FDB;&#x884C;&#x901A;&#x4FE1;&#x662F;&#x5F88;&#x6709;&#x7528;&#x7684;&#x3002;&#x5982;&#x679C;&#x8FDB;&#x7A0B;&#x6CA1;&#x6709;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#xFF0C;&#x90A3;&#x4E48;&#x5728;&#x6253;&#x5F00;/dev/tty&#x65F6;&#x4F1A;&#x62A5;&#x51FA;ENXIO&#x7684;&#x9519;&#x8BEF;&#x3002;</p>
<h3 id="&#x5220;&#x9664;&#x8FDB;&#x7A0B;&#x4E0E;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x8054;&#x5173;&#x7CFB;"><a href="#&#x5220;&#x9664;&#x8FDB;&#x7A0B;&#x4E0E;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x8054;&#x5173;&#x7CFB;" class="headerlink" title="&#x5220;&#x9664;&#x8FDB;&#x7A0B;&#x4E0E;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x8054;&#x5173;&#x7CFB;"></a>&#x5220;&#x9664;&#x8FDB;&#x7A0B;&#x4E0E;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x8054;&#x5173;&#x7CFB;</h3><p>&#x4F7F;&#x7528;ioctl(fd, TIOCNOTTY)&#x64CD;&#x4F5C;&#x80FD;&#x591F;&#x5220;&#x9664;&#x8FDB;&#x7A0B;&#x4E0E;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;fd&#x6307;&#x5B9A;&#x7684;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x8054;&#x5173;&#x7CFB;&#x3002;&#x5728;&#x8C03;&#x7528;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4E4B;&#x540E;&#x518D;&#x8BD5;&#x56FE;&#x6253;&#x5F00;/dev/tty&#x6587;&#x4EF6;&#x7684;&#x8BDD;&#x5C31;&#x4F1A;&#x5931;&#x8D25;&#x3002;&#xFF08;&#x5C3D;&#x7BA1;SUSv3&#x6CA1;&#x6709;&#x6307;&#x5B9A;&#x8FD9;&#x4E2A;&#x64CD;&#x4F5C;&#xFF0C;&#x4F46;&#x5927;&#x591A;&#x6570;UNIX&#x5B9E;&#x73B0;&#x90FD;&#x652F;&#x6301;TIOCNOTTY&#x64CD;&#x4F5C;&#x3002;&#xFF09;</p>
<p>&#x5982;&#x679C;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x662F;&#x7EC8;&#x7AEF;&#x7684;&#x63A7;&#x5236;&#x8FDB;&#x7A0B;&#xFF0C;&#x90A3;&#x4E48;&#x5728;&#x63A7;&#x5236;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#x65F6;&#x4F1A;&#x53D1;&#x751F;&#x4E0B;&#x5217;&#x4E8B;&#x60C5;&#x3002;<br>1&#xFF0E; &#x4F1A;&#x8BDD;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x8FDB;&#x7A0B;&#x5C06;&#x4F1A;&#x5931;&#x53BB;&#x4E0E;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x8054;&#x5173;&#x7CFB;&#x3002;<br>2&#xFF0E; &#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x5931;&#x53BB;&#x4E86;&#x4E0E;&#x8BE5;&#x4F1A;&#x8BDD;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x8054;&#x5173;&#x7CFB;&#xFF0C;&#x56E0;&#x6B64;&#x53E6;&#x4E00;&#x4E2A;&#x4F1A;&#x8BDD;&#x9996;&#x8FDB;&#x7A0B;&#x5C31;&#x80FD;&#x591F;&#x83B7;&#x53D6;&#x8BE5;&#x7EC8;&#x7AEF;&#x4EE5;&#x6210;&#x4E3A;&#x63A7;&#x5236;&#x8FDB;&#x7A0B;&#x3002;<br>3&#xFF0E; &#x5185;&#x6838;&#x4F1A;&#x5411;&#x524D;&#x53F0;&#x8FDB;&#x7A0B;&#x7EC4;&#x7684;&#x6240;&#x6709;&#x6210;&#x5458;&#x53D1;&#x9001;&#x4E00;&#x4E2A;SIGHUP&#x4FE1;&#x53F7;&#xFF08;&#x548C;&#x4E00;&#x4E2A;SIGCONT&#x4FE1;&#x53F7;&#xFF09;&#x6765;&#x901A;&#x77E5;&#x5B83;&#x4EEC;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x7684;&#x4E22;&#x5931;&#x3002;</p>
<h3 id="&#x5728;BSD&#x4E0A;&#x5EFA;&#x7ACB;&#x4E00;&#x4E2A;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;"><a href="#&#x5728;BSD&#x4E0A;&#x5EFA;&#x7ACB;&#x4E00;&#x4E2A;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;" class="headerlink" title="&#x5728;BSD&#x4E0A;&#x5EFA;&#x7ACB;&#x4E00;&#x4E2A;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;"></a>&#x5728;BSD&#x4E0A;&#x5EFA;&#x7ACB;&#x4E00;&#x4E2A;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;</h3><p>SUSv3&#x5E76;&#x4E0D;&#x652F;&#x6301;&#x4E00;&#x4E2A;&#x4F1A;&#x8BDD;&#x83B7;&#x53D6;&#x672A;&#x6307;&#x5B9A;&#x7684;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#xFF0C;&#x5728;&#x6253;&#x5F00;&#x7EC8;&#x7AEF;&#x65F6;&#x4EC5;&#x6307;&#x5B9A;O_NOCTTY&#x6807;&#x8BB0;&#x7684;&#x8BDD;&#x53EA;&#x80FD;&#x786E;&#x4FDD;&#x8BE5;&#x7EC8;&#x7AEF;&#x4E0D;&#x4F1A;&#x6210;&#x4E3A;&#x4F1A;&#x8BDD;&#x7684;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x3002;&#x4E0A;&#x9762;&#x63CF;&#x8FF0;&#x7684;Linux&#x8BED;&#x4E49;&#x6E90;&#x81EA;System V&#x7CFB;&#x7EDF;&#x3002;</p>
<p>&#x5728;BSD&#x7CFB;&#x7EDF;&#x4E0A;&#xFF0C;&#x5728;&#x4F1A;&#x8BDD;&#x9996;&#x8FDB;&#x7A0B;&#x4E2D;&#x6253;&#x5F00;&#x4E00;&#x4E2A;&#x7EC8;&#x7AEF;&#x4E0D;&#x4F1A;&#x5BFC;&#x81F4;&#x8BE5;&#x7EC8;&#x7AEF;&#x6210;&#x4E3A;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#xFF0C;&#x4E0D;&#x7BA1;&#x662F;&#x5426;&#x6307;&#x5B9A;&#x4E86;O_NOCTTY&#x6807;&#x8BB0;&#x3002;&#x76F8;&#x53CD;&#xFF0C;&#x4F1A;&#x8BDD;&#x9996;&#x8FDB;&#x7A0B;&#x9700;&#x8981;&#x4F7F;&#x7528;ioctl() TIOCSCTTY&#x64CD;&#x4F5C;&#x6765;&#x663E;&#x5F0F;&#x5730;&#x5C06;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;fd&#x6307;&#x5B9A;&#x7684;&#x7EC8;&#x7AEF;&#x5EFA;&#x7ACB;&#x4E3A;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">ioctl</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span>TIOCSCTTY<span class="token punctuation">)</span><span class="token operator">==</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;ioctl&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x53EA;&#x6709;&#x5728;&#x4F1A;&#x8BDD;&#x6CA1;&#x6709;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x65F6;&#x624D;&#x80FD;&#x6267;&#x884C;&#x8FD9;&#x4E2A;&#x64CD;&#x4F5C;&#x3002;</p>
<p>Linux&#x7CFB;&#x7EDF;&#x4E0A;&#x4E5F;&#x6709;TIOCSCTTY&#x64CD;&#x4F5C;&#xFF0C;&#x4F46;&#x5728;&#x5176;&#x4ED6;&#xFF08;&#x975E;BSD&#xFF09;&#x5B9E;&#x73B0;&#x4E2D;&#x7528;&#x5F97;&#x5E76;&#x4E0D;&#x591A;&#x3002;</p>
<h3 id="&#x83B7;&#x53D6;&#x8868;&#x793A;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x7684;&#x8DEF;&#x5F84;&#x540D;&#xFF1A;ctermid"><a href="#&#x83B7;&#x53D6;&#x8868;&#x793A;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x7684;&#x8DEF;&#x5F84;&#x540D;&#xFF1A;ctermid" class="headerlink" title="&#x83B7;&#x53D6;&#x8868;&#x793A;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x7684;&#x8DEF;&#x5F84;&#x540D;&#xFF1A;ctermid()"></a>&#x83B7;&#x53D6;&#x8868;&#x793A;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x7684;&#x8DEF;&#x5F84;&#x540D;&#xFF1A;ctermid()</h3><p>ctermid()&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x8868;&#x793A;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x7684;&#x8DEF;&#x5F84;&#x540D;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>

<span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">ctermid</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>ttyname<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>ctermid()&#x51FD;&#x6570;&#x4EE5;&#x4E24;&#x79CD;&#x4E0D;&#x540C;&#x7684;&#x65B9;&#x5F0F;&#x8FD4;&#x56DE;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x7684;&#x8DEF;&#x5F84;&#x540D;&#xFF1A;&#x901A;&#x8FC7;&#x51FD;&#x6570;&#x7ED3;&#x679C;&#x548C;&#x901A;&#x8FC7;ttyname&#x6307;&#x5411;&#x7684;&#x7F13;&#x51B2;&#x533A;&#x3002;</p>
<p>&#x5982;&#x679C;ttyname&#x4E0D;&#x4E3A;NULL&#xFF0C;&#x90A3;&#x4E48;&#x5B83;&#x662F;&#x4E00;&#x4E2A;&#x5927;&#x5C0F;&#x81F3;&#x5C11;&#x4E3A;L_ctermid&#x5B57;&#x8282;&#x7684;&#x7F13;&#x51B2;&#x533A;&#xFF0C;&#x5E76;&#x4E14;&#x8DEF;&#x5F84;&#x540D;&#x4F1A;&#x88AB;&#x590D;&#x5236;&#x8FDB;&#x8FD9;&#x4E2A;&#x6570;&#x7EC4;&#x4E2D;&#x3002;&#x8FD9;&#x91CC;&#x51FD;&#x6570;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x4E5F;&#x662F;&#x4E00;&#x4E2A;&#x6307;&#x5411;&#x8BE5;&#x7F13;&#x51B2;&#x533A;&#x7684;&#x6307;&#x9488;&#x3002;&#x5982;&#x679C;ttyname&#x4E3A;NULL&#xFF0C;&#x90A3;&#x4E48;ctermid()&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x6307;&#x5411;&#x9759;&#x6001;&#x5206;&#x914D;&#x7684;&#x7F13;&#x51B2;&#x533A;&#x7684;&#x6307;&#x9488;&#xFF0C;&#x7F13;&#x51B2;&#x533A;&#x4E2D;&#x5305;&#x542B;&#x4E86;&#x8DEF;&#x5F84;&#x540D;&#x3002;&#x5F53;ttyname&#x4E3A;NULL&#x65F6;&#xFF0C;ctermid()&#x662F;&#x4E0D;&#x53EF;&#x91CD;&#x5165;&#x7684;&#x3002;</p>
<p>&#x5728;Linux&#x548C;&#x5176;&#x4ED6;UNIX&#x5B9E;&#x73B0;&#x4E2D;&#xFF0C;ctermid()&#x901A;&#x5E38;&#x4F1A;&#x751F;&#x6210;&#x5B57;&#x7B26;&#x4E32;/dev/tty&#x3002;&#x5F15;&#x5165;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x7684;&#x76EE;&#x7684;&#x662F;&#x4E3A;&#x4E86;&#x80FD;&#x66F4;&#x52A0;&#x5BB9;&#x6613;&#x5730;&#x5C06;&#x7A0B;&#x5E8F;&#x79FB;&#x690D;&#x5230;&#x975E;UNIX&#x7CFB;&#x7EDF;&#x4E0A;&#x3002;</p>
<h2 id="&#x524D;&#x53F0;&#x548C;&#x540E;&#x53F0;&#x8FDB;&#x7A0B;&#x7EC4;"><a href="#&#x524D;&#x53F0;&#x548C;&#x540E;&#x53F0;&#x8FDB;&#x7A0B;&#x7EC4;" class="headerlink" title="&#x524D;&#x53F0;&#x548C;&#x540E;&#x53F0;&#x8FDB;&#x7A0B;&#x7EC4;"></a>&#x524D;&#x53F0;&#x548C;&#x540E;&#x53F0;&#x8FDB;&#x7A0B;&#x7EC4;</h2><p>&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x4FDD;&#x7559;&#x4E86;&#x524D;&#x53F0;&#x8FDB;&#x7A0B;&#x7EC4;&#x7684;&#x6982;&#x5FF5;&#x3002;&#x5728;&#x4E00;&#x4E2A;&#x4F1A;&#x8BDD;&#x4E2D;&#xFF0C;&#x5728;&#x540C;&#x4E00;&#x65F6;&#x523B;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x80FD;&#x6210;&#x4E3A;&#x524D;&#x53F0;&#x8FDB;&#x7A0B;&#xFF0C;&#x4F1A;&#x8BDD;&#x4E2D;&#x7684;&#x5176;&#x4ED6;&#x6240;&#x6709;&#x8FDB;&#x7A0B;&#x90FD;&#x662F;&#x540E;&#x53F0;&#x8FDB;&#x7A0B;&#x7EC4;&#x3002;&#x524D;&#x53F0;&#x8FDB;&#x7A0B;&#x7EC4;&#x662F;&#x552F;&#x4E00;&#x80FD;&#x591F;&#x81EA;&#x7531;&#x5730;&#x8BFB;&#x53D6;&#x548C;&#x5199;&#x5165;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x7684;&#x8FDB;&#x7A0B;&#x7EC4;&#x3002;&#x5F53;&#x5728;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x4E2D;&#x8F93;&#x5165;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x4FE1;&#x53F7;&#x751F;&#x6210;&#x7EC8;&#x7AEF;&#x5B57;&#x7B26;&#x4E4B;&#x540E;&#xFF0C;&#x7EC8;&#x7AEF;&#x9A71;&#x52A8;&#x5668;&#x4F1A;&#x5C06;&#x76F8;&#x5E94;&#x7684;&#x4FE1;&#x53F7;&#x53D1;&#x9001;&#x7ED9;&#x524D;&#x53F0;&#x8FDB;&#x7A0B;&#x7EC4;&#x7684;&#x6210;&#x5458;&#x3002;</p>
<p>&#x4ECE;&#x7406;&#x8BBA;&#x4E0A;&#x6765;&#x8BB2;&#xFF0C;&#x53EF;&#x80FD;&#x4F1A;&#x51FA;&#x73B0;&#x4E00;&#x4E2A;&#x4F1A;&#x8BDD;&#x6CA1;&#x6709;&#x524D;&#x53F0;&#x8FDB;&#x7A0B;&#x7EC4;&#x7684;&#x60C5;&#x51B5;&#x3002;&#x5982;&#x5F53;&#x524D;&#x53F0;&#x8FDB;&#x7A0B;&#x7EC4;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x8FDB;&#x7A0B;&#x90FD;&#x7EC8;&#x6B62;&#x5E76;&#x4E14;&#x6CA1;&#x6709;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x6CE8;&#x610F;&#x5230;&#x8FD9;&#x4E2A;&#x4E8B;&#x5B9E;&#x800C;&#x5C06;&#x81EA;&#x5DF1;&#x79FB;&#x52A8;&#x5230;&#x524D;&#x53F0;&#x65F6;&#x5C31;&#x4F1A;&#x51FA;&#x73B0;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x3002;&#x4F46;&#x5728;&#x5B9E;&#x8DF5;&#x4E2D;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x662F;&#x6BD4;&#x8F83;&#x5C11;&#x89C1;&#x7684;&#x3002;&#x901A;&#x5E38;shell&#x8FDB;&#x7A0B;&#x4F1A;&#x76D1;&#x63A7;&#x524D;&#x53F0;&#x8FDB;&#x7A0B;&#x7EC4;&#x7684;&#x72B6;&#x6001;&#xFF0C;&#x5F53;&#x5B83;&#x6CE8;&#x610F;&#x5230;&#x524D;&#x53F0;&#x8FDB;&#x7A0B;&#x7EC4;&#x7ED3;&#x675F;&#x4E4B;&#x540E;&#xFF08;&#x901A;&#x8FC7;wait()&#xFF09;&#x4F1A;&#x5C06;&#x81EA;&#x5DF1;&#x79FB;&#x52A8;&#x5230;&#x524D;&#x53F0;&#x3002;</p>
<p>tcgetpgrp()&#x548C;tcsetpgrp()&#x51FD;&#x6570;&#x5206;&#x522B;&#x83B7;&#x53D6;&#x548C;&#x4FEE;&#x6539;&#x4E00;&#x4E2A;&#x7EC8;&#x7AEF;&#x7684;&#x8FDB;&#x7A0B;&#x7EC4;&#x3002;&#x8FD9;&#x4E9B;&#x51FD;&#x6570;&#x4E3B;&#x8981;&#x4F9B;&#x4EFB;&#x52A1;&#x63A7;&#x5236;shell&#x4F7F;&#x7528;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;unistd.h&gt;</span></span>

pid_t <span class="token function">tcgetpgrp</span><span class="token punctuation">(</span><span class="token keyword">int</span> fd<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">tcsetpgrp</span><span class="token punctuation">(</span><span class="token keyword">int</span> fd<span class="token punctuation">,</span>pid_t pgid<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>tcgetpgrp()&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;fd&#x6240;&#x6307;&#x5B9A;&#x7684;&#x7EC8;&#x7AEF;&#x7684;&#x524D;&#x53F0;&#x8FDB;&#x7A0B;&#x7EC4;&#x7684;&#x8FDB;&#x7A0B;&#x7EC4;ID&#xFF0C;&#x8BE5;&#x7EC8;&#x7AEF;&#x5FC5;&#x987B;&#x662F;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x7684;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x3002;<br>&#x5982;&#x679C;&#x8FD9;&#x4E2A;&#x7EC8;&#x7AEF;&#x6CA1;&#x6709;&#x524D;&#x53F0;&#x8FDB;&#x7A0B;&#x7EC4;&#xFF0C;&#x90A3;&#x4E48;tcgetpgrp()&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x5927;&#x4E8E;1&#x5E76;&#x4E14;&#x4E0E;&#x6240;&#x6709;&#x65E2;&#x6709;&#x8FDB;&#x7A0B;&#x7EC4;ID&#x90FD;&#x4E0D;&#x5339;&#x914D;&#x7684;&#x503C;&#x3002;&#xFF08;SUSv3&#x89C4;&#x5B9A;&#x4E86;&#x8FD9;&#x79CD;&#x884C;&#x4E3A;&#x3002;&#xFF09;<br>tcsetpgrp()&#x51FD;&#x6570;&#x4FEE;&#x6539;&#x4E00;&#x4E2A;&#x7EC8;&#x7AEF;&#x7684;&#x524D;&#x53F0;&#x8FDB;&#x7A0B;&#x7EC4;&#x3002;&#x5982;&#x679C;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x62E5;&#x6709;&#x4E00;&#x4E2A;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#xFF0C;&#x90A3;&#x4E48;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;fd&#x5F15;&#x7528;&#x7684;&#x5C31;&#x662F;&#x90A3;&#x4E2A;&#x7EC8;&#x7AEF;&#xFF0C;&#x63A5;&#x7740;tcsetpgrp()&#x4F1A;&#x5C06;&#x7EC8;&#x7AEF;&#x7684;&#x524D;&#x53F0;&#x8FDB;&#x7A0B;&#x7EC4;&#x8BBE;&#x7F6E;&#x4E3A;pgid&#x53C2;&#x6570;&#x6307;&#x5B9A;&#x7684;&#x8FDB;&#x7A0B;&#x7EC4;&#xFF0C;&#x8BE5;&#x53C2;&#x6570;&#x5FC5;&#x987B;&#x4E0E;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x6240;&#x5C5E;&#x7684;&#x4F1A;&#x8BDD;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7684;&#x8FDB;&#x7A0B;&#x7EC4;ID&#x5339;&#x914D;&#x3002;</p>
<p>tcgetpgrp() &#x548C; tcsetpgrp()&#x5728;SUSv3&#x4E2D;&#x90FD;&#x88AB;&#x6807;&#x51C6;&#x5316;&#x4E86;&#x3002;&#x5728;Linux&#x4E0A;&#xFF0C;&#x4E0E;&#x5F88;&#x591A;&#x5176;&#x4ED6;UNIX&#x5B9E;&#x73B0;&#x4E00;&#x6837;&#xFF0C;&#x8FD9;&#x4E9B;&#x51FD;&#x6570;&#x662F;&#x901A;&#x8FC7;&#x4E24;&#x4E2A;&#x975E;&#x6807;&#x51C6;&#x7684;ioctl()&#x64CD;&#x4F5C;&#x6765;&#x5B9E;&#x73B0;&#x7684;&#xFF0C;&#x5373;TIOCGPGRP&#x548C;TIOCSPGRP&#x3002;</p>
<h2 id="SIGHUP&#x4FE1;&#x53F7;"><a href="#SIGHUP&#x4FE1;&#x53F7;" class="headerlink" title="SIGHUP&#x4FE1;&#x53F7;"></a>SIGHUP&#x4FE1;&#x53F7;</h2><p>&#x5F53;&#x4E00;&#x4E2A;&#x63A7;&#x5236;&#x8FDB;&#x7A0B;&#x5931;&#x53BB;&#x5176;&#x7EC8;&#x7AEF;&#x8FDE;&#x63A5;&#x4E4B;&#x540E;&#xFF0C;&#x5185;&#x6838;&#x4F1A;&#x5411;&#x5176;&#x53D1;&#x9001;&#x4E00;&#x4E2A;SIGHUP&#x4FE1;&#x53F7;&#x6765;&#x901A;&#x77E5;&#x5B83;&#x8FD9;&#x4E00;&#x4E8B;&#x5B9E;&#x3002;&#xFF08;&#x8FD8;&#x4F1A;&#x53D1;&#x9001;&#x4E00;&#x4E2A;SIGCONT&#x4FE1;&#x53F7;&#x4EE5;&#x786E;&#x4FDD;&#x5F53;&#x8BE5;&#x8FDB;&#x7A0B;&#x4E4B;&#x524D;&#x88AB;&#x4E00;&#x4E2A;&#x4FE1;&#x53F7;&#x505C;&#x6B62;&#x65F6;&#x91CD;&#x65B0;&#x5F00;&#x59CB;&#x8BE5;&#x8FDB;&#x7A0B;&#x3002;&#xFF09;&#x4E00;&#x822C;&#x6765;&#x8BB2;&#xFF0C;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x53EF;&#x80FD;&#x4F1A;&#x5728;&#x4E0B;&#x9762;&#x4E24;&#x4E2A;&#x573A;&#x666F;&#x4E2D;&#x51FA;&#x73B0;&#x3002;</p>
<ul>
<li>&#x5F53;&#x7EC8;&#x7AEF;&#x9A71;&#x52A8;&#x5668;&#x68C0;&#x6D4B;&#x5230;&#x8FDE;&#x63A5;&#x65AD;&#x5F00;&#x540E;&#xFF0C;&#x8868;&#x660E;&#x8C03;&#x5236;&#x89E3;&#x8C03;&#x5668;&#x6216;&#x7EC8;&#x7AEF;&#x884C;&#x4E0A;&#x4FE1;&#x53F7;&#x7684;&#x4E22;&#x5931;&#x3002;</li>
<li>&#x5F53;&#x5DE5;&#x4F5C;&#x7AD9;&#x4E0A;&#x7684;&#x7EC8;&#x7AEF;&#x7A97;&#x53E3;&#x88AB;&#x5173;&#x95ED;&#x65F6;&#x3002;&#x53D1;&#x751F;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x662F;&#x56E0;&#x4E3A;&#x6700;&#x8FD1;&#x6253;&#x5F00;&#x7684;&#x4E0E;&#x7EC8;&#x7AEF;&#x7A97;&#x53E3;&#x5173;&#x8054;&#x7684;&#x4F2A;&#x7EC8;&#x7AEF;&#x7684;&#x4E3B;&#x4FA7;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x88AB;&#x5173;&#x95ED;&#x4E86;&#x3002;</li>
</ul>
<p>SIGHUP&#x4FE1;&#x53F7;&#x7684;&#x9ED8;&#x8BA4;&#x5904;&#x7406;&#x65B9;&#x5F0F;&#x662F;&#x7EC8;&#x6B62;&#x8FDB;&#x7A0B;&#x3002;&#x5982;&#x679C;&#x63A7;&#x5236;&#x8FDB;&#x7A0B;&#x5904;&#x7406;&#x4E86;&#x6216;&#x5FFD;&#x7565;&#x4E86;&#x8FD9;&#x4E2A;&#x4FE1;&#x53F7;&#xFF0C;&#x90A3;&#x4E48;&#x540E;&#x7EED;&#x5C1D;&#x8BD5;&#x4ECE;&#x7EC8;&#x7AEF;&#x4E2D;&#x8BFB;&#x53D6;&#x6570;&#x636E;&#x7684;&#x8BF7;&#x6C42;&#x5C31;&#x4F1A;&#x8FD4;&#x56DE;&#x6587;&#x4EF6;&#x7ED3;&#x675F;&#x7684;&#x9519;&#x8BEF;&#x3002;</p>
<p>SUSv3&#x58F0;&#x79F0;&#x5982;&#x679C;&#x7EC8;&#x7AEF;&#x65AD;&#x5F00;&#x53D1;&#x751F;&#x7684;&#x540C;&#x65F6;&#x8FD8;&#x6EE1;&#x8DB3;&#x8C03;&#x7528;read()&#x65F6;&#x629B;&#x51FA;EIO&#x9519;&#x8BEF;&#x7684;&#x6761;&#x4EF6;&#x7684;&#x8BDD;&#xFF0C;&#x90A3;&#x4E48;&#x8C03;&#x7528;read()&#x65E2;&#x6709;&#x53EF;&#x80FD;&#x8FD4;&#x56DE;&#x6587;&#x4EF6;&#x7ED3;&#x675F;&#xFF0C;&#x4E5F;&#x6709;&#x53EF;&#x80FD;&#x8FD4;&#x56DE;EIO&#x9519;&#x8BEF;&#x3002;&#x53EF;&#x79FB;&#x690D;&#x7684;&#x7A0B;&#x5E8F;&#x5FC5;&#x987B;&#x8981;&#x5904;&#x7406;&#x597D;&#x8FD9;&#x4E24;&#x79CD;&#x60C5;&#x51B5;&#x3002;</p>
<p>&#x5411;&#x63A7;&#x5236;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;SIGHUP&#x4FE1;&#x53F7;&#x4F1A;&#x5F15;&#x8D77;&#x4E00;&#x79CD;&#x94FE;&#x5F0F;&#x53CD;&#x5E94;&#xFF0C;&#x4ECE;&#x800C;&#x5BFC;&#x81F4;&#x5C06;SIGHUP&#x4FE1;&#x53F7;&#x53D1;&#x9001;&#x7ED9;&#x5F88;&#x591A;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x3002;&#x8FD9;&#x4E2A;&#x8FC7;&#x7A0B;&#x53EF;&#x80FD;&#x4F1A;&#x4EE5;&#x4E0B;&#x5217;&#x4E24;&#x79CD;&#x65B9;&#x5F0F;&#x53D1;&#x751F;&#x3002;</p>
<ul>
<li>&#x63A7;&#x5236;&#x8FDB;&#x7A0B;&#x901A;&#x5E38;&#x662F;&#x4E00;&#x4E2A;shell&#x3002;shell&#x5EFA;&#x7ACB;&#x4E86;&#x4E00;&#x4E2A;SIGHUP&#x4FE1;&#x53F7;&#x7684;&#x5904;&#x7406;&#x5668;&#xFF0C;&#x8FD9;&#x6837;&#x5728;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#x4E4B;&#x524D;&#xFF0C;&#x5B83;&#x80FD;&#x591F;&#x5C06;SIGHUP&#x4FE1;&#x53F7;&#x53D1;&#x9001;&#x7ED9;&#x7531;&#x5B83;&#x6240;&#x521B;&#x5EFA;&#x7684;&#x5404;&#x4E2A;&#x4EFB;&#x52A1;&#x3002;&#x5728;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x8FD9;&#x4E2A;&#x4FE1;&#x53F7;&#x4F1A;&#x7EC8;&#x6B62;&#x90A3;&#x4E9B;&#x4EFB;&#x52A1;&#xFF0C;&#x4F46;&#x5982;&#x679C;&#x5B83;&#x4EEC;&#x6355;&#x83B7;&#x4E86;&#x8FD9;&#x4E2A;&#x4FE1;&#x53F7;&#xFF0C;&#x5C31;&#x80FD;&#x77E5;&#x9053;shell&#x8FDB;&#x7A0B;&#x5DF2;&#x7ECF;&#x7EC8;&#x6B62;&#x4E86;&#x3002;</li>
<li>&#x5728;&#x7EC8;&#x6B62;&#x7EC8;&#x7AEF;&#x7684;&#x63A7;&#x5236;&#x8FDB;&#x7A0B;&#x65F6;&#xFF0C;&#x5185;&#x6838;&#x4F1A;&#x89E3;&#x9664;&#x4F1A;&#x8BDD;&#x4E2D;&#x6240;&#x6709;&#x8FDB;&#x7A0B;&#x4E0E;&#x8BE5;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x8054;&#x5173;&#x7CFB;&#x4EE5;&#x53CA;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x4E0E;&#x8BE5;&#x4F1A;&#x8BDD;&#x7684;&#x5173;&#x8054;&#x5173;&#x7CFB;&#xFF08;&#x56E0;&#x6B64;&#x53E6;&#x4E00;&#x4E2A;&#x4F1A;&#x8BDD;&#x9996;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x8BF7;&#x6C42;&#x8BE5;&#x7EC8;&#x7AEF;&#x6210;&#x4E3A;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x4E86;&#xFF09;&#xFF0C;&#x5E76;&#x4E14;&#x901A;&#x8FC7;&#x5411;&#x8BE5;&#x7EC8;&#x7AEF;&#x7684;&#x524D;&#x53F0;&#x8FDB;&#x7A0B;&#x7EC4;&#x7684;&#x6210;&#x5458;&#x53D1;&#x9001;SIGHUP&#x4FE1;&#x53F7;&#x6765;&#x901A;&#x77E5;&#x5B83;&#x4EEC;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x7684;&#x4E22;&#x5931;&#x3002;</li>
</ul>
<h3 id="&#x5728;shell&#x4E2D;&#x5904;&#x7406;SIGHUP&#x4FE1;&#x53F7;"><a href="#&#x5728;shell&#x4E2D;&#x5904;&#x7406;SIGHUP&#x4FE1;&#x53F7;" class="headerlink" title="&#x5728;shell&#x4E2D;&#x5904;&#x7406;SIGHUP&#x4FE1;&#x53F7;"></a>&#x5728;shell&#x4E2D;&#x5904;&#x7406;SIGHUP&#x4FE1;&#x53F7;</h3><p>&#x5728;&#x767B;&#x5F55;&#x4F1A;&#x8BDD;&#x4E2D;&#xFF0C;shell&#x901A;&#x5E38;&#x662F;&#x7EC8;&#x7AEF;&#x7684;&#x63A7;&#x5236;&#x8FDB;&#x7A0B;&#x3002;&#x5927;&#x591A;&#x6570;shell&#x7A0B;&#x5E8F;&#x5728;&#x4EA4;&#x4E92;&#x5F0F;&#x8FD0;&#x884C;&#x65F6;&#x4F1A;&#x4E3A;SIGHUP&#x4FE1;&#x53F7;&#x5EFA;&#x7ACB;&#x4E00;&#x4E2A;&#x5904;&#x7406;&#x5668;&#x3002;&#x8FD9;&#x4E2A;&#x5904;&#x7406;&#x5668;&#x4F1A;&#x7EC8;&#x6B62;shell&#xFF0C;&#x4F46;&#x5728;&#x7EC8;&#x6B62;&#x4E4B;&#x524D;&#x4F1A;&#x5411;&#x7531;shell&#x521B;&#x5EFA;&#x7684;&#x5404;&#x4E2A;&#x8FDB;&#x7A0B;&#x7EC4;&#xFF08;&#x5305;&#x62EC;&#x524D;&#x53F0;&#x548C;&#x540E;&#x53F0;&#x8FDB;&#x7A0B;&#x7EC4;&#xFF09;&#x53D1;&#x9001;&#x4E00;&#x4E2A;SIGHUP&#x4FE1;&#x53F7;&#x3002;&#xFF08;&#x5728;SIGHUP&#x4FE1;&#x53F7;&#x4E4B;&#x540E;&#x53EF;&#x80FD;&#x4F1A;&#x53D1;&#x9001;&#x4E00;&#x4E2A;SIGCONT&#x4FE1;&#x53F7;&#xFF0C;&#x8FD9;&#x4F9D;&#x8D56;&#x4E8E;shell&#x672C;&#x8EAB;&#x4EE5;&#x53CA;&#x4EFB;&#x52A1;&#x5F53;&#x524D;&#x662F;&#x5426;&#x5904;&#x4E8E;&#x505C;&#x6B62;&#x72B6;&#x6001;&#x3002;&#xFF09;&#x81F3;&#x4E8E;&#x8FD9;&#x4E9B;&#x7EC4;&#x4E2D;&#x7684;&#x8FDB;&#x7A0B;&#x5982;&#x4F55;&#x54CD;&#x5E94;SIGHUP&#x4FE1;&#x53F7;&#x5219;&#x9700;&#x8981;&#x6839;&#x636E;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x5177;&#x4F53;&#x9700;&#x6C42;&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x91C7;&#x53D6;&#x7279;&#x6B8A;&#x7684;&#x52A8;&#x4F5C;&#xFF0C;&#x90A3;&#x4E48;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#x5C06;&#x4F1A;&#x7EC8;&#x6B62;&#x8FDB;&#x7A0B;&#x3002;</p>
<p>&#x4E00;&#x4E9B;&#x4EFB;&#x52A1;&#x63A7;&#x5236;shell&#x5728;&#x6B63;&#x5E38;&#x9000;&#x51FA;&#xFF08;&#x5982;&#x767B;&#x51FA;&#x6216;&#x5728;shell&#x7A97;&#x53E3;&#x4E2D;&#x63A5;&#x4E0B;Control-D&#xFF09;&#x65F6;&#x4E5F;&#x4F1A;&#x53D1;&#x9001;SIGHUP&#x4FE1;&#x53F7;&#x6765;&#x505C;&#x6B62;&#x540E;&#x53F0;&#x4EFB;&#x52A1;&#x3002;bash&#x548C;Korn shell&#x90FD;&#x91C7;&#x53D6;&#x4E86;&#x8FD9;&#x79CD;&#x5904;&#x7406;&#x65B9;&#x5F0F;&#xFF08;&#x5728;&#x9996;&#x6B21;&#x767B;&#x51FA;&#x5C1D;&#x8BD5;&#x65F6;&#x6253;&#x5370;&#x51FA;&#x4E00;&#x6761;&#x6D88;&#x606F;&#x4E4B;&#x540E;&#xFF09;&#x3002;</p>
<p>nohup(1)&#x547D;&#x4EE4;&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x4F7F;&#x4E00;&#x4E2A;&#x547D;&#x4EE4;&#x5BF9;SIGHUP&#x4FE1;&#x53F7;&#x514D;&#x75AB;&#x2014;&#x2014;&#x5373;&#x6267;&#x884C;&#x547D;&#x4EE4;&#x65F6;&#x5C06;SIGHUP&#x4FE1;&#x53F7;&#x7684;&#x5904;&#x7406;&#x8BBE;&#x7F6E;&#x4E3A;SIG_IGN&#x3002;bash&#x5185;&#x7F6E;&#x7684;&#x547D;&#x4EE4;disown&#x63D0;&#x4F9B;&#x4E86;&#x7C7B;&#x4F3C;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x5B83;&#x4ECE;shell&#x7684;&#x4EFB;&#x52A1;&#x5217;&#x8868;&#x4E2D;&#x5220;&#x9664;&#x4E00;&#x4E2A;&#x4EFB;&#x52A1;&#xFF0C;&#x8FD9;&#x6837;&#x5728;shell&#x7EC8;&#x6B62;&#x65F6;&#x5C31;&#x4E0D;&#x4F1A;&#x5411;&#x8BE5;&#x4EFB;&#x52A1;&#x53D1;&#x9001;SIGHUP&#x4FE1;&#x53F7;&#x4E86;&#x3002;</p>
<h3 id="SIGHUP&#x548C;&#x63A7;&#x5236;&#x8FDB;&#x7A0B;&#x7684;&#x7EC8;&#x6B62;"><a href="#SIGHUP&#x548C;&#x63A7;&#x5236;&#x8FDB;&#x7A0B;&#x7684;&#x7EC8;&#x6B62;" class="headerlink" title="SIGHUP&#x548C;&#x63A7;&#x5236;&#x8FDB;&#x7A0B;&#x7684;&#x7EC8;&#x6B62;"></a>SIGHUP&#x548C;&#x63A7;&#x5236;&#x8FDB;&#x7A0B;&#x7684;&#x7EC8;&#x6B62;</h3><p>&#x5982;&#x679C;&#x56E0;&#x4E3A;&#x7EC8;&#x7AEF;&#x65AD;&#x5F00;&#x5F15;&#x8D77;&#x7684;&#x5411;&#x63A7;&#x5236;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;&#x7684;SIGHUP&#x4FE1;&#x53F7;&#x4F1A;&#x5BFC;&#x81F4;&#x63A7;&#x5236;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#xFF0C;&#x90A3;&#x4E48;SIGHUP&#x4FE1;&#x53F7;&#x4F1A;&#x88AB;&#x53D1;&#x9001;&#x7ED9;&#x7EC8;&#x7AEF;&#x7684;&#x524D;&#x53F0;&#x8FDB;&#x7A0B;&#x7EC4;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x6210;&#x5458;&#x3002;&#x8FD9;&#x4E2A;&#x884C;&#x4E3A;&#x662F;&#x63A7;&#x5236;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#x7684;&#x7ED3;&#x679C;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x4E13;&#x95E8;&#x4E0E;SIGHUP&#x4FE1;&#x53F7;&#x5173;&#x8054;&#x7684;&#x884C;&#x4E3A;&#x3002;&#x5982;&#x679C;&#x63A7;&#x5236;&#x8FDB;&#x7A0B;&#x51FA;&#x4E8E;&#x4EFB;&#x4F55;&#x539F;&#x56E0;&#x7EC8;&#x6B62;&#xFF0C;&#x90A3;&#x4E48;&#x524D;&#x53F0;&#x8FDB;&#x7A0B;&#x7EC4;&#x5C31;&#x4F1A;&#x6536;&#x5230;SIGHUP&#x4FE1;&#x53F7;&#x3002;</p>
<p>&#x5728;Linux&#x4E0A;&#xFF0C;SIGHUP&#x4FE1;&#x53F7;&#x540E;&#x9762;&#x4F1A;&#x8DDF;&#x7740;&#x4E00;&#x4E2A;SIGCONT&#x4FE1;&#x53F7;&#x4EE5;&#x786E;&#x4FDD;&#x5728;&#x8FDB;&#x7A0B;&#x7EC4;&#x4E4B;&#x524D;&#x88AB;&#x4E00;&#x4E2A;&#x4FE1;&#x53F7;&#x505C;&#x6B62;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x6062;&#x590D;&#x8BE5;&#x8FDB;&#x7A0B;&#x7EC4;&#x3002;&#x4F46;SUSv3&#x5E76;&#x6CA1;&#x6709;&#x6307;&#x5B9A;&#x8FD9;&#x79CD;&#x884C;&#x4E3A;&#xFF0C;&#x5E76;&#x4E14;&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#x5927;&#x591A;&#x6570;&#x5176;&#x4ED6;UNIX&#x5B9E;&#x73B0;&#x4E0D;&#x4F1A;&#x53D1;&#x9001;SIGCONT&#x4FE1;&#x53F7;&#x3002;</p>
<h2 id="&#x4F5C;&#x4E1A;&#x63A7;&#x5236;"><a href="#&#x4F5C;&#x4E1A;&#x63A7;&#x5236;" class="headerlink" title="&#x4F5C;&#x4E1A;&#x63A7;&#x5236;"></a>&#x4F5C;&#x4E1A;&#x63A7;&#x5236;</h2><p>&#x4F5C;&#x4E1A;&#x63A7;&#x5236;&#x662F;&#x5728;1980&#x5E74;&#x5DE6;&#x53F3;&#x7531;BSD&#x7CFB;&#x7EDF;&#x4E0A;&#x7684;C shell&#x9996;&#x6B21;&#x63A8;&#x51FA;&#x7684;&#x7279;&#x6027;&#x3002;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;&#x5141;&#x8BB8;&#x4E00;&#x4E2A;shell&#x7528;&#x6237;&#x540C;&#x65F6;&#x6267;&#x884C;&#x591A;&#x4E2A;&#x547D;&#x4EE4;&#xFF08;&#x4F5C;&#x4E1A;&#xFF09;&#xFF0C;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x547D;&#x4EE4;&#x5728;&#x524D;&#x53F0;&#x8FD0;&#x884C;&#xFF0C;&#x5176;&#x4F59;&#x7684;&#x547D;&#x4EE4;&#x5728;&#x540E;&#x53F0;&#x8FD0;&#x884C;&#x3002;&#x4F5C;&#x4E1A;&#x53EF;&#x4EE5;&#x88AB;&#x505C;&#x6B62;&#x548C;&#x6062;&#x590D;&#x4EE5;&#x53CA;&#x5728;&#x524D;&#x540E;&#x53F0;&#x4E4B;&#x95F4;&#x79FB;&#x52A8;.</p>
<p>&#x5728;&#x521D;&#x59CB;&#x7684;POSIX.1&#x6807;&#x51C6;&#x4E2D;&#xFF0C;&#x5BF9;&#x4F5C;&#x4E1A;&#x7684;&#x652F;&#x6301;&#x662F;&#x53EF;&#x9009;&#x7684;&#x3002;&#x540E;&#x9762;&#x7684;UNIX&#x6807;&#x51C6;&#x4F7F;&#x8FD9;&#x4E2A;&#x529F;&#x80FD;&#x6210;&#x4E3A;&#x4E86;&#x5FC5;&#x5907;&#x529F;&#x80FD;&#x3002;</p>
<p>&#x5728;&#x57FA;&#x4E8E;&#x5B57;&#x7B26;&#x7684;&#x54D1;&#x7EC8;&#x7AEF;&#x76DB;&#x884C;&#x7684;&#x5E74;&#x4EE3;&#xFF08;&#x7269;&#x7406;&#x7EC8;&#x7AEF;&#x8BBE;&#x5907;&#x53EA;&#x80FD;&#x663E;&#x793A;ASCII&#x5B57;&#x7B26;&#xFF09;&#xFF0C;&#x5F88;&#x591A;shell&#x7528;&#x6237;&#x90FD;&#x77E5;&#x9053;&#x5982;&#x4F55;&#x4F7F;&#x7528;shell&#x4F5C;&#x4E1A;&#x63A7;&#x5236;&#x547D;&#x4EE4;&#x3002;&#x5728;&#x8FD0;&#x884C;X Window System&#x7684;&#x4F4D;&#x56FE;&#x663E;&#x793A;&#x5668;&#x51FA;&#x73B0;&#x4E4B;&#x540E;&#xFF0C;&#x719F;&#x6089;shell&#x4F5C;&#x4E1A;&#x63A7;&#x5236;&#x7684;&#x4EBA;&#x5C31;&#x8D8A;&#x6765;&#x8D8A;&#x5C11;&#x4E86;&#xFF0C;&#x4F46;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;&#x4ECD;&#x7136;&#x662F;&#x4E00;&#x9879;&#x975E;&#x5E38;&#x6709;&#x7528;&#x7684;&#x7279;&#x6027;&#x3002;&#x4F7F;&#x7528;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;&#x7BA1;&#x7406;&#x591A;&#x4E2A;&#x540C;&#x65F6;&#x6267;&#x884C;&#x7684;&#x547D;&#x4EE4;&#x6BD4;&#x5728;&#x51E0;&#x4E2A;&#x7A97;&#x53E3;&#x4E4B;&#x95F4;&#x6765;&#x56DE;&#x5207;&#x6362;&#x66F4;&#x5FEB;&#x901F;&#x548C;&#x7B80;&#x5355;&#x3002;</p>
<h3 id="&#x5728;shell&#x4E2D;&#x4F7F;&#x7528;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;"><a href="#&#x5728;shell&#x4E2D;&#x4F7F;&#x7528;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;" class="headerlink" title="&#x5728;shell&#x4E2D;&#x4F7F;&#x7528;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;"></a>&#x5728;shell&#x4E2D;&#x4F7F;&#x7528;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;</h3><p>&#x5F53;&#x8F93;&#x5165;&#x7684;&#x547D;&#x4EE4;&#x4EE5;&amp;&#x7B26;&#x53F7;&#x7ED3;&#x675F;&#x65F6;&#xFF0C;&#x8BE5;&#x547D;&#x4EE4;&#x4F1A;&#x4F5C;&#x4E3A;&#x540E;&#x53F0;&#x4EFB;&#x52A1;&#x8FD0;&#x884C;&#xFF0C;&#x5982;&#x4E0B;&#x9762;&#x7684;&#x793A;&#x4F8B;&#x6240;&#x793A;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">grep</span> -r SIGHUP /usr/src/linux <span class="token operator">&gt;</span>x <span class="token operator">&amp;</span>
<span class="token punctuation">[</span>1<span class="token punctuation">]</span> 18932
$ <span class="token function">sleep</span> 60 <span class="token operator">&amp;</span>
<span class="token punctuation">[</span>2<span class="token punctuation">]</span> 18934<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>shell&#x4F1A;&#x4E3A;&#x540E;&#x53F0;&#x7684;&#x6BCF;&#x4E2A;&#x8FDB;&#x7A0B;&#x8D4B;&#x4E00;&#x4E2A;&#x552F;&#x4E00;&#x7684;&#x4F5C;&#x4E1A;&#x53F7;&#x3002;&#x5F53;&#x4F5C;&#x4E1A;&#x5728;&#x540E;&#x53F0;&#x8FD0;&#x884C;&#x4E4B;&#x540E;&#x4EE5;&#x53CA;&#x5728;&#x4F7F;&#x7528;&#x5404;&#x79CD;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;&#x547D;&#x4EE4;&#x64CD;&#x4F5C;&#x6216;&#x76D1;&#x63A7;&#x4F5C;&#x4E1A;&#x65F6;&#x4F5C;&#x4E1A;&#x53F7;&#x4F1A;&#x663E;&#x793A;&#x5728;&#x65B9;&#x62EC;&#x53F7;&#x4E2D;&#x3002;&#x4F5C;&#x4E1A;&#x53F7;&#x540E;&#x9762;&#x7684;&#x6570;&#x5B57;&#x662F;&#x6267;&#x884C;&#x8FD9;&#x4E2A;&#x547D;&#x4EE4;&#x7684;&#x8FDB;&#x7A0B;&#x7684;&#x8FDB;&#x7A0B;ID&#x6216;&#x7BA1;&#x9053;&#x4E2D;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7684;&#x8FDB;&#x7A0B;ID&#x3002;&#x5728;&#x540E;&#x9762;&#x51E0;&#x4E2A;&#x6BB5;&#x843D;&#x4E2D;&#x4ECB;&#x7ECD;&#x7684;&#x547D;&#x4EE4;&#x4E2D;&#x4F1A;&#x4F7F;&#x7528;%num&#x6765;&#x5F15;&#x7528;&#x4F5C;&#x4E1A;&#xFF0C;&#x5176;&#x4E2D;num&#x662F;shell&#x8D4B;&#x7ED9;&#x4F5C;&#x4E1A;&#x7684;&#x4F5C;&#x4E1A;&#x53F7;&#x3002;</p>
<p>&#x5728;&#x5F88;&#x591A;&#x60C5;&#x51B5;&#x4E0B;&#x662F;&#x53EF;&#x4EE5;&#x7701;&#x7565;%num&#x7684;&#xFF0C;&#x5F53;&#x7701;&#x7565;%num&#x65F6;&#x9ED8;&#x8BA4;&#x6307;&#x5F53;&#x524D;&#x4F5C;&#x4E1A;&#x3002;&#x5F53;&#x524D;&#x4F5C;&#x4E1A;&#x662F;&#x5728;&#x524D;&#x53F0;&#x6700;&#x65B0;&#x88AB;&#x505C;&#x6B62;&#x7684;&#x4F5C;&#x4E1A;&#xFF08;&#x4F7F;&#x7528;&#x4E0B;&#x9762;&#x4ECB;&#x7ECD;&#x7684;&#x6302;&#x8D77;&#x5B57;&#x7B26;&#xFF09;&#x6216;&#x8005;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x8FD9;&#x6837;&#x7684;&#x4F5C;&#x4E1A;&#x7684;&#x8BDD;&#xFF0C;&#x6700;&#x65B0;&#x4F5C;&#x4E1A;&#x662F;&#x5728;&#x540E;&#x53F0;&#x542F;&#x52A8;&#x7684;&#x4EFB;&#x52A1;&#x3002;&#xFF08;&#x4E0D;&#x540C;shell&#x786E;&#x5B9A;&#x54EA;&#x4E2A;&#x540E;&#x53F0;&#x4F5C;&#x4E1A;&#x4E3A;&#x5F53;&#x524D;&#x4F5C;&#x4E1A;&#x7684;&#x7EC6;&#x8282;&#x65B9;&#x9762;&#x7A0D;&#x5FAE;&#x6709;&#x4E9B;&#x4E0D;&#x540C;&#x3002;&#xFF09;&#x53E6;&#x5916;&#xFF0C;%%&#x548C;%+&#x7B26;&#x53F7;&#x6307;&#x7684;&#x662F;&#x5F53;&#x524D;&#x4F5C;&#x4E1A;&#xFF0C;%&#x2212;&#x7B26;&#x53F7;&#x6307;&#x7684;&#x662F;&#x4E0A;&#x4E00;&#x4E2A;&#x5F53;&#x524D;&#x4F5C;&#x4E1A;&#x3002;&#x5728;jobs&#x547D;&#x4EE4;&#x7684;&#x8F93;&#x51FA;&#x4E2D;&#xFF0C;&#x5F53;&#x524D;&#x7684;&#x548C;&#x4E0A;&#x4E00;&#x4E2A;&#x5F53;&#x524D;&#x4F5C;&#x4E1A;&#x5206;&#x522B;&#x7528;&#x52A0;&#x53F7;&#xFF08;+&#xFF09;&#x548C;&#x51CF;&#x53F7;&#xFF08;&#x2212;&#xFF09;&#x6807;&#x8BB0;.</p>
<p>jobs&#x662F;shell&#x5185;&#x7F6E;&#x7684;&#x4E00;&#x4E2A;&#x547D;&#x4EE4;&#xFF0C;&#x5B83;&#x4F1A;&#x5217;&#x51FA;&#x6240;&#x6709;&#x540E;&#x53F0;&#x4F5C;&#x4E1A;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">jobs</span>
<span class="token punctuation">[</span>1<span class="token punctuation">]</span>- Running        <span class="token function">grep</span> -r SIGHUP /usr/src/linux <span class="token operator">&gt;</span>x <span class="token operator">&amp;</span>
<span class="token punctuation">[</span>2<span class="token punctuation">]</span>+ Running        <span class="token function">sleep</span> 60 <span class="token operator">&amp;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x5728;&#x8FD9;&#x4E2A;&#x65F6;&#x523B;&#xFF0C;shell&#x662F;&#x7EC8;&#x7AEF;&#x7684;&#x524D;&#x53F0;&#x8FDB;&#x7A0B;&#x3002;&#x7531;&#x4E8E;&#x4EC5;&#x6709;&#x4E00;&#x4E2A;&#x524D;&#x53F0;&#x8FDB;&#x7A0B;&#x80FD;&#x591F;&#x4ECE;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x8BFB;&#x53D6;&#x8F93;&#x5165;&#x548C;&#x63A5;&#x6536;&#x7EC8;&#x7AEF;&#x751F;&#x6210;&#x7684;&#x4FE1;&#x53F7;&#xFF0C;&#x56E0;&#x6B64;&#x6709;&#x65F6;&#x5019;&#x9700;&#x8981;&#x5C06;&#x540E;&#x53F0;&#x4F5C;&#x4E1A;&#x79FB;&#x52A8;&#x5230;&#x524D;&#x53F0;&#x3002;&#x8FD9;&#x662F;&#x901A;&#x8FC7;fg&#x8FD9;&#x4E2A;shell&#x5185;&#x7F6E;&#x547D;&#x4EE4;&#x6765;&#x5B8C;&#x6210;&#x7684;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">fg</span> %1
<span class="token function">grep</span> -r SIGHUP /usr/src/linux <span class="token operator">&gt;</span>x<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x4ECE;&#x4E0A;&#x9762;&#x7684;&#x793A;&#x4F8B;&#x4E2D;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF0C;&#x5F53;&#x5728;&#x524D;&#x540E;&#x53F0;&#x4E4B;&#x95F4;&#x79FB;&#x52A8;&#x4F5C;&#x4E1A;&#x65F6;shell&#x4F1A;&#x91CD;&#x65B0;&#x6253;&#x5370;&#x51FA;&#x8BE5;&#x4F5C;&#x4E1A;&#x7684;&#x547D;&#x4EE4;&#x884C;&#x3002;&#x8BFB;&#x8005;&#x901A;&#x8FC7;&#x9605;&#x8BFB;&#x4E0B;&#x9762;&#x7684;&#x5185;&#x5BB9;&#x5C31;&#x4F1A;&#x53D1;&#x73B0;&#xFF0C;&#x5F53;&#x4F5C;&#x4E1A;&#x5728;&#x540E;&#x53F0;&#x7684;&#x72B6;&#x6001;&#x53D1;&#x751F;&#x53D8;&#x5316;&#x65F6;&#xFF0C;shell&#x4E5F;&#x4F1A;&#x91CD;&#x65B0;&#x6253;&#x5370;&#x8BE5;&#x4F5C;&#x4E1A;&#x7684;&#x547D;&#x4EE4;&#x884C;&#x3002;</p>
<p>&#x5F53;&#x4F5C;&#x4E1A;&#x5728;&#x524D;&#x53F0;&#x8FD0;&#x884C;&#x65F6;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x7EC8;&#x7AEF;&#x6302;&#x8D77;&#x5B57;&#x7B26;&#xFF08;&#x901A;&#x5E38;&#x662F;Control-Z&#xFF09;&#x6765;&#x6302;&#x8D77;&#x4F5C;&#x4E1A;&#xFF0C;&#x5B83;&#x4F1A;&#x5411;&#x7EC8;&#x7AEF;&#x7684;&#x524D;&#x53F0;&#x8FDB;&#x7A0B;&#x7EC4;&#x53D1;&#x9001;&#x4E00;&#x4E2A;SIGTSTP&#x4FE1;&#x53F7;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">Type Control-Z
<span class="token punctuation">[</span>1<span class="token punctuation">]</span>+ Stopped <span class="token function">grep</span> -r SIGHUP /usr/src/linux <span class="token operator">&gt;</span>x<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x5728;&#x6309;&#x4E0B;Control-Z&#x4E4B;&#x540E;&#xFF0C;shell&#x4F1A;&#x6253;&#x5370;&#x51FA;&#x5728;&#x540E;&#x53F0;&#x88AB;&#x505C;&#x6B62;&#x7684;&#x547D;&#x4EE4;&#x3002;&#x5982;&#x679C;&#x9700;&#x8981;&#x7684;&#x8BDD;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;fg&#x547D;&#x4EE4;&#x5728;&#x524D;&#x53F0;&#x6062;&#x590D;&#x8FD9;&#x4E2A;&#x4F5C;&#x4E1A;&#x6216;&#x4F7F;&#x7528;bg&#x547D;&#x4EE4;&#x5728;&#x540E;&#x53F0;&#x6062;&#x590D;&#x8FD9;&#x4E2A;&#x547D;&#x4EE4;&#x3002;&#x4E0D;&#x7BA1;&#x4F7F;&#x7528;&#x54EA;&#x4E2A;&#x547D;&#x4EE4;&#x6062;&#x590D;&#x4F5C;&#x4E1A;&#xFF0C;shell&#x90FD;&#x4F1A;&#x901A;&#x8FC7;&#x5411;&#x4EFB;&#x52A1;&#x53D1;&#x9001;&#x4E00;&#x4E2A;SIGCONT&#x4FE1;&#x53F7;&#x6765;&#x6062;&#x590D;&#x88AB;&#x505C;&#x6B62;&#x7684;&#x4F5C;&#x4E1A;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">bg</span> %1
<span class="token punctuation">[</span>1<span class="token punctuation">]</span>+ <span class="token function">grep</span> -r SIGHUP /usr/src/linux <span class="token operator">&gt;</span>x <span class="token operator">&amp;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x901A;&#x8FC7;&#x5411;&#x540E;&#x53F0;&#x4F5C;&#x4E1A;&#x53D1;&#x9001;&#x4E00;&#x4E2A;SIGSTOP&#x4FE1;&#x53F7;&#x80FD;&#x591F;&#x505C;&#x6B62;&#x8BE5;&#x540E;&#x53F0;&#x4F5C;&#x4E1A;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">kill</span> -STOP %1
<span class="token punctuation">[</span>1<span class="token punctuation">]</span>+ Stopped <span class="token function">grep</span> -r SIGHUP /usr/src/linux <span class="token operator">&gt;</span>x <span class="token operator">&amp;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>Korn&#x548C;C shell&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x547D;&#x4EE4;stop&#x4F5C;&#x4E3A;kill-stop&#x5FEB;&#x6377;&#x65B9;&#x5F0F;&#x3002;</p>
<p>&#x5F53;&#x540E;&#x53F0;&#x4F5C;&#x4E1A;&#x6700;&#x540E;&#x6267;&#x884C;&#x7ED3;&#x675F;&#x4E4B;&#x540E;&#xFF0C;shell&#x4F1A;&#x5728;&#x6253;&#x5370;&#x4E0B;&#x4E00;&#x4E2A;shell&#x63D0;&#x793A;&#x7B26;&#x4E4B;&#x524D;&#x5148;&#x6253;&#x5370;&#x4E00;&#x6761;&#x6D88;&#x606F;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">jobs</span>
<span class="token punctuation">[</span>2<span class="token punctuation">]</span>+  Done                    <span class="token function">sleep</span> 60<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x53EA;&#x6709;&#x524D;&#x53F0;&#x4F5C;&#x4E1A;&#x4E2D;&#x7684;&#x8FDB;&#x7A0B;&#x624D;&#x80FD;&#x591F;&#x4ECE;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x4E2D;&#x8BFB;&#x53D6;&#x8F93;&#x5165;&#x3002;&#x8FD9;&#x4E2A;&#x9650;&#x5236;&#x6761;&#x4EF6;&#x907F;&#x514D;&#x4E86;&#x591A;&#x4E2A;&#x4F5C;&#x4E1A;&#x7ADE;&#x4E89;&#x8BFB;&#x53D6;&#x7EC8;&#x7AEF;&#x8F93;&#x5165;&#x3002;&#x5982;&#x679C;&#x540E;&#x53F0;&#x4F5C;&#x4E1A;&#x5C1D;&#x8BD5;&#x4ECE;&#x7EC8;&#x7AEF;&#x4E2D;&#x8BFB;&#x53D6;&#x8F93;&#x5165;&#xFF0C;&#x5C31;&#x4F1A;&#x63A5;&#x6536;&#x5230;&#x4E00;&#x4E2A;SIGTTIN&#x4FE1;&#x53F7;&#x3002;SIGTTIN&#x4FE1;&#x53F7;&#x7684;&#x9ED8;&#x8BA4;&#x5904;&#x7406;&#x52A8;&#x4F5C;&#x662F;&#x505C;&#x6B62;&#x4F5C;&#x4E1A;&#x3002;</p>
<p>&#x5728;&#x4E0A;&#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#x4EE5;&#x53CA;&#x540E;&#x9762;&#x7684;&#x51E0;&#x4E2A;&#x4F8B;&#x5B50;&#x4E2D;&#x53EF;&#x80FD;&#x4E0D;&#x9700;&#x8981;&#x6309;&#x4E0B;&#x56DE;&#x8F66;&#x952E;&#x5C31;&#x80FD;&#x770B;&#x5230;&#x4F5C;&#x4E1A;&#x72B6;&#x6001;&#x53D8;&#x66F4;&#x4FE1;&#x606F;&#x3002;&#x6839;&#x636E;&#x5185;&#x6838;&#x7684;&#x8C03;&#x5EA6;&#x51B3;&#x7B56;&#xFF0C;shell&#x53EF;&#x80FD;&#x4F1A;&#x5728;&#x6253;&#x5370;&#x4E0B;&#x4E00;&#x4E2A;shell&#x63D0;&#x793A;&#x7B26;&#x4E4B;&#x524D;&#x63A5;&#x6536;&#x5230;&#x6709;&#x5173;&#x540E;&#x53F0;&#x4F5C;&#x4E1A;&#x72B6;&#x6001;&#x53D8;&#x66F4;&#x7684;&#x901A;&#x77E5;&#x3002;</p>
<p>&#x73B0;&#x5728;&#x5FC5;&#x987B;&#x8981;&#x5C06;&#x4F5C;&#x4E1A;&#x79FB;&#x5230;&#x524D;&#x53F0;&#x6765;&#xFF08;fg&#xFF09;&#x5E76;&#x5411;&#x5176;&#x63D0;&#x4F9B;&#x6240;&#x9700;&#x7684;&#x8F93;&#x5165;&#x4E86;&#x3002;&#x5982;&#x679C;&#x9700;&#x8981;&#x7684;&#x8BDD;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5148;&#x6302;&#x8D77;&#x8BE5;&#x4F5C;&#x4E1A;&#x540E;&#x5728;&#x540E;&#x53F0;&#x6062;&#x590D;&#x8BE5;&#x4F5C;&#x4E1A;&#xFF08;bg&#xFF09;&#x7684;&#x65B9;&#x5F0F;&#x7EE7;&#x7EED;&#x8BE5;&#x4F5C;&#x4E1A;&#x7684;&#x6267;&#x884C;&#x3002;&#xFF08;&#x5F53;&#x7136;&#xFF0C;&#x5728;&#x8FD9;&#x4E2A;&#x7279;&#x5B9A;&#x7684;&#x4F8B;&#x5B50;&#x4E2D;&#xFF0C;cat&#x5C06;&#x4F1A;&#x518D;&#x6B21;&#x7ACB;&#x5373;&#x88AB;&#x505C;&#x6B62;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x4F1A;&#x518D;&#x6B21;&#x5C1D;&#x8BD5;&#x4ECE;&#x7EC8;&#x7AEF;&#x4E2D;&#x8BFB;&#x53D6;&#x8F93;&#x5165;&#x3002;&#xFF09;   </p>
<p>&#x5728;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x540E;&#x53F0;&#x4F5C;&#x4E1A;&#x662F;&#x88AB;&#x5141;&#x8BB8;&#x5411;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x8F93;&#x5165;&#x5185;&#x5BB9;&#x7684;&#x3002;&#x4F46;&#x5982;&#x679C;&#x7EC8;&#x7AEF;&#x8BBE;&#x7F6E;&#x4E86;TOSTOP&#x6807;&#x8BB0;&#xFF08;&#x7EC8;&#x7AEF;&#x8F93;&#x51FA;&#x505C;&#x6B62;&#xFF09;&#xFF0C;&#x90A3;&#x4E48;&#x5F53;&#x540E;&#x53F0;&#x4F5C;&#x4E1A;&#x5C1D;&#x8BD5;&#x5728;&#x7EC8;&#x7AEF;&#x4E0A;&#x8F93;&#x51FA;&#x65F6;&#x4F1A;&#x5BFC;&#x81F4;SIGTTOU&#x4FE1;&#x53F7;&#x7684;&#x4EA7;&#x751F;&#x3002;&#xFF08;&#x4F7F;&#x7528;stty&#x547D;&#x4EE4;&#x80FD;&#x591F;&#x8BBE;&#x7F6E;TOSTOP&#x6807;&#x5FD7;&#x3002;&#xFF09;&#x4E0E;SIGTTIN&#x4FE1;&#x53F7;&#x4E00;&#x6837;&#xFF0C;SIGTTOU&#x4FE1;&#x53F7;&#x4F1A;&#x505C;&#x6B62;&#x4F5C;&#x4E1A;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ stty tostop
$ <span class="token function">date</span> <span class="token operator">&amp;</span>
<span class="token punctuation">[</span>1<span class="token punctuation">]</span> 28626
<span class="token comment" spellcheck="true"># &#x56DE;&#x8F66; </span>
<span class="token punctuation">[</span>1<span class="token punctuation">]</span>+  Stopped                 <span class="token function">date</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5C06;&#x4F5C;&#x4E1A;&#x79FB;&#x5230;&#x524D;&#x53F0;&#x6765;&#x67E5;&#x770B;&#x4F5C;&#x4E1A;&#x7684;&#x8F93;&#x51FA;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">fg</span>
<span class="token function">date</span>
Fri Feb 14 23:38:59 CST 2020<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x4F5C;&#x4E1A;&#x5177;&#x5907;&#x591A;&#x79CD;&#x72B6;&#x6001;&#xFF0C;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;&#x4EE5;&#x53CA;shell&#x547D;&#x4EE4;&#x548C;&#x7EC8;&#x7AEF;&#x5B57;&#x7B26;&#xFF08;&#x4EE5;&#x53CA;&#x76F8;&#x5E94;&#x7684;&#x4FE1;&#x53F7;&#xFF09;&#x53EF;&#x4EE5;&#x4F7F;&#x4F5C;&#x4E1A;&#x5728;&#x4E0D;&#x540C;&#x72B6;&#x6001;&#x4E4B;&#x95F4;&#x8FC1;&#x79FB;&#xFF0C;&#x4E0B;&#x56FE;&#x5BF9;&#x4F5C;&#x4E1A;&#x7684;&#x72B6;&#x6001;&#x8FDB;&#x884C;&#x4E86;&#x603B;&#x7ED3;&#x3002;&#x8FD9;&#x4E9B;&#x4F5C;&#x4E1A;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5411;&#x4F5C;&#x4E1A;&#x53D1;&#x9001;&#x5404;&#x79CD;&#x4FE1;&#x53F7;&#x6765;&#x5230;&#x8FBE;&#xFF0C;&#x5982;SIGINT&#x548C;SIGQUIT&#x4FE1;&#x53F7;&#xFF0C;&#x800C;&#x8FD9;&#x4E9B;&#x4FE1;&#x53F7;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x952E;&#x76D8;&#x6765;&#x751F;&#x6210;&#x3002;<br></p><div class="amp-img-wrapper"><amp-img src="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1581694898973.png?x-oss-process=image/resize,m_lfit,h_450" width="650" height="450" layout="responsive"></amp-img></div>
<h3 id="&#x5B9E;&#x73B0;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;"><a href="#&#x5B9E;&#x73B0;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;" class="headerlink" title="&#x5B9E;&#x73B0;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;"></a>&#x5B9E;&#x73B0;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;</h3><p>&#x5C3D;&#x7BA1;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;&#x4E00;&#x5F00;&#x59CB;&#x5728;POSIX.1&#x6807;&#x51C6;&#x4E2D;&#x662F;&#x53EF;&#x9009;&#x7684;&#xFF0C;&#x4F46;&#x5728;&#x540E;&#x9762;&#x7684;&#x6807;&#x51C6;&#x4E2D;&#xFF0C;&#x5305;&#x62EC;SUSv3&#xFF0C;&#x5219;&#x8981;&#x6C42;&#x5B9E;&#x73B0;&#x5FC5;&#x987B;&#x8981;&#x652F;&#x6301;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;&#x3002;&#x8FD9;&#x79CD;&#x652F;&#x6301;&#x6240;&#x9700;&#x7684;&#x6761;&#x4EF6;&#x5982;&#x4E0B;&#x3002;</p>
<ul>
<li>&#x5B9E;&#x73B0;&#x5FC5;&#x987B;&#x8981;&#x63D0;&#x4F9B;&#x7279;&#x5B9A;&#x7684;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;&#x4FE1;&#x53F7;&#xFF1A;SIGTSTP&#x3001;SIGSTOP&#x3001;SIGCONT&#x3001;SIGTTOU&#x4EE5;&#x53CA;SIGTTIN&#x3002;&#x6B64;&#x5916;&#xFF0C;SIGCHLD&#x4FE1;&#x53F7;&#x4E5F;&#x662F;&#x5FC5;&#x9700;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x5141;&#x8BB8;shell&#xFF08;&#x6240;&#x6709;&#x4EFB;&#x52A1;&#x7684;&#x7236;&#x8FDB;&#x7A0B;&#xFF09;&#x627E;&#x51FA;&#x5176;&#x5B50;&#x8FDB;&#x7A0B;&#x4F55;&#x65F6;&#x6267;&#x884C;&#x7EC8;&#x6B62;&#x6216;&#x88AB;&#x505C;&#x6B62;&#x4E86;&#x3002;</li>
<li>&#x7EC8;&#x7AEF;&#x9A71;&#x52A8;&#x5668;&#x5FC5;&#x987B;&#x8981;&#x652F;&#x6301;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;&#x4FE1;&#x53F7;&#x7684;&#x751F;&#x6210;&#xFF0C;&#x8FD9;&#x6837;&#x5F53;&#x8F93;&#x5165;&#x7279;&#x5B9A;&#x7684;&#x5B57;&#x7B26;&#x6216;&#x8FDB;&#x884C;&#x7EC8;&#x7AEF;I/O&#x4EE5;&#x53CA;&#x5728;&#x540E;&#x53F0;&#x4F5C;&#x4E1A;&#x4E2D;&#x6267;&#x884C;&#x7279;&#x5B9A;&#x7684;&#x5176;&#x4ED6;&#x7EC8;&#x7AEF;&#x64CD;&#x4F5C;&#x65F6;&#x9700;&#x8981;&#x5C06;&#x6070;&#x5F53;&#x7684;&#x4FE1;&#x53F7;&#x53D1;&#x9001;&#x5230;&#x76F8;&#x5173;&#x7684;&#x8FDB;&#x7A0B;&#x7EC4;&#x3002;&#x4E3A;&#x4E86;&#x80FD;&#x591F;&#x5B8C;&#x6210;&#x8FD9;&#x4E9B;&#x52A8;&#x4F5C;&#xFF0C;&#x7EC8;&#x7AEF;&#x9A71;&#x52A8;&#x5668;&#x5FC5;&#x987B;&#x8981;&#x8BB0;&#x5F55;&#x4E0E;&#x7EC8;&#x7AEF;&#x76F8;&#x5173;&#x8054;&#x7684;&#x4F1A;&#x8BDD;ID&#xFF08;&#x63A7;&#x5236;&#x8FDB;&#x7A0B;&#xFF09;&#x548C;&#x524D;&#x53F0;&#x8FDB;&#x7A0B;&#x7EC4;ID&#x3002;</li>
<li>shell&#x5FC5;&#x987B;&#x8981;&#x652F;&#x6301;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;&#xFF08;&#x5927;&#x591A;&#x6570;&#x73B0;&#x4EE3;shell&#x90FD;&#x5177;&#x5907;&#x8FD9;&#x4E2A;&#x529F;&#x80FD;&#xFF09;&#x3002;&#x8FD9;&#x79CD;&#x652F;&#x6301;&#x662F;&#x901A;&#x8FC7;&#x524D;&#x9762;&#x4ECB;&#x7ECD;&#x7684;&#x5C06;&#x4F5C;&#x4E1A;&#x5728;&#x524D;&#x53F0;&#x548C;&#x540E;&#x53F0;&#x4E4B;&#x95F4;&#x8FC1;&#x79FB;&#x4EE5;&#x53CA;&#x76D1;&#x63A7;&#x4F5C;&#x4E1A;&#x7684;&#x72B6;&#x6001;&#x7684;&#x547D;&#x4EE4;&#x7684;&#x5F62;&#x5F0F;&#x6765;&#x5B8C;&#x6210;&#x7684;&#x3002;&#x5176;&#x4E2D;&#x67D0;&#x4E9B;&#x547D;&#x4EE4;&#x4F1A;&#x5411;&#x4F5C;&#x4E1A;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x5728;&#x6267;&#x884C;&#x5C06;&#x4F5C;&#x4E1A;&#x4ECE;&#x524D;&#x53F0;&#x8FD0;&#x884C;&#x7684;&#x72B6;&#x6001;&#x8FC1;&#x79FB;&#x81F3;&#x5176;&#x4ED6;&#x72B6;&#x6001;&#x7684;&#x64CD;&#x4F5C;&#x4E2D;&#xFF0C;shell&#x4F7F;&#x7528;tcsetpgrp()&#x8C03;&#x7528;&#x6765;&#x8C03;&#x6574;&#x7EC8;&#x7AEF;&#x9A71;&#x52A8;&#x5668;&#x4E2D;&#x4E0E;&#x524D;&#x53F0;&#x8FDB;&#x7A0B;&#x7EC4;&#x6709;&#x5173;&#x7684;&#x8BB0;&#x5F55;&#x4FE1;&#x606F;&#x3002;</li>
</ul>
<p>&#x4FE1;&#x53F7;&#x4E00;&#x822C;&#x53EA;&#x6709;&#x5728;&#x53D1;&#x9001;&#x8FDB;&#x7A0B;&#x7684;&#x771F;&#x5B9E;&#x6216;&#x6709;&#x6548;&#x7528;&#x6237;ID&#x4E0E;&#x63A5;&#x6536;&#x8FDB;&#x7A0B;&#x7684;&#x771F;&#x5B9E;&#x7528;&#x6237;ID&#x6216;&#x4FDD;&#x5B58;&#x7684;set-user-ID&#x5339;&#x914D;&#x65F6;&#x624D;&#x4F1A;&#x88AB;&#x53D1;&#x9001;&#x7ED9;&#x8FDB;&#x7A0B;&#xFF0C;&#x4F46;SIGCONT&#x662F;&#x8FD9;&#x4E2A;&#x89C4;&#x5219;&#x7684;&#x4E00;&#x4E2A;&#x4F8B;&#x5916;&#x3002;&#x5185;&#x6838;&#x5141;&#x8BB8;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#xFF08;&#x5982;shell&#xFF09;&#x5411;&#x540C;&#x4E00;&#x4F1A;&#x8BDD;&#x4E2D;&#x7684;&#x4EFB;&#x610F;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;SIGCONT&#x4FE1;&#x53F7;&#xFF0C;&#x4E0D;&#x7BA1;&#x8FDB;&#x7A0B;&#x7684;&#x9A8C;&#x8BC1;&#x4FE1;&#x606F;&#x662F;&#x4EC0;&#x4E48;&#x3002;&#x5728;SIGCONT&#x4FE1;&#x53F7;&#x4E0A;&#x653E;&#x5BBD;&#x8FD9;&#x4E2A;&#x89C4;&#x5219;&#x662F;&#x6709;&#x5FC5;&#x8981;&#x7684;&#xFF0C;&#x8FD9;&#x6837;&#x5F53;&#x7528;&#x6237;&#x5F00;&#x59CB;&#x4E00;&#x4E2A;&#x4F1A;&#x4FEE;&#x6539;&#x81EA;&#x8EAB;&#x7684;&#x9A8C;&#x8BC1;&#x4FE1;&#x606F;&#xFF08;&#x7279;&#x522B;&#x662F;&#x771F;&#x5B9E;&#x7684;&#x7528;&#x6237;ID&#xFF09;&#x7684;set-user-ID&#x7A0B;&#x5E8F;&#x65F6;&#xFF0C;&#x4ECD;&#x7136;&#x80FD;&#x591F;&#x5728;&#x7A0B;&#x5E8F;&#x88AB;&#x505C;&#x6B62;&#x65F6;&#x901A;&#x8FC7;SIGCONT&#x4FE1;&#x53F7;&#x6765;&#x6062;&#x590D;&#x8FD9;&#x4E2A;&#x7A0B;&#x5E8F;&#x7684;&#x8FD0;&#x884C;&#x3002;</p>
<h3 id="SIGTTIN&#x548C;SIGTTOU&#x4FE1;&#x53F7;"><a href="#SIGTTIN&#x548C;SIGTTOU&#x4FE1;&#x53F7;" class="headerlink" title="SIGTTIN&#x548C;SIGTTOU&#x4FE1;&#x53F7;"></a>SIGTTIN&#x548C;SIGTTOU&#x4FE1;&#x53F7;</h3><p>SUSv3&#x5BF9;&#x540E;&#x53F0;&#x8FDB;&#x7A0B;&#x7684;SIGTTIN&#x548C;SIGTTOU&#x4FE1;&#x53F7;&#x7684;&#x4EA7;&#x751F;&#x89C4;&#x5B9A;&#x4E86;&#x4E00;&#x4E9B;&#x7279;&#x6B8A;&#x60C5;&#x51B5;&#xFF08;Linux&#x5B9E;&#x73B0;&#x4E86;&#x8FD9;&#x4E9B;&#x89C4;&#x5B9A;&#xFF09;&#x3002;</p>
<ul>
<li>&#x5F53;&#x8FDB;&#x7A0B;&#x5F53;&#x524D;&#x5904;&#x4E8E;&#x963B;&#x585E;&#x72B6;&#x6001;&#x6216;&#x5FFD;&#x89C6;SIGTTIN&#x4FE1;&#x53F7;&#x7684;&#x72B6;&#x6001;&#x65F6;&#x5219;&#x4E0D;&#x53D1;&#x9001;SIGTTIN&#x4FE1;&#x53F7;&#xFF0C;&#x8FD9;&#x65F6;&#x8BD5;&#x56FE;&#x4ECE;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x53D1;&#x8D77;read()&#x8C03;&#x7528;&#x4F1A;&#x5931;&#x8D25;&#xFF0C;errno&#x4F1A;&#x88AB;&#x8BBE;&#x7F6E;&#x6210;EIO&#x3002;&#x8FD9;&#x79CD;&#x884C;&#x4E3A;&#x7684;&#x903B;&#x8F91;&#x662F;&#x6CA1;&#x6709;&#x8FD9;&#x79CD;&#x884C;&#x4E3A;&#x7684;&#x8BDD;&#x8FDB;&#x7A0B;&#x5C31;&#x65E0;&#x6CD5;&#x77E5;&#x9053;&#x4E0D;&#x5141;&#x8BB8;&#x8FDB;&#x884C;read()&#x64CD;&#x4F5C;&#x3002;</li>
<li>&#x5373;&#x4F7F;&#x7EC8;&#x7AEF;&#x88AB;&#x8BBE;&#x7F6E;&#x4E86;TOSTOP&#x6807;&#x8BB0;&#xFF0C;&#x5F53;&#x8FDB;&#x7A0B;&#x5F53;&#x524D;&#x5904;&#x4E8E;&#x963B;&#x585E;&#x72B6;&#x6001;&#x6216;&#x5FFD;&#x89C6;SIGTTIN&#x4FE1;&#x53F7;&#x7684;&#x72B6;&#x6001;&#x65F6;&#x4E5F;&#x4E0D;&#x53D1;&#x9001;SIGTTOU&#x4FE1;&#x53F7;&#x3002;&#x8FD9;&#x65F6;&#x4ECE;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x53D1;&#x8D77;write()&#x8C03;&#x7528;&#x662F;&#x5141;&#x8BB8;&#x7684;&#xFF08;&#x5373;TOSTOP&#x6807;&#x8BB0;&#x88AB;&#x5FFD;&#x89C6;&#x4E86;&#xFF09;&#x3002;</li>
<li>&#x4E0D;&#x7BA1;&#x662F;&#x5426;&#x8BBE;&#x7F6E;&#x4E86;TOSTOP&#x6807;&#x8BB0;&#xFF0C;&#x5F53;&#x540E;&#x53F0;&#x8FDB;&#x7A0B;&#x8BD5;&#x56FE;&#x5728;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x4E0A;&#x8C03;&#x7528;&#x4F1A;&#x4FEE;&#x6539;&#x7EC8;&#x7AEF;&#x9A71;&#x52A8;&#x5668;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x7684;&#x7279;&#x5B9A;&#x51FD;&#x6570;&#x65F6;&#x4F1A;&#x751F;&#x6210;SIGTTOU&#x4FE1;&#x53F7;&#x3002;&#x8FD9;&#x4E9B;&#x51FD;&#x6570;&#x5305;&#x62EC;tcsetpgrp()&#x3001;tcsetattr()&#x3001;tcflush()&#x3001;tcflow()&#x3001;tcsendbreak()&#x4EE5;&#x53CA;tcdrain()&#x3002;&#x5982;&#x679C;SIGTTOU&#x4FE1;&#x53F7;&#x88AB;&#x963B;&#x585E;&#x6216;&#x88AB;&#x5FFD;&#x89C6;&#x4E86;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x4E9B;&#x8C03;&#x7528;&#x5C31;&#x4F1A;&#x6210;&#x529F;&#x3002;</li>
</ul>
<h3 id="&#x5904;&#x7406;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;&#x4FE1;&#x53F7;"><a href="#&#x5904;&#x7406;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;&#x4FE1;&#x53F7;" class="headerlink" title="&#x5904;&#x7406;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;&#x4FE1;&#x53F7;"></a>&#x5904;&#x7406;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;&#x4FE1;&#x53F7;</h3><p>&#x7531;&#x4E8E;&#x5BF9;&#x4E8E;&#x5927;&#x591A;&#x6570;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x6765;&#x8BB2;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;&#x7684;&#x64CD;&#x4F5C;&#x662F;&#x900F;&#x660E;&#x7684;&#xFF0C;&#x56E0;&#x6B64;&#x5B83;&#x4EEC;&#x65E0;&#x9700;&#x5BF9;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;&#x4FE1;&#x53F7;&#x91C7;&#x53D6;&#x7279;&#x6B8A;&#x7684;&#x52A8;&#x4F5C;&#xFF0C;&#x4F46;&#x50CF;vi&#x548C;less&#x4E4B;&#x7C7B;&#x7684;&#x8FDB;&#x884C;&#x5C4F;&#x5E55;&#x5904;&#x7406;&#x7684;&#x7A0B;&#x5E8F;&#x5219;&#x662F;&#x4F8B;&#x5916;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x4EEC;&#x9700;&#x8981;&#x63A7;&#x5236;&#x6587;&#x672C;&#x5728;&#x7EC8;&#x7AEF;&#x4E0A;&#x7684;&#x5E03;&#x5C40;&#x548C;&#x4FEE;&#x6539;&#x5404;&#x79CD;&#x7EC8;&#x7AEF;&#x8BBE;&#x7F6E;&#xFF0C;&#x5305;&#x62EC;&#x5141;&#x8BB8;&#x5728;&#x67D0;&#x4E00;&#x65F6;&#x523B;&#x4ECE;&#x7EC8;&#x7AEF;&#x8F93;&#x5165;&#x4E2D;&#x8BFB;&#x53D6;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#xFF08;&#x4E0D;&#x662F;&#x4E00;&#x884C;&#xFF09;&#x7684;&#x8BBE;&#x7F6E;&#x3002;<br>&#x5C4F;&#x5E55;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x9700;&#x8981;&#x5904;&#x7406;&#x7EC8;&#x7AEF;&#x505C;&#x6B62;&#x4FE1;&#x53F7;&#xFF08;SIGTSTP&#xFF09;&#x3002;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x5E94;&#x8BE5;&#x5C06;&#x7EC8;&#x7AEF;&#x91CD;&#x7F6E;&#x4E3A;&#x89C4;&#x8303;&#xFF08;&#x6BCF;&#x6B21;&#x4E00;&#x884C;&#xFF09;&#x8F93;&#x5165;&#x6A21;&#x5F0F;&#x5E76;&#x5C06;&#x5149;&#x6807;&#x653E;&#x5728;&#x7EC8;&#x7AEF;&#x7684;&#x5DE6;&#x4E0B;&#x89D2;&#x3002;&#x5F53;&#x8FDB;&#x7A0B;&#x6062;&#x590D;&#x4E4B;&#x540E;&#xFF0C;&#x7A0B;&#x5E8F;&#x4F1A;&#x5C06;&#x7EC8;&#x7AEF;&#x8BBE;&#x7F6E;&#x56DE;&#x6240;&#x9700;&#x7684;&#x6A21;&#x5F0F;&#xFF0C;&#x68C0;&#x67E5;&#x7EC8;&#x7AEF;&#x7A97;&#x53E3;&#x5927;&#x5C0F;&#xFF08;&#x7A97;&#x53E3;&#x5927;&#x5C0F;&#x540C;&#x65F6;&#x53EF;&#x80FD;&#x4F1A;&#x88AB;&#x7528;&#x6237;&#x6539;&#x6389;&#xFF09;&#x4EE5;&#x53CA;&#x4F7F;&#x7528;&#x6240;&#x9700;&#x7684;&#x5185;&#x5BB9;&#x91CD;&#x65B0;&#x7ED8;&#x5236;&#x5C4F;&#x5E55;&#x3002;<br>&#x5F53;&#x6302;&#x8D77;&#x6216;&#x9000;&#x51FA;&#x8BF8;&#x5982;vi&#x3001;xterm&#x6216;&#x5176;&#x4ED6;&#x7EC8;&#x7AEF;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x65F6;&#x901A;&#x5E38;&#x4F1A;&#x770B;&#x5230;&#x7A0B;&#x5E8F;&#x4F7F;&#x7528;&#x542F;&#x52A8;&#x4E4B;&#x524D;&#x7684;&#x53EF;&#x89C1;&#x6587;&#x672C;&#x6765;&#x7ED8;&#x5236;&#x7EC8;&#x7AEF;&#x3002;&#x8FD9;&#x4E9B;&#x7EC8;&#x7AEF;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x662F;&#x901A;&#x8FC7;&#x6355;&#x83B7;&#x4E24;&#x4E2A;&#x5B57;&#x7B26;&#x5E8F;&#x5217;&#x6765;&#x53D6;&#x5F97;&#x8FD9;&#x79CD;&#x6548;&#x679C;&#x7684;&#xFF0C;&#x6240;&#x6709;&#x4F7F;&#x7528;terminfo&#x6216;termcap&#x5305;&#x7684;&#x7A0B;&#x5E8F;&#x5728;&#x53D6;&#x5F97;&#x548C;&#x91CA;&#x653E;&#x7EC8;&#x7AEF;&#x5E03;&#x5C40;&#x7684;&#x63A7;&#x5236;&#x65F6;&#x90FD;&#x9700;&#x8981;&#x8F93;&#x51FA;&#x8FD9;&#x4E24;&#x4E2A;&#x5B57;&#x7B26;&#x5E8F;&#x5217;&#x3002;&#x7B2C;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x5E8F;&#x5217;&#x79F0;&#x4E3A;smcup&#xFF08;&#x901A;&#x5E38;&#x662F;Escape&#x540E;&#x9762;&#x8DDF;&#x7740;[?1049h&#xFF09;&#xFF0C;&#x5B83;&#x4F1A;&#x5BFC;&#x81F4;&#x7EC8;&#x7AEF;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x5207;&#x6362;&#x81F3;&#x5176;&#x201C;&#x9884;&#x5907;&#x201D;&#x5C4F;&#x5E55;&#x3002;&#x7B2C;&#x4E8C;&#x4E2A;&#x5E8F;&#x5217;&#x79F0;&#x4E3A;rmcup&#xFF08;&#x901A;&#x5E38;&#x662F;Escape&#x540E;&#x9762;&#x8DDF;&#x7740;[?1049l&#xFF09;&#xFF0C;&#x5B83;&#x4F1A;&#x5BFC;&#x81F4;&#x7EC8;&#x7AEF;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x6062;&#x590D;&#x5230;&#x9ED8;&#x8BA4;&#x5C4F;&#x5E55;&#xFF0C;&#x4ECE;&#x800C;&#x5BFC;&#x81F4;&#x5728;&#x663E;&#x793A;&#x5668;&#x4E0A;&#x91CD;&#x73B0;&#x5C4F;&#x5E55;&#x5904;&#x7406;&#x7A0B;&#x5E8F;&#x5728;&#x83B7;&#x53D6;&#x7EC8;&#x7AEF;&#x7684;&#x63A7;&#x5236;&#x6743;&#x4E4B;&#x524D;&#x7684;&#x521D;&#x59CB;&#x6587;&#x672C;&#x3002;</p>
<p>&#x5728;&#x5904;&#x7406;SIGTSTP&#x4FE1;&#x53F7;&#x65F6;&#x9700;&#x8981;&#x6E05;&#x695A;&#x4E00;&#x4E9B;&#x7EC6;&#x8282;&#x95EE;&#x9898;&#x3002;&#x7B2C;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#x662F;&#xFF1A;&#x5982;&#x679C;SIGTSTP&#x4FE1;&#x53F7;&#x88AB;&#x6355;&#x83B7;&#x4E86;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x4E0D;&#x4F1A;&#x6267;&#x884C;&#x9ED8;&#x8BA4;&#x7684;&#x505C;&#x6B62;&#x8FDB;&#x7A0B;&#x7684;&#x52A8;&#x4F5C;&#x3002;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8BA9;SIGTSTP&#x4FE1;&#x53F7;&#x7684;&#x5904;&#x7406;&#x5668;&#x751F;&#x6210;&#x4E00;&#x4E2A;SIGSTOP&#x4FE1;&#x53F7;&#x6765;&#x89E3;&#x51B3;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x3002;&#x7531;&#x4E8E;SIGSTOP&#x4FE1;&#x53F7;&#x662F;&#x65E0;&#x6CD5;&#x88AB;&#x6355;&#x83B7;&#x3001;&#x963B;&#x585E;&#x548C;&#x5FFD;&#x7565;&#x7684;&#xFF0C;&#x56E0;&#x6B64;&#x80FD;&#x786E;&#x4FDD;&#x7ACB;&#x5373;&#x505C;&#x6B62;&#x8FDB;&#x7A0B;&#xFF0C;&#x4F46;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x4E0D;&#x662F;&#x975E;&#x5E38;&#x51C6;&#x786E;&#x3002;&#x7236;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;wait()&#x6216;waitpid()&#x8FD4;&#x56DE;&#x7684;&#x7B49;&#x5F85;&#x72B6;&#x6001;&#x503C;&#x6765;&#x786E;&#x5B9A;&#x54EA;&#x4E2A;&#x4FE1;&#x53F7;&#x5BFC;&#x81F4;&#x4E86;&#x5176;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x505C;&#x6B62;&#x3002;&#x5982;&#x679C;&#x5728;SIGTSTP&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x4E2D;&#x751F;&#x6210;&#x4E86;SIGSTOP&#x4FE1;&#x53F7;&#xFF0C;&#x90A3;&#x4E48;&#x5BF9;&#x4E8E;&#x7236;&#x8FDB;&#x7A0B;&#x6765;&#x8BB2;&#xFF0C;&#x5176;&#x5B50;&#x8FDB;&#x7A0B;&#x662F;&#x88AB;SIGSTOP&#x4FE1;&#x53F7;&#x505C;&#x6B62;&#x7684;&#xFF0C;&#x8FD9;&#x5C31;&#x4F1A;&#x4EA7;&#x751F;&#x8BEF;&#x5BFC;&#x3002;</p>
<p>&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x6070;&#x5F53;&#x7684;&#x5904;&#x7406;&#x65B9;&#x5F0F;&#x662F;&#x8BA9;SIGTSTP&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x518D;&#x751F;&#x6210;&#x4E00;&#x4E2A;SIGTSTP&#x4FE1;&#x53F7;&#x6765;&#x505C;&#x6B62;&#x8FDB;&#x7A0B;&#xFF0C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#x3002;<br>1&#xFF0E; &#x5904;&#x7406;&#x5668;&#x5C06;SIGTSTP&#x4FE1;&#x53F7;&#x7684;&#x5904;&#x7406;&#x91CD;&#x7F6E;&#x4E3A;&#x9ED8;&#x8BA4;&#x503C;&#xFF08;SIG_DFL&#xFF09;&#x3002;<br>2&#xFF0E; &#x5904;&#x7406;&#x5668;&#x751F;&#x6210;SIGTSTP&#x4FE1;&#x53F7;&#x3002;<br>3&#xFF0E; &#x7531;&#x4E8E;SIGTSTP&#x4FE1;&#x53F7;&#x4F1A;&#x88AB;&#x963B;&#x585E;&#x8FDB;&#x5165;&#x5904;&#x7406;&#x5668;&#xFF08;&#x9664;&#x975E;&#x6307;&#x5B9A;&#x4E86;SA_NODEFER&#x6807;&#x8BB0;&#xFF09;&#xFF0C;&#x56E0;&#x6B64;&#x5904;&#x7406;&#x5668;&#x4F1A;&#x63A5;&#x89E6;&#x8BE5;&#x4FE1;&#x53F7;&#x7684;&#x963B;&#x585E;&#x3002;&#x8FD9;&#x65F6;&#xFF0C;&#x5728;&#x4E0A;&#x4E00;&#x4E2A;&#x6B65;&#x9AA4;&#x4E2D;&#x751F;&#x6210;&#x7684;SIGTSTP&#x4FE1;&#x53F7;&#x4F1A;&#x5BFC;&#x81F4;&#x9ED8;&#x8BA4;&#x52A8;&#x4F5C;&#x7684;&#x6267;&#x884C;&#xFF1A;&#x8FDB;&#x7A0B;&#x4F1A;&#x7ACB;&#x5373;&#x88AB;&#x6302;&#x8D77;&#x3002;<br>4&#xFF0E; &#x5728;&#x540E;&#x9762;&#x7684;&#x67D0;&#x4E2A;&#x65F6;&#x523B;&#xFF0C;&#x5F53;&#x8FDB;&#x7A0B;&#x63A5;&#x6536;&#x5230;SIGCONT&#x4FE1;&#x53F7;&#x65F6;&#x4F1A;&#x6062;&#x590D;&#x3002;&#x8FD9;&#x65F6;&#xFF0C;&#x5904;&#x7406;&#x5668;&#x7684;&#x6267;&#x884C;&#x5C31;&#x4F1A;&#x7EE7;&#x7EED;&#x3002;<br>5&#xFF0E; &#x5728;&#x8FD4;&#x56DE;&#x4E4B;&#x524D;&#xFF0C;&#x5904;&#x7406;&#x5668;&#x4F1A;&#x91CD;&#x65B0;&#x963B;&#x585E;SIGTSTP&#x4FE1;&#x53F7;&#x5E76;&#x91CD;&#x65B0;&#x6CE8;&#x518C;&#x672C;&#x8EAB;&#x6765;&#x5904;&#x7406;&#x4E0B;&#x4E00;&#x4E2A;SIGTSTP&#x4FE1;&#x53F7;&#x3002;</p>
<p>&#x6267;&#x884C;&#x91CD;&#x65B0;&#x963B;&#x585E;SIGTSTP&#x4FE1;&#x53F7;&#x8FD9;&#x4E00;&#x6B65;&#x662F;&#x56E0;&#x4E3A;&#x9632;&#x6B62;&#x5728;&#x5904;&#x7406;&#x5668;&#x91CD;&#x65B0;&#x6CE8;&#x518C;&#x672C;&#x8EAB;&#x4E4B;&#x540E;&#x548C;&#x8FD4;&#x56DE;&#x4E4B;&#x524D;&#x63A5;&#x6536;&#x5230;&#x53E6;&#x4E00;&#x4E2A;SIGTSTP&#x4FE1;&#x53F7;&#x800C;&#x5BFC;&#x81F4;&#x5904;&#x7406;&#x5668;&#x88AB;&#x9012;&#x5F52;&#x8C03;&#x7528;&#x7684;&#x60C5;&#x51B5;&#x3002;&#x5728;&#x5FEB;&#x901F;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x65F6;&#x9012;&#x5F52;&#x8C03;&#x7528;&#x4E00;&#x4E2A;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x4F1A;&#x5BFC;&#x81F4;&#x6808;&#x6EA2;&#x51FA;&#x3002;&#x963B;&#x585E;&#x4FE1;&#x53F7;&#x8FD8;&#x907F;&#x514D;&#x4E86;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x5728;&#x91CD;&#x65B0;&#x6CE8;&#x518C;&#x672C;&#x8EAB;&#x548C;&#x8FD4;&#x56DE;&#x4E4B;&#x524D;&#x9700;&#x8981;&#x6267;&#x884C;&#x5176;&#x4ED6;&#x52A8;&#x4F5C;&#xFF08;&#x5982;&#x4FDD;&#x5B58;&#x548C;&#x8FD8;&#x539F;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#xFF09;&#x65F6;&#x5B58;&#x5728;&#x7684;&#x95EE;&#x9898;&#x3002;</p>
<h3 id="&#x5B64;&#x513F;&#x8FDB;&#x7A0B;&#x7EC4;&#xFF08;SIGHUP&#x56DE;&#x987E;&#xFF09;"><a href="#&#x5B64;&#x513F;&#x8FDB;&#x7A0B;&#x7EC4;&#xFF08;SIGHUP&#x56DE;&#x987E;&#xFF09;" class="headerlink" title="&#x5B64;&#x513F;&#x8FDB;&#x7A0B;&#x7EC4;&#xFF08;SIGHUP&#x56DE;&#x987E;&#xFF09;"></a>&#x5B64;&#x513F;&#x8FDB;&#x7A0B;&#x7EC4;&#xFF08;SIGHUP&#x56DE;&#x987E;&#xFF09;</h3><p>&#x5B64;&#x513F;&#x8FDB;&#x7A0B;&#x662F;&#x90A3;&#x4E9B;&#x5728;&#x7236;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#x4E4B;&#x540E;&#x88AB;init&#x8FDB;&#x7A0B;&#xFF08;&#x8FDB;&#x7A0B;ID&#x4E3A;1&#xFF09;&#x6536;&#x517B;&#x7684;&#x8FDB;&#x7A0B;&#x3002;&#x5728;&#x7A0B;&#x5E8F;&#x4E2D;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5B64;&#x513F;&#x8FDB;&#x7A0B;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">//&#x5982;&#x679C;&#x662F;&#x7236;&#x8FDB;&#x7A0B;&#x5C31;&#x9000;&#x51FA;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x5047;&#x8BBE;&#x5728;shell&#x4E2D;&#x6267;&#x884C;&#x4E00;&#x4E2A;&#x5305;&#x542B;&#x4E0A;&#x9762;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x7684;&#x7A0B;&#x5E8F;&#xFF0C;&#x4E0B;&#x56FE;&#x7ED9;&#x51FA;&#x4E86;&#x7236;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#x524D;&#x540E;&#x8BE5;&#x8FDB;&#x7A0B;&#x7684;&#x72B6;&#x6001;&#x3002;<br></p><div class="amp-img-wrapper"><amp-img src="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1581727644657.png?x-oss-process=image/resize,m_lfit,h_450" width="647" height="450" layout="responsive"></amp-img></div><br>&#x5728;&#x7236;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#x4E4B;&#x540E;&#xFF0C;&#x5B50;&#x8FDB;&#x7A0B;&#x4E0D;&#x4EC5;&#x662F;&#x4E00;&#x4E2A;&#x5B64;&#x513F;&#x8FDB;&#x7A0B;&#xFF0C;&#x540C;&#x65F6;&#x4E5F;&#x662F;&#x5B64;&#x513F;&#x8FDB;&#x7A0B;&#x7EC4;&#x7684;&#x4E00;&#x4E2A;&#x6210;&#x5458;&#x3002;SUSv3&#x8BA4;&#x4E3A;&#x5F53;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7EC4;&#x6EE1;&#x8DB3;&#x201C;&#x6BCF;&#x4E2A;&#x6210;&#x5458;&#x7684;&#x7236;&#x8FDB;&#x7A0B;&#x672C;&#x8EAB;&#x662F;&#x7EC4;&#x7684;&#x4E00;&#x4E2A;&#x6210;&#x5458;&#x6216;&#x4E0D;&#x662F;&#x7EC4;&#x4F1A;&#x8BDD;&#x7684;&#x4E00;&#x4E2A;&#x6210;&#x5458;&#x201D;&#x65F6;&#x5C31;&#x53D8;&#x6210;&#x4E86;&#x4E00;&#x4E2A;&#x5B64;&#x513F;&#x8FDB;&#x7A0B;&#x7EC4;&#x3002;&#x6362;&#x53E5;&#x8BDD;&#x8BF4;&#xFF0C;&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7EC4;&#x4E2D;&#x81F3;&#x5C11;&#x6709;&#x4E00;&#x4E2A;&#x6210;&#x5458;&#x62E5;&#x6709;&#x4E00;&#x4E2A;&#x4F4D;&#x4E8E;&#x540C;&#x4E00;&#x4F1A;&#x8BDD;&#x4F46;&#x4E0D;&#x540C;&#x8FDB;&#x7A0B;&#x7EC4;&#x4E2D;&#x7684;&#x7236;&#x8FDB;&#x7A0B;&#xFF0C;&#x5C31;&#x4E0D;&#x662F;&#x5B64;&#x513F;&#x8FDB;&#x7A0B;&#x7EC4;&#x3002;&#x4E0A;&#x56FE;&#x4E2D;&#x5305;&#x542B;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x8FDB;&#x7A0B;&#x7EC4;&#x662F;&#x5B64;&#x513F;&#x8FDB;&#x7A0B;&#x7EC4;&#xFF0C;&#x56E0;&#x4E3A;&#x8FDB;&#x7A0B;&#x7EC4;&#x4E2D;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x662F;&#x552F;&#x4E00;&#x8FDB;&#x7A0B;&#xFF0C;&#x5176;&#x7236;&#x8FDB;&#x7A0B;&#xFF08;init&#xFF09;&#x4F4D;&#x4E8E;&#x4E0D;&#x540C;&#x7684;&#x4F1A;&#x8BDD;&#x4E2D;&#x3002;
<p>&#x6839;&#x636E;&#x5B9A;&#x4E49;&#xFF0C;&#x4F1A;&#x8BDD;&#x9996;&#x8FDB;&#x7A0B;&#x4F4D;&#x4E8E;&#x5B64;&#x513F;&#x8FDB;&#x7A0B;&#x7EC4;&#x4E2D;&#x3002;&#x8FD9;&#x662F;&#x56E0;&#x4E3A;setsid()&#x5728;&#x65B0;&#x4F1A;&#x8BDD;&#x4E2D;&#x521B;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A;&#x65B0;&#x8FDB;&#x7A0B;&#x7EC4;&#xFF0C;&#x800C;&#x4F1A;&#x8BDD;&#x9996;&#x8FDB;&#x7A0B;&#x7684;&#x7236;&#x8FDB;&#x7A0B;&#x5219;&#x4F4D;&#x4E8E;&#x4E0D;&#x540C;&#x7684;&#x4F1A;&#x8BDD;&#x4E2D;&#x3002;</p>
<p>&#x4ECE;shell&#x4F5C;&#x4E1A;&#x63A7;&#x5236;&#x7684;&#x89D2;&#x5EA6;&#x6765;&#x8BB2;&#xFF0C;&#x5B64;&#x513F;&#x8FDB;&#x7A0B;&#x7EC4;&#x662F;&#x975E;&#x5E38;&#x91CD;&#x8981;&#x7684;&#x3002;&#x6839;&#x636E;&#x4E0A;&#x56FE;&#x8003;&#x8651;&#x4E0B;&#x9762;&#x7684;&#x573A;&#x666F;&#x3002;<br>1&#xFF0E; &#x5728;&#x7236;&#x8FDB;&#x7A0B;&#x9000;&#x51FA;&#x4E4B;&#x524D;&#xFF0C;&#x5B50;&#x8FDB;&#x7A0B;&#x88AB;&#x505C;&#x6B62;&#x4E86;&#xFF08;&#x53EF;&#x80FD;&#x662F;&#x7531;&#x4E8E;&#x7236;&#x8FDB;&#x7A0B;&#x5411;&#x5B50;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;&#x4E86;&#x4E00;&#x4E2A;&#x505C;&#x6B62;&#x4FE1;&#x53F7;&#xFF09;&#x3002;<br>2&#xFF0E; &#x5F53;&#x7236;&#x8FDB;&#x7A0B;&#x9000;&#x51FA;&#x65F6;shell&#x4ECE;&#x4F5C;&#x4E1A;&#x5217;&#x8868;&#x4E2D;&#x5220;&#x9664;&#x4E86;&#x7236;&#x8FDB;&#x7A0B;&#x7684;&#x8FDB;&#x7A0B;&#x7EC4;&#x3002;&#x5B50;&#x8FDB;&#x7A0B;&#x7531;init&#x6536;&#x517B;&#x5E76;&#x53D8;&#x6210;&#x4E86;&#x7EC8;&#x7AEF;&#x7684;&#x4E00;&#x4E2A;&#x540E;&#x53F0;&#x8FDB;&#x7A0B;&#xFF0C;&#x5305;&#x542B;&#x8BE5;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x8FDB;&#x7A0B;&#x7EC4;&#x53D8;&#x6210;&#x4E86;&#x5B64;&#x513F;&#x8FDB;&#x7A0B;&#x7EC4;&#x3002;<br>3&#xFF0E; &#x8FD9;&#x65F6;&#x6CA1;&#x6709;&#x8FDB;&#x7A0B;&#x4F1A;&#x901A;&#x8FC7;wait()&#x76D1;&#x63A7;&#x88AB;&#x505C;&#x6B62;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x72B6;&#x6001;&#x3002;</p>
<p>&#x7531;&#x4E8E;shell&#x5E76;&#x6CA1;&#x6709;&#x521B;&#x5EFA;&#x5B50;&#x8FDB;&#x7A0B;&#xFF0C;&#x56E0;&#x6B64;&#x5B83;&#x4E0D;&#x6E05;&#x695A;&#x5B50;&#x8FDB;&#x7A0B;&#x662F;&#x5426;&#x5B58;&#x5728;&#x4EE5;&#x53CA;&#x5B50;&#x8FDB;&#x7A0B;&#x4E0E;&#x5DF2;&#x7ECF;&#x9000;&#x51FA;&#x7684;&#x7236;&#x8FDB;&#x7A0B;&#x4F4D;&#x4E8E;&#x540C;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7EC4;&#x4E2D;&#x3002;&#x6B64;&#x5916;&#xFF0C;init&#x8FDB;&#x7A0B;&#x53EA;&#x4F1A;&#x68C0;&#x67E5;&#x88AB;&#x7EC8;&#x6B62;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x5E76;&#x6E05;&#x7406;&#x8BE5;&#x50F5;&#x5C38;&#x8FDB;&#x7A0B;&#xFF0C;&#x4ECE;&#x800C;&#x5BFC;&#x81F4;&#x88AB;&#x505C;&#x6B62;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x53EF;&#x80FD;&#x4F1A;&#x6C38;&#x8FDC;&#x6B8B;&#x7559;&#x5728;&#x7CFB;&#x7EDF;&#x4E2D;&#xFF0C;&#x56E0;&#x4E3A;&#x6CA1;&#x6709;&#x8FDB;&#x7A0B;&#x77E5;&#x9053;&#x8981;&#x5411;&#x5176;&#x53D1;&#x9001;&#x4E00;&#x4E2A;SIGCONT&#x4FE1;&#x53F7;&#x6765;&#x6062;&#x590D;&#x5B83;&#x7684;&#x6267;&#x884C;&#x3002;</p>
<p>&#x5373;&#x4F7F;&#x5B64;&#x513F;&#x8FDB;&#x7A0B;&#x7EC4;&#x4E2D;&#x4E00;&#x4E2A;&#x88AB;&#x505C;&#x6B62;&#x7684;&#x8FDB;&#x7A0B;&#x62E5;&#x6709;&#x4E00;&#x4E2A;&#x4ECD;&#x7136;&#x5B58;&#x6D3B;&#x4F46;&#x4F4D;&#x4E8E;&#x4E0D;&#x540C;&#x4F1A;&#x8BDD;&#x4E2D;&#x7684;&#x7236;&#x8FDB;&#x7A0B;&#xFF0C;&#x4E5F;&#x65E0;&#x6CD5;&#x4FDD;&#x8BC1;&#x7236;&#x8FDB;&#x7A0B;&#x80FD;&#x591F;&#x5411;&#x8FD9;&#x4E2A;&#x88AB;&#x505C;&#x6B62;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;SIGCONT&#x4FE1;&#x53F7;&#x3002;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x5411;&#x540C;&#x4E00;&#x4F1A;&#x8BDD;&#x4E2D;&#x7684;&#x4EFB;&#x610F;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;SIGCONT&#x4FE1;&#x53F7;&#xFF0C;&#x4F46;&#x5982;&#x679C;&#x5B50;&#x8FDB;&#x7A0B;&#x4F4D;&#x4E8E;&#x4E0D;&#x540C;&#x7684;&#x4F1A;&#x8BDD;&#x4E2D;&#xFF0C;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x7684;&#x6807;&#x51C6;&#x89C4;&#x5219;&#x5C31;&#x5F00;&#x59CB;&#x8D77;&#x4F5C;&#x7528;&#x4E86;&#xFF0C;&#x56E0;&#x6B64;&#x5982;&#x679C;&#x5B50;&#x8FDB;&#x7A0B;&#x662F;&#x4E00;&#x4E2A;&#x4FEE;&#x6539;&#x4E86;&#x81EA;&#x8EAB;&#x7684;&#x9A8C;&#x8BC1;&#x4FE1;&#x606F;&#x7684;&#x7279;&#x6743;&#x8FDB;&#x7A0B;&#xFF0C;&#x7236;&#x8FDB;&#x7A0B;&#x53EF;&#x80FD;&#x5C31;&#x65E0;&#x6CD5;&#x5411;&#x5B50;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x3002;</p>
<p>&#x4E3A;&#x9632;&#x6B62;&#x4E0A;&#x9762;&#x6240;&#x63CF;&#x8FF0;&#x7684;&#x60C5;&#x51B5;&#x7684;&#x53D1;&#x751F;&#xFF0C;SUSv3&#x89C4;&#x5B9A;&#xFF0C;&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7EC4;&#x53D8;&#x6210;&#x4E86;&#x5B64;&#x513F;&#x8FDB;&#x7A0B;&#x7EC4;&#x5E76;&#x4E14;&#x62E5;&#x6709;&#x5F88;&#x591A;&#x5DF2;&#x505C;&#x6B62;&#x6267;&#x884C;&#x7684;&#x6210;&#x5458;&#xFF0C;&#x90A3;&#x4E48;&#x7CFB;&#x7EDF;&#x4F1A;&#x5411;&#x8FDB;&#x7A0B;&#x7EC4;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x6210;&#x5458;&#x53D1;&#x9001;&#x4E00;&#x4E2A;SIGHUP&#x4FE1;&#x53F7;&#x901A;&#x77E5;&#x5B83;&#x4EEC;&#x5DF2;&#x7ECF;&#x4E0E;&#x4F1A;&#x8BDD;&#x65AD;&#x5F00;&#x8FDE;&#x63A5;&#x4E86;&#xFF0C;&#x4E4B;&#x540E;&#x518D;&#x53D1;&#x9001;&#x4E00;&#x4E2A;SIGCONT&#x4FE1;&#x53F7;&#x786E;&#x4FDD;&#x5B83;&#x4EEC;&#x6062;&#x590D;&#x6267;&#x884C;&#x3002;&#x5982;&#x679C;&#x5B64;&#x513F;&#x8FDB;&#x7A0B;&#x7EC4;&#x4E0D;&#x5305;&#x542B;&#x88AB;&#x505C;&#x6B62;&#x7684;&#x6210;&#x5458;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x4E0D;&#x4F1A;&#x53D1;&#x9001;&#x4EFB;&#x4F55;&#x4FE1;&#x53F7;&#x3002;</p>
<p>&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7EC4;&#x53D8;&#x6210;&#x5B64;&#x513F;&#x8FDB;&#x7A0B;&#x7EC4;&#x7684;&#x539F;&#x56E0;&#x53EF;&#x80FD;&#x662F;&#x56E0;&#x4E3A;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x4F4D;&#x4E8E;&#x4E0D;&#x540C;&#x8FDB;&#x7A0B;&#x7EC4;&#x4F46;&#x5C5E;&#x4E8E;&#x540C;&#x4E00;&#x4F1A;&#x8BDD;&#x7684;&#x7236;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#x4E86;&#xFF0C;&#x4E5F;&#x53EF;&#x80FD;&#x662F;&#x56E0;&#x4E3A;&#x7236;&#x8FDB;&#x7A0B;&#x4F4D;&#x4E8E;&#x53E6;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7EC4;&#x4E2D;&#x7684;&#x8FDB;&#x7A0B;&#x7EC4;&#x4E2D;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#x4E86;&#x3002;&#x4E0D;&#x7BA1;&#x662F;&#x4F55;&#x79CD;&#x539F;&#x56E0;&#x5F15;&#x8D77;&#x7684;&#xFF0C;&#x5BF9;&#x5305;&#x542B;&#x88AB;&#x505C;&#x6B62;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x65B0;&#x5B64;&#x513F;&#x8FDB;&#x7A0B;&#x7EC4;&#x7684;&#x5904;&#x7406;&#x662F;&#x4E00;&#x6837;&#x7684;&#x3002;</p>
<p>&#x5411;&#x5305;&#x542B;&#x88AB;&#x505C;&#x6B62;&#x7684;&#x6210;&#x5458;&#x7684;&#x65B0;&#x5B64;&#x513F;&#x8FDB;&#x7A0B;&#x7EC4;&#x53D1;&#x9001;SIGHUP&#x548C;SIGCONT&#x4FE1;&#x53F7;&#x662F;&#x4E3A;&#x4E86;&#x6D88;&#x9664;&#x4EFB;&#x52A1;&#x63A7;&#x5236;&#x6846;&#x67B6;&#x4E2D;&#x7684;&#x7279;&#x5B9A;&#x6F0F;&#x6D1E;&#xFF0C;&#x56E0;&#x4E3A;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x63AA;&#x65BD;&#x80FD;&#x591F;&#x9632;&#x6B62;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#xFF08;&#x62E5;&#x6709;&#x5408;&#x9002;&#x7684;&#x6743;&#x9650;&#xFF09;&#x5411;&#x5B64;&#x513F;&#x8FDB;&#x7A0B;&#x7EC4;&#x4E2D;&#x7684;&#x6210;&#x5458;&#x53D1;&#x9001;&#x505C;&#x6B62;&#x4FE1;&#x53F7;&#x6765;&#x505C;&#x6B62;&#x5B83;&#x4EEC;&#x3002;&#x8FD9;&#x6837;&#xFF0C;&#x8FDB;&#x7A0B;&#x5C31;&#x4F1A;&#x4FDD;&#x6301;&#x5728;&#x505C;&#x6B62;&#x7684;&#x72B6;&#x6001;&#xFF0C;&#x76F4;&#x5230;&#x4E00;&#x4E9B;&#x8FDB;&#x7A0B;&#xFF08;&#x540C;&#x6837;&#x9700;&#x8981;&#x62E5;&#x6709;&#x5408;&#x9002;&#x7684;&#x6743;&#x9650;&#xFF09;&#x5411;&#x5B83;&#x4EEC;&#x53D1;&#x9001;&#x4E00;&#x4E2A;SIGCONT&#x4FE1;&#x53F7;&#x3002;</p>
<p>&#x5B64;&#x513F;&#x8FDB;&#x7A0B;&#x7EC4;&#x4E2D;&#x7684;&#x6210;&#x5458;&#x5728;&#x8C03;&#x7528;tcsetpgrp()&#x51FD;&#x6570;&#x65F6;&#x4F1A;&#x5F97;&#x5230;ENOTTY&#x7684;&#x9519;&#x8BEF;&#xFF0C;&#x5728;&#x8C03;&#x7528;tcsetattr()&#x3001;tcflush()&#x3001;tcflow()&#x3001;tcsendbreak()&#x548C;tcdrain()&#x51FD;&#x6570;&#x65F6;&#x4F1A;&#x5F97;&#x5230;EIO&#x7684;&#x9519;&#x8BEF;&#x3002;</p>
<h1 id="&#x8FDB;&#x7A0B;&#x4F18;&#x5148;&#x7EA7;&#x548C;&#x8C03;&#x5EA6;"><a href="#&#x8FDB;&#x7A0B;&#x4F18;&#x5148;&#x7EA7;&#x548C;&#x8C03;&#x5EA6;" class="headerlink" title="&#x8FDB;&#x7A0B;&#x4F18;&#x5148;&#x7EA7;&#x548C;&#x8C03;&#x5EA6;"></a>&#x8FDB;&#x7A0B;&#x4F18;&#x5148;&#x7EA7;&#x548C;&#x8C03;&#x5EA6;</h1><h2 id="&#x8FDB;&#x7A0B;&#x4F18;&#x5148;&#x7EA7;&#xFF08;nice&#x503C;&#xFF09;"><a href="#&#x8FDB;&#x7A0B;&#x4F18;&#x5148;&#x7EA7;&#xFF08;nice&#x503C;&#xFF09;" class="headerlink" title="&#x8FDB;&#x7A0B;&#x4F18;&#x5148;&#x7EA7;&#xFF08;nice&#x503C;&#xFF09;"></a>&#x8FDB;&#x7A0B;&#x4F18;&#x5148;&#x7EA7;&#xFF08;nice&#x503C;&#xFF09;</h2><p>Linux&#x4E0E;&#x5927;&#x591A;&#x6570;&#x5176;&#x4ED6;UNIX&#x5B9E;&#x73B0;&#x4E00;&#x6837;&#xFF0C;&#x8C03;&#x5EA6;&#x8FDB;&#x7A0B;&#x4F7F;&#x7528;CPU&#x7684;&#x9ED8;&#x8BA4;&#x6A21;&#x578B;&#x662F;&#x5FAA;&#x73AF;&#x65F6;&#x95F4;&#x5171;&#x4EAB;&#x3002;&#x5728;&#x8FD9;&#x79CD;&#x6A21;&#x578B;&#x4E2D;&#xFF0C;&#x6BCF;&#x4E2A;&#x8FDB;&#x7A0B;&#x8F6E;&#x6D41;&#x4F7F;&#x7528;CPU&#x4E00;&#x6BB5;&#x65F6;&#x95F4;&#xFF0C;&#x8FD9;&#x6BB5;&#x65F6;&#x95F4;&#x88AB;&#x79F0;&#x4E3A;&#x65F6;&#x95F4;&#x7247;&#x6216;&#x91CF;&#x5B50;&#x3002;&#x5FAA;&#x73AF;&#x65F6;&#x95F4;&#x5171;&#x4EAB;&#x6EE1;&#x8DB3;&#x4E86;&#x4EA4;&#x4E92;&#x5F0F;&#x591A;&#x4EFB;&#x52A1;&#x7CFB;&#x7EDF;&#x7684;&#x4E24;&#x4E2A;&#x91CD;&#x8981;&#x9700;&#x6C42;&#x3002;</p>
<ul>
<li>&#x516C;&#x5E73;&#x6027;&#xFF1A;&#x6BCF;&#x4E2A;&#x8FDB;&#x7A0B;&#x90FD;&#x6709;&#x673A;&#x4F1A;&#x7528;&#x5230;CPU&#x3002;</li>
<li>&#x54CD;&#x5E94;&#x5EA6;&#xFF1A;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x5728;&#x4F7F;&#x7528;CPU&#x4E4B;&#x524D;&#x65E0;&#x9700;&#x7B49;&#x5F85;&#x592A;&#x957F;&#x7684;&#x65F6;&#x95F4;&#x3002;</li>
</ul>
<p>&#x5728;&#x5FAA;&#x73AF;&#x65F6;&#x95F4;&#x5171;&#x4EAB;&#x7B97;&#x6CD5;&#x4E2D;&#xFF0C;&#x8FDB;&#x7A0B;&#x65E0;&#x6CD5;&#x76F4;&#x63A5;&#x63A7;&#x5236;&#x4F55;&#x65F6;&#x4F7F;&#x7528;CPU&#x4EE5;&#x53CA;&#x4F7F;&#x7528;CPU&#x7684;&#x65F6;&#x95F4;&#x3002;&#x5728;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x6BCF;&#x4E2A;&#x8FDB;&#x7A0B;&#x8F6E;&#x6D41;&#x4F7F;&#x7528;CPU&#x76F4;&#x81F3;&#x65F6;&#x95F4;&#x7247;&#x88AB;&#x7528;&#x5149;&#x6216;&#x81EA;&#x5DF1;&#x81EA;&#x52A8;&#x653E;&#x5F03;CPU&#xFF08;&#x5982;&#x8FDB;&#x884C;&#x7761;&#x7720;&#x6216;&#x6267;&#x884C;&#x4E00;&#x4E2A;&#x78C1;&#x76D8;&#x8BFB;&#x53D6;&#x64CD;&#x4F5C;&#xFF09;&#x3002;&#x5982;&#x679C;&#x6240;&#x6709;&#x8FDB;&#x7A0B;&#x90FD;&#x8BD5;&#x56FE;&#x5C3D;&#x53EF;&#x80FD;&#x591A;&#x5730;&#x4F7F;&#x7528;CPU&#xFF08;&#x5373;&#x6CA1;&#x6709;&#x8FDB;&#x7A0B;&#x4F1A;&#x7761;&#x7720;&#x6216;&#x88AB;I/O&#x64CD;&#x4F5C;&#x963B;&#x585E;&#xFF09;&#xFF0C;&#x90A3;&#x4E48;&#x5B83;&#x4EEC;&#x4F7F;&#x7528;CPU&#x7684;&#x65F6;&#x95F4;&#x5DEE;&#x4E0D;&#x591A;&#x662F;&#x76F8;&#x7B49;&#x7684;&#x3002;</p>
<p>&#x8FDB;&#x7A0B;&#x7279;&#x6027;nice&#x503C;&#x5141;&#x8BB8;&#x8FDB;&#x7A0B;&#x95F4;&#x63A5;&#x5730;&#x5F71;&#x54CD;&#x5185;&#x6838;&#x7684;&#x8C03;&#x5EA6;&#x7B97;&#x6CD5;&#x3002;&#x6BCF;&#x4E2A;&#x8FDB;&#x7A0B;&#x90FD;&#x62E5;&#x6709;&#x4E00;&#x4E2A;nice&#x503C;&#xFF0C;&#x5176;&#x53D6;&#x503C;&#x8303;&#x56F4;&#x4E3A;&#x2212;20&#xFF08;&#x9AD8;&#x4F18;&#x5148;&#x7EA7;&#xFF09;&#xFF5E;19&#xFF08;&#x4F4E;&#x4F18;&#x5148;&#x7EA7;&#xFF09;&#xFF0C;&#x9ED8;&#x8BA4;&#x503C;&#x4E3A;0&#x3002;&#x5728;&#x4F20;&#x7EDF;&#x7684;UNIX&#x5B9E;&#x73B0;&#x4E2D;&#xFF0C;&#x53EA;&#x6709;&#x7279;&#x6743;&#x8FDB;&#x7A0B;&#x624D;&#x80FD;&#x591F;&#x8D4B;&#x7ED9;&#x81EA;&#x5DF1;&#xFF08;&#x6216;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#xFF09;&#x4E00;&#x4E2A;&#x8D1F;&#xFF08;&#x9AD8;&#xFF09;&#x4F18;&#x5148;&#x7EA7;&#x3002;&#x975E;&#x7279;&#x6743;&#x8FDB;&#x7A0B;&#x53EA;&#x80FD;&#x964D;&#x4F4E;&#x81EA;&#x5DF1;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#xFF0C;&#x5373;&#x8D4B;&#x4E00;&#x4E2A;&#x5927;&#x4E8E;&#x9ED8;&#x8BA4;&#x503C;0&#x7684;nice&#x503C;&#x3002;&#x8FD9;&#x6837;&#x505A;&#x4E4B;&#x540E;&#x5B83;&#x4EEC;&#x5C31;&#x5BF9;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x201C;&#x53CB;&#x597D;&#xFF08;nice&#xFF09;&#x201D;&#x4E86;&#xFF0C;&#x8FD9;&#x4E2A;&#x7279;&#x6027;&#x7684;&#x540D;&#x79F0;&#x4E5F;&#x7531;&#x6B64;&#x800C;&#x6765;&#x3002;</p>
<p>&#x4F7F;&#x7528;fork()&#x521B;&#x5EFA;&#x5B50;&#x8FDB;&#x7A0B;&#x65F6;&#x4F1A;&#x7EE7;&#x627F;nice&#x503C;&#x5E76;&#x4E14;&#x8BE5;&#x503C;&#x4F1A;&#x5728;exec()&#x8C03;&#x7528;&#x4E2D;&#x5F97;&#x5230;&#x4FDD;&#x6301;&#x3002;</p>
<p>getpriority()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x670D;&#x52A1;&#x4F8B;&#x7A0B;&#x4E0D;&#x4F1A;&#x8FD4;&#x56DE;&#x5B9E;&#x9645;&#x7684;nice&#x503C;&#xFF0C;&#x76F8;&#x53CD;&#xFF0C;&#x5B83;&#x4F1A;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x8303;&#x56F4;&#x5728;1&#xFF08;&#x4F4E;&#x4F18;&#x5148;&#x7EA7;&#xFF09;&#xFF5E;40&#xFF08;&#x9AD8;&#x4F18;&#x5148;&#x7EA7;&#xFF09;&#x4E4B;&#x95F4;&#x7684;&#x6570;&#x5B57;&#xFF0C;&#x8FD9;&#x4E2A;&#x6570;&#x5B57;&#x662F;&#x901A;&#x8FC7;&#x516C;&#x5F0F;unice=20-knice&#x8BA1;&#x7B97;&#x5F97;&#x6765;&#x7684;&#x3002;&#x8FD9;&#x6837;&#x505A;&#x662F;&#x4E3A;&#x4E86;&#x907F;&#x514D;&#x8BA9;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x670D;&#x52A1;&#x4F8B;&#x7A0B;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x8D1F;&#x503C;&#xFF0C;&#x56E0;&#x4E3A;&#x8D1F;&#x503C;&#x4E00;&#x822C;&#x90FD;&#x8868;&#x793A;&#x9519;&#x8BEF;&#x3002;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x662F;&#x4E0D;&#x6E05;&#x695A;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x670D;&#x52A1;&#x4F8B;&#x7A0B;&#x5BF9;&#x8FD4;&#x56DE;&#x503C;&#x6240;&#x505A;&#x7684;&#x5904;&#x7406;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;C&#x5E93;&#x51FD;&#x6570;getpriority()&#x505A;&#x4E86;&#x76F8;&#x53CD;&#x7684;&#x8BA1;&#x7B97;&#x64CD;&#x4F5C;&#xFF0C;&#x5B83;&#x5C06;20-unice&#x503C;&#x8FD4;&#x56DE;&#x7ED9;&#x4E86;&#x8C03;&#x7528;&#x7A0B;&#x5E8F;&#x3002;</p>
<h3 id="nice&#x503C;&#x7684;&#x5F71;&#x54CD;"><a href="#nice&#x503C;&#x7684;&#x5F71;&#x54CD;" class="headerlink" title="nice&#x503C;&#x7684;&#x5F71;&#x54CD;"></a>nice&#x503C;&#x7684;&#x5F71;&#x54CD;</h3><p>&#x8FDB;&#x7A0B;&#x7684;&#x8C03;&#x5EA6;&#x4E0D;&#x662F;&#x4E25;&#x683C;&#x6309;&#x7167;nice&#x503C;&#x7684;&#x5C42;&#x6B21;&#x8FDB;&#x884C;&#x7684;&#xFF0C;&#x76F8;&#x53CD;&#xFF0C;nice&#x503C;&#x662F;&#x4E00;&#x4E2A;&#x6743;&#x91CD;&#x56E0;&#x7D20;&#xFF0C;&#x5B83;&#x5BFC;&#x81F4;&#x5185;&#x6838;&#x8C03;&#x5EA6;&#x5668;&#x503E;&#x5411;&#x4E8E;&#x8C03;&#x5EA6;&#x62E5;&#x6709;&#x9AD8;&#x4F18;&#x5148;&#x7EA7;&#x7684;&#x8FDB;&#x7A0B;&#x3002;&#x7ED9;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x8D4B;&#x4E00;&#x4E2A;&#x4F4E;&#x4F18;&#x5148;&#x7EA7;&#xFF08;&#x5373;&#x9AD8;nice&#x503C;&#xFF09;&#x5E76;&#x4E0D;&#x4F1A;&#x5BFC;&#x81F4;&#x5B83;&#x5B8C;&#x5168;&#x65E0;&#x6CD5;&#x7528;&#x5230;CPU&#xFF0C;&#x4F46;&#x4F1A;&#x5BFC;&#x81F4;&#x5B83;&#x4F7F;&#x7528;CPU&#x7684;&#x65F6;&#x95F4;&#x53D8;&#x5C11;&#x3002;nice&#x503C;&#x5BF9;&#x8FDB;&#x7A0B;&#x8C03;&#x5EA6;&#x7684;&#x5F71;&#x54CD;&#x7A0B;&#x5EA6;&#x5219;&#x4F9D;&#x636E;Linux&#x5185;&#x6838;&#x7248;&#x672C;&#x7684;&#x4E0D;&#x540C;&#x800C;&#x4E0D;&#x540C;&#xFF0C;&#x540C;&#x65F6;&#x5728;&#x4E0D;&#x540C;UNIX&#x7CFB;&#x7EDF;&#x4E4B;&#x95F4;&#x4E5F;&#x662F;&#x4E0D;&#x540C;&#x7684;&#x3002;</p>
<p>&#x4ECE;&#x7248;&#x672C;&#x53F7;&#x4E3A;2.6.23&#x7684;&#x5185;&#x6838;&#x5F00;&#x59CB;&#xFF0C;nice&#x503C;&#x4E4B;&#x95F4;&#x7684;&#x5DEE;&#x522B;&#x5BF9;&#x65B0;&#x5185;&#x6838;&#x8C03;&#x5EA6;&#x7B97;&#x6CD5;&#x7684;&#x5F71;&#x54CD;&#x6BD4;&#x5BF9;&#x4E4B;&#x524D;&#x7684;&#x5185;&#x6838;&#x4E2D;&#x7684;&#x8C03;&#x5EA6;&#x7B97;&#x6CD5;&#x7684;&#x5F71;&#x54CD;&#x8981;&#x5F3A;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x4F4E;nice&#x503C;&#x7684;&#x8FDB;&#x7A0B;&#x4F7F;&#x7528;CPU&#x7684;&#x65F6;&#x95F4;&#x5C06;&#x6BD4;&#x4EE5;&#x524D;&#x5C11;&#xFF0C;&#x9AD8;nice&#x503C;&#x7684;&#x8FDB;&#x7A0B;&#x5360;&#x7528;CPU&#x7684;&#x65F6;&#x95F4;&#x5C06;&#x5927;&#x5927;&#x63D0;&#x9AD8;&#x3002;</p>
<h3 id="&#x83B7;&#x53D6;&#x548C;&#x4FEE;&#x6539;&#x4F18;&#x5148;&#x7EA7;"><a href="#&#x83B7;&#x53D6;&#x548C;&#x4FEE;&#x6539;&#x4F18;&#x5148;&#x7EA7;" class="headerlink" title="&#x83B7;&#x53D6;&#x548C;&#x4FEE;&#x6539;&#x4F18;&#x5148;&#x7EA7;"></a>&#x83B7;&#x53D6;&#x548C;&#x4FEE;&#x6539;&#x4F18;&#x5148;&#x7EA7;</h3><p>getpriority()&#x548C;setpriority()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5141;&#x8BB8;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x83B7;&#x53D6;&#x548C;&#x4FEE;&#x6539;&#x81EA;&#x8EAB;&#x6216;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x7684;nice&#x503C;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;sys/resource.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">getpriority</span><span class="token punctuation">(</span><span class="token keyword">int</span> which<span class="token punctuation">,</span>id_t who<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">setpriority</span><span class="token punctuation">(</span><span class="token keyword">int</span> which<span class="token punctuation">,</span>id_t who<span class="token punctuation">,</span><span class="token keyword">int</span> prio<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x4E24;&#x4E2A;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x90FD;&#x63A5;&#x6536;&#x53C2;&#x6570;which&#x548C;who&#xFF0C;&#x8FD9;&#x4E24;&#x4E2A;&#x53C2;&#x6570;&#x7528;&#x4E8E;&#x6807;&#x8BC6;&#x9700;&#x8BFB;&#x53D6;&#x6216;&#x4FEE;&#x6539;&#x4F18;&#x5148;&#x7EA7;&#x7684;&#x8FDB;&#x7A0B;&#x3002;which&#x53C2;&#x6570;&#x786E;&#x5B9A;who&#x53C2;&#x6570;&#x5982;&#x4F55;&#x88AB;&#x89E3;&#x91CA;&#x3002;&#x8FD9;&#x4E2A;&#x53C2;&#x6570;&#x7684;&#x53D6;&#x503C;&#x4E3A;&#x4E0B;&#x9762;&#x8FD9;&#x4E9B;&#x503C;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x3002;<br><code>PRIO_PROCESS</code><br>&#x64CD;&#x4F5C;&#x8FDB;&#x7A0B;ID&#x4E3A;who&#x7684;&#x8FDB;&#x7A0B;&#x3002;&#x5982;&#x679C;who&#x4E3A;0&#xFF0C;&#x90A3;&#x4E48;&#x4F7F;&#x7528;&#x8C03;&#x7528;&#x8005;&#x7684;&#x8FDB;&#x7A0B;ID&#x3002;</p>
<p><code>PRIO_PGRP</code><br>&#x64CD;&#x4F5C;&#x8FDB;&#x7A0B;&#x7EC4;ID&#x4E3A;who&#x7684;&#x8FDB;&#x7A0B;&#x7EC4;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x6210;&#x5458;&#x3002;&#x5982;&#x679C;who&#x4E3A;0&#xFF0C;&#x90A3;&#x4E48;&#x4F7F;&#x7528;&#x8C03;&#x7528;&#x8005;&#x7684;&#x8FDB;&#x7A0B;&#x7EC4;&#x3002;</p>
<p><code>PRIO_USER</code><br>&#x64CD;&#x4F5C;&#x6240;&#x6709;&#x771F;&#x5B9E;&#x7528;&#x6237;ID&#x4E3A;who&#x7684;&#x8FDB;&#x7A0B;&#x3002;&#x5982;&#x679C;who&#x4E3A;0&#xFF0C;&#x90A3;&#x4E48;&#x4F7F;&#x7528;&#x8C03;&#x7528;&#x8005;&#x7684;&#x771F;&#x5B9E;&#x7528;&#x6237;ID&#x3002;</p>
<p>who&#x53C2;&#x6570;&#x7684;&#x7C7B;&#x578B;id_t&#x662F;&#x4E00;&#x4E2A;&#x5927;&#x5C0F;&#x80FD;&#x5BB9;&#x7EB3;&#x8FDB;&#x7A0B;ID&#x6216;&#x7528;&#x6237;ID&#x7684;&#x6574;&#x578B;&#x3002;</p>
<p>getpriority()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x8FD4;&#x56DE;&#x7531;which&#x548C;who&#x6307;&#x5B9A;&#x7684;&#x8FDB;&#x7A0B;&#x7684;nice&#x503C;&#x3002;&#x5982;&#x679C;&#x6709;&#x591A;&#x4E2A;&#x8FDB;&#x7A0B;&#x7B26;&#x5408;&#x6307;&#x5B9A;&#x7684;&#x6807;&#x51C6;&#xFF08;&#x5F53;which&#x4E3A;PRIO_PGRP&#x6216;PRIO_USER&#x65F6;&#x4F1A;&#x51FA;&#x73B0;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#xFF09;&#xFF0C;&#x90A3;&#x4E48;&#x5C06;&#x4F1A;&#x8FD4;&#x56DE;&#x4F18;&#x5148;&#x7EA7;&#x6700;&#x9AD8;&#x7684;&#x8FDB;&#x7A0B;&#x7684;nice&#x503C;&#xFF08;&#x5373;&#x6700;&#x5C0F;&#x7684;&#x6570;&#x503C;&#xFF09;&#x3002;&#x7531;&#x4E8E;getpriority()&#x53EF;&#x80FD;&#x4F1A;&#x5728;&#x6210;&#x529F;&#x65F6;&#x8FD4;&#x56DE;&#x2212;1&#xFF0C;&#x56E0;&#x6B64;&#x5728;&#x8C03;&#x7528;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4E4B;&#x524D;&#x5FC5;&#x987B;&#x8981;&#x5C06;errno&#x8BBE;&#x7F6E;&#x4E3A;0&#xFF0C;&#x63A5;&#x7740;&#x5728;&#x8C03;&#x7528;&#x4E4B;&#x540E;&#x68C0;&#x67E5;&#x8FD4;&#x56DE;&#x503C;&#x4E3A;&#x2212;1&#x4EE5;&#x53CA;errno&#x4E0D;&#x4E3A;0&#x624D;&#x80FD;&#x786E;&#x8BA4;&#x8C03;&#x7528;&#x6210;&#x529F;&#x3002;</p>
<p>setpriority()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x4F1A;&#x5C06;&#x7531;which&#x548C;who&#x6307;&#x5B9A;&#x7684;&#x8FDB;&#x7A0B;&#x7684;nice&#x503C;&#x8BBE;&#x7F6E;&#x4E3A;prio&#x3002;&#x8BD5;&#x56FE;&#x5C06;nice&#x503C;&#x8BBE;&#x7F6E;&#x4E3A;&#x4E00;&#x4E2A;&#x8D85;&#x51FA;&#x5141;&#x8BB8;&#x8303;&#x56F4;&#x7684;&#x503C;&#xFF08;-20&#xFF5E;+19&#xFF09;&#x65F6;&#x4F1A;&#x76F4;&#x63A5;&#x5C06;nice&#x503C;&#x8BBE;&#x7F6E;&#x4E3A;&#x8FB9;&#x754C;&#x503C;&#x3002;</p>
<p>&#x4EE5;&#x524D;nice&#x503C;&#x662F;&#x901A;&#x8FC7;&#x8C03;&#x7528;nice(incr)&#x6765;&#x5B8C;&#x6210;&#x7684;&#xFF0C;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4F1A;&#x5C06;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x7684;nice&#x503C;&#x52A0;&#x4E0A;incr&#x3002;&#x73B0;&#x5728;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4ECD;&#x7136;&#x662F;&#x53EF;&#x7528;&#x7684;&#xFF0C;&#x4F46;&#x5DF2;&#x7ECF;&#x88AB;&#x66F4;&#x901A;&#x7528;&#x7684;setpriority()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x6240;&#x53D6;&#x4EE3;&#x4E86;&#x3002;</p>
<p>&#x5728;&#x547D;&#x4EE4;&#x884C;&#x4E2D;&#x4E0E;setpriority()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5B9E;&#x73B0;&#x7C7B;&#x4F3C;&#x529F;&#x80FD;&#x7684;&#x547D;&#x4EE4;&#x662F;nice(1)&#xFF0C;&#x975E;&#x7279;&#x6743;&#x7528;&#x6237;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x547D;&#x4EE4;&#x6765;&#x8FD0;&#x884C;&#x4E00;&#x4E2A;&#x4F18;&#x5148;&#x7EA7;&#x66F4;&#x4F4E;&#x7684;&#x547D;&#x4EE4;&#xFF0C;&#x7279;&#x6743;&#x7528;&#x6237;&#x5219;&#x53EF;&#x4EE5;&#x8FD0;&#x884C;&#x4E00;&#x4E2A;&#x4F18;&#x5148;&#x7EA7;&#x66F4;&#x9AD8;&#x7684;&#x547D;&#x4EE4;&#xFF0C;&#x8D85;&#x7EA7;&#x7528;&#x6237;&#x5219;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;renice(8)&#x6765;&#x4FEE;&#x6539;&#x65E2;&#x6709;&#x8FDB;&#x7A0B;&#x7684;nice&#x503C;&#x3002;</p>
<p>&#x7279;&#x6743;&#x8FDB;&#x7A0B;&#xFF08;CAP_SYS_NICE&#xFF09;&#x80FD;&#x591F;&#x4FEE;&#x6539;&#x4EFB;&#x610F;&#x8FDB;&#x7A0B;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x3002;&#x975E;&#x7279;&#x6743;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x4FEE;&#x6539;&#x81EA;&#x5DF1;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#xFF08;&#x5C06;which&#x8BBE;&#x4E3A;PRIO_PROCESS&#xFF0C;who&#x8BBE;&#x4E3A;0&#xFF09;&#x548C;&#x5176;&#x4ED6;&#xFF08;&#x76EE;&#x6807;&#xFF09;&#x8FDB;&#x7A0B;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#xFF0C;&#x524D;&#x63D0;&#x662F;&#x81EA;&#x5DF1;&#x7684;&#x6709;&#x6548;&#x7528;&#x6237;ID&#x4E0E;&#x76EE;&#x6807;&#x8FDB;&#x7A0B;&#x7684;&#x771F;&#x5B9E;&#x6216;&#x6709;&#x6548;&#x7528;&#x6237;ID&#x5339;&#x914D;&#x3002;Linux&#x4E2D;setpriority()&#x7684;&#x6743;&#x9650;&#x89C4;&#x5219;&#x4E0E;SUSv3&#x4E2D;&#x7684;&#x89C4;&#x5219;&#x4E0D;&#x540C;&#xFF0C;&#x5B83;&#x89C4;&#x5B9A;&#x5F53;&#x975E;&#x7279;&#x6743;&#x8FDB;&#x7A0B;&#x7684;&#x771F;&#x5B9E;&#x6216;&#x6709;&#x6548;&#x7528;&#x6237;ID&#x4E0E;&#x76EE;&#x6807;&#x8FDB;&#x7A0B;&#x7684;&#x6709;&#x6548;&#x7528;&#x6237;ID&#x5339;&#x914D;&#x65F6;&#xFF0C;&#x8BE5;&#x8FDB;&#x7A0B;&#x5C31;&#x80FD;&#x4FEE;&#x6539;&#x76EE;&#x6807;&#x8FDB;&#x7A0B;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x3002;UNIX&#x5B9E;&#x73B0;&#x5728;&#x8FD9;&#x4E00;&#x70B9;&#x4E0A;&#x4E0E;Linux&#x6709;&#x4E9B;&#x4E0D;&#x540C;&#x3002;&#x4E00;&#x4E9B;&#x5B9E;&#x73B0;&#x9075;&#x5FAA;&#x7684;SUSv3&#x7684;&#x89C4;&#x5219;&#xFF0C;&#x800C;&#x53E6;&#x4E00;&#x4E9B;&#x2014;&#x2014;&#x7279;&#x522B;&#x662F;BSD&#x7CFB;&#x5217;&#x2014;&#x2014;&#x4E0E;Linux&#x7684;&#x884C;&#x4E3A;&#x65B9;&#x5F0F;&#x4E00;&#x6837;&#x3002;</p>
<p>&#x7248;&#x672C;&#x53F7;&#x5C0F;&#x4E8E;2.6.12&#x7684;Linux&#x5185;&#x6838;&#x4E0E;&#x4E4B;&#x540E;&#x7684;&#x5185;&#x6838;&#x5BF9;&#x975E;&#x7279;&#x6743;&#x8FDB;&#x7A0B;&#x8C03;&#x7528;setpriority()&#x65F6;&#x4F7F;&#x7528;&#x7684;&#x6743;&#x9650;&#x89C4;&#x5219;&#x4E0D;&#x540C;&#xFF08;&#x4E5F;&#x4E0E;SUSv3&#x4E0D;&#x540C;&#xFF09;&#x3002;&#x5F53;&#x975E;&#x7279;&#x6743;&#x8FDB;&#x7A0B;&#x7684;&#x771F;&#x5B9E;&#x6216;&#x6709;&#x6548;&#x7528;&#x6237;ID&#x4E0E;&#x76EE;&#x6807;&#x8FDB;&#x7A0B;&#x7684;&#x771F;&#x5B9E;&#x7528;&#x6237;ID&#x5339;&#x914D;&#x65F6;&#xFF0C;&#x8BE5;&#x8FDB;&#x7A0B;&#x5C31;&#x80FD;&#x4FEE;&#x6539;&#x76EE;&#x6807;&#x8FDB;&#x7A0B;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x3002;&#x4ECE;Linux 2.6.12&#x5F00;&#x59CB;&#xFF0C;&#x6743;&#x9650;&#x68C0;&#x67E5;&#x53D8;&#x5F97;&#x4E0E;Linux&#x4E2D;&#x7C7B;&#x4F3C;&#x7684;API&#x4E00;&#x81F4;&#x4E86;&#xFF0C;&#x5982;sched_setscheduler()&#x548C;sched_setaffinity()&#x3002;</p>
<p>&#x5728;&#x7248;&#x672C;&#x53F7;&#x5C0F;&#x4E8E;2.6.12&#x7684;Linux&#x5185;&#x6838;&#x4E2D;&#xFF0C;&#x975E;&#x7279;&#x6743;&#x8FDB;&#x7A0B;&#x53EA;&#x80FD;&#x4F7F;&#x7528;setpriority()&#x6765;&#x964D;&#x4F4E;&#xFF08;&#x4E0D;&#x53EF;&#x9006;&#x7684;&#xFF09;&#x81EA;&#x5DF1;&#x6216;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x7684;nice&#x503C;&#x3002;&#x7279;&#x6743;&#x8FDB;&#x7A0B;&#xFF08;CAP_SYS_NICE&#xFF09;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;setpriority()&#x6765;&#x63D0;&#x9AD8;nice&#x503C;&#x3002;</p>
<p>&#x4ECE;&#x7248;&#x672C;&#x53F7;&#x4E3A;2.6.12&#x7684;&#x5185;&#x6838;&#x5F00;&#x59CB;&#xFF0C;Linux&#x63D0;&#x4F9B;&#x4E86;RLIMIT_NICE&#x8D44;&#x6E90;&#x9650;&#x5236;&#xFF0C;&#x5373;&#x5141;&#x8BB8;&#x975E;&#x7279;&#x6743;&#x8FDB;&#x7A0B;&#x63D0;&#x5347;nice&#x503C;&#x3002;&#x975E;&#x7279;&#x6743;&#x8FDB;&#x7A0B;&#x80FD;&#x591F;&#x5C06;&#x81EA;&#x5DF1;&#x7684;nice&#x503C;&#x6700;&#x9AD8;&#x63D0;&#x9AD8;&#x5230;&#x516C;&#x5F0F;20&#x2212;rlim_cur&#x6307;&#x5B9A;&#x7684;&#x503C;&#xFF0C;&#x5176;&#x4E2D;rlim_cur&#x662F;&#x5F53;&#x524D;&#x7684;RLIMIT_NICE&#x8F6F;&#x8D44;&#x6E90;&#x9650;&#x5236;&#x3002;&#x5982;&#x5047;&#x8BBE;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7684;RLIMIT_NICE&#x8F6F;&#x9650;&#x5236;&#x662F;25&#xFF0C;&#x90A3;&#x4E48;&#x5176;nice&#x503C;&#x53EF;&#x4EE5;&#x88AB;&#x63D0;&#x9AD8;&#x5230;&#x2212;5&#x3002;&#x6839;&#x636E;&#x8FD9;&#x4E2A;&#x516C;&#x5F0F;&#x4EE5;&#x53CA;nice&#x503C;&#x7684;&#x53D6;&#x503C;&#x8303;&#x56F4;&#x4E3A;+19&#xFF08;&#x4F4E;&#xFF09;&#xFF5E;&#x2212;20&#xFF08;&#x9AD8;&#xFF09;&#x7684;&#x4E8B;&#x5B9E;&#x53EF;&#x4EE5;&#x5F97;&#x51FA;RLIMIT_NICE&#x7684;&#x6709;&#x6548;&#x8303;&#x56F4;&#x4E3A;1&#xFF08;&#x4F4E;&#xFF09;&#xFF5E;40&#xFF08;&#x9AD8;&#xFF09;&#x7684;&#x7ED3;&#x8BBA;&#x3002;&#xFF08;RLIMIT_NICE&#x6CA1;&#x6709;&#x4F7F;&#x7528;&#x8303;&#x56F4;&#x4E3A;+19&#xFF5E;&#x2212;20&#x4E4B;&#x95F4;&#x7684;&#x503C;&#xFF0C;&#x56E0;&#x4E3A;&#x4E00;&#x4E9B;&#x8D1F;&#x7684;&#x8D44;&#x6E90;&#x9650;&#x5236;&#x503C;&#x5177;&#x6709;&#x7279;&#x6B8A;&#x542B;&#x4E49;&#x2014;&#x2014;&#x5982;RLIM_INFINITY&#x53EF;&#x4EE5;&#x4E3A;&#x2212;1&#x3002;&#xFF09;</p>
<p>&#x975E;&#x7279;&#x6743;&#x8FDB;&#x7A0B;&#x80FD;&#x591F;&#x901A;&#x8FC7;setpriority()&#x8C03;&#x7528;&#x6765;&#x4FEE;&#x6539;&#x5176;&#x4ED6;&#xFF08;&#x76EE;&#x6807;&#xFF09;&#x8FDB;&#x7A0B;&#x7684;nice&#x503C;&#xFF0C;&#x524D;&#x63D0;&#x662F;&#x8C03;&#x7528;setpriority()&#x7684;&#x8FDB;&#x7A0B;&#x7684;&#x6709;&#x6548;&#x7528;&#x6237;ID&#x4E0E;&#x76EE;&#x6807;&#x8FDB;&#x7A0B;&#x7684;&#x771F;&#x5B9E;&#x6216;&#x6709;&#x6548;&#x7528;&#x6237;ID&#x5339;&#x914D;&#x5E76;&#x4E14;&#x5BF9;nice&#x503C;&#x7684;&#x4FEE;&#x6539;&#x7B26;&#x5408;&#x76EE;&#x6807;&#x8FDB;&#x7A0B;&#x7684;RLIMIT_NIC&#x9650;&#x5236;&#x3002;</p>
<h2 id="&#x5B9E;&#x65F6;&#x8FDB;&#x7A0B;&#x8C03;&#x5EA6;&#x6982;&#x8FF0;"><a href="#&#x5B9E;&#x65F6;&#x8FDB;&#x7A0B;&#x8C03;&#x5EA6;&#x6982;&#x8FF0;" class="headerlink" title="&#x5B9E;&#x65F6;&#x8FDB;&#x7A0B;&#x8C03;&#x5EA6;&#x6982;&#x8FF0;"></a>&#x5B9E;&#x65F6;&#x8FDB;&#x7A0B;&#x8C03;&#x5EA6;&#x6982;&#x8FF0;</h2><p>&#x5728;&#x4E00;&#x4E2A;&#x7CFB;&#x7EDF;&#x4E0A;&#x4E00;&#x822C;&#x4F1A;&#x540C;&#x65F6;&#x8FD0;&#x884C;&#x4EA4;&#x4E92;&#x5F0F;&#x8FDB;&#x7A0B;&#x548C;&#x540E;&#x53F0;&#x8FDB;&#x7A0B;&#xFF0C;&#x6807;&#x51C6;&#x7684;&#x5185;&#x6838;&#x8C03;&#x5EA6;&#x7B97;&#x6CD5;&#x4E00;&#x822C;&#x80FD;&#x591F;&#x4E3A;&#x8FD9;&#x4E9B;&#x8FDB;&#x7A0B;&#x63D0;&#x4F9B;&#x8DB3;&#x591F;&#x7684;&#x6027;&#x80FD;&#x548C;&#x54CD;&#x5E94;&#x5EA6;&#x3002;&#x4F46;&#x5B9E;&#x65F6;&#x5E94;&#x7528;&#x5BF9;&#x8C03;&#x5EA6;&#x5668;&#x6709;&#x66F4;&#x52A0;&#x4E25;&#x683C;&#x7684;&#x8981;&#x6C42;&#xFF0C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#x3002;</p>
<ul>
<li>&#x5B9E;&#x65F6;&#x5E94;&#x7528;&#x5FC5;&#x987B;&#x8981;&#x4E3A;&#x5916;&#x90E8;&#x8F93;&#x5165;&#x63D0;&#x4F9B;&#x62C5;&#x4FDD;&#x6700;&#x5927;&#x54CD;&#x5E94;&#x65F6;&#x95F4;&#x3002;&#x5728;&#x5F88;&#x591A;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x8FD9;&#x4E9B;&#x62C5;&#x4FDD;&#x6700;&#x5927;&#x54CD;&#x5E94;&#x65F6;&#x95F4;&#x5FC5;&#x987B;&#x975E;&#x5E38;&#x77ED;&#xFF08;&#x5982;&#x4F4E;&#x4E8E;&#x79D2;&#x7EA7;&#xFF09;&#x3002;&#x5982;&#x4EA4;&#x901A;&#x5BFC;&#x822A;&#x7CFB;&#x7EDF;&#x7684;&#x6162;&#x901F;&#x54CD;&#x5E94;&#x53EF;&#x80FD;&#x4F1A;&#x4F7F;&#x4E00;&#x4E2A;&#x707E;&#x96BE;&#x3002;&#x4E3A;&#x4E86;&#x6EE1;&#x8DB3;&#x8FD9;&#x79CD;&#x8981;&#x6C42;&#xFF0C;&#x5185;&#x6838;&#x5FC5;&#x987B;&#x8981;&#x63D0;&#x4F9B;&#x5DE5;&#x5177;&#x8BA9;&#x9AD8;&#x4F18;&#x5148;&#x7EA7;&#x8FDB;&#x7A0B;&#x80FD;&#x5FEB;&#x901F;&#x5730;&#x53D6;&#x5F97;CPU&#x7684;&#x63A7;&#x5236;&#x6743;&#xFF0C;&#x62A2;&#x5360;&#x5F53;&#x524D;&#x8FD0;&#x884C;&#x7684;&#x6240;&#x6709;&#x8FDB;&#x7A0B;&#x3002;</li>
<li>&#x9AD8;&#x4F18;&#x5148;&#x7EA7;&#x8FDB;&#x7A0B;&#x5E94;&#x8BE5;&#x80FD;&#x591F;&#x4FDD;&#x6301;&#x4E92;&#x65A5;&#x5730;&#x8BBF;&#x95EE;CPU&#x76F4;&#x81F3;&#x5B83;&#x5B8C;&#x6210;&#x6216;&#x81EA;&#x52A8;&#x91CA;&#x653E;CPU&#x3002;</li>
<li>&#x5B9E;&#x65F6;&#x5E94;&#x7528;&#x5E94;&#x8BE5;&#x80FD;&#x591F;&#x7CBE;&#x786E;&#x5730;&#x63A7;&#x5236;&#x5176;&#x7EC4;&#x4EF6;&#x8FDB;&#x7A0B;&#x7684;&#x8C03;&#x5EA6;&#x987A;&#x5E8F;&#x3002;</li>
</ul>
<p>SUSv3&#x89C4;&#x5B9A;&#x7684;&#x5B9E;&#x65F6;&#x8FDB;&#x7A0B;&#x8C03;&#x5EA6; API&#xFF08;&#x539F;&#x5148;&#x5728;POSIX.1b&#x4E2D;&#x5B9A;&#x4E49;&#xFF09;&#x90E8;&#x5206;&#x6EE1;&#x8DB3;&#x4E86;&#x8FD9;&#x4E9B;&#x8981;&#x6C42;&#x3002;&#x8FD9;&#x4E2A;API&#x63D0;&#x4F9B;&#x4E86;&#x4E24;&#x4E2A;&#x5B9E;&#x65F6;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#xFF1A;SCHED_RR&#x548C;SCHED_FIFO&#x3002;&#x4F7F;&#x7528;&#x8FD9;&#x4E24;&#x79CD;&#x7B56;&#x7565;&#x4E2D;&#x4EFB;&#x610F;&#x4E00;&#x79CD;&#x7B56;&#x7565;&#x8FDB;&#x884C;&#x8C03;&#x5EA6;&#x7684;&#x8FDB;&#x7A0B;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x8981;&#x9AD8;&#x4E8E;&#x4F7F;&#x7528;&#x4E0A;&#x4E00;&#x8282;&#x4E2D;&#x4ECB;&#x7ECD;&#x7684;&#x6807;&#x51C6;&#x5FAA;&#x73AF;&#x65F6;&#x95F4;&#x5206;&#x4EAB;&#x7B56;&#x7565;&#x6765;&#x8C03;&#x5EA6;&#x7684;&#x8FDB;&#x7A0B;&#xFF0C;&#x5B9E;&#x65F6;&#x8C03;&#x5EA6;API&#x4F7F;&#x7528;&#x5E38;&#x91CF;SCHED_OTHER&#x6765;&#x6807;&#x8BC6;&#x8FD9;&#x79CD;&#x5FAA;&#x73AF;&#x65F6;&#x95F4;&#x5206;&#x4EAB;&#x7B56;&#x7565;&#x3002;</p>
<p>&#x6BCF;&#x4E2A;&#x5B9E;&#x65F6;&#x7B56;&#x7565;&#x5141;&#x8BB8;&#x4E00;&#x4E2A;&#x4F18;&#x5148;&#x7EA7;&#x8303;&#x56F4;&#x3002;SUSv3&#x8981;&#x6C42;&#x5B9E;&#x73B0;&#x81F3;&#x5C11;&#x8981;&#x4E3A;&#x5B9E;&#x65F6;&#x7B56;&#x7565;&#x63D0;&#x4F9B;32&#x4E2A;&#x79BB;&#x6563;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x3002;&#x5728;&#x6BCF;&#x4E2A;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#x4E2D;&#xFF0C;&#x62E5;&#x6709;&#x9AD8;&#x4F18;&#x5148;&#x7EA7;&#x7684;&#x53EF;&#x8FD0;&#x884C;&#x8FDB;&#x7A0B;&#x5728;&#x5C1D;&#x8BD5;&#x8BBF;&#x95EE;CPU&#x65F6;&#x603B;&#x662F;&#x4F18;&#x5148;&#x4E8E;&#x4F18;&#x5148;&#x7EA7;&#x8F83;&#x4F4E;&#x7684;&#x8FDB;&#x7A0B;&#x3002;</p>
<p>&#x5BF9;&#x4E8E;&#x591A;&#x5904;&#x7406;&#x5668;Linux&#x7CFB;&#x7EDF;&#xFF08;&#x5305;&#x62EC;&#x8D85;&#x7EBF;&#x7A0B;&#x7CFB;&#x7EDF;&#xFF09;&#x6765;&#x8BB2;&#xFF0C;&#x9AD8;&#x4F18;&#x5148;&#x7EA7;&#x7684;&#x53EF;&#x8FD0;&#x884C;&#x8FDB;&#x7A0B;&#x603B;&#x662F;&#x4F18;&#x5148;&#x4E8E;&#x4F18;&#x5148;&#x7EA7;&#x8F83;&#x4F4E;&#x7684;&#x8FDB;&#x7A0B;&#x7684;&#x89C4;&#x5219;&#x5E76;&#x4E0D;&#x9002;&#x7528;&#x3002;&#x5728;&#x591A;&#x5904;&#x7406;&#x5668;&#x7CFB;&#x7EDF;&#x4E2D;&#xFF0C;&#x5404;&#x4E2A;CPU&#x62E5;&#x6709;&#x72EC;&#x7ACB;&#x7684;&#x8FD0;&#x884C;&#x961F;&#x5217;&#xFF08;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x6BD4;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x7CFB;&#x7EDF;&#x5C42;&#x9762;&#x7684;&#x8FD0;&#x884C;&#x961F;&#x5217;&#x7684;&#x6027;&#x80FD;&#x8981;&#x597D;&#xFF09;&#xFF0C;&#x5E76;&#x4E14;&#x6BCF;&#x4E2A;CPU&#x7684;&#x8FD0;&#x884C;&#x961F;&#x5217;&#x4E2D;&#x7684;&#x8FDB;&#x7A0B;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x90FD;&#x5C40;&#x9650;&#x4E8E;&#x8BE5;&#x961F;&#x5217;&#x3002;&#x5982;&#x5047;&#x8BBE;&#x4E00;&#x4E2A;&#x53CC;&#x5904;&#x7406;&#x5668;&#x7CFB;&#x7EDF;&#x4E2D;&#x8FD0;&#x884C;&#x7740;&#x4E09;&#x4E2A;&#x8FDB;&#x7A0B;&#xFF0C;&#x8FDB;&#x7A0B;A&#x7684;&#x5B9E;&#x65F6;&#x4F18;&#x5148;&#x7EA7;&#x4E3A;20&#xFF0C;&#x5E76;&#x4E14;&#x5B83;&#x4F4D;&#x4E8E;CPU 0&#x7684;&#x7B49;&#x5F85;&#x961F;&#x5217;&#x4E2D;&#xFF0C;&#x800C;&#x8BE5;CPU&#x5F53;&#x524D;&#x6B63;&#x5728;&#x8FD0;&#x884C;&#x4F18;&#x5148;&#x7EA7;&#x4E3A;30&#x7684;&#x8FDB;&#x7A0B;B&#xFF0C;&#x5373;&#x4F7F;CPU 1&#x6B63;&#x5728;&#x8FD0;&#x884C;&#x4F18;&#x5148;&#x7EA7;&#x4E3A;10&#x7684;&#x8FDB;&#x7A0B;C&#xFF0C;&#x8FDB;&#x7A0B;A&#x8FD8;&#x662F;&#x9700;&#x8981;&#x7B49;&#x5F85;CPU 0&#x3002;</p>
<p>&#x5305;&#x542B;&#x591A;&#x4E2A;&#x8FDB;&#x7A0B;&#x7684;&#x5B9E;&#x65F6;&#x5E94;&#x7528;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;CPU&#x4EB2;&#x548C;&#x529B;API&#x6765;&#x907F;&#x514D;&#x8FD9;&#x79CD;&#x8C03;&#x5EA6;&#x884C;&#x4E3A;&#x53EF;&#x80FD;&#x5F15;&#x8D77;&#x7684;&#x95EE;&#x9898;&#x3002;&#x5982;&#x5728;&#x4E00;&#x4E2A;&#x56DB;&#x5904;&#x7406;&#x5668;&#x7CFB;&#x7EDF;&#x4E2D;&#xFF0C;&#x6240;&#x6709;&#x975E;&#x5173;&#x952E;&#x7684;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x88AB;&#x5206;&#x914D;&#x5230;&#x4E00;&#x4E2A;CPU&#x4E2D;&#xFF0C;&#x8BA9;&#x5176;&#x4ED6;&#x4E09;&#x4E2A;CPU&#x5904;&#x7406;&#x5B9E;&#x65F6;&#x5E94;&#x7528;&#x3002;</p>
<p>Linux&#x63D0;&#x4F9B;&#x4E86; 99&#x4E2A;&#x5B9E;&#x65F6;&#x4F18;&#x5148;&#x7EA7;&#xFF0C;&#x5176;&#x6570;&#x503C;&#x4ECE;1&#xFF08;&#x6700;&#x4F4E;&#xFF09;&#xFF5E;99&#xFF08;&#x6700;&#x9AD8;&#xFF09;&#xFF0C;&#x5E76;&#x4E14;&#x8FD9;&#x4E2A;&#x53D6;&#x503C;&#x8303;&#x56F4;&#x540C;&#x65F6;&#x9002;&#x7528;&#x4E8E;&#x4E24;&#x4E2A;&#x5B9E;&#x65F6;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#x3002;&#x6BCF;&#x4E2A;&#x7B56;&#x7565;&#x4E2D;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x662F;&#x7B49;&#x4EF7;&#x7684;&#x3002;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x5982;&#x679C;&#x4E24;&#x4E2A;&#x8FDB;&#x7A0B;&#x62E5;&#x6709;&#x540C;&#x6837;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#xFF0C;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x91C7;&#x7528;&#x4E86;SCHED_RR&#x7684;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#xFF0C;&#x53E6;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x91C7;&#x7528;&#x4E86;SCHED_FIFO&#x7684;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#xFF0C;&#x90A3;&#x4E48;&#x4E24;&#x4E2A;&#x90FD;&#x7B26;&#x5408;&#x8FD0;&#x884C;&#x7684;&#x6761;&#x4EF6;&#xFF0C;&#x81F3;&#x4E8E;&#x5230;&#x5E95;&#x8FD0;&#x884C;&#x54EA;&#x4E2A;&#x5219;&#x53D6;&#x51B3;&#x4E8E;&#x5B83;&#x4EEC;&#x88AB;&#x8C03;&#x5EA6;&#x7684;&#x987A;&#x5E8F;&#x4E86;&#x3002;&#x5B9E;&#x9645;&#x4E0A;&#xFF0C;&#x6BCF;&#x4E2A;&#x4F18;&#x5148;&#x7EA7;&#x7EA7;&#x522B;&#x90FD;&#x7EF4;&#x62A4;&#x7740;&#x4E00;&#x4E2A;&#x53EF;&#x8FD0;&#x884C;&#x7684;&#x8FDB;&#x7A0B;&#x961F;&#x5217;&#xFF0C;&#x4E0B;&#x4E00;&#x4E2A;&#x8FD0;&#x884C;&#x7684;&#x8FDB;&#x7A0B;&#x662F;&#x4ECE;&#x4F18;&#x5148;&#x7EA7;&#x6700;&#x9AD8;&#x7684;&#x975E;&#x7A7A;&#x961F;&#x5217;&#x7684;&#x961F;&#x5934;&#x9009;&#x53D6;&#x51FA;&#x6765;&#x7684;&#x3002;</p>
<h3 id="POSIX&#x5B9E;&#x65F6;&#x4E0E;&#x786C;&#x5B9E;&#x65F6;&#x5BF9;&#x6BD4;"><a href="#POSIX&#x5B9E;&#x65F6;&#x4E0E;&#x786C;&#x5B9E;&#x65F6;&#x5BF9;&#x6BD4;" class="headerlink" title="POSIX&#x5B9E;&#x65F6;&#x4E0E;&#x786C;&#x5B9E;&#x65F6;&#x5BF9;&#x6BD4;"></a>POSIX&#x5B9E;&#x65F6;&#x4E0E;&#x786C;&#x5B9E;&#x65F6;&#x5BF9;&#x6BD4;</h3><p>&#x6EE1;&#x8DB3;&#x672C;&#x8282;&#x5F00;&#x5934;&#x5904;&#x5217;&#x51FA;&#x7684;&#x6240;&#x6709;&#x8981;&#x6C42;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x6709;&#x65F6;&#x5019;&#x88AB;&#x79F0;&#x4E3A;&#x786C;&#x5B9E;&#x65F6;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x3002;&#x4F46;POSIX&#x5B9E;&#x65F6;&#x8FDB;&#x7A0B;&#x8C03;&#x5EA6;API&#x65E0;&#x6CD5;&#x6EE1;&#x8DB3;&#x8FD9;&#x4E9B;&#x8981;&#x6C42;&#x3002;&#x7279;&#x522B;&#x662F;&#x5B83;&#x6CA1;&#x6709;&#x4E3A;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x63D0;&#x4F9B;&#x4E00;&#x79CD;&#x673A;&#x5236;&#x6765;&#x786E;&#x4FDD;&#x5904;&#x7406;&#x8F93;&#x5165;&#x7684;&#x54CD;&#x5E94;&#x65F6;&#x95F4;&#xFF0C;&#x800C;&#x8FD9;&#x79CD;&#x673A;&#x5236;&#x9700;&#x8981;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x7684;&#x63D0;&#x4F9B;&#x76F8;&#x5E94;&#x7684;&#x7279;&#x6027;&#xFF0C;&#x4F46;Linux&#x5185;&#x6838;&#x5E76;&#x6CA1;&#x6709;&#x63D0;&#x4F9B;&#x8FD9;&#x79CD;&#x7279;&#x6027;&#xFF08;&#x5927;&#x591A;&#x6570;&#x5176;&#x4ED6;&#x6807;&#x51C6;&#x7684;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x4E5F;&#x6CA1;&#x6709;&#x63D0;&#x4F9B;&#x8FD9;&#x79CD;&#x7279;&#x6027;&#xFF09;&#x3002;POSIX API&#x4EC5;&#x4EC5;&#x63D0;&#x4F9B;&#x4E86;&#x6240;&#x8C13;&#x7684;&#x8F6F;&#x5B9E;&#x65F6;&#xFF0C;&#x5141;&#x8BB8;&#x63A7;&#x5236;&#x8C03;&#x5EA6;&#x54EA;&#x4E2A;&#x8FDB;&#x7A0B;&#x4F7F;&#x7528;CPU&#x3002;</p>
<p>&#x5728;&#x4E0D;&#x7ED9;&#x7CFB;&#x7EDF;&#x589E;&#x52A0;&#x989D;&#x5916;&#x5F00;&#x9500;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x589E;&#x52A0;&#x5BF9;&#x786C;&#x5B9E;&#x65F6;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x652F;&#x6301;&#x662F;&#x975E;&#x5E38;&#x56F0;&#x96BE;&#x7684;&#xFF0C;&#x8FD9;&#x79CD;&#x65B0;&#x589E;&#x7684;&#x5F00;&#x9500;&#x901A;&#x5E38;&#x4E0E;&#x65F6;&#x95F4;&#x5206;&#x4EAB;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x6027;&#x80FD;&#x8981;&#x6C42;&#x662F;&#x5B58;&#x5728;&#x51B2;&#x7A81;&#x7684;&#xFF0C;&#x800C;&#x5178;&#x578B;&#x7684;&#x684C;&#x9762;&#x548C;&#x670D;&#x52A1;&#x5668;&#x7CFB;&#x7EDF;&#x4E0A;&#x8FD0;&#x884C;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5927;&#x90E8;&#x5206;&#x90FD;&#x662F;&#x65F6;&#x95F4;&#x5206;&#x4EAB;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x3002;&#x8FD9;&#x5C31;&#x662F;&#x4E3A;&#x4F55;&#x5927;&#x591A;&#x6570;UNIX&#x5185;&#x6838;&#x2014;&#x2014;&#x5305;&#x62EC;&#x539F;&#x6765;&#x7684;Linux&#x2014;&#x2014;&#x5E76;&#x6CA1;&#x6709;&#x4E3A;&#x5B9E;&#x65F6;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x63D0;&#x4F9B;&#x539F;&#x751F;&#x652F;&#x6301;&#x7684;&#x539F;&#x56E0;&#x3002;&#x4F46;&#x4ECE;&#x7248;&#x672C;2.6.18&#x5F00;&#x59CB;&#xFF0C;&#x5404;&#x79CD;&#x7279;&#x6027;&#x90FD;&#x88AB;&#x6DFB;&#x52A0;&#x5230;&#x4E86;Linux&#x5185;&#x6838;&#x4E2D;&#xFF0C;&#x4ECE;&#x800C;&#x5141;&#x8BB8;Linux&#x4E3A;&#x786C;&#x5B9E;&#x65F6;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x63D0;&#x4F9B;&#x4E86;&#x5B8C;&#x5168;&#x7684;&#x539F;&#x751F;&#x652F;&#x6301;&#xFF0C;&#x540C;&#x65F6;&#x4E0D;&#x4F1A;&#x7ED9;&#x65F6;&#x95F4;&#x5206;&#x4EAB;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x589E;&#x52A0;&#x524D;&#x9762;&#x63D0;&#x53CA;&#x5230;&#x7684;&#x5F00;&#x9500;&#x3002;</p>
<h3 id="SCHED-RR&#x7B56;&#x7565;"><a href="#SCHED-RR&#x7B56;&#x7565;" class="headerlink" title="SCHED_RR&#x7B56;&#x7565;"></a>SCHED_RR&#x7B56;&#x7565;</h3><p>&#x5728;SCHED_RR&#xFF08;&#x5FAA;&#x73AF;&#xFF09;&#x7B56;&#x7565;&#x4E2D;&#xFF0C;&#x4F18;&#x5148;&#x7EA7;&#x76F8;&#x540C;&#x7684;&#x8FDB;&#x7A0B;&#x4EE5;&#x5FAA;&#x73AF;&#x65F6;&#x95F4;&#x5206;&#x4EAB;&#x7684;&#x65B9;&#x5F0F;&#x6267;&#x884C;&#x3002;&#x8FDB;&#x7A0B;&#x6BCF;&#x6B21;&#x4F7F;&#x7528;CPU&#x7684;&#x65F6;&#x95F4;&#x4E3A;&#x4E00;&#x4E2A;&#x56FA;&#x5B9A;&#x957F;&#x5EA6;&#x7684;&#x65F6;&#x95F4;&#x7247;&#x3002;&#x4E00;&#x65E6;&#x88AB;&#x8C03;&#x5EA6;&#x6267;&#x884C;&#x4E4B;&#x540E;&#xFF0C;&#x4F7F;&#x7528;SCHED_RR&#x7B56;&#x7565;&#x7684;&#x8FDB;&#x7A0B;&#x4F1A;&#x4FDD;&#x6301;&#x5BF9;CPU&#x7684;&#x63A7;&#x5236;&#x76F4;&#x5230;&#x4E0B;&#x5217;&#x6761;&#x4EF6;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x5F97;&#x5230;&#x6EE1;&#x8DB3;&#xFF1A;</p>
<ul>
<li>&#x8FBE;&#x5230;&#x65F6;&#x95F4;&#x7247;&#x7684;&#x7EC8;&#x70B9;&#x4E86;&#xFF1B;</li>
<li>&#x81EA;&#x613F;&#x653E;&#x5F03;CPU&#xFF0C;&#x8FD9;&#x53EF;&#x80FD;&#x662F;&#x7531;&#x4E8E;&#x6267;&#x884C;&#x4E86;&#x4E00;&#x4E2A;&#x963B;&#x585E;&#x5F0F;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x6216;&#x8C03;&#x7528;&#x4E86;sched_yield()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF08;35.3.3&#x8282;&#x5C06;&#x4E88;&#x4EE5;&#x4ECB;&#x7ECD;&#xFF09;&#xFF1B;</li>
<li>&#x7EC8;&#x6B62;&#x4E86;&#xFF1B;</li>
<li>&#x88AB;&#x4E00;&#x4E2A;&#x4F18;&#x5148;&#x7EA7;&#x66F4;&#x9AD8;&#x7684;&#x8FDB;&#x7A0B;&#x62A2;&#x5360;&#x4E86;&#x3002;</li>
</ul>
<p>&#x5BF9;&#x4E8E;&#x4E0A;&#x9762;&#x5217;&#x51FA;&#x7684;&#x524D;&#x4E24;&#x4E2A;&#x4E8B;&#x4EF6;&#xFF0C;&#x5F53;&#x8FD0;&#x884C;&#x5728;SCHED_RR&#x7B56;&#x7565;&#x4E0B;&#x7684;&#x8FDB;&#x7A0B;&#x4E22;&#x6389;CPU&#x4E4B;&#x540E;&#x5C06;&#x4F1A;&#x88AB;&#x653E;&#x7F6E;&#x5728;&#x4E0E;&#x5176;&#x4F18;&#x5148;&#x7EA7;&#x7EA7;&#x522B;&#x5BF9;&#x5E94;&#x7684;&#x961F;&#x5217;&#x7684;&#x961F;&#x5C3E;&#x3002;&#x5728;&#x6700;&#x540E;&#x4E00;&#x79CD;&#x60C5;&#x51B5;&#x4E2D;&#xFF0C;&#x5F53;&#x4F18;&#x5148;&#x7EA7;&#x66F4;&#x9AD8;&#x7684;&#x8FDB;&#x7A0B;&#x6267;&#x884C;&#x7ED3;&#x675F;&#x4E4B;&#x540E;&#xFF0C;&#x88AB;&#x62A2;&#x5360;&#x7684;&#x8FDB;&#x7A0B;&#x4F1A;&#x7EE7;&#x7EED;&#x6267;&#x884C;&#x76F4;&#x5230;&#x5176;&#x65F6;&#x95F4;&#x7247;&#x7684;&#x5269;&#x4F59;&#x90E8;&#x5206;&#x88AB;&#x6D88;&#x8017;&#x5B8C;&#xFF08;&#x5373;&#x88AB;&#x62A2;&#x5360;&#x7684;&#x8FDB;&#x7A0B;&#x4ECD;&#x7136;&#x4F4D;&#x4E8E;&#x4E0E;&#x5176;&#x4F18;&#x5148;&#x7EA7;&#x7EA7;&#x522B;&#x5BF9;&#x5E94;&#x7684;&#x961F;&#x5217;&#x7684;&#x961F;&#x5934;&#xFF09;&#x3002;</p>
<p>&#x5728;SCHED_RR&#x548C;SCHED_FIFO&#x4E24;&#x79CD;&#x7B56;&#x7565;&#x4E2D;&#xFF0C;&#x5F53;&#x524D;&#x8FD0;&#x884C;&#x7684;&#x8FDB;&#x7A0B;&#x53EF;&#x80FD;&#x4F1A;&#x56E0;&#x4E3A;&#x4E0B;&#x9762;&#x67D0;&#x4E2A;&#x539F;&#x56E0;&#x800C;&#x88AB;&#x62A2;&#x5360;&#xFF1A;</p>
<ul>
<li>&#x4E4B;&#x524D;&#x88AB;&#x963B;&#x585E;&#x7684;&#x9AD8;&#x4F18;&#x5148;&#x7EA7;&#x8FDB;&#x7A0B;&#x89E3;&#x9664;&#x963B;&#x585E;&#x4E86;&#xFF08;&#x5982;&#x5B83;&#x6240;&#x7B49;&#x5F85;&#x7684;I/O&#x64CD;&#x4F5C;&#x5B8C;&#x6210;&#x4E86;&#xFF09;&#xFF1B;</li>
<li>&#x53E6;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x88AB;&#x63D0;&#x5230;&#x4E86;&#x4E00;&#x4E2A;&#x7EA7;&#x522B;&#x9AD8;&#x4E8E;&#x5F53;&#x524D;&#x8FD0;&#x884C;&#x7684;&#x8FDB;&#x7A0B;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#xFF1B;</li>
<li>&#x5F53;&#x524D;&#x8FD0;&#x884C;&#x7684;&#x8FDB;&#x7A0B;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x88AB;&#x964D;&#x4F4E;&#x5230;&#x4F4E;&#x4E8E;&#x5176;&#x4ED6;&#x53EF;&#x8FD0;&#x884C;&#x7684;&#x8FDB;&#x7A0B;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x4E86;&#x3002;</li>
</ul>
<p>SCHED_RR&#x7B56;&#x7565;&#x4E0E;&#x6807;&#x51C6;&#x7684;&#x5FAA;&#x73AF;&#x65F6;&#x95F4;&#x5206;&#x4EAB;&#x8C03;&#x5EA6;&#x7B97;&#x6CD5;&#xFF08;SCHED_OTHER&#xFF09;&#x7C7B;&#x4F3C;&#xFF0C;&#x5373;&#x5B83;&#x4E5F;&#x5141;&#x8BB8;&#x4F18;&#x5148;&#x7EA7;&#x76F8;&#x540C;&#x7684;&#x4E00;&#x7EC4;&#x8FDB;&#x7A0B;&#x5206;&#x4EAB;CPU&#x65F6;&#x95F4;&#x3002;&#x5B83;&#x4EEC;&#x4E4B;&#x95F4;&#x6700;&#x91CD;&#x8981;&#x7684;&#x5DEE;&#x522B;&#x5728;&#x4E8E;SCHED_RR&#x7B56;&#x7565;&#x5B58;&#x5728;&#x4E25;&#x683C;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x7EA7;&#x522B;&#xFF0C;&#x9AD8;&#x4F18;&#x5148;&#x7EA7;&#x7684;&#x8FDB;&#x7A0B;&#x603B;&#x662F;&#x4F18;&#x5148;&#x4E8E;&#x4F18;&#x5148;&#x7EA7;&#x8F83;&#x4F4E;&#x7684;&#x8FDB;&#x7A0B;&#x3002;&#x800C;&#x5728;SCHED_OTHER&#x7B56;&#x7565;&#x4E2D;&#xFF0C;&#x4F4E;nice&#x503C;&#xFF08;&#x5373;&#x9AD8;&#x4F18;&#x5148;&#x7EA7;&#xFF09;&#x7684;&#x8FDB;&#x7A0B;&#x4E0D;&#x4F1A;&#x72EC;&#x5360;CPU&#xFF0C;&#x5B83;&#x4EC5;&#x4EC5;&#x5728;&#x8C03;&#x5EA6;&#x51B3;&#x7B56;&#x65F6;&#x4E3A;&#x8FDB;&#x7A0B;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x8F83;&#x5927;&#x7684;&#x6743;&#x91CD;&#x3002;&#x4E00;&#x4E2A;&#x4F18;&#x5148;&#x7EA7;&#x8F83;&#x4F4E;&#x7684;&#x8FDB;&#x7A0B;&#xFF08;&#x5373;&#x9AD8;nice&#x503C;&#xFF09;&#x603B;&#x662F;&#x81F3;&#x5C11;&#x4F1A;&#x7528;&#x5230;&#x4E00;&#x4E9B;CPU&#x65F6;&#x95F4;&#x7684;&#x3002;&#x5B83;&#x4EEC;&#x4E4B;&#x95F4;&#x53E6;&#x4E00;&#x4E2A;&#x91CD;&#x8981;&#x7684;&#x5DEE;&#x522B;&#x662F;SCHED_RR&#x7B56;&#x7565;&#x5141;&#x8BB8;&#x7CBE;&#x786E;&#x63A7;&#x5236;&#x8FDB;&#x7A0B;&#x88AB;&#x8C03;&#x7528;&#x7684;&#x987A;&#x5E8F;&#x3002;</p>
<h3 id="SCHED-FIFO&#x7B56;&#x7565;"><a href="#SCHED-FIFO&#x7B56;&#x7565;" class="headerlink" title="SCHED_FIFO&#x7B56;&#x7565;"></a>SCHED_FIFO&#x7B56;&#x7565;</h3><p>SCHED_FIFO&#xFF08;&#x5148;&#x5165;&#x5148;&#x51FA;&#xFF0C;first-in&#xFF0C;first-out&#xFF09;&#x7B56;&#x7565;&#x4E0E;SCHED_RR&#x7B56;&#x7565;&#x7C7B;&#x4F3C;&#xFF0C;&#x5B83;&#x4EEC;&#x4E4B;&#x95F4;&#x6700;&#x4E3B;&#x8981;&#x7684;&#x5DEE;&#x522B;&#x5728;&#x4E8E;&#x5728;SCHED_FIFO&#x7B56;&#x7565;&#x4E2D;&#x4E0D;&#x5B58;&#x5728;&#x65F6;&#x95F4;&#x7247;&#x3002;&#x4E00;&#x65E6;&#x4E00;&#x4E2A;SCHED_FIFO&#x8FDB;&#x7A0B;&#x83B7;&#x5F97;&#x4E86;CPU&#x7684;&#x63A7;&#x5236;&#x6743;&#x4E4B;&#x540E;&#xFF0C;&#x5B83;&#x5C31;&#x4F1A;&#x4E00;&#x76F4;&#x6267;&#x884C;&#x76F4;&#x5230;&#x4E0B;&#x9762;&#x67D0;&#x4E2A;&#x6761;&#x4EF6;&#x88AB;&#x6EE1;&#x8DB3;&#xFF1A;</p>
<ul>
<li>&#x81EA;&#x52A8;&#x653E;&#x5F03;CPU&#xFF08;&#x91C7;&#x7528;&#x7684;&#x65B9;&#x5F0F;&#x4E0E;&#x524D;&#x9762;&#x63CF;&#x8FF0;&#x7684;SCHED_FIFO&#x7B56;&#x7565;&#x4E2D;&#x7684;&#x65B9;&#x5F0F;&#x4E00;&#x6837;&#xFF09;&#xFF1B;</li>
<li>&#x7EC8;&#x6B62;&#x4E86;&#xFF1B;</li>
<li>&#x88AB;&#x4E00;&#x4E2A;&#x4F18;&#x5148;&#x7EA7;&#x66F4;&#x9AD8;&#x7684;&#x8FDB;&#x7A0B;&#x62A2;&#x5360;&#x4E86;&#xFF08;&#x573A;&#x666F;&#x4E0E;&#x524D;&#x9762;&#x63CF;&#x8FF0;&#x7684;SCHED_FIFO&#x7B56;&#x7565;&#x4E2D;&#x573A;&#x666F;&#x4E00;&#x6837;&#xFF09;&#x3002;</li>
</ul>
<p>&#x5728;&#x7B2C;&#x4E00;&#x79CD;&#x60C5;&#x51B5;&#x4E2D;&#xFF0C;&#x8FDB;&#x7A0B;&#x4F1A;&#x88AB;&#x653E;&#x7F6E;&#x5728;&#x4E0E;&#x5176;&#x4F18;&#x5148;&#x7EA7;&#x7EA7;&#x522B;&#x5BF9;&#x5E94;&#x7684;&#x961F;&#x5217;&#x7684;&#x961F;&#x5C3E;&#x3002;&#x5728;&#x6700;&#x540E;&#x4E00;&#x79CD;&#x60C5;&#x51B5;&#x4E2D;&#xFF0C;&#x5F53;&#x9AD8;&#x4F18;&#x5148;&#x7EA7;&#x8FDB;&#x7A0B;&#x6267;&#x884C;&#x7ED3;&#x675F;&#x4E4B;&#x540E;&#xFF08;&#x88AB;&#x963B;&#x585E;&#x6216;&#x7EC8;&#x6B62;&#x4E86;&#xFF09;&#xFF0C;&#x88AB;&#x62A2;&#x5360;&#x7684;&#x8FDB;&#x7A0B;&#x4F1A;&#x7EE7;&#x7EED;&#x6267;&#x884C;&#xFF08;&#x5373;&#x88AB;&#x62A2;&#x5360;&#x7684;&#x8FDB;&#x7A0B;&#x4F4D;&#x4E8E;&#x4E0E;&#x5176;&#x4F18;&#x5148;&#x7EA7;&#x7EA7;&#x522B;&#x5BF9;&#x5E94;&#x7684;&#x961F;&#x5217;&#x7684;&#x961F;&#x5934;&#xFF09;&#x3002;</p>
<h3 id="SCHED-BATCH&#x548C;SCHED-IDLE&#x7B56;&#x7565;"><a href="#SCHED-BATCH&#x548C;SCHED-IDLE&#x7B56;&#x7565;" class="headerlink" title="SCHED_BATCH&#x548C;SCHED_IDLE&#x7B56;&#x7565;"></a>SCHED_BATCH&#x548C;SCHED_IDLE&#x7B56;&#x7565;</h3><p>Linux 2.6&#x7CFB;&#x5217;&#x7684;&#x5185;&#x6838;&#x6DFB;&#x52A0;&#x4E86;&#x4E24;&#x4E2A;&#x975E;&#x6807;&#x51C6;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#xFF1A;SCHED_BATCH&#x548C;SCHED_IDLE&#x3002;&#x5C3D;&#x7BA1;&#x8FD9;&#x4E9B;&#x7B56;&#x7565;&#x662F;&#x901A;&#x8FC7;POSIX&#x5B9E;&#x65F6;&#x8C03;&#x5EA6;API&#x6765;&#x8BBE;&#x7F6E;&#x7684;&#xFF0C;&#x4F46;&#x5B9E;&#x9645;&#x4E0A;&#x5B83;&#x4EEC;&#x5E76;&#x4E0D;&#x662F;&#x5B9E;&#x65F6;&#x7B56;&#x7565;&#x3002;</p>
<p>SCHED_BATCH&#x7B56;&#x7565;&#x662F;&#x5728;&#x7248;&#x672C;&#x4E3A;2.6.16&#x7684;&#x5185;&#x6838;&#x4E2D;&#x52A0;&#x5165;&#x7684;&#xFF0C;&#x5B83;&#x4E0E;&#x9ED8;&#x8BA4;&#x7684;SCHED_OTHER&#x7B56;&#x7565;&#x7C7B;&#x4F3C;&#xFF0C;&#x4E24;&#x4E2A;&#x4E4B;&#x95F4;&#x7684;&#x5DEE;&#x522B;&#x5728;&#x4E8E;SCHED_BATCH&#x7B56;&#x7565;&#x4F1A;&#x5BFC;&#x81F4;&#x9891;&#x7E41;&#x88AB;&#x5524;&#x9192;&#x7684;&#x4EFB;&#x52A1;&#x88AB;&#x8C03;&#x5EA6;&#x7684;&#x6B21;&#x6570;&#x8F83;&#x5C11;&#x3002;&#x8FD9;&#x79CD;&#x7B56;&#x7565;&#x7528;&#x4E8E;&#x8FDB;&#x7A0B;&#x7684;&#x6279;&#x91CF;&#x5F0F;&#x6267;&#x884C;&#x3002;</p>
<p>SCHED_IDLE&#x7B56;&#x7565;&#x662F;&#x5728;&#x7248;&#x672C;&#x4E3A;2.6.23&#x7684;&#x5185;&#x6838;&#x4E2D;&#x52A0;&#x5165;&#x7684;&#xFF0C;&#x5B83;&#x4E5F;&#x4E0E;SCHED_OTHER&#x7C7B;&#x4F3C;&#xFF0C;&#x4F46;&#x63D0;&#x4F9B;&#x7684;&#x529F;&#x80FD;&#x7B49;&#x4EF7;&#x4E8E;&#x4E00;&#x4E2A;&#x975E;&#x5E38;&#x4F4E;&#x7684;nice&#x503C;&#xFF08;&#x5373;&#x4F4E;&#x4E8E;+19&#xFF09;&#x3002;&#x5728;&#x8FD9;&#x4E2A;&#x7B56;&#x7565;&#x4E2D;&#xFF0C;&#x8FDB;&#x7A0B;&#x7684;nice&#x503C;&#x6BEB;&#x65E0;&#x610F;&#x4E49;&#x3002;&#x5B83;&#x7528;&#x4E8E;&#x8FD0;&#x884C;&#x4F4E;&#x4F18;&#x5148;&#x7EA7;&#x7684;&#x4EFB;&#x52A1;&#xFF0C;&#x8FD9;&#x4E9B;&#x4EFB;&#x52A1;&#x5728;&#x7CFB;&#x7EDF;&#x4E2D;&#x6CA1;&#x6709;&#x5176;&#x4ED6;&#x4EFB;&#x52A1;&#x9700;&#x8981;&#x4F7F;&#x7528;CPU&#x65F6;&#x624D;&#x4F1A;&#x5927;&#x91CF;&#x4F7F;&#x7528;CPU&#x3002;</p>
<h2 id="&#x5B9E;&#x65F6;&#x8FDB;&#x7A0B;&#x8C03;&#x7528;API"><a href="#&#x5B9E;&#x65F6;&#x8FDB;&#x7A0B;&#x8C03;&#x7528;API" class="headerlink" title="&#x5B9E;&#x65F6;&#x8FDB;&#x7A0B;&#x8C03;&#x7528;API"></a>&#x5B9E;&#x65F6;&#x8FDB;&#x7A0B;&#x8C03;&#x7528;API</h2><p>&#x4E0B;&#x9762;&#x5F00;&#x59CB;&#x4ECB;&#x7ECD;&#x6784;&#x6210;&#x5B9E;&#x65F6;&#x8FDB;&#x7A0B;&#x8C03;&#x5EA6;API&#x7684;&#x5404;&#x4E2A;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x3002;&#x8FD9;&#x4E9B;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5141;&#x8BB8;&#x63A7;&#x5236;&#x8FDB;&#x7A0B;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#x548C;&#x4F18;&#x5148;&#x7EA7;&#x3002;</p>
<blockquote>
<p>&#x867D;&#x7136;&#x4ECE;2.0&#x5185;&#x6838;&#x5F00;&#x59CB;&#x5B9E;&#x65F6;&#x8C03;&#x5EA6;&#x5DF2;&#x7ECF;&#x662F;Linux&#x7684;&#x4E00;&#x90E8;&#x5206;&#x4E86;&#xFF0C;&#x4F46;&#x5728;&#x5B9E;&#x73B0;&#x4E2D;&#x51E0;&#x4E2A;&#x95EE;&#x9898;&#x5B58;&#x5728;&#x4E86;&#x5F88;&#x957F;&#x65F6;&#x95F4;&#x3002;&#x5728;2.2&#x5185;&#x6838;&#x7684;&#x5B9E;&#x73B0;&#x4E2D;&#x4E00;&#x4E9B;&#x7279;&#x6027;&#x4ECD;&#x7136;&#x65E0;&#x6CD5;&#x5DE5;&#x4F5C;&#xFF0C;&#x751A;&#x81F3;&#x5728;2.4&#x5185;&#x6838;&#x7684;&#x65E9;&#x671F;&#x7248;&#x672C;&#x4E2D;&#x4E5F;&#x662F;&#x540C;&#x6837;&#x7684;&#x60C5;&#x51B5;&#x3002;&#x5176;&#x4E2D;&#x5927;&#x591A;&#x6570;&#x95EE;&#x9898;&#x76F4;&#x5230;2.4.20&#x5185;&#x6838;&#x624D;&#x5F97;&#x4EE5;&#x4FEE;&#x6B63;&#x3002;</p>
</blockquote>
<h3 id="&#x5B9E;&#x65F6;&#x4F18;&#x5148;&#x7EA7;&#x8303;&#x56F4;"><a href="#&#x5B9E;&#x65F6;&#x4F18;&#x5148;&#x7EA7;&#x8303;&#x56F4;" class="headerlink" title="&#x5B9E;&#x65F6;&#x4F18;&#x5148;&#x7EA7;&#x8303;&#x56F4;"></a>&#x5B9E;&#x65F6;&#x4F18;&#x5148;&#x7EA7;&#x8303;&#x56F4;</h3><p>sched_get_priority_min()&#x548C;sched_get_priority_max()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x53D6;&#x503C;&#x8303;&#x56F4;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;sched.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">sched_get_priority_min</span><span class="token punctuation">(</span><span class="token keyword">int</span> policy<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">sched_get_priority_max</span><span class="token punctuation">(</span><span class="token keyword">int</span> policy<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x5728;&#x4E24;&#x4E2A;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x4E2D;&#xFF0C;policy&#x6307;&#x5B9A;&#x4E86;&#x9700;&#x83B7;&#x53D6;&#x54EA;&#x79CD;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#x7684;&#x4FE1;&#x606F;&#x3002;&#x8FD9;&#x4E2A;&#x53C2;&#x6570;&#x7684;&#x53D6;&#x503C;&#x4E00;&#x822C;&#x662F;SCHED_RR&#x6216;SCHED_FIFO&#x3002;sched_get_priority_min()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x8FD4;&#x56DE;&#x6307;&#x5B9A;&#x7B56;&#x7565;&#x7684;&#x6700;&#x5C0F;&#x4F18;&#x5148;&#x7EA7;&#xFF0C;sched_get_priority_max()&#x8FD4;&#x56DE;&#x6700;&#x5927;&#x4F18;&#x5148;&#x7EA7;&#x3002;&#x5728;Linux&#x4E0A;&#xFF0C;&#x8FD9;&#x4E9B;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x4E3A;SCHED_RR&#x548C;SCHED_FIFO&#x7B56;&#x7565;&#x5206;&#x522B;&#x8FD4;&#x56DE;&#x8303;&#x56F4;&#x4E3A;1&#x5230;99&#x7684;&#x6570;&#x5B57;&#x3002;&#x6362;&#x53E5;&#x8BDD;&#x8BF4;&#xFF0C;&#x4E24;&#x4E2A;&#x5B9E;&#x65F6;&#x7B56;&#x7565;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x53D6;&#x503C;&#x8303;&#x56F4;&#x662F;&#x5B8C;&#x5168;&#x4E00;&#x6837;&#x7684;&#xFF0C;&#x5E76;&#x4E14;&#x4F18;&#x5148;&#x7EA7;&#x76F8;&#x540C;&#x7684;SCHED_RR&#x548C;SCHED_FIFO&#x8FDB;&#x7A0B;&#x90FD;&#x5177;&#x5907;&#x88AB;&#x8C03;&#x5EA6;&#x7684;&#x8D44;&#x683C;&#x3002;&#xFF08;&#x81F3;&#x4E8E;&#x54EA;&#x4E2A;&#x8FDB;&#x7A0B;&#x5148;&#x88AB;&#x8C03;&#x5EA6;&#x5219;&#x53D6;&#x51B3;&#x4E8E;&#x5B83;&#x4EEC;&#x5728;&#x4F18;&#x5148;&#x7EA7;&#x7EA7;&#x522B;&#x961F;&#x5217;&#x4E2D;&#x7684;&#x987A;&#x5E8F;&#x3002;&#xFF09;</p>
<p>&#x4E0D;&#x540C;UNIX&#x5B9E;&#x73B0;&#x4E2D;&#x7684;&#x5B9E;&#x65F6;&#x7B56;&#x7565;&#x7684;&#x53D6;&#x503C;&#x8303;&#x56F4;&#x662F;&#x4E0D;&#x540C;&#x7684;&#x3002;&#x56E0;&#x6B64;&#x4E0D;&#x80FD;&#x5728;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E2D;&#x786C;&#x7F16;&#x7801;&#x4F18;&#x5148;&#x7EA7;&#x503C;&#xFF0C;&#x76F8;&#x53CD;&#xFF0C;&#x9700;&#x8981;&#x6839;&#x636E;&#x4E24;&#x4E2A;&#x51FD;&#x6570;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x6765;&#x6307;&#x5B9A;&#x4F18;&#x5148;&#x7EA7;&#x3002;&#x56E0;&#x6B64;&#xFF0C;SCHED_RR&#x7B56;&#x7565;&#x4E2D;&#x6700;&#x4F4E;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x5E94;&#x8BE5;&#x662F;sched_get_priority_min(SCHED_FIFO)&#xFF0C;&#x6BD4;&#x5B83;&#x9AD8;&#x4E00;&#x7EA7;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x662F;sched_get_priority_min&#xFF08;SCHED_FIFO&#xFF09;+1&#xFF0C;&#x4F9D;&#x6B64;&#x7C7B;&#x63A8;&#x3002;</p>
<p>SUSv3&#x5E76;&#x4E0D;&#x8981;&#x6C42;SCHED_RR&#x548C;SCHED_FIFO&#x7B56;&#x7565;&#x4F7F;&#x7528;&#x540C;&#x6837;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x8303;&#x56F4;&#xFF0C;&#x4F46;&#x5728;&#x5927;&#x591A;&#x6570;UNIX&#x5B9E;&#x73B0;&#x4E2D;&#x90FD;&#x662F;&#x8FD9;&#x6837;&#x505A;&#x7684;&#x3002;&#x5982;&#x5728;Solaris 8&#x4E2D;&#x4E24;&#x79CD;&#x7B56;&#x7565;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x8303;&#x56F4;&#x662F;0&#xFF5E;59&#xFF0C;&#x800C;&#x5728;FreeBSD 6.1&#x4E2D;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x8303;&#x56F4;&#x662F;0&#xFF5E;31&#x3002;</p>
<h3 id="&#x4FEE;&#x6539;&#x548C;&#x83B7;&#x53D6;&#x7B56;&#x7565;&#x548C;&#x4F18;&#x5148;&#x7EA7;"><a href="#&#x4FEE;&#x6539;&#x548C;&#x83B7;&#x53D6;&#x7B56;&#x7565;&#x548C;&#x4F18;&#x5148;&#x7EA7;" class="headerlink" title="&#x4FEE;&#x6539;&#x548C;&#x83B7;&#x53D6;&#x7B56;&#x7565;&#x548C;&#x4F18;&#x5148;&#x7EA7;"></a>&#x4FEE;&#x6539;&#x548C;&#x83B7;&#x53D6;&#x7B56;&#x7565;&#x548C;&#x4F18;&#x5148;&#x7EA7;</h3><p><strong>&#x4FEE;&#x6539;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#x548C;&#x4F18;&#x5148;&#x7EA7;</strong><br>sched_setscheduler()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x4FEE;&#x6539;&#x8FDB;&#x7A0B;ID&#x4E3A;pid&#x7684;&#x8FDB;&#x7A0B;&#x7684;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#x548C;&#x4F18;&#x5148;&#x7EA7;&#x3002;&#x5982;&#x679C;pid&#x4E3A;0&#xFF0C;&#x90A3;&#x4E48;&#x5C06;&#x4F1A;&#x4FEE;&#x6539;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x7684;&#x7279;&#x6027;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;sched.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">sched_setscheduler</span><span class="token punctuation">(</span>pid_t pid<span class="token punctuation">,</span> <span class="token keyword">int</span> policy<span class="token punctuation">,</span><span class="token keyword">const</span> <span class="token keyword">struct</span> sched_param <span class="token operator">*</span>param<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>param&#x53C2;&#x6570;&#x662F;&#x4E00;&#x4E2A;&#x6307;&#x5411;&#x4E0B;&#x9762;&#x8FD9;&#x79CD;&#x7ED3;&#x6784;&#x7684;&#x6307;&#x9488;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">struct</span> sched_param
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> sched_priority<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>SUSv3&#x5C06;param&#x53C2;&#x6570;&#x5B9A;&#x4E49;&#x6210;&#x4E00;&#x4E2A;&#x7ED3;&#x6784;&#x4EE5;&#x5141;&#x8BB8;&#x5B9E;&#x73B0;&#x5305;&#x542B;&#x989D;&#x5916;&#x7684;&#x7279;&#x5B9A;&#x4E8E;&#x5B9E;&#x73B0;&#x7684;&#x5B57;&#x6BB5;&#xFF0C;&#x5F53;&#x5B9E;&#x73B0;&#x63D0;&#x4F9B;&#x4E86;&#x989D;&#x5916;&#x7684;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#x65F6;&#x8FD9;&#x4E9B;&#x5B57;&#x6BB5;&#x53EF;&#x80FD;&#x4F1A;&#x53D8;&#x5F97;&#x6709;&#x7528;&#x3002;&#x4F46;&#x4E0E;&#x5927;&#x591A;&#x6570;UNIX&#x5B9E;&#x73B0;&#x4E00;&#x6837;&#xFF0C;Linux&#x63D0;&#x4F9B;&#x4E86;sched_priority&#x5B57;&#x6BB5;&#xFF0C;&#x8BE5;&#x5B57;&#x6BB5;&#x6307;&#x5B9A;&#x4E86;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#x3002;&#x5BF9;&#x4E8E; SCHED_RR&#x548C;SCHED_FIFO&#x6765;&#x8BB2;&#xFF0C;&#x8FD9;&#x4E2A;&#x5B57;&#x6BB5;&#x7684;&#x53D6;&#x503C;&#x5FC5;&#x987B;&#x4F4D;&#x4E8E; sched_get_priority_min()&#x548C; sched_get_priority_max()&#x89C4;&#x5B9A;&#x7684;&#x8303;&#x56F4;&#x5185;&#xFF1B;&#x5BF9;&#x4E8E;&#x5176;&#x4ED6;&#x7B56;&#x7565;&#x6765;&#x8BB2;&#xFF0C;&#x4F18;&#x5148;&#x7EA7;&#x5FC5;&#x987B;&#x662F;0&#x3002;</p>
<p>policy&#x53C2;&#x6570;&#x786E;&#x5B9A;&#x4E86;&#x8FDB;&#x7A0B;&#x7684;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#xFF0C;&#x5B83;&#x7684;&#x53D6;&#x503C;&#x4E3A;&#x4E0B;&#x8868;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x3002;</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th align="left">&#x7B56;&#x3000;&#x3000;&#x7565;</th>
<th align="center">&#x63CF;&#x3000;&#x3000;&#x8FF0;</th>
</tr>
</thead>
<tbody><tr>
<td align="left">SCHED_FIFO<br>SCHED_RR</td>
<td align="center">&#x5B9E;&#x65F6;&#x5148;&#x5165;&#x5148;&#x51FA; &#x5B9E;&#x65F6;&#x5FAA;&#x73AF;</td>
</tr>
<tr>
<td align="left">SCHED_OTHER<br>SCHED_BATCH<br>SCHED_IDLE</td>
<td align="center">&#x6807;&#x51C6;&#x7684;&#x5FAA;&#x73AF;&#x65F6;&#x95F4;&#x5206;&#x4EAB;<br>&#x4E0E;SCHED_OTHER&#x7C7B;&#x4F3C;&#xFF0C;&#x4F46;&#x7528;&#x4E8E;&#x6279;&#x91CF;&#x6267;&#x884C;&#xFF08;&#x81EA;Linux 2.6.16&#x8D77;&#xFF09;<br>&#x4E0E;SCHED_OTHER&#x7C7B;&#x4F3C;&#xFF0C;&#x4F46;&#x4F18;&#x5148;&#x7EA7;&#x6BD4;&#x6700;&#x5927;&#x7684;nice&#x503C;&#xFF08;+19&#xFF09;&#x8FD8;&#x8981;&#x4F4E;&#xFF08;&#x81EA;Linux 2.6.23&#x8D77;&#xFF09;</td>
</tr>
</tbody></table></div>
<p>&#x6210;&#x529F;&#x8C03;&#x7528;sched_setscheduler()&#x4F1A;&#x5C06;pid&#x6307;&#x5B9A;&#x7684;&#x8FDB;&#x7A0B;&#x79FB;&#x5230;&#x4E0E;&#x5176;&#x4F18;&#x5148;&#x7EA7;&#x7EA7;&#x522B;&#x5BF9;&#x5E94;&#x7684;&#x961F;&#x5217;&#x7684;&#x961F;&#x5C3E;&#x3002;</p>
<p>SUSv3&#x89C4;&#x5B9A;&#x6210;&#x529F;&#x8C03;&#x7528;sched_setscheduler()&#x65F6;&#x5176;&#x8FD4;&#x56DE;&#x503C;&#x5E94;&#x8BE5;&#x662F;&#x4E0A;&#x4E00;&#x79CD;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#x3002;&#x4F46;Linux&#x5E76;&#x6CA1;&#x6709;&#x9075;&#x5FAA;&#x8FD9;&#x4E2A;&#x89C4;&#x5219;&#xFF0C;&#x5728;&#x6210;&#x529F;&#x8C03;&#x7528;&#x65F6;&#x8BE5;&#x51FD;&#x6570;&#x4F1A;&#x8FD4;&#x56DE;0&#x3002;&#x4E00;&#x4E2A;&#x53EF;&#x79FB;&#x690D;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5E94;&#x8BE5;&#x901A;&#x8FC7;&#x68C0;&#x67E5;&#x8FD4;&#x56DE;&#x503C;&#x662F;&#x5426;&#x4E0D;&#x4E3A;&#x2212;1&#x6765;&#x5224;&#x65AD;&#x8C03;&#x7528;&#x662F;&#x5426;&#x6210;&#x529F;&#x3002;</p>
<p>&#x901A;&#x8FC7;fork()&#x521B;&#x5EFA;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x4F1A;&#x7EE7;&#x627F;&#x7236;&#x8FDB;&#x7A0B;&#x7684;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#x548C;&#x4F18;&#x5148;&#x7EA7;&#xFF0C;&#x5E76;&#x4E14;&#x5728;exec()&#x8C03;&#x7528;&#x4E2D;&#x4F1A;&#x4FDD;&#x6301;&#x8FD9;&#x4E9B;&#x4FE1;&#x606F;&#x3002;</p>
<p>sched_setparam()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x63D0;&#x4F9B;&#x4E86; sched_setscheduler()&#x51FD;&#x6570;&#x7684;&#x4E00;&#x4E2A;&#x529F;&#x80FD;&#x5B50;&#x96C6;&#x3002;&#x5B83;&#x4FEE;&#x6539;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7684;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#xFF0C;&#x4F46;&#x4E0D;&#x4F1A;&#x4FEE;&#x6539;&#x5176;&#x4F18;&#x5148;&#x7EA7;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;sched.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">sched_setparam</span><span class="token punctuation">(</span>pid_t pid<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">struct</span> sched_param <span class="token operator">*</span>param<span class="token punctuation">)</span><span class="token punctuation">;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>pid&#x548C;param&#x53C2;&#x6570;&#x4E0E;sched_setscheduler()&#x4E2D;&#x76F8;&#x5E94;&#x7684;&#x53C2;&#x6570;&#x662F;&#x4E00;&#x6837;&#x7684;&#x3002;</p>
<p>&#x6210;&#x529F;&#x8C03;&#x7528;sched_setparam()&#x4F1A;&#x5C06;pid&#x6307;&#x5B9A;&#x7684;&#x8FDB;&#x7A0B;&#x79FB;&#x5230;&#x4E0E;&#x5176;&#x4F18;&#x5148;&#x7EA7;&#x7EA7;&#x522B;&#x5BF9;&#x5E94;&#x7684;&#x961F;&#x5217;&#x7684;&#x961F;&#x5C3E;&#x3002;</p>
<h3 id="&#x6743;&#x9650;&#x548C;&#x8D44;&#x6E90;&#x9650;&#x5236;&#x4F1A;&#x5F71;&#x54CD;&#x5BF9;&#x8C03;&#x5EA6;&#x53C2;&#x6570;&#x7684;&#x53D8;&#x66F4;"><a href="#&#x6743;&#x9650;&#x548C;&#x8D44;&#x6E90;&#x9650;&#x5236;&#x4F1A;&#x5F71;&#x54CD;&#x5BF9;&#x8C03;&#x5EA6;&#x53C2;&#x6570;&#x7684;&#x53D8;&#x66F4;" class="headerlink" title="&#x6743;&#x9650;&#x548C;&#x8D44;&#x6E90;&#x9650;&#x5236;&#x4F1A;&#x5F71;&#x54CD;&#x5BF9;&#x8C03;&#x5EA6;&#x53C2;&#x6570;&#x7684;&#x53D8;&#x66F4;"></a>&#x6743;&#x9650;&#x548C;&#x8D44;&#x6E90;&#x9650;&#x5236;&#x4F1A;&#x5F71;&#x54CD;&#x5BF9;&#x8C03;&#x5EA6;&#x53C2;&#x6570;&#x7684;&#x53D8;&#x66F4;</h3><p>&#x5728;2.6.12&#x4E4B;&#x524D;&#x7684;&#x5185;&#x6838;&#x4E2D;&#xFF0C;&#x8FDB;&#x7A0B;&#x5FC5;&#x987B;&#x8981;&#x5148;&#x53D8;&#x6210;&#x7279;&#x6743;&#x8FDB;&#x7A0B;&#xFF08;CAP_SYS_NICE&#xFF09;&#x624D;&#x80FD;&#x591F;&#x4FEE;&#x6539;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#x548C;&#x4F18;&#x5148;&#x7EA7;&#x3002;&#x8FD9;&#x4E2A;&#x89C4;&#x5219;&#x7684;&#x4E00;&#x4E2A;&#x4F8B;&#x5916;&#x60C5;&#x51B5;&#x662F;&#x975E;&#x7279;&#x6743;&#x8FDB;&#x7A0B;&#x5728;&#x8C03;&#x7528;&#x8005;&#x7684;&#x6709;&#x6548;&#x7528;&#x6237;ID&#x4E0E;&#x76EE;&#x6807;&#x8FDB;&#x7A0B;&#x7684;&#x771F;&#x5B9E;&#x6216;&#x6709;&#x6548;&#x7528;&#x6237; ID &#x5339;&#x914D;&#x65F6;&#x5C31;&#x80FD;&#x5C06;&#x8BE5;&#x8FDB;&#x7A0B;&#x7684;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#x4FEE;&#x6539;&#x4E3A;SCHED_OTHER&#x3002;</p>
<p>&#x4ECE;2.6.12&#x7684;&#x5185;&#x6838;&#x5F00;&#x59CB;&#xFF0C;&#x8BBE;&#x7F6E;&#x5B9E;&#x65F6;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#x548C;&#x4F18;&#x5148;&#x7EA7;&#x7684;&#x89C4;&#x5219;&#x53D1;&#x751F;&#x4E86;&#x53D8;&#x52A8;&#xFF0C;&#x5373;&#x5F15;&#x5165;&#x4E86;&#x4E00;&#x4E2A;&#x5168;&#x65B0;&#x7684;&#x975E;&#x6807;&#x51C6;&#x7684;&#x8D44;&#x6E90;&#x9650;&#x5236;RLIMIT_RTPRIO&#x3002;&#x5728;&#x8001;&#x5F0F;&#x5185;&#x6838;&#x4E2D;&#xFF0C;&#x7279;&#x6743;&#xFF08;CAP_SYS_NICE&#xFF09;&#x8FDB;&#x7A0B;&#x80FD;&#x591F;&#x968F;&#x610F;&#x4FEE;&#x6539;&#x4EFB;&#x610F;&#x8FDB;&#x7A0B;&#x7684;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#x548C;&#x4F18;&#x5148;&#x7EA7;&#x3002;&#x540C;&#x65F6;&#xFF0C;&#x975E;&#x7279;&#x6743;&#x8FDB;&#x7A0B;&#x4E5F;&#x80FD;&#x591F;&#x6839;&#x636E;&#x4E0B;&#x5217;&#x89C4;&#x5219;&#x4FEE;&#x6539;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#x548C;&#x4F18;&#x5148;&#x7EA7;&#x3002;</p>
<ul>
<li>&#x5982;&#x679C;&#x8FDB;&#x7A0B;&#x62E5;&#x6709;&#x975E;&#x96F6;&#x7684;RLIMIT_RTPRIO&#x8F6F;&#x9650;&#x5236;&#xFF0C;&#x90A3;&#x4E48;&#x5B83;&#x5C31;&#x80FD;&#x968F;&#x610F;&#x4FEE;&#x6539;&#x81EA;&#x5DF1;&#x7684;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#x548C;&#x4F18;&#x5148;&#x7EA7;&#xFF0C;&#x53EA;&#x8981;&#x7B26;&#x5408;&#x5B9E;&#x65F6;&#x4F18;&#x5148;&#x7EA7;&#x7684;&#x4E0A;&#x9650;&#x4E3A;&#x5176;&#x5F53;&#x524D;&#x5B9E;&#x65F6;&#x4F18;&#x5148;&#x7EA7;&#xFF08;&#x5982;&#x679C;&#x8BE5;&#x8FDB;&#x7A0B;&#x5F53;&#x524D;&#x8FD0;&#x884C;&#x4E8E;&#x4E00;&#x4E2A;&#x5B9E;&#x65F6;&#x7B56;&#x7565;&#x4E0B;&#xFF09;&#x7684;&#x6700;&#x5927;&#x503C;&#x53CA;&#x5176;RLIMIT_RTPRIO&#x8F6F;&#x9650;&#x5236;&#x503C;&#x7684;&#x7EA6;&#x675F;&#x5373;&#x53EF;&#x3002;</li>
<li>&#x5982;&#x679C;&#x8FDB;&#x7A0B;&#x7684;RLIMIT_RTPRIO&#x8F6F;&#x9650;&#x5236;&#x503C;&#x4E3A;0&#xFF0C;&#x90A3;&#x4E48;&#x8FDB;&#x7A0B;&#x53EA;&#x80FD;&#x964D;&#x4F4E;&#x81EA;&#x5DF1;&#x7684;&#x5B9E;&#x65F6;&#x8C03;&#x5EA6;&#x4F18;&#x5148;&#x7EA7;&#x6216;&#x4ECE;&#x5B9E;&#x65F6;&#x7B56;&#x7565;&#x5207;&#x6362;&#x975E;&#x5B9E;&#x65F6;&#x7B56;&#x7565;&#x3002;</li>
<li>SCHED_IDLE&#x7B56;&#x7565;&#x662F;&#x4E00;&#x79CD;&#x7279;&#x6B8A;&#x7684;&#x7B56;&#x7565;&#x3002;&#x8FD0;&#x884C;&#x5728;&#x8FD9;&#x4E2A;&#x7B56;&#x7565;&#x4E0B;&#x7684;&#x8FDB;&#x7A0B;&#x65E0;&#x6CD5;&#x4FEE;&#x6539;&#x81EA;&#x5DF1;&#x7684;&#x7B56;&#x7565;&#xFF0C;&#x4E0D;&#x7BA1;RLIMIT_RTPRIO&#x8D44;&#x6E90;&#x9650;&#x5236;&#x7684;&#x503C;&#x662F;&#x4EC0;&#x4E48;&#x3002;</li>
<li>&#x5728;&#x5176;&#x4ED6;&#x975E;&#x7279;&#x6743;&#x8FDB;&#x7A0B;&#x4E2D;&#x4E5F;&#x80FD;&#x6267;&#x884C;&#x7B56;&#x7565;&#x548C;&#x4F18;&#x5148;&#x7EA7;&#x7684;&#x4FEE;&#x6539;&#x5DE5;&#x4F5C;&#xFF0C;&#x53EA;&#x8981;&#x8BE5;&#x8FDB;&#x7A0B;&#x7684;&#x6709;&#x6548;&#x7528;&#x6237;ID&#x4E0E;&#x76EE;&#x6807;&#x8FDB;&#x7A0B;&#x7684;&#x771F;&#x5B9E;&#x6216;&#x6709;&#x6548;&#x7528;&#x6237;ID&#x5339;&#x914D;&#x5373;&#x53EF;&#x3002;</li>
<li>&#x8FDB;&#x7A0B;&#x7684;&#x8F6F;RLIMIT_RTPRIO&#x9650;&#x5236;&#x503C;&#x53EA;&#x80FD;&#x786E;&#x5B9A;&#x53EF;&#x4EE5;&#x5BF9;&#x81EA;&#x5DF1;&#x7684;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#x548C;&#x4F18;&#x5148;&#x7EA7;&#x505A;&#x51FA;&#x54EA;&#x4E9B;&#x53D8;&#x66F4;&#xFF0C;&#x8FD9;&#x4E9B;&#x53D8;&#x66F4;&#x53EF;&#x4EE5;&#x7531;&#x8FDB;&#x7A0B;&#x81EA;&#x5DF1;&#x53D1;&#x8D77;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x7531;&#x5176;&#x4ED6;&#x975E;&#x7279;&#x6743;&#x8FDB;&#x7A0B;&#x53D1;&#x8D77;&#x3002;&#x62E5;&#x6709;&#x975E;&#x96F6;&#x9650;&#x5236;&#x503C;&#x7684;&#x975E;&#x7279;&#x6743;&#x8FDB;&#x7A0B;&#x65E0;&#x6CD5;&#x4FEE;&#x6539;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x7684;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#x548C;&#x4F18;&#x5148;&#x7EA7;&#x3002;</li>
</ul>
<h3 id="&#x83B7;&#x53D6;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#x548C;&#x4F18;&#x5148;&#x7EA7;"><a href="#&#x83B7;&#x53D6;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#x548C;&#x4F18;&#x5148;&#x7EA7;" class="headerlink" title="&#x83B7;&#x53D6;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#x548C;&#x4F18;&#x5148;&#x7EA7;"></a>&#x83B7;&#x53D6;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#x548C;&#x4F18;&#x5148;&#x7EA7;</h3><p>sched_getscheduler()&#x548C;sched_getparam()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x83B7;&#x53D6;&#x8FDB;&#x7A0B;&#x7684;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#x548C;&#x4F18;&#x5148;&#x7EA7;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;sched.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">sched_getscheduler</span><span class="token punctuation">(</span>pid_t pid<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">sched_getparam</span><span class="token punctuation">(</span>pid_t pid<span class="token punctuation">,</span><span class="token keyword">struct</span> sched_param <span class="token operator">*</span>param<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x5728;&#x8FD9;&#x4E24;&#x4E2A;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x4E2D;&#xFF0C;pid&#x6307;&#x5B9A;&#x4E86;&#x9700;&#x67E5;&#x8BE2;&#x4FE1;&#x606F;&#x7684;&#x8FDB;&#x7A0B;ID&#x3002;&#x5982;&#x679C;pid&#x4E3A;0&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x4F1A;&#x67E5;&#x8BE2;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x7684;&#x4FE1;&#x606F;&#x3002;&#x4E24;&#x4E2A;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x90FD;&#x53EF;&#x88AB;&#x975E;&#x7279;&#x6743;&#x8FDB;&#x7A0B;&#x7528;&#x6765;&#x83B7;&#x53D6;&#x4EFB;&#x610F;&#x8FDB;&#x7A0B;&#x7684;&#x4FE1;&#x606F;&#xFF0C;&#x800C;&#x4E0D;&#x7BA1;&#x8FDB;&#x7A0B;&#x7684;&#x9A8C;&#x8BC1;&#x4FE1;&#x606F;&#x662F;&#x4EC0;&#x4E48;&#x3002;</p>
<p>sched_getparam()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x8FD4;&#x56DE;&#x7531;param&#x6307;&#x5411;&#x7684;sched_param&#x7ED3;&#x6784;&#x4E2D;sched_priority&#x5B57;&#x6BB5;&#x6307;&#x5B9A;&#x7684;&#x8FDB;&#x7A0B;&#x7684;&#x5B9E;&#x65F6;&#x4F18;&#x5148;&#x7EA7;&#x3002;</p>
<p>&#x5982;&#x679C;&#x6267;&#x884C;&#x6210;&#x529F;&#xFF0C;sched_getscheduler()&#x5C06;&#x4F1A;&#x8FD4;&#x56DE;&#x524D;&#x9762;&#x8868;&#x4E2D;&#x5217;&#x51FA;&#x7684;&#x4E00;&#x4E2A;&#x7B56;&#x7565;&#x3002;</p>
<h3 id="&#x9632;&#x6B62;&#x5B9E;&#x65F6;&#x8FDB;&#x7A0B;&#x9501;&#x4F4F;&#x7CFB;&#x7EDF;"><a href="#&#x9632;&#x6B62;&#x5B9E;&#x65F6;&#x8FDB;&#x7A0B;&#x9501;&#x4F4F;&#x7CFB;&#x7EDF;" class="headerlink" title="&#x9632;&#x6B62;&#x5B9E;&#x65F6;&#x8FDB;&#x7A0B;&#x9501;&#x4F4F;&#x7CFB;&#x7EDF;"></a>&#x9632;&#x6B62;&#x5B9E;&#x65F6;&#x8FDB;&#x7A0B;&#x9501;&#x4F4F;&#x7CFB;&#x7EDF;</h3><p>&#x7531;&#x4E8E;SCHED_RR&#x548C;SCHED_FIFO&#x8FDB;&#x7A0B;&#x4F1A;&#x62A2;&#x5360;&#x6240;&#x6709;&#x4F4E;&#x4F18;&#x5148;&#x7EA7;&#x7684;&#x8FDB;&#x7A0B;&#xFF08;&#x5982;&#x8FD0;&#x884C;&#x8FD9;&#x4E2A;&#x7A0B;&#x5E8F;&#x7684;shell&#xFF09;&#xFF0C;&#x56E0;&#x6B64;&#x5728;&#x5F00;&#x53D1;&#x4F7F;&#x7528;&#x8FD9;&#x4E9B;&#x7B56;&#x7565;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x65F6;&#x9700;&#x8981;&#x5C0F;&#x5FC3;&#x53EF;&#x80FD;&#x4F1A;&#x53D1;&#x751F;&#x5931;&#x63A7;&#x7684;&#x5B9E;&#x65F6;&#x8FDB;&#x7A0B;&#x56E0;&#x4E00;&#x76F4;&#x5360;&#x4F4F;CPU&#x800C;&#x5BFC;&#x81F4;&#x9501;&#x4F4F;&#x7CFB;&#x7EDF;&#x7684;&#x60C5;&#x51B5;&#x3002;&#x5728;&#x7A0B;&#x5E8F;&#x4E2D;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4E00;&#x4E9B;&#x65B9;&#x6CD5;&#x6765;&#x907F;&#x514D;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x7684;&#x53D1;&#x751F;&#x3002;</p>
<ul>
<li>&#x4F7F;&#x7528;setrlimit()&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x5408;&#x7406;&#x7684;&#x4F4E;&#x8F6F; CPU &#x65F6;&#x95F4;&#x7EC4;&#x5458;&#x9650;&#x5236;&#x3002;&#x5982;&#x679C;&#x8FDB;&#x7A0B;&#x6D88;&#x8017;&#x4E86;&#x592A;&#x591A;&#x7684; CPU &#x65F6;&#x95F4;&#xFF0C;&#x90A3;&#x4E48;&#x5B83;&#x5C06;&#x4F1A;&#x6536;&#x5230;&#x4E00;&#x4E2A;SIGXCPU&#x4FE1;&#x53F7;&#xFF0C;&#x8BE5;&#x4FE1;&#x53F7;&#x5728;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#x4F1A;&#x6740;&#x6B7B;&#x8BE5;&#x8FDB;&#x7A0B;&#x3002;</li>
<li>&#x4F7F;&#x7528;alarm()&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x8B66;&#x62A5;&#x5B9A;&#x65F6;&#x5668;&#x3002;&#x5982;&#x679C;&#x8FDB;&#x7A0B;&#x7684;&#x8FD0;&#x884C;&#x65F6;&#x95F4;&#x8D85;&#x51FA;&#x4E86;&#x7531;alarm()&#x8C03;&#x7528;&#x6307;&#x5B9A;&#x7684;&#x79D2;&#x6570;&#xFF0C;&#x90A3;&#x4E48;&#x8BE5;&#x8FDB;&#x7A0B;&#x4F1A;&#x88AB;SIGALRM&#x4FE1;&#x53F7;&#x6740;&#x6B7B;&#x3002;</li>
<li>&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x62E5;&#x6709;&#x9AD8;&#x5B9E;&#x65F6;&#x4F18;&#x5148;&#x7EA7;&#x7684;&#x770B;&#x95E8;&#x72D7;&#x8FDB;&#x7A0B;&#x3002;&#x8FD9;&#x4E2A;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x8FDB;&#x884C;&#x65E0;&#x9650;&#x5FAA;&#x73AF;&#xFF0C;&#x6BCF;&#x6B21;&#x5FAA;&#x73AF;&#x90FD;&#x7761;&#x7720;&#x6307;&#x5B9A;&#x7684;&#x65F6;&#x95F4;&#x95F4;&#x9694;&#xFF0C;&#x7136;&#x540E;&#x9192;&#x6765;&#x5E76;&#x76D1;&#x63A7;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x7684;&#x72B6;&#x6001;&#x3002;&#x8FD9;&#x79CD;&#x76D1;&#x63A7;&#x53EF;&#x4EE5;&#x5305;&#x542B;&#x5BF9;&#x6BCF;&#x4E2A;&#x8FDB;&#x7A0B;&#x6D88;&#x8017;&#x7684;CPU&#x65F6;&#x95F4;&#x7684;&#x5EA6;&#x91CF;,&#x5E76;&#x4F7F;&#x7528;sched_getscheduler()&#x548C;sched_getparam()&#x6765;&#x68C0;&#x67E5;&#x8FDB;&#x7A0B;&#x7684;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#x548C;&#x4F18;&#x5148;&#x7EA7;&#x3002;&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x770B;&#x8D77;&#x6765;&#x884C;&#x4E3A;&#x5F02;&#x5E38;&#xFF0C;&#x90A3;&#x4E48;&#x770B;&#x95E8;&#x72D7;&#x7EBF;&#x7EBF;&#x7A0B;&#x53EF;&#x4EE5;&#x964D;&#x4F4E;&#x8BE5;&#x8FDB;&#x7A0B;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x6216;&#x5411;&#x5176;&#x53D1;&#x9001;&#x5408;&#x9002;&#x7684;&#x4FE1;&#x53F7;&#x6765;&#x505C;&#x6B62;&#x6216;&#x7EC8;&#x6B62;&#x8BE5;&#x8FDB;&#x7A0B;&#x3002;</li>
<li>&#x4ECE;2.6.25&#x7684;&#x5185;&#x6838;&#x5F00;&#x59CB;&#xFF0C;Linux&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x975E;&#x6807;&#x51C6;&#x7684;&#x8D44;&#x6E90;&#x9650;&#x5236;RLIMIT_RTTIME&#x7528;&#x4E8E;&#x63A7;&#x5236;&#x4E00;&#x4E2A;&#x8FD0;&#x884C;&#x5728;&#x5B9E;&#x65F6;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#x4E0B;&#x7684;&#x8FDB;&#x7A0B;&#x5728;&#x5355;&#x6B21;&#x8FD0;&#x884C;&#x4E2D;&#x80FD;&#x591F;&#x6D88;&#x8017;&#x7684;CPU&#x65F6;&#x95F4;&#x3002;RLIMIT_RTTIME&#x7684;&#x5355;&#x4F4D;&#x662F;&#x6BEB;&#x79D2;&#xFF0C;&#x5B83;&#x9650;&#x5236;&#x4E86;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x5728;&#x4E0D;&#x6267;&#x884C;&#x963B;&#x585E;&#x5F0F;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x65F6;&#x80FD;&#x591F;&#x6D88;&#x8017;&#x7684;CPU&#x65F6;&#x95F4;&#x3002;&#x5F53;&#x8FDB;&#x7A0B;&#x6267;&#x884C;&#x4E86;&#x8FD9;&#x6837;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x65F6;&#xFF0C;&#x7D2F;&#x79EF;&#x6D88;&#x8017;&#x7684;CPU&#x65F6;&#x95F4;&#x5C06;&#x4F1A;&#x88AB;&#x91CD;&#x7F6E;&#x4E3A;0&#x3002;&#x5F53;&#x8FD9;&#x4E2A;&#x8FDB;&#x7A0B;&#x88AB;&#x4E00;&#x4E2A;&#x4F18;&#x5148;&#x7EA7;&#x66F4;&#x9AD8;&#x7684;&#x8FDB;&#x7A0B;&#x62A2;&#x5360;&#x65F6;&#xFF0C;&#x7D2F;&#x79EF;&#x6D88;&#x8017;&#x7684;CPU&#x65F6;&#x95F4;&#x4E0D;&#x4F1A;&#x88AB;&#x91CD;&#x7F6E;&#x3002;&#x5F53;&#x8FDB;&#x7A0B;&#x7684;&#x65F6;&#x95F4;&#x7247;&#x88AB;&#x8017;&#x5B8C;&#x6216;&#x8C03;&#x7528;sched_yield()&#xFF08;&#x53C2;&#x89C1;35.3.3&#x8282;&#xFF09;&#x65F6;&#x8FDB;&#x7A0B;&#x4F1A;&#x653E;&#x5F03;CPU&#x3002;&#x5F53;&#x8FDB;&#x7A0B;&#x8FBE;&#x5230;&#x4E86;CPU&#x65F6;&#x95F4;&#x9650;&#x5236;RLIMIT_CPU&#x4E4B;&#x540E;&#xFF0C;&#x7CFB;&#x7EDF;&#x4F1A;&#x5411;&#x5176;&#x53D1;&#x9001;&#x4E00;&#x4E2A;SIGXCPU&#x4FE1;&#x53F7;&#xFF0C;&#x8BE5;&#x4FE1;&#x53F7;&#x5728;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#x4F1A;&#x6740;&#x6B7B;&#x8FD9;&#x4E2A;&#x8FDB;&#x7A0B;&#x3002;</li>
</ul>
<h3 id="&#x907F;&#x514D;&#x5B50;&#x8FDB;&#x7A0B;&#x8FDB;&#x7A0B;&#x7279;&#x6743;&#x8C03;&#x5EA6;&#x7B56;&#x7565;"><a href="#&#x907F;&#x514D;&#x5B50;&#x8FDB;&#x7A0B;&#x8FDB;&#x7A0B;&#x7279;&#x6743;&#x8C03;&#x5EA6;&#x7B56;&#x7565;" class="headerlink" title="&#x907F;&#x514D;&#x5B50;&#x8FDB;&#x7A0B;&#x8FDB;&#x7A0B;&#x7279;&#x6743;&#x8C03;&#x5EA6;&#x7B56;&#x7565;"></a>&#x907F;&#x514D;&#x5B50;&#x8FDB;&#x7A0B;&#x8FDB;&#x7A0B;&#x7279;&#x6743;&#x8C03;&#x5EA6;&#x7B56;&#x7565;</h3><p>Linux 2.6.32&#x589E;&#x52A0;&#x4E86;&#x4E00;&#x4E2A;SCHED_RESET_ON_FORK&#xFF0C;&#x5728;&#x8C03;&#x7528;sched_setscheduler()&#x65F6;&#x53EF;&#x4EE5;&#x5C06;policy&#x53C2;&#x6570;&#x7684;&#x503C;&#x8BBE;&#x7F6E;&#x4E3A;&#x8BE5;&#x5E38;&#x91CF;&#x3002;&#x7CFB;&#x7EDF;&#x4F1A;&#x5C06;&#x8FD9;&#x4E2A;&#x6807;&#x8BB0;&#x503C;&#x4E0E;&#x8868;35-1&#x4E2D;&#x5217;&#x51FA;&#x7684;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x7B56;&#x7565;&#x53D6;OR&#x3002;&#x5982;&#x679C;&#x8BBE;&#x7F6E;&#x4E86;&#x8FD9;&#x4E2A;&#x6807;&#x8BB0;&#xFF0C;&#x90A3;&#x4E48;&#x7531;&#x8FD9;&#x4E2A;&#x8FDB;&#x7A0B;&#x4F7F;&#x7528;fork()&#x521B;&#x5EFA;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x5C31;&#x4E0D;&#x4F1A;&#x7EE7;&#x627F;&#x7279;&#x6743;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#x548C;&#x4F18;&#x5148;&#x7EA7;&#x4E86;&#x3002;&#x5176;&#x89C4;&#x5219;&#x5982;&#x4E0B;&#x3002;</p>
<ul>
<li>&#x5982;&#x679C;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x62E5;&#x6709;&#x4E00;&#x4E2A;&#x5B9E;&#x65F6;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#xFF08;SCHED_RR&#x6216;SCHED_FIFO&#xFF09;&#xFF0C;&#x90A3;&#x4E48;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x7B56;&#x7565;&#x4F1A;&#x88AB;&#x91CD;&#x7F6E;&#x4E3A;&#x6807;&#x51C6;&#x7684;&#x5FAA;&#x73AF;&#x65F6;&#x95F4;&#x5206;&#x4EAB;&#x7B56;&#x7565;SCHED_OTHER&#x3002;</li>
<li>&#x5982;&#x679C;&#x8FDB;&#x7A0B;&#x7684;nice&#x503C;&#x4E3A;&#x8D1F;&#x503C;&#xFF08;&#x5373;&#x9AD8;&#x4F18;&#x5148;&#x7EA7;&#xFF09;&#xFF0C;&#x90A3;&#x4E48;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;nice&#x503C;&#x4F1A;&#x88AB;&#x91CD;&#x7F6E;&#x4E3A;0&#x3002;</li>
</ul>
<p>SCHED_RESET_ON_FORK&#x6807;&#x8BB0;&#x7528;&#x4E8E;&#x5A92;&#x4F53;&#x56DE;&#x653E;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#xFF0C;&#x5B83;&#x5141;&#x8BB8;&#x521B;&#x5EFA;&#x5355;&#x4E2A;&#x62E5;&#x6709;&#x5B9E;&#x65F6;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#x4F46;&#x4E0D;&#x4F1A;&#x5C06;&#x8BE5;&#x7B56;&#x7565;&#x4F20;&#x9012;&#x7ED9;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x8FDB;&#x7A0B;&#x3002;&#x4F7F;&#x7528;SCHED_RESET_ON_FORK&#x6807;&#x8BB0;&#x80FD;&#x591F;&#x901A;&#x8FC7;&#x521B;&#x5EFA;&#x591A;&#x4E2A;&#x8FD0;&#x884C;&#x4E8E;&#x5B9E;&#x65F6;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#x4E0B;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x6765;&#x9632;&#x6B62;&#x521B;&#x5EFA;&#x8BD5;&#x56FE;&#x8D85;&#x51FA;RLIMIT_RTTIME&#x8D44;&#x6E90;&#x9650;&#x5236;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x3002;</p>
<p>&#x4E00;&#x65E6;&#x8FDB;&#x7A0B;&#x542F;&#x7528;&#x4E86;SCHED_RESET_ON_FORK&#x6807;&#x8BB0;&#xFF0C;&#x90A3;&#x4E48;&#x53EA;&#x6709;&#x7279;&#x6743;&#x8FDB;&#x7A0B;&#xFF08;CAP_SYS_NICE&#xFF09;&#x624D;&#x80FD;&#x591F;&#x7981;&#x7528;&#x8BE5;&#x6807;&#x8BB0;&#x3002;&#x5F53;&#x5B50;&#x8FDB;&#x7A0B;&#x88AB;&#x521B;&#x5EFA;&#x51FA;&#x6765;&#x4E4B;&#x540E;&#xFF0C;&#x5B83;&#x7684;reset-on-fork&#x6807;&#x8BB0;&#x4F1A;&#x88AB;&#x7981;&#x7528;&#x3002;</p>
<h3 id="&#x91CA;&#x653E;CPU"><a href="#&#x91CA;&#x653E;CPU" class="headerlink" title="&#x91CA;&#x653E;CPU"></a>&#x91CA;&#x653E;CPU</h3><p>&#x5B9E;&#x65F6;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4E24;&#x79CD;&#x65B9;&#x5F0F;&#x81EA;&#x613F;&#x91CA;&#x653E;CPU&#xFF1A;&#x901A;&#x8FC7;&#x8C03;&#x7528;&#x4E00;&#x4E2A;&#x963B;&#x585E;&#x8FDB;&#x7A0B;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF08;&#x5982;&#x4ECE;&#x7EC8;&#x7AEF;&#x4E2D;read()&#xFF09;&#x6216;&#x8C03;&#x7528;sched_yield()&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;sched.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">sched_yield</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>sched_yield()&#x7684;&#x64CD;&#x4F5C;&#x662F;&#x6BD4;&#x8F83;&#x7B80;&#x5355;&#x7684;&#x3002;&#x5982;&#x679C;&#x5B58;&#x5728;&#x4E0E;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x76F8;&#x540C;&#x7684;&#x5176;&#x4ED6;&#x6392;&#x961F;&#x7684;&#x53EF;&#x8FD0;&#x884C;&#x8FDB;&#x7A0B;&#xFF0C;&#x90A3;&#x4E48;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x4F1A;&#x88AB;&#x653E;&#x5728;&#x961F;&#x5217;&#x7684;&#x961F;&#x5C3E;&#xFF0C;&#x961F;&#x5217;&#x4E2D;&#x961F;&#x5934;&#x7684;&#x8FDB;&#x7A0B;&#x5C06;&#x4F1A;&#x88AB;&#x8C03;&#x5EA6;&#x4F7F;&#x7528;CPU&#x3002;&#x5982;&#x679C;&#x5728;&#x8BE5;&#x4F18;&#x5148;&#x7EA7;&#x961F;&#x5217;&#x4E2D;&#x4E0D;&#x5B58;&#x5728;&#x53EF;&#x8FD0;&#x884C;&#x7684;&#x8FDB;&#x7A0B;&#xFF0C;&#x90A3;&#x4E48;sched_yield()&#x4E0D;&#x4F1A;&#x505A;&#x4EFB;&#x4F55;&#x4E8B;&#x60C5;&#xFF0C;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x4F1A;&#x7EE7;&#x7EED;&#x4F7F;&#x7528;CPU&#x3002;</p>
<p>&#x867D;&#x7136;SUSv3&#x5141;&#x8BB8;sched_yield()&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#xFF0C;&#x4F46;&#x5728;Linux&#x6216;&#x5F88;&#x591A;&#x5176;&#x4ED6;UNIX&#x5B9E;&#x73B0;&#x4E0A;&#x8FD9;&#x4E2A;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x603B;&#x4F1A;&#x6210;&#x529F;&#x3002;&#x53EF;&#x79FB;&#x690D;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5E94;&#x8BE5;&#x603B;&#x662F;&#x68C0;&#x67E5;&#x8FD9;&#x4E2A;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x662F;&#x5426;&#x8FD4;&#x56DE;&#x9519;&#x8BEF;&#x3002;</p>
<p>&#x975E;&#x5B9E;&#x65F6;&#x8FDB;&#x7A0B;&#x4F7F;&#x7528;sched_yield()&#x7684;&#x7ED3;&#x679C;&#x662F;&#x672A;&#x5B9A;&#x4E49;&#x7684;&#x3002;</p>
<h3 id="SCHED-RR&#x65F6;&#x95F4;&#x7247;"><a href="#SCHED-RR&#x65F6;&#x95F4;&#x7247;" class="headerlink" title="SCHED_RR&#x65F6;&#x95F4;&#x7247;"></a>SCHED_RR&#x65F6;&#x95F4;&#x7247;</h3><p>&#x901A;&#x8FC7;sched_rr_get_interval()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x80FD;&#x591F;&#x627E;&#x51FA;SCHED_RR&#x8FDB;&#x7A0B;&#x5728;&#x6BCF;&#x6B21;&#x88AB;&#x6388;&#x6743;&#x4F7F;&#x7528;CPU&#x65F6;&#x5206;&#x914D;&#x5230;&#x7684;&#x65F6;&#x95F4;&#x7247;&#x7684;&#x957F;&#x5EA6;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;sched.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">sched_rr_get_interval</span><span class="token punctuation">(</span>pid_t pid<span class="token punctuation">,</span><span class="token keyword">struct</span> timespec <span class="token operator">*</span>tp<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x4E0E;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x8C03;&#x5EA6;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x4E00;&#x6837;&#xFF0C;pid&#x6807;&#x8BC6;&#x51FA;&#x4E86;&#x9700;&#x67E5;&#x8BE2;&#x4FE1;&#x606F;&#x7684;&#x8FDB;&#x7A0B;&#xFF0C;&#x5F53;pid&#x4E3A;0&#x65F6;&#x8868;&#x793A;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x3002;&#x8FD4;&#x56DE;&#x7684;&#x65F6;&#x95F4;&#x7247;&#x662F;&#x7531;tp&#x6307;&#x5411;&#x7684;timespec&#x7ED3;&#x6784;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">struct</span> timespec
<span class="token punctuation">{</span>
    time_t tv_sec<span class="token punctuation">;</span>
    <span class="token keyword">long</span> tv_nsec<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x5728;&#x6700;&#x65B0;&#x7684;2.6&#x5185;&#x6838;&#x4E2D;&#xFF0C;&#x5B9E;&#x65F6;&#x5FAA;&#x73AF;&#x65F6;&#x95F4;&#x7247;&#x662F;0.1&#x79D2;&#x3002;</p>
<h2 id="CPU&#x4EB2;&#x548C;&#x529B;"><a href="#CPU&#x4EB2;&#x548C;&#x529B;" class="headerlink" title="CPU&#x4EB2;&#x548C;&#x529B;"></a>CPU&#x4EB2;&#x548C;&#x529B;</h2><p>&#x5F53;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x5728;&#x4E00;&#x4E2A;&#x591A;&#x5904;&#x7406;&#x5668;&#x7CFB;&#x7EDF;&#x4E0A;&#x88AB;&#x91CD;&#x65B0;&#x8C03;&#x5EA6;&#x65F6;&#x65E0;&#x9700;&#x5728;&#x4E0A;&#x4E00;&#x6B21;&#x6267;&#x884C;&#x7684;CPU&#x4E0A;&#x8FD0;&#x884C;&#x3002;&#x4E4B;&#x6240;&#x4EE5;&#x4F1A;&#x5728;&#x53E6;&#x4E00;&#x4E2A; CPU &#x4E0A;&#x8FD0;&#x884C;&#x7684;&#x539F;&#x56E0;&#x662F;&#x539F;&#x6765;&#x7684;CPU&#x5904;&#x4E8E;&#x5FD9;&#x788C;&#x72B6;&#x6001;&#x3002;</p>
<p>&#x8FDB;&#x7A0B;&#x5207;&#x6362;CPU&#x65F6;&#x5BF9;&#x6027;&#x80FD;&#x4F1A;&#x6709;&#x4E00;&#x5B9A;&#x7684;&#x5F71;&#x54CD;&#xFF1A;&#x5982;&#x679C;&#x5728;&#x539F;&#x6765;&#x7684;CPU&#x7684;&#x9AD8;&#x901F;&#x7F13;&#x51B2;&#x5668;&#x4E2D;&#x5B58;&#x5728;&#x8FDB;&#x7A0B;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x90A3;&#x4E48;&#x4E3A;&#x4E86;&#x5C06;&#x8FDB;&#x7A0B;&#x7684;&#x4E00;&#x884C;&#x6570;&#x636E;&#x52A0;&#x8F7D;&#x8FDB;&#x65B0; CPU &#x7684;&#x9AD8;&#x901F;&#x7F13;&#x51B2;&#x5668;&#x4E2D;&#xFF0C;&#x9996;&#x5148;&#x5FC5;&#x987B;&#x4F7F;&#x8FD9;&#x884C;&#x6570;&#x636E;&#x5931;&#x6548;&#xFF08;&#x5373;&#x5728;&#x6CA1;&#x88AB;&#x4FEE;&#x6539;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x4E22;&#x5F03;&#x6570;&#x636E;&#xFF0C;&#x5728;&#x88AB;&#x4FEE;&#x6539;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x5C06;&#x6570;&#x636E;&#x5199;&#x5165;&#x5185;&#x5B58;&#xFF09;&#x3002;&#xFF08;&#x4E3A;&#x9632;&#x6B62;&#x9AD8;&#x901F;&#x7F13;&#x51B2;&#x5668;&#x4E0D;&#x4E00;&#x81F4;&#xFF0C;&#x591A;&#x5904;&#x7406;&#x5668;&#x67B6;&#x6784;&#x5728;&#x67D0;&#x4E2A;&#x65F6;&#x523B;&#x53EA;&#x5141;&#x8BB8;&#x6570;&#x636E;&#x88AB;&#x5B58;&#x653E;&#x5728;&#x4E00;&#x4E2A;CPU&#x7684;&#x9AD8;&#x901F;&#x7F13;&#x51B2;&#x5668;&#x4E2D;&#x3002;&#xFF09;&#x8FD9;&#x4E2A;&#x4F7F;&#x6570;&#x636E;&#x5931;&#x6548;&#x7684;&#x8FC7;&#x7A0B;&#x4F1A;&#x6D88;&#x8017;&#x65F6;&#x95F4;&#x3002;&#x7531;&#x4E8E;&#x5B58;&#x5728;&#x8FD9;&#x4E2A;&#x6027;&#x80FD;&#x5F71;&#x54CD;&#xFF0C;Linux&#xFF08;2.6&#xFF09;&#x5185;&#x6838;&#x5C1D;&#x8BD5;&#x4E86;&#x7ED9;&#x8FDB;&#x7A0B;&#x4FDD;&#x8BC1;&#x8F6F; CPU &#x4EB2;&#x548C;&#x529B;&#x2014;&#x2014;&#x5728;&#x6761;&#x4EF6;&#x5141;&#x8BB8;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x8FDB;&#x7A0B;&#x91CD;&#x65B0;&#x88AB;&#x8C03;&#x5EA6;&#x5230;&#x539F;&#x6765;&#x7684;CPU &#x4E0A;&#x8FD0;&#x884C;&#x3002;</p>
<p>&#x6709;&#x65F6;&#x5019;&#x9700;&#x8981;&#x4E3A;&#x8FDB;&#x7A0B;&#x8BBE;&#x7F6E;&#x786C;CPU&#x4EB2;&#x548C;&#x529B;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x80FD;&#x663E;&#x5F0F;&#x5730;&#x5C06;&#x5176;&#x9650;&#x5236;&#x5728;&#x53EF;&#x7528;CPU&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x6216;&#x4E00;&#x7EC4;CPU&#x4E0A;&#x8FD0;&#x884C;&#x3002;&#x4E4B;&#x6240;&#x4EE5;&#x9700;&#x8981;&#x8FD9;&#x6837;&#x505A;&#xFF0C;&#x539F;&#x56E0;&#x5982;&#x4E0B;&#x3002;</p>
<ul>
<li>&#x53EF;&#x4EE5;&#x907F;&#x514D;&#x7531;&#x4F7F;&#x9AD8;&#x901F;&#x7F13;&#x51B2;&#x5668;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x5931;&#x6548;&#x6240;&#x5E26;&#x6765;&#x7684;&#x6027;&#x80FD;&#x5F71;&#x54CD;&#x3002;</li>
<li>&#x5982;&#x679C;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#xFF08;&#x6216;&#x8FDB;&#x7A0B;&#xFF09;&#x8BBF;&#x95EE;&#x540C;&#x6837;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x90A3;&#x4E48;&#x5F53;&#x5C06;&#x5B83;&#x4EEC;&#x9650;&#x5236;&#x5728;&#x540C;&#x6837;&#x7684;CPU&#x4E0A;&#x7684;&#x8BDD;&#x53EF;&#x80FD;&#x4F1A;&#x5E26;&#x6765;&#x6027;&#x80FD;&#x63D0;&#x5347;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x4EEC;&#x65E0;&#x9700;&#x7ADE;&#x4E89;&#x6570;&#x636E;&#x5E76;&#x4E14;&#x4E5F;&#x4E0D;&#x5B58;&#x5728;&#x7531;&#x6B64;&#x800C;&#x4EA7;&#x751F;&#x7684;&#x9AD8;&#x901F;&#x7F13;&#x51B2;&#x5668;&#x672A;&#x547D;&#x4E2D;&#x3002;</li>
<li>&#x5BF9;&#x4E8E;&#x65F6;&#x95F4;&#x5173;&#x952E;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x6765;&#x8BB2;&#xFF0C;&#x53EF;&#x80FD;&#x9700;&#x8981;&#x4E3A;&#x6B64;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x9884;&#x7559;&#x4E00;&#x4E2A;&#x6216;&#x66F4;&#x591A;CPU&#xFF0C;&#x800C;&#x5C06;&#x7CFB;&#x7EDF;&#x4E2D;&#x5927;&#x591A;&#x6570;&#x8FDB;&#x7A0B;&#x9650;&#x5236;&#x5728;&#x5176;&#x4ED6;CPU&#x4E0A;&#x3002;</li>
</ul>
<p>Linux 2.6&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x5BF9;&#x975E;&#x6807;&#x51C6;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x6765;&#x4FEE;&#x6539;&#x548C;&#x83B7;&#x53D6;&#x8FDB;&#x7A0B;&#x7684;&#x786C;CPU&#x4EB2;&#x548C;&#x529B;&#xFF1A;sched_ setaffinity()&#x548C;sched_getaffinity()&#x3002;</p>
<p>&#x5F88;&#x591A;&#x5176;&#x4ED6;UNIX&#x5B9E;&#x73B0;&#x63D0;&#x4F9B;&#x4E86;&#x63A7;&#x5236;CPU&#x4EB2;&#x548C;&#x529B;&#x7684;&#x63A5;&#x53E3;&#xFF0C;&#x5982;HP-UX&#x548C;Solaris&#x63D0;&#x4F9B;&#x4E86;pset_bind()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x3002;</p>
<p>sched_setaffinity()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x8BBE;&#x7F6E;&#x4E86;pid&#x6307;&#x5B9A;&#x7684;&#x8FDB;&#x7A0B;&#x7684;CPU&#x4EB2;&#x548C;&#x529B;&#x3002;&#x5982;&#x679C;pid&#x4E3A;0&#xFF0C;&#x90A3;&#x4E48;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x7684;CPU&#x4EB2;&#x548C;&#x529B;&#x5C31;&#x4F1A;&#x88AB;&#x6539;&#x53D8;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">define</span> _GNU_SOURCE</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;sched.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">sched_setaffinity</span><span class="token punctuation">(</span>pid_t pid<span class="token punctuation">,</span>size_t len<span class="token punctuation">,</span>cpu_set_t <span class="token operator">*</span>set<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x8D4B;&#x7ED9;&#x8FDB;&#x7A0B;&#x7684;CPU&#x4EB2;&#x548C;&#x529B;&#x7531;set&#x6307;&#x5411;&#x7684;cpu_set_t&#x7ED3;&#x6784;&#x6765;&#x6307;&#x5B9A;&#x3002;</p>
<p>&#x5B9E;&#x9645;&#x4E0A;CPU&#x4EB2;&#x548C;&#x529B;&#x662F;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x7EA7;&#x7279;&#x6027;&#xFF0C;&#x53EF;&#x4EE5;&#x8C03;&#x6574;&#x7EBF;&#x7A0B;&#x7EC4;&#x4E2D;&#x5404;&#x4E2A;&#x8FDB;&#x7A0B;&#x7684;CPU&#x4EB2;&#x548C;&#x529B;&#x3002;&#x5982;&#x679C;&#x9700;&#x8981;&#x4FEE;&#x6539;&#x4E00;&#x4E2A;&#x591A;&#x7EBF;&#x7A0B;&#x8FDB;&#x7A0B;&#x4E2D;&#x67D0;&#x4E2A;&#x7279;&#x5B9A;&#x7EBF;&#x7A0B;&#x7684;CPU&#x4EB2;&#x548C;&#x529B;&#x7684;&#x8BDD;&#xFF0C;&#x53EF;&#x4EE5;&#x5C06;pid&#x8BBE;&#x5B9A;&#x4E3A;&#x7EBF;&#x7A0B;&#x4E2D;gettid()&#x8C03;&#x7528;&#x8FD4;&#x56DE;&#x7684;&#x503C;&#x3002;&#x5C06;pid&#x8BBE;&#x4E3A;0&#x8868;&#x793A;&#x8C03;&#x7528;&#x7EBF;&#x7A0B;&#x3002;</p>
<p>&#x867D;&#x7136;cpu_set_t&#x6570;&#x636E;&#x7C7B;&#x578B;&#x5B9E;&#x73B0;&#x4E3A;&#x4E00;&#x4E2A;&#x4F4D;&#x63A9;&#x7801;&#xFF0C;&#x4F46;&#x5E94;&#x8BE5;&#x5C06;&#x5176;&#x770B;&#x6210;&#x662F;&#x4E00;&#x4E2A;&#x4E0D;&#x900F;&#x660E;&#x7684;&#x7ED3;&#x6784;&#x3002;&#x6240;&#x6709;&#x5BF9;&#x8FD9;&#x4E2A;&#x7ED3;&#x6784;&#x7684;&#x64CD;&#x4F5C;&#x90FD;&#x5E94;&#x8BE5;&#x4F7F;&#x7528;&#x5B8F;CPU_ZERO()&#x3001;CPU_SET()&#x3001;CPU_CLR()&#x548C;CPU_ISSET()&#x6765;&#x5B8C;&#x6210;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">define</span> _GNU_SOURCE</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;sched.h&gt;</span></span>

<span class="token keyword">void</span> <span class="token function">CPU_ZERO</span><span class="token punctuation">(</span>cpu_set_t <span class="token operator">*</span>set<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">CPU_SET</span><span class="token punctuation">(</span><span class="token keyword">int</span> cpu<span class="token punctuation">,</span>cpu_set_t <span class="token operator">*</span>set<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">CPU_CLR</span><span class="token punctuation">(</span><span class="token keyword">int</span> cpu<span class="token punctuation">,</span>cpu_set_t <span class="token operator">*</span>set<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">CPU_ISSET</span><span class="token punctuation">(</span><span class="token keyword">int</span> cpu<span class="token punctuation">,</span>cpu_set_t <span class="token operator">*</span>set<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x4E0B;&#x9762;&#x8FD9;&#x4E9B;&#x5B8F;&#x64CD;&#x4F5C;set&#x6307;&#x5411;&#x7684;CPU&#x96C6;&#x5408;&#xFF1A;</p>
<ul>
<li>CPU_ZERO()&#x5C06;set&#x521D;&#x59CB;&#x5316;&#x4E3A;&#x7A7A;&#x3002;</li>
<li>CPU_SET()&#x5C06;CPU cpu&#x6DFB;&#x52A0;&#x5230;set&#x4E2D;&#x3002;</li>
<li>CPU_CLR()&#x4ECE;set&#x4E2D;&#x5220;&#x9664;CPU cpu&#x3002;</li>
<li>CPU_ISSET()&#x5728;CPU cpu&#x662F;set&#x7684;&#x4E00;&#x4E2A;&#x6210;&#x5458;&#x65F6;&#x8FD4;&#x56DE;true&#x3002;</li>
</ul>
<p>CPU&#x96C6;&#x5408;&#x4E2D;&#x7684;CPU&#x4ECE;0&#x5F00;&#x59CB;&#x7F16;&#x53F7;&#x3002;&lt;sched.h&gt;&#x5934;&#x6587;&#x4EF6;&#x5B9A;&#x4E49;&#x4E86;&#x5E38;&#x91CF;CPU_SETSIZE&#xFF0C;&#x5B83;&#x662F;&#x6BD4;cpu_set_t&#x53D8;&#x91CF;&#x80FD;&#x591F;&#x8868;&#x793A;&#x7684;&#x6700;&#x5927;CPU&#x7F16;&#x53F7;&#x8FD8;&#x8981;&#x5927;&#x7684;&#x4E00;&#x4E2A;&#x6570;&#x5B57;&#x3002;CPU_SETSIZE&#x7684;&#x503C;&#x4E3A;1024&#x3002;</p>
<p>&#x4F20;&#x9012;&#x7ED9;sched_setaffinity()&#x7684;len&#x53C2;&#x6570;&#x5E94;&#x8BE5;&#x6307;&#x5B9A;set&#x53C2;&#x6570;&#x4E2D;&#x5B57;&#x8282;&#x6570;&#xFF08;&#x5373;sizeof(cpu_set_t)&#xFF09;&#x3002;</p>
<p>&#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x5C06;pid&#x6807;&#x8BC6;&#x51FA;&#x7684;&#x8FDB;&#x7A0B;&#x9650;&#x5236;&#x5728;&#x56DB;&#x5904;&#x7406;&#x5668;&#x7CFB;&#x7EDF;&#x4E0A;&#x9664;&#x7B2C;&#x4E00;&#x4E2A;CPU&#x4E4B;&#x5916;&#x7684;&#x4EFB;&#x610F;CPU&#x4E0A;&#x8FD0;&#x884C;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c">cpu_set_t set<span class="token punctuation">;</span>

<span class="token function">CPU_ZERO</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>set<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">CPU_SET</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>set<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">CPU_SET</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>set<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">CPU_SET</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>set<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">sched_setaffinity</span><span class="token punctuation">(</span>pid<span class="token punctuation">,</span>CPU_SERSIZE<span class="token punctuation">,</span><span class="token operator">&amp;</span>set<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x5982;&#x679C;set&#x4E2D;&#x6307;&#x5B9A;&#x7684;CPU&#x4E0E;&#x7CFB;&#x7EDF;&#x4E2D;&#x7684;&#x6240;&#x6709;CPU&#x90FD;&#x4E0D;&#x5339;&#x914D;&#xFF0C;&#x90A3;&#x4E48;sched_setaffinity()&#x8C03;&#x7528;&#x5C31;&#x4F1A;&#x8FD4;&#x56DE;EINVAL&#x9519;&#x8BEF;&#x3002;</p>
<p>&#x5982;&#x679C;&#x8FD0;&#x884C;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x7684;CPU&#x4E0D;&#x5305;&#x542B;&#x5728;set&#x4E2D;&#xFF0C;&#x90A3;&#x4E48;&#x8FDB;&#x7A0B;&#x4F1A;&#x88AB;&#x8FC1;&#x79FB;&#x5230;set&#x4E2D;&#x7684;&#x4E00;&#x4E2A;CPU&#x4E0A;&#x3002;</p>
<p>&#x975E;&#x7279;&#x6743;&#x8FDB;&#x7A0B;&#x53EA;&#x6709;&#x5728;&#x5176;&#x6709;&#x6548;&#x7528;&#x6237;ID&#x4E0E;&#x76EE;&#x6807;&#x8FDB;&#x7A0B;&#x7684;&#x771F;&#x5B9E;&#x6216;&#x6709;&#x6548;&#x7528;&#x6237;ID&#x5339;&#x914D;&#x65F6;&#x624D;&#x80FD;&#x591F;&#x8BBE;&#x7F6E;&#x76EE;&#x6807;&#x8FDB;&#x7A0B;&#x7684;CPU&#x4EB2;&#x548C;&#x529B;&#x3002;&#x7279;&#x6743;&#xFF08;CAP_SYS_NICE&#xFF09;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&#x4EFB;&#x610F;&#x8FDB;&#x7A0B;&#x7684;CPU&#x4EB2;&#x548C;&#x529B;&#x3002;</p>
<p>sched_getaffinity()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x83B7;&#x53D6;pid&#x6307;&#x5B9A;&#x7684;&#x8FDB;&#x7A0B;&#x7684;CPU&#x4EB2;&#x548C;&#x529B;&#x63A9;&#x7801;&#x3002;&#x5982;&#x679C;pid&#x4E3A;0&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x8FD4;&#x56DE;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x7684;CPU&#x4EB2;&#x548C;&#x529B;&#x63A9;&#x7801;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">define</span> _GNU_SOURCE</span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;sched.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">sched_getaffinity</span><span class="token punctuation">(</span>pid_t pid<span class="token punctuation">,</span>size_t len<span class="token punctuation">,</span>cpu_set_t <span class="token operator">*</span>set<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x8FD4;&#x56DE;&#x7684; CPU &#x4EB2;&#x548C;&#x529B;&#x63A9;&#x7801;&#x4F4D;&#x4E8E;set&#x6307;&#x5411;&#x7684; cpu_set_t &#x7ED3;&#x6784;&#x4E2D;&#xFF0C;&#x540C;&#x65F6;&#x5E94;&#x8BE5;&#x5C06;len&#x53C2;&#x6570;&#x8BBE;&#x7F6E;&#x4E3A;&#x7ED3;&#x6784;&#x4E2D;&#x5305;&#x542B;&#x7684;&#x5B57;&#x8282;&#x6570;&#xFF0C;&#x5373; sizeof(cpu_set_t)&#x3002;&#x4F7F;&#x7528; CPU_ISSET()&#x5B8F;&#x80FD;&#x591F;&#x786E;&#x5B9A;&#x54EA;&#x4E9B; CPU &#x4F4D;&#x4E8E;set&#x4E2D;&#x3002;</p>
<p>&#x5982;&#x679C;&#x76EE;&#x6807;&#x8FDB;&#x7A0B;&#x7684;CPU&#x4EB2;&#x548C;&#x529B;&#x63A9;&#x7801;&#x5E76;&#x6CA1;&#x6709;&#x88AB;&#x4FEE;&#x6539;&#x8FC7;&#xFF0C;&#x90A3;&#x4E48;sched_getaffinity()&#x8FD4;&#x56DE;&#x5305;&#x542B;&#x7CFB;&#x7EDF;&#x4E2D;&#x6240;&#x6709;CPU&#x7684;&#x96C6;&#x5408;&#x3002;</p>
<p>sched_getaffinity()&#x6267;&#x884C;&#x65F6;&#x4E0D;&#x4F1A;&#x8FDB;&#x884C;&#x6743;&#x9650;&#x68C0;&#x67E5;&#xFF0C;&#x975E;&#x7279;&#x6743;&#x8FDB;&#x7A0B;&#x80FD;&#x591F;&#x83B7;&#x53D6;&#x7CFB;&#x7EDF;&#x4E0A;&#x6240;&#x6709;&#x8FDB;&#x7A0B;&#x7684;CPU&#x4EB2;&#x548C;&#x529B;&#x63A9;&#x7801;&#x3002;</p>
<p>&#x901A;&#x8FC7;fork()&#x521B;&#x5EFA;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x4F1A;&#x7EE7;&#x627F;&#x5176;&#x7236;&#x8FDB;&#x7A0B;&#x7684;CPU&#x4EB2;&#x548C;&#x529B;&#x63A9;&#x7801;&#x5E76;&#x4E14;&#x5728;exec()&#x8C03;&#x7528;&#x4E4B;&#x95F4;&#x63A9;&#x7801;&#x4F1A;&#x5F97;&#x4EE5;&#x4FDD;&#x7559;&#x3002;</p>
<p>sched_setaffinity()&#x548C;sched_getaffinity()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x662F;Linux&#x7279;&#x6709;&#x7684;&#x3002;</p>
<h1 id="&#x8FDB;&#x7A0B;&#x8D44;&#x6E90;"><a href="#&#x8FDB;&#x7A0B;&#x8D44;&#x6E90;" class="headerlink" title="&#x8FDB;&#x7A0B;&#x8D44;&#x6E90;"></a>&#x8FDB;&#x7A0B;&#x8D44;&#x6E90;</h1><h2 id="&#x8FDB;&#x7A0B;&#x8D44;&#x6E90;&#x4F7F;&#x7528;"><a href="#&#x8FDB;&#x7A0B;&#x8D44;&#x6E90;&#x4F7F;&#x7528;" class="headerlink" title="&#x8FDB;&#x7A0B;&#x8D44;&#x6E90;&#x4F7F;&#x7528;"></a>&#x8FDB;&#x7A0B;&#x8D44;&#x6E90;&#x4F7F;&#x7528;</h2><p>getrusage()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x8FD4;&#x56DE;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x6216;&#x5176;&#x5B50;&#x8FDB;&#x7A0B;&#x7528;&#x6389;&#x7684;&#x5404;&#x7C7B;&#x7CFB;&#x7EDF;&#x8D44;&#x6E90;&#x7684;&#x7EDF;&#x8BA1;&#x4FE1;&#x606F;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;sys/resource.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">getrusage</span><span class="token punctuation">(</span><span class="token keyword">int</span> who<span class="token punctuation">,</span> <span class="token keyword">struct</span> rusage <span class="token operator">*</span>usage<span class="token punctuation">)</span><span class="token punctuation">;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>who&#x53C2;&#x6570;&#x6307;&#x5B9A;&#x4E86;&#x9700;&#x67E5;&#x8BE2;&#x8D44;&#x6E90;&#x4F7F;&#x7528;&#x4FE1;&#x606F;&#x7684;&#x8FDB;&#x7A0B;&#xFF0C;&#x5176;&#x53D6;&#x503C;&#x4E3A;&#x4E0B;&#x5217;&#x51E0;&#x4E2A;&#x503C;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x3002;<br><code>RUSAGE_SELF</code><br>&#x8FD4;&#x56DE;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x76F8;&#x5173;&#x7684;&#x4FE1;&#x606F;&#x3002;</p>
<p><code>RUSAGE_CHILDREN</code><br>&#x8FD4;&#x56DE;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x7684;&#x6240;&#x6709;&#x88AB;&#x7EC8;&#x6B62;&#x548C;&#x5904;&#x4E8E;&#x7B49;&#x5F85;&#x72B6;&#x6001;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x76F8;&#x5173;&#x7684;&#x4FE1;&#x606F;&#x3002;</p>
<p><code>RUSAGE_THREAD&#xFF08;&#x81EA;Linux 2.6.26&#x8D77;&#xFF09;</code><br>&#x8FD4;&#x56DE;&#x8C03;&#x7528;&#x7EBF;&#x7A0B;&#x76F8;&#x5173;&#x7684;&#x4FE1;&#x606F;&#x3002;&#x8FD9;&#x4E2A;&#x503C;&#x662F;Linux&#x7279;&#x6709;&#x7684;&#x3002;</p>
<p>res_usage&#x53C2;&#x6570;&#x662F;&#x4E00;&#x4E2A;&#x6307;&#x5411;rusage&#x7ED3;&#x6784;&#x7684;&#x6307;&#x9488;&#xFF0C;&#x5176;&#x5B9A;&#x4E49;&#x5982;&#x4E0B;&#x6240;&#x793A;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">struct</span> rusage <span class="token punctuation">{</span>
        <span class="token keyword">struct</span> timeval ru_utime<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// user time used </span>
        <span class="token keyword">struct</span> timeval ru_stime<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// system time used </span>
        <span class="token keyword">long</span> ru_maxrss<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// maximum resident set size </span>
        <span class="token keyword">long</span> ru_ixrss<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// integral shared memory size</span>
        <span class="token keyword">long</span> ru_idrss<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// integral unshared data size </span>
        <span class="token keyword">long</span> ru_isrss<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// integral unshared stack size </span>
        <span class="token keyword">long</span> ru_minflt<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// page reclaims </span>
        <span class="token keyword">long</span> ru_majflt<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// page faults </span>
        <span class="token keyword">long</span> ru_nswap<span class="token punctuation">;</span><span class="token comment" spellcheck="true">// swaps</span>
        <span class="token keyword">long</span> ru_inblock<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// block input operations </span>
        <span class="token keyword">long</span> ru_oublock<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// block output operations </span>
        <span class="token keyword">long</span> ru_msgsnd<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// messages sent </span>
        <span class="token keyword">long</span> ru_msgrcv<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//messages received </span>
        <span class="token keyword">long</span> ru_nsignals<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// signals received </span>
        <span class="token keyword">long</span> ru_nvcsw<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// voluntary context switches </span>
        <span class="token keyword">long</span> ru_nivcsw<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// involuntary context switches </span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x5728;Linux&#x4E0A;&#xFF0C;&#x5728;&#x8C03;&#x7528;getrusage()&#xFF08;&#x6216;wait3()&#x4EE5;&#x53CA;wait4()&#xFF09;&#x65F6;&#xFF0C;rusage&#x7ED3;&#x6784;&#x4E2D;&#x7684;&#x5F88;&#x591A;&#x5B57;&#x6BB5;&#x90FD;&#x4E0D;&#x4F1A;&#x88AB;&#x586B;&#x5145;&#xFF0C;&#x53EA;&#x6709;&#x6700;&#x65B0;&#x7684;&#x5185;&#x6838;&#x624D;&#x4F1A;&#x586B;&#x5145;&#x8FD9;&#x4E9B;&#x5B57;&#x6BB5;&#x3002;&#x5176;&#x4E2D;&#x4E00;&#x4E9B;&#x5B57;&#x6BB5;&#x5728;Linux&#x4E2D;&#x5E76;&#x6CA1;&#x6709;&#x7528;&#x5230;&#xFF0C;&#x53EA;&#x6709;UNIX&#x5B9E;&#x73B0;&#x7528;&#x5230;&#x4E86;&#x8FD9;&#x4E9B;&#x5B57;&#x6BB5;&#x3002;&#x800C;Linux&#x7CFB;&#x7EDF;&#x4E4B;&#x6240;&#x4EE5;&#x4E5F;&#x63D0;&#x4F9B;&#x4E86;&#x8FD9;&#x4E9B;&#x5B57;&#x6BB5;&#x662F;&#x4E3A;&#x4E86;&#x9632;&#x6B62;&#x4EE5;&#x540E;&#x6269;&#x5C55;&#x65F6;&#x9700;&#x8981;&#x4FEE;&#x6539;rusage&#x7ED3;&#x6784;&#x800C;&#x7834;&#x574F;&#x65E2;&#x6709;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5E93;&#x3002;</p>
<p>&#x867D;&#x7136;&#x5927;&#x591A;&#x6570;UNIX&#x5B9E;&#x73B0;&#x90FD;&#x63D0;&#x4F9B;&#x4E86;getrusage()&#xFF0C;&#x4F46;SUSv3&#x5E76;&#x6CA1;&#x6709;&#x5168;&#x9762;&#x89C4;&#x8303;&#x8FD9;&#x4E2A;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF08;&#x4EC5;&#x89C4;&#x5B9A;&#x4E86;ru_utime&#x548C;ru_stime&#x5B57;&#x6BB5;&#xFF09;&#xFF0C;&#x8FD9;&#x6837;&#x505A;&#x7684;&#x90E8;&#x5206;&#x539F;&#x56E0;&#x662F;&#x56E0;&#x4E3A;rusage&#x7ED3;&#x6784;&#x4E2D;&#x7684;&#x5F88;&#x591A;&#x5B57;&#x6BB5;&#x7684;&#x542B;&#x4E49;&#x662F;&#x4F9D;&#x8D56;&#x4E8E;&#x5B9E;&#x73B0;&#x7684;&#x3002;</p>
<p>ru_utime&#x548C;ru_stime&#x5B57;&#x6BB5;&#x7684;&#x7C7B;&#x578B;&#x662F;timeval&#x7ED3;&#x6784;&#xFF0C;&#x5B83;&#x5206;&#x522B;&#x8868;&#x793A;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x5728;&#x7528;&#x6237;&#x6A21;&#x5F0F;&#x548C;&#x5185;&#x6838;&#x6A21;&#x5F0F;&#x4E0B;&#x6D88;&#x8017;&#x7684;CPU&#x7684;&#x79D2;&#x6570;&#x548C;&#x6BEB;&#x79D2;&#x6570;&#x3002;</p>
<p>Linux&#x7279;&#x6709;&#x7684;/proc/PID/stat&#x6587;&#x4EF6;&#x63D0;&#x4F9B;&#x4E86;&#x7CFB;&#x7EDF;&#x4E2D;&#x6240;&#x6709;&#x8FDB;&#x7A0B;&#x7684;&#x67D0;&#x4E9B;&#x8D44;&#x6E90;&#x4F7F;&#x7528;&#x4FE1;&#x606F;&#xFF08;CPU&#x65F6;&#x95F4;&#x548C;&#x9875;&#x9762;&#x9519;&#x8BEF;&#xFF09;.</p>
<p>getrusage() RUSAGE_CHILDREN&#x64CD;&#x4F5C;&#x8FD4;&#x56DE;&#x7684;rusage&#x7ED3;&#x6784;&#x4E2D;&#x5305;&#x542B;&#x4E86;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x7684;&#x6240;&#x6709;&#x5B50;&#x5B59;&#x8FDB;&#x7A0B;&#x7684;&#x8D44;&#x6E90;&#x4F7F;&#x7528;&#x7EDF;&#x8BA1;&#x4FE1;&#x606F;&#x3002;&#x5982;&#x5047;&#x8BBE;&#x4E09;&#x4E2A;&#x8FDB;&#x7A0B;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x7CFB;&#x4E3A;&#x7236;&#x8FDB;&#x7A0B;&#x3001;&#x5B50;&#x8FDB;&#x7A0B;&#x548C;&#x5B59;&#x5B50;&#x8FDB;&#x7A0B;&#xFF0C;&#x90A3;&#x4E48;&#x5F53;&#x5B50;&#x8FDB;&#x7A0B;&#x5728;wait()&#x5B59;&#x5B50;&#x8FDB;&#x7A0B;&#x65F6;&#xFF0C;&#x5B59;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x8D44;&#x6E90;&#x4F7F;&#x7528;&#x503C;&#x5C31;&#x4F1A;&#x88AB;&#x52A0;&#x5230;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;RUSAGE_CHILDREN&#x503C;&#x4E0A;&#xFF0C;&#x5F53;&#x7236;&#x8FDB;&#x7A0B;&#x6267;&#x884C;&#x4E86;&#x4E00;&#x4E2A;wait()&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x64CD;&#x4F5C;&#x65F6;&#xFF0C;&#x5B50;&#x8FDB;&#x7A0B;&#x548C;&#x5B59;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x8D44;&#x6E90;&#x4F7F;&#x7528;&#x4FE1;&#x606F;&#x5C31;&#x4F1A;&#x88AB;&#x52A0;&#x5230;&#x7236;&#x8FDB;&#x7A0B;&#x7684;RUSAGE_CHILDREN&#x503C;&#x4E0A;&#x3002;&#x800C;&#x5982;&#x679C;&#x5B50;&#x8FDB;&#x7A0B;&#x6CA1;&#x6709;wait()&#x5B59;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x8BDD;&#xFF0C;&#x5B59;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x8D44;&#x6E90;&#x4F7F;&#x7528;&#x5C31;&#x4E0D;&#x4F1A;&#x88AB;&#x8BB0;&#x5F55;&#x5230;&#x7236;&#x8FDB;&#x7A0B;&#x7684;RUSAGE_CHILDREN&#x503C;&#x4E2D;&#x3002;</p>
<p>&#x5728;RUSAGE_CHILDREN&#x64CD;&#x4F5C;&#x4E2D;&#xFF0C;ru_maxrss&#x5B57;&#x6BB5;&#x8FD4;&#x56DE;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x7684;&#x6240;&#x6709;&#x5B50;&#x5B59;&#x8FDB;&#x7A0B;&#x4E2D;&#x6700;&#x5927;&#x9A7B;&#x7559;&#x96C6;&#x5927;&#x5C0F;&#xFF08;&#x4E0D;&#x662F;&#x6240;&#x6709;&#x5B50;&#x5B59;&#x8FDB;&#x7A0B;&#x4E4B;&#x548C;&#xFF09;&#x3002;</p>
<p>SUSv3&#x89C4;&#x5B9A;&#x5F53;SIGCHLD&#x88AB;&#x5FFD;&#x7565;&#x65F6;&#xFF08;&#x8FD9;&#x6837;&#x5B50;&#x8FDB;&#x7A0B;&#x5C31;&#x4E0D;&#x4F1A;&#x53D8;&#x6210;&#x53EF;&#x7B49;&#x5F85;&#x7684;&#x50F5;&#x6B7B;&#x8FDB;&#x7A0B;&#x4E86;&#xFF09;&#xFF0C;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x7EDF;&#x8BA1;&#x4FE1;&#x606F;&#x4E0D;&#x5E94;&#x8BE5;&#x88AB;&#x52A0;&#x5230;RUSAGE_CHILDREN&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x4E2D;&#x3002;&#x4F46;&#x5728;26.3.3&#x8282;&#x4E2D;&#x66FE;&#x7ECF;&#x6307;&#x51FA;&#x8FC7;&#x5728;&#x7248;&#x672C;&#x53F7;&#x65E9;&#x4E8E;2.6.9&#x7684;&#x5185;&#x6838;&#x4E2D;&#xFF0C;Linux&#x7684;&#x884C;&#x4E3A;&#x4E0E;&#x8FD9;&#x4E2A;&#x89C4;&#x5219;&#x4E0D;&#x540C;&#x2014;&#x2014;&#x5F53;SIGCHLD&#x88AB;&#x5FFD;&#x7565;&#x65F6;&#xFF0C;&#x5DF2;&#x7ECF;&#x6B7B;&#x53BB;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x8D44;&#x6E90;&#x4F7F;&#x7528;&#x503C;&#x4F1A;&#x88AB;&#x52A0;&#x5230;RUSAGE_CHILDREN&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x4E2D;&#x3002;</p>
<h2 id="&#x8FDB;&#x7A0B;&#x8D44;&#x6E90;&#x9650;&#x5236;"><a href="#&#x8FDB;&#x7A0B;&#x8D44;&#x6E90;&#x9650;&#x5236;" class="headerlink" title="&#x8FDB;&#x7A0B;&#x8D44;&#x6E90;&#x9650;&#x5236;"></a>&#x8FDB;&#x7A0B;&#x8D44;&#x6E90;&#x9650;&#x5236;</h2><p>&#x6BCF;&#x4E2A;&#x8FDB;&#x7A0B;&#x90FD;&#x7528;&#x4E00;&#x7EC4;&#x8D44;&#x6E90;&#x9650;&#x503C;&#xFF0C;&#x5B83;&#x4EEC;&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x9650;&#x5236;&#x8FDB;&#x7A0B;&#x80FD;&#x591F;&#x6D88;&#x8017;&#x7684;&#x5404;&#x79CD;&#x7CFB;&#x7EDF;&#x8D44;&#x6E90;&#x3002;&#x5982;&#x5728;&#x6267;&#x884C;&#x4EFB;&#x610F;&#x4E00;&#x4E2A;&#x7A0B;&#x5E8F;&#x4E4B;&#x524D;&#x5982;&#x679C;&#x4E0D;&#x60F3;&#x8BA9;&#x5B83;&#x6D88;&#x8017;&#x592A;&#x591A;&#x8D44;&#x6E90;&#xFF0C;&#x5219;&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&#x8BE5;&#x8FDB;&#x7A0B;&#x7684;&#x8D44;&#x6E90;&#x9650;&#x5236;&#x3002;&#x4F7F;&#x7528;shell&#x7684;&#x5185;&#x7F6E;&#x547D;&#x4EE4;ulimit&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;shell&#x7684;&#x8D44;&#x6E90;&#x9650;&#x5236;&#xFF08;&#x5728;C shell&#x4E2D;&#x662F;limit&#xFF09;&#x3002;shell&#x521B;&#x5EFA;&#x7528;&#x6765;&#x6267;&#x884C;&#x7528;&#x6237;&#x547D;&#x4EE4;&#x7684;&#x8FDB;&#x7A0B;&#x4F1A;&#x7EE7;&#x627F;&#x8FD9;&#x4E9B;&#x9650;&#x5236;&#x3002;</p>
<p>&#x4ECE;2.6.24&#x7684;&#x5185;&#x6838;&#x5F00;&#x59CB;&#xFF0C;Linux&#x7279;&#x6709;&#x7684;/proc/PID/limits&#x6587;&#x4EF6;&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x67E5;&#x770B;&#x4EFB;&#x610F;&#x8FDB;&#x7A0B;&#x7684;&#x6240;&#x6709;&#x8D44;&#x6E90;&#x9650;&#x5236;&#x3002;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x7531;&#x76F8;&#x5E94;&#x8FDB;&#x7A0B;&#x7684;&#x771F;&#x5B9E;&#x7528;&#x6237;ID&#x6240;&#x62E5;&#x6709;&#xFF0C;&#x5E76;&#x4E14;&#x53EA;&#x6709;&#x8FDB;&#x7A0B;ID&#x4E3A;&#x7528;&#x6237;ID&#x7684;&#x8FDB;&#x7A0B;&#xFF08;&#x6216;&#x7279;&#x6743;&#x8FDB;&#x7A0B;&#xFF09;&#x624D;&#x80FD;&#x591F;&#x8BFB;&#x53D6;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x3002;</p>
<p>getrlimit()&#x548C;setrlimit()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5141;&#x8BB8;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x8BFB;&#x53D6;&#x548C;&#x4FEE;&#x6539;&#x81EA;&#x5DF1;&#x7684;&#x8D44;&#x6E90;&#x9650;&#x5236;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;sys/resource.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">getrlimit</span><span class="token punctuation">(</span><span class="token keyword">int</span> resource<span class="token punctuation">,</span> <span class="token keyword">struct</span> rlimit <span class="token operator">*</span>rlim<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">setrlimit</span><span class="token punctuation">(</span><span class="token keyword">int</span> resource<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">struct</span> rlimit <span class="token operator">*</span>rlim<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>resource&#x53C2;&#x6570;&#x6807;&#x8BC6;&#x51FA;&#x4E86;&#x9700;&#x8BFB;&#x53D6;&#x6216;&#x4FEE;&#x6539;&#x7684;&#x8D44;&#x6E90;&#x9650;&#x5236;&#x3002;rlim&#x53C2;&#x6570;&#x7528;&#x6765;&#x8FD4;&#x56DE;&#x9650;&#x5236;&#x503C;&#xFF08;getrlimit()&#xFF09;&#x6216;&#x6307;&#x5B9A;&#x65B0;&#x7684;&#x8D44;&#x6E90;&#x9650;&#x5236;&#x503C;&#xFF08;(setrlimit())&#xFF0C;&#x5B83;&#x662F;&#x4E00;&#x4E2A;&#x6307;&#x5411;&#x5305;&#x542B;&#x4E24;&#x4E2A;&#x5B57;&#x6BB5;&#x7684;&#x7ED3;&#x6784;&#x7684;&#x6307;&#x9488;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">struct</span> rlimit
<span class="token punctuation">{</span>
    rlim_t rlim_cur<span class="token punctuation">;</span>
    rlim_t rlim_max<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x8FD9;&#x4E24;&#x4E2A;&#x5B57;&#x6BB5;&#x5BF9;&#x5E94;&#x4E8E;&#x4E00;&#x79CD;&#x8D44;&#x6E90;&#x7684;&#x4E24;&#x4E2A;&#x5173;&#x8054;&#x9650;&#x5236;&#xFF1A;&#x8F6F;&#x9650;&#x5236;&#xFF08;rlim_cur&#xFF09;&#x548C;&#x786C;&#x9650;&#x5236;&#xFF08;rlim_max&#xFF09;&#x3002;&#xFF08;rlim_t&#x6570;&#x636E;&#x7C7B;&#x578B;&#x662F;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#x7C7B;&#x578B;&#x3002;&#xFF09;&#x8F6F;&#x9650;&#x5236;&#x89C4;&#x5B9A;&#x4E86;&#x8FDB;&#x7A0B;&#x80FD;&#x591F;&#x6D88;&#x8017;&#x7684;&#x8D44;&#x6E90;&#x6570;&#x91CF;&#x3002;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x5C06;&#x8F6F;&#x9650;&#x5236;&#x8C03;&#x6574;&#x4E3A;&#x4ECE;0&#x5230;&#x786C;&#x9650;&#x5236;&#x4E4B;&#x95F4;&#x7684;&#x503C;&#x3002;&#x5BF9;&#x4E8E;&#x5927;&#x591A;&#x6570;&#x8D44;&#x6E90;&#x6765;&#x8BB2;&#xFF0C;&#x786C;&#x9650;&#x5236;&#x7684;&#x552F;&#x4E00;&#x4F5C;&#x7528;&#x662F;&#x4E3A;&#x8F6F;&#x9650;&#x5236;&#x8BBE;&#x5B9A;&#x4E86;&#x4E0A;&#x9650;&#x3002;&#x7279;&#x6743;&#xFF08;CAP_SYS_RESOURCE&#xFF09;&#x8FDB;&#x7A0B;&#x80FD;&#x591F;&#x589E;&#x5927;&#x548C;&#x7F29;&#x5C0F;&#x786C;&#x9650;&#x5236;&#xFF08;&#x53EA;&#x8981;&#x5176;&#x503C;&#x4ECD;&#x7136;&#x5927;&#x4E8E;&#x8F6F;&#x9650;&#x5236;&#xFF09;&#xFF0C;&#x4F46;&#x975E;&#x7279;&#x6743;&#x8FDB;&#x7A0B;&#x5219;&#x53EA;&#x80FD;&#x7F29;&#x5C0F;&#x786C;&#x9650;&#x5236;&#xFF08;&#x8FD9;&#x4E2A;&#x884C;&#x4E3A;&#x662F;&#x4E0D;&#x53EF;&#x9006;&#x7684;&#xFF09;&#x3002;&#x5728;getrlimit()&#x548C;setrlimit()&#x8C03;&#x7528;&#x4E2D;&#xFF0C;rlim_cur&#x548C;rlim_max&#x53D6;&#x503C;&#x4E3A;RLIM_INFINITY&#x8868;&#x793A;&#x6CA1;&#x6709;&#x9650;&#x5236;&#xFF08;&#x4E0D;&#x9650;&#x5236;&#x8D44;&#x6E90;&#x7684;&#x4F7F;&#x7528;&#xFF09;&#x3002;</p>
<p>&#x5728;&#x5927;&#x591A;&#x6570;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x7279;&#x6743;&#x8FDB;&#x7A0B;&#x548C;&#x975E;&#x7279;&#x6743;&#x8FDB;&#x7A0B;&#x5728;&#x4F7F;&#x7528;&#x8D44;&#x6E90;&#x65F6;&#x90FD;&#x4F1A;&#x53D7;&#x5230;&#x9650;&#x5236;&#x3002;&#x901A;&#x8FC7;fork()&#x521B;&#x5EFA;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x4F1A;&#x7EE7;&#x627F;&#x8FD9;&#x4E9B;&#x9650;&#x5236;&#x5E76;&#x4E14;&#x5728;exec()&#x8C03;&#x7528;&#x4E4B;&#x95F4;&#x4E0D;&#x5F97;&#x5230;&#x4FDD;&#x6301;&#x3002;</p>
<p>&#x867D;&#x7136;&#x8D44;&#x6E90;&#x9650;&#x5236;&#x662F;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7EA7;&#x522B;&#x7684;&#x7279;&#x6027;&#xFF0C;&#x4F46;&#x5728;&#x67D0;&#x4E9B;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x4E0D;&#x4EC5;&#x9700;&#x8981;&#x5EA6;&#x91CF;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x5BF9;&#x76F8;&#x5173;&#x8D44;&#x6E90;&#x7684;&#x6D88;&#x8017;&#x60C5;&#x51B5;&#xFF0C;&#x8FD8;&#x9700;&#x8981;&#x5EA6;&#x91CF;&#x540C;&#x4E00;&#x4E2A;&#x771F;&#x5B9E;&#x7528;&#x6237;ID&#x4E0B;&#x6240;&#x6709;&#x8FDB;&#x7A0B;&#x5BF9;&#x8D44;&#x6E90;&#x7684;&#x6D88;&#x8017;&#x603B;&#x548C;&#x60C5;&#x51B5;&#x3002;&#x9650;&#x5236;&#x80FD;&#x521B;&#x5EFA;&#x7684;&#x8FDB;&#x7A0B;&#x6570;&#x76EE;&#x7684;RLIMIT_NPROC&#x5C31;&#x8F83;&#x597D;&#x5730;&#x9075;&#x5FAA;&#x4E86;&#x8FD9;&#x4E2A;&#x89C4;&#x5219;&#x3002;&#x4EC5;&#x4EC5;&#x5C06;&#x8FD9;&#x4E2A;&#x9650;&#x5236;&#x65BD;&#x52A0;&#x4E8E;&#x8FDB;&#x7A0B;&#x672C;&#x8EAB;&#x6240;&#x521B;&#x5EFA;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x6570;&#x91CF;&#x7684;&#x505A;&#x6CD5;&#x4E0D;&#x662F;&#x975E;&#x5E38;&#x6709;&#x6548;&#xFF0C;&#x56E0;&#x4E3A;&#x7531;&#x8BE5;&#x8FDB;&#x7A0B;&#x521B;&#x5EFA;&#x7684;&#x6BCF;&#x4E2A;&#x5B50;&#x8FDB;&#x7A0B;&#x90FD;&#x53EF;&#x4EE5;&#x521B;&#x5EFA;&#x81EA;&#x5DF1;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#xFF0C;&#x800C;&#x8FD9;&#x4E9B;&#x5B50;&#x8FDB;&#x7A0B;&#x8FD8;&#x80FD;&#x591F;&#x521B;&#x5EFA;&#x66F4;&#x591A;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#xFF0C;&#x4EE5;&#x6B64;&#x7C7B;&#x63A8;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x8FD9;&#x4E2A;&#x9650;&#x5236;&#x662F;&#x6839;&#x636E;&#x540C;&#x4E00;&#x771F;&#x5B9E;&#x7528;&#x6237;ID&#x4E0B;&#x6240;&#x6709;&#x7684;&#x8FDB;&#x7A0B;&#x6570;&#x6765;&#x5EA6;&#x91CF;&#x7684;&#x3002;&#x6CE8;&#x610F;&#x53EA;&#x6709;&#x5728;&#x8BBE;&#x7F6E;&#x4E86;&#x8D44;&#x6E90;&#x9650;&#x5236;&#x7684;&#x8FDB;&#x7A0B;&#x4E2D;&#xFF08;&#x5373;&#x8FDB;&#x7A0B;&#x672C;&#x8EAB;&#x53CA;&#x7EE7;&#x627F;&#x4E86;&#x9650;&#x5236;&#x503C;&#x7684;&#x5B50;&#x5B59;&#x8FDB;&#x7A0B;&#xFF09;&#x624D;&#x4F1A;&#x5BF9;&#x8D44;&#x6E90;&#x4F7F;&#x7528;&#x60C5;&#x51B5;&#x8FDB;&#x884C;&#x68C0;&#x67E5;&#x3002;&#x5982;&#x679C;&#x540C;&#x4E00;&#x771F;&#x5B9E;&#x7528;&#x6237;ID&#x4E0B;&#x5B58;&#x5728;&#x4E00;&#x4E2A;&#x6CA1;&#x6709;&#x8BBE;&#x7F6E;&#x9650;&#x5236;&#xFF08;&#x5373;&#x9650;&#x5236;&#x503C;&#x4E3A;&#x65E0;&#x9650;&#xFF09;&#x6216;&#x8BBE;&#x7F6E;&#x4E86;&#x4E00;&#x4E2A;&#x4E0D;&#x540C;&#x7684;&#x9650;&#x5236;&#x503C;&#x7684;&#x8FDB;&#x7A0B;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x4F1A;&#x6839;&#x636E;&#x5B83;&#x6240;&#x8BBE;&#x7F6E;&#x7684;&#x9650;&#x5236;&#x503C;&#x6765;&#x68C0;&#x67E5;&#x5176;&#x521B;&#x5EFA;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x6570;&#x91CF;&#x3002;</p>
<p>&#x4E0B;&#x9762;&#x5728;&#x4ECB;&#x7ECD;&#x6BCF;&#x7C7B;&#x8D44;&#x6E90;&#x7684;&#x9650;&#x5236;&#x503C;&#x65F6;&#x90FD;&#x4F1A;&#x6307;&#x51FA;&#x6B64;&#x7C7B;&#x8D44;&#x6E90;&#x9650;&#x5236;&#x503C;&#x662F;&#x6307;&#x540C;&#x4E00;&#x771F;&#x5B9E;&#x7528;&#x6237;ID&#x4E0B;&#x6240;&#x6709;&#x8FDB;&#x7A0B;&#x7D2F;&#x79EF;&#x80FD;&#x591F;&#x6D88;&#x8017;&#x7684;&#x8D44;&#x6E90;&#x9650;&#x5236;&#x503C;&#x3002;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x7279;&#x522B;&#x6307;&#x51FA;&#xFF0C;&#x90A3;&#x4E48;&#x4E00;&#x4E2A;&#x8D44;&#x6E90;&#x9650;&#x5236;&#x503C;&#x5C31;&#x662F;&#x6307;&#x8FDB;&#x7A0B;&#x672C;&#x8EAB;&#x80FD;&#x591F;&#x6D88;&#x8017;&#x7684;&#x8D44;&#x6E90;&#x9650;&#x5236;&#x503C;&#x3002;</p>
<p>&#x8BB0;&#x4F4F;&#xFF0C;&#x5728;&#x5F88;&#x591A;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x83B7;&#x53D6;&#x548C;&#x8BBE;&#x7F6E;&#x8D44;&#x6E90;&#x9650;&#x5236;&#x7684;shell&#x547D;&#x4EE4;&#xFF08;bash&#x548C;Korn shell&#x4E2D;&#x662F;ulimit&#xFF0C;C shell&#x4E2D;&#x662F;limit&#xFF09;&#x4F7F;&#x7528;&#x7684;&#x5355;&#x4F4D;&#x4E0E;getrlimit()&#x548C;setrlimit()&#x4F7F;&#x7528;&#x7684;&#x5355;&#x4F4D;&#x4E0D;&#x540C;&#x3002;&#x5982;shell&#x547D;&#x4EE4;&#x5728;&#x9650;&#x5236;&#x5404;&#x79CD;&#x5185;&#x5B58;&#x6BB5;&#x7684;&#x5927;&#x5C0F;&#x65F6;&#x901A;&#x5E38;&#x4EE5;&#x5343;&#x5B57;&#x8282;&#x4E3A;&#x5355;&#x4F4D;&#x3002;</p>
<h3 id="getrlimit-&#x548C;setrlimit-&#x4E2D;&#x7684;&#x8D44;&#x6E90;&#x503C;"><a href="#getrlimit-&#x548C;setrlimit-&#x4E2D;&#x7684;&#x8D44;&#x6E90;&#x503C;" class="headerlink" title="getrlimit()&#x548C;setrlimit()&#x4E2D;&#x7684;&#x8D44;&#x6E90;&#x503C;"></a>getrlimit()&#x548C;setrlimit()&#x4E2D;&#x7684;&#x8D44;&#x6E90;&#x503C;</h3><div class="table-wrapper"><table>
<thead>
<tr>
<th align="left">&#x8D44; &#x6E90;</th>
<th align="center">&#x9650; &#x5236;</th>
<th align="center">SUSv3</th>
</tr>
</thead>
<tbody><tr>
<td align="left">RLIMIT_AS</td>
<td align="center">&#x8FDB;&#x7A0B;&#x865A;&#x62DF;&#x5185;&#x5B58;&#x9650;&#x5236;&#x5927;&#x5C0F;&#xFF08;&#x5B57;&#x8282;&#x6570;&#xFF09;</td>
<td align="center">&#x25CF;</td>
</tr>
<tr>
<td align="left">RLIMIT_CORE</td>
<td align="center">&#x6838;&#x5FC3;&#x6587;&#x4EF6;&#x5927;&#x5C0F;&#xFF08;&#x5B57;&#x8282;&#x6570;&#xFF09;</td>
<td align="center">&#x25CF;</td>
</tr>
<tr>
<td align="left">RLIMIT_CPU</td>
<td align="center">CPU&#x65F6;&#x95F4;&#xFF08;&#x79D2;&#x6570;&#xFF09;</td>
<td align="center">&#x25CF;</td>
</tr>
<tr>
<td align="left">RLIMIT_DATA</td>
<td align="center">&#x8FDB;&#x7A0B;&#x6570;&#x636E;&#x6BB5;&#xFF08;&#x5B57;&#x8282;&#x6570;&#xFF09;</td>
<td align="center">&#x25CF;</td>
</tr>
<tr>
<td align="left">RLIMIT_FSIZE</td>
<td align="center">&#x6587;&#x4EF6;&#x5927;&#x5C0F;&#xFF08;&#x5B57;&#x8282;&#x6570;&#xFF09;</td>
<td align="center">&#x25CF;</td>
</tr>
<tr>
<td align="left">RLIMIT_MEMLOCK</td>
<td align="center">&#x9501;&#x4F4F;&#x7684;&#x5185;&#x5B58;&#xFF08;&#x5B57;&#x8282;&#x6570;&#xFF09;</td>
<td align="center"></td>
</tr>
<tr>
<td align="left">RLIMIT_MSGQUEUE</td>
<td align="center">&#x4E3A;&#x771F;&#x5B9E;&#x7528;&#x6237;ID&#x5206;&#x914D;&#x7684;POSIX&#x6D88;&#x606F;&#x961F;&#x5217;&#x7684;&#x5B57;&#x8282;&#x6570;&#xFF08;&#x81EA;Linux 2.6.8&#x8D77;&#xFF09;</td>
<td align="center"></td>
</tr>
<tr>
<td align="left">RLIMIT_NICE</td>
<td align="center">nice&#x503C;&#xFF08;&#x81EA;Linux 2.6.12&#x8D77;&#xFF09;</td>
<td align="center"></td>
</tr>
<tr>
<td align="left">RLIMIT_NOFILE</td>
<td align="center">&#x6700;&#x5927;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x6570;&#x91CF;&#x52A0;1</td>
<td align="center">&#x25CF;</td>
</tr>
<tr>
<td align="left">RLIMIT_NPROC</td>
<td align="center">&#x771F;&#x5B9E;&#x7528;&#x6237;ID&#x4E0B;&#x7684;&#x8FDB;&#x7A0B;&#x6570;&#x91CF;</td>
<td align="center"></td>
</tr>
<tr>
<td align="left">RLIMIT_RSS</td>
<td align="center">&#x9A7B;&#x7559;&#x96C6;&#x5927;&#x5C0F;&#xFF08;&#x5B57;&#x8282;&#x6570;&#xFF1B;&#x6CA1;&#x6709;&#x5B9E;&#x73B0;&#xFF09;</td>
<td align="center"></td>
</tr>
<tr>
<td align="left">RLIMIT_RTPRIO</td>
<td align="center">&#x5B9E;&#x65F6;&#x8C03;&#x5EA6;&#x7B56;&#x7565;&#xFF08;&#x81EA;Linux 2.6.12&#x8D77;&#xFF09;</td>
<td align="center"></td>
</tr>
<tr>
<td align="left">RLIMIT_RTTIME</td>
<td align="center">&#x5B9E;&#x65F6;CPU&#x65F6;&#x95F4;&#xFF08;&#x5FAE;&#x79D2;&#xFF1B;&#x81EA;Linux 2.6.25&#x8D77;&#xFF09;</td>
<td align="center"></td>
</tr>
<tr>
<td align="left">RLIMIT_SIGPENDING</td>
<td align="center">&#x771F;&#x5B9E;&#x7528;&#x6237;ID&#x4FE1;&#x53F7;&#x961F;&#x5217;&#x4E2D;&#x7684;&#x4FE1;&#x53F7;&#x6570;&#xFF08;&#x81EA;Linux 2.6.8&#x8D77;&#xFF09;</td>
<td align="center"></td>
</tr>
<tr>
<td align="left">RLIMIT_STACK</td>
<td align="center">&#x6808;&#x6BB5;&#x7684;&#x5927;&#x5C0F;&#xFF08;&#x5B57;&#x8282;&#x6570;&#xFF09;</td>
<td align="center">&#x25CF;</td>
</tr>
</tbody></table></div>
<h3 id="&#x65E0;&#x6CD5;&#x8868;&#x793A;&#x7684;&#x9650;&#x5236;&#x503C;"><a href="#&#x65E0;&#x6CD5;&#x8868;&#x793A;&#x7684;&#x9650;&#x5236;&#x503C;" class="headerlink" title="&#x65E0;&#x6CD5;&#x8868;&#x793A;&#x7684;&#x9650;&#x5236;&#x503C;"></a>&#x65E0;&#x6CD5;&#x8868;&#x793A;&#x7684;&#x9650;&#x5236;&#x503C;</h3><p>&#x5728;&#x67D0;&#x4E9B;&#x7A0B;&#x5E8F;&#x8BBE;&#x8BA1;&#x73AF;&#x5883;&#x4E2D;&#xFF0C;rlim_t&#x6570;&#x636E;&#x7C7B;&#x578B;&#x53EF;&#x80FD;&#x65E0;&#x6CD5;&#x8868;&#x793A;&#x67D0;&#x4E2A;&#x7279;&#x5B9A;&#x8D44;&#x6E90;&#x9650;&#x5236;&#x7684;&#x6240;&#x6709;&#x53EF;&#x53D6;&#x503C;&#xFF0C;&#x8FD9;&#x662F;&#x56E0;&#x4E3A;&#x4E00;&#x4E2A;&#x7CFB;&#x7EDF;&#x53EF;&#x80FD;&#x63D0;&#x4F9B;&#x4E86;&#x591A;&#x4E2A;&#x7A0B;&#x5E8F;&#x8BBE;&#x8BA1;&#x73AF;&#x5883;&#xFF0C;&#x800C;&#x5728;&#x8FD9;&#x4E9B;&#x7A0B;&#x5E8F;&#x8BBE;&#x8BA1;&#x73AF;&#x5883;&#x4E2D;rlim_t&#x6570;&#x636E;&#x7C7B;&#x578B;&#x7684;&#x5927;&#x5C0F;&#x662F;&#x4E0D;&#x540C;&#x7684;&#x3002;&#x5982;&#x5F53;&#x4E00;&#x4E2A;off_t&#x4E3A;64&#x4F4D;&#x7684;&#x5927;&#x578B;&#x6587;&#x4EF6;&#x7F16;&#x8BD1;&#x73AF;&#x5883;&#x88AB;&#x6DFB;&#x52A0;&#x5230;off_t&#x4E3A;32&#x4F4D;&#x7684;&#x7CFB;&#x7EDF;&#x4E2D;&#x65F6;&#x5C31;&#x4F1A;&#x51FA;&#x73B0;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x3002;&#xFF08;&#x5728;&#x6BCF;&#x79CD;&#x73AF;&#x5883;&#x4E2D;&#xFF0C;rlim_t&#x548C;off_t&#x7684;&#x5927;&#x5C0F;&#x662F;&#x4E00;&#x6837;&#x7684;&#x3002;&#xFF09;&#x8FD9;&#x5C31;&#x4F1A;&#x5BFC;&#x81F4;&#x51FA;&#x73B0;&#x8FD9;&#x6837;&#x4E00;&#x79CD;&#x60C5;&#x51B5;&#xFF0C;&#x5373;&#x4E00;&#x4E2A;off_t&#x4E3A;64&#x4F4D;&#x7684;&#x7A0B;&#x5E8F;&#x80FD;&#x591F;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5B50;&#x8FDB;&#x7A0B;&#x6765;&#x6267;&#x884C;&#x4E00;&#x4E2A;rlim_t&#x503C;&#x8F83;&#x5C0F;&#x7684;&#x7A0B;&#x5E8F;&#xFF0C;&#x8FD9;&#x6837;&#x5B50;&#x8FDB;&#x7A0B;&#x5C31;&#x4F1A;&#x7EE7;&#x627F;&#x7236;&#x8FDB;&#x7A0B;&#x7684;&#x8D44;&#x6E90;&#x9650;&#x5236;&#xFF08;&#x5982;&#x6587;&#x4EF6;&#x5927;&#x5C0F;&#x9650;&#x5236;&#xFF09;&#xFF0C;&#x4F46;&#x8BE5;&#x8D44;&#x6E90;&#x9650;&#x5236;&#x8D85;&#x8FC7;&#x4E86;&#x6700;&#x5927;&#x7684;rlim_t&#x503C;&#x3002;</p>
<p>&#x4E3A;&#x4E86;&#x5E2E;&#x52A9;&#x53EF;&#x79FB;&#x690D;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5904;&#x7406;&#x53EF;&#x80FD;&#x51FA;&#x73B0;&#x7684;&#x65E0;&#x6CD5;&#x6807;&#x8BC6;&#x8D44;&#x6E90;&#x9650;&#x5236;&#x7684;&#x60C5;&#x51B5;&#xFF0C;SUSv3&#x89C4;&#x5B9A;&#x4E86;&#x4E24;&#x4E2A;&#x5E38;&#x91CF;&#x6765;&#x6807;&#x8BB0;&#x65E0;&#x6CD5;&#x8868;&#x793A;&#x7684;&#x9650;&#x5236;&#x503C;&#xFF1A;RLIM_SAVED_CUR&#x548C;RLIM_SAVED_MAX&#x3002;&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x8F6F;&#x8D44;&#x6E90;&#x9650;&#x5236;&#x65E0;&#x6CD5;&#x7528;rlim_t&#x8868;&#x793A;&#xFF0C;&#x90A3;&#x4E48;getrlimit()&#x5C06;&#x4F1A;&#x5728;rlim_cur&#x5B57;&#x6BB5;&#x8FD4;&#x56DE;RLIM_SAVED_CUR&#x3002;&#x800C;RLIM_SAVED_MAX&#x7684;&#x529F;&#x80FD;&#x7C7B;&#x4F3C;&#xFF0C;&#x5373;&#x5F53;&#x78B0;&#x5230;&#x65E0;&#x6CD5;&#x8868;&#x793A;&#x7684;&#x786C;&#x9650;&#x5236;&#x65F6;&#x5728;rlim_max&#x5B57;&#x6BB5;&#x8FD4;&#x56DE;&#x8BE5;&#x503C;&#x3002;</p>
<p>SUSv3&#x5141;&#x8BB8;&#x5B9E;&#x73B0;&#x5728;rlim_t&#x80FD;&#x591F;&#x8868;&#x793A;&#x8D44;&#x6E90;&#x9650;&#x5236;&#x7684;&#x6240;&#x6709;&#x53EF;&#x53D6;&#x503C;&#x65F6;&#x5C06;RLIM_SAVED_CUR&#x548C;RLIM_SAVED_MAX&#x5B9A;&#x4E49;&#x6210;&#x4E0E;RLIM_INFINITY&#x4E00;&#x6837;&#x7684;&#x503C;&#x3002;&#x5728;Linux&#x4E0A;&#xFF0C;&#x8FD9;&#x4E24;&#x4E2A;&#x5E38;&#x91CF;&#x503C;&#x5C31;&#x662F;&#x8FD9;&#x6837;&#x5B9A;&#x4E49;&#x7684;&#xFF0C;&#x8FD9;&#x6837;rlim_t&#x80FD;&#x591F;&#x8868;&#x793A;&#x8D44;&#x6E90;&#x9650;&#x5236;&#x7684;&#x6240;&#x6709;&#x53EF;&#x53D6;&#x503C;&#xFF0C;&#x4F46;&#x5728;&#x50CF;x86-32&#x8FD9;&#x6837;&#x7684;32&#x4F4D;&#x67B6;&#x6784;&#x4E0A;&#x8FD9;&#x79CD;&#x505A;&#x6CD5;&#x662F;&#x4E0D;&#x5BF9;&#x7684;&#x3002;&#x5728;&#x90A3;&#x4E9B;&#x67B6;&#x6784;&#x4E0A;&#xFF0C;&#x5728;&#x4E00;&#x4E2A;&#x5927;&#x6587;&#x4EF6;&#x7F16;&#x8BD1;&#x73AF;&#x5883;&#x4E2D;&#xFF0C;glibc&#x5C06;rlim_t&#x5B9A;&#x4E49;&#x4E3A;64&#x4F4D;&#xFF0C;&#x4F46;&#x5185;&#x6838;&#x4E2D;&#x8868;&#x793A;&#x8D44;&#x6E90;&#x9650;&#x5236;&#x7684;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x662F;unsigned long&#xFF0C;&#x5B83;&#x53EA;&#x6709;32&#x4F4D;&#x3002;&#x5F53;&#x524D;&#x7248;&#x672C;&#x7684;glibc&#x662F;&#x8FD9;&#x6837;&#x5904;&#x7406;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x7684;&#xFF1A;&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x8BBE;&#x7F6E;&#x4E86;_FILE_OFFSET_BITS=64&#x7F16;&#x8BD1;&#x9009;&#x9879;&#x7684;&#x7A0B;&#x5E8F;&#x8BD5;&#x56FE;&#x5C06;&#x4E00;&#x4E2A;&#x8D44;&#x6E90;&#x9650;&#x5236;&#x503C;&#x8BBE;&#x7F6E;&#x4E3A;&#x4E00;&#x4E2A;&#x8D85;&#x51FA;32&#x4F4D;unsigned long&#x8868;&#x793A;&#x8303;&#x56F4;&#x7684;&#x503C;&#xFF0C;&#x90A3;&#x4E48;glibc&#x4E2D;setrlimit()&#x7684;&#x5305;&#x88C5;&#x51FD;&#x6570;&#x4F1A;&#x6BEB;&#x65E0;&#x5F81;&#x5146;&#x5730;&#x5C06;&#x8FD9;&#x4E2A;&#x503C;&#x8F6C;&#x6362;&#x6210;RLIM_INFINITY&#x3002;&#x6362;&#x53E5;&#x8BDD;&#x8BF4;&#xFF0C;&#x8981;&#x6C42;&#x5B8C;&#x6210;&#x7684;&#x8D44;&#x6E90;&#x9650;&#x5236;&#x503C;&#x7684;&#x8BBE;&#x7F6E;&#x5E76;&#x6CA1;&#x6709;&#x5982;&#x5B9E;&#x5730;&#x88AB;&#x5B8C;&#x6210;&#x3002;</p>
<p>&#x7531;&#x4E8E;&#x5728;&#x5F88;&#x591A; x86-32 &#x53D1;&#x884C;&#x7248;&#x4E2D;&#xFF0C;&#x5904;&#x7406;&#x6587;&#x4EF6;&#x7684;&#x5B9E;&#x7528;&#x7A0B;&#x5E8F;&#x5728;&#x7F16;&#x8BD1;&#x65F6;&#x901A;&#x5E38;&#x90FD;&#x8BBE;&#x7F6E;&#x4E86;_FILE_OFFSET_BITS=64&#x53C2;&#x6570;&#xFF0C;&#x56E0;&#x6B64;&#x5F53;&#x8D44;&#x6E90;&#x9650;&#x5236;&#x503C;&#x8D85;&#x51FA;32&#x4F4D;&#x7684;&#x8868;&#x793A;&#x8303;&#x56F4;&#x65F6;&#x7CFB;&#x7EDF;&#x4E0D;&#x5982;&#x5B9E;&#x5730;&#x8BBE;&#x7F6E;&#x8D44;&#x6E90;&#x9650;&#x5236;&#x503C;&#x7684;&#x505A;&#x6CD5;&#x4E0D;&#x4EC5;&#x4EC5;&#x4F1A;&#x5F71;&#x54CD;&#x5230;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5F00;&#x53D1;&#x4EBA;&#x5458;&#xFF0C;&#x8FD8;&#x4F1A;&#x5F71;&#x54CD;&#x5230;&#x6700;&#x7EC8;&#x7684;&#x7528;&#x6237;&#x3002;</p>
<p>&#x6709;&#x4E9B;&#x4EBA;&#x53EF;&#x80FD;&#x4F1A;&#x8BA4;&#x4E3A;glibc setrlimit()&#x5305;&#x88C5;&#x51FD;&#x6570;&#x7684;&#x505A;&#x6CD5;&#x8981;&#x6BD4;&#x5728;&#x8BF7;&#x6C42;&#x7684;&#x8D44;&#x6E90;&#x9650;&#x5236;&#x8D85;&#x51FA;32&#x4F4D;unsigned long&#x8868;&#x793A;&#x8303;&#x56F4;&#x65F6;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#x8981;&#x597D;&#xFF0C;&#x800C;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x7684;&#x672C;&#x8D28;&#x662F;&#x5185;&#x6838;&#x7684;&#x9650;&#x5236;&#xFF0C;glibc&#x7684;&#x5F00;&#x53D1;&#x4EBA;&#x5458;&#x5728;&#x5904;&#x7406;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x65F6;&#x5219;&#x91C7;&#x7528;&#x4E86;&#x524D;&#x9762;&#x6B63;&#x6587;&#x4E2D;&#x4ECB;&#x7ECD;&#x7684;&#x65B9;&#x6CD5;&#x3002;</p>
<h2 id="&#x7279;&#x5B9A;&#x8D44;&#x6E90;&#x9650;&#x5236;&#x7EC6;&#x8282;"><a href="#&#x7279;&#x5B9A;&#x8D44;&#x6E90;&#x9650;&#x5236;&#x7EC6;&#x8282;" class="headerlink" title="&#x7279;&#x5B9A;&#x8D44;&#x6E90;&#x9650;&#x5236;&#x7EC6;&#x8282;"></a>&#x7279;&#x5B9A;&#x8D44;&#x6E90;&#x9650;&#x5236;&#x7EC6;&#x8282;</h2><p>TODO.</p>
<h1 id="&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;DAEMON"><a href="#&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;DAEMON" class="headerlink" title="&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;DAEMON"></a>&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;DAEMON</h1><h2 id="&#x6982;&#x8FF0;-2"><a href="#&#x6982;&#x8FF0;-2" class="headerlink" title="&#x6982;&#x8FF0;"></a>&#x6982;&#x8FF0;</h2><p>daemon&#x662F;&#x4E00;&#x79CD;&#x5177;&#x5907;&#x4E0B;&#x5217;&#x7279;&#x5F81;&#x7684;&#x8FDB;&#x7A0B;&#x3002;</p>
<ul>
<li>&#x5B83;&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;&#x5F88;&#x957F;&#x3002;&#x901A;&#x5E38;&#xFF0C;&#x4E00;&#x4E2A;daemon&#x4F1A;&#x5728;&#x7CFB;&#x7EDF;&#x542F;&#x52A8;&#x7684;&#x65F6;&#x5019;&#x88AB;&#x521B;&#x5EFA;&#x5E76;&#x4E00;&#x76F4;&#x8FD0;&#x884C;&#x76F4;&#x81F3;&#x7CFB;&#x7EDF;&#x88AB;&#x5173;&#x95ED;&#x3002;</li>
<li>&#x5B83;&#x5728;&#x540E;&#x53F0;&#x8FD0;&#x884C;&#x5E76;&#x4E14;&#x4E0D;&#x62E5;&#x6709;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x3002;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x7684;&#x7F3A;&#x5931;&#x786E;&#x4FDD;&#x4E86;&#x5185;&#x6838;&#x6C38;&#x8FDC;&#x4E0D;&#x4F1A;&#x4E3A;daemon&#x81EA;&#x52A8;&#x751F;&#x6210;&#x4EFB;&#x4F55;&#x4EFB;&#x52A1;&#x63A7;&#x5236;&#x4FE1;&#x53F7;&#x4EE5;&#x53CA;&#x7EC8;&#x7AEF;&#x76F8;&#x5173;&#x7684;&#x4FE1;&#x53F7;&#xFF08;&#x5982;SIGINT&#x3001;SIGTSTP&#x548C;SIGHUP&#xFF09;&#x3002;</li>
</ul>
<p>daemon&#x662F;&#x7528;&#x6765;&#x6267;&#x884C;&#x7279;&#x6B8A;&#x4EFB;&#x52A1;&#x7684;&#xFF0C;&#x5982;&#x4E0B;&#x9762;&#x7684;&#x793A;&#x4F8B;&#x6240;&#x793A;&#x3002;</p>
<p>cron&#xFF1A;&#x4E00;&#x4E2A;&#x5728;&#x89C4;&#x5B9A;&#x65F6;&#x95F4;&#x6267;&#x884C;&#x547D;&#x4EE4;&#x7684;daemon&#x3002;<br>sshd&#xFF1A;&#x5B89;&#x5168;shell daemon&#xFF0C;&#x5141;&#x8BB8;&#x5728;&#x8FDC;&#x7A0B;&#x4E3B;&#x673A;&#x4E0A;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x5B89;&#x5168;&#x7684;&#x901A;&#x4FE1;&#x534F;&#x8BAE;&#x767B;&#x5F55;&#x7CFB;&#x7EDF;&#x3002;<br>httpd&#xFF1A;HTTP&#x670D;&#x52A1;&#x5668;daemon&#xFF08;Apache&#xFF09;&#xFF0C;&#x5B83;&#x7528;&#x4E8E;&#x670D;&#x52A1;Web&#x9875;&#x9762;&#x3002;<br>inetd&#xFF1A;Internet&#x8D85;&#x7EA7;&#x670D;&#x52A1;&#x5668;daemon&#xFF0C;&#x5B83;&#x76D1;&#x542C;&#x4ECE;&#x6307;&#x5B9A;&#x7684;TCP/IP&#x7AEF;&#x53E3;&#x4E0A;&#x8FDB;&#x5165;&#x7684;&#x7F51;&#x7EDC;&#x8FDE;&#x63A5;&#x5E76;&#x542F;&#x52A8;&#x76F8;&#x5E94;&#x7684;&#x670D;&#x52A1;&#x5668;&#x7A0B;&#x5E8F;&#x6765;&#x5904;&#x7406;&#x8FD9;&#x4E9B;&#x8FDE;&#x63A5;&#x3002;<br>&#x5F88;&#x591A;&#x6807;&#x51C6;&#x7684;daemon&#x4F1A;&#x4F5C;&#x4E3A;&#x7279;&#x6743;&#x8FDB;&#x7A0B;&#x8FD0;&#x884C;&#xFF08;&#x5373;&#x6709;&#x6548;&#x7528;&#x6237;ID&#x4E3A;0&#xFF09;&#xFF0C;&#x56E0;&#x6B64;&#x5728;&#x7F16;&#x5199;daemon&#x7A0B;&#x5E8F;&#x65F6;&#x5E94;&#x8BE5;&#x9075;&#x5FAA;&#x4E0B;&#x4E00;&#x7AE0;&#x4E2D;&#x7ED9;&#x51FA;&#x7684;&#x6307;&#x5357;&#x3002;</p>
<p>&#x901A;&#x5E38;&#x4F1A;&#x5C06;daemon&#x7A0B;&#x5E8F;&#x7684;&#x540D;&#x79F0;&#x4EE5;&#x5B57;&#x6BCD;d&#x7ED3;&#x5C3E;&#xFF08;&#x4F46;&#x5E76;&#x4E0D;&#x662F;&#x6240;&#x6709;&#x4EBA;&#x90FD;&#x9075;&#x5FAA;&#x8FD9;&#x4E2A;&#x60EF;&#x4F8B;&#xFF09;&#x3002;</p>
<p>&#x5728;Linux&#x4E0A;&#xFF0C;&#x7279;&#x5B9A;&#x7684;daemon&#x4F1A;&#x4F5C;&#x4E3A;&#x5185;&#x6838;&#x7EBF;&#x7A0B;&#x8FD0;&#x884C;&#x3002;&#x5B9E;&#x73B0;&#x6B64;&#x7C7B;daemon&#x7684;&#x4EE3;&#x7801;&#x662F;&#x5185;&#x6838;&#x7684;&#x4E00;&#x90E8;&#x5206;&#xFF0C;&#x5B83;&#x4EEC;&#x901A;&#x5E38;&#x5728;&#x7CFB;&#x7EDF;&#x542F;&#x52A8;&#x7684;&#x65F6;&#x5019;&#x88AB;&#x521B;&#x5EFA;&#x3002;&#x5F53;&#x4F7F;&#x7528;ps(1)&#x5217;&#x51FA;&#x7EBF;&#x7A0B;&#x65F6;&#xFF0C;&#x8FD9;&#x4E9B;daemon&#x7684;&#x540D;&#x79F0;&#x4F1A;&#x7528;&#x65B9;&#x62EC;&#x53F7;&#xFF08;[]&#xFF09;&#x62EC;&#x8D77;&#x6765;&#x3002;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x5185;&#x6838;&#x7EBF;&#x7A0B;&#x662F;pdflush&#xFF0C;&#x5B83;&#x4F1A;&#x5B9A;&#x671F;&#x5C06;&#x810F;&#x9875;&#x9762;&#xFF08;&#x5373;&#x9AD8;&#x901F;&#x7F13;&#x51B2;&#x533A;&#x4E2D;&#x7684;&#x9875;&#x9762;&#xFF09;&#x5199;&#x5165;&#x78C1;&#x76D8;&#x3002;</p>
<h2 id="&#x521B;&#x5EFA;&#x4E00;&#x4E2A;daemon"><a href="#&#x521B;&#x5EFA;&#x4E00;&#x4E2A;daemon" class="headerlink" title="&#x521B;&#x5EFA;&#x4E00;&#x4E2A;daemon"></a>&#x521B;&#x5EFA;&#x4E00;&#x4E2A;daemon</h2><p>&#x8981;&#x53D8;&#x6210;daemon&#xFF0C;&#x4E00;&#x4E2A;&#x7A0B;&#x5E8F;&#x9700;&#x8981;&#x5B8C;&#x6210;&#x4E0B;&#x9762;&#x7684;&#x6B65;&#x9AA4;&#x3002;<br>1&#xFF0E; &#x6267;&#x884C;&#x4E00;&#x4E2A;fork()&#xFF0C;&#x4E4B;&#x540E;&#x7236;&#x8FDB;&#x7A0B;&#x9000;&#x51FA;&#xFF0C;&#x5B50;&#x8FDB;&#x7A0B;&#x7EE7;&#x7EED;&#x6267;&#x884C;&#x3002;&#xFF08;&#x7ED3;&#x679C;&#x662F;daemon&#x6210;&#x4E3A;&#x4E86;init&#x8FDB;&#x7A0B;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x3002;&#xFF09;&#x4E4B;&#x6240;&#x4EE5;&#x8981;&#x505A;&#x8FD9;&#x4E00;&#x6B65;&#x662F;&#x56E0;&#x4E3A;&#x4E0B;&#x9762;&#x4E24;&#x4E2A;&#x539F;&#x56E0;&#x3002;</p>
<ul>
<li>&#x5047;&#x8BBE;daemon&#x662F;&#x4ECE;&#x547D;&#x4EE4;&#x884C;&#x542F;&#x52A8;&#x7684;&#xFF0C;&#x7236;&#x8FDB;&#x7A0B;&#x7684;&#x7EC8;&#x6B62;&#x4F1A;&#x88AB;shell&#x53D1;&#x73B0;&#xFF0C;shell&#x5728;&#x53D1;&#x73B0;&#x4E4B;&#x540E;&#x4F1A;&#x663E;&#x793A;&#x51FA;&#x53E6;&#x4E00;&#x4E2A;shell&#x63D0;&#x793A;&#x7B26;&#x5E76;&#x8BA9;&#x5B50;&#x8FDB;&#x7A0B;&#x7EE7;&#x7EED;&#x5728;&#x540E;&#x53F0;&#x8FD0;&#x884C;&#x3002;</li>
<li>&#x5B50;&#x8FDB;&#x7A0B;&#x88AB;&#x786E;&#x4FDD;&#x4E0D;&#x4F1A;&#x6210;&#x4E3A;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7EC4;&#x9996;&#x8FDB;&#x7A0B;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x4ECE;&#x5176;&#x7236;&#x8FDB;&#x7A0B;&#x90A3;&#x91CC;&#x7EE7;&#x627F;&#x4E86;&#x8FDB;&#x7A0B;&#x7EC4;ID&#x5E76;&#x4E14;&#x62E5;&#x6709;&#x4E86;&#x81EA;&#x5DF1;&#x7684;&#x552F;&#x4E00;&#x7684;&#x8FDB;&#x7A0B;ID&#xFF0C;&#x800C;&#x8FD9;&#x4E2A;&#x8FDB;&#x7A0B;ID&#x4E0E;&#x7EE7;&#x627F;&#x800C;&#x6765;&#x7684;&#x8FDB;&#x7A0B;&#x7EC4;ID&#x662F;&#x4E0D;&#x540C;&#x7684;&#xFF0C;&#x8FD9;&#x6837;&#x624D;&#x80FD;&#x591F;&#x6210;&#x529F;&#x5730;&#x6267;&#x884C;&#x4E0B;&#x9762;&#x4E00;&#x4E2A;&#x6B65;&#x9AA4;&#x3002;</li>
</ul>
<ol start="2">
<li>&#x5B50;&#x8FDB;&#x7A0B;&#x8C03;&#x7528;setsid()&#x5F00;&#x542F;&#x4E00;&#x4E2A;&#x65B0;&#x4F1A;&#x8BDD;&#x5E76;&#x91CA;&#x653E;&#x5B83;&#x4E0E;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x4E4B;&#x95F4;&#x7684;&#x6240;&#x6709;&#x5173;&#x8054;&#x5173;&#x7CFB;&#x3002;</li>
</ol>
<p>3&#xFF0E; &#x5982;&#x679C;daemon&#x4ECE;&#x6765;&#x6CA1;&#x6709;&#x6253;&#x5F00;&#x8FC7;&#x7EC8;&#x7AEF;&#x8BBE;&#x5907;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x65E0;&#x9700;&#x62C5;&#x5FC3;daemon&#x4F1A;&#x91CD;&#x65B0;&#x8BF7;&#x6C42;&#x4E00;&#x4E2A;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x4E86;&#x3002;&#x5982;&#x679C;daemon&#x540E;&#x9762;&#x53EF;&#x80FD;&#x4F1A;&#x6253;&#x5F00;&#x4E00;&#x4E2A;&#x7EC8;&#x7AEF;&#x8BBE;&#x5907;&#xFF0C;&#x90A3;&#x4E48;&#x5FC5;&#x987B;&#x8981;&#x91C7;&#x53D6;&#x63AA;&#x65BD;&#x6765;&#x786E;&#x4FDD;&#x8FD9;&#x4E2A;&#x8BBE;&#x5907;&#x4E0D;&#x4F1A;&#x6210;&#x4E3A;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x3002;&#x8FD9;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4E0B;&#x9762;&#x4E24;&#x79CD;&#x65B9;&#x5F0F;&#x5B9E;&#x73B0;&#x3002;</p>
<ul>
<li>&#x5728;&#x6240;&#x6709;&#x53EF;&#x80FD;&#x5E94;&#x7528;&#x5230;&#x4E00;&#x4E2A;&#x7EC8;&#x7AEF;&#x8BBE;&#x5907;&#x4E0A;&#x7684;open()&#x8C03;&#x7528;&#x4E2D;&#x6307;&#x5B9A;O_NOCTTY&#x6807;&#x8BB0;&#x3002;</li>
<li>&#x6216;&#x8005;&#x66F4;&#x7B80;&#x5355;&#x5730;&#x8BF4;&#xFF0C;&#x5728;setsid()&#x8C03;&#x7528;&#x4E4B;&#x540E;&#x6267;&#x884C;&#x7B2C;&#x4E8C;&#x4E2A;fork()&#xFF0C;&#x7136;&#x540E;&#x518D;&#x6B21;&#x8BA9;&#x7236;&#x8FDB;&#x7A0B;&#x9000;&#x51FA;&#x5E76;&#x8BA9;&#x5B59;&#x5B50;&#x8FDB;&#x7A0B;&#x7EE7;&#x7EED;&#x6267;&#x884C;&#x3002;&#x8FD9;&#x6837;&#x5C31;&#x786E;&#x4FDD;&#x4E86;&#x5B50;&#x8FDB;&#x7A0B;&#x4E0D;&#x4F1A;&#x6210;&#x4E3A;&#x4F1A;&#x8BDD;&#x7EC4;&#x957F;&#xFF0C;&#x56E0;&#x6B64;&#x6839;&#x636E;System V&#x4E2D;&#x83B7;&#x53D6;&#x7EC8;&#x7AEF;&#x7684;&#x89C4;&#x5219;&#xFF08;Linux&#x4E5F;&#x9075;&#x5FAA;&#x4E86;&#x8FD9;&#x4E2A;&#x89C4;&#x5219;&#xFF09;&#xFF0C;&#x8FDB;&#x7A0B;&#x6C38;&#x8FDC;&#x4E0D;&#x4F1A;&#x91CD;&#x65B0;&#x8BF7;&#x6C42;&#x4E00;&#x4E2A;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x3002;&#x5728;&#x9075;&#x5FAA;BSD&#x89C4;&#x5219;&#x7684;&#x5B9E;&#x73B0;&#x4E2D;&#xFF0C;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x53EA;&#x80FD;&#x901A;&#x8FC7;&#x4E00;&#x4E2A;&#x663E;&#x5F0F;&#x7684;ioctl() TIOCSCTTY&#x64CD;&#x4F5C;&#x6765;&#x83B7;&#x53D6;&#x4E00;&#x4E2A;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#xFF0C;&#x56E0;&#x6B64;&#x7B2C;&#x4E8C;&#x4E2A;fork()&#x8C03;&#x7528;&#x5BF9;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x7684;&#x83B7;&#x53D6;&#x5E76;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x5F71;&#x54CD;&#xFF0C;&#x4F46;&#x591A;&#x4E00;&#x4E2A;fork()&#x8C03;&#x7528;&#x4E0D;&#x4F1A;&#x5E26;&#x6765;&#x4EFB;&#x4F55;&#x574F;&#x5904;&#x3002;</li>
</ul>
<ol start="4">
<li>&#x6E05;&#x9664;&#x8FDB;&#x7A0B;&#x7684;umask&#x4EE5;&#x786E;&#x4FDD;&#x5F53;daemon&#x521B;&#x5EFA;&#x6587;&#x4EF6;&#x548C;&#x76EE;&#x5F55;&#x65F6;&#x62E5;&#x6709;&#x6240;&#x9700;&#x7684;&#x6743;&#x9650;&#x3002;</li>
</ol>
<p>5&#xFF0E; &#x4FEE;&#x6539;&#x8FDB;&#x7A0B;&#x7684;&#x5F53;&#x524D;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;&#xFF0C;&#x901A;&#x5E38;&#x4F1A;&#x6539;&#x4E3A;&#x6839;&#x76EE;&#x5F55;&#xFF08;/&#xFF09;&#x3002;&#x8FD9;&#x6837;&#x505A;&#x662F;&#x6709;&#x5FC5;&#x8981;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;daemon&#x901A;&#x5E38;&#x4F1A;&#x4E00;&#x76F4;&#x8FD0;&#x884C;&#x76F4;&#x81F3;&#x7CFB;&#x7EDF;&#x5173;&#x95ED;&#x4E3A;&#x6B62;&#x3002;&#x5982;&#x679C;daemon&#x7684;&#x5F53;&#x524D;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;&#x4E3A;&#x4E0D;&#x5305;&#x542B;/&#x7684;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x65E0;&#x6CD5;&#x5378;&#x8F7D;&#x8BE5;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x3002;&#x6216;&#x8005;daemon&#x53EF;&#x4EE5;&#x5C06;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;&#x6539;&#x4E3A;&#x5B8C;&#x6210;&#x4EFB;&#x52A1;&#x65F6;&#x6240;&#x5728;&#x7684;&#x76EE;&#x5F55;&#x6216;&#x5728;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E2D;&#x5B9A;&#x4E49;&#x7684;&#x4E00;&#x4E2A;&#x76EE;&#x5F55;&#xFF0C;&#x53EA;&#x8981;&#x5305;&#x542B;&#x8FD9;&#x4E2A;&#x76EE;&#x5F55;&#x7684;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x6C38;&#x8FDC;&#x4E0D;&#x4F1A;&#x88AB;&#x5378;&#x8F7D;&#x5373;&#x53EF;&#x3002;&#x5982;cron&#x4F1A;&#x5C06;&#x81EA;&#x8EAB;&#x653E;&#x5728;/var/spool/cron&#x76EE;&#x5F55;&#x4E0B;&#x3002;</p>
<p>6&#xFF0E; &#x5173;&#x95ED;daemon&#x4ECE;&#x5176;&#x7236;&#x8FDB;&#x7A0B;&#x7EE7;&#x627F;&#x800C;&#x6765;&#x7684;&#x6240;&#x6709;&#x6253;&#x5F00;&#x7740;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x3002;&#xFF08;daemon&#x53EF;&#x80FD;&#x9700;&#x8981;&#x4FDD;&#x6301;&#x7EE7;&#x627F;&#x800C;&#x6765;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7684;&#x6253;&#x5F00;&#x72B6;&#x6001;&#xFF0C;&#x56E0;&#x6B64;&#x8FD9;&#x4E00;&#x6B65;&#x662F;&#x53EF;&#x9009;&#x7684;&#x6216;&#x8005;&#x662F;&#x53EF;&#x53D8;&#x66F4;&#x7684;&#x3002;&#xFF09;&#x4E4B;&#x6240;&#x4EE5;&#x9700;&#x8981;&#x8FD9;&#x6837;&#x505A;&#x7684;&#x539F;&#x56E0;&#x6709;&#x5F88;&#x591A;&#x3002;&#x7531;&#x4E8E;daemon&#x5931;&#x53BB;&#x4E86;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x5E76;&#x4E14;&#x662F;&#x5728;&#x540E;&#x53F0;&#x8FD0;&#x884C;&#x7684;&#xFF0C;&#x56E0;&#x6B64;&#x8BA9;daemon&#x4FDD;&#x6301;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;0&#x3001;1&#x548C;2&#x7684;&#x6253;&#x5F00;&#x72B6;&#x6001;&#x6BEB;&#x65E0;&#x610F;&#x4E49;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x4EEC;&#x6307;&#x5411;&#x7684;&#x5C31;&#x662F;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x65E0;&#x6CD5;&#x5378;&#x8F7D;&#x957F;&#x65F6;&#x95F4;&#x8FD0;&#x884C;&#x7684;daemon&#x6253;&#x5F00;&#x7684;&#x6587;&#x4EF6;&#x6240;&#x5728;&#x7684;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x901A;&#x5E38;&#x7684;&#x505A;&#x6CD5;&#x662F;&#x5173;&#x95ED;&#x6240;&#x6709;&#x65E0;&#x7528;&#x7684;&#x6253;&#x5F00;&#x7740;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#xFF0C;&#x56E0;&#x4E3A;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x662F;&#x4E00;&#x79CD;&#x6709;&#x9650;&#x7684;&#x8D44;&#x6E90;&#x3002;</p>
<p>7&#xFF0E; &#x5728;&#x5173;&#x95ED;&#x4E86;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;0&#x3001;1&#x548C;2&#x4E4B;&#x540E;&#xFF0C;daemon&#x901A;&#x5E38;&#x4F1A;&#x6253;&#x5F00;/dev/null&#x5E76;&#x4F7F;&#x7528;dup2()&#xFF08;&#x6216;&#x7C7B;&#x4F3C;&#x7684;&#x51FD;&#x6570;&#xFF09;&#x4F7F;&#x6240;&#x6709;&#x8FD9;&#x4E9B;&#x63CF;&#x8FF0;&#x7B26;&#x6307;&#x5411;&#x8FD9;&#x4E2A;&#x8BBE;&#x5907;&#x3002;&#x4E4B;&#x6240;&#x4EE5;&#x8981;&#x8FD9;&#x6837;&#x505A;&#x662F;&#x56E0;&#x4E3A;&#x4E0B;&#x9762;&#x4E24;&#x4E2A;&#x539F;&#x56E0;&#x3002;</p>
<ul>
<li>&#x5B83;&#x786E;&#x4FDD;&#x4E86;&#x5F53; daemon &#x8C03;&#x7528;&#x4E86;&#x5728;&#x8FD9;&#x4E9B;&#x63CF;&#x8FF0;&#x7B26;&#x4E0A;&#x6267;&#x884C; I/O &#x7684;&#x5E93;&#x51FD;&#x6570;&#x65F6;&#x4E0D;&#x4F1A;&#x51FA;&#x4E4E;&#x610F;&#x6599;&#x5730;&#x5931;&#x8D25;&#x3002;</li>
<li>&#x5B83;&#x9632;&#x6B62;&#x4E86;daemon&#x540E;&#x9762;&#x4F7F;&#x7528;&#x63CF;&#x8FF0;&#x7B26;1&#x6216;2&#x6253;&#x5F00;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x56E0;&#x4E3A;&#x5E93;&#x51FD;&#x6570;&#x4F1A;&#x5C06;&#x8FD9;&#x4E9B;&#x63CF;&#x8FF0;&#x7B26;&#x5F53;&#x505A;&#x6807;&#x51C6;&#x8F93;&#x51FA;&#x548C;&#x6807;&#x51C6;&#x9519;&#x8BEF;&#x6765;&#x5199;&#x5165;&#x6570;&#x636E;&#xFF08;&#x8FDB;&#x800C;&#x7834;&#x574F;&#x4E86;&#x539F;&#x6709;&#x7684;&#x6570;&#x636E;&#xFF09;&#x3002;</li>
</ul>
<blockquote>
<p>/dev/null&#x662F;&#x4E00;&#x4E2A;&#x865A;&#x62DF;&#x8BBE;&#x5907;&#xFF0C;&#x5B83;&#x603B;&#x4F1A;&#x5C06;&#x5199;&#x5165;&#x7684;&#x6570;&#x636E;&#x4E22;&#x5F03;&#x3002;&#x5F53;&#x9700;&#x8981;&#x5220;&#x9664;&#x4E00;&#x4E2A;shell&#x547D;&#x4EE4;&#x7684;&#x6807;&#x51C6;&#x8F93;&#x51FA;&#x548C;&#x9519;&#x8BEF;&#x65F6;&#x53EF;&#x4EE5;&#x5C06;&#x5B83;&#x4EEC;&#x91CD;&#x5B9A;&#x5411;&#x5230;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x3002;&#x4ECE;&#x8FD9;&#x4E2A;&#x8BBE;&#x5907;&#x4E2D;&#x8BFB;&#x53D6;&#x6570;&#x636E;&#x603B;&#x662F;&#x4F1A;&#x8FD4;&#x56DE;&#x6587;&#x4EF6;&#x7ED3;&#x675F;&#x7684;&#x9519;&#x8BEF;&#x3002;</p>
</blockquote>
<p>&#x4E0B;&#x9762;&#x662F;becomeDaemon()&#x51FD;&#x6570;&#x7684;&#x5B9E;&#x73B0;&#xFF0C;&#x5B83;&#x5B8C;&#x6210;&#x4E86;&#x4E0A;&#x9762;&#x63CF;&#x8FF0;&#x7684;&#x6B65;&#x9AA4;&#x4EE5;&#x5C06;&#x8C03;&#x7528;&#x8005;&#x53D8;&#x6210;&#x4E00;&#x4E2A;daemon&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;syslog.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">becomeDaemon</span><span class="token punctuation">(</span><span class="token keyword">int</span> flags<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>becomeDaeomon()&#x51FD;&#x6570;&#x63A5;&#x6536;&#x4E00;&#x4E2A;&#x4F4D;&#x63A9;&#x7801;&#x53C2;&#x6570;flags&#xFF0C;&#x5B83;&#x5141;&#x8BB8;&#x8C03;&#x7528;&#x8005;&#x6709;&#x9009;&#x62E9;&#x5730;&#x6267;&#x884C;&#x5176;&#x4E2D;&#x7684;&#x6B65;&#x9AA4;&#xFF0C;&#x5177;&#x4F53;&#x53EF;&#x53C2;&#x8003;&#x7A0B;&#x5E8F;&#x6E05;&#x5355;&#x4E2D;&#x5217;&#x51FA;&#x7684;&#x5934;&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x6CE8;&#x91CA;&#x3002;<br>become_daemon.c&#x7684;&#x5934;&#x6587;&#x4EF6;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token comment" spellcheck="true">/* become_daemon.h

   Header file for become_daemon.c.
*/</span>
<span class="token macro property">#<span class="token directive keyword">ifndef</span> BECOME_DAEMON_H             </span><span class="token comment" spellcheck="true">/* Prevent double inclusion */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> BECOME_DAEMON_H</span>

<span class="token comment" spellcheck="true">/* Bit-mask values for &apos;flags&apos; argument of becomeDaemon() */</span>

<span class="token macro property">#<span class="token directive keyword">define</span> BD_NO_CHDIR           01    </span><span class="token comment" spellcheck="true">/* Don&apos;t chdir(&quot;/&quot;) */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> BD_NO_CLOSE_FILES     02    </span><span class="token comment" spellcheck="true">/* Don&apos;t close all open files */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> BD_NO_REOPEN_STD_FDS  04    </span><span class="token comment" spellcheck="true">/* Don&apos;t reopen stdin, stdout, and
                                       stderr to /dev/null */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> BD_NO_UMASK0         010    </span><span class="token comment" spellcheck="true">/* Don&apos;t do a umask(0) */</span>

<span class="token macro property">#<span class="token directive keyword">define</span> BD_MAX_CLOSE  8192          </span><span class="token comment" spellcheck="true">/* Maximum file descriptors to close if
                                       sysconf(_SC_OPEN_MAX) is indeterminate */</span>

<span class="token keyword">int</span> <span class="token function">becomeDaemon</span><span class="token punctuation">(</span><span class="token keyword">int</span> flags<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token macro property">#<span class="token directive keyword">endif</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>becomeDaemon()&#x51FD;&#x6570;&#x7684;&#x5B9E;&#x73B0;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token comment" spellcheck="true">/* become_daemon.c

   A function encapsulating the steps in becoming a daemon.
*/</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;sys/stat.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;fcntl.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&quot;become_daemon.h&quot;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&quot;tlpi_hdr.h&quot;</span></span>

<span class="token keyword">int</span>                                     <span class="token comment" spellcheck="true">/* Returns 0 on success, -1 on error */</span>
<span class="token function">becomeDaemon</span><span class="token punctuation">(</span><span class="token keyword">int</span> flags<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> maxfd<span class="token punctuation">,</span> fd<span class="token punctuation">;</span>

    <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                   <span class="token comment" spellcheck="true">/* Become background process */</span>
    <span class="token keyword">case</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0</span><span class="token punctuation">:</span>  <span class="token keyword">break</span><span class="token punctuation">;</span>                     <span class="token comment" spellcheck="true">/* Child falls through... */</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token function">_exit</span><span class="token punctuation">(</span>EXIT_SUCCESS<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment" spellcheck="true">/* while parent terminates */</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">setsid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>                 <span class="token comment" spellcheck="true">/* Become leader of new session */</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>

    <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                   <span class="token comment" spellcheck="true">/* Ensure we are not session leader */</span>
    <span class="token keyword">case</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0</span><span class="token punctuation">:</span>  <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token function">_exit</span><span class="token punctuation">(</span>EXIT_SUCCESS<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>flags <span class="token operator">&amp;</span> BD_NO_UMASK0<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token function">umask</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                       <span class="token comment" spellcheck="true">/* Clear file mode creation mask */</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>flags <span class="token operator">&amp;</span> BD_NO_CHDIR<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token function">chdir</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                     <span class="token comment" spellcheck="true">/* Change to root directory */</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>flags <span class="token operator">&amp;</span> BD_NO_CLOSE_FILES<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">/* Close all open files */</span>
        maxfd <span class="token operator">=</span> <span class="token function">sysconf</span><span class="token punctuation">(</span>_SC_OPEN_MAX<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>maxfd <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>                <span class="token comment" spellcheck="true">/* Limit is indeterminate... */</span>
            maxfd <span class="token operator">=</span> BD_MAX_CLOSE<span class="token punctuation">;</span>       <span class="token comment" spellcheck="true">/* so take a guess */</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span>fd <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> fd <span class="token operator">&lt;</span> maxfd<span class="token punctuation">;</span> fd<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token function">close</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>flags <span class="token operator">&amp;</span> BD_NO_REOPEN_STD_FDS<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">close</span><span class="token punctuation">(</span>STDIN_FILENO<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">/* Reopen standard fd&apos;s to /dev/null */</span>

        fd <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;/dev/null&quot;</span><span class="token punctuation">,</span> O_RDWR<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>fd <span class="token operator">!=</span> STDIN_FILENO<span class="token punctuation">)</span>         <span class="token comment" spellcheck="true">/* &apos;fd&apos; should be 0 */</span>
            <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">dup2</span><span class="token punctuation">(</span>STDIN_FILENO<span class="token punctuation">,</span> STDOUT_FILENO<span class="token punctuation">)</span> <span class="token operator">!=</span> STDOUT_FILENO<span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">dup2</span><span class="token punctuation">(</span>STDIN_FILENO<span class="token punctuation">,</span> STDERR_FILENO<span class="token punctuation">)</span> <span class="token operator">!=</span> STDERR_FILENO<span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>GNU C&#x5E93;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x975E;&#x6807;&#x51C6;&#x7684;daemon()&#x51FD;&#x6570;&#xFF0C;&#x5B83;&#x5C06;&#x8C03;&#x7528;&#x8005;&#x53D8;&#x6210;&#x4E00;&#x4E2A;daemon&#x3002;glibc daemon()&#x51FD;&#x6570;&#x4E0E;&#x8FD9;&#x91CC;&#x7684;becomeDaemon()&#x51FD;&#x6570;&#x4E0D;&#x540C;&#xFF0C;&#x5B83;&#x5E76;&#x6CA1;&#x6709;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x4E0E;flags&#x53C2;&#x6570;&#x7B49;&#x4EF7;&#x7684;&#x53C2;&#x6570;&#x3002;</p>
<h3 id="&#x7F16;&#x5199;daemon&#x6307;&#x5357;"><a href="#&#x7F16;&#x5199;daemon&#x6307;&#x5357;" class="headerlink" title="&#x7F16;&#x5199;daemon&#x6307;&#x5357;"></a>&#x7F16;&#x5199;daemon&#x6307;&#x5357;</h3><p>&#x524D;&#x9762;&#x66FE;&#x7ECF;&#x63D0;&#x53CA;&#x8FC7;&#xFF0C;&#x4E00;&#x4E2A;daemon&#x901A;&#x5E38;&#x53EA;&#x6709;&#x5728;&#x7CFB;&#x7EDF;&#x5173;&#x95ED;&#x7684;&#x65F6;&#x5019;&#x624D;&#x4F1A;&#x7EC8;&#x6B62;&#x3002;&#x5F88;&#x591A;&#x6807;&#x51C6;&#x7684;daemon&#x662F;&#x901A;&#x8FC7;&#x5728;&#x7CFB;&#x7EDF;&#x5173;&#x95ED;&#x65F6;&#x6267;&#x884C;&#x7279;&#x5B9A;&#x4E8E;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x811A;&#x672C;&#x6765;&#x505C;&#x6B62;&#x7684;&#x3002;&#x800C;&#x90A3;&#x4E9B;&#x4E0D;&#x4EE5;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x7EC8;&#x6B62;&#x7684;daemon&#x4F1A;&#x6536;&#x5230;&#x4E00;&#x4E2A;SIGTERM&#x4FE1;&#x53F7;&#xFF0C;&#x56E0;&#x4E3A;&#x5728;&#x7CFB;&#x7EDF;&#x5173;&#x95ED;&#x7684;&#x65F6;&#x5019;init&#x8FDB;&#x7A0B;&#x4F1A;&#x5411;&#x6240;&#x6709;&#x5176;&#x5B50;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;&#x8FD9;&#x4E2A;&#x4FE1;&#x53F7;&#x3002;&#x5728;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;SIGTERM&#x4FE1;&#x53F7;&#x4F1A;&#x7EC8;&#x6B62;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x3002;&#x5982;&#x679C;daemon&#x5728;&#x7EC8;&#x6B62;&#x4E4B;&#x524D;&#x9700;&#x8981;&#x505A;&#x4E9B;&#x6E05;&#x7406;&#x5DE5;&#x4F5C;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x9700;&#x8981;&#x4E3A;&#x8FD9;&#x4E2A;&#x4FE1;&#x53F7;&#x5EFA;&#x7ACB;&#x4E00;&#x4E2A;&#x5904;&#x7406;&#x5668;&#x3002;&#x8FD9;&#x4E2A;&#x5904;&#x7406;&#x5668;&#x5FC5;&#x987B;&#x80FD;&#x5FEB;&#x901F;&#x5730;&#x5B8C;&#x6210;&#x6E05;&#x7406;&#x5DE5;&#x4F5C;&#xFF0C;&#x56E0;&#x4E3A;init&#x5728;&#x53D1;&#x5B8C;SIGTERM&#x4FE1;&#x53F7;&#x7684;5&#x79D2;&#x4E4B;&#x540E;&#x4F1A;&#x53D1;&#x9001;&#x4E00;&#x4E2A;SIGKILL&#x4FE1;&#x53F7;&#x3002;&#xFF08;&#x8FD9;&#x5E76;&#x4E0D;&#x610F;&#x5473;&#x7740;&#x8FD9;&#x4E2A;daemon&#x80FD;&#x591F;&#x6267;&#x884C;5&#x79D2;&#x7684;CPU&#x65F6;&#x95F4;&#xFF0C;&#x56E0;&#x4E3A;init&#x4F1A;&#x540C;&#x65F6;&#x5411;&#x7CFB;&#x7EDF;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#xFF0C;&#x800C;&#x5B83;&#x4EEC;&#x53EF;&#x80FD;&#x90FD;&#x8BD5;&#x56FE;&#x5728;5&#x79D2;&#x5185;&#x5B8C;&#x6210;&#x6E05;&#x7406;&#x5DE5;&#x4F5C;&#x3002;&#xFF09;</p>
<p>&#x7531;&#x4E8E;daemon&#x662F;&#x957F;&#x65F6;&#x95F4;&#x8FD0;&#x884C;&#x7684;&#xFF0C;&#x56E0;&#x6B64;&#x8981;&#x7279;&#x522B;&#x5C0F;&#x5FC3;&#x6F5C;&#x5728;&#x7684;&#x5185;&#x5B58;&#x6CC4;&#x9732;&#x95EE;&#x9898;&#x548C;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x6CC4;&#x9732;&#xFF08;&#x5373;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x6CA1;&#x6709;&#x5173;&#x95ED;&#x6240;&#x6709;&#x6253;&#x5F00;&#x7740;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#xFF09;&#x3002;&#x5982;&#x679C;&#x6B64;&#x7C7B;bug&#x5F71;&#x54CD;&#x5230;&#x4E86;daemon&#x7684;&#x8FD0;&#x884C;&#xFF0C;&#x90A3;&#x4E48;&#x552F;&#x4E00;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x662F;&#x6740;&#x6B7B;&#x5B83;&#xFF0C;&#x4E4B;&#x540E;&#xFF08;&#x4FEE;&#x590D;&#x4E86;bug&#xFF09;&#x518D;&#x91CD;&#x65B0;&#x542F;&#x52A8;&#x5B83;&#x3002;</p>
<p>&#x5F88;&#x591A;daemon&#x9700;&#x8981;&#x786E;&#x4FDD;&#x540C;&#x4E00;&#x65F6;&#x523B;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#x5904;&#x4E8E;&#x6D3B;&#x8DC3;&#x72B6;&#x6001;&#x3002;&#x5982;&#x8BA9;&#x4E24;&#x4E2A;cron daemon&#x90FD;&#x8BD5;&#x56FE;&#x5B9E;&#x884C;&#x8BA1;&#x5212;&#x4EFB;&#x52A1;&#x6BEB;&#x65E0;&#x610F;&#x4E49;&#x3002;</p>
<h2 id="&#x4F7F;&#x7528;SIGHUP&#x91CD;&#x65B0;&#x521D;&#x59CB;&#x5316;&#x4E00;&#x4E2A;daemon"><a href="#&#x4F7F;&#x7528;SIGHUP&#x91CD;&#x65B0;&#x521D;&#x59CB;&#x5316;&#x4E00;&#x4E2A;daemon" class="headerlink" title="&#x4F7F;&#x7528;SIGHUP&#x91CD;&#x65B0;&#x521D;&#x59CB;&#x5316;&#x4E00;&#x4E2A;daemon"></a>&#x4F7F;&#x7528;SIGHUP&#x91CD;&#x65B0;&#x521D;&#x59CB;&#x5316;&#x4E00;&#x4E2A;daemon</h2><p>&#x7531;&#x4E8E;&#x5F88;&#x591A;daemon&#x9700;&#x8981;&#x6301;&#x7EED;&#x8FD0;&#x884C;&#xFF0C;&#x56E0;&#x6B64;&#x5728;&#x8BBE;&#x8BA1;daemon&#x7A0B;&#x5E8F;&#x65F6;&#x9700;&#x8981;&#x514B;&#x670D;&#x4E00;&#x4E9B;&#x969C;&#x788D;&#x3002;</p>
<ul>
<li>&#x901A;&#x5E38;daemon&#x4F1A;&#x5728;&#x542F;&#x52A8;&#x65F6;&#x4ECE;&#x76F8;&#x5173;&#x7684;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E2D;&#x8BFB;&#x53D6;&#x64CD;&#x4F5C;&#x53C2;&#x6570;&#xFF0C;&#x4F46;&#x6709;&#x4E9B;&#x65F6;&#x5019;&#x9700;&#x8981;&#x5728;&#x4E0D;&#x91CD;&#x542F;daemon&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x5FEB;&#x901F;&#x4FEE;&#x6539;&#x8FD9;&#x4E9B;&#x53C2;&#x6570;&#x3002;</li>
<li>&#x4E00;&#x4E9B;daemon&#x4F1A;&#x4EA7;&#x751F;&#x65E5;&#x5FD7;&#x6587;&#x4EF6;&#x3002;&#x5982;&#x679C;daemon&#x6C38;&#x8FDC;&#x4E0D;&#x5173;&#x95ED;&#x65E5;&#x5FD7;&#x6587;&#x4EF6;&#x7684;&#x8BDD;&#xFF0C;&#x90A3;&#x4E48;&#x65E5;&#x5FD7;&#x6587;&#x4EF6;&#x5C31;&#x4F1A;&#x65E0;&#x9650;&#x5236;&#x5730;&#x589E;&#x957F;&#xFF0C;&#x6700;&#x7EC8;&#x4F1A;&#x963B;&#x585E;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x3002;&#xFF08;&#x5728;&#x524D;&#x9762;&#x7AE0;&#x8282;&#x4E2D;&#x66FE;&#x7ECF;&#x63D0;&#x5230;&#x8FC7;&#x5373;&#x4F7F;&#x5220;&#x9664;&#x4E86;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x7684;&#x6587;&#x4EF6;&#x540D;&#xFF0C;&#x53EA;&#x8981;&#x6709;&#x8FDB;&#x7A0B;&#x8FD8;&#x6253;&#x5F00;&#x7740;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x5C31;&#x4F1A;&#x4E00;&#x76F4;&#x5B58;&#x5728;&#x4E0B;&#x53BB;&#x3002;&#xFF09;&#x8FD9;&#x91CC;&#x9700;&#x8981;&#x6709;&#x4E00;&#x79CD;&#x673A;&#x5236;&#x6765;&#x544A;&#x8BC9;daemon&#x5173;&#x95ED;&#x5176;&#x65E5;&#x5FD7;&#x6587;&#x4EF6;&#x5E76;&#x6253;&#x5F00;&#x4E00;&#x4E2A;&#x65B0;&#x6587;&#x4EF6;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x80FD;&#x591F;&#x5728;&#x9700;&#x8981;&#x7684;&#x65F6;&#x5019;&#x65CB;&#x8F6C;&#x65E5;&#x5FD7;&#x6587;&#x4EF6;&#x4E86;&#x3002;</li>
</ul>
<p>&#x89E3;&#x51B3;&#x8FD9;&#x4E24;&#x4E2A;&#x95EE;&#x9898;&#x7684;&#x65B9;&#x6848;&#x662F;&#x8BA9;daemon&#x4E3A;SIGHUP&#x5EFA;&#x7ACB;&#x4E00;&#x4E2A;&#x5904;&#x7406;&#x5668;&#xFF0C;&#x5E76;&#x5728;&#x6536;&#x5230;&#x8FD9;&#x4E2A;&#x4FE1;&#x53F7;&#x65F6;&#x91C7;&#x53D6;&#x6240;&#x9700;&#x7684;&#x63AA;&#x65BD;&#x3002;&#x5F53;&#x63A7;&#x5236;&#x8FDB;&#x7A0B;&#x4E0E;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#x65AD;&#x5F00;&#x8FDE;&#x63A5;&#x4E4B;&#x540E;&#x5C31;&#x4F1A;&#x751F;&#x6210;SIGHUP&#x4FE1;&#x53F7;&#x3002;&#x7531;&#x4E8E;daemon&#x6CA1;&#x6709;&#x63A7;&#x5236;&#x7EC8;&#x7AEF;&#xFF0C;&#x56E0;&#x6B64;&#x5185;&#x6838;&#x6C38;&#x8FDC;&#x4E0D;&#x4F1A;&#x5411;daemon&#x53D1;&#x9001;&#x8FD9;&#x4E2A;&#x4FE1;&#x53F7;&#x3002;&#x8FD9;&#x6837;daemon&#x5C31;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;SIGHUP&#x4FE1;&#x53F7;&#x6765;&#x8FBE;&#x5230;&#x76EE;&#x7684;&#x3002;</p>
<p>TODO.</p>
<h2 id="&#x4F7F;&#x7528;syslog&#x8BB0;&#x5F55;&#x6D88;&#x606F;&#x548C;&#x9519;&#x8BEF;"><a href="#&#x4F7F;&#x7528;syslog&#x8BB0;&#x5F55;&#x6D88;&#x606F;&#x548C;&#x9519;&#x8BEF;" class="headerlink" title="&#x4F7F;&#x7528;syslog&#x8BB0;&#x5F55;&#x6D88;&#x606F;&#x548C;&#x9519;&#x8BEF;"></a>&#x4F7F;&#x7528;syslog&#x8BB0;&#x5F55;&#x6D88;&#x606F;&#x548C;&#x9519;&#x8BEF;</h2><p>&#x5728;&#x7F16;&#x5199;daemon&#x65F6;&#x78B0;&#x5230;&#x7684;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#x662F;&#x5982;&#x4F55;&#x663E;&#x793A;&#x9519;&#x8BEF;&#x6D88;&#x606F;&#x3002;&#x7531;&#x4E8E;daemon&#x662F;&#x5728;&#x540E;&#x53F0;&#x8FD0;&#x884C;&#x7684;&#xFF0C;&#x56E0;&#x6B64;&#x901A;&#x5E38;&#x65E0;&#x6CD5;&#x50CF;&#x5176;&#x4ED6;&#x7A0B;&#x5E8F;&#x90A3;&#x6837;&#x5C06;&#x6D88;&#x606F;&#x8F93;&#x51FA;&#x5230;&#x5173;&#x8054;&#x7EC8;&#x7AEF;&#x4E0A;&#x3002;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x7684;&#x4E00;&#x79CD;&#x89E3;&#x51B3;&#x65B9;&#x5F0F;&#x662F;&#x5C06;&#x6D88;&#x606F;&#x5199;&#x5165;&#x5230;&#x4E00;&#x4E2A;&#x7279;&#x5B9A;&#x4E8E;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x65E5;&#x5FD7;&#x6587;&#x4EF6;&#x4E2D;&#x3002;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x5B58;&#x5728;&#x7684;&#x4E00;&#x4E2A;&#x4E3B;&#x8981;&#x95EE;&#x9898;&#x662F;&#x8BA9;&#x7CFB;&#x7EDF;&#x7BA1;&#x7406;&#x5458;&#x7BA1;&#x7406;&#x591A;&#x4E2A;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x65E5;&#x5FD7;&#x6587;&#x4EF6;&#x548C;&#x76D1;&#x63A7;&#x5176;&#x4E2D;&#x662F;&#x5426;&#x5B58;&#x5728;&#x9519;&#x8BEF;&#x6D88;&#x606F;&#x6BD4;&#x8F83;&#x56F0;&#x96BE;&#xFF0C;syslog&#x5DE5;&#x5177;&#x5C31;&#x7528;&#x4E8E;&#x89E3;&#x51B3;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x3002;</p>
<h3 id="&#x6982;&#x8FF0;-3"><a href="#&#x6982;&#x8FF0;-3" class="headerlink" title="&#x6982;&#x8FF0;"></a>&#x6982;&#x8FF0;</h3><p>syslog&#x5DE5;&#x5177;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x96C6;&#x4E2D;&#x5F0F;&#x65E5;&#x5FD7;&#x5DE5;&#x5177;&#xFF0C;&#x7CFB;&#x7EDF;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x90FD;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x5DE5;&#x5177;&#x6765;&#x8BB0;&#x5F55;&#x65E5;&#x5FD7;&#x6D88;&#x606F;&#x3002;<br></p><div class="amp-img-wrapper"><amp-img src="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1581753917106.png?x-oss-process=image/resize,m_lfit,h_450" width="621" height="450" layout="responsive"></amp-img></div>
<p>syslog&#x5DE5;&#x5177;&#x6709;&#x4E24;&#x4E2A;&#x4E3B;&#x8981;&#x7EC4;&#x4EF6;&#xFF1A;syslogd daemon&#x548C;syslog(3)&#x5E93;&#x51FD;&#x6570;&#x3002;</p>
<p>System Log daemon syslogd&#x4ECE;&#x4E24;&#x4E2A;&#x4E0D;&#x540C;&#x7684;&#x6E90;&#x63A5;&#x6536;&#x65E5;&#x5FD7;&#x6D88;&#x606F;&#xFF1A;&#x4E00;&#x4E2A;&#x662F;UNIX domain socket /dev/log&#xFF0C;&#x5B83;&#x4FDD;&#x5B58;&#x672C;&#x5730;&#x4EA7;&#x751F;&#x7684;&#x6D88;&#x606F;&#xFF1B;&#x53E6;&#x4E00;&#x4E2A;&#x662F;Internet domain socket&#xFF08;UNP&#x7AEF;&#x53E3;514&#xFF0C;&#x5982;&#x679C;&#x542F;&#x7528;&#x7684;&#x8BDD;&#xFF09;&#xFF0C;&#x5B83;&#x4FDD;&#x5B58;&#x901A;&#x8FC7;TCP/IP&#x7F51;&#x7EDC;&#x53D1;&#x9001;&#x7684;&#x6D88;&#x606F;&#x3002;&#xFF08;&#x5728;&#x5176;&#x4ED6;&#x4E00;&#x4E9B;UNIX&#x5B9E;&#x73B0;&#x4E2D;&#xFF0C;syslog socket&#x4F4D;&#x4E8E;/var/run/log&#x3002;&#xFF09;</p>
<p>&#x6BCF;&#x6761;&#x7531;syslogd&#x5904;&#x7406;&#x7684;&#x6D88;&#x606F;&#x90FD;&#x5177;&#x5907;&#x51E0;&#x4E2A;&#x7279;&#x6027;&#xFF0C;&#x5176;&#x4E2D;&#x5305;&#x62EC;&#x4E00;&#x4E2A;facility&#xFF0C;&#x5B83;&#x6307;&#x5B9A;&#x4E86;&#x4EA7;&#x751F;&#x6D88;&#x606F;&#x7684;&#x7A0B;&#x5E8F;&#x7C7B;&#x578B;&#xFF1B;&#x8FD8;&#x6709;&#x4E00;&#x4E2A;&#x662F;level&#xFF0C;&#x5B83;&#x6307;&#x5B9A;&#x4E86;&#x6D88;&#x606F;&#x7684;&#x4E25;&#x91CD;&#x7A0B;&#x5EA6;&#xFF08;&#x4F18;&#x5148;&#x7EA7;&#xFF09;&#x3002;syslogd daemon&#x4F1A;&#x68C0;&#x67E5;&#x6BCF;&#x6761;&#x6D88;&#x606F;&#x7684;facility&#x548C;level&#xFF0C;&#x7136;&#x540E;&#x6839;&#x636E;&#x4E00;&#x4E2A;&#x76F8;&#x5173;&#x914D;&#x7F6E;&#x6587;&#x4EF6;/etc/syslog.conf&#x4E2D;&#x7684;&#x6307;&#x4EE4;&#x5C06;&#x6D88;&#x606F;&#x4F20;&#x9012;&#x5230;&#x51E0;&#x4E2A;&#x53EF;&#x80FD;&#x76EE;&#x7684;&#x5730;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x3002;&#x53EF;&#x80FD;&#x7684;&#x76EE;&#x7684;&#x5730;&#x5305;&#x62EC;&#x7EC8;&#x7AEF;&#x6216;&#x865A;&#x62DF;&#x63A7;&#x5236;&#x53F0;&#x3001;&#x78C1;&#x76D8;&#x6587;&#x4EF6;&#x3001;FIFO&#x3001;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#xFF08;&#x6216;&#x6240;&#x6709;&#xFF09;&#x767B;&#x5F55;&#x8FC7;&#x7684;&#x7528;&#x6237;&#x4EE5;&#x53CA;&#x4F4D;&#x4E8E;&#x53E6;&#x4E00;&#x4E2A;&#x7CFB;&#x7EDF;&#x4E0A;&#x7684;&#x901A;&#x8FC7;TCP/IP&#x7F51;&#x7EDC;&#x8FDE;&#x63A5;&#x7684;&#x8FDB;&#x7A0B;&#xFF08;&#x901A;&#x5E38;&#x662F;&#x53E6;&#x4E00;&#x4E2A;syslogd daemon&#xFF09;&#x3002;&#xFF08;&#x5C06;&#x6D88;&#x606F;&#x53D1;&#x9001;&#x5230;&#x53E6;&#x4E00;&#x4E2A;&#x7CFB;&#x7EDF;&#x4E0A;&#x7684;&#x8FDB;&#x7A0B;&#x6709;&#x52A9;&#x4E8E;&#x901A;&#x8FC7;&#x5C06;&#x591A;&#x4E2A;&#x7CFB;&#x7EDF;&#x4E2D;&#x7684;&#x65E5;&#x5FD7;&#x4FE1;&#x606F;&#x96C6;&#x4E2D;&#x5230;&#x4E00;&#x4E2A;&#x4F4D;&#x7F6E;&#x4EE5;&#x964D;&#x4F4E;&#x7BA1;&#x7406;&#x8D1F;&#x62C5;&#x3002;&#xFF09;&#x4E00;&#x6761;&#x6D88;&#x606F;&#x53EF;&#x4EE5;&#x88AB;&#x53D1;&#x9001;&#x5230;&#x591A;&#x4E2A;&#x76EE;&#x7684;&#x5730;&#xFF08;&#x6216;&#x4E0D;&#x53D1;&#x9001;&#x5230;&#x4EFB;&#x4F55;&#x76EE;&#x7684;&#x5730;&#xFF09;&#xFF0C;&#x5177;&#x5907;&#x4E0D;&#x540C;&#x7684;facility&#x548C;level&#x7EC4;&#x5408;&#x7684;&#x6D88;&#x606F;&#x53EF;&#x4EE5;&#x88AB;&#x53D1;&#x9001;&#x5230;&#x4E0D;&#x540C;&#x7684;&#x76EE;&#x7684;&#x5730;&#x6216;&#x4E0D;&#x540C;&#x7684;&#x76EE;&#x7684;&#x5730;&#x5B9E;&#x4F8B;&#xFF08;&#x5373;&#x4E0D;&#x540C;&#x7684;&#x63A7;&#x5236;&#x53F0;&#x3001;&#x4E0D;&#x540C;&#x7684;&#x78C1;&#x76D8;&#x6587;&#x4EF6;&#x7B49;&#xFF09;&#x3002;</p>
<p>&#x901A;&#x8FC7;TCP/IP&#x7F51;&#x7EDC;&#x5C06;syslog&#x6D88;&#x606F;&#x53D1;&#x9001;&#x5230;&#x53E6;&#x4E00;&#x4E2A;&#x7CFB;&#x7EDF;&#x8FD8;&#x6709;&#x52A9;&#x4E8E;&#x53D1;&#x73B0;&#x7CFB;&#x7EDF;&#x975E;&#x6CD5;&#x5165;&#x4FB5;&#x3002;&#x975E;&#x6CD5;&#x5165;&#x4FB5;&#x901A;&#x5E38;&#x4F1A;&#x5728;&#x7CFB;&#x7EDF;&#x65E5;&#x5FD7;&#x4E2D;&#x7559;&#x4E0B;&#x8E2A;&#x8FF9;&#xFF0C;&#x4F46;&#x653B;&#x51FB;&#x8005;&#x901A;&#x5E38;&#x4F1A;&#x5220;&#x9664;&#x65E5;&#x5FD7;&#x8BB0;&#x5F55;&#x4EE5;&#x63A9;&#x76D6;&#x4ED6;&#x4EEC;&#x7684;&#x884C;&#x4E3A;&#x3002;&#x6709;&#x4E86;&#x8FDC;&#x7A0B;&#x65E5;&#x5FD7;&#x8BB0;&#x5F55;&#x4E4B;&#x540E;&#xFF0C;&#x653B;&#x51FB;&#x8005;&#x5C31;&#x9700;&#x8981;&#x4FB5;&#x5165;&#x53E6;&#x4E00;&#x4E2A;&#x7CFB;&#x7EDF;&#x624D;&#x80FD;&#x5220;&#x9664;&#x65E5;&#x5FD7;&#x8BB0;&#x5F55;&#x3002;</p>
<p>&#x901A;&#x5E38;&#xFF0C;&#x4EFB;&#x610F;&#x8FDB;&#x7A0B;&#x90FD;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;syslog(3)&#x5E93;&#x51FD;&#x6570;&#x6765;&#x8BB0;&#x5F55;&#x6D88;&#x606F;&#x3002;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4F1A;&#x4F7F;&#x7528;&#x4F20;&#x5165;&#x7684;&#x53C2;&#x6570;&#x4EE5;&#x6807;&#x51C6;&#x7684;&#x683C;&#x5F0F;&#x6784;&#x5EFA;&#x4E00;&#x6761;&#x6D88;&#x606F;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x8FD9;&#x6761;&#x6D88;&#x606F;&#x5199;&#x5165;/dev/log socket&#x4EE5;&#x4F9B;syslogd&#x8BFB;&#x53D6;.</p>
<p>/dev/log&#x4E2D;&#x7684;&#x6D88;&#x606F;&#x7684;&#x53E6;&#x4E00;&#x4E2A;&#x6765;&#x6E90;&#x662F;Kernel Log daemon klogd&#xFF0C;&#x5B83;&#x4F1A;&#x6536;&#x96C6;&#x5185;&#x6838;&#x65E5;&#x5FD7;&#x6D88;&#x606F;&#xFF08;&#x5185;&#x6838;&#x4F7F;&#x7528;printk()&#x51FD;&#x6570;&#x751F;&#x6210;&#x7684;&#x6D88;&#x606F;&#xFF09;&#x3002;&#x8FD9;&#x4E9B;&#x6D88;&#x606F;&#x7684;&#x6536;&#x96C6;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4E24;&#x4E2A;&#x7B49;&#x4EF7;&#x7684;Linux&#x7279;&#x6709;&#x7684;&#x63A5;&#x53E3;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x6765;&#x5B8C;&#x6210;&#xFF08;&#x5373;/proc/kmsg&#x6587;&#x4EF6;&#x548C;syslog(2)&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF09;&#xFF0C;&#x7136;&#x540E;&#x4F7F;&#x7528;syslog(3)&#x5E93;&#x51FD;&#x6570;&#x5C06;&#x5B83;&#x4EEC;&#x5199;&#x5165;/dev/log&#x3002;</p>
<p>&#x5C3D;&#x7BA1;syslog(2)&#x548C;syslog(3)&#x7684;&#x540D;&#x79F0;&#x76F8;&#x540C;&#xFF0C;&#x4F46;&#x5B83;&#x4EEC;&#x6267;&#x884C;&#x7684;&#x4EFB;&#x52A1;&#x662F;&#x4E0D;&#x540C;&#x7684;&#x3002;glibc&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x8C03;&#x7528;syslog(2)&#x7684;&#x63A5;&#x53E3;&#xFF0C;&#x5176;&#x540D;&#x79F0;&#x4E3A;klogctl()&#x3002;</p>
<p>syslog&#x5DE5;&#x5177;&#x539F;&#x5148;&#x51FA;&#x73B0;&#x5728;4.2BSD&#x4E2D;&#xFF0C;&#x4F46;&#x73B0;&#x5728;&#x51E0;&#x4E4E;&#x6240;&#x6709;&#x7684;UNIX&#x5B9E;&#x73B0;&#x90FD;&#x63D0;&#x4F9B;&#x4E86;&#x8FD9;&#x4E2A;&#x5DE5;&#x5177;&#x3002;SUSv3&#x5BF9;syslog(3)&#x548C;&#x76F8;&#x5173;&#x51FD;&#x6570;&#x8FDB;&#x884C;&#x4E86;&#x6807;&#x51C6;&#x5316;&#xFF0C;&#x4F46;&#x5E76;&#x6CA1;&#x6709;&#x89C4;&#x5B9A;syslogd&#x7684;&#x5B9E;&#x73B0;&#x548C;&#x64CD;&#x4F5C;&#x4EE5;&#x53CA;syslog.conf&#x6587;&#x4EF6;&#x7684;&#x683C;&#x5F0F;&#x3002;Linux&#x4E2D;syslogd&#x7684;&#x5B9E;&#x73B0;&#x4E0E;&#x5B83;&#x539F;&#x5148;&#x5728;BSD&#x7684;&#x5B9E;&#x73B0;&#x7684;&#x4E0D;&#x540C;&#x4E4B;&#x5904;&#x5728;&#x4E8E;Linux&#x5141;&#x8BB8;&#x5BF9;&#x5728;syslog.conf&#x4E2D;&#x6307;&#x5B9A;&#x7684;&#x6D88;&#x606F;&#x5904;&#x7406;&#x89C4;&#x5219;&#x8FDB;&#x884C;&#x4E00;&#x4E9B;&#x6269;&#x5C55;&#x3002;</p>
<h3 id="syslog-API"><a href="#syslog-API" class="headerlink" title="syslog API"></a>syslog API</h3><p>syslog API&#x7531;&#x4EE5;&#x4E0B;&#x4E09;&#x4E2A;&#x4E3B;&#x8981;&#x51FD;&#x6570;&#x6784;&#x6210;&#x3002;</p>
<ul>
<li>openlog()&#x51FD;&#x6570;&#x4E3A;&#x540E;&#x7EED;&#x7684;&#x7684;syslog()&#x8C03;&#x7528;&#x5EFA;&#x7ACB;&#x4E86;&#x9ED8;&#x8BA4;&#x8BBE;&#x7F6E;&#x3002;syslog()&#x7684;&#x8C03;&#x7528;&#x662F;&#x53EF;&#x9009;&#x7684;&#xFF0C;&#x5982;&#x679C;&#x7701;&#x7565;&#x4E86;&#x8FD9;&#x4E2A;&#x8C03;&#x7528;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x4F1A;&#x4F7F;&#x7528;&#x9996;&#x6B21;&#x8C03;&#x7528;syslog()&#x65F6;&#x91C7;&#x7528;&#x7684;&#x9ED8;&#x8BA4;&#x8BBE;&#x7F6E;&#x6765;&#x5EFA;&#x7ACB;&#x5230;&#x65E5;&#x5FD7;&#x8BB0;&#x5F55;&#x5DE5;&#x5177;&#x7684;&#x8FDE;&#x63A5;&#x3002;</li>
<li>syslog()&#x51FD;&#x6570;&#x8BB0;&#x5F55;&#x4E00;&#x6761;&#x65E5;&#x5FD7;&#x6D88;&#x606F;&#x3002;</li>
<li>&#x5F53;&#x5B8C;&#x6210;&#x65E5;&#x5FD7;&#x8BB0;&#x5F55;&#x6D88;&#x606F;&#x4E4B;&#x540E;&#x9700;&#x8981;&#x8C03;&#x7528;closelog()&#x51FD;&#x6570;&#x62C6;&#x9664;&#x4E0E;&#x65E5;&#x5FD7;&#x4E4B;&#x95F4;&#x7684;&#x8FDE;&#x63A5;&#x3002;</li>
</ul>
<p>&#x6240;&#x6709;&#x8FD9;&#x4E9B;&#x51FD;&#x6570;&#x90FD;&#x4E0D;&#x4F1A;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x72B6;&#x6001;&#x503C;&#xFF0C;&#x8FD9;&#x662F;&#x56E0;&#x4E3A;&#x7CFB;&#x7EDF;&#x65E5;&#x5FD7;&#x670D;&#x52A1;&#x5E94;&#x8BE5;&#x603B;&#x662F;&#x5904;&#x4E8E;&#x53EF;&#x7528;&#x72B6;&#x6001;&#xFF08;&#x7CFB;&#x7EDF;&#x7BA1;&#x7406;&#x5458;&#x5E94;&#x8BE5;&#x5728;&#x670D;&#x52A1;&#x4E0D;&#x53EF;&#x7528;&#x65F6;&#x7ACB;&#x5373;&#x80FD;&#x53D1;&#x73B0;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#xFF09;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x5982;&#x679C;&#x5728;&#x7CFB;&#x7EDF;&#x8BB0;&#x5F55;&#x65E5;&#x5FD7;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x53D1;&#x751F;&#x4E86;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#xFF0C;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x901A;&#x5E38;&#x4E5F;&#x65E0;&#x6CD5;&#x505A;&#x66F4;&#x591A;&#x7684;&#x4E8B;&#x60C5;&#x6765;&#x62A5;&#x544A;&#x8FD9;&#x4E2A;&#x9519;&#x8BEF;&#x3002;</p>
<h3 id="&#x5EFA;&#x7ACB;&#x4E00;&#x4E2A;&#x5230;&#x7CFB;&#x7EDF;&#x65E5;&#x5FD7;&#x7684;&#x8FDE;&#x63A5;"><a href="#&#x5EFA;&#x7ACB;&#x4E00;&#x4E2A;&#x5230;&#x7CFB;&#x7EDF;&#x65E5;&#x5FD7;&#x7684;&#x8FDE;&#x63A5;" class="headerlink" title="&#x5EFA;&#x7ACB;&#x4E00;&#x4E2A;&#x5230;&#x7CFB;&#x7EDF;&#x65E5;&#x5FD7;&#x7684;&#x8FDE;&#x63A5;"></a>&#x5EFA;&#x7ACB;&#x4E00;&#x4E2A;&#x5230;&#x7CFB;&#x7EDF;&#x65E5;&#x5FD7;&#x7684;&#x8FDE;&#x63A5;</h3><p>openlog()&#x51FD;&#x6570;&#x7684;&#x8C03;&#x7528;&#x662F;&#x53EF;&#x9009;&#x7684;&#xFF0C;&#x5B83;&#x5EFA;&#x7ACB;&#x4E00;&#x4E2A;&#x5230;&#x7CFB;&#x7EDF;&#x65E5;&#x5FD7;&#x5DE5;&#x5177;&#x7684;&#x8FDE;&#x63A5;&#x5E76;&#x4E3A;&#x540E;&#x7EED;&#x7684;syslog()&#x8C03;&#x7528;&#x8BBE;&#x7F6E;&#x9ED8;&#x8BA4;&#x8BBE;&#x7F6E;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;syslog.h&gt;</span></span>

<span class="token keyword">void</span> <span class="token function">openlog</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>ident<span class="token punctuation">,</span> <span class="token keyword">int</span> option<span class="token punctuation">,</span> <span class="token keyword">int</span> facility<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>ident&#x53C2;&#x6570;&#x662F;&#x4E00;&#x4E2A;&#x6307;&#x5411;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x6307;&#x9488;&#xFF0C;syslog()&#x8F93;&#x51FA;&#x7684;&#x6BCF;&#x6761;&#x6D88;&#x606F;&#x90FD;&#x4F1A;&#x5305;&#x542B;&#x8FD9;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x8FD9;&#x4E2A;&#x53C2;&#x6570;&#x7684;&#x53D6;&#x503C;&#x901A;&#x5E38;&#x662F;&#x7A0B;&#x5E8F;&#x540D;&#x3002;&#x6CE8;&#x610F;openlog()&#x4EC5;&#x4EC5;&#x662F;&#x590D;&#x5236;&#x4E86;&#x8FD9;&#x4E2A;&#x6307;&#x9488;&#x7684;&#x503C;&#x3002;&#x53EA;&#x8981;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x540E;&#x9762;&#x4F1A;&#x7EE7;&#x7EED;&#x8C03;&#x7528;syslog()&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x5E94;&#x8BE5;&#x786E;&#x4FDD;&#x4E0D;&#x4F1A;&#x4FEE;&#x6539;&#x6240;&#x5F15;&#x7528;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002;</p>
<p>&#x5982;&#x679C;ident&#x7684;&#x503C;&#x4E3A;NULL&#xFF0C;&#x90A3;&#x4E48;&#x4E0E;&#x5176;&#x4ED6;&#x4E00;&#x4E9B;&#x5B9E;&#x73B0;&#x4E00;&#x6837;&#xFF0C;glibc syslog&#x5B9E;&#x73B0;&#x4F1A;&#x81EA;&#x52A8;&#x5C06;&#x7A0B;&#x5E8F;&#x540D;&#x4F5C;&#x4E3A;ident&#x7684;&#x503C;&#x3002;&#x4F46;SUSv3&#x5E76;&#x6CA1;&#x6709;&#x8981;&#x6C42;&#x5B9E;&#x73B0;&#x8FD9;&#x4E2A;&#x529F;&#x80FD;&#xFF0C;&#x4E00;&#x4E9B;&#x5B9E;&#x73B0;&#x4E5F;&#x6CA1;&#x6709;&#x63D0;&#x4F9B;&#x8FD9;&#x4E2A;&#x529F;&#x80FD;&#x3002;&#x53EF;&#x79FB;&#x690D;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x4E0D;&#x5E94;&#x8BE5;&#x4F9D;&#x8D56;&#x4E8E;&#x8FD9;&#x4E2A;&#x529F;&#x80FD;&#x3002;</p>
<p>&#x4F20;&#x5165;openlog()&#x7684;log_options&#x53C2;&#x6570;&#x662F;&#x4E00;&#x4E2A;&#x4F4D;&#x63A9;&#x7801;&#xFF0C;&#x5B83;&#x662F;&#x4E0B;&#x9762;&#x51E0;&#x4E2A;&#x5E38;&#x91CF;&#x4E4B;&#x95F4;&#x7684;OR&#x503C;&#x3002;</p>
<p><code>LOG_CONS</code><br>&#x5F53;&#x5411;&#x7CFB;&#x7EDF;&#x65E5;&#x5FD7;&#x53D1;&#x9001;&#x6D88;&#x606F;&#x53D1;&#x751F;&#x9519;&#x8BEF;&#x65F6;&#x5C06;&#x6D88;&#x606F;&#x5199;&#x5165;&#x5230;&#x7CFB;&#x7EDF;&#x63A7;&#x5236;&#x53F0;&#xFF08;/dev/console&#xFF09;&#x3002;</p>
<p><code>LOG_NDELAY</code><br>&#x7ACB;&#x5373;&#x6253;&#x5F00;&#x5230;&#x65E5;&#x5FD7;&#x7CFB;&#x7EDF;&#x7684;&#x8FDE;&#x63A5;&#xFF08;&#x5373;&#x5E95;&#x5C42;&#x7684;UNIX domain socket, /dev/log&#xFF09;&#x3002;&#x5728;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF08;LOG_ODELAY&#xFF09;&#xFF0C;&#x53EA;&#x6709;&#x5728;&#x9996;&#x6B21;&#x4F7F;&#x7528;syslog()&#x8BB0;&#x5F55;&#x6D88;&#x606F;&#x7684;&#x65F6;&#x5019;&#x624D;&#x4F1A;&#x6253;&#x5F00;&#x8FDE;&#x63A5;&#x3002;O_NDELAY&#x6807;&#x8BB0;&#x5BF9;&#x4E8E;&#x90A3;&#x4E9B;&#x9700;&#x8981;&#x7CBE;&#x786E;&#x63A7;&#x5236;&#x4F55;&#x65F6;&#x4E3A;/dev/log&#x5206;&#x914D;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x7684;&#x7A0B;&#x5E8F;&#x6765;&#x8BB2;&#x662F;&#x6BD4;&#x8F83;&#x6709;&#x7528;&#x7684;&#xFF0C;&#x5982;&#x8C03;&#x7528;chroot()&#x7684;&#x7A0B;&#x5E8F;&#x5C31;&#x6709;&#x8FD9;&#x6837;&#x7684;&#x8981;&#x6C42;&#x3002;&#x5728;&#x8C03;&#x7528;chroot()&#x4E4B;&#x540E;&#xFF0C;/dev/log&#x8DEF;&#x5F84;&#x540D;&#x5C06;&#x4E0D;&#x518D;&#x53EF;&#x89C1;&#xFF0C;&#x56E0;&#x6B64;&#x5728;chroot()&#x4E4B;&#x524D;&#x9700;&#x8981;&#x8C03;&#x7528;&#x4E00;&#x4E2A;&#x6307;&#x5B9A;&#x4E86;LOG_NDELAY&#x7684;openlog()&#x3002;tftpd daemon&#xFF08;Trivial File Transfer&#xFF09;&#x5C31;&#x56E0;&#x4E3A;&#x4E0A;&#x8FF0;&#x7684;&#x539F;&#x56E0;&#x800C;&#x4F7F;&#x7528;&#x4E86;LOG_NDELAY&#x3002;</p>
<p><code>LOG_NOWAIT</code><br>&#x4E0D;&#x8981;wait()&#x88AB;&#x521B;&#x5EFA;&#x6765;&#x8BB0;&#x5F55;&#x65E5;&#x5FD7;&#x6D88;&#x606F;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x3002;&#x5728;&#x90A3;&#x4E9B;&#x521B;&#x5EFA;&#x5B50;&#x8FDB;&#x7A0B;&#x6765;&#x8BB0;&#x5F55;&#x65E5;&#x5FD7;&#x6D88;&#x606F;&#x7684;&#x5B9E;&#x73B0;&#x4E0A;&#xFF0C;&#x5F53;&#x8C03;&#x7528;&#x8005;&#x521B;&#x5EFA;&#x5E76;&#x7B49;&#x5F85;&#x5B50;&#x8FDB;&#x7A0B;&#x65F6;&#x5C31;&#x9700;&#x8981;&#x4F7F;&#x7528;LOG_NOWAIT&#x4E86;&#xFF0C;&#x8FD9;&#x6837;syslog()&#x5C31;&#x4E0D;&#x4F1A;&#x8BD5;&#x56FE;&#x7B49;&#x5F85;&#x5DF2;&#x7ECF;&#x88AB;&#x8C03;&#x7528;&#x8005;&#x9500;&#x6BC1;&#x7684;&#x5B50;&#x8FDB;&#x7A0B;&#x3002;&#x5728;Linux&#x4E0A;&#xFF0C;LOG_NOWAIT&#x4E0D;&#x8D77;&#x4EFB;&#x4F55;&#x4F5C;&#x7528;&#xFF0C;&#x56E0;&#x4E3A;&#x5728;&#x8BB0;&#x5F55;&#x65E5;&#x5FD7;&#x6D88;&#x606F;&#x65F6;&#x4E0D;&#x4F1A;&#x521B;&#x5EFA;&#x5B50;&#x8FDB;&#x7A0B;&#x3002;</p>
<p><code>LOG_ODELAY</code><br>&#x8FD9;&#x4E2A;&#x6807;&#x8BB0;&#x7684;&#x4F5C;&#x7528;&#x4E0E;LOG_NDELAY&#x76F8;&#x53CD;&#x2014;&#x2014;&#x8FDE;&#x63A5;&#x5230;&#x65E5;&#x5FD7;&#x7CFB;&#x7EDF;&#x7684;&#x64CD;&#x4F5C;&#x4F1A;&#x88AB;&#x5EF6;&#x8FDF;&#x81F3;&#x8BB0;&#x5F55;&#x7B2C;&#x4E00;&#x6761;&#x6D88;&#x606F;&#x65F6;&#x3002;&#x8FD9;&#x662F;&#x9ED8;&#x8BA4;&#x884C;&#x4E3A;&#xFF0C;&#x56E0;&#x6B64;&#x65E0;&#x9700;&#x6307;&#x5B9A;&#x8FD9;&#x4E2A;&#x6807;&#x8BB0;&#x3002;</p>
<p><code>LOG_PERROR</code><br>&#x5C06;&#x6D88;&#x606F;&#x5199;&#x5165;&#x6807;&#x51C6;&#x9519;&#x8BEF;&#x548C;&#x7CFB;&#x7EDF;&#x65E5;&#x5FD7;&#x3002;&#x901A;&#x5E38;&#xFF0C;daemon&#x8FDB;&#x7A0B;&#x4F1A;&#x5173;&#x95ED;&#x6807;&#x51C6;&#x9519;&#x8BEF;&#x6216;&#x5C06;&#x5176;&#x91CD;&#x5B9A;&#x5411;&#x5230;/dev/null&#xFF0C;&#x8FD9;&#x6837;LOG_PERROR&#x5C31;&#x6CA1;&#x6709;&#x7528;&#x4E86;&#x3002;</p>
<p><code>LOG_PID</code></p>
<p>&#x5728;&#x6BCF;&#x6761;&#x6D88;&#x606F;&#x4E2D;&#x52A0;&#x4E0A;&#x8C03;&#x7528;&#x8005;&#x7684;&#x8FDB;&#x7A0B;ID&#x3002;&#x5728;&#x4E00;&#x4E2A;&#x521B;&#x5EFA;&#x591A;&#x4E2A;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x670D;&#x52A1;&#x5668;&#x4E2D;&#x4F7F;&#x7528;LOG_PID&#x6709;&#x52A9;&#x4E8E;&#x533A;&#x5206;&#x54EA;&#x4E2A;&#x8FDB;&#x7A0B;&#x8BB0;&#x5F55;&#x4E86;&#x67D0;&#x6761;&#x7279;&#x5B9A;&#x7684;&#x6D88;&#x606F;&#x3002;<br><strong>openlog()&#x7684;facility&#x503C;&#x548C;syslog()&#x7684;priority&#x53C2;&#x6570;&#xFF1A;</strong></p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th align="left">&#x503C;</th>
<th align="center">&#x63CF; &#x8FF0;</th>
<th align="center">SUSv3</th>
</tr>
</thead>
<tbody><tr>
<td align="left">LOG_AUTH</td>
<td align="center">&#x5B89;&#x5168;&#x548C;&#x9A8C;&#x8BC1;&#x6D88;&#x606F;&#xFF08;&#x5982;su&#xFF09;</td>
<td align="center">&#x25CF;</td>
</tr>
<tr>
<td align="left">LOG_AUTHPRIV</td>
<td align="center">&#x79C1;&#x6709;&#x7684;&#x5B89;&#x5168;&#x548C;&#x9A8C;&#x8BC1;&#x6D88;&#x606F;</td>
<td align="center"></td>
</tr>
<tr>
<td align="left">LOG_CRON</td>
<td align="center">&#x6765;&#x81EA;cron&#x548C;at daemons&#x7684;&#x6D88;&#x606F;</td>
<td align="center">&#x25CF;</td>
</tr>
<tr>
<td align="left">LOG_DAEMON</td>
<td align="center">&#x6765;&#x81EA;&#x5176;&#x4ED6;&#x7CFB;&#x7EDF;daemon&#x7684;&#x6D88;&#x606F;</td>
<td align="center">&#x25CF;</td>
</tr>
<tr>
<td align="left">LOG_FTP</td>
<td align="center">&#x6765;&#x81EA;ftp daemon&#x7684;&#x6D88;&#x606F;&#xFF08;ftpd&#xFF09;</td>
<td align="center"></td>
</tr>
<tr>
<td align="left">LOG_KERN</td>
<td align="center">&#x5185;&#x6838;&#x6D88;&#x606F;&#xFF08;&#x7528;&#x6237;&#x8FDB;&#x7A0B;&#x65E0;&#x6CD5;&#x751F;&#x6210;&#x6B64;&#x7C7B;&#x6D88;&#x606F;&#xFF09;</td>
<td align="center">&#x25CF;</td>
</tr>
<tr>
<td align="left">LOG_LOCAL0</td>
<td align="center">&#x4FDD;&#x7559;&#x7ED9;&#x672C;&#x5730;&#x4F7F;&#x7528;&#xFF08;&#x5305;&#x62EC;LOG_LOCAL1&#x5230;LOG_LOCAL7&#xFF09;</td>
<td align="center">&#x25CF;</td>
</tr>
<tr>
<td align="left">LOG_LPR</td>
<td align="center">&#x6765;&#x81EA;&#x884C;&#x6253;&#x5370;&#x673A;&#x7CFB;&#x7EDF;&#x7684;&#x6D88;&#x606F;&#xFF08;lpr&#x3001;lpd&#x3001;lpc&#xFF09;</td>
<td align="center">&#x25CF;</td>
</tr>
<tr>
<td align="left">LOG_MAIL</td>
<td align="center">&#x6765;&#x81EA;&#x90AE;&#x4EF6;&#x7CFB;&#x7EDF;&#x7684;&#x6D88;&#x606F;</td>
<td align="center">&#x25CF;</td>
</tr>
<tr>
<td align="left">LOG_NEWS</td>
<td align="center">&#x4E0E;Usenet&#x7F51;&#x7EDC;&#x65B0;&#x95FB;&#x76F8;&#x5173;&#x7684;&#x6D88;&#x606F;</td>
<td align="center">&#x25CF;</td>
</tr>
<tr>
<td align="left">LOG_SYSLOG</td>
<td align="center">&#x6765;&#x81EA;syslogd daemon&#x7684;&#x6D88;&#x606F;</td>
<td align="center"></td>
</tr>
<tr>
<td align="left">LOG_USER</td>
<td align="center">&#x7528;&#x6237;&#x8FDB;&#x7A0B;&#xFF08;&#x9ED8;&#x8BA4;&#x503C;&#xFF09;&#x751F;&#x6210;&#x7684;&#x6D88;&#x606F;</td>
<td align="center">&#x25CF;</td>
</tr>
<tr>
<td align="left">LOG_UUCP</td>
<td align="center">&#x6765;&#x81EA;UUCP&#x7CFB;&#x7EDF;&#x7684;&#x6D88;&#x606F;</td>
<td align="center">&#x25CF;</td>
</tr>
</tbody></table></div>
<p>&#x4E0A;&#x8868;&#x5217;&#x51FA;&#x7684;facility&#x503C;&#x7684;&#x5927;&#x90E8;&#x5206;&#x90FD;&#x5728;SUSv3&#x4E2D;&#x8FDB;&#x884C;&#x4E86;&#x5B9A;&#x4E49;&#xFF0C;&#x5982;&#x8868;&#x4E2D;&#x7684;SUSv3&#x5217;&#x6240;&#x793A;&#xFF0C;&#x4F46;LOG_AUTHPRIV&#x548C;LOG_FTP&#x53EA;&#x51FA;&#x73B0;&#x5728;&#x4E86;&#x4E00;&#x4E9B;UNIX&#x5B9E;&#x73B0;&#x4E2D;&#xFF0C;LOG_SYSLOG&#x5219;&#x5728;&#x5927;&#x591A;&#x6570;&#x5B9E;&#x73B0;&#x4E2D;&#x90FD;&#x5B58;&#x5728;&#x3002;&#x5F53;&#x9700;&#x8981;&#x5C06;&#x5305;&#x542B;&#x5BC6;&#x7801;&#x6216;&#x5176;&#x4ED6;&#x654F;&#x611F;&#x4FE1;&#x606F;&#x7684;&#x65E5;&#x5FD7;&#x6D88;&#x606F;&#x8BB0;&#x5F55;&#x5230;&#x4E00;&#x4E2A;&#x4E0E;LOG_AUTH&#x6307;&#x5B9A;&#x7684;&#x4F4D;&#x7F6E;&#x4E0D;&#x540C;&#x7684;&#x4F4D;&#x7F6E;&#x4E0A;&#x65F6;&#xFF0C;LOG_AUTHPRIV&#x503C;&#x662F;&#x6BD4;&#x8F83;&#x6709;&#x7528;&#x7684;&#x3002;</p>
<p>LOG_KERN facility&#x503C;&#x7528;&#x4E8E;&#x5185;&#x6838;&#x6D88;&#x606F;&#x3002;&#x7528;&#x6237;&#x7A7A;&#x95F4;&#x7684;&#x7A0B;&#x5E8F;&#x662F;&#x65E0;&#x6CD5;&#x7528;&#x8FD9;&#x4E2A;&#x5DE5;&#x5177;&#x8BB0;&#x5F55;&#x65E5;&#x5FD7;&#x6D88;&#x606F;&#x7684;&#x3002;LOG_KERN&#x5E38;&#x91CF;&#x7684;&#x503C;&#x4E3A;0&#x3002;&#x5982;&#x679C;&#x5728;syslog()&#x8C03;&#x7528;&#x4E2D;&#x4F7F;&#x7528;&#x4E86;&#x8FD9;&#x4E2A;&#x5E38;&#x91CF;&#xFF0C;&#x90A3;&#x4E48;0&#x88AB;&#x7FFB;&#x8BD1;&#x6210;&#x4E86;&#x201C;&#x4F7F;&#x7528;&#x9ED8;&#x8BA4;&#x7684;&#x7EA7;&#x522B;&#x201D;&#x3002;</p>
<h3 id="&#x8BB0;&#x5F55;&#x4E00;&#x6761;&#x65E5;&#x5FD7;&#x6D88;&#x606F;"><a href="#&#x8BB0;&#x5F55;&#x4E00;&#x6761;&#x65E5;&#x5FD7;&#x6D88;&#x606F;" class="headerlink" title="&#x8BB0;&#x5F55;&#x4E00;&#x6761;&#x65E5;&#x5FD7;&#x6D88;&#x606F;"></a>&#x8BB0;&#x5F55;&#x4E00;&#x6761;&#x65E5;&#x5FD7;&#x6D88;&#x606F;</h3><p>&#x8981;&#x5199;&#x5165;&#x4E00;&#x6761;&#x65E5;&#x5FD7;&#x6D88;&#x606F;&#x53EF;&#x4EE5;&#x8C03;&#x7528;syslog()&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;syslog.h&gt;</span></span>

<span class="token keyword">void</span> <span class="token function">syslog</span><span class="token punctuation">(</span><span class="token keyword">int</span> priority<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span>format<span class="token punctuation">,</span>&#x2026;&#x2026;<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>priority&#x53C2;&#x6570;&#x662F;facility&#x503C;&#x548C;level&#x503C;&#x7684;OR&#x503C;&#x3002;facility&#x8868;&#x793A;&#x8BB0;&#x5F55;&#x65E5;&#x5FD7;&#x6D88;&#x606F;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x7C7B;&#x522B;&#xFF0C;&#x5176;&#x53D6;&#x503C;&#x4E3A;&#x4E0A;&#x8868;&#x4E2D;&#x5217;&#x51FA;&#x7684;&#x503C;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x3002;&#x5982;&#x679C;&#x7701;&#x7565;&#x4E86;&#x8FD9;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x90A3;&#x4E48;facility&#x7684;&#x9ED8;&#x8BA4;&#x503C;&#x4E3A;&#x524D;&#x9762;&#x4E00;&#x4E2A;openlog()&#x8C03;&#x7528;&#x4E2D;&#x6307;&#x5B9A;&#x7684;facility&#x503C;&#xFF0C;&#x6216;&#x8005;&#x5F53;&#x90A3;&#x4E2A;&#x8C03;&#x7528;&#x4E2D;&#x4E5F;&#x7701;&#x7565;&#x4E86;facility&#x503C;&#x7684;&#x8BDD;&#x4E3A;LOG_USER&#x3002;level&#x8868;&#x793A;&#x6D88;&#x606F;&#x7684;&#x4E25;&#x91CD;&#x7A0B;&#x5EA6;&#xFF0C;&#x5176;&#x53D6;&#x503C;&#x4E3A;&#x8868;37-2&#x4E2D;&#x5217;&#x51FA;&#x7684;&#x503C;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x3002;&#x8FD9;&#x5F20;&#x8868;&#x4E2D;&#x5217;&#x51FA;&#x7684;&#x6240;&#x6709;&#x503C;&#x90FD;&#x5728;SUSv3&#x8FDB;&#x884C;&#x4E86;&#x5B9A;&#x4E49;&#x3002;</p>
<p><strong>syslog()&#x4E2D;priority&#x53C2;&#x6570;&#x7684;level&#x503C;&#xFF08;&#x4E25;&#x91CD;&#x6027;&#x4ECE;&#x6700;&#x9AD8;&#x5230;&#x6700;&#x4F4E;&#xFF09;&#xFF1A;</strong></p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th align="left">&#x503C;</th>
<th align="center">&#x63CF;&#x3000;&#x3000;&#x8FF0;cc</th>
</tr>
</thead>
<tbody><tr>
<td align="left">LOG_EMERG</td>
<td align="center">&#x7D27;&#x6025;&#x6216;&#x4EE4;&#x4EBA;&#x6050;&#x614C;&#x7684;&#x60C5;&#x51B5;&#xFF08;&#x7CFB;&#x7EDF;&#x4E0D;&#x53EF;&#x7528;&#x4E86;&#xFF09;</td>
</tr>
<tr>
<td align="left">LOG_ALERT</td>
<td align="center">&#x9700;&#x8981;&#x7ACB;&#x5373;&#x5904;&#x7406;&#x7684;&#x60C5;&#x51B5;&#xFF08;&#x5982;&#x7834;&#x574F;&#x4E86;&#x7CFB;&#x7EDF;&#x6570;&#x636E;&#x5E93;&#xFF09;</td>
</tr>
<tr>
<td align="left">LOG_CRIT</td>
<td align="center">&#x5173;&#x952E;&#x60C5;&#x51B5;&#xFF08;&#x5982;&#x78C1;&#x76D8;&#x8BBE;&#x5907;&#x53D1;&#x751F;&#x9519;&#x8BEF;&#xFF09;</td>
</tr>
<tr>
<td align="left">LOG_ERR</td>
<td align="center">&#x5E38;&#x89C4;&#x9519;&#x8BEF;&#x60C5;&#x51B5;</td>
</tr>
<tr>
<td align="left">LOG_WARNING</td>
<td align="center">&#x8B66;&#x544A;</td>
</tr>
<tr>
<td align="left">LOG_NOTICE</td>
<td align="center">&#x53EF;&#x80FD;&#x9700;&#x8981;&#x7279;&#x6B8A;&#x5904;&#x7406;&#x7684;&#x666E;&#x901A;&#x60C5;&#x51B5;</td>
</tr>
<tr>
<td align="left">LOG_INFO</td>
<td align="center">&#x60C5;&#x62A5;&#x6027;&#x6D88;&#x606F;</td>
</tr>
<tr>
<td align="left">LOG_DEBUG</td>
<td align="center">&#x8C03;&#x8BD5;&#x6D88;&#x606F;</td>
</tr>
</tbody></table></div>
<p>&#x53E6;&#x4E00;&#x4E2A;&#x4F20;&#x5165;syslog()&#x7684;&#x53C2;&#x6570;&#x662F;&#x4E00;&#x4E2A;&#x683C;&#x5F0F;&#x5B57;&#x7B26;&#x4E32;&#x4EE5;&#x53CA;&#x76F8;&#x5E94;&#x7684;&#x53C2;&#x6570;&#xFF0C;&#x5B83;&#x4EEC;&#x4E0E;&#x4F20;&#x5165;printf()&#x4E2D;&#x7684;&#x53C2;&#x6570;&#x662F;&#x4E00;&#x6837;&#x7684;&#xFF0C;&#x4F46;&#x4E0E;printf()&#x4E0D;&#x540C;&#x7684;&#x662F;&#x8FD9;&#x91CC;&#x7684;&#x683C;&#x5F0F;&#x5B57;&#x7B26;&#x4E32;&#x4E0D;&#x9700;&#x8981;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x6362;&#x884C;&#x5B57;&#x7B26;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x683C;&#x5F0F;&#x5B57;&#x7B26;&#x4E32;&#x8FD8;&#x53EF;&#x4EE5;&#x5305;&#x542B;&#x53CC;&#x5B57;&#x7B26;&#x5E8F;&#x5217;%m&#xFF0C;&#x5728;&#x8C03;&#x7528;&#x7684;&#x65F6;&#x5019;&#x8FD9;&#x4E2A;&#x5E8F;&#x5217;&#x4F1A;&#x88AB;&#x4E0E;&#x5F53;&#x524D;&#x7684;errno&#x503C;&#x5BF9;&#x5E94;&#x7684;&#x9519;&#x8BEF;&#x5B57;&#x7B26;&#x4E32;&#xFF08;&#x5373;&#x7B49;&#x4EF7;&#x4E8E;strerror(errno)&#xFF09;&#x6240;&#x66FF;&#x6362;&#x3002;</p>
<p>&#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x6F14;&#x793A;&#x4E86;openlog()&#x548C;syslog()&#x7684;&#x7528;&#x6CD5;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token function">openlog</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>LOG_PID <span class="token operator">|</span> LOG_CONS <span class="token operator">|</span>  LOG_NOWAIT<span class="token punctuation">,</span> LOG_LOCALO<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">syslog</span><span class="token punctuation">(</span>LOG_ERROR<span class="token punctuation">,</span><span class="token string">&quot;Bad argument: %s&quot;</span><span class="token punctuation">,</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">syslog</span><span class="token punctuation">(</span>LOG_USER <span class="token operator">|</span> LOG_INFO<span class="token punctuation">,</span> <span class="token string">&quot;Exiting&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x7531;&#x4E8E;&#x5728;&#x7B2C;&#x4E00;&#x4E2A;syslog()&#x8C03;&#x7528;&#x4E2D;&#x5E76;&#x6CA1;&#x6709;&#x6307;&#x5B9A;facility&#xFF0C;&#x56E0;&#x6B64;&#x5C06;&#x4F1A;&#x4F7F;&#x7528;openlog()&#x8C03;&#x7528;&#x4E2D;&#x7684;&#x9ED8;&#x8BA4;&#x503C;&#xFF08;LOG_LOCAL0&#xFF09;&#x3002;&#x5728;&#x7B2C;&#x4E8C;&#x4E2A;syslog()&#x8C03;&#x7528;&#x4E2D;&#x663E;&#x5F0F;&#x5730;&#x6307;&#x5B9A;&#x4E86;LOG_USER&#x6807;&#x8BB0;&#x6765;&#x8986;&#x76D6;openlog()&#x8C03;&#x7528;&#x4E2D;&#x8BBE;&#x7F6E;&#x7684;&#x9ED8;&#x8BA4;&#x503C;&#x3002;</p>
<p>&#x5728;shell&#x4E2D;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;logger(1)&#x547D;&#x4EE4;&#x6765;&#x5411;&#x7CFB;&#x7EDF;&#x65E5;&#x5FD7;&#x4E2D;&#x6DFB;&#x52A0;&#x6761;&#x76EE;&#x3002;&#x8FD9;&#x4E2A;&#x547D;&#x4EE4;&#x5141;&#x8BB8;&#x6307;&#x5B9A;&#x4E0E;&#x65E5;&#x5FD7;&#x6D88;&#x606F;&#x76F8;&#x5173;&#x7684;level&#xFF08;priority&#xFF09;&#x548C;ident&#xFF08;tag&#xFF09;&#xFF0C;&#x66F4;&#x591A;&#x7EC6;&#x8282;&#x53EF;&#x53C2;&#x8003;logger(1)&#x624B;&#x518C;&#x3002;SUSv3&#x89C4;&#x5B9A;&#x4E86;logger&#x547D;&#x4EE4;&#xFF08;&#x5E76;&#x6CA1;&#x6709;&#x8FDB;&#x884C;&#x5168;&#x9762;&#x5B9A;&#x4E49;&#xFF09;&#xFF0C;&#x5927;&#x591A;&#x6570;UNIX&#x5B9E;&#x73B0;&#x90FD;&#x5B9E;&#x73B0;&#x4E86;&#x8FD9;&#x4E2A;&#x547D;&#x4EE4;&#x3002;</p>
<p>&#x50CF;&#x4E0B;&#x9762;&#x8FD9;&#x6837;&#x4F7F;&#x7528;syslog()&#x5199;&#x5165;&#x4E00;&#x4E9B;&#x7528;&#x6237;&#x63D0;&#x4F9B;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x662F;&#x9519;&#x8BEF;&#x7684;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token function">syslog</span><span class="token punctuation">(</span>priority<span class="token punctuation">,</span>user_supplied_string<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>&#x4E0A;&#x9762;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x5B58;&#x5728;&#x7684;&#x95EE;&#x9898;&#x662F;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4F1A;&#x9762;&#x4E34;&#x6240;&#x8C13;&#x7684;&#x683C;&#x5F0F;&#x5B57;&#x7B26;&#x4E32;&#x653B;&#x51FB;&#x3002;&#x5982;&#x679C;&#x7528;&#x6237;&#x63D0;&#x4F9B;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x4E2D;&#x5305;&#x542B;&#x683C;&#x5F0F;&#x6307;&#x793A;&#x7B26;&#xFF08;&#x5982;%s&#xFF09;&#xFF0C;&#x90A3;&#x4E48;&#x7ED3;&#x679C;&#x5C06;&#x662F;&#x4E0D;&#x53EF;&#x9884;&#x6D4B;&#x7684;&#xFF0C;&#x4ECE;&#x5B89;&#x5168;&#x7684;&#x89D2;&#x5EA6;&#x6765;&#x8BB2;&#xFF0C;&#x8FD9;&#x79CD;&#x7ED3;&#x679C;&#x53EF;&#x80FD;&#x662F;&#x5177;&#x6709;&#x7834;&#x574F;&#x6027;&#x7684;&#x3002;&#xFF08;&#x8FD9;&#x4E2A;&#x7ED3;&#x8BBA;&#x4E5F;&#x540C;&#x6837;&#x9002;&#x7528;&#x4E8E;&#x4F20;&#x7EDF;&#x7684;printf()&#x51FD;&#x6570;&#x3002;&#xFF09;&#x56E0;&#x6B64;&#x9700;&#x8981;&#x5C06;&#x4E0A;&#x9762;&#x7684;&#x8C03;&#x7528;&#x91CD;&#x5199;&#x4E3A;&#x4E0B;&#x9762;&#x8FD9;&#x6837;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token function">syslog</span><span class="token punctuation">(</span>priority<span class="token punctuation">,</span><span class="token string">&quot;%s&quot;</span><span class="token punctuation">,</span>user_supplied_string<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="&#x5173;&#x95ED;&#x65E5;&#x5FD7;"><a href="#&#x5173;&#x95ED;&#x65E5;&#x5FD7;" class="headerlink" title="&#x5173;&#x95ED;&#x65E5;&#x5FD7;"></a>&#x5173;&#x95ED;&#x65E5;&#x5FD7;</h3><p>&#x5F53;&#x5B8C;&#x6210;&#x65E5;&#x5FD7;&#x8BB0;&#x5F55;&#x4E4B;&#x540E;&#x53EF;&#x4EE5;&#x8C03;&#x7528;closelog()&#x6765;&#x91CA;&#x653E;&#x5206;&#x914D;&#x7ED9;/dev/log socket&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;syslog.h&gt;</span></span>

<span class="token keyword">void</span> <span class="token function">closelog</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x7531;&#x4E8E; daemon &#x901A;&#x5E38;&#x4F1A;&#x6301;&#x7EED;&#x4FDD;&#x6301;&#x4E0E;&#x7CFB;&#x7EDF;&#x65E5;&#x5FD7;&#x4E4B;&#x95F4;&#x7684;&#x8FDE;&#x63A5;&#x7684;&#x6253;&#x5F00;&#x72B6;&#x6001;&#xFF0C;&#x56E0;&#x6B64;&#x901A;&#x5E38;&#x4F1A;&#x7701;&#x7565;&#x5BF9;closelog()&#x7684;&#x8C03;&#x7528;&#x3002;</p>
<h3 id="&#x8FC7;&#x6EE4;&#x65E5;&#x5FD7;&#x6D88;&#x606F;"><a href="#&#x8FC7;&#x6EE4;&#x65E5;&#x5FD7;&#x6D88;&#x606F;" class="headerlink" title="&#x8FC7;&#x6EE4;&#x65E5;&#x5FD7;&#x6D88;&#x606F;"></a>&#x8FC7;&#x6EE4;&#x65E5;&#x5FD7;&#x6D88;&#x606F;</h3><p>setlogmask()&#x51FD;&#x6570;&#x8BBE;&#x7F6E;&#x4E86;&#x4E00;&#x4E2A;&#x80FD;&#x8FC7;&#x6EE4;&#x7531;syslog()&#x5199;&#x5165;&#x7684;&#x6D88;&#x606F;&#x7684;&#x63A9;&#x7801;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;syslog.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">setlogmask</span><span class="token punctuation">(</span><span class="token keyword">int</span> mask_priority<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x6240;&#x6709;level&#x4E0D;&#x5728;&#x5F53;&#x524D;&#x7684;&#x63A9;&#x7801;&#x8BBE;&#x7F6E;&#x4E2D;&#x7684;&#x6D88;&#x606F;&#x90FD;&#x4F1A;&#x88AB;&#x4E22;&#x5F03;&#x3002;&#x9ED8;&#x8BA4;&#x7684;&#x63A9;&#x7801;&#x503C;&#x5141;&#x8BB8;&#x8BB0;&#x5F55;&#x6240;&#x6709;&#x7684;&#x4E25;&#x91CD;&#x6027;&#x7EA7;&#x522B;&#x3002;</p>
<p>&#x5B8F;LOG_MASK()&#xFF08;&#x5728;&lt;syslog.h&gt;&#x4E2D;&#x5B9A;&#x4E49;&#xFF09;&#x4F1A;&#x5C06;level&#x503C;&#x8F6C;&#x6362;&#x6210;&#x9002;&#x5408;&#x4F20;&#x5165;setlogmask()&#x7684;&#x4F4D;&#x503C;&#x3002;&#x5982;&#x8981;&#x4E22;&#x5F03;&#x9664;&#x4F18;&#x5148;&#x7EA7;&#x4E3A;LOG_ERR&#x4EE5;&#x53CA;&#x4EE5;&#x4E0A;&#x4E4B;&#x5916;&#x7684;&#x6D88;&#x606F;&#x65F6;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4E0B;&#x9762;&#x7684;&#x8C03;&#x7528;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token function">setlogmask</span><span class="token punctuation">(</span><span class="token function">LOG_MASK</span><span class="token punctuation">(</span>LOG_EMERG<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token function">LOG_MASK</span><span class="token punctuation">(</span>LOG_ALERT<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token function">LOG_MASK</span><span class="token punctuation">(</span>LOG_CRIT<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token function">LOG_MASK</span><span class="token punctuation">(</span>LOG_ERR<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>SUSv3&#x89C4;&#x5B9A;&#x4E86;LOG_MASK()&#x5B8F;&#x3002;&#x5927;&#x591A;&#x6570;UNIX&#x5B9E;&#x73B0;&#xFF08;&#x5305;&#x62EC;Linux&#xFF09;&#x8FD8;&#x63D0;&#x4F9B;&#x4E86;&#x6807;&#x51C6;&#x4E2D;&#x672A;&#x89C4;&#x5B9A;&#x7684;LOG_UPTO()&#x5B8F;&#x3002;&#x5B83;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x80FD;&#x8FC7;&#x6EE4;&#x7279;&#x5B9A;&#x7EA7;&#x522B;&#x4EE5;&#x53CA;&#x4EE5;&#x4E0A;&#x7684;&#x6240;&#x6709;&#x6D88;&#x606F;&#x7684;&#x4F4D;&#x63A9;&#x7801;&#x3002;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x5B8F;&#x80FD;&#x591F;&#x5C06;&#x524D;&#x9762;&#x7684;setlogmask()&#x8C03;&#x7528;&#x7B80;&#x5316;&#x6210;&#x4E0B;&#x9762;&#x8FD9;&#x4E2A;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token function">setlogmask</span><span class="token punctuation">(</span><span class="token function">LOG_UPTO</span><span class="token punctuation">(</span>LOG_ERR<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="etc-syslog-conf&#x6587;&#x4EF6;"><a href="#etc-syslog-conf&#x6587;&#x4EF6;" class="headerlink" title="/etc/syslog.conf&#x6587;&#x4EF6;"></a>/etc/syslog.conf&#x6587;&#x4EF6;</h3><p>/etc/syslog.conf&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x63A7;&#x5236;syslogd daemon&#x7684;&#x64CD;&#x4F5C;&#x3002;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x7531;&#x89C4;&#x5219;&#x548C;&#x6CE8;&#x91CA;&#xFF08;&#x4EE5;#&#x5B57;&#x7B26;&#x6253;&#x5934;&#xFF09;&#x6784;&#x6210;&#x3002;&#x89C4;&#x5219;&#x7684;&#x5F62;&#x5F0F;&#x5982;&#x4E0B;&#x6240;&#x793A;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">facility.level    action<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>facility&#x548C;level&#x7EC4;&#x5408;&#x5728;&#x4E00;&#x8D77;&#x88AB;&#x79F0;&#x4E3A;&#x9009;&#x62E9;&#x5668;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x4EEC;&#x9009;&#x62E9;&#x4E86;&#x9700;&#x5E94;&#x7528;&#x89C4;&#x5219;&#x7684;&#x6D88;&#x606F;&#x3002;action&#x6307;&#x5B9A;&#x4E86;&#x4E0E;&#x9009;&#x62E9;&#x5668;&#x5339;&#x914D;&#x7684;&#x6D88;&#x606F;&#x88AB;&#x53D1;&#x9001;&#x5230;&#x4F55;&#x5904;&#x3002;&#x9009;&#x62E9;&#x5668;&#x548C;action&#x4E4B;&#x95F4;&#x7528;&#x7A7A;&#x767D;&#x5B57;&#x7B26;&#x9694;&#x5F00;&#xFF0C;&#x4E0B;&#x9762;&#x662F;&#x4E00;&#x4E9B;&#x793A;&#x4F8B;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token operator">*</span><span class="token punctuation">.</span>err                         <span class="token operator">/</span>dev<span class="token operator">/</span>tty10
auth<span class="token punctuation">.</span>notice                   root
<span class="token operator">*</span><span class="token punctuation">.</span>debug<span class="token punctuation">;</span>mail<span class="token punctuation">.</span>none<span class="token punctuation">;</span>news<span class="token punctuation">.</span>none   <span class="token operator">-</span><span class="token operator">/</span>var<span class="token operator">/</span>log<span class="token operator">/</span>messages<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x7B2C;&#x4E00;&#x6761;&#x89C4;&#x5219;&#x8868;&#x793A;&#x6765;&#x81EA;&#x6240;&#x6709;&#x5DE5;&#x5177;&#xFF08;*&#xFF09;&#x7684;level&#x4E3A;err&#xFF08;(LOG_ERR&#xFF09;&#x6216;&#x66F4;&#x9AD8;&#x7684;&#x6D88;&#x606F;&#x5E94;&#x8BE5;&#x88AB;&#x53D1;&#x9001;&#x5230;/dev/tty10&#x63A7;&#x5236;&#x53F0;&#x8BBE;&#x5907;&#x4E0A;&#x3002;&#x7B2C;&#x4E8C;&#x6761;&#x89C4;&#x5219;&#x8868;&#x793A;&#x6765;&#x81EA;&#x9A8C;&#x8BC1;&#x5DE5;&#x5177;&#xFF08;LOG_AUTH&#xFF09;&#x7684;level&#x4E3A;notice&#xFF08;LOG_NOTICE&#xFF09;&#x6216;&#x66F4;&#x9AD8;&#x7684;&#x6D88;&#x606F;&#x5E94;&#x8BE5;&#x88AB;&#x53D1;&#x9001;&#x5230;root&#x767B;&#x5F55;&#x7684;&#x6240;&#x6709;&#x63A7;&#x5236;&#x53F0;&#x548C;&#x7EC8;&#x7AEF;&#x3002;&#x5982;&#x8FD9;&#x4E2A;&#x7279;&#x522B;&#x7684;&#x89C4;&#x5219;&#x5141;&#x8BB8;&#x4E00;&#x4E2A;&#x767B;&#x5F55;&#x7684;root&#x7528;&#x6237;&#x7ACB;&#x5373;&#x770B;&#x5230;&#x5931;&#x8D25;&#x7684;su&#x5C1D;&#x8BD5;&#x3002;</p>
<p>&#x6700;&#x540E;&#x4E00;&#x6761;&#x89C4;&#x5219;&#x6F14;&#x793A;&#x4E86;&#x89C4;&#x5219;&#x8BED;&#x6CD5;&#x4E2D;&#x7684;&#x51E0;&#x4E2A;&#x9AD8;&#x7EA7;&#x7279;&#x6027;&#x3002;&#x4E00;&#x4E2A;&#x89C4;&#x5219;&#x53EF;&#x4EE5;&#x5305;&#x542B;&#x591A;&#x4E2A;&#x9009;&#x62E9;&#x5668;&#xFF0C;&#x9009;&#x62E9;&#x5668;&#x4E4B;&#x95F4;&#x7528;&#x5206;&#x53F7;&#x9694;&#x5F00;&#x3002;&#x7B2C;&#x4E00;&#x4E2A;&#x9009;&#x62E9;&#x5668;&#x6307;&#x5B9A;&#x4E86;&#x6240;&#x6709;&#x7684;&#x6D88;&#x606F;&#xFF0C;&#x5B83;&#x4F7F;&#x7528;<em>&#x901A;&#x914D;&#x7B26;&#x8868;&#x793A;facility&#x5E76;&#x5C06;level&#x7684;&#x503C;&#x6307;&#x5B9A;&#x4E3A;debug&#xFF0C;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x6240;&#x6709;&#x7EA7;&#x522B;&#x4E3A;debug&#xFF08;&#x6700;&#x4F4E;&#x7684;&#x7EA7;&#x522B;&#xFF09;&#x4EE5;&#x53CA;&#x66F4;&#x9AD8;&#x7684;&#x6D88;&#x606F;&#x90FD;&#x4F1A;&#x88AB;&#x8BB0;&#x5F55;&#x4E0B;&#x6765;&#x3002;&#xFF08;&#x5728;Linux&#x4EE5;&#x53CA;&#x5176;&#x4ED6;&#x4E00;&#x4E9B;UNIX&#x5B9E;&#x73B0;&#x4E2D;&#xFF0C;&#x53EF;&#x4EE5;&#x5C06;level&#x6307;&#x5B9A;&#x4E3A;</em>&#xFF0C;&#x5176;&#x542B;&#x4E49;&#x4E0E;debug&#x662F;&#x4E00;&#x6837;&#x7684;&#x3002;&#x4F46;&#x4E0D;&#x662F;&#x6240;&#x6709;&#x7684;syslog&#x5B9E;&#x73B0;&#x90FD;&#x652F;&#x6301;&#x8FD9;&#x4E2A;&#x7279;&#x6027;&#x3002;&#xFF09;&#x901A;&#x5E38;&#xFF0C;&#x4E00;&#x4E2A;&#x5305;&#x542B;&#x591A;&#x4E2A;&#x9009;&#x62E9;&#x5668;&#x7684;&#x89C4;&#x5219;&#x4F1A;&#x5339;&#x914D;&#x4E0E;&#x5176;&#x4E2D;&#x4EFB;&#x610F;&#x4E00;&#x4E2A;&#x9009;&#x62E9;&#x5668;&#x5BF9;&#x5E94;&#x7684;&#x6D88;&#x606F;&#xFF0C;&#x4F46;&#x5F53;&#x5C06;level&#x8BBE;&#x7F6E;&#x4E3A;none&#x65F6;&#x5219;&#x8868;&#x793A;&#x6392;&#x9664;&#x6240;&#x6709;&#x5C5E;&#x4E8E;&#x76F8;&#x5E94;&#x7684;facility&#x7684;&#x6D88;&#x606F;&#x3002;&#x56E0;&#x6B64;&#x8FD9;&#x6761;&#x89C4;&#x5219;&#x5C06;&#x9664;&#x6765;&#x81EA;mail&#x548C;news&#x5DE5;&#x5177;&#x7684;&#x6D88;&#x606F;&#x4E4B;&#x5916;&#x7684;&#x6240;&#x6709;&#x6D88;&#x606F;&#x53D1;&#x9001;&#x5230;/var/log/messages&#x6587;&#x4EF6;&#x4E2D;&#x3002;&#x6587;&#x4EF6;&#x540D;&#x524D;&#x9762;&#x7684;&#x8FDE;&#x63A5;&#x7B26;&#xFF08;-&#xFF09;&#x8868;&#x793A;&#x65E0;&#x9700;&#x6BCF;&#x6B21;&#x5199;&#x5165;&#x6587;&#x4EF6;&#x65F6;&#x90FD;&#x5C06;&#x6587;&#x4EF6;&#x540C;&#x6B65;&#x5230;&#x78C1;&#x76D8;&#xFF08;&#x53C2;&#x89C1;13.3&#x8282;&#xFF09;&#x3002;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x5199;&#x5165;&#x64CD;&#x4F5C;&#x5C06;&#x53D8;&#x5F97;&#x66F4;&#x5FEB;&#xFF0C;&#x4F46;&#x5982;&#x679C;&#x7CFB;&#x7EDF;&#x5728;&#x5199;&#x5165;&#x4E4B;&#x540E;&#x5D29;&#x6E83;&#x7684;&#x8BDD;&#x53EF;&#x80FD;&#x4F1A;&#x4E22;&#x5931;&#x4E00;&#x4E9B;&#x6570;&#x636E;&#x3002;</p>
<p>&#x6BCF;&#x6B21;&#x4FEE;&#x6539;syslog.conf&#x6587;&#x4EF6;&#x4E4B;&#x540E;&#x90FD;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x4E0B;&#x9762;&#x7684;&#x65B9;&#x5F0F;&#x8BA9;daemon&#x6839;&#x636E;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x91CD;&#x65B0;&#x521D;&#x59CB;&#x5316;&#x81EA;&#x8EAB;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">killall</span> -HUP syslogd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>syslog.conf&#x89C4;&#x5219;&#x8BED;&#x6CD5;&#x7684;&#x9AD8;&#x7EA7;&#x7279;&#x6027;&#x5141;&#x8BB8;&#x7F16;&#x5199;&#x6BD4;&#x524D;&#x9762;&#x4ECB;&#x7ECD;&#x7684;&#x66F4;&#x52A0;&#x5F3A;&#x5927;&#x7684;&#x89C4;&#x5219;&#xFF0C;&#x66F4;&#x591A;&#x7EC6;&#x8282;&#x53EF;&#x53C2;&#x8003;syslog.conf(5)&#x624B;&#x518C;&#x3002;</p>
<h1 id="&#x7F16;&#x5199;&#x5B89;&#x5168;&#x7684;&#x7279;&#x6743;&#x7A0B;&#x5E8F;"><a href="#&#x7F16;&#x5199;&#x5B89;&#x5168;&#x7684;&#x7279;&#x6743;&#x7A0B;&#x5E8F;" class="headerlink" title="&#x7F16;&#x5199;&#x5B89;&#x5168;&#x7684;&#x7279;&#x6743;&#x7A0B;&#x5E8F;"></a>&#x7F16;&#x5199;&#x5B89;&#x5168;&#x7684;&#x7279;&#x6743;&#x7A0B;&#x5E8F;</h1><p>&#x7279;&#x6743;&#x7A0B;&#x5E8F;&#x80FD;&#x591F;&#x8BBF;&#x95EE;&#x666E;&#x901A;&#x7528;&#x6237;&#x65E0;&#x6CD5;&#x8BBF;&#x95EE;&#x7684;&#x7279;&#x6027;&#x548C;&#x8D44;&#x6E90;&#xFF08;&#x6587;&#x4EF6;&#x8BBE;&#x5907;&#x7B49;&#xFF09;&#x3002;&#x4E00;&#x4E2A;&#x7A0B;&#x5E8F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4E0B;&#x9762;&#x4E24;&#x79CD;&#x65B9;&#x5F0F;&#x4EE5;&#x7279;&#x6743;&#x65B9;&#x5F0F;&#x8FD0;&#x884C;&#x3002;</p>
<ul>
<li>&#x7A0B;&#x5E8F;&#x5728;&#x4E00;&#x4E2A;&#x7279;&#x6743;&#x7528;&#x6237;ID&#x4E0B;&#x542F;&#x52A8;&#xFF0C;&#x5F88;&#x591A;daemon&#x548C;&#x7F51;&#x7EDC;&#x670D;&#x52A1;&#x5668;&#x901A;&#x5E38;&#x4EE5;root&#x8EAB;&#x4EFD;&#x8FD0;&#x884C;&#xFF0C;&#x5B83;&#x4EEC;&#x5C31;&#x5C5E;&#x4E8E;&#x8FD9;&#x79CD;&#x7C7B;&#x522B;&#x3002;</li>
<li>&#x7A0B;&#x5E8F;&#x8BBE;&#x7F6E;&#x4E86;set-user-ID&#x6216;set-group-ID&#x6743;&#x9650;&#x4F4D;&#x3002;&#x5F53;&#x4E00;&#x4E2A;set-user-ID&#xFF08;set-group-ID&#xFF09;&#x7A0B;&#x5E8F;&#x88AB;&#x6267;&#x884C;&#x4E4B;&#x540E;&#xFF0C;&#x5B83;&#x4F1A;&#x5C06;&#x8FDB;&#x7A0B;&#x7684;&#x6709;&#x6548;&#x7528;&#x6237;&#xFF08;&#x7EC4;&#xFF09;ID&#x4FEE;&#x6539;&#x4E3A;&#x4E0E;&#x7A0B;&#x5E8F;&#x6587;&#x4EF6;&#x7684;&#x6240;&#x6709;&#x8005;&#xFF08;&#x7EC4;&#xFF09;&#x4E00;&#x6837;&#x7684;ID&#x3002;&#xFF08;&#x5728;9.3&#x8282;&#x4E2D;&#x9996;&#x6B21;&#x5BF9;set-user-ID&#x548C;set-group-ID&#x7A0B;&#x5E8F;&#x8FDB;&#x884C;&#x4E86;&#x4ECB;&#x7ECD;&#x3002;&#xFF09;&#x5728;&#x672C;&#x7AE0;&#x4E2D;&#x6709;&#x65F6;&#x5019;&#x4F1A;&#x4F7F;&#x7528;&#x672F;&#x8BED;set-user-ID-root&#x533A;&#x5206;&#x5C06;&#x8D85;&#x7EA7;&#x7528;&#x6237;&#x6743;&#x9650;&#x8D4B;&#x7ED9;&#x8FDB;&#x7A0B;&#x7684;set-user-ID&#x7A0B;&#x5E8F;&#x4E0E;&#x8D4B;&#x7ED9;&#x8FDB;&#x7A0B;&#x53E6;&#x4E00;&#x4E2A;&#x6709;&#x6548;&#x8EAB;&#x4EFD;&#x7684;&#x7A0B;&#x5E8F;&#x3002;</li>
</ul>
<p>&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x7279;&#x6743;&#x7A0B;&#x5E8F;&#x5305;&#x542B;bug&#x6216;&#x53EF;&#x4EE5;&#x88AB;&#x6076;&#x610F;&#x7528;&#x6237;&#x7834;&#x574F;&#xFF0C;&#x90A3;&#x4E48;&#x7CFB;&#x7EDF;&#x6216;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x5B89;&#x5168;&#x6027;&#x5C31;&#x4F1A;&#x53D7;&#x5230;&#x5F71;&#x54CD;&#x3002;&#x4ECE;&#x5B89;&#x5168;&#x7684;&#x89D2;&#x5EA6;&#x6765;&#x8BB2;&#xFF0C;&#x5728;&#x7F16;&#x5199;&#x7A0B;&#x5E8F;&#x7684;&#x65F6;&#x5019;&#x5E94;&#x8BE5;&#x5C06;&#x7CFB;&#x7EDF;&#x53D7;&#x5230;&#x5B89;&#x5168;&#x5A01;&#x80C1;&#x7684;&#x53EF;&#x80FD;&#x6027;&#x4EE5;&#x53CA;&#x53D7;&#x5230;&#x5B89;&#x5168;&#x5A01;&#x80C1;&#x65F6;&#x4EA7;&#x751F;&#x7684;&#x635F;&#x5931;&#x964D;&#x5230;&#x6700;&#x5C0F;&#x3002;</p>
<h2 id="&#x662F;&#x5426;&#x9700;&#x8981;&#x4E00;&#x4E2A;Set-User-ID&#x6216;Set-Group-ID&#x7A0B;&#x5E8F;"><a href="#&#x662F;&#x5426;&#x9700;&#x8981;&#x4E00;&#x4E2A;Set-User-ID&#x6216;Set-Group-ID&#x7A0B;&#x5E8F;" class="headerlink" title="&#x662F;&#x5426;&#x9700;&#x8981;&#x4E00;&#x4E2A;Set-User-ID&#x6216;Set-Group-ID&#x7A0B;&#x5E8F;"></a>&#x662F;&#x5426;&#x9700;&#x8981;&#x4E00;&#x4E2A;Set-User-ID&#x6216;Set-Group-ID&#x7A0B;&#x5E8F;</h2><p>&#x6709;&#x5173;&#x7F16;&#x5199;set-user-ID&#x548C;set-group-ID&#x7A0B;&#x5E8F;&#x7684;&#x6700;&#x4F73;&#x5EFA;&#x8BAE;&#x4E2D;&#x7684;&#x4E00;&#x6761;&#x5C31;&#x662F;&#x5C3D;&#x91CF;&#x907F;&#x514D;&#x7F16;&#x5199;&#x8FD9;&#x79CD;&#x7A0B;&#x5E8F;&#x3002;&#x5728;&#x6267;&#x884C;&#x4E00;&#x4E2A;&#x4EFB;&#x52A1;&#x65F6;&#x5982;&#x679C;&#x5B58;&#x5728;&#x65E0;&#x9700;&#x8D4B;&#x7ED9;&#x7A0B;&#x5E8F;&#x6743;&#x9650;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x90A3;&#x4E48;&#x4E00;&#x822C;&#x6765;&#x8BB2;&#x5E94;&#x8BE5;&#x91C7;&#x7528;&#x8FD9;&#x79CD;&#x65B9;&#x6CD5;&#xFF0C;&#x56E0;&#x4E3A;&#x8FD9;&#x6837;&#x5C31;&#x6D88;&#x9664;&#x4E86;&#x53D1;&#x751F;&#x5B89;&#x5168;&#x6027;&#x95EE;&#x9898;&#x7684;&#x53EF;&#x80FD;&#x3002;</p>
<p>&#x6709;&#x65F6;&#x5019;&#x53EF;&#x4EE5;&#x5C06;&#x9700;&#x8981;&#x6743;&#x9650;&#x624D;&#x80FD;&#x5B8C;&#x6210;&#x7684;&#x529F;&#x80FD;&#x62C6;&#x5206;&#x5230;&#x4E00;&#x4E2A;&#x53EA;&#x6267;&#x884C;&#x5355;&#x4E2A;&#x4EFB;&#x52A1;&#x7684;&#x7A0B;&#x5E8F;&#x4E2D;&#xFF0C;&#x7136;&#x540E;&#x5728;&#x9700;&#x8981;&#x7684;&#x65F6;&#x5019;&#x5728;&#x5B50;&#x8FDB;&#x7A0B;&#x4E2D;&#x6267;&#x884C;&#x8FD9;&#x4E2A;&#x7A0B;&#x5E8F;&#x3002;&#x5BF9;&#x4E8E;&#x5E93;&#x6765;&#x8BB2;&#xFF0C;&#x8FD9;&#x9879;&#x6280;&#x672F;&#x662F;&#x7279;&#x522B;&#x6709;&#x7528;&#x7684;&#x3002;</p>
<p>TODO.</p>
<h1 id="&#x80FD;&#x529B;"><a href="#&#x80FD;&#x529B;" class="headerlink" title="&#x80FD;&#x529B;"></a>&#x80FD;&#x529B;</h1><p>TODO.</p>
<h1 id="&#x767B;&#x5F55;&#x8BB0;&#x8D26;"><a href="#&#x767B;&#x5F55;&#x8BB0;&#x8D26;" class="headerlink" title="&#x767B;&#x5F55;&#x8BB0;&#x8D26;"></a>&#x767B;&#x5F55;&#x8BB0;&#x8D26;</h1><p>TODO.</p>
<h1 id="&#x5171;&#x4EAB;&#x5E93;&#x57FA;&#x7840;"><a href="#&#x5171;&#x4EAB;&#x5E93;&#x57FA;&#x7840;" class="headerlink" title="&#x5171;&#x4EAB;&#x5E93;&#x57FA;&#x7840;"></a>&#x5171;&#x4EAB;&#x5E93;&#x57FA;&#x7840;</h1><p>&#x5171;&#x4EAB;&#x5E93;&#x662F;&#x4E00;&#x79CD;&#x5C06;&#x5E93;&#x51FD;&#x6570;&#x6253;&#x5305;&#x6210;&#x4E00;&#x4E2A;&#x5355;&#x5143;&#x4F7F;&#x4E4B;&#x80FD;&#x591F;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x88AB;&#x591A;&#x4E2A;&#x8FDB;&#x7A0B;&#x5171;&#x4EAB;&#x7684;&#x6280;&#x672F;&#x3002;&#x8FD9;&#x79CD;&#x6280;&#x672F;&#x80FD;&#x591F;&#x8282;&#x7701;&#x78C1;&#x76D8;&#x7A7A;&#x95F4;&#x548C;RAM&#x3002;</p>
<h2 id="&#x76EE;&#x6807;&#x5E93;"><a href="#&#x76EE;&#x6807;&#x5E93;" class="headerlink" title="&#x76EE;&#x6807;&#x5E93;"></a>&#x76EE;&#x6807;&#x5E93;</h2><p>&#x6784;&#x5EFA;&#x7A0B;&#x5E8F;&#x7684;&#x4E00;&#x79CD;&#x65B9;&#x5F0F;&#x662F;&#x7B80;&#x5355;&#x5730;&#x5C06;&#x6BCF;&#x4E00;&#x4E2A;&#x6E90;&#x6587;&#x4EF6;&#x7F16;&#x8BD1;&#x6210;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x8FD9;&#x4E9B;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x94FE;&#x63A5;&#x5728;&#x4E00;&#x8D77;&#x7EC4;&#x6210;&#x4E00;&#x4E2A;&#x53EF;&#x6267;&#x884C;&#x7A0B;&#x5E8F;&#xFF0C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ cc -g -c prog.c mod1.c mod2.c mod3.c
$ cc -g -o prog_nolib prog.o mod1.o mod2.o mod3.o<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x94FE;&#x63A5;&#x5B9E;&#x9645;&#x4E0A;&#x662F;&#x7531;&#x4E00;&#x4E2A;&#x5355;&#x72EC;&#x7684;&#x94FE;&#x63A5;&#x5668;&#x7A0B;&#x5E8F;ld&#x6765;&#x5B8C;&#x6210;&#x7684;&#x3002;&#x5F53;&#x4F7F;&#x7528;cc&#xFF08;&#x6216;gcc&#xFF09;&#x547D;&#x4EE4;&#x94FE;&#x63A5;&#x4E00;&#x4E2A;&#x7A0B;&#x5E8F;&#x65F6;&#xFF0C;&#x7F16;&#x8BD1;&#x5668;&#x4F1A;&#x5728;&#x5E55;&#x540E;&#x8C03;&#x7528;ld&#x3002;&#x5728;Linux&#x4E0A;&#x5E94;&#x8BE5;&#x603B;&#x662F;&#x901A;&#x8FC7;gcc&#x95F4;&#x63A5;&#x5730;&#x8C03;&#x7528;&#x94FE;&#x63A5;&#x5668;&#xFF0C;&#x56E0;&#x4E3A;gcc&#x80FD;&#x591F;&#x786E;&#x4FDD;&#x4F7F;&#x7528;&#x6B63;&#x786E;&#x7684;&#x9009;&#x9879;&#x6765;&#x8C03;&#x7528;ld&#x5E76;&#x5C06;&#x7A0B;&#x5E8F;&#x4E0E;&#x6B63;&#x786E;&#x7684;&#x5E93;&#x6587;&#x4EF6;&#x94FE;&#x63A5;&#x8D77;&#x6765;&#x3002;</p>
<p>&#x5728;&#x5F88;&#x591A;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x6E90;&#x4EE3;&#x7801;&#x6587;&#x4EF6;&#x4E5F;&#x53EF;&#x4EE5;&#x88AB;&#x591A;&#x4E2A;&#x7A0B;&#x5E8F;&#x5171;&#x4EAB;&#x3002;&#x56E0;&#x6B64;&#x8981;&#x964D;&#x4F4E;&#x5DE5;&#x4F5C;&#x91CF;&#x7684;&#x7B2C;&#x4E00;&#x6B65;&#x5C31;&#x662F;&#x5C06;&#x8FD9;&#x4E9B;&#x6E90;&#x4EE3;&#x7801;&#x6587;&#x4EF6;&#x53EA;&#x7F16;&#x8BD1;&#x4E00;&#x6B21;&#xFF0C;&#x7136;&#x540E;&#x5728;&#x9700;&#x8981;&#x7684;&#x65F6;&#x5019;&#x5C06;&#x5B83;&#x4EEC;&#x94FE;&#x63A5;&#x8FDB;&#x4E0D;&#x540C;&#x7684;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x4E2D;&#x3002;&#x867D;&#x7136;&#x8FD9;&#x9879;&#x6280;&#x672F;&#x80FD;&#x591F;&#x8282;&#x7701;&#x7F16;&#x8BD1;&#x65F6;&#x95F4;&#xFF0C;&#x4F46;&#x5176;&#x7F3A;&#x70B9;&#x662F;&#x5728;&#x94FE;&#x63A5;&#x7684;&#x65F6;&#x5019;&#x4ECD;&#x7136;&#x9700;&#x8981;&#x4E3A;&#x6240;&#x6709;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x547D;&#x540D;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x5927;&#x91CF;&#x7684;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x4F1A;&#x6563;&#x843D;&#x5728;&#x7CFB;&#x7EDF;&#x4E0A;&#x7684;&#x5404;&#x4E2A;&#x76EE;&#x5F55;&#x4E2D;&#xFF0C;&#x4ECE;&#x800C;&#x9020;&#x6210;&#x76EE;&#x5F55;&#x4E2D;&#x5185;&#x5BB9;&#x7684;&#x6DF7;&#x4E71;&#x3002;</p>
<p>&#x4E3A;&#x89E3;&#x51B3;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x53EF;&#x4EE5;&#x5C06;&#x4E00;&#x7EC4;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x7EC4;&#x7EC7;&#x6210;&#x4E00;&#x4E2A;&#x88AB;&#x79F0;&#x4E3A;&#x5BF9;&#x8C61;&#x5E93;&#x7684;&#x5355;&#x5143;&#x3002;&#x5BF9;&#x8C61;&#x5E93;&#x5206;&#x4E3A;&#x4E24;&#x79CD;&#xFF1A;&#x9759;&#x6001;&#x7684;&#x548C;&#x5171;&#x4EAB;&#x7684;&#x3002;&#x5171;&#x4EAB;&#x5E93;&#x662F;&#x4E00;&#x79CD;&#x66F4;&#x52A0;&#x73B0;&#x4EE3;&#x5316;&#x7684;&#x5BF9;&#x8C61;&#x5E93;&#xFF0C;&#x5B83;&#x6BD4;&#x9759;&#x6001;&#x5E93;&#x66F4;&#x5177;&#x4F18;&#x52BF;.</p>
<h3 id="&#x9898;&#x5916;&#x8BDD;&#xFF1A;&#x5728;&#x7F16;&#x8BD1;&#x7A0B;&#x5E8F;&#x65F6;&#x5305;&#x542B;&#x8C03;&#x8BD5;&#x5668;&#x4FE1;&#x606F;"><a href="#&#x9898;&#x5916;&#x8BDD;&#xFF1A;&#x5728;&#x7F16;&#x8BD1;&#x7A0B;&#x5E8F;&#x65F6;&#x5305;&#x542B;&#x8C03;&#x8BD5;&#x5668;&#x4FE1;&#x606F;" class="headerlink" title="&#x9898;&#x5916;&#x8BDD;&#xFF1A;&#x5728;&#x7F16;&#x8BD1;&#x7A0B;&#x5E8F;&#x65F6;&#x5305;&#x542B;&#x8C03;&#x8BD5;&#x5668;&#x4FE1;&#x606F;"></a>&#x9898;&#x5916;&#x8BDD;&#xFF1A;&#x5728;&#x7F16;&#x8BD1;&#x7A0B;&#x5E8F;&#x65F6;&#x5305;&#x542B;&#x8C03;&#x8BD5;&#x5668;&#x4FE1;&#x606F;</h3><p>&#x5728;&#x4E0A;&#x9762;&#x7684;cc&#x547D;&#x4EE4;&#x4E2D;&#x4F7F;&#x7528;&#x4E86;-g&#x9009;&#x9879;&#x4EE5;&#x5728;&#x7F16;&#x8BD1;&#x8FC7;&#x7684;&#x7A0B;&#x5E8F;&#x4E2D;&#x5305;&#x542B;&#x8C03;&#x8BD5;&#x4FE1;&#x606F;&#x3002;&#x4E00;&#x822C;&#x6765;&#x8BB2;&#xFF0C;&#x521B;&#x5EFA;&#x5141;&#x8BB8;&#x8C03;&#x8BD5;&#x7684;&#x7A0B;&#x5E8F;&#x548C;&#x5E93;&#x662F;&#x4E00;&#x79CD;&#x6BD4;&#x8F83;&#x597D;&#x7684;&#x505A;&#x6CD5;&#x3002;&#xFF08;&#x5728;&#x65E9;&#x671F;&#xFF0C;&#x6709;&#x65F6;&#x5019;&#x4F1A;&#x5FFD;&#x7565;&#x8C03;&#x8BD5;&#x4FE1;&#x606F;&#xFF0C;&#x8FD9;&#x6837;&#x4EA7;&#x751F;&#x7684;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x4F1A;&#x5360;&#x7528;&#x66F4;&#x5C11;&#x7684;&#x78C1;&#x76D8;&#x548C;RAM&#xFF0C;&#x4F46;&#x73B0;&#x5728;&#x78C1;&#x76D8;&#x548C;RAM&#x5DF2;&#x7ECF;&#x975E;&#x5E38;&#x4FBF;&#x5B9C;&#x4E86;&#x3002;&#xFF09;</p>
<p>&#x6B64;&#x5916;&#xFF0C;&#x5728;&#x4E00;&#x4E9B;&#x67B6;&#x6784;&#x4E0A;&#xFF0C;&#x5982;x86-32&#xFF0C;&#x4E0D;&#x5E94;&#x8BE5;&#x6307;&#x5B9A;&#x2013;fomit&#x2013;frame&#x2013;pointer&#x9009;&#x9879;&#xFF0C;&#x56E0;&#x4E3A;&#x8FD9;&#x4F1A;&#x4F7F;&#x5F97;&#x65E0;&#x6CD5;&#x8C03;&#x8BD5;&#x3002;&#xFF08;&#x5728;&#x4E00;&#x4E9B;&#x67B6;&#x6784;&#x4E0A;&#xFF0C;&#x5982;x86-64&#xFF0C;&#x8FD9;&#x4E2A;&#x9009;&#x9879;&#x662F;&#x9ED8;&#x8BA4;&#x542F;&#x7528;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x4E0D;&#x4F1A;&#x9632;&#x6B62;&#x8C03;&#x8BD5;&#x3002;&#xFF09;&#x51FA;&#x4E8E;&#x540C;&#x6837;&#x7684;&#x539F;&#x56E0;&#xFF0C;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x548C;&#x5E93;&#x4E0D;&#x5E94;&#x8BE5;&#x4F7F;&#x7528;strip(1)&#x5220;&#x9664;&#x8C03;&#x8BD5;&#x4FE1;&#x606F;&#x3002;</p>
<h2 id="&#x9759;&#x6001;&#x5E93;"><a href="#&#x9759;&#x6001;&#x5E93;" class="headerlink" title="&#x9759;&#x6001;&#x5E93;"></a>&#x9759;&#x6001;&#x5E93;</h2><p>&#x5728;&#x5F00;&#x59CB;&#x8BA8;&#x8BBA;&#x5171;&#x4EAB;&#x5E93;&#x4E4B;&#x524D;&#x9996;&#x5148;&#x5BF9;&#x9759;&#x6001;&#x5E93;&#x4F5C;&#x4E00;&#x4E2A;&#x7B80;&#x77ED;&#x7684;&#x4ECB;&#x7ECD;&#xFF0C;&#x8FD9;&#x6837;&#x8BFB;&#x8005;&#x5C31;&#x80FD;&#x591F;&#x5F04;&#x6E05;&#x695A;&#x5171;&#x4EAB;&#x5E93;&#x4E0E;&#x9759;&#x6001;&#x5E93;&#x4E4B;&#x95F4;&#x7684;&#x5DEE;&#x522B;&#x4EE5;&#x53CA;&#x5171;&#x4EAB;&#x5E93;&#x6240;&#x5177;&#x5907;&#x7684;&#x4F18;&#x52BF;&#x4E86;&#x3002;</p>
<p>&#x9759;&#x6001;&#x5E93;&#x4E5F;&#x88AB;&#x79F0;&#x4E3A;&#x5F52;&#x6863;&#x6587;&#x4EF6;&#xFF0C;&#x5B83;&#x662F;UNIX&#x7CFB;&#x7EDF;&#x63D0;&#x4F9B;&#x7684;&#x7B2C;&#x4E00;&#x79CD;&#x5E93;&#x3002;&#x9759;&#x6001;&#x5E93;&#x80FD;&#x5E26;&#x6765;&#x4E0B;&#x5217;&#x597D;&#x5904;&#x3002;</p>
<ul>
<li>&#x53EF;&#x4EE5;&#x5C06;&#x4E00;&#x7EC4;&#x7ECF;&#x5E38;&#x88AB;&#x7528;&#x5230;&#x7684;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x7EC4;&#x7EC7;&#x8FDB;&#x5355;&#x4E2A;&#x5E93;&#x6587;&#x4EF6;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5B83;&#x6765;&#x6784;&#x5EFA;&#x591A;&#x4E2A;&#x53EF;&#x6267;&#x884C;&#x7A0B;&#x5E8F;&#x5E76;&#x4E14;&#x5728;&#x6784;&#x5EFA;&#x5404;&#x4E2A;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x65F6;&#x5019;&#x65E0;&#x9700;&#x91CD;&#x65B0;&#x7F16;&#x8BD1;&#x539F;&#x6765;&#x7684;&#x6E90;&#x4EE3;&#x7801;&#x6587;&#x4EF6;&#x3002;</li>
<li>&#x94FE;&#x63A5;&#x547D;&#x4EE4;&#x53D8;&#x5F97;&#x66F4;&#x52A0;&#x7B80;&#x5355;&#x4E86;&#x3002;&#x5728;&#x94FE;&#x63A5;&#x547D;&#x4EE4;&#x884C;&#x4E2D;&#x53EA;&#x9700;&#x8981;&#x6307;&#x5B9A;&#x9759;&#x6001;&#x5E93;&#x7684;&#x540D;&#x79F0;&#x5373;&#x53EF;&#xFF0C;&#x800C;&#x65E0;&#x9700;&#x4E00;&#x4E2A;&#x4E2A;&#x5730;&#x5217;&#x51FA;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x4E86;&#x3002;&#x94FE;&#x63A5;&#x5668;&#x77E5;&#x9053;&#x5982;&#x4F55;&#x641C;&#x7D20;&#x9759;&#x6001;&#x5E93;&#x5E76;&#x5C06;&#x53EF;&#x6267;&#x884C;&#x7A0B;&#x5E8F;&#x9700;&#x8981;&#x7684;&#x5BF9;&#x8C61;&#x62BD;&#x53D6;&#x51FA;&#x6765;&#x3002;</li>
</ul>
<h3 id="&#x521B;&#x5EFA;&#x548C;&#x7EF4;&#x62A4;&#x9759;&#x6001;&#x5E93;"><a href="#&#x521B;&#x5EFA;&#x548C;&#x7EF4;&#x62A4;&#x9759;&#x6001;&#x5E93;" class="headerlink" title="&#x521B;&#x5EFA;&#x548C;&#x7EF4;&#x62A4;&#x9759;&#x6001;&#x5E93;"></a>&#x521B;&#x5EFA;&#x548C;&#x7EF4;&#x62A4;&#x9759;&#x6001;&#x5E93;</h3><p>&#x4ECE;&#x7ED3;&#x679C;&#x4E0A;&#x6765;&#x770B;&#xFF0C;&#x9759;&#x6001;&#x5E93;&#x5B9E;&#x9645;&#x4E0A;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x4FDD;&#x5B58;&#x6240;&#x6709;&#x88AB;&#x6DFB;&#x52A0;&#x5230;&#x5176;&#x4E2D;&#x7684;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x7684;&#x526F;&#x672C;&#x7684;&#x6587;&#x4EF6;&#x3002;&#x8FD9;&#x4E2A;&#x5F52;&#x6863;&#x6587;&#x4EF6;&#x8FD8;&#x8BB0;&#x5F55;&#x7740;&#x6BCF;&#x4E2A;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x7684;&#x5404;&#x79CD;&#x7279;&#x6027;&#xFF0C;&#x5305;&#x62EC;&#x6587;&#x4EF6;&#x6743;&#x9650;&#x3001;&#x6570;&#x5B57;&#x7528;&#x6237;&#x548C;&#x7EC4;ID&#x4EE5;&#x53CA;&#x6700;&#x540E;&#x4FEE;&#x6539;&#x65F6;&#x95F4;&#x3002;&#x6839;&#x636E;&#x60EF;&#x4F8B;&#xFF0C;&#x9759;&#x6001;&#x5E93;&#x7684;&#x540D;&#x79F0;&#x7684;&#x5F62;&#x5F0F;&#x4E3A;libname.a&#x3002;</p>
<p>&#x4F7F;&#x7528;ar(1)&#x547D;&#x4EE4;&#x80FD;&#x591F;&#x521B;&#x5EFA;&#x548C;&#x7EF4;&#x62A4;&#x9759;&#x6001;&#x5E93;&#xFF0C;&#x5176;&#x901A;&#x7528;&#x5F62;&#x5F0F;&#x5982;&#x4E0B;&#x6240;&#x793A;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ ar options archive object-file<span class="token punctuation">..</span>.<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>options&#x53C2;&#x6570;&#x7531;&#x4E00;&#x7CFB;&#x5217;&#x7684;&#x5B57;&#x6BCD;&#x6784;&#x6210;&#xFF0C;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x662F;&#x64CD;&#x4F5C;&#x4EE3;&#x7801;&#xFF0C;&#x5176;&#x4ED6;&#x662F;&#x80FD;&#x591F;&#x5F71;&#x54CD;&#x64CD;&#x4F5C;&#x7684;&#x6267;&#x884C;&#x7684;&#x4FEE;&#x9970;&#x7B26;&#x3002;&#x4E0B;&#x9762;&#x662F;&#x4E00;&#x4E9B;&#x5E38;&#x7528;&#x7684;&#x64CD;&#x4F5C;&#x4EE3;&#x7801;&#x3002;<br><code>1. r&#xFF08;&#x66FF;&#x6362;&#xFF09;&#xFF1A;</code>&#x5C06;&#x4E00;&#x4E2A;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x63D2;&#x5165;&#x5230;&#x5F52;&#x6863;&#x6587;&#x4EF6;&#x4E2D;&#x5E76;&#x53D6;&#x4EE3;&#x540C;&#x540D;&#x7684;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x3002;&#x8FD9;&#x4E2A;&#x521B;&#x5EFA;&#x548C;&#x66F4;&#x65B0;&#x5F52;&#x6863;&#x6587;&#x4EF6;&#x7684;&#x6807;&#x51C6;&#x65B9;&#x6CD5;&#xFF0C;&#x4F7F;&#x7528;&#x4E0B;&#x9762;&#x7684;&#x547D;&#x4EE4;&#x53EF;&#x4EE5;&#x6784;&#x5EFA;&#x4E00;&#x4E2A;&#x5F52;&#x6863;&#x6587;&#x4EF6;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ cc -g -c mod1.c mod2.c mod3.c
$ ar r libdemo.a mod1.o mod2.o mod3.o
$ <span class="token function">rm</span> mod1.o mod2.o mod3.o<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x4ECE;&#x4E0A;&#x9762;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF0C;&#x5728;&#x6784;&#x5EFA;&#x5B8C;&#x5E93;&#x4E4B;&#x540E;&#x53EF;&#x4EE5;&#x6839;&#x636E;&#x9700;&#x8981;&#x5220;&#x9664;&#x539F;&#x59CB;&#x7684;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#xFF0C;&#x56E0;&#x4E3A;&#x5DF2;&#x7ECF;&#x4E0D;&#x518D;&#x9700;&#x8981;&#x5B83;&#x4EEC;&#x4E86;&#x3002;<br><code>2. t&#xFF08;&#x76EE;&#x5F55;&#x8868;&#xFF09;&#xFF1A;</code>&#x663E;&#x793A;&#x5F52;&#x6863;&#x4E2D;&#x7684;&#x76EE;&#x5F55;&#x8868;&#x3002;&#x5728;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#x53EA;&#x4F1A;&#x5217;&#x51FA;&#x5F52;&#x6863;&#x6587;&#x4EF6;&#x4E2D;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x7684;&#x540D;&#x79F0;&#x3002;&#x6DFB;&#x52A0;v&#xFF08;verbose&#xFF09;&#x4FEE;&#x9970;&#x7B26;&#x4E4B;&#x540E;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x8BB0;&#x5F55;&#x5728;&#x5F52;&#x6863;&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x5404;&#x4E2A;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x7684;&#x5176;&#x4ED6;&#x6240;&#x6709;&#x7279;&#x6027;&#xFF0C;&#x5982;&#x4E0B;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x6240;&#x793A;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ ar tv libdemo.a<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre><code>rw-r--r-- 0/0   4872 Jan  1 08:00 1970 mod1.o
rw-r--r-- 0/0   4872 Jan  1 08:00 1970 mod2.o
rw-r--r-- 0/0   4872 Jan  1 08:00 1970 mod3.o</code></pre><p>&#x4ECE;&#x5DE6;&#x81F3;&#x53F3;&#x6BCF;&#x4E2A;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x7684;&#x7279;&#x6027;&#x4E3A;&#x88AB;&#x6DFB;&#x52A0;&#x5230;&#x5F52;&#x6863;&#x6587;&#x4EF6;&#x4E2D;&#x65F6;&#x7684;&#x6743;&#x9650;&#x3001;&#x7528;&#x6237;ID&#x548C;&#x7EC4;ID&#x3001;&#x5927;&#x5C0F;&#x4EE5;&#x53CA;&#x4E0A;&#x6B21;&#x4FEE;&#x6539;&#x7684;&#x65E5;&#x5FD7;&#x548C;&#x65F6;&#x95F4;&#x3002;<br><code>3. d&#xFF08;&#x5220;&#x9664;&#xFF09;&#xFF1A;</code>&#x4ECE;&#x5F52;&#x6863;&#x6587;&#x4EF6;&#x4E2D;&#x5220;&#x9664;&#x4E00;&#x4E2A;&#x6A21;&#x5757;&#xFF0C;&#x5982;&#x4E0B;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x6240;&#x793A;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ ar d libdemo.a mod3.o<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="&#x4F7F;&#x7528;&#x9759;&#x6001;&#x5E93;"><a href="#&#x4F7F;&#x7528;&#x9759;&#x6001;&#x5E93;" class="headerlink" title="&#x4F7F;&#x7528;&#x9759;&#x6001;&#x5E93;"></a>&#x4F7F;&#x7528;&#x9759;&#x6001;&#x5E93;</h3><p>&#x5C06;&#x7A0B;&#x5E8F;&#x4E0E;&#x9759;&#x6001;&#x5E93;&#x94FE;&#x63A5;&#x8D77;&#x6765;&#x5B58;&#x5728;&#x4E24;&#x79CD;&#x65B9;&#x5F0F;&#x3002;&#x7B2C;&#x4E00;&#x79CD;&#x662F;&#x5728;&#x94FE;&#x63A5;&#x547D;&#x4EE4;&#x4E2D;&#x6307;&#x5B9A;&#x9759;&#x6001;&#x5E93;&#x7684;&#x540D;&#x79F0;&#xFF0C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ cc -g -c prog.c
$ cc -g -o prog prog.o libdemo.a<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x6216;&#x8005;&#x5C06;&#x9759;&#x6001;&#x5E93;&#x653E;&#x5728;&#x94FE;&#x63A5;&#x5668;&#x641C;&#x7D22;&#x7684;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x6807;&#x51C6;&#x76EE;&#x5F55;&#x4E2D;&#xFF08;&#x5982;/usr/lib&#xFF09;&#xFF0C;&#x7136;&#x540E;&#x4F7F;&#x7528;-l&#x9009;&#x9879;&#x6307;&#x5B9A;&#x5E93;&#x540D;&#xFF08;&#x5373;&#x5E93;&#x7684;&#x6587;&#x4EF6;&#x540D;&#x53BB;&#x9664;&#x4E86;lib&#x524D;&#x7F00;&#x548C;.a&#x540E;&#x7F00;&#xFF09;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ cc -g -o prog prog.o -ldemo<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>&#x5982;&#x679C;&#x5E93;&#x4E0D;&#x4F4D;&#x4E8E;&#x94FE;&#x63A5;&#x5668;&#x641C;&#x7D22;&#x7684;&#x76EE;&#x5F55;&#x4E2D;&#xFF0C;&#x90A3;&#x4E48;&#x53EF;&#x4EE5;&#x53EA;&#x7528;-L&#x9009;&#x9879;&#x6307;&#x5B9A;&#x94FE;&#x63A5;&#x5668;&#x5E94;&#x8BE5;&#x641C;&#x7D22;&#x8FD9;&#x4E2A;&#x989D;&#x5916;&#x7684;&#x76EE;&#x5F55;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ cc -g -o prog prog.o -Lmylibdir -ldemo<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>&#x867D;&#x7136;&#x4E00;&#x4E2A;&#x9759;&#x6001;&#x5E93;&#x53EF;&#x4EE5;&#x5305;&#x542B;&#x5F88;&#x591A;&#x76EE;&#x6807;&#x6A21;&#x5757;&#xFF0C;&#x4F46;&#x94FE;&#x63A5;&#x5668;&#x53EA;&#x4F1A;&#x5305;&#x542B;&#x90A3;&#x4E9B;&#x7A0B;&#x5E8F;&#x9700;&#x8981;&#x7684;&#x6A21;&#x5757;&#x3002;</p>
<h2 id="&#x5171;&#x4EAB;&#x5E93;&#x6982;&#x8FF0;"><a href="#&#x5171;&#x4EAB;&#x5E93;&#x6982;&#x8FF0;" class="headerlink" title="&#x5171;&#x4EAB;&#x5E93;&#x6982;&#x8FF0;"></a>&#x5171;&#x4EAB;&#x5E93;&#x6982;&#x8FF0;</h2><p>&#x5C06;&#x7A0B;&#x5E8F;&#x4E0E;&#x9759;&#x6001;&#x5E93;&#x94FE;&#x63A5;&#x8D77;&#x6765;&#x65F6;&#xFF08;&#x6216;&#x6CA1;&#x6709;&#x4F7F;&#x7528;&#x9759;&#x6001;&#x5E93;&#xFF09;&#xFF0C;&#x5F97;&#x5230;&#x7684;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x4F1A;&#x5305;&#x542B;&#x6240;&#x6709;&#x88AB;&#x94FE;&#x63A5;&#x8FDB;&#x7A0B;&#x5E8F;&#x7684;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x7684;&#x526F;&#x672C;&#x3002;&#x8FD9;&#x6837;&#x5F53;&#x51E0;&#x4E2A;&#x4E0D;&#x540C;&#x7684;&#x53EF;&#x6267;&#x884C;&#x7A0B;&#x5E8F;&#x4F7F;&#x7528;&#x4E86;&#x540C;&#x6837;&#x7684;&#x76EE;&#x6807;&#x6A21;&#x5757;&#x65F6;&#xFF0C;&#x6BCF;&#x4E2A;&#x53EF;&#x6267;&#x884C;&#x7A0B;&#x5E8F;&#x4F1A;&#x62E5;&#x6709;&#x81EA;&#x5DF1;&#x7684;&#x76EE;&#x6807;&#x6A21;&#x5757;&#x7684;&#x526F;&#x672C;&#x3002;&#x8FD9;&#x79CD;&#x4EE3;&#x7801;&#x7684;&#x5197;&#x4F59;&#x5B58;&#x5728;&#x51E0;&#x4E2A;&#x7F3A;&#x70B9;&#x3002;</p>
<ul>
<li>&#x5B58;&#x50A8;&#x540C;&#x4E00;&#x4E2A;&#x76EE;&#x6807;&#x6A21;&#x5757;&#x7684;&#x591A;&#x4E2A;&#x526F;&#x672C;&#x4F1A;&#x6D6A;&#x8D39;&#x78C1;&#x76D8;&#x7A7A;&#x95F4;&#xFF0C;&#x5E76;&#x4E14;&#x6240;&#x6D6A;&#x8D39;&#x7684;&#x7A7A;&#x95F4;&#x662F;&#x6BD4;&#x8F83;&#x5927;&#x7684;&#x3002;</li>
<li>&#x5982;&#x679C;&#x51E0;&#x4E2A;&#x4F7F;&#x7528;&#x4E86;&#x540C;&#x4E00;&#x6A21;&#x5757;&#x7684;&#x7A0B;&#x5E8F;&#x5728;&#x540C;&#x4E00;&#x65F6;&#x523B;&#x8FD0;&#x884C;&#xFF0C;&#x90A3;&#x4E48;&#x6BCF;&#x4E2A;&#x7A0B;&#x5E8F;&#x4F1A;&#x72EC;&#x7ACB;&#x5730;&#x5728;&#x865A;&#x62DF;&#x5185;&#x5B58;&#x4E2D;&#x4FDD;&#x5B58;&#x4E00;&#x4EFD;&#x76EE;&#x6807;&#x6A21;&#x5757;&#x7684;&#x526F;&#x672C;&#xFF0C;&#x4ECE;&#x800C;&#x63D0;&#x9AD8;&#x7CFB;&#x7EDF;&#x4E2D;&#x865A;&#x62DF;&#x5185;&#x5B58;&#x7684;&#x6574;&#x4F53;&#x4F7F;&#x7528;&#x91CF;&#x3002;</li>
<li>&#x5982;&#x679C;&#x9700;&#x8981;&#x4FEE;&#x6539;&#x4E00;&#x4E2A;&#x9759;&#x6001;&#x5E93;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x76EE;&#x6807;&#x6A21;&#x5757;&#xFF08;&#x53EF;&#x80FD;&#x662F;&#x56E0;&#x4E3A;&#x5B89;&#x5168;&#x6027;&#x6216;&#x9700;&#x8981;&#x4FEE;&#x6B63;bug&#xFF09;&#xFF0C;&#x90A3;&#x4E48;&#x6240;&#x6709;&#x4F7F;&#x7528;&#x90A3;&#x4E2A;&#x6A21;&#x5757;&#x7684;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x90FD;&#x5FC5;&#x987B;&#x8981;&#x91CD;&#x65B0;&#x8FDB;&#x884C;&#x94FE;&#x63A5;&#x4EE5;&#x5408;&#x5E76;&#x8FD9;&#x4E2A;&#x53D8;&#x66F4;&#x3002;&#x8FD9;&#x4E2A;&#x7F3A;&#x70B9;&#x8FD8;&#x4F1A;&#x5BFC;&#x81F4;&#x7CFB;&#x7EDF;&#x7BA1;&#x7406;&#x5458;&#x9700;&#x8981;&#x5F04;&#x6E05;&#x695A;&#x54EA;&#x4E9B;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x94FE;&#x63A5;&#x4E86;&#x8FD9;&#x4E2A;&#x5E93;&#x3002;</li>
</ul>
<p>&#x5171;&#x4EAB;&#x5E93;&#x5C31;&#x662F;&#x8BBE;&#x8BA1;&#x7528;&#x6765;&#x89E3;&#x51B3;&#x8FD9;&#x4E9B;&#x7F3A;&#x70B9;&#x7684;&#x3002;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x5173;&#x952E;&#x601D;&#x60F3;&#x662F;&#x76EE;&#x6807;&#x6A21;&#x5757;&#x7684;&#x5355;&#x4E2A;&#x526F;&#x672C;&#x7531;&#x6240;&#x6709;&#x9700;&#x8981;&#x8FD9;&#x4E9B;&#x6A21;&#x5757;&#x7684;&#x7A0B;&#x5E8F;&#x5171;&#x4EAB;&#x3002;&#x76EE;&#x6807;&#x6A21;&#x5757;&#x4E0D;&#x4F1A;&#x88AB;&#x590D;&#x5236;&#x5230;&#x94FE;&#x63A5;&#x8FC7;&#x7684;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x4E2D;&#xFF0C;&#x76F8;&#x53CD;&#xFF0C;&#x5F53;&#x7B2C;&#x4E00;&#x4E2A;&#x9700;&#x8981;&#x5171;&#x4EAB;&#x5E93;&#x4E2D;&#x7684;&#x6A21;&#x5757;&#x7684;&#x7A0B;&#x5E8F;&#x542F;&#x52A8;&#x65F6;&#xFF0C;&#x5E93;&#x7684;&#x5355;&#x4E2A;&#x526F;&#x672C;&#x5C31;&#x4F1A;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x88AB;&#x52A0;&#x8F7D;&#x8FDB;&#x5185;&#x5B58;&#x3002;&#x5F53;&#x540E;&#x9762;&#x4F7F;&#x7528;&#x540C;&#x4E00;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x5176;&#x4ED6;&#x7A0B;&#x5E8F;&#x542F;&#x52A8;&#x65F6;&#xFF0C;&#x5B83;&#x4EEC;&#x4F1A;&#x4F7F;&#x7528;&#x5DF2;&#x7ECF;&#x88AB;&#x52A0;&#x8F7D;&#x8FDB;&#x5185;&#x5B58;&#x7684;&#x5E93;&#x7684;&#x526F;&#x672C;&#x3002;&#x4F7F;&#x7528;&#x5171;&#x4EAB;&#x5E93;&#x610F;&#x5473;&#x7740;&#x53EF;&#x6267;&#x884C;&#x7A0B;&#x5E8F;&#x9700;&#x8981;&#x7684;&#x78C1;&#x76D8;&#x7A7A;&#x95F4;&#x548C;&#x865A;&#x62DF;&#x5185;&#x5B58;&#xFF08;&#x5728;&#x8FD0;&#x884C;&#x7684;&#x65F6;&#x5019;&#xFF09;&#x66F4;&#x5C11;&#x4E86;&#x3002;</p>
<p>&#x867D;&#x7136;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x4EE3;&#x7801;&#x662F;&#x7531;&#x591A;&#x4E2A;&#x8FDB;&#x7A0B;&#x5171;&#x4EAB;&#x7684;&#xFF0C;&#x4F46;&#x5176;&#x4E2D;&#x7684;&#x53D8;&#x91CF;&#x5374;&#x4E0D;&#x662F;&#x7684;&#x3002;&#x6BCF;&#x4E2A;&#x4F7F;&#x7528;&#x5E93;&#x7684;&#x8FDB;&#x7A0B;&#x4F1A;&#x62E5;&#x6709;&#x81EA;&#x5DF1;&#x7684;&#x5728;&#x5E93;&#x4E2D;&#x5B9A;&#x4E49;&#x7684;&#x5168;&#x5C40;&#x548C;&#x9759;&#x6001;&#x53D8;&#x91CF;&#x7684;&#x526F;&#x672C;&#x3002;</p>
<p>&#x5171;&#x4EAB;&#x5E93;&#x8FD8;&#x5177;&#x5907;&#x4E0B;&#x5217;&#x4F18;&#x52BF;&#x3002;</p>
<ul>
<li>&#x7531;&#x4E8E;&#x6574;&#x4E2A;&#x7A0B;&#x5E8F;&#x7684;&#x5927;&#x5C0F;&#x53D8;&#x5F97;&#x66F4;&#x5C0F;&#x4E86;&#xFF0C;&#x56E0;&#x6B64;&#x5728;&#x4E00;&#x4E9B;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x7A0B;&#x5E8F;&#x53EF;&#x4EE5;&#x5B8C;&#x5168;&#x88AB;&#x52A0;&#x8F7D;&#x8FDB;&#x5185;&#x5B58;&#x4E2D;&#xFF0C;&#x4ECE;&#x800C;&#x80FD;&#x591F;&#x66F4;&#x5FEB;&#x5730;&#x542F;&#x52A8;&#x7A0B;&#x5E8F;&#x3002;&#x8FD9;&#x4E00;&#x70B9;&#x53EA;&#x6709;&#x5728;&#x5927;&#x578B;&#x5171;&#x4EAB;&#x5E93;&#x6B63;&#x5728;&#x88AB;&#x5176;&#x4ED6;&#x7A0B;&#x5E8F;&#x4F7F;&#x7528;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x624D;&#x6210;&#x7ACB;&#x3002;&#x7B2C;&#x4E00;&#x4E2A;&#x52A0;&#x8F7D;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x7A0B;&#x5E8F;&#x5B9E;&#x9645;&#x4E0A;&#x5728;&#x542F;&#x52A8;&#x65F6;&#x4F1A;&#x82B1;&#x8D39;&#x66F4;&#x957F;&#x7684;&#x65F6;&#x95F4;&#xFF0C;&#x56E0;&#x4E3A;&#x5FC5;&#x987B;&#x8981;&#x5148;&#x627E;&#x5230;&#x5171;&#x4EAB;&#x5E93;&#x5E76;&#x5C06;&#x5176;&#x52A0;&#x8F7D;&#x5230;&#x5185;&#x5B58;&#x4E2D;&#x3002;</li>
<li>&#x7531;&#x4E8E;&#x76EE;&#x6807;&#x6A21;&#x5757;&#x6CA1;&#x6709;&#x88AB;&#x590D;&#x5236;&#x8FDB;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x4E2D;&#xFF0C;&#x800C;&#x662F;&#x5728;&#x5171;&#x4EAB;&#x5E93;&#x4E2D;&#x96C6;&#x4E2D;&#x7EF4;&#x62A4;&#x7684;&#xFF0C;&#x56E0;&#x6B64;&#x5728;&#x4FEE;&#x6539;&#x76EE;&#x6807;&#x6A21;&#x5757;&#x65F6;&#x65E0;&#x9700;&#x91CD;&#x65B0;&#x94FE;&#x63A5;&#x7A0B;&#x5E8F;&#x5C31;&#x80FD;&#x591F;&#x770B;&#x5230;&#x53D8;&#x66F4;&#xFF0C;&#x751A;&#x81F3;&#x5728;&#x8FD0;&#x884C;&#x7740;&#x7684;&#x7A0B;&#x5E8F;&#x6B63;&#x5728;&#x4F7F;&#x7528;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x73B0;&#x6709;&#x7248;&#x672C;&#x7684;&#x65F6;&#x5019;&#x4E5F;&#x80FD;&#x591F;&#x8FDB;&#x884C;&#x8FD9;&#x6837;&#x7684;&#x53D8;&#x66F4;&#x3002;</li>
</ul>
<p>&#x8FD9;&#x9879;&#x65B0;&#x589E;&#x529F;&#x80FD;&#x7684;&#x4E3B;&#x8981;&#x5F00;&#x9500;&#x5982;&#x4E0B;&#x6240;&#x8FF0;&#x3002;</p>
<ul>
<li>&#x5728;&#x6982;&#x5FF5;&#x4E0A;&#x4EE5;&#x53CA;&#x521B;&#x5EFA;&#x5171;&#x4EAB;&#x5E93;&#x548C;&#x6784;&#x5EFA;&#x4F7F;&#x7528;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x7A0B;&#x5E8F;&#x7684;&#x5B9E;&#x8DF5;&#x4E0A;&#xFF0C;&#x5171;&#x4EAB;&#x5E93;&#x6BD4;&#x9759;&#x6001;&#x5E93;&#x66F4;&#x590D;&#x6742;&#x3002;</li>
<li>&#x5171;&#x4EAB;&#x5E93;&#x5728;&#x7F16;&#x8BD1;&#x65F6;&#x5FC5;&#x987B;&#x8981;&#x4F7F;&#x7528;&#x4F4D;&#x7F6E;&#x72EC;&#x7ACB;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x8FD9;&#x5728;&#x5927;&#x591A;&#x6570;&#x67B6;&#x6784;&#x4E0A;&#x90FD;&#x4F1A;&#x5E26;&#x6765;&#x6027;&#x80FD;&#x5F00;&#x9500;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x989D;&#x5916;&#x7684;&#x4E00;&#x4E2A;&#x5BC4;&#x5B58;&#x5668;&#xFF08;[Hubicka, 2003]&#xFF09;&#x3002;</li>
<li>&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x5FC5;&#x987B;&#x8981;&#x6267;&#x884C;&#x7B26;&#x53F7;&#x91CD;&#x5B9A;&#x4F4D;&#x3002;&#x5728;&#x7B26;&#x53F7;&#x91CD;&#x5B9A;&#x4F4D;&#x671F;&#x95F4;&#xFF0C;&#x9700;&#x8981;&#x5C06;&#x5BF9;&#x5171;&#x4EAB;&#x5E93;&#x4E2D;&#x6BCF;&#x4E2A;&#x7B26;&#x53F7;&#xFF08;&#x53D8;&#x91CF;&#x6216;&#x51FD;&#x6570;&#xFF09;&#x7684;&#x5F15;&#x7528;&#x4FEE;&#x6539;&#x6210;&#x7B26;&#x53F7;&#x5728;&#x865A;&#x62DF;&#x5185;&#x5B58;&#x4E2D;&#x7684;&#x5B9E;&#x9645;&#x8FD0;&#x884C;&#x65F6;&#x4F4D;&#x7F6E;&#x3002;&#x7531;&#x4E8E;&#x5B58;&#x5728;&#x8FD9;&#x4E2A;&#x91CD;&#x5B9A;&#x4F4D;&#x7684;&#x8FC7;&#x7A0B;&#xFF0C;&#x4E0E;&#x9759;&#x6001;&#x94FE;&#x63A5;&#x7A0B;&#x5E8F;&#x76F8;&#x6BD4;&#xFF0C;&#x4E00;&#x4E2A;&#x4F7F;&#x7528;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x7A0B;&#x5E8F;&#x6216;&#x591A;&#x6216;&#x5C11;&#x9700;&#x8981;&#x82B1;&#x8D39;&#x4E00;&#x4E9B;&#x65F6;&#x95F4;&#x6765;&#x6267;&#x884C;&#x8FD9;&#x4E2A;&#x8FC7;&#x7A0B;&#x3002;</li>
</ul>
<p>&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x53E6;&#x4E00;&#x79CD;&#x7528;&#x6CD5;&#x662F;&#x4F5C;&#x4E3A;Java NativeInterface (JNI)&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x6784;&#x5EFA;&#x5757;&#xFF0C;&#x5B83;&#x5141;&#x8BB8;Java&#x4EE3;&#x7801;&#x901A;&#x8FC7;&#x8C03;&#x7528;&#x5171;&#x4EAB;&#x5E93;&#x4E2D;&#x7684;C&#x51FD;&#x6570;&#x76F4;&#x63A5;&#x8BBF;&#x95EE;&#x5E95;&#x5C42;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x7684;&#x7279;&#x6027;.</p>
<h2 id="&#x521B;&#x5EFA;&#x548C;&#x4F7F;&#x7528;&#x5171;&#x4EAB;&#x5E93;&#x2014;&#x2014;&#x9996;&#x56DE;&#x5408;"><a href="#&#x521B;&#x5EFA;&#x548C;&#x4F7F;&#x7528;&#x5171;&#x4EAB;&#x5E93;&#x2014;&#x2014;&#x9996;&#x56DE;&#x5408;" class="headerlink" title="&#x521B;&#x5EFA;&#x548C;&#x4F7F;&#x7528;&#x5171;&#x4EAB;&#x5E93;&#x2014;&#x2014;&#x9996;&#x56DE;&#x5408;"></a>&#x521B;&#x5EFA;&#x548C;&#x4F7F;&#x7528;&#x5171;&#x4EAB;&#x5E93;&#x2014;&#x2014;&#x9996;&#x56DE;&#x5408;</h2><p>&#x4E3A;&#x4E86;&#x7406;&#x89E3;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x64CD;&#x4F5C;&#x65B9;&#x5F0F;&#xFF0C;&#x4E0B;&#x9762;&#x5F00;&#x59CB;&#x4ECB;&#x7ECD;&#x6784;&#x5EFA;&#x548C;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x5171;&#x4EAB;&#x5E93;&#x6240;&#x9700;&#x5B8C;&#x6210;&#x7684;&#x6700;&#x5C11;&#x6B65;&#x9AA4;&#xFF0C;&#x5728;&#x4ECB;&#x7ECD;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x4F1A;&#x5FFD;&#x7565;&#x5E73;&#x65F6;&#x4F7F;&#x7528;&#x7684;&#x5171;&#x4EAB;&#x5E93;&#x6587;&#x4EF6;&#x547D;&#x540D;&#x89C4;&#x8303;&#x3002;&#x5141;&#x8BB8;&#x7A0B;&#x5E8F;&#x81EA;&#x52A8;&#x52A0;&#x8F7D;&#x5B83;&#x4EEC;&#x6240;&#x9700;&#x7684;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x6700;&#x65B0;&#x7248;&#x672C;&#xFF0C;&#x540C;&#x65F6;&#x4E5F;&#x5141;&#x8BB8;&#x4E00;&#x4E2A;&#x5E93;&#x7684;&#x591A;&#x4E2A;&#x76F8;&#x4E92;&#x4E0D;&#x517C;&#x5BB9;&#x7684;&#x7248;&#x672C;&#xFF08;&#x6240;&#x8C13;&#x7684;&#x4E3B;&#x7248;&#x672C;&#xFF09;&#x548C;&#x8C10;&#x5730;&#x5171;&#x5B58;&#x3002;</p>
<p>&#x5728;&#x672C;&#x7AE0;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x5173;&#x5FC3;Executable and Linking Format&#xFF08;ELF&#xFF09;&#x5171;&#x4EAB;&#x5E93;&#xFF0C;&#x56E0;&#x4E3A;&#x73B0;&#x4EE3;&#x7248;&#x672C;&#x7684;Linux&#x4EE5;&#x53CA;&#x5F88;&#x591A;&#x5176;&#x4ED6;UNIX&#x5B9E;&#x73B0;&#x7684;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x548C;&#x5171;&#x4EAB;&#x5E93;&#x90FD;&#x91C7;&#x7528;&#x4E86;ELF&#x683C;&#x5F0F;&#x3002;ELF&#x53D6;&#x4EE3;&#x4E86;&#x8F83;&#x65E9;&#x4EE5;&#x524D;&#x7684;a.out&#x548C;COFF&#x683C;&#x5F0F;&#x3002;</p>
<h3 id="&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5171;&#x4EAB;&#x5E93;"><a href="#&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5171;&#x4EAB;&#x5E93;" class="headerlink" title="&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5171;&#x4EAB;&#x5E93;"></a>&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5171;&#x4EAB;&#x5E93;</h3><p>&#x4E3A;&#x6784;&#x5EFA;&#x4E4B;&#x524D;&#x521B;&#x5EFA;&#x7684;&#x9759;&#x6001;&#x5E93;&#x7684;&#x5171;&#x4EAB;&#x7248;&#x672C;&#xFF0C;&#x9700;&#x8981;&#x6267;&#x884C;&#x4E0B;&#x9762;&#x7684;&#x6B65;&#x9AA4;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ gcc -g -c -fPIC -Wall mod1.c mod2.c mod3.c
$ gcc -g -shared -o libfoo.so mod1.o mod2.o mod3.o<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x7B2C;&#x4E00;&#x4E2A;&#x547D;&#x4EE4;&#x521B;&#x5EFA;&#x4E86;&#x4E09;&#x4E2A;&#x5C06;&#x8981;&#x88AB;&#x653E;&#x5230;&#x5E93;&#x4E2D;&#x7684;&#x76EE;&#x6807;&#x6A21;&#x5757;&#x3002;&#xFF08;&#x4E0B;&#x4E00;&#x8282;&#x5C06;&#x5BF9;cc &#x2013;fPIC&#x9009;&#x9879;&#x8FDB;&#x884C;&#x89E3;&#x91CA;&#x3002;&#xFF09;cc &#x2013;shared&#x547D;&#x4EE4;&#x521B;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A;&#x5305;&#x542B;&#x8FD9;&#x4E09;&#x4E2A;&#x76EE;&#x6807;&#x6A21;&#x5757;&#x7684;&#x5171;&#x4EAB;&#x5E93;&#x3002;<br>&#x6839;&#x636E;&#x60EF;&#x4F8B;&#xFF0C;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x524D;&#x7F00;&#x4E3A;lib&#xFF0C;&#x540E;&#x7F00;&#x4E3A;.so&#xFF08;&#x8868;&#x793A;shared object&#xFF09;&#x3002;<br>&#x5728;&#x4E0A;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x4E2D;&#x4F7F;&#x7528;&#x4E86;gcc&#x547D;&#x4EE4;&#xFF0C;&#x800C;&#x5E76;&#x6CA1;&#x6709;&#x4F7F;&#x7528;&#x4E0E;&#x4E4B;&#x7B49;&#x4EF7;&#x7684;cc&#x547D;&#x4EE4;&#xFF0C;&#x8FD9;&#x662F;&#x4E3A;&#x4E86;&#x7A81;&#x51FA;&#x7528;&#x6765;&#x521B;&#x5EFA;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x547D;&#x4EE4;&#x884C;&#x9009;&#x9879;&#x662F;&#x4F9D;&#x8D56;&#x4E8E;&#x7F16;&#x8BD1;&#x5668;&#x7684;&#xFF0C;&#x5728;&#x53E6;&#x4E00;&#x4E2A;UNIX&#x5B9E;&#x73B0;&#x4E0A;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x4E0D;&#x540C;&#x7684;C&#x7F16;&#x8BD1;&#x5668;&#x53EF;&#x80FD;&#x4F1A;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x4E0D;&#x540C;&#x7684;&#x9009;&#x9879;&#x3002;</p>
<p>&#x6CE8;&#x610F;&#x53EF;&#x4EE5;&#x5C06;&#x7F16;&#x8BD1;&#x6E90;&#x4EE3;&#x7801;&#x6587;&#x4EF6;&#x548C;&#x521B;&#x5EFA;&#x5171;&#x4EAB;&#x5E93;&#x653E;&#x5728;&#x4E00;&#x4E2A;&#x547D;&#x4EE4;&#x4E2D;&#x6267;&#x884C;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ gcc -g -c -fPIC -Wall mod1.c mod2.c mod3.c -shared -o libfoo.so<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>&#x4E0E;&#x9759;&#x6001;&#x5E93;&#x4E0D;&#x540C;&#xFF0C;&#x53EF;&#x4EE5;&#x5411;&#x4E4B;&#x524D;&#x6784;&#x5EFA;&#x7684;&#x5171;&#x4EAB;&#x5E93;&#x4E2D;&#x6DFB;&#x52A0;&#x5355;&#x4E2A;&#x76EE;&#x6807;&#x6A21;&#x5757;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x4ECE;&#x4E2D;&#x5220;&#x9664;&#x5355;&#x4E2A;&#x76EE;&#x6807;&#x6A21;&#x5757;&#x3002;&#x4E0E;&#x666E;&#x901A;&#x7684;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x4E00;&#x6837;&#xFF0C;&#x5171;&#x4EAB;&#x5E93;&#x4E2D;&#x7684;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x4E0D;&#x518D;&#x7EF4;&#x62A4;&#x4E0D;&#x540C;&#x7684;&#x8EAB;&#x4EFD;&#x3002;</p>
<h3 id="&#x4F4D;&#x7F6E;&#x72EC;&#x7ACB;&#x7684;&#x4EE3;&#x7801;"><a href="#&#x4F4D;&#x7F6E;&#x72EC;&#x7ACB;&#x7684;&#x4EE3;&#x7801;" class="headerlink" title="&#x4F4D;&#x7F6E;&#x72EC;&#x7ACB;&#x7684;&#x4EE3;&#x7801;"></a>&#x4F4D;&#x7F6E;&#x72EC;&#x7ACB;&#x7684;&#x4EE3;&#x7801;</h3><p>cc-fPIC&#x9009;&#x9879;&#x6307;&#x5B9A;&#x7F16;&#x8BD1;&#x5668;&#x5E94;&#x8BE5;&#x751F;&#x6210;&#x4F4D;&#x7F6E;&#x72EC;&#x7ACB;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x8FD9;&#x4F1A;&#x6539;&#x53D8;&#x7F16;&#x8BD1;&#x5668;&#x751F;&#x6210;&#x6267;&#x884C;&#x7279;&#x5B9A;&#x64CD;&#x4F5C;&#x7684;&#x4EE3;&#x7801;&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x5305;&#x62EC;&#x8BBF;&#x95EE;&#x5168;&#x5C40;&#x3001;&#x9759;&#x6001;&#x548C;&#x5916;&#x90E8;&#x53D8;&#x91CF;&#xFF0C;&#x8BBF;&#x95EE;&#x5B57;&#x7B26;&#x4E32;&#x5E38;&#x91CF;&#xFF0C;&#x4EE5;&#x53CA;&#x83B7;&#x53D6;&#x51FD;&#x6570;&#x7684;&#x5730;&#x5740;&#x3002;&#x8FD9;&#x4E9B;&#x53D8;&#x66F4;&#x4F7F;&#x5F97;&#x4EE3;&#x7801;&#x53EF;&#x4EE5;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x88AB;&#x653E;&#x7F6E;&#x5728;&#x4EFB;&#x610F;&#x4E00;&#x4E2A;&#x865A;&#x62DF;&#x5730;&#x5740;&#x5904;&#x3002;&#x8FD9;&#x4E00;&#x70B9;&#x5BF9;&#x4E8E;&#x5171;&#x4EAB;&#x5E93;&#x6765;&#x8BB2;&#x662F;&#x5FC5;&#x9700;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#x5728;&#x94FE;&#x63A5;&#x7684;&#x65F6;&#x5019;&#x662F;&#x65E0;&#x6CD5;&#x77E5;&#x9053;&#x5171;&#x4EAB;&#x5E93;&#x4EE3;&#x7801;&#x4F4D;&#x4E8E;&#x5185;&#x5B58;&#x7684;&#x4F55;&#x5904;&#x7684;&#x3002;&#xFF08;&#x4E00;&#x4E2A;&#x5171;&#x4EAB;&#x5E93;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x6240;&#x5904;&#x7684;&#x5185;&#x5B58;&#x4F4D;&#x7F6E;&#x4F9D;&#x8D56;&#x4E8E;&#x5F88;&#x591A;&#x56E0;&#x7D20;&#xFF0C;&#x5982;&#x52A0;&#x8F7D;&#x8FD9;&#x4E2A;&#x5E93;&#x7684;&#x7A0B;&#x5E8F;&#x5DF2;&#x7ECF;&#x5360;&#x7528;&#x7684;&#x5185;&#x5B58;&#x6570;&#x91CF;&#x548C;&#x8FD9;&#x4E2A;&#x7A0B;&#x5E8F;&#x5DF2;&#x7ECF;&#x52A0;&#x8F7D;&#x7684;&#x5176;&#x4ED6;&#x5171;&#x4EAB;&#x5E93;&#x3002;&#xFF09;</p>
<p>cc-fPIC&#x9009;&#x9879;&#x6307;&#x5B9A;&#x7F16;&#x8BD1;&#x5668;&#x5E94;&#x8BE5;&#x751F;&#x6210;&#x4F4D;&#x7F6E;&#x72EC;&#x7ACB;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x8FD9;&#x4F1A;&#x6539;&#x53D8;&#x7F16;&#x8BD1;&#x5668;&#x751F;&#x6210;&#x6267;&#x884C;&#x7279;&#x5B9A;&#x64CD;&#x4F5C;&#x7684;&#x4EE3;&#x7801;&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x5305;&#x62EC;&#x8BBF;&#x95EE;&#x5168;&#x5C40;&#x3001;&#x9759;&#x6001;&#x548C;&#x5916;&#x90E8;&#x53D8;&#x91CF;&#xFF0C;&#x8BBF;&#x95EE;&#x5B57;&#x7B26;&#x4E32;&#x5E38;&#x91CF;&#xFF0C;&#x4EE5;&#x53CA;&#x83B7;&#x53D6;&#x51FD;&#x6570;&#x7684;&#x5730;&#x5740;&#x3002;&#x8FD9;&#x4E9B;&#x53D8;&#x66F4;&#x4F7F;&#x5F97;&#x4EE3;&#x7801;&#x53EF;&#x4EE5;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x88AB;&#x653E;&#x7F6E;&#x5728;&#x4EFB;&#x610F;&#x4E00;&#x4E2A;&#x865A;&#x62DF;&#x5730;&#x5740;&#x5904;&#x3002;&#x8FD9;&#x4E00;&#x70B9;&#x5BF9;&#x4E8E;&#x5171;&#x4EAB;&#x5E93;&#x6765;&#x8BB2;&#x662F;&#x5FC5;&#x9700;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#x5728;&#x94FE;&#x63A5;&#x7684;&#x65F6;&#x5019;&#x662F;&#x65E0;&#x6CD5;&#x77E5;&#x9053;&#x5171;&#x4EAB;&#x5E93;&#x4EE3;&#x7801;&#x4F4D;&#x4E8E;&#x5185;&#x5B58;&#x7684;&#x4F55;&#x5904;&#x7684;&#x3002;&#xFF08;&#x4E00;&#x4E2A;&#x5171;&#x4EAB;&#x5E93;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x6240;&#x5904;&#x7684;&#x5185;&#x5B58;&#x4F4D;&#x7F6E;&#x4F9D;&#x8D56;&#x4E8E;&#x5F88;&#x591A;&#x56E0;&#x7D20;&#xFF0C;&#x5982;&#x52A0;&#x8F7D;&#x8FD9;&#x4E2A;&#x5E93;&#x7684;&#x7A0B;&#x5E8F;&#x5DF2;&#x7ECF;&#x5360;&#x7528;&#x7684;&#x5185;&#x5B58;&#x6570;&#x91CF;&#x548C;&#x8FD9;&#x4E2A;&#x7A0B;&#x5E8F;&#x5DF2;&#x7ECF;&#x52A0;&#x8F7D;&#x7684;&#x5176;&#x4ED6;&#x5171;&#x4EAB;&#x5E93;&#x3002;&#xFF09;</p>
<p>&#x5728;Linux/x86-32&#x4E0A;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4E0D;&#x52A0;&#x2013;fPIC&#x9009;&#x9879;&#x7F16;&#x8BD1;&#x7684;&#x6A21;&#x5757;&#x6765;&#x521B;&#x5EFA;&#x5171;&#x4EAB;&#x5E93;&#x3002;&#x4F46;&#x8FD9;&#x6837;&#x505A;&#x7684;&#x8BDD;&#x4F1A;&#x4E22;&#x5931;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x4E00;&#x4E9B;&#x4F18;&#x70B9;&#xFF0C;&#x56E0;&#x4E3A;&#x5305;&#x542B;&#x4F9D;&#x8D56;&#x4E8E;&#x4F4D;&#x7F6E;&#x7684;&#x5185;&#x5B58;&#x5F15;&#x7528;&#x7684;&#x7A0B;&#x5E8F;&#x6587;&#x672C;&#x9875;&#x9762;&#x4E0D;&#x4F1A;&#x5728;&#x8FDB;&#x7A0B;&#x95F4;&#x5171;&#x4EAB;&#x3002;&#x5728;&#x4E00;&#x4E9B;&#x67B6;&#x6784;&#x4E0A;&#x662F;&#x65E0;&#x6CD5;&#x5728;&#x4E0D;&#x52A0;&#x2013;fPIC&#x9009;&#x9879;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x6784;&#x5EFA;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x3002;</p>
<p>&#x4E3A;&#x4E86;&#x786E;&#x5B9A;&#x4E00;&#x4E2A;&#x65E2;&#x6709;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x5728;&#x7F16;&#x8BD1;&#x65F6;&#x662F;&#x5426;&#x4F7F;&#x7528;&#x4E86;&#x2013;fPIC&#x9009;&#x9879;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4E0B;&#x9762;&#x4E24;&#x4E2A;&#x547D;&#x4EE4;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x6765;&#x68C0;&#x67E5;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x7B26;&#x53F7;&#x8868;&#x4E2D;&#x662F;&#x5426;&#x5B58;&#x5728;&#x540D;&#x79F0;_GLOBAL_OFFSET_TABLE_&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ nm mod1.o <span class="token operator">|</span> <span class="token function">grep</span> _GLOBAL_OFFSET_TABLE_
$ readelf  -s mod1.o <span class="token operator">|</span> <span class="token function">grep</span> _GLOBAL_OFFSET_TABLE_<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x76F8;&#x5E94;&#x5730;&#xFF0C;&#x5982;&#x679C;&#x4E0B;&#x9762;&#x4E24;&#x4E2A;&#x76F8;&#x4E92;&#x7B49;&#x4EF7;&#x7684;&#x547D;&#x4EE4;&#x4E2D;&#x7684;&#x4EFB;&#x610F;&#x4E00;&#x4E2A;&#x4EA7;&#x751F;&#x4E86;&#x4EFB;&#x4F55;&#x8F93;&#x51FA;&#xFF0C;&#x90A3;&#x4E48;&#x6307;&#x5B9A;&#x7684;&#x5171;&#x4EAB;&#x5E93;&#x4E2D;&#x81F3;&#x5C11;&#x5B58;&#x5728;&#x4E00;&#x4E2A;&#x76EE;&#x6807;&#x6A21;&#x5757;&#x5728;&#x7F16;&#x8BD1;&#x65F6;&#x6CA1;&#x6709;&#x6307;&#x5B9A;&#x2013;fPIC&#x9009;&#x9879;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ objdump --all-headers libfoo.so <span class="token operator">|</span> <span class="token function">grep</span> TEXTREL
$ readelf -d libfoo.so <span class="token operator">|</span> <span class="token function">grep</span> TEXTREL<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x5B57;&#x7B26;&#x4E32;TEXTREL&#x8868;&#x793A;&#x5B58;&#x5728;&#x4E00;&#x4E2A;&#x76EE;&#x6807;&#x6A21;&#x5757;&#xFF0C;&#x5176;&#x6587;&#x672C;&#x6BB5;&#x4E2D;&#x5305;&#x542B;&#x9700;&#x8981;&#x8FD0;&#x884C;&#x65F6;&#x91CD;&#x5B9A;&#x4F4D;&#x7684;&#x5F15;&#x7528;&#x3002;</p>
<h3 id="&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x5171;&#x4EAB;&#x5E93;"><a href="#&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x5171;&#x4EAB;&#x5E93;" class="headerlink" title="&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x5171;&#x4EAB;&#x5E93;"></a>&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x5171;&#x4EAB;&#x5E93;</h3><p>&#x4E3A;&#x4E86;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x5171;&#x4EAB;&#x5E93;&#x5C31;&#x9700;&#x8981;&#x505A;&#x4E24;&#x4EF6;&#x4E8B;&#x60C5;&#xFF0C;&#x800C;&#x4F7F;&#x7528;&#x9759;&#x6001;&#x5E93;&#x7684;&#x7A0B;&#x5E8F;&#x5219;&#x65E0;&#x9700;&#x5B8C;&#x6210;&#x8FD9;&#x4E24;&#x4EF6;&#x4E8B;&#x60C5;&#x3002;</p>
<ul>
<li>&#x7531;&#x4E8E;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x4E0D;&#x518D;&#x5305;&#x542B;&#x5B83;&#x6240;&#x9700;&#x7684;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x7684;&#x526F;&#x672C;&#xFF0C;&#x56E0;&#x6B64;&#x5B83;&#x5FC5;&#x987B;&#x8981;&#x901A;&#x8FC7;&#x67D0;&#x79CD;&#x673A;&#x5236;&#x627E;&#x51FA;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x6240;&#x9700;&#x7684;&#x5171;&#x4EAB;&#x5E93;&#x3002;&#x8FD9;&#x662F;&#x901A;&#x8FC7;&#x5728;&#x94FE;&#x63A5;&#x9636;&#x6BB5;&#x5C06;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x540D;&#x79F0;&#x5D4C;&#x5165;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x4E2D;&#x6765;&#x5B8C;&#x6210;&#x7684;&#x3002;&#xFF08;&#x5728;ELF&#x4E2D;&#xFF0C;&#x5E93;&#x4F9D;&#x8D56;&#x6027;&#x662F;&#x8BB0;&#x5F55;&#x5728;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x7684;DT_NEEDED&#x6807;&#x7B7E;&#x4E2D;&#x7684;&#x3002;&#xFF09;&#x4E00;&#x4E2A;&#x7A0B;&#x5E8F;&#x6240;&#x4F9D;&#x8D56;&#x7684;&#x6240;&#x6709;&#x5171;&#x4EAB;&#x5E93;&#x5217;&#x8868;&#x88AB;&#x79F0;&#x4E3A;&#x7A0B;&#x5E8F;&#x7684;&#x52A8;&#x6001;&#x4F9D;&#x8D56;&#x5217;&#x8868;&#x3002;</li>
<li>&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x5FC5;&#x987B;&#x8981;&#x5B58;&#x5728;&#x67D0;&#x79CD;&#x673A;&#x5236;&#x6765;&#x89E3;&#x6790;&#x5D4C;&#x5165;&#x7684;&#x5E93;&#x540D;&#x2014;&#x2014;&#x5373;&#x627E;&#x51FA;&#x4E0E;&#x5728;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x4E2D;&#x6307;&#x5B9A;&#x7684;&#x540D;&#x79F0;&#x5BF9;&#x5E94;&#x7684;&#x5171;&#x4EAB;&#x5E93;&#x6587;&#x4EF6;&#x2014;&#x2014;&#x63A5;&#x7740;&#x5982;&#x679C;&#x5E93;&#x4E0D;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#x7684;&#x8BDD;&#x5C31;&#x5C06;&#x5E93;&#x52A0;&#x8F7D;&#x8FDB;&#x5185;&#x5B58;&#x3002;</li>
</ul>
<p>&#x5C06;&#x7A0B;&#x5E8F;&#x4E0E;&#x5171;&#x4EAB;&#x5E93;&#x94FE;&#x63A5;&#x8D77;&#x6765;&#x65F6;&#x81EA;&#x52A8;&#x4F1A;&#x5C06;&#x5E93;&#x7684;&#x540D;&#x5B57;&#x5D4C;&#x5165;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x4E2D;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ gcc -g -Wall -o -prog prog.c libfoo.so<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>&#x5982;&#x679C;&#x73B0;&#x5728;&#x8FD0;&#x884C;&#x8FD9;&#x4E2A;&#x7A0B;&#x5E8F;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x4F1A;&#x6536;&#x5230;&#x4E0B;&#x9762;&#x7684;&#x9519;&#x8BEF;&#x6D88;&#x606F;&#x3002;</p>
<pre><code>$ ./prog
gcc: error: libfoo.so: No such file or directory</code></pre><p>&#x89E3;&#x51B3;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x5C31;&#x9700;&#x8981;&#x505A;&#x7B2C;&#x4E8C;&#x4EF6;&#x4E8B;&#x60C5;&#xFF1A;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#xFF0C;&#x5373;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x89E3;&#x6790;&#x5185;&#x5D4C;&#x7684;&#x5E93;&#x540D;&#x3002;&#x8FD9;&#x4E2A;&#x4EFB;&#x52A1;&#x662F;&#x7531;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#xFF08;&#x4E5F;&#x79F0;&#x4E3A;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x52A0;&#x8F7D;&#x5668;&#x6216;&#x8FD0;&#x884C;&#x65F6;&#x94FE;&#x63A5;&#x5668;&#xFF09;&#x6765;&#x5B8C;&#x6210;&#x7684;&#x3002;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x672C;&#x8EAB;&#x4E5F;&#x662F;&#x4E00;&#x4E2A;&#x5171;&#x4EAB;&#x5E93;&#xFF0C;&#x5176;&#x540D;&#x79F0;&#x4E3A;/lib/ld-linux.so.2&#xFF0C;&#x6240;&#x6709;&#x4F7F;&#x7528;&#x5171;&#x4EAB;&#x5E93;&#x7684;ELF&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x90FD;&#x4F1A;&#x7528;&#x5230;&#x8FD9;&#x4E2A;&#x5171;&#x4EAB;&#x5E93;&#x3002;</p>
<p>&#x8DEF;&#x5F84;&#x540D;/lib/ld-linux.so.2&#x901A;&#x5E38;&#x662F;&#x4E00;&#x4E2A;&#x6307;&#x5411;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x7684;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#x3002;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x7684;&#x540D;&#x79F0;&#x4E3A;ld-version.so&#xFF0C;&#x5176;&#x4E2D;version&#x8868;&#x793A;&#x5B89;&#x88C5;&#x5728;&#x7CFB;&#x7EDF;&#x4E0A;&#x7684;glibc&#x7684;&#x7248;&#x672C;&#x2014;&#x2014;&#x5982;ld-2.11.so&#x3002;&#x5728;&#x4E00;&#x4E9B;&#x67B6;&#x6784;&#x4E0A;&#xFF0C;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x7684;&#x8DEF;&#x5F84;&#x540D;&#x662F;&#x4E0D;&#x540C;&#x7684;&#x3002;&#x5982;&#x5728;IA-64&#x4E0A;&#xFF0C;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#x7684;&#x540D;&#x79F0;&#x4E3A;/lib/ld-linux-ia64.so.2&#x3002;</p>
<p>&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x4F1A;&#x68C0;&#x67E5;&#x7A0B;&#x5E8F;&#x6240;&#x9700;&#x7684;&#x5171;&#x4EAB;&#x5E93;&#x6E05;&#x5355;&#x5E76;&#x4F7F;&#x7528;&#x4E00;&#x7EC4;&#x9884;&#x5148;&#x5B9A;&#x4E49;&#x597D;&#x7684;&#x89C4;&#x5219;&#x6765;&#x5728;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x4E0A;&#x627E;&#x51FA;&#x76F8;&#x5173;&#x7684;&#x5E93;&#x6587;&#x4EF6;&#x3002;&#x5176;&#x4E2D;&#x4E00;&#x4E9B;&#x89C4;&#x5219;&#x6307;&#x5B9A;&#x4E86;&#x4E00;&#x7EC4;&#x5B58;&#x653E;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x6807;&#x51C6;&#x76EE;&#x5F55;&#x3002;&#x5982;&#x5F88;&#x591A;&#x5171;&#x4EAB;&#x5E93;&#x4F4D;&#x4E8E;/lib&#x548C;/usr/lib&#x4E2D;&#x3002;&#x4E4B;&#x6240;&#x4EE5;&#x51FA;&#x73B0;&#x4E0A;&#x9762;&#x7684;&#x9519;&#x8BEF;&#x6D88;&#x606F;&#x662F;&#x56E0;&#x4E3A;&#x7A0B;&#x5E8F;&#x6240;&#x9700;&#x7684;&#x5E93;&#x4F4D;&#x4E8E;&#x5F53;&#x524D;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;&#x4E2D;&#xFF0C;&#x800C;&#x4E0D;&#x4F4D;&#x4E8E;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x641C;&#x7D22;&#x7684;&#x6807;&#x51C6;&#x76EE;&#x5F55;&#x6E05;&#x5355;&#x4E2D;&#x3002;</p>
<p>&#x4E00;&#x4E9B;&#x67B6;&#x6784;&#xFF08;&#x5982;zSeries&#x3001;PowerPC64&#x4EE5;&#x53CA;x86-64&#xFF09;&#x540C;&#x65F6;&#x652F;&#x6301;&#x6267;&#x884C;32&#x4F4D;&#x548C;64&#x4F4D;&#x7684;&#x7A0B;&#x5E8F;&#x3002;&#x5728;&#x6B64;&#x7C7B;&#x7CFB;&#x7EDF;&#x4E0A;&#xFF0C;32&#x4F4D;&#x7684;&#x5E93;&#x4F4D;&#x4E8E;<em>/lib&#x5B50;&#x76EE;&#x5F55;&#x4E2D;&#xFF0C;64&#x4F4D;&#x7684;&#x5E93;&#x4F4D;&#x4E8E;</em>/lib64&#x5B50;&#x76EE;&#x5F55;&#x4E2D;&#x3002;</p>
<h3 id="LD-LIBRARY-PATH&#x73AF;&#x5883;&#x53D8;&#x91CF;"><a href="#LD-LIBRARY-PATH&#x73AF;&#x5883;&#x53D8;&#x91CF;" class="headerlink" title="LD_LIBRARY_PATH&#x73AF;&#x5883;&#x53D8;&#x91CF;"></a>LD_LIBRARY_PATH&#x73AF;&#x5883;&#x53D8;&#x91CF;</h3><p>&#x901A;&#x77E5;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x4E00;&#x4E2A;&#x5171;&#x4EAB;&#x5E93;&#x4F4D;&#x4E8E;&#x4E00;&#x4E2A;&#x975E;&#x6807;&#x51C6;&#x76EE;&#x5F55;&#x4E2D;&#x7684;&#x4E00;&#x79CD;&#x65B9;&#x6CD5;&#x662F;&#x5C06;&#x8BE5;&#x76EE;&#x5F55;&#x6DFB;&#x52A0;&#x5230;LD_LIBRARY_PATH&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x4E2D;&#x4EE5;&#x5206;&#x53F7;&#x5206;&#x9694;&#x7684;&#x76EE;&#x5F55;&#x5217;&#x8868;&#x4E2D;&#x3002;&#xFF08;&#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5206;&#x53F7;&#x6765;&#x5206;&#x9694;&#xFF0C;&#x5728;&#x4F7F;&#x7528;&#x5206;&#x53F7;&#x65F6;&#x5FC5;&#x987B;&#x5C06;&#x5217;&#x8868;&#x653E;&#x5728;&#x5F15;&#x53F7;&#x4E2D;&#x4EE5;&#x9632;&#x6B62;shell&#x5C06;&#x5206;&#x53F7;&#x89E3;&#x91CA;&#x4E86;&#x5176;&#x4ED6;&#x7528;&#x9014;&#x3002;&#xFF09;&#x5982;&#x679C;&#x5B9A;&#x4E49;&#x4E86;LD_LIBRARY_PATH&#xFF0C;&#x90A3;&#x4E48;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x5728;&#x67E5;&#x627E;&#x6807;&#x51C6;&#x5E93;&#x76EE;&#x5F55;&#x4E4B;&#x524D;&#x4F1A;&#x5148;&#x67E5;&#x627E;&#x8BE5;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x5217;&#x51FA;&#x7684;&#x76EE;&#x5F55;&#x4E2D;&#x7684;&#x5171;&#x4EAB;&#x5E93;&#x3002;&#xFF08;&#x7A0D;&#x540E;&#x4F1A;&#x4ECB;&#x7ECD;&#x4E00;&#x4E2A;&#x751F;&#x4EA7;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x6C38;&#x8FDC;&#x90FD;&#x4E0D;&#x5E94;&#x8BE5;&#x4F9D;&#x8D56;&#x4E8E;LD_LIBRARY_PATH&#xFF0C;&#x4F46;&#x6B64;&#x523B;&#x901A;&#x8FC7;&#x8FD9;&#x4E2A;&#x53D8;&#x91CF;&#x53EF;&#x4EE5;&#x65B9;&#x4FBF;&#x5730;&#x5F00;&#x59CB;&#x4F7F;&#x7528;&#x5171;&#x4EAB;&#x5E93;&#x4E86;&#x3002;&#xFF09;&#x56E0;&#x6B64;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4E0B;&#x9762;&#x7684;&#x547D;&#x4EE4;&#x6765;&#x8FD0;&#x884C;&#x7A0B;&#x5E8F;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ LD_LIBRARY_PATH<span class="token operator">=</span>. ./prog
Called mod1-x1
Called mod2-x2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x4E0A;&#x9762;&#x7684;&#x547D;&#x4EE4;&#x4E2D;&#x4F7F;&#x7528;&#x7684;shell&#xFF08;bash&#x3001;Korn&#x4EE5;&#x53CA;Bourne&#xFF09;&#x8BED;&#x6CD5;&#x5728;&#x6267;&#x884C;prog&#x7684;&#x8FDB;&#x7A0B;&#x4E2D;&#x521B;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x5B9A;&#x4E49;&#x3002;&#x8FD9;&#x4E2A;&#x5B9A;&#x4E49;&#x544A;&#x8BC9;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x5728;.&#xFF0C;&#x5373;&#x5F53;&#x524D;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;&#x4E2D;&#x641C;&#x7D22;&#x5171;&#x4EAB;&#x5E93;&#x3002;</p>
<p>&#x5728;LD_LIBRARY_PATH&#x5217;&#x8868;&#x4E2D;&#x7684;&#x7A7A;&#x76EE;&#x5F55;&#xFF08;&#x5982;dirx::diry&#x4E2D;&#x95F4;&#x7684;&#x7A7A;&#x76EE;&#x5F55;&#xFF09;&#x7B49;&#x4EF7;&#x4E8E;.&#xFF0C;&#x5373;&#x5F53;&#x524D;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;&#xFF08;&#x4F46;&#x6CE8;&#x610F;&#x5C06;LD_LIBRARY_PATH&#x7684;&#x503C;&#x8BBE;&#x7F6E;&#x4E3A;&#x7A7A;&#x5B57;&#x7B26;&#x4E32;&#x5E76;&#x4E0D;&#x80FD;&#x8FBE;&#x5230;&#x540C;&#x6837;&#x6548;&#x679C;&#xFF09;&#x3002;&#x9700;&#x8981;&#x907F;&#x514D;&#x8FD9;&#x79CD;&#x7528;&#x6CD5;&#xFF08;SUSv3&#x540C;&#x6837;&#x4E0D;&#x5EFA;&#x8BAE;&#x5728;PATH&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x4E2D;&#x4F7F;&#x7528;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#xFF09;&#x3002;</p>
<h3 id="&#x9759;&#x6001;&#x94FE;&#x63A5;&#x548C;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x6BD4;&#x8F83;"><a href="#&#x9759;&#x6001;&#x94FE;&#x63A5;&#x548C;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x6BD4;&#x8F83;" class="headerlink" title="&#x9759;&#x6001;&#x94FE;&#x63A5;&#x548C;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x6BD4;&#x8F83;"></a>&#x9759;&#x6001;&#x94FE;&#x63A5;&#x548C;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x6BD4;&#x8F83;</h3><p>&#x901A;&#x5E38;&#xFF0C;&#x672F;&#x8BED;&#x94FE;&#x63A5;&#x7528;&#x6765;&#x8868;&#x793A;&#x4F7F;&#x7528;&#x94FE;&#x63A5;&#x5668;ld&#x5C06;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x7F16;&#x8BD1;&#x8FC7;&#x7684;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x7EC4;&#x5408;&#x6210;&#x4E00;&#x4E2A;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x3002;&#x6709;&#x65F6;&#x5019;&#x4F1A;&#x4F7F;&#x7528;&#x672F;&#x8BED;&#x9759;&#x6001;&#x94FE;&#x63A5;&#x4ECE;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x4E2D;&#x5C06;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x52A0;&#x8F7D;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x6240;&#x9700;&#x7684;&#x5171;&#x4EAB;&#x5E93;&#x8FD9;&#x4E00;&#x6B65;&#x9AA4;&#x7ED9;&#x533A;&#x5206;&#x51FA;&#x6765;&#x3002;&#xFF08;&#x9759;&#x6001;&#x94FE;&#x63A5;&#x6709;&#x65F6;&#x5019;&#x4E5F;&#x88AB;&#x79F0;&#x4E3A;&#x94FE;&#x63A5;&#x7F16;&#x8F91;&#xFF0C;&#x50CF;ld&#x8FD9;&#x6837;&#x7684;&#x9759;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x6709;&#x65F6;&#x5019;&#x88AB;&#x79F0;&#x4E3A;&#x94FE;&#x63A5;&#x7F16;&#x8F91;&#x5668;&#x3002;&#xFF09;&#x6BCF;&#x4E2A;&#x7A0B;&#x5E8F;&#x2014;&#x2014;&#x5305;&#x62EC;&#x90A3;&#x4E9B;&#x4F7F;&#x7528;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x7A0B;&#x5E8F;&#x2014;&#x2014;&#x90FD;&#x4F1A;&#x7ECF;&#x5386;&#x4E00;&#x4E2A;&#x9759;&#x6001;&#x94FE;&#x63A5;&#x7684;&#x9636;&#x6BB5;&#x3002;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#xFF0C;&#x4F7F;&#x7528;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x7A0B;&#x5E8F;&#x4F1A;&#x7ECF;&#x5386;&#x989D;&#x5916;&#x7684;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x9636;&#x6BB5;&#x3002;</p>
<h3 id="&#x5171;&#x4EAB;&#x5E93;soname"><a href="#&#x5171;&#x4EAB;&#x5E93;soname" class="headerlink" title="&#x5171;&#x4EAB;&#x5E93;soname"></a>&#x5171;&#x4EAB;&#x5E93;soname</h3><p>&#x5230;&#x76EE;&#x524D;&#x4E3A;&#x6B62;&#x4ECB;&#x7ECD;&#x7684;&#x6240;&#x6709;&#x4F8B;&#x5B50;&#x4E2D;&#xFF0C;&#x5D4C;&#x5165;&#x5230;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x4EE5;&#x53CA;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x641C;&#x7D22;&#x7684;&#x540D;&#x79F0;&#x662F;&#x5171;&#x4EAB;&#x5E93;&#x6587;&#x4EF6;&#x7684;&#x5B9E;&#x9645;&#x540D;&#x79F0;&#xFF0C;&#x8FD9;&#x88AB;&#x79F0;&#x4E3A;&#x5E93;&#x7684;&#x771F;&#x5B9E;&#x540D;&#x79F0;&#xFF08;real name&#xFF09;&#x3002;&#x4F46;&#x53EF;&#x4EE5;&#x2014;&#x2014;&#x5B9E;&#x9645;&#x4E0A;&#x7ECF;&#x5E38;&#x8FD9;&#x6837;&#x505A;&#x2014;&#x2014;&#x4F7F;&#x7528;&#x522B;&#x540D;&#x6765;&#x521B;&#x5EFA;&#x5171;&#x4EAB;&#x5E93;&#xFF0C;&#x8FD9;&#x79CD;&#x522B;&#x540D;&#x79F0;&#x4E3A;soname&#xFF08;ELF&#x4E2D;&#x7684;DT_SONAME&#x6807;&#x7B7E;&#xFF09;&#x3002;<br>&#x5982;&#x679C;&#x5171;&#x4EAB;&#x5E93;&#x62E5;&#x6709;&#x4E00;&#x4E2A;soname&#xFF0C;&#x90A3;&#x4E48;&#x5728;&#x9759;&#x6001;&#x94FE;&#x63A5;&#x9636;&#x6BB5;&#x4F1A;&#x5C06;soname&#x5D4C;&#x5165;&#x5230;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x4E2D;&#xFF0C;&#x800C;&#x4E0D;&#x4F1A;&#x4F7F;&#x7528;&#x771F;&#x5B9E;&#x540D;&#x79F0;&#xFF0C;&#x540C;&#x65F6;&#x540E;&#x9762;&#x7684;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x4E5F;&#x4F1A;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;soname&#x6765;&#x641C;&#x7D22;&#x5E93;&#x3002;&#x5F15;&#x5165;soname&#x7684;&#x76EE;&#x7684;&#x662F;&#x4E3A;&#x4E86;&#x63D0;&#x4F9B;&#x4E00;&#x5C42;&#x95F4;&#x63A5;&#xFF0C;&#x4F7F;&#x5F97;&#x53EF;&#x6267;&#x884C;&#x7A0B;&#x5E8F;&#x80FD;&#x591F;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x4F7F;&#x7528;&#x4E0E;&#x94FE;&#x63A5;&#x65F6;&#x4F7F;&#x7528;&#x7684;&#x5E93;&#x4E0D;&#x540C;&#x7684;&#xFF08;&#x4F46;&#x517C;&#x5BB9;&#x7684;&#xFF09;&#x5171;&#x4EAB;&#x5E93;&#x3002;</p>
<p>&#x4F7F;&#x7528;soname&#x7684;&#x7B2C;&#x4E00;&#x6B65;&#x662F;&#x5728;&#x521B;&#x5EFA;&#x5171;&#x4EAB;&#x5E93;&#x65F6;&#x6307;&#x5B9A;soname&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ gcc -g -c -fPIC -Wall mod1.c mod2.c mod3.c
$ gcc -g -shared -Wl,-soname,libbar.so -o libfoo.so mod1.o mod2.o mod3.o<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x2013;Wl&#x3001;&#x2013;soname&#x4EE5;&#x53CA;libbar.so&#x9009;&#x9879;&#x662F;&#x4F20;&#x7ED9;&#x94FE;&#x63A5;&#x5668;&#x7684;&#x6307;&#x4EE4;&#x4EE5;&#x5C06;&#x5171;&#x4EAB;&#x5E93;libfoo.so&#x7684;soname&#x8BBE;&#x7F6E;&#x4E3A;libbar.so&#x3002;</p>
<p>&#x5982;&#x679C;&#x8981;&#x786E;&#x5B9A;&#x4E00;&#x4E2A;&#x65E2;&#x6709;&#x5171;&#x4EAB;&#x5E93;&#x7684;soname&#xFF0C;&#x90A3;&#x4E48;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4E0B;&#x9762;&#x4E24;&#x4E2A;&#x547D;&#x4EE4;&#x4E2D;&#x7684;&#x4EFB;&#x610F;&#x4E00;&#x4E2A;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ objdump -p libfoo.so <span class="token operator">|</span> <span class="token function">grep</span> SONAME
  SONAME     libbar.so
$ readelf -d libfoo.so <span class="token operator">|</span> <span class="token function">grep</span> SONAME
0x0000000e <span class="token punctuation">(</span>SONAME<span class="token punctuation">)</span>       Library soname:<span class="token punctuation">[</span>libbar.so<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x5728;&#x4F7F;&#x7528;soname&#x521B;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A;&#x5171;&#x4EAB;&#x5E93;&#x4E4B;&#x540E;&#x5C31;&#x53EF;&#x4EE5;&#x7167;&#x5E38;&#x521B;&#x5EFA;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x4E86;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ gcc -g -Wall -o prog.c libfoo.so<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>&#x4F46;&#x8FD9;&#x6B21;&#x94FE;&#x63A5;&#x5668;&#x68C0;&#x67E5;&#x5230;&#x5E93;libfoo.so&#x5305;&#x542B;&#x4E86;soname libbar.so&#xFF0C;&#x4E8E;&#x662F;&#x5C06;&#x8FD9;&#x4E2A;soname&#x5D4C;&#x5165;&#x5230;&#x4E86;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x4E2D;&#x3002;<br>&#x73B0;&#x5728;&#x5F53;&#x8FD0;&#x884C;&#x8FD9;&#x4E2A;&#x7A0B;&#x5E8F;&#x65F6;&#x5C31;&#x4F1A;&#x770B;&#x5230;&#x4E0B;&#x9762;&#x7684;&#x8F93;&#x51FA;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">gcc: error: libbar.so: No such <span class="token function">file</span> or directory<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>&#x8FD9;&#x91CC;&#x7684;&#x95EE;&#x9898;&#x662F;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x65E0;&#x6CD5;&#x627E;&#x5230;&#x540D;&#x4E3A;libbar.so&#x5171;&#x4EAB;&#x5E93;&#x3002;&#x5F53;&#x4F7F;&#x7528;soname&#x65F6;&#x8FD8;&#x9700;&#x8981;&#x505A;&#x4E00;&#x4EF6;&#x4E8B;&#x60C5;&#xFF1A;&#x5FC5;&#x987B;&#x8981;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#x5C06;soname&#x6307;&#x5411;&#x5E93;&#x7684;&#x771F;&#x5B9E;&#x540D;&#x79F0;&#xFF0C;&#x5E76;&#x4E14;&#x5FC5;&#x987B;&#x8981;&#x5C06;&#x8FD9;&#x4E2A;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#x653E;&#x5728;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x641C;&#x7D22;&#x7684;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x76EE;&#x5F55;&#x4E2D;&#x3002;&#x56E0;&#x6B64;&#x53EF;&#x4EE5;&#x50CF;&#x4E0B;&#x9762;&#x8FD9;&#x6837;&#x8FD0;&#x884C;&#x8FD9;&#x4E2A;&#x7A0B;&#x5E8F;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">ln</span> -s libfoo.so libbar.so
$ LD_LIBRARY_PATH<span class="token operator">=</span>. ./prog
Called mod1-x1
Called mod2-x2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x4E0B;&#x56FE;&#x7ED9;&#x51FA;&#x4E86;&#x5728;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x5185;&#x5D4C;&#x7684;soname&#xFF0C;&#x5C06;&#x7A0B;&#x5E8F;&#x4E0E;&#x5171;&#x4EAB;&#x5E93;&#x94FE;&#x63A5;&#x8D77;&#x6765;&#xFF0C;&#x4EE5;&#x53CA;&#x521B;&#x5EFA;&#x8FD0;&#x884C;&#x7A0B;&#x5E8F;&#x6240;&#x9700;&#x7684;soname&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#x65F6;&#x6240;&#x6D89;&#x53CA;&#x5230;&#x7684;&#x7F16;&#x8BD1;&#x548C;&#x94FE;&#x63A5;&#x4E8B;&#x9879;&#x3002;<br></p><div class="amp-img-wrapper"><amp-img src="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1581764030752.png?x-oss-process=image/resize,m_lfit,h_450" width="382" height="450" layout="responsive"></amp-img></div>
<p>&#x4E0B;&#x56FE;&#x7ED9;&#x51FA;&#x4E86;&#x5F53;&#x56FE;41-1&#x4E2D;&#x521B;&#x5EFA;&#x7684;&#x7A0B;&#x5E8F;&#x88AB;&#x52A0;&#x8F7D;&#x8FDB;&#x5185;&#x5B58;&#x4EE5;&#x5907;&#x6267;&#x884C;&#x65F6;&#x53D1;&#x751F;&#x7684;&#x4E8B;&#x60C5;&#x3002;<br></p><div class="amp-img-wrapper"><amp-img src="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1581764096709.png?x-oss-process=image/resize,m_lfit,h_450" width="406" height="450" layout="responsive"></amp-img></div>
<p>&#x8981;&#x627E;&#x51FA;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x5F53;&#x524D;&#x4F7F;&#x7528;&#x7684;&#x5171;&#x4EAB;&#x5E93;&#x5219;&#x53EF;&#x4EE5;&#x5217;&#x51FA;&#x76F8;&#x5E94;&#x7684;Linux&#x7279;&#x6709;&#x7684;/proc/PID/maps&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x5185;&#x5BB9;&#x3002;</p>
<h2 id="&#x4F7F;&#x7528;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x6709;&#x7528;&#x5DE5;&#x5177;"><a href="#&#x4F7F;&#x7528;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x6709;&#x7528;&#x5DE5;&#x5177;" class="headerlink" title="&#x4F7F;&#x7528;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x6709;&#x7528;&#x5DE5;&#x5177;"></a>&#x4F7F;&#x7528;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x6709;&#x7528;&#x5DE5;&#x5177;</h2><p>&#x672C;&#x8282;&#x5C06;&#x7B80;&#x8981;&#x4ECB;&#x7ECD;&#x5BF9;&#x5206;&#x6790;&#x5171;&#x4EAB;&#x5E93;&#x3001;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x4EE5;&#x53CA;&#x7F16;&#x8BD1;&#x8FC7;&#x7684;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#xFF08;.o&#xFF09;&#x6709;&#x7528;&#x7684;&#x4E00;&#x7EC4;&#x5DE5;&#x5177;&#x3002;</p>
<h3 id="ldd&#x547D;&#x4EE4;"><a href="#ldd&#x547D;&#x4EE4;" class="headerlink" title="ldd&#x547D;&#x4EE4;"></a>ldd&#x547D;&#x4EE4;</h3><p>ldd(1)&#xFF08;&#x5217;&#x51FA;&#x52A8;&#x6001;&#x4F9D;&#x8D56;&#xFF09;&#x547D;&#x4EE4;&#x663E;&#x793A;&#x4E86;&#x4E00;&#x4E2A;&#x7A0B;&#x5E8F;&#x8FD0;&#x884C;&#x6240;&#x9700;&#x7684;&#x5171;&#x4EAB;&#x5E93;&#xFF0C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ ldd prog
    libdemo.so.1 <span class="token operator">=</span><span class="token operator">&gt;</span> /usr/lib/libdemo.so.1<span class="token punctuation">(</span>0x40019000<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>ldd&#x547D;&#x4EE4;&#x4F1A;&#x89E3;&#x6790;&#x51FA;&#x6BCF;&#x4E2A;&#x5E93;&#x5F15;&#x7528;&#xFF08;&#x4F7F;&#x7528;&#x7684;&#x641C;&#x7D22;&#x65B9;&#x5F0F;&#x4E0E;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x4E00;&#x6837;&#xFF09;&#x5E76;&#x4EE5;&#x4E0B;&#x9762;&#x7684;&#x5F62;&#x5F0F;&#x663E;&#x793A;&#x7ED3;&#x679C;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">library-name <span class="token operator">=</span><span class="token operator">&gt;</span> resolves-to-path<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>&#x5BF9;&#x4E8E;&#x5927;&#x591A;&#x6570;ELF&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x6765;&#x8BB2;&#xFF0C;ldd&#x81F3;&#x5C11;&#x4F1A;&#x5217;&#x51FA;&#x4E0E;ld-linux.so.2&#x3001;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x4EE5;&#x53CA;&#x6807;&#x51C6;C&#x5E93;libc.so.6&#x76F8;&#x5173;&#x7684;&#x6761;&#x76EE;&#x3002;<br>&#x5728;&#x4E00;&#x4E9B;&#x67B6;&#x6784;&#x4E0A;&#xFF0C;C&#x5E93;&#x7684;&#x540D;&#x79F0;&#x662F;&#x4E0D;&#x540C;&#x7684;&#x3002;&#x5982;&#x5728;IA-64&#x548C;Alpha&#x4E0A;&#xFF0C;&#x8FD9;&#x4E2A;&#x5E93;&#x7684;&#x540D;&#x79F0;&#x662F;libc.so.6.1&#x3002;</p>
<h3 id="objdump&#x548C;readelf&#x547D;&#x4EE4;"><a href="#objdump&#x548C;readelf&#x547D;&#x4EE4;" class="headerlink" title="objdump&#x548C;readelf&#x547D;&#x4EE4;"></a>objdump&#x548C;readelf&#x547D;&#x4EE4;</h3><p>objdump&#x547D;&#x4EE4;&#x80FD;&#x591F;&#x7528;&#x6765;&#x83B7;&#x53D6;&#x5404;&#x7C7B;&#x4FE1;&#x606F;&#x2014;&#x2014;&#x5305;&#x62EC;&#x53CD;&#x6C47;&#x7F16;&#x7684;&#x4E8C;&#x8FDB;&#x5236;&#x673A;&#x5668;&#x7801;&#x2014;&#x2014;&#x4ECE;&#x4E00;&#x4E2A;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x3001;&#x7F16;&#x8BD1;&#x8FC7;&#x7684;&#x76EE;&#x6807;&#x4EE5;&#x53CA;&#x5171;&#x4EAB;&#x5E93;&#x4E2D;&#x3002;&#x5B83;&#x8FD8;&#x80FD;&#x591F;&#x7528;&#x6765;&#x663E;&#x793A;&#x8FD9;&#x4E9B;&#x6587;&#x4EF6;&#x4E2D;&#x5404;&#x4E2A;ELF&#x8282;&#x7684;&#x5934;&#x90E8;&#x4FE1;&#x606F;&#xFF0C;&#x5F53;&#x8FD9;&#x6837;&#x4F7F;&#x7528;objdump&#x65F6;&#x5B83;&#x5C31;&#x7C7B;&#x4F3C;&#x4E8E;readelf&#xFF0C;readelf&#x80FD;&#x663E;&#x793A;&#x7C7B;&#x4F3C;&#x7684;&#x4FE1;&#x606F;&#xFF0C;&#x4F46;&#x663E;&#x793A;&#x683C;&#x5F0F;&#x4E0D;&#x540C;&#x3002;</p>
<h3 id="nm&#x547D;&#x4EE4;"><a href="#nm&#x547D;&#x4EE4;" class="headerlink" title="nm&#x547D;&#x4EE4;"></a>nm&#x547D;&#x4EE4;</h3><p>nm&#x547D;&#x4EE4;&#x4F1A;&#x5217;&#x51FA;&#x76EE;&#x6807;&#x5E93;&#x6216;&#x53EF;&#x6267;&#x884C;&#x7A0B;&#x5E8F;&#x4E2D;&#x5B9A;&#x4E49;&#x7684;&#x4E00;&#x7EC4;&#x7B26;&#x53F7;&#x3002;&#x8FD9;&#x4E2A;&#x547D;&#x4EE4;&#x7684;&#x4E00;&#x79CD;&#x7528;&#x9014;&#x662F;&#x627E;&#x51FA;&#x54EA;&#x4E9B;&#x5E93;&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x4E2A;&#x7B26;&#x53F7;&#x3002;&#x5982;&#x8981;&#x627E;&#x51FA;&#x54EA;&#x4E2A;&#x5E93;&#x5B9A;&#x4E49;&#x4E86;crypt()&#x51FD;&#x6570;&#x5219;&#x53EF;&#x4EE5;&#x50CF;&#x4E0B;&#x9762;&#x8FD9;&#x6837;&#x505A;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ nm -A /usr/lib/lib*.so 2<span class="token operator">&gt;</span> /dev/null <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&apos;crypt$&apos;</span>
/usr/lib/libcrypt.so:00007080 W crypt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>nm&#x7684;&#x2013;A&#x9009;&#x9879;&#x6307;&#x5B9A;&#x4E86;&#x5728;&#x663E;&#x793A;&#x7B26;&#x53F7;&#x7684;&#x6BCF;&#x4E00;&#x884C;&#x7684;&#x5F00;&#x5934;&#x5904;&#x5E94;&#x8BE5;&#x5217;&#x51FA;&#x5E93;&#x7684;&#x540D;&#x79F0;&#x3002;&#x8FD9;&#x6837;&#x505A;&#x662F;&#x6709;&#x5FC5;&#x8981;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#x5728;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;nm&#x53EA;&#x5217;&#x51FA;&#x5E93;&#x540D;&#x4E00;&#x6B21;&#xFF0C;&#x7136;&#x540E;&#x5728;&#x540E;&#x9762;&#x4F1A;&#x5217;&#x51FA;&#x5E93;&#x4E2D;&#x5305;&#x542B;&#x7684;&#x6240;&#x6709;&#x7B26;&#x53F7;&#xFF0C;&#x8FD9;&#x5BF9;&#x4E8E;&#x50CF;&#x4E0A;&#x9762;&#x90A3;&#x6837;&#x8FDB;&#x884C;&#x67D0;&#x79CD;&#x8FC7;&#x6EE4;&#x7684;&#x4F8B;&#x5B50;&#x6765;&#x8BB2;&#x662F;&#x6CA1;&#x6709;&#x7528;&#x5904;&#x7684;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x8FD9;&#x91CC;&#x8FD8;&#x4E22;&#x5F03;&#x4E86;&#x6807;&#x51C6;&#x9519;&#x8BEF;&#x8F93;&#x51FA;&#x4EE5;&#x4FBF;&#x9690;&#x85CF;&#x4E0E;nm&#x547D;&#x4EE4;&#x65E0;&#x6CD5;&#x8BC6;&#x522B;&#x6587;&#x4EF6;&#x683C;&#x5F0F;&#x6709;&#x5173;&#x7684;&#x9519;&#x8BEF;&#x6D88;&#x606F;&#x3002;&#x4ECE;&#x4E0A;&#x9762;&#x7684;&#x8F93;&#x51FA;&#x4E2D;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF0C;crypt()&#x88AB;&#x5B9A;&#x4E49;&#x5728;&#x4E86;libcrypt&#x5E93;&#x4E2D;&#x3002;</p>
<h2 id="&#x5171;&#x4EAB;&#x5E93;&#x7248;&#x672C;&#x548C;&#x547D;&#x540D;&#x89C4;&#x5219;"><a href="#&#x5171;&#x4EAB;&#x5E93;&#x7248;&#x672C;&#x548C;&#x547D;&#x540D;&#x89C4;&#x5219;" class="headerlink" title="&#x5171;&#x4EAB;&#x5E93;&#x7248;&#x672C;&#x548C;&#x547D;&#x540D;&#x89C4;&#x5219;"></a>&#x5171;&#x4EAB;&#x5E93;&#x7248;&#x672C;&#x548C;&#x547D;&#x540D;&#x89C4;&#x5219;</h2><p>&#x4E0B;&#x9762;&#x8003;&#x8651;&#x5728;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x7248;&#x672C;&#x5316;&#x8FC7;&#x7A0B;&#x4E2D;&#x9700;&#x8981;&#x505A;&#x7684;&#x4E8B;&#x60C5;&#x3002;&#x4E00;&#x822C;&#x6765;&#x8BB2;&#xFF0C;&#x4E00;&#x4E2A;&#x5171;&#x4EAB;&#x5E93;&#x76F8;&#x4E92;&#x8FDE;&#x7EED;&#x7684;&#x4E24;&#x4E2A;&#x7248;&#x672C;&#x662F;&#x76F8;&#x4E92;&#x517C;&#x5BB9;&#x7684;&#xFF0C;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x6BCF;&#x4E2A;&#x6A21;&#x5757;&#x4E2D;&#x7684;&#x51FD;&#x6570;&#x5BF9;&#x5916;&#x5448;&#x73B0;&#x51FA;&#x6765;&#x7684;&#x8C03;&#x7528;&#x63A5;&#x53E3;&#x662F;&#x4E00;&#x81F4;&#x7684;&#xFF0C;&#x5E76;&#x4E14;&#x51FD;&#x6570;&#x7684;&#x8BED;&#x4E49;&#x662F;&#x7B49;&#x4EF7;&#x7684;&#xFF08;&#x5373;&#x5B83;&#x4EEC;&#x80FD;&#x53D6;&#x5F97;&#x540C;&#x6837;&#x7684;&#x7ED3;&#x679C;&#xFF09;&#x3002;&#x8FD9;&#x79CD;&#x7248;&#x672C;&#x53F7;&#x4E0D;&#x540C;&#x4F46;&#x76F8;&#x4E92;&#x517C;&#x5BB9;&#x7684;&#x7248;&#x672C;&#x88AB;&#x79F0;&#x4E3A;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x6B21;&#x8981;&#x7248;&#x672C;&#x3002;&#x4F46;&#x6709;&#x65F6;&#x5019;&#x9700;&#x8981;&#x521B;&#x5EFA;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5E93;&#x7684;&#x65B0;&#x4E3B;&#x7248;&#x672C;&#x2014;&#x2014;&#x5373;&#x4E0E;&#x4E0A;&#x4E00;&#x4E2A;&#x7248;&#x672C;&#x4E0D;&#x517C;&#x5BB9;&#x7684;&#x7248;&#x672C;&#x3002;&#x540C;&#x65F6;&#xFF0C;&#x5FC5;&#x987B;&#x8981;&#x786E;&#x4FDD;&#x4F7F;&#x7528;&#x8001;&#x7248;&#x672C;&#x7684;&#x5E93;&#x7684;&#x7A0B;&#x5E8F;&#x4ECD;&#x7136;&#x80FD;&#x591F;&#x8FD0;&#x884C;&#x3002;&#x4E3A;&#x4E86;&#x6EE1;&#x8DB3;&#x8FD9;&#x4E9B;&#x7248;&#x672C;&#x5316;&#x7684;&#x8981;&#x6C42;&#xFF0C;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x771F;&#x5B9E;&#x540D;&#x79F0;&#x548C;soname&#x5FC5;&#x987B;&#x8981;&#x4F7F;&#x7528;&#x4E00;&#x79CD;&#x6807;&#x51C6;&#x7684;&#x547D;&#x540D;&#x89C4;&#x8303;&#x3002;</p>
<h3 id="&#x771F;&#x5B9E;&#x540D;&#x79F0;&#x3001;soname&#x4EE5;&#x53CA;&#x94FE;&#x63A5;&#x5668;&#x540D;&#x79F0;"><a href="#&#x771F;&#x5B9E;&#x540D;&#x79F0;&#x3001;soname&#x4EE5;&#x53CA;&#x94FE;&#x63A5;&#x5668;&#x540D;&#x79F0;" class="headerlink" title="&#x771F;&#x5B9E;&#x540D;&#x79F0;&#x3001;soname&#x4EE5;&#x53CA;&#x94FE;&#x63A5;&#x5668;&#x540D;&#x79F0;"></a>&#x771F;&#x5B9E;&#x540D;&#x79F0;&#x3001;soname&#x4EE5;&#x53CA;&#x94FE;&#x63A5;&#x5668;&#x540D;&#x79F0;</h3><p>&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x6BCF;&#x4E2A;&#x4E0D;&#x517C;&#x5BB9;&#x7248;&#x672C;&#x662F;&#x901A;&#x8FC7;&#x4E00;&#x4E2A;&#x552F;&#x4E00;&#x7684;&#x4E3B;&#x8981;&#x7248;&#x672C;&#x6807;&#x8BC6;&#x7B26;&#x6765;&#x533A;&#x5206;&#x7684;&#xFF0C;&#x8FD9;&#x4E2A;&#x4E3B;&#x8981;&#x7248;&#x672C;&#x6807;&#x8BC6;&#x7B26;&#x662F;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x771F;&#x5B9E;&#x540D;&#x79F0;&#x7684;&#x4E00;&#x90E8;&#x5206;&#x3002;&#x6839;&#x636E;&#x60EF;&#x4F8B;&#xFF0C;&#x4E3B;&#x8981;&#x7248;&#x672C;&#x6807;&#x8BC6;&#x7B26;&#x7531;&#x4E00;&#x4E2A;&#x6570;&#x5B57;&#x6784;&#x6210;&#xFF0C;&#x8FD9;&#x4E2A;&#x6570;&#x5B57;&#x968F;&#x7740;&#x5E93;&#x7684;&#x6BCF;&#x4E2A;&#x4E0D;&#x517C;&#x5BB9;&#x7248;&#x672C;&#x7684;&#x53D1;&#x5E03;&#x800C;&#x987A;&#x5E8F;&#x9012;&#x589E;&#x3002;&#x9664;&#x4E86;&#x4E3B;&#x8981;&#x7248;&#x672C;&#x6807;&#x8BC6;&#x7B26;&#x4E4B;&#x5916;&#xFF0C;&#x771F;&#x5B9E;&#x540D;&#x79F0;&#x8FD8;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x6B21;&#x8981;&#x7248;&#x672C;&#x6807;&#x8BC6;&#x7B26;&#xFF0C;&#x5B83;&#x7528;&#x6765;&#x533A;&#x5206;&#x5E93;&#x7684;&#x4E3B;&#x8981;&#x7248;&#x672C;&#x4E2D;&#x517C;&#x5BB9;&#x7684;&#x6B21;&#x8981;&#x7248;&#x672C;&#x3002;&#x771F;&#x5B9E;&#x540D;&#x79F0;&#x7684;&#x683C;&#x5F0F;&#x89C4;&#x8303;&#x4E3A;libname.so.major-id.minor-id&#x3002;</p>
<p>&#x4E0E;&#x4E3B;&#x8981;&#x7248;&#x672C;&#x6807;&#x8BC6;&#x7B26;&#x4E00;&#x6837;&#xFF0C;&#x6B21;&#x8981;&#x7248;&#x672C;&#x6807;&#x8BC6;&#x7B26;&#x53EF;&#x4EE5;&#x662F;&#x4EFB;&#x610F;&#x5B57;&#x7B26;&#x4E32;&#x3002;&#x4F46;&#x6839;&#x636E;&#x60EF;&#x4F8B;&#xFF0C;&#x5B83;&#x8981;&#x4E48;&#x662F;&#x4E00;&#x4E2A;&#x6570;&#x5B57;&#xFF0C;&#x8981;&#x4E48;&#x662F;&#x4E24;&#x4E2A;&#x7531;&#x70B9;&#x5206;&#x9694;&#x7684;&#x6570;&#x5B57;&#xFF0C;&#x5176;&#x4E2D;&#x7B2C;&#x4E00;&#x4E2A;&#x6570;&#x5B57;&#x6807;&#x8BC6;&#x51FA;&#x4E86;&#x6B21;&#x8981;&#x7248;&#x672C;&#xFF0C;&#x7B2C;&#x4E8C;&#x4E2A;&#x6570;&#x5B57;&#x8868;&#x793A;&#x8BE5;&#x6B21;&#x8981;&#x7248;&#x672C;&#x4E2D;&#x7684;&#x8865;&#x4E01;&#x53F7;&#x6216;&#x4FEE;&#x8BA2;&#x53F7;&#x3002;&#x4E0B;&#x9762;&#x662F;&#x4E00;&#x4E9B;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x771F;&#x5B9E;&#x540D;&#x79F0;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">libdemo.so.1.0.1
libdemo.so.1.0.2
libdemo.so.2.0.0
libreadline.so.5.0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x5171;&#x4EAB;&#x5E93;&#x7684;soname&#x5305;&#x62EC;&#x76F8;&#x5E94;&#x7684;&#x771F;&#x5B9E;&#x540D;&#x79F0;&#x4E2D;&#x7684;&#x4E3B;&#x8981;&#x7248;&#x672C;&#x6807;&#x8BC6;&#x7B26;&#xFF0C;&#x4F46;&#x4E0D;&#x5305;&#x542B;&#x6B21;&#x8981;&#x7248;&#x672C;&#x6807;&#x8BC6;&#x7B26;&#x3002;&#x56E0;&#x6B64;soname&#x7684;&#x5F62;&#x5F0F;&#x4E3A;libname.so.major-id&#x3002;</p>
<p>&#x901A;&#x5E38;&#xFF0C;&#x4F1A;&#x5C06;soname&#x521B;&#x5EFA;&#x4E3A;&#x5305;&#x542B;&#x771F;&#x5B9E;&#x540D;&#x79F0;&#x7684;&#x76EE;&#x5F55;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x76F8;&#x5BF9;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#x3002;&#x4E0B;&#x9762;&#x662F;&#x4E00;&#x4E9B;soname&#x7684;&#x4F8B;&#x5B50;&#x4EE5;&#x53CA;&#x5B83;&#x4EEC;&#x53EF;&#x80FD;&#x901A;&#x8FC7;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#x6307;&#x5411;&#x7684;&#x771F;&#x5B9E;&#x540D;&#x79F0;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">libdemo.so.1       -<span class="token operator">&gt;</span> libdemo.so.1.0.2
libdemo.so.2       -<span class="token operator">&gt;</span> libdemo.so.2.0.0
libreadline.so.5   -<span class="token operator">&gt;</span> libreadline.so.5.0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x5BF9;&#x4E8E;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x67D0;&#x4E2A;&#x7279;&#x5B9A;&#x7684;&#x4E3B;&#x8981;&#x7248;&#x672C;&#x6765;&#x8BB2;&#xFF0C;&#x53EF;&#x80FD;&#x5B58;&#x5728;&#x51E0;&#x4E2A;&#x5E93;&#x6587;&#x4EF6;&#xFF0C;&#x8FD9;&#x4E9B;&#x5E93;&#x6587;&#x4EF6;&#x662F;&#x901A;&#x8FC7;&#x4E0D;&#x540C;&#x7684;&#x6B21;&#x8981;&#x7248;&#x672C;&#x6807;&#x8BC6;&#x7B26;&#x6765;&#x533A;&#x5206;&#x7684;&#x3002;&#x901A;&#x5E38;&#xFF0C;&#x6BCF;&#x4E2A;&#x5E93;&#x7684;&#x4E3B;&#x8981;&#x7248;&#x672C;&#x7684;soname&#x4F1A;&#x6307;&#x5411;&#x5728;&#x4E3B;&#x8981;&#x7248;&#x672C;&#x4E2D;&#x6700;&#x65B0;&#x7684;&#x6B21;&#x8981;&#x7248;&#x672C;&#x3002;&#x8FD9;&#x79CD;&#x914D;&#x7F6E;&#x4F7F;&#x5F97;&#x5728;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x8FD0;&#x884C;&#x65F6;&#x64CD;&#x4F5C;&#x671F;&#x95F4;&#x7248;&#x672C;&#x5316;&#x8BED;&#x4E49;&#x80FD;&#x591F;&#x6B63;&#x786E;&#x5DE5;&#x4F5C;&#x3002;&#x7531;&#x4E8E;&#x9759;&#x6001;&#x94FE;&#x63A5;&#x9636;&#x6BB5;&#x4F1A;&#x5C06;soname&#x7684;&#x526F;&#x672C;&#xFF08;&#x72EC;&#x7ACB;&#x4E8E;&#x6B21;&#x8981;&#x7248;&#x672C;&#xFF09;&#x5D4C;&#x5165;&#x5230;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x4E2D;&#x5E76;&#x4E14;soname&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#x540E;&#x9762;&#x53EF;&#x80FD;&#x4F1A;&#x88AB;&#x4FEE;&#x6539;&#x6307;&#x5411;&#x4E00;&#x4E2A;&#x66F4;&#x65B0;&#x7684;&#xFF08;&#x6B21;&#x8981;&#xFF09;&#x7248;&#x672C;&#x7684;&#x5171;&#x4EAB;&#x5E93;&#xFF0C;&#x56E0;&#x6B64;&#x53EF;&#x4EE5;&#x786E;&#x4FDD;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x80FD;&#x591F;&#x52A0;&#x8F7D;&#x5E93;&#x7684;&#x6700;&#x65B0;&#x7684;&#x6B21;&#x8981;&#x7248;&#x672C;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x7531;&#x4E8E;&#x4E00;&#x4E2A;&#x5E93;&#x7684;&#x4E0D;&#x540C;&#x7684;&#x4E3B;&#x8981;&#x7248;&#x672C;&#x7684;soname&#x4E0D;&#x540C;&#xFF0C;&#x56E0;&#x6B64;&#x5B83;&#x4EEC;&#x80FD;&#x591F;&#x548C;&#x5E73;&#x5730;&#x5171;&#x5B58;&#x5E76;&#x4E14;&#x88AB;&#x9700;&#x8981;&#x5B83;&#x4EEC;&#x7684;&#x7A0B;&#x5E8F;&#x8BBF;&#x95EE;&#x3002;</p>
<p>&#x9664;&#x4E86;&#x771F;&#x5B9E;&#x540D;&#x79F0;&#x548C;soname&#x4E4B;&#x5916;&#xFF0C;&#x901A;&#x5E38;&#x8FD8;&#x4F1A;&#x4E3A;&#x6BCF;&#x4E2A;&#x5171;&#x4EAB;&#x5E93;&#x5B9A;&#x4E49;&#x7B2C;&#x4E09;&#x4E2A;&#x540D;&#x79F0;&#xFF1A;&#x94FE;&#x63A5;&#x5668;&#x540D;&#x79F0;&#xFF0C;&#x5C06;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x4E0E;&#x5171;&#x4EAB;&#x5E93;&#x94FE;&#x63A5;&#x8D77;&#x6765;&#x65F6;&#x4F1A;&#x7528;&#x5230;&#x8FD9;&#x4E2A;&#x540D;&#x79F0;&#x3002;&#x94FE;&#x63A5;&#x5668;&#x540D;&#x79F0;&#x662F;&#x4E00;&#x4E2A;&#x53EA;&#x5305;&#x542B;&#x5E93;&#x540D;&#x540C;&#x65F6;&#x4E0D;&#x5305;&#x542B;&#x4E3B;&#x8981;&#x6216;&#x6B21;&#x8981;&#x7248;&#x672C;&#x6807;&#x8BC6;&#x7B26;&#x7684;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#xFF0C;&#x56E0;&#x6B64;&#x5176;&#x5F62;&#x5F0F;&#x4E3A;libname.so&#x3002;&#x6709;&#x4E86;&#x94FE;&#x63A5;&#x5668;&#x540D;&#x79F0;&#x4E4B;&#x540E;&#x5C31;&#x53EF;&#x4EE5;&#x6784;&#x5EFA;&#x80FD;&#x591F;&#x81EA;&#x52A8;&#x4F7F;&#x7528;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x6B63;&#x786E;&#x7248;&#x672C;&#xFF08;&#x5373;&#x6700;&#x65B0;&#x7248;&#x672C;&#xFF09;&#x7684;&#x72EC;&#x7ACB;&#x4E8E;&#x7248;&#x672C;&#x7684;&#x94FE;&#x63A5;&#x547D;&#x4EE4;&#x4E86;&#x3002;</p>
<p>&#x4E00;&#x822C;&#x6765;&#x8BB2;&#xFF0C;&#x94FE;&#x63A5;&#x5668;&#x540D;&#x79F0;&#x4E0E;&#x5B83;&#x6240;&#x5F15;&#x7528;&#x7684;&#x6587;&#x4EF6;&#x4F4D;&#x4E8E;&#x540C;&#x4E00;&#x4E2A;&#x76EE;&#x5F55;&#x4E2D;&#xFF0C;&#x5B83;&#x65E2;&#x53EF;&#x4EE5;&#x94FE;&#x63A5;&#x5230;&#x771F;&#x5B9E;&#x540D;&#x79F0;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x8FDE;&#x63A5;&#x5230;&#x5E93;&#x7684;&#x6700;&#x65B0;&#x4E3B;&#x8981;&#x7248;&#x672C;&#x7684;soname&#x3002;&#x901A;&#x5E38;&#xFF0C;&#x6700;&#x597D;&#x4F7F;&#x7528;&#x6307;&#x5411;soname&#x7684;&#x94FE;&#x63A5;&#xFF0C;&#x56E0;&#x6B64;&#x5BF9;soname&#x6240;&#x505A;&#x7684;&#x53D8;&#x66F4;&#x4F1A;&#x81EA;&#x52A8;&#x53CD;&#x5E94;&#x5230;&#x94FE;&#x63A5;&#x5668;&#x540D;&#x79F0;&#x4E0A;&#x3002;</p>
<p>&#x5982;&#x679C;&#x9700;&#x8981;&#x5C06;&#x4E00;&#x4E2A;&#x7A0B;&#x5E8F;&#x4E0E;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x4E00;&#x4E2A;&#x8F83;&#x8001;&#x7684;&#x4E3B;&#x8981;&#x7248;&#x672C;&#x94FE;&#x63A5;&#x8D77;&#x6765;&#xFF0C;&#x5C31;&#x4E0D;&#x80FD;&#x4F7F;&#x7528;&#x94FE;&#x63A5;&#x5668;&#x540D;&#x79F0;&#x3002;&#x76F8;&#x53CD;&#xFF0C;&#x5728;&#x94FE;&#x63A5;&#x547D;&#x4EE4;&#x4E2D;&#x9700;&#x8981;&#x901A;&#x8FC7;&#x5236;&#x5B9A;&#x5177;&#x4F53;&#x7684;&#x771F;&#x5B9E;&#x540D;&#x79F0;&#x6216;soname&#x6765;&#x6807;&#x793A;&#x51FA;&#x6240;&#x9700;&#x8981;&#x7684;&#x7248;&#x672C;&#xFF08;&#x4E3B;&#x8981;&#x7248;&#x672C;&#xFF09;&#x3002;</p>
<p>&#x4E0B;&#x9762;&#x662F;&#x4E00;&#x4E9B;&#x94FE;&#x63A5;&#x5668;&#x540D;&#x79F0;&#x7684;&#x4F8B;&#x5B50;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">libdemo.so     -<span class="token operator">&gt;</span> libdemo.so.2
libreadline.so -<span class="token operator">&gt;</span> libreadline.so.5<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x4E0B;&#x56FE;&#x63CF;&#x7ED8;&#x4E86;&#x8FD9;&#x4E9B;&#x540D;&#x79F0;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x7CFB;&#x3002;<br></p><div class="amp-img-wrapper"><amp-img src="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1581766056075.png?x-oss-process=image/resize,m_lfit,h_450" width="927" height="211" layout="responsive"></amp-img></div>
<h3 id="&#x4F7F;&#x7528;&#x6807;&#x51C6;&#x89C4;&#x8303;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5171;&#x4EAB;&#x5E93;"><a href="#&#x4F7F;&#x7528;&#x6807;&#x51C6;&#x89C4;&#x8303;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5171;&#x4EAB;&#x5E93;" class="headerlink" title="&#x4F7F;&#x7528;&#x6807;&#x51C6;&#x89C4;&#x8303;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5171;&#x4EAB;&#x5E93;"></a>&#x4F7F;&#x7528;&#x6807;&#x51C6;&#x89C4;&#x8303;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5171;&#x4EAB;&#x5E93;</h3><p>&#x6839;&#x636E;&#x4E0A;&#x9762;&#x4ECB;&#x7ECD;&#x7684;&#x76F8;&#x5173;&#x77E5;&#x8BC6;&#xFF0C;&#x4E0B;&#x9762;&#x5F00;&#x59CB;&#x4ECB;&#x7ECD;&#x5982;&#x4F55;&#x9075;&#x5FAA;&#x6807;&#x51C6;&#x89C4;&#x8303;&#x6765;&#x6784;&#x5EFA;&#x4E00;&#x4E2A;&#x6F14;&#x793A;&#x5E93;&#x3002;&#x9996;&#x5148;&#x9700;&#x8981;&#x521B;&#x5EFA;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ gcc -g -c -fPIC -Wall mod1.c mod2.c mod3.c<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>&#x63A5;&#x7740;&#x521B;&#x5EFA;&#x5171;&#x4EAB;&#x5E93;&#xFF0C;&#x5176;&#x771F;&#x5B9E;&#x540D;&#x79F0;&#x4E3A;libdemo.so.1.0.1&#xFF0C;soname&#x4E3A;libdemo.so.1&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ gcc -g -shared -Wl,-soname,libdemo.so.1 -o libdemo.so.1.0.1 mod1.o mod2.o mod3.o<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>&#x63A5;&#x7740;&#x4E3A;soname&#x548C;&#x94FE;&#x63A5;&#x5668;&#x540D;&#x79F0;&#x521B;&#x5EFA;&#x6070;&#x5F53;&#x7684;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">ln</span> -s libdemo.so.1.0.1 libdemo.so.1
$ <span class="token function">ln</span> -s libdemo.so.1 libdemo.so<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x63A5;&#x7740;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;ls&#x6765;&#x9A8C;&#x8BC1;&#x914D;&#x7F6E;&#xFF08;&#x4F7F;&#x7528;awk&#x6765;&#x9009;&#x62E9;&#x611F;&#x5174;&#x8DA3;&#x7684;&#x5B57;&#x6BB5;&#xFF09;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">ls</span> -l libdemo.so* <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&apos;{print <span class="token variable">$1</span>,<span class="token variable">$9</span>,<span class="token variable">$10</span>,<span class="token variable">$11</span>}&apos;</span>
lrwxrwxrwx libdemo.so -<span class="token operator">&gt;</span>libdemo.so.1
lrwxrwxrwx libdemo.so.1 -<span class="token operator">&gt;</span>libdemo.so.1.0.1
-rwxr-xr-x libdemo.so.1.0.1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x63A5;&#x7740;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x94FE;&#x63A5;&#x5668;&#x540D;&#x79F0;&#x6765;&#x6784;&#x5EFA;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#xFF08;&#x6CE8;&#x610F;&#x94FE;&#x63A5;&#x547D;&#x4EE4;&#x4E0D;&#x4F1A;&#x7528;&#x5230;&#x7248;&#x672C;&#x53F7;&#xFF09;&#xFF0C;&#x5E76;&#x7167;&#x5E38;&#x8FD0;&#x884C;&#x8FD9;&#x4E2A;&#x7A0B;&#x5E8F;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ gcc -g -Wall -o prog prog.c -L. -ldemo
$ LD_LIBRARY_PATH<span class="token operator">=</span>. ./prog
Called mod1-x1
Called mod2-x2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="&#x5B89;&#x88C5;&#x5171;&#x4EAB;&#x5E93;"><a href="#&#x5B89;&#x88C5;&#x5171;&#x4EAB;&#x5E93;" class="headerlink" title="&#x5B89;&#x88C5;&#x5171;&#x4EAB;&#x5E93;"></a>&#x5B89;&#x88C5;&#x5171;&#x4EAB;&#x5E93;</h2><p>&#x5728;&#x672C;&#x7AE0;&#x5230;&#x76EE;&#x524D;&#x4E3A;&#x6B62;&#x4ECB;&#x7ECD;&#x7684;&#x4F8B;&#x5B50;&#x4E2D;&#x90FD;&#x662F;&#x5C06;&#x5171;&#x4EAB;&#x5E93;&#x521B;&#x5EFA;&#x5728;&#x7528;&#x6237;&#x79C1;&#x6709;&#x7684;&#x76EE;&#x5F55;&#x4E2D;&#xFF0C;&#x7136;&#x540E;&#x4F7F;&#x7528;LD_LIBRARY_PATH&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x6765;&#x786E;&#x4FDD;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x4F1A;&#x641C;&#x5230;&#x8BE5;&#x76EE;&#x5F55;&#x3002;&#x7279;&#x6743;&#x7528;&#x6237;&#x548C;&#x975E;&#x7279;&#x6743;&#x7528;&#x6237;&#x90FD;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x8FD9;&#x79CD;&#x6280;&#x672F;&#xFF0C;&#x4F46;&#x5728;&#x751F;&#x4EA7;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E2D;&#x4E0D;&#x5E94;&#x8BE5;&#x91C7;&#x7528;&#x8FD9;&#x79CD;&#x6280;&#x672F;&#x3002;&#x4E00;&#x822C;&#x6765;&#x8BB2;&#xFF0C;&#x5171;&#x4EAB;&#x5E93;&#x53CA;&#x5176;&#x5173;&#x8054;&#x7684;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#x4F1A;&#x88AB;&#x5B89;&#x88C5;&#x5728;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x6807;&#x51C6;&#x5E93;&#x76EE;&#x5F55;&#x4E2D;&#xFF0C;&#x6807;&#x51C6;&#x5E93;&#x76EE;&#x5F55;&#x5305;&#x62EC;&#xFF1A;</p>
<ul>
<li>/usr/lib&#xFF0C;&#x5B83;&#x662F;&#x5927;&#x591A;&#x6570;&#x6807;&#x51C6;&#x5E93;&#x5B89;&#x88C5;&#x7684;&#x76EE;&#x5F55;&#x3002;</li>
<li>/lib&#xFF0C;&#x5E94;&#x8BE5;&#x5C06;&#x7CFB;&#x7EDF;&#x542F;&#x52A8;&#x65F6;&#x7528;&#x5230;&#x7684;&#x5E93;&#x5B89;&#x88C5;&#x5728;&#x8FD9;&#x4E2A;&#x76EE;&#x5F55;&#x4E2D;&#xFF08;&#x56E0;&#x4E3A;&#x5728;&#x7CFB;&#x7EDF;&#x542F;&#x52A8;&#x65F6;&#x53EF;&#x80FD;&#x8FD8;&#x6CA1;&#x6709;&#x6302;&#x8F7D;/usr/lib&#xFF09;&#x3002;</li>
<li>/usr/local/lib&#xFF0C;&#x5E94;&#x8BE5;&#x5C06;&#x975E;&#x6807;&#x51C6;&#x6216;&#x5B9E;&#x9A8C;&#x6027;&#x7684;&#x5E93;&#x5B89;&#x88C5;&#x5728;&#x8FD9;&#x4E2A;&#x76EE;&#x5F55;&#x4E2D;&#xFF08;&#x5BF9;&#x4E8E;/usr/lib&#x662F;&#x4E00;&#x4E2A;&#x7531;&#x591A;&#x4E2A;&#x7CFB;&#x7EDF;&#x5171;&#x4EAB;&#x7684;&#x7F51;&#x7EDC;&#x6302;&#x8F7D;&#x4F46;&#x9700;&#x8981;&#x53EA;&#x5728;&#x672C;&#x673A;&#x5B89;&#x88C5;&#x4E00;&#x4E2A;&#x5E93;&#x7684;&#x60C5;&#x51B5;&#x5219;&#x53EF;&#x4EE5;&#x5C06;&#x5E93;&#x653E;&#x5728;&#x8FD9;&#x4E2A;&#x76EE;&#x5F55;&#x4E2D;&#xFF09;&#x3002;</li>
<li>&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x5728;/etc/ld.so.conf&#xFF08;&#x7A0D;&#x540E;&#x4ECB;&#x7ECD;&#xFF09;&#x4E2D;&#x5217;&#x51FA;&#x7684;&#x76EE;&#x5F55;&#x3002;</li>
</ul>
<p>&#x5728;&#x5927;&#x591A;&#x6570;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5C06;&#x6587;&#x4EF6;&#x590D;&#x5236;&#x5230;&#x8FD9;&#x4E9B;&#x76EE;&#x5F55;&#x4E2D;&#x9700;&#x8981;&#x5177;&#x5907;&#x8D85;&#x7EA7;&#x7528;&#x6237;&#x7684;&#x6743;&#x9650;&#x3002;</p>
<p>&#x5B89;&#x88C5;&#x5B8C;&#x4E4B;&#x540E;&#x5C31;&#x5FC5;&#x987B;&#x8981;&#x521B;&#x5EFA;soname&#x548C;&#x94FE;&#x63A5;&#x5668;&#x540D;&#x79F0;&#x7684;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#x4E86;&#xFF0C;&#x901A;&#x5E38;&#x5B83;&#x4EEC;&#x662F;&#x4F5C;&#x4E3A;&#x76F8;&#x5BF9;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#x4E0E;&#x5E93;&#x6587;&#x4EF6;&#x4F4D;&#x4E8E;&#x540C;&#x4E00;&#x4E2A;&#x76EE;&#x5F55;&#x4E2D;&#x3002;&#x56E0;&#x6B64;&#x8981;&#x5C06;&#x672C;&#x7AE0;&#x7684;&#x6F14;&#x793A;&#x5E93;&#x5B89;&#x88C5;&#x5728;/usr/lib&#xFF08;&#x53EA;&#x5141;&#x8BB8;root&#x8FDB;&#x884C;&#x66F4;&#x65B0;&#xFF09;&#x4E2D;&#x5219;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4E0B;&#x9762;&#x7684;&#x547D;&#x4EE4;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">su</span>
Password:
<span class="token comment" spellcheck="true"># mv libdemo.so.1.0.1 /usr/lib</span>

<span class="token comment" spellcheck="true"># cd /usr/lib</span>
<span class="token comment" spellcheck="true"># ln -s libdemo.so.1.0.1 libdemo.so.1</span>
<span class="token comment" spellcheck="true"># ln -s libdemo.so.1 libdemo.so</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>shell&#x4F1A;&#x8BDD;&#x4E2D;&#x7684;&#x6700;&#x540E;&#x4E24;&#x884C;&#x521B;&#x5EFA;&#x4E86;soname&#x548C;&#x94FE;&#x63A5;&#x5668;&#x540D;&#x79F0;&#x7684;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#x3002;</p>
<h3 id="ldconfig"><a href="#ldconfig" class="headerlink" title="ldconfig"></a>ldconfig</h3><p>ldconfig(8)&#x89E3;&#x51B3;&#x4E86;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x4E24;&#x4E2A;&#x6F5C;&#x5728;&#x95EE;&#x9898;&#x3002;</p>
<ul>
<li>&#x5171;&#x4EAB;&#x5E93;&#x53EF;&#x4EE5;&#x4F4D;&#x4E8E;&#x5404;&#x79CD;&#x76EE;&#x5F55;&#x4E2D;&#xFF0C;&#x5982;&#x679C;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x9700;&#x8981;&#x901A;&#x8FC7;&#x641C;&#x7D22;&#x6240;&#x6709;&#x8FD9;&#x4E9B;&#x76EE;&#x5F55;&#x6765;&#x627E;&#x51FA;&#x4E00;&#x4E2A;&#x5E93;&#x5E76;&#x52A0;&#x8F7D;&#x8FD9;&#x4E2A;&#x5E93;&#xFF0C;&#x90A3;&#x4E48;&#x6574;&#x4E2A;&#x8FC7;&#x7A0B;&#x5C06;&#x975E;&#x5E38;&#x6162;&#x3002;</li>
<li>&#x5F53;&#x5B89;&#x88C5;&#x4E86;&#x65B0;&#x7248;&#x672C;&#x7684;&#x5E93;&#x6216;&#x8005;&#x5220;&#x9664;&#x4E86;&#x65E7;&#x7248;&#x672C;&#x7684;&#x5E93;&#xFF0C;&#x90A3;&#x4E48;soname&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#x5C31;&#x4E0D;&#x662F;&#x6700;&#x65B0;&#x7684;&#x3002;</li>
</ul>
<p>ldconfig&#x7A0B;&#x5E8F;&#x901A;&#x8FC7;&#x6267;&#x884C;&#x4E24;&#x4E2A;&#x4EFB;&#x52A1;&#x6765;&#x89E3;&#x51B3;&#x8FD9;&#x4E9B;&#x95EE;&#x9898;&#x3002;<br>1&#xFF0E; &#x5B83;&#x641C;&#x7D22;&#x4E00;&#x7EC4;&#x6807;&#x51C6;&#x7684;&#x76EE;&#x5F55;&#x5E76;&#x521B;&#x5EFA;&#x6216;&#x66F4;&#x65B0;&#x4E00;&#x4E2A;&#x7F13;&#x5B58;&#x6587;&#x4EF6;/etc/ld.so.cache&#x4F7F;&#x4E4B;&#x5305;&#x542B;&#x5728;&#x6240;&#x6709;&#x8FD9;&#x4E9B;&#x76EE;&#x5F55;&#x4E2D;&#x7684;&#x4E3B;&#x8981;&#x5E93;&#x7248;&#x672C;&#xFF08;&#x6BCF;&#x4E2A;&#x5E93;&#x7684;&#x4E3B;&#x8981;&#x7248;&#x672C;&#x7684;&#x6700;&#x65B0;&#x7684;&#x6B21;&#x8981;&#x7248;&#x672C;&#xFF09;&#x5217;&#x8868;&#x3002;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x89E3;&#x6790;&#x5E93;&#x540D;&#x79F0;&#x65F6;&#x4F1A;&#x8F6E;&#x6D41;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x7F13;&#x5B58;&#x6587;&#x4EF6;&#x3002;&#x4E3A;&#x4E86;&#x6784;&#x5EFA;&#x8FD9;&#x4E2A;&#x7F13;&#x5B58;&#xFF0C;ldconfig&#x4F1A;&#x641C;&#x7D22;&#x5728;/etc/ld.so.conf&#x4E2D;&#x6307;&#x5B9A;&#x7684;&#x76EE;&#x5F55;&#xFF0C;&#x7136;&#x540E;&#x641C;&#x7D22;/lib &#x548C; /usr/lib&#x3002;/etc/ld.so.conf&#x6587;&#x4EF6;&#x7531;&#x4E00;&#x4E2A;&#x76EE;&#x5F55;&#x8DEF;&#x5F84;&#x540D;&#xFF08;&#x5E94;&#x8BE5;&#x662F;&#x7EDD;&#x5BF9;&#x8DEF;&#x5F84;&#x540D;&#xFF09;&#x5217;&#x8868;&#x6784;&#x6210;&#xFF0C;&#x5176;&#x4E2D;&#x8DEF;&#x5F84;&#x540D;&#x4E4B;&#x95F4;&#x7528;&#x6362;&#x884C;&#x3001;&#x7A7A;&#x683C;&#x3001;&#x5236;&#x8868;&#x7B26;&#x3001;&#x9017;&#x53F7;&#x6216;&#x5192;&#x53F7;&#x5206;&#x9694;&#x3002;&#x5728;&#x4E00;&#x4E9B;&#x53D1;&#x884C;&#x7248;&#x4E2D;&#xFF0C;/usr/local/lib&#x76EE;&#x5F55;&#x4E5F;&#x4F4D;&#x4E8E;&#x8FD9;&#x4E2A;&#x5217;&#x8868;&#x4E2D;&#x3002;&#xFF08;&#x5982;&#x679C;&#x4E0D;&#x5728;&#x8FD9;&#x4E2A;&#x5217;&#x8868;&#x4E2D;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x9700;&#x8981;&#x624B;&#x5DE5;&#x5C06;&#x5176;&#x6DFB;&#x52A0;&#x5230;&#x5217;&#x8868;&#x4E2D;&#x3002;&#xFF09;<br>&#x547D;&#x4EE4;<code>ldconfig &#x2013;p</code>&#x4F1A;&#x663E;&#x793A;/etc/ld.so.cache&#x7684;&#x5F53;&#x524D;&#x5185;&#x5BB9;&#x3002;<br>2&#xFF0E; &#x5B83;&#x68C0;&#x67E5;&#x6BCF;&#x4E2A;&#x5E93;&#x7684;&#x5404;&#x4E2A;&#x4E3B;&#x8981;&#x7248;&#x672C;&#x7684;&#x6700;&#x65B0;&#x6B21;&#x8981;&#x7248;&#x672C;&#xFF08;&#x5373;&#x5177;&#x6709;&#x6700;&#x5927;&#x7684;&#x6B21;&#x8981;&#x7248;&#x672C;&#x53F7;&#x7684;&#x7248;&#x672C;&#xFF09;&#x4EE5;&#x627E;&#x51FA;&#x5D4C;&#x5165;&#x7684;soname&#xFF0C;&#x7136;&#x540E;&#x5728;&#x540C;&#x4E00;&#x76EE;&#x5F55;&#x4E2D;&#x4E3A;&#x6BCF;&#x4E2A;soname&#x521B;&#x5EFA;&#xFF08;&#x6216;&#x66F4;&#x65B0;&#xFF09;&#x76F8;&#x5BF9;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#x3002;</p>
<p>&#x4E3A;&#x4E86;&#x80FD;&#x591F;&#x6B63;&#x786E;&#x6267;&#x884C;&#x8FD9;&#x4E9B;&#x52A8;&#x4F5C;&#xFF0C;ldconfig&#x8981;&#x6C42;&#x5E93;&#x7684;&#x540D;&#x79F0;&#x8981;&#x6839;&#x636E;&#x524D;&#x9762;&#x4ECB;&#x7ECD;&#x7684;&#x89C4;&#x8303;&#x6765;&#x547D;&#x540D;&#xFF08;&#x5373;&#x5E93;&#x7684;&#x771F;&#x5B9E;&#x540D;&#x79F0;&#x5305;&#x542B;&#x4E3B;&#x8981;&#x548C;&#x6B21;&#x8981;&#x6807;&#x8BC6;&#x7B26;&#xFF0C;&#x5B83;&#x4EEC;&#x968F;&#x7740;&#x5E93;&#x7684;&#x7248;&#x672C;&#x7684;&#x66F4;&#x65B0;&#x800C;&#x6070;&#x5F53;&#x7684;&#x589E;&#x957F;&#xFF09;&#x3002;</p>
<p>&#x5728;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;ldconfig&#x4F1A;&#x6267;&#x884C;&#x4E0A;&#x9762;&#x4E24;&#x4E2A;&#x52A8;&#x4F5C;&#xFF0C;&#x4F46;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x547D;&#x4EE4;&#x884C;&#x9009;&#x9879;&#x6765;&#x6307;&#x5B9A;&#x5B83;&#x6267;&#x884C;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x52A8;&#x4F5C;&#xFF1A;-N&#x9009;&#x9879;&#x4F1A;&#x9632;&#x6B62;&#x7F13;&#x5B58;&#x7684;&#x91CD;&#x5EFA;&#xFF0C;-X&#x9009;&#x9879;&#x4F1A;&#x963B;&#x6B62;soname&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#x7684;&#x521B;&#x5EFA;&#x3002;&#x6B64;&#x5916;&#xFF0C;-v (verbose)&#x9009;&#x9879;&#x4F1A;&#x4F7F;&#x5F97;ldconfig&#x8F93;&#x51FA;&#x63CF;&#x8FF0;&#x5176;&#x6240;&#x6267;&#x884C;&#x7684;&#x52A8;&#x4F5C;&#x7684;&#x4FE1;&#x606F;&#x3002;</p>
<p>&#x6BCF;&#x5F53;&#x5B89;&#x88C5;&#x4E86;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x5E93;&#xFF0C;&#x66F4;&#x65B0;&#x6216;&#x5220;&#x9664;&#x4E86;&#x4E00;&#x4E2A;&#x65E2;&#x6709;&#x5E93;&#xFF0C;&#x4EE5;&#x53CA;/etc/ld.so.conf&#x4E2D;&#x7684;&#x76EE;&#x5F55;&#x5217;&#x8868;&#x88AB;&#x4FEE;&#x6539;&#x4E4B;&#x540E;&#xFF0C;&#x90FD;&#x5E94;&#x8BE5;&#x8FD0;&#x884C;ldconfig&#x3002;</p>
<p>&#x4E0B;&#x9762;&#x662F;&#x4E00;&#x4E2A;&#x4F7F;&#x7528;ldconfig&#x7684;&#x4F8B;&#x5B50;&#x3002;&#x5047;&#x8BBE;&#x9700;&#x8981;&#x5B89;&#x88C5;&#x4E00;&#x4E2A;&#x5E93;&#x7684;&#x4E24;&#x4E2A;&#x4E0D;&#x540C;&#x7684;&#x4E3B;&#x8981;&#x7248;&#x672C;&#xFF0C;&#x90A3;&#x4E48;&#x9700;&#x8981;&#x505A;&#x4E0B;&#x9762;&#x7684;&#x4E8B;&#x60C5;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">su</span>
Password:
<span class="token comment" spellcheck="true"># mv libdemo.so.1.0.1 libdemo.so.2.0.0 /usr/lib</span>

<span class="token comment" spellcheck="true"># ldconfig -v | grep libdemo</span>
        libdemo.so.1 -<span class="token operator">&gt;</span> libdemo.so.1.0.1<span class="token punctuation">(</span>changed<span class="token punctuation">)</span>
        libdemo.so.2 -<span class="token operator">&gt;</span> libdemo.so.2.0.0<span class="token punctuation">(</span>changed<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x63A5;&#x7740;&#x5217;&#x51FA;&#x5728;/usr/lib&#x76EE;&#x5F55;&#x4E2D;&#x540D;&#x4E3A;libdemo&#x7684;&#x6587;&#x4EF6;&#x6765;&#x9A8C;&#x8BC1;soname&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#x7684;&#x8BBE;&#x7F6E;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># cd /usr/lib</span>
<span class="token comment" spellcheck="true"># ls -l libdemo* | awk &apos;{print $1,$$9,$10,$11}&apos;</span>
lrwxrwxrwx libdemo.so.1 -<span class="token operator">&gt;</span> libdemo.so.1.0.1
-rwxr-xr-x libdemo.so.1.0.1
lrwxrwxrwx libdemo.so.2 -<span class="token operator">&gt;</span> libdemo.so.2.0.0
-rwxr-xr-x libdemo.so.2.0.0 <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x8FD8;&#x9700;&#x8981;&#x4E3A;&#x94FE;&#x63A5;&#x5668;&#x540D;&#x79F0;&#x521B;&#x5EFA;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#xFF0C;&#x5982;&#x4E0B;&#x9762;&#x7684;&#x547D;&#x4EE4;&#x6240;&#x793A;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># ln -s libdemo.so.2 libdemo.so</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>&#x5982;&#x679C;&#x5B89;&#x88C5;&#x4E86;&#x5E93;&#x7684;&#x4E00;&#x4E2A;&#x65B0;&#x7684;2.x&#x6B21;&#x8981;&#x7248;&#x672C;&#xFF0C;&#x90A3;&#x4E48;&#x7531;&#x4E8E;&#x94FE;&#x63A5;&#x5668;&#x540D;&#x79F0;&#x6307;&#x5411;&#x4E86;&#x6700;&#x65B0;&#x7684;soname&#xFF0C;&#x56E0;&#x6B64;ldconfig&#x8FD8;&#x80FD;&#x53D6;&#x5F97;&#x4FDD;&#x6301;&#x94FE;&#x63A5;&#x5668;&#x540D;&#x79F0;&#x6700;&#x65B0;&#x7684;&#x6548;&#x679C;&#xFF0C;&#x5982;&#x4E0B;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x6240;&#x793A;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># mv libdemo.so.2.0.1 /usr/lib</span>
<span class="token comment" spellcheck="true"># ldconfig -v | grep libdemo</span>
        libdemo.so.1 -<span class="token operator">&gt;</span> libdemo.so.1.0.1
        libdemo.so.2 -<span class="token operator">&gt;</span> libdemo.so.2.0.1<span class="token punctuation">(</span>changed<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x5982;&#x679C;&#x521B;&#x5EFA;&#x548C;&#x4F7F;&#x7528;&#x7684;&#x662F;&#x4E00;&#x4E2A;&#x79C1;&#x6709;&#x5E93;&#xFF08;&#x5373;&#x6CA1;&#x6709;&#x5B89;&#x88C5;&#x5728;&#x4E0A;&#x8FF0;&#x6807;&#x51C6;&#x76EE;&#x5F55;&#x4E2D;&#x7684;&#x5E93;&#xFF09;&#xFF0C;&#x90A3;&#x4E48;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4F7F;&#x7528;-n&#x9009;&#x9879;&#x8BA9;ldconfig&#x521B;&#x5EFA;soname&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#x3002;&#x8FD9;&#x4E2A;&#x9009;&#x9879;&#x6307;&#x5B9A;&#x4E86;ldconfig&#x53EA;&#x5904;&#x7406;&#x5728;&#x547D;&#x4EE4;&#x884C;&#x4E2D;&#x5217;&#x51FA;&#x7684;&#x76EE;&#x5F55;&#x4E2D;&#x7684;&#x5E93;&#xFF0C;&#x800C;&#x65E0;&#x9700;&#x66F4;&#x65B0;&#x7F13;&#x5B58;&#x6587;&#x4EF6;&#x3002;&#x4E0B;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x4F7F;&#x7528;&#x4E86;ldconfig&#x6765;&#x5904;&#x7406;&#x5F53;&#x524D;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;&#x4E2D;&#x7684;&#x5E93;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ gcc -g -c -fPIC -Wall mod1.c mod2.c mod3.c
$ gcc -g -shared -Wl,-soname,libdemo.so.1 -o libdemo.so.1.0.1 mod1.o mod2.o mod3.o
$ /sbin/ldconfig -nv <span class="token keyword">.</span>
.:
        libdemo.so.1 -<span class="token operator">&gt;</span> libdemo.so.1.0.1
$ <span class="token function">ls</span>  -l libdemo.so* <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&apos;{print <span class="token variable">$1</span>,<span class="token variable">$9</span>,<span class="token variable">$10</span>,<span class="token variable">$11</span>}&apos;</span>
lrwxrwxrwx libdemo.so.1 -<span class="token operator">&gt;</span> libdemo.so.1.0.1
-rwxr-xr-x libdemo.so.1.0.1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x5728;&#x4E0A;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x4E2D;&#xFF0C;&#x5F53;&#x8FD0;&#x884C;ldconfig&#x65F6;&#x6307;&#x5B9A;&#x4E86;&#x5B8C;&#x5168;&#x8DEF;&#x5F84;&#x540D;&#xFF0C;&#x56E0;&#x4E3A;&#x4F7F;&#x7528;&#x7684;&#x662F;&#x4E00;&#x4E2A;&#x975E;&#x7279;&#x6743;&#x8D26;&#x53F7;&#xFF0C;&#x5176;PATH&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x4E0D;&#x5305;&#x542B;/sbin&#x76EE;&#x5F55;&#x3002;</p>
<h2 id="&#x517C;&#x5BB9;&#x4E0E;&#x4E0D;&#x517C;&#x5BB9;&#x5E93;&#x6BD4;&#x8F83;"><a href="#&#x517C;&#x5BB9;&#x4E0E;&#x4E0D;&#x517C;&#x5BB9;&#x5E93;&#x6BD4;&#x8F83;" class="headerlink" title="&#x517C;&#x5BB9;&#x4E0E;&#x4E0D;&#x517C;&#x5BB9;&#x5E93;&#x6BD4;&#x8F83;"></a>&#x517C;&#x5BB9;&#x4E0E;&#x4E0D;&#x517C;&#x5BB9;&#x5E93;&#x6BD4;&#x8F83;</h2><p>&#x968F;&#x7740;&#x65F6;&#x95F4;&#x7684;&#x6D41;&#x901D;&#xFF0C;&#x53EF;&#x80FD;&#x9700;&#x8981;&#x4FEE;&#x6539;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x4EE3;&#x7801;&#x3002;&#x8FD9;&#x79CD;&#x4FEE;&#x6539;&#x4F1A;&#x5BFC;&#x81F4;&#x4EA7;&#x751F;&#x4E00;&#x4E2A;&#x65B0;&#x7248;&#x672C;&#x7684;&#x5E93;&#xFF0C;&#x8FD9;&#x4E2A;&#x65B0;&#x7248;&#x672C;&#x53EF;&#x4EE5;&#x4E0E;&#x4E4B;&#x524D;&#x7684;&#x7248;&#x672C;&#x517C;&#x5BB9;&#xFF0C;&#x4E5F;&#x53EF;&#x80FD;&#x4E0E;&#x4E4B;&#x524D;&#x7684;&#x7248;&#x672C;&#x4E0D;&#x517C;&#x5BB9;&#x3002;&#x5982;&#x679C;&#x662F;&#x517C;&#x5BB9;&#x7684;&#x8BDD;&#x5219;&#x610F;&#x5473;&#x7740;&#x53EA;&#x9700;&#x8981;&#x4FEE;&#x6539;&#x5E93;&#x7684;&#x771F;&#x5B9E;&#x540D;&#x79F0;&#x7684;&#x6B21;&#x8981;&#x7248;&#x672C;&#x6807;&#x8BC6;&#x7B26;&#x5373;&#x53EF;&#xFF0C;&#x5982;&#x679C;&#x662F;&#x4E0D;&#x517C;&#x5BB9;&#x7684;&#x8BDD;&#x5219;&#x610F;&#x5473;&#x7740;&#x5FC5;&#x987B;&#x8981;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x5E93;&#x7684;&#x65B0;&#x4E3B;&#x8981;&#x7248;&#x672C;&#x3002;</p>
<p>&#x5F53;&#x6EE1;&#x8DB3;&#x4E0B;&#x5217;&#x6761;&#x4EF6;&#x65F6;&#x8868;&#x793A;&#x4FEE;&#x6539;&#x8FC7;&#x7684;&#x5E93;&#x4E0E;&#x65E2;&#x6709;&#x5E93;&#x7248;&#x672C;&#x517C;&#x5BB9;&#x3002;</p>
<ul>
<li>&#x5E93;&#x4E2D;&#x6240;&#x6709;&#x516C;&#x5171;&#x65B9;&#x6CD5;&#x548C;&#x53D8;&#x91CF;&#x7684;&#x8BED;&#x4E49;&#x4FDD;&#x6301;&#x4E0D;&#x53D8;&#x3002;&#x6362;&#x53E5;&#x8BDD;&#x8BF4;&#xFF0C;&#x6BCF;&#x4E2A;&#x51FD;&#x6570;&#x7684;&#x53C2;&#x6570;&#x5217;&#x8868;&#x4E0D;&#x53D8;&#x5E76;&#x4E14;&#x5BF9;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x548C;&#x8FD4;&#x56DE;&#x53C2;&#x6570;&#x4EA7;&#x751F;&#x7684;&#x5F71;&#x54CD;&#x4E0D;&#x53D8;&#xFF0C;&#x540C;&#x65F6;&#x8FD4;&#x56DE;&#x540C;&#x6837;&#x7684;&#x7ED3;&#x679C;&#x503C;&#x3002;&#x56E0;&#x6B64;&#x63D0;&#x5347;&#x6027;&#x80FD;&#x6216;&#x4FEE;&#x590D;Bug&#xFF08;&#x5BFC;&#x81F4;&#x66F4;&#x52A0;&#x884C;&#x4E3A;&#x66F4;&#x52A0;&#x7B26;&#x5408;&#x89C4;&#x5B9A;&#xFF09;&#x7684;&#x53D8;&#x66F4;&#x53EF;&#x4EE5;&#x8BA4;&#x4E3A;&#x662F;&#x517C;&#x5BB9;&#x7684;&#x53D8;&#x66F4;&#x3002;</li>
<li>&#x6CA1;&#x6709;&#x5220;&#x9664;&#x5E93;&#x7684;&#x516C;&#x5171;API&#x4E2D;&#x7684;&#x51FD;&#x6570;&#x548C;&#x53D8;&#x91CF;&#xFF0C;&#x4F46;&#x5411;&#x516C;&#x5171;API&#x4E2D;&#x6DFB;&#x52A0;&#x65B0;&#x51FD;&#x6570;&#x548C;&#x53D8;&#x91CF;&#x4E0D;&#x4F1A;&#x5F71;&#x54CD;&#x517C;&#x5BB9;&#x6027;&#x3002;</li>
<li>&#x5728;&#x6BCF;&#x4E2A;&#x51FD;&#x6570;&#x4E2D;&#x5206;&#x914D;&#x7684;&#x7ED3;&#x6784;&#x4EE5;&#x53CA;&#x6BCF;&#x4E2A;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x7684;&#x7ED3;&#x6784;&#x4FDD;&#x6301;&#x4E0D;&#x53D8;&#x3002;&#x7C7B;&#x4F3C;&#x7684;&#xFF0C;&#x7531;&#x5E93;&#x5BFC;&#x51FA;&#x7684;&#x516C;&#x5171;&#x7ED3;&#x6784;&#x4FDD;&#x6301;&#x4E0D;&#x53D8;&#x3002;&#x8FD9;&#x4E2A;&#x89C4;&#x5219;&#x7684;&#x4E00;&#x4E2A;&#x4F8B;&#x5916;&#x60C5;&#x51B5;&#x662F;&#x5728;&#x7279;&#x5B9A;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x53EF;&#x80FD;&#x4F1A;&#x5411;&#x65E2;&#x6709;&#x7ED3;&#x6784;&#x7684;&#x7ED3;&#x5C3E;&#x5904;&#x6DFB;&#x52A0;&#x65B0;&#x7684;&#x5B57;&#x6BB5;&#xFF0C;&#x4F46;&#x5F53;&#x8C03;&#x7528;&#x7A0B;&#x5E8F;&#x5728;&#x5206;&#x914D;&#x8FD9;&#x4E2A;&#x7ED3;&#x6784;&#x7C7B;&#x578B;&#x7684;&#x6570;&#x7EC4;&#x65F6;&#x4F1A;&#x4EA7;&#x751F;&#x95EE;&#x9898;&#x3002;&#x6709;&#x65F6;&#x5019;&#xFF0C;&#x5E93;&#x7684;&#x8BBE;&#x8BA1;&#x4EBA;&#x5458;&#x4F1A;&#x901A;&#x8FC7;&#x5C06;&#x5BFC;&#x51FA;&#x7ED3;&#x6784;&#x7684;&#x5927;&#x5C0F;&#x5B9A;&#x4E49;&#x4E3A;&#x6BD4;&#x5E93;&#x7684;&#x9996;&#x4E2A;&#x53D1;&#x884C;&#x7248;&#x6240;&#x9700;&#x7684;&#x5927;&#x5C0F;&#x5927;&#x6765;&#x89E3;&#x51B3;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x5373;&#x589E;&#x52A0;&#x4E00;&#x4E9B;&#x586B;&#x5145;&#x5B57;&#x6BB5;&#x4EE5;&#x5907;&#x5C06;&#x6765;&#x4E4B;&#x9700;&#x3002;</li>
</ul>
<p>&#x5982;&#x679C;&#x6240;&#x6709;&#x8FD9;&#x4E9B;&#x6761;&#x4EF6;&#x90FD;&#x5F97;&#x5230;&#x4E86;&#x6EE1;&#x8DB3;&#xFF0C;&#x90A3;&#x4E48;&#x5728;&#x66F4;&#x65B0;&#x65B0;&#x5E93;&#x540D;&#x65F6;&#x5C31;&#x53EA;&#x9700;&#x8981;&#x8C03;&#x6574;&#x65E2;&#x6709;&#x540D;&#x79F0;&#x4E2D;&#x7684;&#x6B21;&#x8981;&#x7248;&#x672C;&#x53F7;&#x4E86;&#xFF0C;&#x5426;&#x5219;&#x5C31;&#x9700;&#x8981;&#x521B;&#x5EFA;&#x5E93;&#x7684;&#x4E00;&#x4E2A;&#x65B0;&#x4E3B;&#x8981;&#x7248;&#x672C;&#x3002;</p>
<h2 id="&#x5347;&#x7EA7;&#x5171;&#x4EAB;&#x5E93;"><a href="#&#x5347;&#x7EA7;&#x5171;&#x4EAB;&#x5E93;" class="headerlink" title="&#x5347;&#x7EA7;&#x5171;&#x4EAB;&#x5E93;"></a>&#x5347;&#x7EA7;&#x5171;&#x4EAB;&#x5E93;</h2><p>&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x4F18;&#x70B9;&#x4E4B;&#x4E00;&#x662F;&#x5F53;&#x4E00;&#x4E2A;&#x8FD0;&#x884C;&#x7740;&#x7684;&#x7A0B;&#x5E8F;&#x6B63;&#x5728;&#x4F7F;&#x7528;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x4E00;&#x4E2A;&#x65E2;&#x6709;&#x7248;&#x672C;&#x65F6;&#x4E5F;&#x80FD;&#x591F;&#x5B89;&#x88C5;&#x5E93;&#x7684;&#x65B0;&#x4E3B;&#x8981;&#x7248;&#x672C;&#x6216;&#x6B21;&#x8981;&#x7248;&#x672C;&#x3002;&#x5728;&#x5B89;&#x88C5;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x9700;&#x8981;&#x505A;&#x7684;&#x4E8B;&#x60C5;&#x5305;&#x62EC;&#x521B;&#x5EFA;&#x65B0;&#x7684;&#x5E93;&#x7248;&#x672C;&#x3001;&#x5C06;&#x5176;&#x5B89;&#x88C5;&#x5728;&#x6070;&#x5F53;&#x7684;&#x76EE;&#x5F55;&#x4E2D;&#x4EE5;&#x53CA;&#x6839;&#x636E;&#x9700;&#x8981;&#x66F4;&#x65B0;soname&#x548C;&#x94FE;&#x63A5;&#x5668;&#x540D;&#x79F0;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#xFF08;&#x6216;&#x901A;&#x5E38;&#x8BA9;ldconfig&#x6765;&#x5B8C;&#x6210;&#x8FD9;&#x90E8;&#x5206;&#x5DE5;&#x4F5C;&#xFF09;&#x3002;&#x5982;&#x8981;&#x521B;&#x5EFA;&#x5171;&#x4EAB;&#x5E93;/usr/lib/libdemo.1.0.1&#x7684;&#x4E00;&#x4E2A;&#x65B0;&#x6B21;&#x8981;&#x7248;&#x672C;&#xFF0C;&#x90A3;&#x4E48;&#x9700;&#x8981;&#x5B8C;&#x6210;&#xFF1A;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">su</span>
Password
<span class="token comment" spellcheck="true"># gcc -g -c -fPIC -Wall mod1.c mod2.c mod3.c</span>
<span class="token comment" spellcheck="true"># gcc -g -shared -Wl,-soname,libdemo.so.1 -o libdemo.so.1.0.1 mod1.o mod2.o mod3.o</span>
<span class="token comment" spellcheck="true"># mv libdemo.so.1.0.2 /usr/lib</span>
<span class="token comment" spellcheck="true"># ldconfig -v | grep libdemo</span>
        libdemo.so.1 -<span class="token operator">&gt;</span> libdemo.so.1.0.2<span class="token punctuation">(</span>changed<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x5047;&#x8BBE;&#x5DF2;&#x7ECF;&#x6B63;&#x786E;&#x5730;&#x914D;&#x7F6E;&#x4E86;&#x94FE;&#x63A5;&#x5668;&#x540D;&#x79F0;&#xFF08;&#x5373;&#x6307;&#x5411;&#x5E93;&#x7684;soname&#xFF09;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x65E0;&#x9700;&#x4FEE;&#x6539;&#x94FE;&#x63A5;&#x5668;&#x540D;&#x79F0;&#x4E86;&#x3002;</p>
<p>&#x5DF2;&#x7ECF;&#x8FD0;&#x884C;&#x7740;&#x7684;&#x7A0B;&#x5E8F;&#x4F1A;&#x7EE7;&#x7EED;&#x4F7F;&#x7528;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x4E0A;&#x4E00;&#x4E2A;&#x6B21;&#x8981;&#x7248;&#x672C;&#xFF0C;&#x53EA;&#x6709;&#x5F53;&#x5B83;&#x4EEC;&#x7EC8;&#x6B62;&#x6216;&#x91CD;&#x542F;&#x4E4B;&#x540E;&#x624D;&#x4F1A;&#x4F7F;&#x7528;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x65B0;&#x6B21;&#x8981;&#x7248;&#x672C;&#x3002;</p>
<p>&#x5982;&#x679C;&#x540E;&#x9762;&#x9700;&#x8981;&#x521B;&#x5EFA;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x4E00;&#x4E2A;&#x65B0;&#x4E3B;&#x8981;&#x7248;&#x672C;&#xFF08;2.0.0&#xFF09;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x9700;&#x8981;&#x5B8C;&#x6210;&#xFF1A;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">su</span>
Password
<span class="token comment" spellcheck="true"># gcc -g -c -fPIC -Wall mod1.c mod2.c mod3.c</span>
<span class="token comment" spellcheck="true"># gcc -g -shared -Wl,-soname,libdemo.so.1 -o libdemo.so.1.0.1 mod1.o mod2.o mod3.o</span>
<span class="token comment" spellcheck="true"># mv libdemo.so.2.0.0 /usr/lib</span>
<span class="token comment" spellcheck="true"># ldconfig -v | grep libdemo</span>
        libdemo.so.1 -<span class="token operator">&gt;</span> libdemo.so.1.0.2
        libdemo.so.2 -<span class="token operator">&gt;</span> libdemo.so.2.0.1<span class="token punctuation">(</span>changed<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># cd /usr/lib</span>
<span class="token comment" spellcheck="true"># ln -sf libdemo.so.2 libdemo.so</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x4ECE;&#x4E0A;&#x9762;&#x7684;&#x8F93;&#x51FA;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF0C;ldconfig&#x81EA;&#x52A8;&#x4E3A;&#x65B0;&#x4E3B;&#x8981;&#x7248;&#x672C;&#x521B;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A;soname&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#xFF0C;&#x4F46;&#x4ECE;&#x6700;&#x540E;&#x4E00;&#x6761;&#x547D;&#x4EE4;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF0C;&#x5FC5;&#x987B;&#x8981;&#x624B;&#x5DE5;&#x66F4;&#x65B0;&#x94FE;&#x63A5;&#x5668;&#x540D;&#x79F0;&#x7684;&#x7B26;&#x53F7;&#x94FE;&#x63A5;&#x3002;</p>
<h2 id="&#x5728;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x4E2D;&#x6307;&#x5B9A;&#x5E93;&#x641C;&#x7D22;&#x76EE;&#x5F55;"><a href="#&#x5728;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x4E2D;&#x6307;&#x5B9A;&#x5E93;&#x641C;&#x7D22;&#x76EE;&#x5F55;" class="headerlink" title="&#x5728;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x4E2D;&#x6307;&#x5B9A;&#x5E93;&#x641C;&#x7D22;&#x76EE;&#x5F55;"></a>&#x5728;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x4E2D;&#x6307;&#x5B9A;&#x5E93;&#x641C;&#x7D22;&#x76EE;&#x5F55;</h2><p>&#x5230;&#x76EE;&#x524D;&#x4E3A;&#x6B62;&#x672C;&#x7AE0;&#x5DF2;&#x7ECF;&#x4ECB;&#x7ECD;&#x4E86;&#x4E24;&#x79CD;&#x901A;&#x77E5;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x4F4D;&#x7F6E;&#x7684;&#x65B9;&#x5F0F;&#xFF1A;&#x4F7F;&#x7528;LD_LIBRARY_PATH&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x548C;&#x5C06;&#x5171;&#x4EAB;&#x5E93;&#x5B89;&#x88C5;&#x5230;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x6807;&#x51C6;&#x5E93;&#x76EE;&#x5F55;&#x4E2D;&#xFF08;/lib&#x3001;/usr/lib&#x6216;&#x5728;/etc/ld.so.conf&#x4E2D;&#x5217;&#x51FA;&#x7684;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x76EE;&#x5F55;&#xFF09;&#x3002;</p>
<p>&#x8FD8;&#x5B58;&#x5728;&#x7B2C;&#x4E09;&#x79CD;&#x65B9;&#x5F0F;&#xFF1A;&#x5728;&#x9759;&#x6001;&#x7F16;&#x8F91;&#x9636;&#x6BB5;&#x53EF;&#x4EE5;&#x5728;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x4E2D;&#x63D2;&#x5165;&#x4E00;&#x4E2A;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x641C;&#x7D22;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x76EE;&#x5F55;&#x5217;&#x8868;&#x3002;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x5BF9;&#x4E8E;&#x5E93;&#x4F4D;&#x4E8E;&#x4E00;&#x4E2A;&#x56FA;&#x5B9A;&#x7684;&#x4F46;&#x4E0D;&#x5C5E;&#x4E8E;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x641C;&#x7D22;&#x7684;&#x6807;&#x51C6;&#x4F4D;&#x7F6E;&#x7684;&#x4F4D;&#x7F6E;&#x4E2D;&#x65F6;&#x662F;&#x975E;&#x5E38;&#x6709;&#x7528;&#x7684;&#x3002;&#x8981;&#x5B9E;&#x73B0;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x9700;&#x8981;&#x5728;&#x521B;&#x5EFA;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x65F6;&#x4F7F;&#x7528;-rpath&#x94FE;&#x63A5;&#x5668;&#x9009;&#x9879;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ gcc -g -Wall -Wl,-rpath,/home/mkt/pdir -o prog prog.c libdemo.so<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>&#x4E0A;&#x9762;&#x7684;&#x547D;&#x4EE4;&#x5C06;&#x5B57;&#x7B26;&#x4E32;/home/mtk/pdir&#x590D;&#x5236;&#x5230;&#x4E86;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;prog&#x7684;&#x8FD0;&#x884C;&#x65F6;&#x5E93;&#x8DEF;&#x5F84;&#xFF08;rpath&#xFF09;&#x5217;&#x8868;&#x4E2D;&#xFF0C;&#x56E0;&#x6B64;&#x5F53;&#x8FD0;&#x884C;&#x8FD9;&#x4E2A;&#x7A0B;&#x5E8F;&#x65F6;&#xFF0C;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x5728;&#x89E3;&#x6790;&#x5171;&#x4EAB;&#x5E93;&#x5F15;&#x7528;&#x65F6;&#x8FD8;&#x4F1A;&#x641C;&#x7D22;&#x8FD9;&#x4E2A;&#x76EE;&#x5F55;&#x3002;<br>&#x5982;&#x679C;&#x6709;&#x5FC5;&#x8981;&#x7684;&#x8BDD;&#xFF0C;&#x53EF;&#x4EE5;&#x591A;&#x6B21;&#x6307;&#x5B9A;&#x2013;rpath&#x9009;&#x9879;&#xFF1B;&#x6240;&#x6709;&#x8FD9;&#x4E9B;&#x5217;&#x51FA;&#x7684;&#x76EE;&#x5F55;&#x4F1A;&#x88AB;&#x8FDE;&#x63A5;&#x6210;&#x4E00;&#x4E2A;&#x653E;&#x5230;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x6709;&#x5E8F;rpath&#x5217;&#x8868;&#x3002;&#x6216;&#x8005;&#xFF0C;&#x5728;&#x4E00;&#x4E2A;rpath&#x9009;&#x9879;&#x4E2D;&#x53EF;&#x4EE5;&#x6307;&#x5B9A;&#x591A;&#x4E2A;&#x7531;&#x5206;&#x53F7;&#x5206;&#x5272;&#x5F00;&#x6765;&#x7684;&#x76EE;&#x5F55;&#x5217;&#x8868;&#x3002;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#xFF0C;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x4F1A;&#x6309;&#x7167;&#x5728;&#x2013;rpath&#x9009;&#x9879;&#x4E2D;&#x6307;&#x5B9A;&#x7684;&#x76EE;&#x5F55;&#x987A;&#x5E8F;&#x6765;&#x641C;&#x7D22;&#x76EE;&#x5F55;&#x3002;</p>
<p>-rpath&#x9009;&#x9879;&#x7684;&#x4E00;&#x4E2A;&#x66FF;&#x4EE3;&#x65B9;&#x6848;&#x662F;LD_RUN_PATH&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x3002;&#x53EF;&#x4EE5;&#x5C06;&#x4E00;&#x4E2A;&#x7531;&#x5206;&#x53F7;&#x5206;&#x9694;&#x5F00;&#x6765;&#x7684;&#x76EE;&#x5F55;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x8D4B;&#x7ED9;&#x8BE5;&#x53D8;&#x91CF;&#xFF0C;&#x5F53;&#x6784;&#x5EFA;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x65F6;&#x53EF;&#x4EE5;&#x5C06;&#x8FD9;&#x4E2A;&#x53D8;&#x91CF;&#x4F5C;&#x4E3A;rpath&#x5217;&#x8868;&#x6765;&#x4F7F;&#x7528;&#x3002;&#x53EA;&#x6709;&#x5F53;&#x6784;&#x5EFA;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x65F6;&#x4E0D;&#x6307;&#x5B9A;-rpath&#x9009;&#x9879;&#x65F6;&#x624D;&#x4F1A;&#x4F7F;&#x7528;LD_RUN_PATH&#x53D8;&#x91CF;&#x3002;</p>
<h3 id="&#x5728;&#x6784;&#x5EFA;&#x5171;&#x4EAB;&#x5E93;&#x65F6;&#x4F7F;&#x7528;&#x2013;rpath&#x94FE;&#x63A5;&#x5668;&#x9009;&#x9879;"><a href="#&#x5728;&#x6784;&#x5EFA;&#x5171;&#x4EAB;&#x5E93;&#x65F6;&#x4F7F;&#x7528;&#x2013;rpath&#x94FE;&#x63A5;&#x5668;&#x9009;&#x9879;" class="headerlink" title="&#x5728;&#x6784;&#x5EFA;&#x5171;&#x4EAB;&#x5E93;&#x65F6;&#x4F7F;&#x7528;&#x2013;rpath&#x94FE;&#x63A5;&#x5668;&#x9009;&#x9879;"></a>&#x5728;&#x6784;&#x5EFA;&#x5171;&#x4EAB;&#x5E93;&#x65F6;&#x4F7F;&#x7528;&#x2013;rpath&#x94FE;&#x63A5;&#x5668;&#x9009;&#x9879;</h3><p>&#x5728;&#x6784;&#x5EFA;&#x5171;&#x4EAB;&#x5E93;&#x65F6;&#x2013;rpath&#x9009;&#x9879;&#x4E5F;&#x662F;&#x6709;&#x7528;&#x7684;&#x3002;&#x5047;&#x8BBE;&#x6709;&#x4E00;&#x4E2A;&#x4F9D;&#x8D56;&#x4E8E;&#x53E6;&#x4E00;&#x4E2A;&#x5171;&#x4EAB;&#x5E93;libx2.so&#x7684;&#x5171;&#x4EAB;&#x5E93;libx1.so&#xFF0C;&#x5982;&#x56FE;41-4&#x6240;&#x793A;&#x3002;&#x53E6;&#x5916;&#x518D;&#x5047;&#x8BBE;&#x8FD9;&#x4E9B;&#x5E93;&#x5206;&#x522B;&#x4F4D;&#x4E8E;&#x975E;&#x6807;&#x51C6;&#x76EE;&#x5F55;d1&#x548C;d2&#x4E2D;&#x3002;&#x4E0B;&#x9762;&#x4ECB;&#x7ECD;&#x6784;&#x5EFA;&#x8FD9;&#x4E9B;&#x5E93;&#x4EE5;&#x53CA;&#x4F7F;&#x7528;&#x5B83;&#x4EEC;&#x7684;&#x7A0B;&#x5E8F;&#x6240;&#x9700;&#x5B8C;&#x6210;&#x7684;&#x6B65;&#x9AA4;&#x3002;<br></p><div class="amp-img-wrapper"><amp-img src="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1581821425399.png?x-oss-process=image/resize,m_lfit,h_450" width="754" height="192" layout="responsive"></amp-img></div><br>&#x9996;&#x5148;&#x5728;pdir/d2&#x76EE;&#x5F55;&#x4E2D;&#x6784;&#x5EFA;libx2.so&#x3002;&#xFF08;&#x4E3A;&#x4E86;&#x4F7F;&#x8FD9;&#x4E2A;&#x4F8B;&#x5B50;&#x7B80;&#x5355;&#x4E00;&#x70B9;&#xFF0C;&#x8FD9;&#x91CC;&#x7701;&#x7565;&#x4E86;&#x5E93;&#x7684;&#x7248;&#x672C;&#x53F7;&#x548C;soname&#x3002;&#xFF09;
<pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">cd</span> /home/mtk/pdir/d2
$ gcc -g -c -fPUC -Wall modx2.c
$ gcc -g -shared -o libx2.so modx2.o<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x63A5;&#x7740;&#x5728;pdir/d1&#x76EE;&#x5F55;&#x4E2D;&#x6784;&#x5EFA;libx1.so&#x3002;&#x7531;&#x4E8E;libx1.so&#x4F9D;&#x8D56;&#x4E8E;libx2.so&#xFF0C;&#x5E76;&#x4E14;libx2.so&#x4F4D;&#x4E8E;&#x4E00;&#x4E2A;&#x975E;&#x6807;&#x51C6;&#x76EE;&#x5F55;&#x4E2D;&#xFF0C;&#x56E0;&#x6B64;&#x5728;&#x6307;&#x5B9A;libx2.so&#x7684;&#x8FD0;&#x884C;&#x65F6;&#x4F4D;&#x7F6E;&#x65F6;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x2013;rpath&#x94FE;&#x63A5;&#x5668;&#x9009;&#x9879;&#x3002;&#x8FD9;&#x4E2A;&#x9009;&#x9879;&#x7684;&#x53D6;&#x503C;&#x4E0E;&#x5E93;&#x7684;&#x94FE;&#x63A5;&#x65F6;&#x4F4D;&#x7F6E;&#xFF08;&#x7531;-L&#x9009;&#x9879;&#x6307;&#x5B9A;&#xFF09;&#x53EF;&#x4EE5;&#x4E0D;&#x540C;&#xFF0C;&#x5C3D;&#x7BA1;&#x5728;&#x8FD9;&#x4E2A;&#x4F8B;&#x5B50;&#x4E2D;&#x8FD9;&#x4E24;&#x4E2A;&#x4F4D;&#x7F6E;&#x662F;&#x76F8;&#x540C;&#x7684;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">cd</span> /home/mtk/pdir/d1
$ gcc -g -c -Wall -fPIC modx1.c
$ gcc -g -shared -o libx1.so modx1.o -Wl,-rpath,/home/mtk/pdir/d2 -L/home/mtk/pdir/d2 -lx2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x6700;&#x540E;&#x5728;pdir&#x76EE;&#x5F55;&#x4E2D;&#x6784;&#x5EFA;&#x4E3B;&#x7A0B;&#x5E8F;&#x3002;&#x7531;&#x4E8E;&#x4E3B;&#x7A0B;&#x5E8F;&#x4F7F;&#x7528;&#x4E86;libx1.so&#x5E76;&#x4E14;&#x8FD9;&#x4E2A;&#x5E93;&#x4F4D;&#x4E8E;&#x4E00;&#x4E2A;&#x975E;&#x6807;&#x51C6;&#x76EE;&#x5F55;&#x4E2D;&#xFF0C;&#x56E0;&#x6B64;&#x8FD8;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x2013;rpath&#x94FE;&#x63A5;&#x5668;&#x9009;&#x9879;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">cd</span> /home/mtk/pdir
$ gcc -g -Wall -o prog prog.c -Wl,-rpath,/home/mtk/pdir/d1/ -L/home/mtk/pdir/d1 -lx1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x6CE8;&#x610F;&#x5728;&#x94FE;&#x63A5;&#x4E3B;&#x7A0B;&#x5E8F;&#x65F6;&#x65E0;&#x9700;&#x6307;&#x5B9A;libx2.so&#x3002;&#x7531;&#x4E8E;&#x94FE;&#x63A5;&#x5668;&#x80FD;&#x591F;&#x5206;&#x6790;libx1.so&#x4E2D;&#x7684;rpath&#x5217;&#x8868;&#xFF0C;&#x56E0;&#x6B64;&#x5B83;&#x80FD;&#x591F;&#x627E;&#x5230;libx2.so&#xFF0C;&#x540C;&#x65F6;&#x5728;&#x9759;&#x6001;&#x94FE;&#x63A5;&#x9636;&#x6BB5;&#x89E3;&#x6790;&#x51FA;&#x6240;&#x6709;&#x7684;&#x7B26;&#x53F7;&#x3002;</p>
<p>&#x4F7F;&#x7528;&#x4E0B;&#x9762;&#x7684;&#x547D;&#x4EE4;&#x80FD;&#x591F;&#x68C0;&#x67E5;prog&#x548C;libx1.so&#x4EE5;&#x4FBF;&#x67E5;&#x770B;&#x5B83;&#x4EEC;&#x7684;rpath&#x5217;&#x8868;&#x7684;&#x5185;&#x5BB9;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ objdump -p prog <span class="token operator">|</span> <span class="token function">grep</span> PATH
  RPATH      /home/mtk/pdir/d1
$ objdump -p d1/libx1.so <span class="token operator">|</span> <span class="token function">grep</span>    PATH
  RPATH      /home/mtk/pdir/d2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x8FD8;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x67E5;&#x627E;readelf &#x2013; &#x2013;dynamic&#xFF08;&#x6216;&#x7B49;&#x4EF7;&#x7684;readelf &#x2013;d&#xFF09;&#x547D;&#x4EE4;&#x7684;&#x8F93;&#x51FA;&#x6765;&#x67E5;&#x770B;rpath&#x5217;&#x8868;&#x3002;</p>
<p>&#x4F7F;&#x7528;ldd&#x547D;&#x4EE4;&#x80FD;&#x591F;&#x5217;&#x51FA;prog&#x7684;&#x5B8C;&#x6574;&#x7684;&#x52A8;&#x6001;&#x4F9D;&#x8D56;&#x5217;&#x8868;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ ldd prog<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="ELF-DT-RPATH&#x548C;DT-RUNPATH&#x6761;&#x76EE;"><a href="#ELF-DT-RPATH&#x548C;DT-RUNPATH&#x6761;&#x76EE;" class="headerlink" title="ELF DT_RPATH&#x548C;DT_RUNPATH&#x6761;&#x76EE;"></a>ELF DT_RPATH&#x548C;DT_RUNPATH&#x6761;&#x76EE;</h3><p>&#x5728;&#x7B2C;&#x4E00;&#x7248;ELF&#x89C4;&#x8303;&#x4E2D;&#xFF0C;&#x53EA;&#x6709;&#x4E00;&#x79CD;rpath&#x5217;&#x8868;&#x80FD;&#x591F;&#x88AB;&#x5D4C;&#x5165;&#x5230;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x6216;&#x5171;&#x4EAB;&#x5E93;&#x4E2D;&#xFF0C;&#x5B83;&#x5BF9;&#x5E94;&#x4E8E;ELF&#x6587;&#x4EF6;&#x4E2D;&#x7684;DT_RPATH&#x6807;&#x7B7E;&#x3002;&#x540E;&#x7EED;&#x7684;ELF&#x89C4;&#x8303;&#x820D;&#x5F03;&#x4E86;DT_RPATH&#xFF0C;&#x540C;&#x65F6;&#x5F15;&#x5165;&#x4E86;&#x4E00;&#x79CD;&#x65B0;&#x6807;&#x7B7E;DT_RUNPATH&#x6765;&#x8868;&#x793A;rpath&#x5217;&#x8868;&#x3002;&#x8FD9;&#x4E24;&#x79CD;rpath&#x5217;&#x8868;&#x4E4B;&#x95F4;&#x7684;&#x5DEE;&#x522B;&#x5728;&#x4E8E;&#x5F53;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x641C;&#x7D22;&#x5171;&#x4EAB;&#x5E93;&#x65F6;&#x5B83;&#x4EEC;&#x76F8;&#x5BF9;&#x4E8E;LD_LIBRARY_PATH&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#xFF1A;DT_RPATH&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x66F4;&#x9AD8;&#xFF0C;&#x800C;DT_RUNPATH&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x5219;&#x66F4;&#x4F4E;&#x3002;</p>
<p>&#x5728;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x94FE;&#x63A5;&#x5668;&#x4F1A;&#x5C06;rpath&#x5217;&#x8868;&#x521B;&#x5EFA;&#x4E3A;DT_RPATH&#x6807;&#x7B7E;&#x3002;&#x4E3A;&#x4E86;&#x8BA9;&#x94FE;&#x63A5;&#x5668;&#x5C06;rpath&#x5217;&#x8868;&#x521B;&#x5EFA;&#x4E3A;DT_RUNPATH&#x6761;&#x76EE;&#x5FC5;&#x987B;&#x8981;&#x989D;&#x5916;&#x4F7F;&#x7528;&#x2013; &#x2013;enable&#x2013;new&#x2013;dtags(&#x542F;&#x7528;&#x65B0;&#x52A8;&#x6001;&#x6807;&#x7B7E;)&#x94FE;&#x63A5;&#x5668;&#x9009;&#x9879;&#x3002;&#x5982;&#x679C;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x9009;&#x9879;&#x91CD;&#x5EFA;&#x7A0B;&#x5E8F;&#x5E76;&#x4E14;&#x4F7F;&#x7528;objdump&#x67E5;&#x770B;&#x83B7;&#x5F97;&#x7684;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#xFF0C;&#x90A3;&#x4E48;&#x5C06;&#x4F1A;&#x770B;&#x5230;&#x4E0B;&#x9762;&#x8FD9;&#x6837;&#x7684;&#x8F93;&#x51FA;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ objdump -p prog <span class="token operator">|</span> <span class="token function">grep</span> PATH
    RPATH    /home/mtk/pdir/d1
    RUNPATH  /home/mtk/pdir/d1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x4ECE;&#x4E0A;&#x9762;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF0C;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x5305;&#x542B;&#x4E86;DT_RPATH&#x548C;DT_RUNPATH&#x6807;&#x7B7E;&#x3002;&#x94FE;&#x63A5;&#x5668;&#x91C7;&#x7528;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x590D;&#x5199;&#x4E86;rpath&#x5217;&#x8868;&#x662F;&#x4E3A;&#x4E86;&#x8BA9;&#x4E0D;&#x7406;&#x89E3;DT_RUNPATH&#x6807;&#x7B7E;&#x7684;&#x8001;&#x5F0F;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x80FD;&#x591F;&#x6B63;&#x5E38;&#x5DE5;&#x4F5C;&#x3002;&#xFF08;glibc 2.2&#x589E;&#x52A0;&#x4E86;&#x5BF9;DT_RUNPATH&#x7684;&#x652F;&#x6301;&#xFF09;&#x3002;&#x7406;&#x89E3;DT_RUNPATH&#x6807;&#x7B7E;&#x7684;&#x94FE;&#x63A5;&#x5668;&#x4F1A;&#x5FFD;&#x7565;DT_RPATH&#x6807;&#x7B7E;&#x3002;</p>
<h3 id="&#x5728;rpath&#x4E2D;&#x4F7F;&#x7528;-ORIGIN"><a href="#&#x5728;rpath&#x4E2D;&#x4F7F;&#x7528;-ORIGIN" class="headerlink" title="&#x5728;rpath&#x4E2D;&#x4F7F;&#x7528;$ORIGIN"></a>&#x5728;rpath&#x4E2D;&#x4F7F;&#x7528;$ORIGIN</h3><p>&#x5047;&#x8BBE;&#x9700;&#x8981;&#x53D1;&#x5E03;&#x4E00;&#x4E2A;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#xFF0C;&#x8FD9;&#x4E2A;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4F7F;&#x7528;&#x4E86;&#x81EA;&#x8EAB;&#x7684;&#x5171;&#x4EAB;&#x5E93;&#xFF0C;&#x4F46;&#x540C;&#x65F6;&#x4E0D;&#x5E0C;&#x671B;&#x5F3A;&#x5236;&#x8981;&#x6C42;&#x7528;&#x6237;&#x5C06;&#x8FD9;&#x4E9B;&#x5E93;&#x5B89;&#x88C5;&#x5728;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x6807;&#x51C6;&#x76EE;&#x5F55;&#x4E2D;&#xFF0C;&#x76F8;&#x53CD;&#xFF0C;&#x9700;&#x8981;&#x5141;&#x8BB8;&#x7528;&#x6237;&#x5C06;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x89E3;&#x538B;&#x5230;&#x4EFB;&#x610F;&#x5F02;&#x76EE;&#x5F55;&#x4E2D;&#xFF0C;&#x7136;&#x540E;&#x80FD;&#x591F;&#x7ACB;&#x5373;&#x8FD0;&#x884C;&#x8FD9;&#x4E2A;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x3002;&#x8FD9;&#x91CC;&#x5B58;&#x5728;&#x7684;&#x95EE;&#x9898;&#x662F;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x65E0;&#x6CD5;&#x786E;&#x5B9A;&#x5B58;&#x653E;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x4F4D;&#x7F6E;&#xFF0C;&#x9664;&#x975E;&#x8981;&#x6C42;&#x7528;&#x6237;&#x8BBE;&#x7F6E;LD_LIBRARY_PATH&#x6216;&#x8005;&#x8981;&#x6C42;&#x7528;&#x6237;&#x8FD0;&#x884C;&#x67D0;&#x79CD;&#x80FD;&#x591F;&#x6807;&#x8BC6;&#x51FA;&#x6240;&#x9700;&#x7684;&#x76EE;&#x5F55;&#x7684;&#x5B89;&#x88C5;&#x811A;&#x672C;&#xFF0C;&#x4F46;&#x8FD9;&#x4E24;&#x79CD;&#x65B9;&#x6CD5;&#x90FD;&#x4E0D;&#x662F;&#x4EE4;&#x4EBA;&#x6EE1;&#x610F;&#x7684;&#x65B9;&#x6CD5;&#x3002;</p>
<p>&#x4E3A;&#x89E3;&#x51B3;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x5728;&#x6784;&#x5EFA;&#x94FE;&#x63A5;&#x5668;&#x7684;&#x65F6;&#x5019;&#x589E;&#x52A0;&#x4E86;&#x5BF9;rpath&#x89C4;&#x8303;&#x4E2D;&#x7279;&#x6B8A;&#x5B57;&#x7B26;&#x4E32;<amp-mathml layout="container" inline data-formula="\[ORIGIN&#xFF08;&#x6216;&#x7B49;&#x4EF7;&#x7684;\]"></amp-mathml>{ORIGIN}&#xFF09;&#x7684;&#x652F;&#x6301;&#x3002;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x5C06;&#x8FD9;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x89E3;&#x91CA;&#x6210;&#x201C;&#x5305;&#x542B;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x76EE;&#x5F55;&#x201D;&#x3002;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4E0B;&#x9762;&#x7684;&#x547D;&#x4EE4;&#x6765;&#x6784;&#x5EFA;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ gcc -Wl,-rpath,<span class="token string">&apos;<span class="token variable">$ORIGIN</span>&apos;</span>/lib <span class="token punctuation">..</span>.<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>&#x4E0A;&#x9762;&#x7684;&#x547D;&#x4EE4;&#x5047;&#x8BBE;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x5171;&#x4EAB;&#x5E93;&#x4F4D;&#x4E8E;&#x5305;&#x542B;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x7684;&#x76EE;&#x5F55;&#x7684;&#x5B50;&#x76EE;&#x5F55;lib&#x4E2D;&#x3002;&#x8FD9;&#x6837;&#x5C31;&#x80FD;&#x5411;&#x7528;&#x6237;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x5305;&#x542B;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x53CA;&#x76F8;&#x5173;&#x7684;&#x5E93;&#x7684;&#x5B89;&#x88C5;&#x5305;&#xFF0C;&#x540C;&#x65F6;&#x5141;&#x8BB8;&#x7528;&#x6237;&#x5C06;&#x8FD9;&#x4E2A;&#x5305;&#x5B89;&#x88C5;&#x5728;&#x4EFB;&#x610F;&#x4F4D;&#x7F6E;&#x5E76;&#x8FD0;&#x884C;&#x8FD9;&#x4E2A;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E86;&#xFF08;&#x5373;&#x6240;&#x8C13;&#x7684;&#x201C;turn-key&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x201D;&#xFF09;&#x3002;</p>
<h2 id="&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x627E;&#x51FA;&#x5171;&#x4EAB;&#x5E93;"><a href="#&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x627E;&#x51FA;&#x5171;&#x4EAB;&#x5E93;" class="headerlink" title="&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x627E;&#x51FA;&#x5171;&#x4EAB;&#x5E93;"></a>&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x627E;&#x51FA;&#x5171;&#x4EAB;&#x5E93;</h2><p>&#x5728;&#x89E3;&#x6790;&#x5E93;&#x4F9D;&#x8D56;&#x65F6;&#xFF0C;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x9996;&#x5148;&#x4F1A;&#x68C0;&#x67E5;&#x5404;&#x4E2A;&#x4F9D;&#x8D56;&#x5B57;&#x7B26;&#x4E32;&#x4EE5;&#x786E;&#x5B9A;&#x5B83;&#x662F;&#x5426;&#x5305;&#x542B;&#x659C;&#x7EBF;&#xFF08;/&#xFF09;&#xFF0C;&#x56E0;&#x4E3A;&#x5728;&#x94FE;&#x63A5;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x65F6;&#x5982;&#x679C;&#x6307;&#x5B9A;&#x4E86;&#x4E00;&#x4E2A;&#x663E;&#x5F0F;&#x7684;&#x5E93;&#x8DEF;&#x5F84;&#x540D;&#x7684;&#x8BDD;&#x5C31;&#x4F1A;&#x53D1;&#x751F;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x3002;&#x5982;&#x679C;&#x627E;&#x5230;&#x4E86;&#x4E00;&#x4E2A;&#x659C;&#x7EBF;&#xFF0C;&#x90A3;&#x4E48;&#x4F9D;&#x8D56;&#x5B57;&#x7B26;&#x4E32;&#x5C31;&#x4F1A;&#x88AB;&#x89E3;&#x91CA;&#x6210;&#x4E00;&#x4E2A;&#x8DEF;&#x5F84;&#x540D;&#xFF08;&#x7EDD;&#x5BF9;&#x8DEF;&#x5F84;&#x540D;&#x6216;&#x76F8;&#x5BF9;&#x8DEF;&#x5F84;&#x540D;&#xFF09;&#xFF0C;&#x5E76;&#x4E14;&#x4F1A;&#x4F7F;&#x7528;&#x8BE5;&#x8DEF;&#x5F84;&#x540D;&#x52A0;&#x8F7D;&#x5E93;&#x3002;&#x5426;&#x5219;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x4F1A;&#x4F7F;&#x7528;&#x4E0B;&#x9762;&#x7684;&#x89C4;&#x5219;&#x6765;&#x641C;&#x7D22;&#x5171;&#x4EAB;&#x5E93;&#x3002;<br>1&#xFF0E; &#x5982;&#x679C;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x7684;DT_RPATH&#x8FD0;&#x884C;&#x65F6;&#x5E93;&#x8DEF;&#x5F84;&#x5217;&#x8868;&#xFF08;rpath&#xFF09;&#x4E2D;&#x5305;&#x542B;&#x76EE;&#x5F55;&#x5E76;&#x4E14;&#x4E0D;&#x5305;&#x542B;DT_RUNPATH&#x5217;&#x8868;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x641C;&#x7D22;&#x8FD9;&#x4E9B;&#x76EE;&#x5F55;&#xFF08;&#x6309;&#x7167;&#x94FE;&#x63A5;&#x7A0B;&#x5E8F;&#x65F6;&#x6307;&#x5B9A;&#x7684;&#x76EE;&#x5F55;&#x987A;&#x5E8F;&#xFF09;&#x3002;<br>2&#xFF0E; &#x5982;&#x679C;&#x5B9A;&#x4E49;&#x4E86;LD_LIBRARY_PATH&#x73AF;&#x5883;&#x53D8;&#x91CF;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x4F1A;&#x8F6E;&#x6D41;&#x641C;&#x7D22;&#x8BE5;&#x53D8;&#x91CF;&#x503C;&#x4E2D;&#x4EE5;&#x5192;&#x53F7;&#x5206;&#x9694;&#x7684;&#x5404;&#x4E2A;&#x76EE;&#x5F55;&#x3002;&#x5982;&#x679C;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x662F;&#x4E00;&#x4E2A;set-user-ID&#x6216;set-group-ID&#x7A0B;&#x5E8F;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x4F1A;&#x5FFD;&#x7565;LD_LIBRARY_PATH&#x53D8;&#x91CF;&#x3002;&#x8FD9;&#x9879;&#x5B89;&#x5168;&#x63AA;&#x65BD;&#x662F;&#x4E3A;&#x4E86;&#x9632;&#x6B62;&#x7528;&#x6237;&#x6B3A;&#x9A97;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x8BA9;&#x5176;&#x52A0;&#x8F7D;&#x4E00;&#x4E2A;&#x4E0E;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x6240;&#x9700;&#x7684;&#x5E93;&#x7684;&#x540D;&#x79F0;&#x4E00;&#x6837;&#x7684;&#x79C1;&#x6709;&#x5E93;&#x3002;<br>3&#xFF0E; &#x5982;&#x679C;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;DT_RUNPATH&#x8FD0;&#x884C;&#x65F6;&#x5E93;&#x8DEF;&#x5F84;&#x5217;&#x8868;&#x4E2D;&#x5305;&#x542B;&#x76EE;&#x5F55;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x4F1A;&#x641C;&#x7D22;&#x8FD9;&#x4E9B;&#x76EE;&#x5F55;&#xFF08;&#x6309;&#x7167;&#x94FE;&#x63A5;&#x7A0B;&#x5E8F;&#x65F6;&#x6307;&#x5B9A;&#x7684;&#x76EE;&#x5F55;&#x987A;&#x5E8F;&#xFF09;&#x3002;<br>4&#xFF0E; &#x68C0;&#x67E5;/etc/ld.so.cache&#x6587;&#x4EF6;&#x4EE5;&#x786E;&#x8BA4;&#x5B83;&#x662F;&#x5426;&#x5305;&#x542B;&#x4E86;&#x4E0E;&#x5E93;&#x76F8;&#x5173;&#x7684;&#x6761;&#x76EE;&#x3002;<br>5&#xFF0E; &#x641C;&#x7D22;/lib&#x548C;/usr/lib&#x76EE;&#x5F55;&#xFF08;&#x6309;&#x7167;&#x8FD9;&#x4E2A;&#x987A;&#x5E8F;&#xFF09;&#x3002;</p>
<h3 id="&#x8FD0;&#x884C;&#x65F6;&#x7B26;&#x53F7;&#x89E3;&#x6790;"><a href="#&#x8FD0;&#x884C;&#x65F6;&#x7B26;&#x53F7;&#x89E3;&#x6790;" class="headerlink" title="&#x8FD0;&#x884C;&#x65F6;&#x7B26;&#x53F7;&#x89E3;&#x6790;"></a>&#x8FD0;&#x884C;&#x65F6;&#x7B26;&#x53F7;&#x89E3;&#x6790;</h3><p>&#x5047;&#x8BBE;&#x5728;&#x591A;&#x4E2A;&#x5730;&#x65B9;&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x4E2A;&#x5168;&#x5C40;&#x7B26;&#x53F7;&#xFF08;&#x5373;&#x51FD;&#x6570;&#x6216;&#x53D8;&#x91CF;&#xFF09;&#xFF0C;&#x5982;&#x5728;&#x4E00;&#x4E2A;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x548C;&#x4E00;&#x4E2A;&#x5171;&#x4EAB;&#x5E93;&#x4E2D;&#x6216;&#x5728;&#x591A;&#x4E2A;&#x5171;&#x4EAB;&#x5E93;&#x4E2D;&#x3002;&#x90A3;&#x4E48;&#x5982;&#x4F55;&#x89E3;&#x6790;&#x6307;&#x5411;&#x8FD9;&#x4E2A;&#x7B26;&#x53F7;&#x7684;&#x5F15;&#x7528;&#x5462;&#xFF1F;</p>
<p>&#x5047;&#x8BBE;&#x73B0;&#x5728;&#x6709;&#x4E00;&#x4E2A;&#x4E3B;&#x7A0B;&#x5E8F;&#x548C;&#x4E00;&#x4E2A;&#x5171;&#x4EAB;&#x5E93;&#xFF0C;&#x5B83;&#x4EEC;&#x4E24;&#x4E2A;&#x90FD;&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x4E2A;&#x5168;&#x5C40;&#x51FD;&#x6570;xyz()&#xFF0C;&#x5E76;&#x4E14;&#x5171;&#x4EAB;&#x5E93;&#x4E2D;&#x7684;&#x53E6;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x4E86;xyz()&#xFF0C;&#x5982;&#x56FE;&#x6240;&#x793A;&#x3002;<br></p><div class="amp-img-wrapper"><amp-img src="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1581822733350.png?x-oss-process=image/resize,m_lfit,h_450" width="822" height="273" layout="responsive"></amp-img></div>
<p>&#x5728;&#x6784;&#x5EFA;&#x5171;&#x4EAB;&#x5E93;&#x548C;&#x53EF;&#x6267;&#x884C;&#x7A0B;&#x5E8F;&#x5E76;&#x8FD0;&#x884C;&#x8FD9;&#x4E2A;&#x7A0B;&#x5E8F;&#x4E4B;&#x540E;&#x80FD;&#x591F;&#x770B;&#x5230;&#x4E0B;&#x9762;&#x7684;&#x8F93;&#x51FA;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash"> $ gcc -g -c -fPIC -Wall -c foo.c
$ gcc -g -shared -o libfoo.so foo.o
$ gcc -g -o prog prog.c libfoo.so
$ LD_LIBRARY_PATH<span class="token operator">=</span>. ./prog
main-xyz<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x4ECE;&#x4E0A;&#x9762;&#x8F93;&#x51FA;&#x7684;&#x6700;&#x540E;&#x4E00;&#x884C;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF0C;&#x4E3B;&#x7A0B;&#x5E8F;&#x4E2D;&#x7684;xyz()&#x5B9A;&#x4E49;&#x8986;&#x76D6;&#xFF08;&#x4F18;&#x5148;&#xFF09;&#x4E86;&#x5171;&#x4EAB;&#x5E93;&#x4E2D;&#x7684;&#x5B9A;&#x4E49;&#x3002;</p>
<p>&#x5C3D;&#x7BA1;&#x8FD9;&#x79CD;&#x5904;&#x7406;&#x65B9;&#x5F0F;&#x5728;&#x4E00;&#x5F00;&#x59CB;&#x770B;&#x8D77;&#x6765;&#x6709;&#x4E9B;&#x4EE4;&#x4EBA;&#x60CA;&#x8BB6;&#xFF0C;&#x4F46;&#x8FD9;&#x6837;&#x505A;&#x662F;&#x6709;&#x5386;&#x53F2;&#x539F;&#x56E0;&#x7684;&#x3002;&#x7B2C;&#x4E00;&#x4E2A;&#x5171;&#x4EAB;&#x5E93;&#x5B9E;&#x73B0;&#x5728;&#x8BBE;&#x8BA1;&#x65F6;&#x7684;&#x76EE;&#x6807;&#x662F;&#x4F7F;&#x7B26;&#x53F7;&#x89E3;&#x6790;&#x7684;&#x9ED8;&#x8BA4;&#x8BED;&#x4E49;&#x4E0E;&#x90A3;&#x4E9B;&#x548C;&#x540C;&#x4E00;&#x5E93;&#x7B49;&#x4EF7;&#x7684;&#x9759;&#x6001;&#x5E93;&#x8FDB;&#x884C;&#x94FE;&#x63A5;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E2D;&#x7684;&#x7B26;&#x53F7;&#x89E3;&#x6790;&#x7684;&#x8BED;&#x4E49;&#x5B8C;&#x6210;&#x4E00;&#x81F4;&#x3002;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x4E0B;&#x9762;&#x7684;&#x8BED;&#x4E49;&#x662F;&#x6B63;&#x786E;&#x7684;&#x3002;</p>
<ul>
<li>&#x4E3B;&#x7A0B;&#x5E8F;&#x4E2D;&#x5168;&#x5C40;&#x7B26;&#x53F7;&#x7684;&#x5B9A;&#x4E49;&#x8986;&#x76D6;&#x5E93;&#x4E2D;&#x76F8;&#x5E94;&#x7684;&#x5B9A;&#x4E49;&#x3002;</li>
<li>&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x5168;&#x5C40;&#x7B26;&#x53F7;&#x5728;&#x591A;&#x4E2A;&#x5E93;&#x4E2D;&#x8FDB;&#x884C;&#x4E86;&#x5B9A;&#x4E49;&#xFF0C;&#x90A3;&#x4E48;&#x5BF9;&#x8BE5;&#x7B26;&#x53F7;&#x7684;&#x5F15;&#x7528;&#x4F1A;&#x88AB;&#x7ED1;&#x5B9A;&#x5230;&#x5728;&#x626B;&#x63CF;&#x5E93;&#x65F6;&#x627E;&#x5230;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x5B9A;&#x4E49;&#xFF0C;&#x5176;&#x4E2D;&#x626B;&#x63CF;&#x987A;&#x5E8F;&#x662F;&#x6309;&#x7167;&#x8FD9;&#x4E9B;&#x5E93;&#x5728;&#x9759;&#x6001;&#x94FE;&#x63A5;&#x547D;&#x4EE4;&#x884C;&#x4E2D;&#x5217;&#x51FA;&#x65F6;&#x4ECE;&#x5DE6;&#x81F3;&#x53F3;&#x7684;&#x987A;&#x5E8F;&#x3002;</li>
</ul>
<p>&#x867D;&#x7136;&#x8FD9;&#x4E9B;&#x8BED;&#x4E49;&#x4F7F;&#x5F97;&#x4ECE;&#x9759;&#x6001;&#x5E93;&#x5230;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x8F6C;&#x53D8;&#x53D8;&#x5F97;&#x76F8;&#x5BF9;&#x7B80;&#x5355;&#x4E86;&#xFF0C;&#x4F46;&#x8FD9;&#x79CD;&#x505A;&#x6CD5;&#x4F1A;&#x5BFC;&#x81F4;&#x4E00;&#x4E9B;&#x95EE;&#x9898;&#x3002;&#x5176;&#x4E2D;&#x6700;&#x5927;&#x7684;&#x95EE;&#x9898;&#x662F;&#x8FD9;&#x4E9B;&#x8BED;&#x4E49;&#x5728;&#x4F7F;&#x7528;&#x5171;&#x4EAB;&#x5E93;&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x81EA;&#x5305;&#x542B;&#x7684;&#x5B50;&#x7CFB;&#x7EDF;&#x65F6;&#x4F1A;&#x4E0E;&#x5171;&#x4EAB;&#x5E93;&#x6A21;&#x578B;&#x4EA7;&#x751F;&#x77DB;&#x76FE;&#x3002;&#x5728;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5171;&#x4EAB;&#x5E93;&#x65E0;&#x6CD5;&#x786E;&#x4FDD;&#x4E00;&#x4E2A;&#x6307;&#x5411;&#x5176;&#x81EA;&#x8EAB;&#x7684;&#x67D0;&#x4E2A;&#x5168;&#x5C40;&#x7B26;&#x53F7;&#x7684;&#x5F15;&#x7528;&#x4F1A;&#x771F;&#x6B63;&#x88AB;&#x7ED1;&#x5B9A;&#x5230;&#x8BE5;&#x7B26;&#x53F7;&#x5728;&#x5E93;&#x4E2D;&#x7684;&#x5B9A;&#x4E49;&#x4E0A;&#xFF0C;&#x4ECE;&#x800C;&#x5BFC;&#x81F4;&#x5F53;&#x8BE5;&#x5171;&#x4EAB;&#x5E93;&#x88AB;&#x96C6;&#x6210;&#x5230;&#x4E00;&#x4E2A;&#x66F4;&#x5927;&#x7684;&#x7CFB;&#x7EDF;&#x4E2D;&#x65F6;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x5C5E;&#x6027;&#x53EF;&#x80FD;&#x4F1A;&#x53D1;&#x751F;&#x6539;&#x53D8;&#x3002;&#x8FD9;&#x4F1A;&#x5BFC;&#x81F4;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x51FA;&#x73B0;&#x4EE4;&#x4EBA;&#x610F;&#x6599;&#x4E4B;&#x5916;&#x7684;&#x884C;&#x4E3A;&#xFF0C;&#x540C;&#x65F6;&#x4E5F;&#x4F7F;&#x5F97;&#x5206;&#x6CBB;&#x8C03;&#x8BD5;&#x7684;&#x6267;&#x884C;&#x53D8;&#x5F97;&#x66F4;&#x52A0;&#x56F0;&#x96BE;&#xFF08;&#x5373;&#x5C1D;&#x8BD5;&#x4F7F;&#x7528;&#x66F4;&#x5C11;&#x6216;&#x4E0D;&#x540C;&#x7684;&#x5171;&#x4EAB;&#x5E93;&#x6765;&#x91CD;&#x73B0;&#x95EE;&#x9898;&#xFF09;&#x3002;</p>
<p>&#x5728;&#x4E0A;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x4E2D;&#xFF0C;&#x5982;&#x679C;&#x60F3;&#x8981;&#x786E;&#x4FDD;&#x5728;&#x5171;&#x4EAB;&#x5E93;&#x4E2D;&#x5BF9;xyz()&#x7684;&#x8C03;&#x7528;&#x786E;&#x5B9E;&#x8C03;&#x7528;&#x4E86;&#x5E93;&#x4E2D;&#x5B9A;&#x4E49;&#x7684;&#x76F8;&#x5E94;&#x51FD;&#x6570;&#xFF0C;&#x90A3;&#x4E48;&#x5728;&#x6784;&#x5EFA;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x65F6;&#x5019;&#x5C31;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x2013;Bsymbolic&#x94FE;&#x63A5;&#x5668;&#x9009;&#x9879;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ gcc -g -c -fPIC -Wall -c foo.c
$ gcc -g -shared -Wl,-Bsymbolic -o libfoo.so foo.o
$ gcc -g -o prog prog.c libfoo.so
$ LD_LIBRARY_PATH<span class="token operator">=</span>. ./prog
foo-xyz<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x2013;Bsymbolic&#x94FE;&#x63A5;&#x5668;&#x9009;&#x9879;&#x6307;&#x5B9A;&#x4E86;&#x5171;&#x4EAB;&#x5E93;&#x4E2D;&#x5BF9;&#x5168;&#x5C40;&#x7B26;&#x53F7;&#x7684;&#x5F15;&#x7528;&#x5E94;&#x8BE5;&#x4F18;&#x5148;&#x88AB;&#x7ED1;&#x5B9A;&#x5230;&#x5E93;&#x4E2D;&#x7684;&#x76F8;&#x5E94;&#x5B9A;&#x4E49;&#x4E0A;&#xFF08;&#x5982;&#x679C;&#x5B58;&#x5728;&#x7684;&#x8BDD;&#xFF09;&#x3002;&#xFF08;&#x6CE8;&#x610F;&#x4E0D;&#x7BA1;&#x662F;&#x5426;&#x4F7F;&#x7528;&#x4E86;&#x8FD9;&#x4E2A;&#x9009;&#x9879;&#xFF0C;&#x5728;&#x4E3B;&#x7A0B;&#x5E8F;&#x4E2D;&#x8C03;&#x7528;xyz()&#x603B;&#x662F;&#x4F1A;&#x8C03;&#x7528;&#x4E3B;&#x7A0B;&#x5E8F;&#x4E2D;&#x5B9A;&#x4E49;&#x7684;xyz()&#x3002;&#xFF09;</p>
<h2 id="&#x4F7F;&#x7528;&#x9759;&#x6001;&#x5E93;&#x53D6;&#x4EE3;&#x5171;&#x4EAB;&#x5E93;"><a href="#&#x4F7F;&#x7528;&#x9759;&#x6001;&#x5E93;&#x53D6;&#x4EE3;&#x5171;&#x4EAB;&#x5E93;" class="headerlink" title="&#x4F7F;&#x7528;&#x9759;&#x6001;&#x5E93;&#x53D6;&#x4EE3;&#x5171;&#x4EAB;&#x5E93;"></a>&#x4F7F;&#x7528;&#x9759;&#x6001;&#x5E93;&#x53D6;&#x4EE3;&#x5171;&#x4EAB;&#x5E93;</h2><p>&#x867D;&#x7136;&#x5728;&#x5927;&#x591A;&#x6570;&#x60C5;&#x51B5;&#x4E0B;&#x90FD;&#x5E94;&#x8BE5;&#x4F7F;&#x7528;&#x5171;&#x4EAB;&#x5E93;&#xFF0C;&#x4F46;&#x5728;&#x67D0;&#x4E9B;&#x573A;&#x666F;&#x4E2D;&#x9759;&#x6001;&#x5E93;&#x5219;&#x66F4;&#x52A0;&#x9002;&#x5408;&#x3002;&#x7279;&#x522B;&#x5730;&#xFF0C;&#x9759;&#x6001;&#x94FE;&#x63A5;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5305;&#x542B;&#x4E86;&#x5B83;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x6240;&#x9700;&#x7684;&#x5168;&#x5C40;&#x4EE3;&#x7801;&#x8FD9;&#x4E00;&#x4E8B;&#x5B9E;&#x662F;&#x975E;&#x5E38;&#x6709;&#x5229;&#x7684;&#x3002;&#x5982;&#x5F53;&#x7528;&#x6237;&#x4E0D;&#x5E0C;&#x671B;&#x6216;&#x8005;&#x65E0;&#x6CD5;&#x5728;&#x8FD0;&#x884C;&#x7A0B;&#x5E8F;&#x7684;&#x7CFB;&#x7EDF;&#x4E0A;&#x5B89;&#x88C5;&#x5171;&#x4EAB;&#x5E93;&#x6216;&#x8005;&#x7A0B;&#x5E8F;&#x5728;&#x53E6;&#x4E00;&#x4E2A;&#x65E0;&#x6CD5;&#x4F7F;&#x7528;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x73AF;&#x5883;&#x4E2D;&#x8FD0;&#x884C;&#x65F6;&#xFF08;&#x5982;&#x53EF;&#x80FD;&#x662F;&#x4E00;&#x4E2A;chroot&#x76D1;&#x72F1;&#xFF08;jail&#xFF09;&#xFF09;&#xFF0C;&#x9759;&#x6001;&#x94FE;&#x63A5;&#x5C31;&#x6D3E;&#x4E0A;&#x7528;&#x573A;&#x4E86;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x5373;&#x4F7F;&#x662F;&#x4E00;&#x4E2A;&#x517C;&#x5BB9;&#x7684;&#x5171;&#x4EAB;&#x5E93;&#x5347;&#x7EA7;&#x4E5F;&#x53EF;&#x80FD;&#x4F1A;&#x5728;&#x65E0;&#x610F;&#x4E2D;&#x5F15;&#x5165;&#x4E00;&#x4E2A;Bug&#xFF0C;&#x4ECE;&#x800C;&#x5BFC;&#x81F4;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x65E0;&#x6CD5;&#x6B63;&#x5E38;&#x5DE5;&#x4F5C;&#x3002;&#x901A;&#x8FC7;&#x9759;&#x6001;&#x94FE;&#x63A5;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5C31;&#x80FD;&#x786E;&#x4FDD;&#x7CFB;&#x7EDF;&#x4E0A;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x53D8;&#x52A8;&#x4E0D;&#x4F1A;&#x5F71;&#x54CD;&#x5230;&#x5B83;&#x5E76;&#x4E14;&#x5B83;&#x5DF2;&#x7ECF;&#x62E5;&#x6709;&#x4E86;&#x8FD0;&#x884C;&#x6240;&#x9700;&#x7684;&#x5168;&#x5C40;&#x4EE3;&#x7801;&#xFF08;&#x4ED8;&#x51FA;&#x7684;&#x4EE3;&#x4EF7;&#x5C31;&#x662F;&#x7A0B;&#x5E8F;&#x66F4;&#x5927;&#x4E86;&#xFF0C;&#x4ECE;&#x800C;&#x4F1A;&#x9700;&#x8981;&#x66F4;&#x591A;&#x7684;&#x78C1;&#x76D8;&#x7A7A;&#x95F4;&#x548C;&#x5185;&#x5B58;&#xFF09;&#x3002;</p>
<p>&#x5728;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5F53;&#x94FE;&#x63A5;&#x5668;&#x80FD;&#x591F;&#x9009;&#x62E9;&#x540D;&#x79F0;&#x4E00;&#x6837;&#x7684;&#x5171;&#x4EAB;&#x5E93;&#x548C;&#x9759;&#x6001;&#x5E93;&#x65F6;&#xFF08;&#x5982;&#x5728;&#x94FE;&#x63A5;&#x65F6;&#x4F7F;&#x7528;&#x2013;Lsomedir &#x2013;ldemo&#x5E76;&#x4E14;libdemo.so&#x548C;libdemo.a&#x90FD;&#x5B58;&#x5728;&#xFF09;&#x4F1A;&#x4F18;&#x5148;&#x4F7F;&#x7528;&#x5171;&#x4EAB;&#x5E93;&#x3002;&#x8981;&#x5F3A;&#x5236;&#x4F7F;&#x7528;&#x5E93;&#x7684;&#x9759;&#x6001;&#x7248;&#x672C;&#x5219;&#x53EF;&#x4EE5;&#x5B8C;&#x6210;&#x4E0B;&#x5217;&#x4E4B;&#x4E00;&#x3002;</p>
<ul>
<li>&#x5728;gcc&#x547D;&#x4EE4;&#x884C;&#x4E2D;&#x6307;&#x5B9A;&#x9759;&#x6001;&#x5E93;&#x7684;&#x8DEF;&#x5F84;&#x540D;&#xFF08;&#x5305;&#x62EC;.a&#x6269;&#x5C55;&#xFF09;&#x3002;</li>
<li>&#x5728;gcc&#x547D;&#x4EE4;&#x884C;&#x4E2D;&#x6307;&#x5B9A;-static&#x9009;&#x9879;&#x3002;</li>
<li>&#x4F7F;&#x7528;&#x2013;Wl,&#x2013;Bstatic&#x548C;&#x2013;Wl,&#x2013;Bdynamic gcc&#x9009;&#x9879;&#x6765;&#x663E;&#x5F0F;&#x5730;&#x6307;&#x5B9A;&#x94FE;&#x63A5;&#x5668;&#x9009;&#x62E9;&#x5171;&#x4EAB;&#x5E93;&#x8FD8;&#x662F;&#x9759;&#x6001;&#x5E93;&#x3002;&#x5728;gcc&#x547D;&#x4EE4;&#x884C;&#x4E2D;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;-l&#x9009;&#x9879;&#x6765;&#x6DF7;&#x5408;&#x8FD9;&#x4E9B;&#x9009;&#x9879;&#x3002;&#x94FE;&#x63A5;&#x5668;&#x4F1A;&#x6309;&#x7167;&#x9009;&#x9879;&#x88AB;&#x6307;&#x5B9A;&#x65F6;&#x7684;&#x987A;&#x5E8F;&#x6765;&#x5904;&#x7406;&#x8FD9;&#x4E9B;&#x9009;&#x9879;&#x3002;</li>
</ul>
<h1 id="&#x5171;&#x4EAB;&#x5E93;&#x9AD8;&#x7EA7;&#x7279;&#x6027;"><a href="#&#x5171;&#x4EAB;&#x5E93;&#x9AD8;&#x7EA7;&#x7279;&#x6027;" class="headerlink" title="&#x5171;&#x4EAB;&#x5E93;&#x9AD8;&#x7EA7;&#x7279;&#x6027;"></a>&#x5171;&#x4EAB;&#x5E93;&#x9AD8;&#x7EA7;&#x7279;&#x6027;</h1><h2 id="&#x52A8;&#x6001;&#x52A0;&#x8F7D;&#x5E93;"><a href="#&#x52A8;&#x6001;&#x52A0;&#x8F7D;&#x5E93;" class="headerlink" title="&#x52A8;&#x6001;&#x52A0;&#x8F7D;&#x5E93;"></a>&#x52A8;&#x6001;&#x52A0;&#x8F7D;&#x5E93;</h2><p>&#x5F53;&#x4E00;&#x4E2A;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x5F00;&#x59CB;&#x8FD0;&#x884C;&#x4E4B;&#x540E;&#xFF0C;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x4F1A;&#x52A0;&#x8F7D;&#x7A0B;&#x5E8F;&#x7684;&#x52A8;&#x6001;&#x4F9D;&#x8D56;&#x5217;&#x8868;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x5171;&#x4EAB;&#x5E93;&#xFF0C;&#x4F46;&#x6709;&#x4E9B;&#x65F6;&#x5019;&#x5EF6;&#x8FDF;&#x52A0;&#x8F7D;&#x5E93;&#x662F;&#x6BD4;&#x8F83;&#x6709;&#x7528;&#x7684;&#xFF0C;&#x5982;&#x53EA;&#x5728;&#x9700;&#x8981;&#x7684;&#x65F6;&#x5019;&#x518D;&#x52A0;&#x8F7D;&#x4E00;&#x4E2A;&#x63D2;&#x4EF6;&#x3002;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x7684;&#x8FD9;&#x9879;&#x529F;&#x80FD;&#x662F;&#x901A;&#x8FC7;&#x4E00;&#x7EC4;API&#x6765;&#x5B9E;&#x73B0;&#x7684;&#x3002;&#x8FD9;&#x7EC4;API&#x901A;&#x5E38;&#x88AB;&#x79F0;&#x4E3A;dlopen API&#xFF0C;&#x5B83;&#x6E90;&#x81EA;Solaris&#xFF0C;&#x73B0;&#x5728;&#x5176;&#x4E2D;&#x5927;&#x90E8;&#x5206;&#x5185;&#x5BB9;&#x90FD;&#x5728;SUSv3&#x4E2D;&#x8FDB;&#x884C;&#x4E86;&#x89C4;&#x5B9A;&#x3002;</p>
<p>dlopen API&#x4F7F;&#x5F97;&#x7A0B;&#x5E8F;&#x80FD;&#x591F;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x6253;&#x5F00;&#x4E00;&#x4E2A;&#x5171;&#x4EAB;&#x5E93;&#xFF0C;&#x6839;&#x636E;&#x540D;&#x5B57;&#x5728;&#x5E93;&#x4E2D;&#x641C;&#x7D22;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#xFF0C;&#x7136;&#x540E;&#x8C03;&#x7528;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x3002;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x91C7;&#x7528;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x52A0;&#x8F7D;&#x7684;&#x5171;&#x4EAB;&#x5E93;&#x901A;&#x5E38;&#x88AB;&#x79F0;&#x4E3A;&#x52A8;&#x6001;&#x52A0;&#x8F7D;&#x7684;&#x5E93;&#xFF0C;&#x5B83;&#x7684;&#x521B;&#x5EFA;&#x65B9;&#x5F0F;&#x4E0E;&#x5176;&#x4ED6;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x521B;&#x5EFA;&#x65B9;&#x5F0F;&#x5B8C;&#x5168;&#x4E00;&#x6837;&#x3002;</p>
<p>&#x6838;&#x5FC3;dlopen API&#x7531;&#x4E0B;&#x5217;&#x51FD;&#x6570;&#xFF08;&#x6240;&#x6709;&#x8FD9;&#x4E9B;&#x51FD;&#x6570;&#x90FD;&#x5728;SUSv3&#x8FDB;&#x884C;&#x4E86;&#x89C4;&#x5B9A;&#xFF09;&#x6784;&#x6210;&#x3002;</p>
<ul>
<li>dlopen()&#x51FD;&#x6570;&#x6253;&#x5F00;&#x4E00;&#x4E2A;&#x5171;&#x4EAB;&#x5E93;&#xFF0C;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x4F9B;&#x540E;&#x7EED;&#x8C03;&#x7528;&#x4F7F;&#x7528;&#x7684;&#x53E5;&#x67C4;&#x3002;</li>
<li>dlsym()&#x51FD;&#x6570;&#x5728;&#x5E93;&#x4E2D;&#x641C;&#x7D22;&#x4E00;&#x4E2A;&#x7B26;&#x53F7;&#xFF08;&#x4E00;&#x4E2A;&#x5305;&#x542B;&#x51FD;&#x6570;&#x6216;&#x53D8;&#x91CF;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF09;&#x5E76;&#x8FD4;&#x56DE;&#x5176;&#x5730;&#x5740;&#x3002;</li>
<li>dlclose()&#x51FD;&#x6570;&#x5173;&#x95ED;&#x4E4B;&#x524D;&#x7531;dlopen()&#x6253;&#x5F00;&#x7684;&#x5E93;&#x3002;</li>
<li>dlerror()&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#x6D88;&#x606F;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x5728;&#x8C03;&#x7528;&#x4E0A;&#x8FF0;&#x51FD;&#x6570;&#x4E2D;&#x7684;&#x67D0;&#x4E2A;&#x51FD;&#x6570;&#x53D1;&#x751F;&#x9519;&#x8BEF;&#x65F6;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x6765;&#x83B7;&#x53D6;&#x9519;&#x8BEF;&#x6D88;&#x606F;&#x3002;</li>
</ul>
<p>glibc&#x5B9E;&#x73B0;&#x8FD8;&#x5305;&#x542B;&#x4E86;&#x4E00;&#x7EC4;&#x76F8;&#x5173;&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x5176;&#x4E2D;&#x4E00;&#x4E9B;&#x5C06;&#x4F1A;&#x5728;&#x540E;&#x9762;&#x4E88;&#x4EE5;&#x4ECB;&#x7ECD;&#x3002;</p>
<p>&#x8981;&#x5728;Linux&#x4E0A;&#x4F7F;&#x7528;dlopen API&#x6784;&#x5EFA;&#x7A0B;&#x5E8F;&#x5FC5;&#x987B;&#x8981;&#x6307;&#x5B9A;&#x2013;ldl&#x9009;&#x9879;&#x4EE5;&#x4FBF;&#x4E0E;libdl&#x5E93;&#x94FE;&#x63A5;&#x8D77;&#x6765;&#x3002;</p>
<h3 id="&#x6253;&#x5F00;&#x5171;&#x4EAB;&#x5E93;&#xFF1A;dlopen"><a href="#&#x6253;&#x5F00;&#x5171;&#x4EAB;&#x5E93;&#xFF1A;dlopen" class="headerlink" title="&#x6253;&#x5F00;&#x5171;&#x4EAB;&#x5E93;&#xFF1A;dlopen()"></a>&#x6253;&#x5F00;&#x5171;&#x4EAB;&#x5E93;&#xFF1A;dlopen()</h3><p>dlopen()&#x51FD;&#x6570;&#x5C06;&#x540D;&#x4E3A;libfilename&#x7684;&#x5171;&#x4EAB;&#x5E93;&#x52A0;&#x8F7D;&#x8FDB;&#x8C03;&#x7528;&#x8FDB;&#x7A0B;&#x7684;&#x865A;&#x62DF;&#x5730;&#x5740;&#x7A7A;&#x95F4;&#x5E76;&#x589E;&#x52A0;&#x8BE5;&#x5E93;&#x7684;&#x6253;&#x5F00;&#x5F15;&#x7528;&#x8BA1;&#x6570;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;dlfcn.h&gt;</span></span>

<span class="token keyword">void</span> <span class="token operator">*</span><span class="token function">dlopen</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>libfilename<span class="token punctuation">,</span><span class="token keyword">int</span> flags<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x5982;&#x679C;libfilename&#x5305;&#x542B;&#x4E86;&#x4E00;&#x4E2A;&#x659C;&#x7EBF;&#xFF08;/&#xFF09;&#xFF0C;&#x90A3;&#x4E48;dlopen()&#x4F1A;&#x5C06;&#x5176;&#x89E3;&#x91CA;&#x6210;&#x4E00;&#x4E2A;&#x7EDD;&#x5BF9;&#x6216;&#x76F8;&#x5BF9;&#x8DEF;&#x5F84;&#x540D;&#xFF0C;&#x5426;&#x5219;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x4F1A;&#x4F7F;&#x7528;&#x7B2C;41.11&#x8282;&#x4E2D;&#x4ECB;&#x7ECD;&#x7684;&#x89C4;&#x5219;&#x6765;&#x641C;&#x7D22;&#x5171;&#x4EAB;&#x5E93;&#x3002;</p>
<p>dlopen()&#x5728;&#x6210;&#x529F;&#x65F6;&#x4F1A;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x53E5;&#x67C4;&#xFF0C;&#x5728;&#x540E;&#x7EED;&#x5BF9;dlopen API&#x4E2D;&#x7684;&#x51FD;&#x6570;&#x7684;&#x8C03;&#x7528;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x8BE5;&#x53E5;&#x67C4;&#x6765;&#x5F15;&#x7528;&#x8FD9;&#x4E2A;&#x5E93;&#x3002;&#x5982;&#x679C;&#x53D1;&#x751F;&#x4E86;&#x9519;&#x8BEF;&#xFF08;&#x5982;&#x65E0;&#x6CD5;&#x627E;&#x5230;&#x5E93;&#xFF09;&#xFF0C;&#x90A3;&#x4E48;dlopen()&#x4F1A;&#x8FD4;&#x56DE;NULL&#x3002;</p>
<p>&#x5982;&#x679C;libfilename&#x6307;&#x5B9A;&#x7684;&#x5171;&#x4EAB;&#x5E93;&#x4F9D;&#x8D56;&#x4E8E;&#x5176;&#x4ED6;&#x5171;&#x4EAB;&#x5E93;&#xFF0C;&#x90A3;&#x4E48;dlopen()&#x4F1A;&#x81EA;&#x52A8;&#x52A0;&#x8F7D;&#x90A3;&#x4E9B;&#x5E93;&#x3002;&#x5982;&#x679C;&#x6709;&#x5FC5;&#x8981;&#x7684;&#x8BDD;&#xFF0C;&#x8FD9;&#x4E00;&#x8FC7;&#x7A0B;&#x4F1A;&#x9012;&#x5F52;&#x8FDB;&#x884C;&#x3002;&#x8FD9;&#x79CD;&#x88AB;&#x52A0;&#x8F7D;&#x8FDB;&#x6765;&#x7684;&#x5E93;&#x88AB;&#x79F0;&#x4E3A;&#x8FD9;&#x4E2A;&#x5E93;&#x7684;&#x4F9D;&#x8D56;&#x6811;&#x3002;</p>
<p>&#x5728;&#x540C;&#x4E00;&#x4E2A;&#x5E93;&#x6587;&#x4EF6;&#x4E2D;&#x53EF;&#x4EE5;&#x591A;&#x6B21;&#x8C03;&#x7528;dlopen()&#xFF0C;&#x4F46;&#x5C06;&#x5E93;&#x52A0;&#x8F7D;&#x8FDB;&#x5185;&#x5B58;&#x7684;&#x64CD;&#x4F5C;&#x53EA;&#x4F1A;&#x53D1;&#x751F;&#x4E00;&#x6B21;&#xFF08;&#x7B2C;&#x4E00;&#x6B21;&#x8C03;&#x7528;&#xFF09;&#xFF0C;&#x6240;&#x6709;&#x7684;&#x8C03;&#x7528;&#x90FD;&#x8FD4;&#x56DE;&#x540C;&#x6837;&#x7684;&#x53E5;&#x67C4;&#x503C;&#x3002;&#x4F46;dlopen API&#x4F1A;&#x4E3A;&#x6BCF;&#x4E2A;&#x5E93;&#x53E5;&#x67C4;&#x7EF4;&#x62A4;&#x4E00;&#x4E2A;&#x5F15;&#x7528;&#x8BA1;&#x6570;&#xFF0C;&#x6BCF;&#x6B21;&#x8C03;&#x7528;dlopen()&#x65F6;&#x90FD;&#x4F1A;&#x589E;&#x52A0;&#x5F15;&#x7528;&#x8BA1;&#x6570;&#xFF0C;&#x6BCF;&#x6B21;&#x8C03;&#x7528;dlclose()&#x90FD;&#x4F1A;&#x51CF;&#x5C0F;&#x5F15;&#x7528;&#x8BA1;&#x6570;&#xFF0C;&#x53EA;&#x6709;&#x5F53;&#x8BA1;&#x6570;&#x4E3A;0&#x65F6;dlclose()&#x624D;&#x4F1A;&#x4ECE;&#x5185;&#x5B58;&#x4E2D;&#x5220;&#x9664;&#x8FD9;&#x4E2A;&#x5E93;&#x3002;</p>
<p>flags&#x53C2;&#x6570;&#x662F;&#x4E00;&#x4E2A;&#x4F4D;&#x63A9;&#x7801;&#xFF0C;&#x5B83;&#x7684;&#x53D6;&#x503C;&#x662F;RTLD_LAZY&#x548C;RTLD_NOW&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#xFF0C;&#x8FD9;&#x4E24;&#x4E2A;&#x503C;&#x7684;&#x542B;&#x4E49;&#x5206;&#x522B;&#x5982;&#x4E0B;&#x3002;<br><code>RTLD_LAZY</code><br>&#x53EA;&#x6709;&#x5F53;&#x4EE3;&#x7801;&#x88AB;&#x6267;&#x884C;&#x7684;&#x65F6;&#x5019;&#x624D;&#x89E3;&#x6790;&#x5E93;&#x4E2D;&#x672A;&#x5B9A;&#x4E49;&#x7684;&#x51FD;&#x6570;&#x7B26;&#x53F7;&#x3002;&#x5982;&#x679C;&#x9700;&#x8981;&#x67D0;&#x4E2A;&#x7279;&#x5B9A;&#x7B26;&#x53F7;&#x7684;&#x4EE3;&#x7801;&#x6CA1;&#x6709;&#x88AB;&#x6267;&#x884C;&#x5230;&#xFF0C;&#x90A3;&#x4E48;&#x6C38;&#x8FDC;&#x90FD;&#x4E0D;&#x4F1A;&#x89E3;&#x6790;&#x8BE5;&#x7B26;&#x53F7;&#x3002;&#x5EF6;&#x8FDF;&#x89E3;&#x6790;&#x53EA;&#x9002;&#x7528;&#x4E8E;&#x51FD;&#x6570;&#x5F15;&#x7528;&#xFF0C;&#x5BF9;&#x53D8;&#x91CF;&#x7684;&#x5F15;&#x7528;&#x4F1A;&#x88AB;&#x7ACB;&#x5373;&#x89E3;&#x6790;&#x3002;&#x6307;&#x5B9A;RTLD_LAZY&#x6807;&#x8BB0;&#x80FD;&#x591F;&#x63D0;&#x4F9B;&#x4E0E;&#x5728;&#x52A0;&#x8F7D;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x7684;&#x52A8;&#x6001;&#x4F9D;&#x8D56;&#x5217;&#x8868;&#x4E2D;&#x7684;&#x5171;&#x4EAB;&#x5E93;&#x65F6;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x7684;&#x5E38;&#x89C4;&#x64CD;&#x4F5C;&#x5BF9;&#x5E94;&#x7684;&#x884C;&#x4E3A;&#x3002;</p>
<p><code>RTLD_NOW</code><br>&#x5728;dlopen()&#x7ED3;&#x675F;&#x4E4B;&#x524D;&#x7ACB;&#x5373;&#x52A0;&#x8F7D;&#x5E93;&#x4E2D;&#x6240;&#x6709;&#x7684;&#x672A;&#x5B9A;&#x4E49;&#x7B26;&#x53F7;&#xFF0C;&#x4E0D;&#x7BA1;&#x662F;&#x5426;&#x9700;&#x8981;&#x7528;&#x5230;&#x8FD9;&#x4E9B;&#x7B26;&#x53F7;&#xFF0C;&#x8FD9;&#x79CD;&#x505A;&#x6CD5;&#x7684;&#x7ED3;&#x679C;&#x662F;&#x6253;&#x5F00;&#x5E93;&#x53D8;&#x5F97;&#x66F4;&#x6162;&#x4E86;&#xFF0C;&#x4F46;&#x80FD;&#x591F;&#x7ACB;&#x5373;&#x68C0;&#x6D4B;&#x5230;&#x4EFB;&#x4F55;&#x6F5C;&#x5728;&#x7684;&#x672A;&#x5B9A;&#x4E49;&#x51FD;&#x6570;&#x7B26;&#x53F7;&#x9519;&#x8BEF;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x5728;&#x540E;&#x9762;&#x67D0;&#x4E2A;&#x65F6;&#x523B;&#x624D;&#x68C0;&#x6D4B;&#x5230;&#x8FD9;&#x79CD;&#x9519;&#x8BEF;&#x3002;&#x5728;&#x8C03;&#x8BD5;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x65F6;&#x8FD9;&#x79CD;&#x505A;&#x6CD5;&#x662F;&#x6BD4;&#x8F83;&#x6709;&#x7528;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x80FD;&#x591F;&#x786E;&#x4FDD;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5728;&#x78B0;&#x5230;&#x672A;&#x89E3;&#x6790;&#x7684;&#x7B26;&#x53F7;&#x65F6;&#x7ACB;&#x5373;&#x53D1;&#x751F;&#x9519;&#x8BEF;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x5728;&#x6267;&#x884C;&#x4E86;&#x5F88;&#x957F;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;&#x4E4B;&#x540E;&#x624D;&#x53D1;&#x751F;&#x9519;&#x8BEF;&#x3002;</p>
<p>&#x901A;&#x8FC7;&#x5C06;&#x73AF;&#x5883;&#x53D8;&#x91CF;LD_BIND_NOW&#x8BBE;&#x7F6E;&#x4E3A;&#x4E00;&#x4E2A;&#x975E;&#x7A7A;&#x5B57;&#x7B26;&#x4E32;&#x80FD;&#x591F;&#x5F3A;&#x5236;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x5728;&#x52A0;&#x8F7D;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x7684;&#x52A8;&#x6001;&#x4F9D;&#x8D56;&#x5217;&#x8868;&#x4E2D;&#x7684;&#x5171;&#x4EAB;&#x5E93;&#x65F6;&#x7ACB;&#x5373;&#x89E3;&#x6790;&#x6240;&#x6709;&#x7B26;&#x53F7;&#xFF08;&#x5373;&#x7C7B;&#x4F3C;&#x4E8E;RTLD_NOW&#xFF09;&#x3002;&#x8FD9;&#x4E2A;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x5728;glibc 2.1.1&#x4EE5;&#x53CA;&#x540E;&#x7EED;&#x7684;&#x7248;&#x672C;&#x4E2D;&#x662F;&#x6709;&#x6548;&#x7684;&#x3002;&#x8BBE;&#x7F6E;LD_BIND_NOW&#x4F1A;&#x8986;&#x76D6;dlopen() RTLD_LAZY&#x6807;&#x8BB0;&#x7684;&#x6548;&#x679C;&#x3002;</p>
<p><strong>flags&#x4E5F;&#x53EF;&#x4EE5;&#x53D6;&#x5176;&#x4ED6;&#x7684;&#x503C;&#xFF0C;SUSv3&#x89C4;&#x5B9A;&#x4E86;&#x4E0B;&#x5217;&#x51E0;&#x79CD;&#x6807;&#x8BB0;&#x3002;</strong><br><code>RTLD_GLOBAL</code><br>&#x8FD9;&#x4E2A;&#x5E93;&#x53CA;&#x5176;&#x4F9D;&#x8D56;&#x6811;&#x4E2D;&#x7684;&#x7B26;&#x53F7;&#x5728;&#x89E3;&#x6790;&#x7531;&#x8FD9;&#x4E2A;&#x8FDB;&#x7A0B;&#x52A0;&#x8F7D;&#x7684;&#x5176;&#x4ED6;&#x5E93;&#x4E2D;&#x7684;&#x5F15;&#x7528;&#x548C;&#x901A;&#x8FC7;dlsym()&#x67E5;&#x627E;&#x65F6;&#x53EF;&#x7528;&#x3002;</p>
<p><code>RTLD_LOCAL</code><br>&#x4E0E;RTLD_GLOBAL&#x76F8;&#x53CD;&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x6307;&#x5B9A;&#x4EFB;&#x4F55;&#x5E38;&#x91CF;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x53D6;&#x8FD9;&#x4E2A;&#x9ED8;&#x8BA4;&#x503C;&#x3002;&#x5B83;&#x89C4;&#x5B9A;&#x5728;&#x89E3;&#x6790;&#x540E;&#x7EED;&#x52A0;&#x8F7D;&#x7684;&#x5E93;&#x4E2D;&#x7684;&#x5F15;&#x7528;&#x65F6;&#x8FD9;&#x4E2A;&#x5E93;&#x53CA;&#x5176;&#x4F9D;&#x8D56;&#x6811;&#x4E2D;&#x7684;&#x7B26;&#x53F7;&#x4E0D;&#x53EF;&#x7528;&#x3002;</p>
<p>&#x5728;&#x4E0D;&#x6307;&#x5B9A;RTLD_GLOBAL&#x6216;RTLD_LOCAL&#x65F6;&#xFF0C;SUSv3&#x5E76;&#x6CA1;&#x6709;&#x89C4;&#x5B9A;&#x4E00;&#x4E2A;&#x9ED8;&#x8BA4;&#x503C;&#x3002;&#x5927;&#x591A;&#x6570;UNIX&#x5B9E;&#x73B0;&#x4E0E;Linux&#x4E00;&#x6837;&#xFF0C;&#x5C06;RTLD_LOCAL&#x4F5C;&#x4E3A;&#x9ED8;&#x8BA4;&#x503C;&#xFF0C;&#x4F46;&#x4E00;&#x4E9B;&#x5B9E;&#x73B0;&#x5C06;RTLD_GLOBAL&#x4F5C;&#x4E3A;&#x9ED8;&#x8BA4;&#x503C;&#x3002;</p>
<p><strong>Linux&#x8FD8;&#x652F;&#x6301;&#x51E0;&#x4E2A;&#x5E76;&#x6CA1;&#x6709;&#x5728;SUSv3&#x4E2D;&#x8FDB;&#x884C;&#x89C4;&#x5B9A;&#x7684;&#x6807;&#x8BB0;&#xFF0C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#x3002;</strong><br><code>RTLD_NODELETE&#xFF08;&#x81EA;glibc 2.2&#x8D77;&#xFF09;</code><br>&#x5728;dlclose()&#x8C03;&#x7528;&#x4E2D;&#x4E0D;&#x8981;&#x5378;&#x8F7D;&#x5E93;&#xFF0C;&#x5373;&#x4F7F;&#x5176;&#x5F15;&#x7528;&#x8BA1;&#x6570;&#x5DF2;&#x7ECF;&#x53D8;&#x6210;0&#x4E86;&#x3002;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x5728;&#x540E;&#x9762;&#x91CD;&#x65B0;&#x901A;&#x8FC7;dlopen()&#x52A0;&#x8F7D;&#x5E93;&#x65F6;&#x4E0D;&#x4F1A;&#x91CD;&#x65B0;&#x521D;&#x59CB;&#x5316;&#x5E93;&#x4E2D;&#x7684;&#x9759;&#x6001;&#x53D8;&#x91CF;&#x3002;&#xFF08;&#x5BF9;&#x4E8E;&#x7531;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x81EA;&#x52A8;&#x52A0;&#x8F7D;&#x7684;&#x5E93;&#x6765;&#x8BB2;&#xFF0C;&#x5728;&#x521B;&#x5EFA;&#x5E93;&#x65F6;&#x901A;&#x8FC7;&#x6307;&#x5B9A;gcc &#x2013;Wl,&#x2013;znodelete&#x9009;&#x9879;&#x80FD;&#x591F;&#x53D6;&#x5F97;&#x7C7B;&#x4F3C;&#x7684;&#x6548;&#x679C;&#x3002;&#xFF09;</p>
<p><code>RTLD_NOLOAD&#xFF08;&#x81EA;glibc 2.2&#x8D77;&#xFF09;</code><br>&#x4E0D;&#x52A0;&#x8F7D;&#x5E93;&#x3002;&#x8FD9;&#x4E2A;&#x6807;&#x8BB0;&#x6709;&#x4E24;&#x4E2A;&#x76EE;&#x7684;&#x3002;&#x7B2C;&#x4E00;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x6807;&#x8BB0;&#x6765;&#x68C0;&#x67E5;&#x67D0;&#x4E2A;&#x7279;&#x5B9A;&#x7684;&#x5E93;&#x662F;&#x5426;&#x5DF2;&#x7ECF;&#x88AB;&#x52A0;&#x8F7D;&#x5230;&#x4E86;&#x8FDB;&#x7A0B;&#x7684;&#x5730;&#x5740;&#x7A7A;&#x95F4;&#x4E2D;&#x3002;&#x5982;&#x679C;&#x5DF2;&#x7ECF;&#x52A0;&#x8F7D;&#x4E86;&#xFF0C;&#x90A3;&#x4E48;dlopen()&#x4F1A;&#x8FD4;&#x56DE;&#x5E93;&#x7684;&#x53E5;&#x67C4;&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x52A0;&#x8F7D;&#xFF0C;&#x90A3;&#x4E48;dlopen()&#x4F1A;&#x8FD4;&#x56DE;NULL&#x3002;&#x7B2C;&#x4E8C;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x6807;&#x8BB0;&#x6765;&#x201C;&#x63D0;&#x5347;&#x201D;&#x5DF2;&#x52A0;&#x8F7D;&#x7684;&#x5E93;&#x7684;&#x6807;&#x8BB0;&#x3002;&#x5982;&#x5728;&#x5BF9;&#x4E4B;&#x524D;&#x4F7F;&#x7528;RTLD_LOCAL&#x6253;&#x5F00;&#x7684;&#x5E93;&#x8C03;&#x7528;dlopen()&#x65F6;&#x53EF;&#x4EE5;&#x5728;flags&#x53C2;&#x6570;&#x4E2D;&#x6307;&#x5B9A;RTLD_NOLOAD | RTLD_GLOBAL&#x3002;</p>
<p><code>RTLD_DEEPBIND&#xFF08;&#x81EA;glibc 2.3.4&#xFF09;</code><br>&#x5728;&#x89E3;&#x6790;&#x8FD9;&#x4E2A;&#x5E93;&#x4E2D;&#x7684;&#x7B26;&#x53F7;&#x5F15;&#x7528;&#x65F6;&#x5148;&#x641C;&#x7D22;&#x5E93;&#x4E2D;&#x7684;&#x5B9A;&#x4E49;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x641C;&#x7D22;&#x5DF2;&#x52A0;&#x8F7D;&#x7684;&#x5E93;&#x4E2D;&#x7684;&#x5B9A;&#x4E49;&#x3002;&#x8FD9;&#x4E2A;&#x6807;&#x8BB0;&#x4F7F;&#x5F97;&#x4E00;&#x4E2A;&#x5E93;&#x80FD;&#x591F;&#x5B9E;&#x73B0;&#x81EA;&#x5305;&#x542B;&#xFF0C;&#x5373;&#x4F18;&#x5148;&#x4F7F;&#x7528;&#x81EA;&#x5DF1;&#x7684;&#x7B26;&#x53F7;&#x5B9A;&#x4E49;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x5728;&#x5DF2;&#x52A0;&#x8F7D;&#x7684;&#x5176;&#x4ED6;&#x5E93;&#x4E2D;&#x5B9A;&#x4E49;&#x7684;&#x540C;&#x540D;&#x5168;&#x5C40;&#x7B26;&#x53F7;&#x3002;&#xFF08;&#x8FD9;&#x4E0E;&#x2013;Bsymbolic&#x94FE;&#x63A5;&#x5668;&#x9009;&#x9879;&#x5177;&#x6709;&#x7C7B;&#x4F3C;&#x7684;&#x6548;&#x679C;&#x3002;&#xFF09;</p>
<p>RTLD_NODELETE&#x548C;RTLD_NOLOAD&#x6807;&#x8BB0;&#x5728;Solaris dlopen API&#x4E2D;&#x4E5F;&#x8FDB;&#x884C;&#x4E86;&#x5B9E;&#x73B0;&#xFF0C;&#x4F46;&#x63D0;&#x4F9B;&#x8FD9;&#x4E2A;&#x4E24;&#x4E2A;&#x6807;&#x8BB0;&#x7684;UNIX&#x5B9E;&#x73B0;&#x5F88;&#x5C11;&#x3002;RTLD_DEEPBIND&#x6807;&#x8BB0;&#x662F;Linux&#x7279;&#x6709;&#x7684;&#x3002;</p>
<p>&#x5F53;&#x5C06;libfilename&#x6307;&#x5B9A;&#x4E3A;NULL&#x65F6;dlopen()&#x4F1A;&#x8FD4;&#x56DE;&#x4E3B;&#x7A0B;&#x5E8F;&#x7684;&#x53E5;&#x67C4;&#x3002;&#xFF08;SUSv3&#x5C06;&#x8FD9;&#x79CD;&#x53E5;&#x67C4;&#x79F0;&#x4E3A;&#x201C;&#x5168;&#x5C40;&#x7B26;&#x53F7;&#x5BF9;&#x8C61;&#x201D;&#x7684;&#x53E5;&#x67C4;&#x3002;&#xFF09;&#x5728;&#x540E;&#x7EED;&#x5BF9;dlsym()&#x7684;&#x8C03;&#x7528;&#x4E2D;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x53E5;&#x67C4;&#x4F1A;&#x5BFC;&#x81F4;&#x9996;&#x5148;&#x5728;&#x4E3B;&#x7A0B;&#x5E8F;&#x4E2D;&#x641C;&#x7D22;&#x7B26;&#x53F7;&#xFF0C;&#x7136;&#x540E;&#x5728;&#x7A0B;&#x5E8F;&#x542F;&#x52A8;&#x65F6;&#x52A0;&#x8F7D;&#x7684;&#x5171;&#x4EAB;&#x5E93;&#x4E2D;&#x8FDB;&#x884C;&#x641C;&#x7D22;&#xFF0C;&#x6700;&#x540E;&#x5728;&#x6240;&#x6709;&#x4F7F;&#x7528;&#x4E86;RTLD_GLOBAL&#x6807;&#x8BB0;&#x7684;&#x52A8;&#x6001;&#x52A0;&#x8F7D;&#x7684;&#x5E93;&#x4E2D;&#x8FDB;&#x884C;&#x641C;&#x7D22;&#x3002;</p>
<h3 id="&#x9519;&#x8BEF;&#x8BCA;&#x65AD;&#xFF1A;dlerror"><a href="#&#x9519;&#x8BEF;&#x8BCA;&#x65AD;&#xFF1A;dlerror" class="headerlink" title="&#x9519;&#x8BEF;&#x8BCA;&#x65AD;&#xFF1A;dlerror()"></a>&#x9519;&#x8BEF;&#x8BCA;&#x65AD;&#xFF1A;dlerror()</h3><p>&#x5982;&#x679C;&#x5728;dlopen()&#x8C03;&#x7528;&#x6216;dlopen API&#x7684;&#x5176;&#x4ED6;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x4E2D;&#x5F97;&#x5230;&#x4E86;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#xFF0C;&#x90A3;&#x4E48;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;dlerror()&#x6765;&#x83B7;&#x53D6;&#x4E00;&#x4E2A;&#x6307;&#x5411;&#x8868;&#x660E;&#x9519;&#x8BEF;&#x539F;&#x56E0;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x6307;&#x9488;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;dlfcn.h&gt;</span></span>

<span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">dlerror</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x5982;&#x679C;&#x4ECE;&#x4E0A;&#x4E00;&#x6B21;&#x8C03;&#x7528;dlerror()&#x5230;&#x73B0;&#x5728;&#x6CA1;&#x6709;&#x53D1;&#x751F;&#x9519;&#x8BEF;&#xFF0C;&#x90A3;&#x4E48;dlerror()&#x51FD;&#x6570;&#x8FD4;&#x56DE;NULL&#xFF0C;&#x8BFB;&#x8005;&#x5728;&#x4E0B;&#x4E00;&#x8282;&#x4E2D;&#x5C31;&#x4F1A;&#x770B;&#x5230;&#x8FD9;&#x79CD;&#x5904;&#x7406;&#x65B9;&#x5F0F;&#x5E26;&#x6765;&#x7684;&#x597D;&#x5904;&#x4E86;&#x3002;</p>
<h3 id="&#x83B7;&#x53D6;&#x7B26;&#x53F7;&#x7684;&#x5730;&#x5740;&#xFF1A;dlsym"><a href="#&#x83B7;&#x53D6;&#x7B26;&#x53F7;&#x7684;&#x5730;&#x5740;&#xFF1A;dlsym" class="headerlink" title="&#x83B7;&#x53D6;&#x7B26;&#x53F7;&#x7684;&#x5730;&#x5740;&#xFF1A;dlsym()"></a>&#x83B7;&#x53D6;&#x7B26;&#x53F7;&#x7684;&#x5730;&#x5740;&#xFF1A;dlsym()</h3><p>dlsym()&#x51FD;&#x6570;&#x5728;handle&#x6307;&#x5411;&#x7684;&#x5E93;&#x4EE5;&#x53CA;&#x8BE5;&#x5E93;&#x7684;&#x4F9D;&#x8D56;&#x6811;&#x4E2D;&#x7684;&#x5E93;&#x4E2D;&#x641C;&#x7D22;&#x540D;&#x4E3A;symbol&#x7684;&#x7B26;&#x53F7;&#xFF08;&#x51FD;&#x6570;&#x6216;&#x53D8;&#x91CF;&#xFF09;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;dlfcn.h&gt;</span></span>

<span class="token keyword">void</span> <span class="token operator">*</span><span class="token function">dlsym</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>handle<span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>symbol<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x5982;&#x679C;&#x627E;&#x5230;&#x4E86;symbol&#xFF0C;&#x90A3;&#x4E48;dlsym()&#x4F1A;&#x8FD4;&#x56DE;&#x5176;&#x5730;&#x5740;&#xFF0C;&#x5426;&#x5219;&#x5C31;&#x8FD4;&#x56DE;NULL&#x3002;handle&#x53C2;&#x6570;&#x901A;&#x5E38;&#x662F;&#x4E0A;&#x4E00;&#x4E2A;dlopen()&#x8C03;&#x7528;&#x8FD4;&#x56DE;&#x7684;&#x5E93;&#x53E5;&#x67C4;&#xFF0C;&#x6216;&#x8005;&#x5B83;&#x4E5F;&#x53EF;&#x4EE5;&#x662F;&#x4E0B;&#x9762;&#x4ECB;&#x7ECD;&#x7684;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x6240;&#x8C13;&#x7684;&#x4F2A;&#x53E5;&#x67C4;&#x3002;</p>
<p>dlvsym(handle, symbol, version)&#x4E0E;dlsym()&#x7C7B;&#x4F3C;&#xFF0C;&#x4F46;&#x5B83;&#x80FD;&#x591F;&#x7528;&#x6765;&#x5728;&#x7B26;&#x53F7;&#x7248;&#x672C;&#x5316;&#x7684;&#x5E93;&#x4E2D;&#x641C;&#x7D22;&#x7248;&#x672C;&#x4E0E;&#x5728;&#x5B57;&#x7B26;&#x4E32;version&#x4E2D;&#x6307;&#x5B9A;&#x7684;&#x7248;&#x672C;&#x5339;&#x914D;&#x7684;&#x7B26;&#x53F7;&#x5B9A;&#x4E49;&#x3002;&#x8981;&#x4ECE;&lt;dlfcn.h&gt;&#x4E2D;&#x83B7;&#x53D6;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x7684;&#x58F0;&#x660E;&#x5FC5;&#x987B;&#x8981;&#x5B9A;&#x4E49;_GNU_SOURCE&#x7279;&#x6027;&#x6D4B;&#x8BD5;&#x5B8F;&#x3002;</p>
<p>dlsym()&#x8FD4;&#x56DE;&#x7684;&#x7B26;&#x53F7;&#x503C;&#x53EF;&#x80FD;&#x4F1A;&#x662F;NULL&#xFF0C;&#x8FD9;&#x4E00;&#x70B9;&#x4E0E;&#x201C;&#x627E;&#x4E0D;&#x5230;&#x7B26;&#x53F7;&#x201D;&#x7684;&#x8FD4;&#x56DE;&#x662F;&#x65E0;&#x6CD5;&#x533A;&#x5206;&#x7684;&#x3002;&#x4E3A;&#x4E86;&#x5F04;&#x6E05;&#x695A;&#x5177;&#x4F53;&#x662F;&#x54EA;&#x79CD;&#x60C5;&#x51B5;&#x5C31;&#x5FC5;&#x987B;&#x8981;&#x5148;&#x8C03;&#x7528;dlerror()&#xFF08;&#x786E;&#x4FDD;&#x4E4B;&#x524D;&#x7684;&#x9519;&#x8BEF;&#x5B57;&#x7B26;&#x4E32;&#x5DF2;&#x7ECF;&#x88AB;&#x6E05;&#x9664;&#x4E86;&#xFF09;&#xFF0C;&#x5982;&#x679C;&#x5728;&#x8C03;&#x7528;dlsym()&#x4E4B;&#x540E;dlerror()&#x8FD4;&#x56DE;&#x4E86;&#x4E00;&#x4E2A;&#x975E;NULL&#x503C;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x53EF;&#x4EE5;&#x5F97;&#x51FA;&#x53D1;&#x751F;&#x9519;&#x8BEF;&#x7684;&#x7ED3;&#x8BBA;&#x4E86;&#x3002;</p>
<p>&#x5982;&#x679C;symbol&#x662F;&#x4E00;&#x4E2A;&#x53D8;&#x91CF;&#x7684;&#x540D;&#x79F0;&#xFF0C;&#x90A3;&#x4E48;&#x53EF;&#x4EE5;&#x5C06;dlsym()&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x8D4B;&#x7ED9;&#x4E00;&#x4E2A;&#x5408;&#x9002;&#x7684;&#x6307;&#x9488;&#x7C7B;&#x578B;&#xFF0C;&#x5E76;&#x901A;&#x8FC7;&#x53CD;&#x5F15;&#x7528;&#x8BE5;&#x6307;&#x9488;&#x6765;&#x5F97;&#x5230;&#x53D8;&#x91CF;&#x7684;&#x503C;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">int</span> <span class="token operator">*</span>ip<span class="token punctuation">;</span>

ip<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">dlsym</span><span class="token punctuation">(</span>symbol<span class="token punctuation">,</span><span class="token string">&quot;myvar&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>ip <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Value is %d\n&quot;</span><span class="token punctuation">,</span> <span class="token operator">*</span>ip<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<div class="uk-alert uk-alert-success"><i class="fa fa-check-circle"></i> &#xA0;&#xA0;&#x6307;&#x9488;&#x548C;&#x7A7A;&#x6307;&#x9488;<br>
&#x6307;&#x9488;&#x5305;&#x542B;&#x9996;&#x5730;&#x5740;&#x548C;&#x5927;&#x5C0F;&#x4E24;&#x90E8;&#x5206;&#xFF0C;&#x7A7A;&#x6307;&#x9488;&#xFF08;void *&#xFF09;&#x53EA;&#x5305;&#x542B;&#x5730;&#x5740;&#x4E0D;&#x5305;&#x542B;&#x5927;&#x5C0F;&#xFF0C;int &#x578B;&#x6307;&#x9488;(int *)&#x5305;&#x542B;&#x9996;&#x5730;&#x5740;&#x548C;4&#x4E2A;&#x5B57;&#x8282;&#x5927;&#x5C0F;&#x7684;&#x5185;&#x5B58;&#x3002;<br>
&#x6240;&#x4EE5;&#x7A7A;&#x6307;&#x9488;&#x53EF;&#x4EE5;&#x8F6C;&#x5316;&#x4E3A;&#x5176;&#x4ED6;&#x6307;&#x9488;&#x7684;&#x610F;&#x601D;&#x5C31;&#x662F;&#xFF0C;&#x7ED9;&#x7A7A;&#x6307;&#x9488;&#x6307;&#x5B9A;&#x4E86;&#x5185;&#x5B58;&#x5927;&#x5C0F;&#x3002;</div>
<p>&#x5982;&#x679C;symbol&#x662F;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x7684;&#x540D;&#x79F0;&#xFF0C;&#x90A3;&#x4E48;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;dlsym()&#x8FD4;&#x56DE;&#x7684;&#x6307;&#x9488;&#x6765;&#x8C03;&#x7528;&#x8BE5;&#x51FD;&#x6570;&#x3002;&#x53EF;&#x4EE5;&#x5C06;dlsym()&#x8FD4;&#x56DE;&#x7684;&#x503C;&#x5B58;&#x50A8;&#x5230;&#x4E00;&#x4E2A;&#x7C7B;&#x578B;&#x5408;&#x9002;&#x7684;&#x6307;&#x9488;&#x4E2D;&#xFF0C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>funcp<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>&#x4F46;&#x4E0D;&#x80FD;&#x7B80;&#x5355;&#x5730;&#x5C06;dlsym()&#x7684;&#x7ED3;&#x679C;&#x8D4B;&#x7ED9;&#x6B64;&#x7C7B;&#x6307;&#x9488;&#xFF0C;&#x5982;&#x4E0B;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x6240;&#x793A;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c">funcp<span class="token operator">=</span><span class="token function">dlsym</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span>symbol<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>&#x5176;&#x539F;&#x56E0;&#x662F;C99&#x6807;&#x51C6;&#x7981;&#x6B62;&#x51FD;&#x6570;&#x6307;&#x9488;&#x548C;void *&#x4E4B;&#x95F4;&#x7684;&#x8D4B;&#x503C;&#x64CD;&#x4F5C;&#x3002;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#x662F;&#x4F7F;&#x7528;&#x4E0B;&#x9762;&#x8FD9;&#x6837;&#x7684;&#xFF08;&#x7A0D;&#x5FAE;&#x6709;&#x4E9B;&#x7B28;&#x62D9;&#xFF09;&#x7C7B;&#x578B;&#x8F6C;&#x6362;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>funcp<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">dlsym</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span>symbol<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>&#x901A;&#x8FC7;dlsym()&#x5F97;&#x5230;&#x4E86;&#x6307;&#x5411;&#x51FD;&#x6570;&#x7684;&#x6307;&#x9488;&#x4E4B;&#x540E;&#x5C31;&#x80FD;&#x591F;&#x901A;&#x8FC7;&#x5E38;&#x89C4;&#x7684;C&#x8BED;&#x6CD5;&#x53CD;&#x5F15;&#x7528;&#x51FD;&#x6570;&#x6307;&#x9488;&#x6765;&#x8C03;&#x7528;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4E86;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c">res <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">*</span>funcp<span class="token punctuation">)</span><span class="token punctuation">(</span>somearg<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>&#x8BFB;&#x8005;&#x5728;&#x5C06;dlsym()&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x8FDB;&#x884C;&#x8D4B;&#x503C;&#x65F6;&#x53EF;&#x80FD;&#x4F1A;&#x4F7F;&#x7528;&#x4E0B;&#x9762;&#x8FD9;&#x6BB5;&#x770B;&#x8D77;&#x6765;&#x4E0E;&#x4E0A;&#x8FF0;&#x4EE3;&#x7801;&#x7B49;&#x4EF7;&#x7684;&#x4EE3;&#x7801;&#x6765;&#x53D6;&#x4EE3;&#x4E0A;&#x9762;&#x7684;<em>(void *</em>)&#x8BED;&#x6CD5;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">)</span>funcp <span class="token operator">=</span> <span class="token function">dlsym</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span>symbol<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>&#x4F46;gcc &#x2013;pedantic&#x5728;&#x78B0;&#x5230;&#x4E0A;&#x9762;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x65F6;&#x4F1A;&#x53D1;&#x51FA;&#x201C;ANSI C forbids the use of cast expressions as lvalues.&#x201D;&#x7684;&#x8B66;&#x544A;&#x4FE1;&#x606F;&#x3002;&#x800C;&#x4F7F;&#x7528;<em>(void *</em>)&#x8BED;&#x8A00;&#x5C31;&#x4E0D;&#x4F1A;&#x51FA;&#x73B0;&#x8FD9;&#x4E2A;&#x8B66;&#x544A;&#x4FE1;&#x606F;&#xFF0C;&#x56E0;&#x4E3A;&#x662F;&#x5728;&#x5411;&#x8D4B;&#x503C;&#x8BED;&#x53E5;&#x4E2D;&#x7684;&#x5DE6;&#x503C;&#x6307;&#x5411;&#x7684;&#x5730;&#x5740;&#x8D4B;&#x503C;&#x3002;</p>
<p>&#x5728;&#x5F88;&#x591A;UNIX&#x5B9E;&#x73B0;&#x4E2D;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4E0B;&#x9762;&#x8FD9;&#x6837;&#x7684;&#x7C7B;&#x578B;&#x8F6C;&#x6362;&#x7C7B;&#x6D88;&#x9664;C&#x7F16;&#x8BD1;&#x5668;&#x7684;&#x8B66;&#x544A;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c">funcp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">dlsym</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span>symbol<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>&#x4F46;SUSv3 Technical Corrigendum Number 1&#x4E2D;dlsym()&#x7684;&#x89C4;&#x8303;&#x6307;&#x51FA;C99&#x6807;&#x51C6;&#x4ECD;&#x7136;&#x8981;&#x6C42;&#x7F16;&#x8BD1;&#x5668;&#x5BF9;&#x6B64;&#x7C7B;&#x8F6C;&#x6362;&#x751F;&#x6210;&#x8B66;&#x544A;&#x4FE1;&#x606F;&#x5E76;&#x5217;&#x4E3E;&#x4E86;&#x4E0A;&#x9762;&#x7684;<em>(void *</em>)&#x8BED;&#x6CD5;&#x3002;</p>
<p>SUSv3 TC1&#x6307;&#x51FA;&#x7531;&#x4E8E;&#x9700;&#x8981;&#x7528;&#x5230;<em>(void *</em>)&#x8BED;&#x6CD5;&#xFF0C;&#x56E0;&#x6B64;&#x6807;&#x51C6;&#x7684;&#x540E;&#x7EED;&#x7248;&#x672C;&#x53EF;&#x80FD;&#x4F1A;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x4E0E;dlsym()&#x7C7B;&#x4F3C;&#x7684;API&#x6765;&#x5904;&#x7406;&#x6570;&#x636E;&#x548C;&#x51FD;&#x6570;&#x6307;&#x9488;&#x3002;&#x4F46;SUSv4&#x5728;&#x8FD9;&#x4E00;&#x70B9;&#x4E0A;&#x6CA1;&#x6709;&#x53D1;&#x751F;&#x4EFB;&#x4F55;&#x53D8;&#x5316;&#x3002;</p>
<h3 id="&#x5728;dlsym-&#x4E2D;&#x4F7F;&#x7528;&#x5E93;&#x4F2A;&#x53E5;&#x67C4;"><a href="#&#x5728;dlsym-&#x4E2D;&#x4F7F;&#x7528;&#x5E93;&#x4F2A;&#x53E5;&#x67C4;" class="headerlink" title="&#x5728;dlsym()&#x4E2D;&#x4F7F;&#x7528;&#x5E93;&#x4F2A;&#x53E5;&#x67C4;"></a>&#x5728;dlsym()&#x4E2D;&#x4F7F;&#x7528;&#x5E93;&#x4F2A;&#x53E5;&#x67C4;</h3><p>dlsym()&#x51FD;&#x6570;&#x4E2D;&#x7684;handle&#x53C2;&#x6570;&#x9664;&#x4E86;&#x80FD;&#x591F;&#x53D6;&#x7531;dlopen()&#x8C03;&#x7528;&#x8FD4;&#x56DE;&#x7684;&#x53E5;&#x67C4;&#x503C;&#x4E4B;&#x5916;&#xFF0C;&#x8FD8;&#x80FD;&#x591F;&#x53D6;&#x4E0B;&#x5217;&#x4F2A;&#x53E5;&#x67C4;&#x503C;&#x3002;<br><code>RTLD_DEFAULT</code><br>&#x4ECE;&#x4E3B;&#x7A0B;&#x5E8F;&#x4E2D;&#x5F00;&#x59CB;&#x67E5;&#x627E;symbol&#xFF0C;&#x63A5;&#x7740;&#x6309;&#x5E8F;&#x5728;&#x6240;&#x6709;&#x5DF2;&#x52A0;&#x8F7D;&#x7684;&#x5171;&#x4EAB;&#x5E93;&#x4E2D;&#x67E5;&#x627E;&#xFF0C;&#x5305;&#x62EC;&#x90A3;&#x4E9B;&#x901A;&#x8FC7;&#x4F7F;&#x7528;&#x4E86;RTLD_GLOBAL&#x6807;&#x8BB0;&#x7684;dlopen()&#x8C03;&#x7528;&#x52A8;&#x6001;&#x52A0;&#x8F7D;&#x7684;&#x5E93;&#xFF0C;&#x8FD9;&#x4E2A;&#x6807;&#x8BB0;&#x5BF9;&#x5E94;&#x4E8E;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x6240;&#x91C7;&#x7528;&#x7684;&#x9ED8;&#x8BA4;&#x641C;&#x7D22;&#x6A21;&#x578B;&#x3002;</p>
<p><code>RTLD_NEXT</code><br>&#x5728;&#x8C03;&#x7528;dlsym()&#x4E4B;&#x540E;&#x52A0;&#x8F7D;&#x7684;&#x5171;&#x4EAB;&#x5E93;&#x4E2D;&#x641C;&#x7D22;symbol&#xFF0C;&#x8FD9;&#x4E2A;&#x6807;&#x8BB0;&#x9002;&#x7528;&#x4E8E;&#x9700;&#x8981;&#x521B;&#x5EFA;&#x4E0E;&#x5728;&#x5176;&#x4ED6;&#x5730;&#x65B9;&#x5B9A;&#x4E49;&#x7684;&#x51FD;&#x6570;&#x540C;&#x540D;&#x7684;&#x5305;&#x88C5;&#x51FD;&#x6570;&#x7684;&#x60C5;&#x51B5;&#x3002;&#x5982;&#xFF0C;&#x5728;&#x4E3B;&#x7A0B;&#x5E8F;&#x4E2D;&#x53EF;&#x80FD;&#x4F1A;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;malloc()&#xFF08;&#x5B83;&#x53EF;&#x80FD;&#x5B8C;&#x6210;&#x5185;&#x5B58;&#x5206;&#x914D;&#x7684;&#x7C3F;&#x8BB0;&#x5DE5;&#x4F5C;&#xFF09;&#xFF0C;&#x800C;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x5728;&#x8C03;&#x7528;&#x5B9E;&#x9645;&#x7684;malloc()&#x4E4B;&#x524D;&#x9996;&#x5148;&#x4F1A;&#x901A;&#x8FC7;&#x8C03;&#x7528;func = dlsym(RTLD_NEXT, &#x201C;malloc&#x201D;)&#x6765;&#x83B7;&#x53D6;&#x5176;&#x5730;&#x5740;&#x3002;</p>
<p>SUSv3&#x5E76;&#x6CA1;&#x6709;&#x8981;&#x6C42;&#x5B9E;&#x73B0;&#x4E0A;&#x8FF0;&#x5217;&#x51FA;&#x7684;&#x4F2A;&#x53E5;&#x67C4;&#xFF08;&#x751A;&#x81F3;&#x6CA1;&#x6709;&#x4FDD;&#x7559;&#x8FD9;&#x4E24;&#x4E2A;&#x503C;&#x4EE5;&#x4F9B;&#x540E;&#x7EED;&#x4E4B;&#x7528;&#xFF09;&#xFF0C;&#x5E76;&#x4E14;&#x6240;&#x6709;UNIX&#x5B9E;&#x73B0;&#x4E5F;&#x6CA1;&#x6709;&#x5B9A;&#x4E49;&#x4E0A;&#x8FF0;&#x4F2A;&#x53E5;&#x67C4;&#x3002;&#x4E3A;&#x4E86;&#x4ECE;&lt;dlfcn.h&gt;&#x4E2D;&#x83B7;&#x53D6;&#x8FD9;&#x4E9B;&#x5E38;&#x91CF;&#x7684;&#x5B9A;&#x4E49;&#x5FC5;&#x987B;&#x8981;&#x5B9A;&#x4E49;_GNU_SOURCE&#x7279;&#x6027;&#x6D4B;&#x8BD5;&#x5B8F;&#x3002;</p>
<h3 id="&#x5173;&#x95ED;&#x5171;&#x4EAB;&#x5E93;&#xFF1A;dlclose"><a href="#&#x5173;&#x95ED;&#x5171;&#x4EAB;&#x5E93;&#xFF1A;dlclose" class="headerlink" title="&#x5173;&#x95ED;&#x5171;&#x4EAB;&#x5E93;&#xFF1A;dlclose()"></a>&#x5173;&#x95ED;&#x5171;&#x4EAB;&#x5E93;&#xFF1A;dlclose()</h3><p>dlclose()&#x51FD;&#x6570;&#x5173;&#x95ED;&#x4E00;&#x4E2A;&#x5E93;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;dlfcn.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">dlclose</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>handle<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>dlclose()&#x51FD;&#x6570;&#x4F1A;&#x51CF;&#x5C0F;handle&#x6240;&#x5F15;&#x7528;&#x7684;&#x5E93;&#x7684;&#x6253;&#x5F00;&#x5F15;&#x7528;&#x7684;&#x7CFB;&#x7EDF;&#x8BA1;&#x6570;&#x3002;&#x5982;&#x679C;&#x8FD9;&#x4E2A;&#x5F15;&#x7528;&#x8BA1;&#x6570;&#x53D8;&#x6210;&#x4E86;0&#x5E76;&#x4E14;&#x5176;&#x4ED6;&#x5E93;&#x5DF2;&#x7ECF;&#x4E0D;&#x9700;&#x8981;&#x7528;&#x5230;&#x8BE5;&#x5E93;&#x4E2D;&#x7684;&#x7B26;&#x53F7;&#x4E86;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x4F1A;&#x5378;&#x8F7D;&#x8FD9;&#x4E2A;&#x5E93;&#x3002;&#x7CFB;&#x7EDF;&#x4E5F;&#x4F1A;&#x5728;&#x8FD9;&#x4E2A;&#x5E93;&#x7684;&#x4F9D;&#x8D56;&#x6811;&#x4E2D;&#x7684;&#x5E93;&#x6267;&#x884C;&#xFF08;&#x9012;&#x5F52;&#x5730;&#xFF09;&#x540C;&#x6837;&#x7684;&#x8FC7;&#x7A0B;&#x3002;&#x5F53;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#x65F6;&#x4F1A;&#x9690;&#x5F0F;&#x5730;&#x5BF9;&#x6240;&#x6709;&#x5E93;&#x6267;&#x884C;dlclose()&#x3002;</p>
<p>&#x4ECE;glibc 2.2.3&#x5F00;&#x59CB;&#xFF0C;&#x5171;&#x4EAB;&#x5E93;&#x4E2D;&#x7684;&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;atexit()&#xFF08;&#x6216;on_exit()&#xFF09;&#x6765;&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x5728;&#x5E93;&#x88AB;&#x5378;&#x8F7D;&#x65F6;&#x81EA;&#x52A8;&#x8C03;&#x7528;&#x7684;&#x51FD;&#x6570;&#x3002;</p>
<h3 id="&#x83B7;&#x53D6;&#x4E0E;&#x52A0;&#x8F7D;&#x7684;&#x7B26;&#x53F7;&#x76F8;&#x5173;&#x7684;&#x4FE1;&#x606F;&#xFF1A;dladdr"><a href="#&#x83B7;&#x53D6;&#x4E0E;&#x52A0;&#x8F7D;&#x7684;&#x7B26;&#x53F7;&#x76F8;&#x5173;&#x7684;&#x4FE1;&#x606F;&#xFF1A;dladdr" class="headerlink" title="&#x83B7;&#x53D6;&#x4E0E;&#x52A0;&#x8F7D;&#x7684;&#x7B26;&#x53F7;&#x76F8;&#x5173;&#x7684;&#x4FE1;&#x606F;&#xFF1A;dladdr()"></a>&#x83B7;&#x53D6;&#x4E0E;&#x52A0;&#x8F7D;&#x7684;&#x7B26;&#x53F7;&#x76F8;&#x5173;&#x7684;&#x4FE1;&#x606F;&#xFF1A;dladdr()</h3><p>dladdr()&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x5305;&#x542B;&#x5730;&#x5740;addr&#xFF08;&#x901A;&#x5E38;&#x901A;&#x8FC7;&#x524D;&#x9762;&#x7684;dlsym()&#x8C03;&#x7528;&#x83B7;&#x5F97;&#xFF09;&#x7684;&#x76F8;&#x5173;&#x4FE1;&#x606F;&#x7684;&#x7ED3;&#x6784;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">define</span> _GNU_SOURCE</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;dlfcn.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">dladdr</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">void</span> <span class="token operator">*</span>addr<span class="token punctuation">,</span> Dl_info <span class="token operator">*</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>info&#x53C2;&#x6570;&#x662F;&#x4E00;&#x4E2A;&#x6307;&#x5411;&#x7531;&#x8C03;&#x7528;&#x8005;&#x5206;&#x914D;&#x7684;&#x7ED3;&#x6784;&#x7684;&#x6307;&#x9488;&#xFF0C;&#x5176;&#x7ED3;&#x6784;&#x5F62;&#x5F0F;&#x5982;&#x4E0B;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>dli_fname<span class="token punctuation">;</span>&#x3000;&#x3000;<span class="token comment" spellcheck="true">//&#x5305;&#x542B;&#x2018;addr&#x2019;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x8DEF;&#x5F84;&#x540D;</span>
    <span class="token keyword">void</span>        <span class="token operator">*</span>dli_fbase<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//&#x88AB;&#x52A0;&#x8F7D;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x57FA;&#x5730;&#x5740;</span>
    <span class="token keyword">const</span> <span class="token keyword">char</span>  <span class="token operator">*</span>dli_sname<span class="token punctuation">;</span>  
    <span class="token keyword">void</span>        <span class="token operator">*</span>dli_saddr<span class="token punctuation">;</span>
<span class="token punctuation">}</span>Dl_info<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Dl_info&#x7ED3;&#x6784;&#x4E2D;&#x7684;&#x524D;&#x4E24;&#x4E2A;&#x5B57;&#x6BB5;&#x6307;&#x5B9A;&#x4E86;&#x5305;&#x542B;&#x5730;&#x5740;addr&#x7684;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x8DEF;&#x5F84;&#x540D;&#x548C;&#x8FD0;&#x884C;&#x65F6;&#x57FA;&#x5730;&#x5740;&#x3002;&#x6700;&#x540E;&#x4E24;&#x4E2A;&#x5B57;&#x6BB5;&#x8FD4;&#x56DE;&#x5730;&#x5740;&#x76F8;&#x5173;&#x7684;&#x4FE1;&#x606F;&#x3002;&#x5047;&#x8BBE;addr&#x6307;&#x5411;&#x5171;&#x4EAB;&#x5E93;&#x4E2D;&#x4E00;&#x4E2A;&#x7B26;&#x53F7;&#x7684;&#x786E;&#x5207;&#x5730;&#x5740;&#xFF0C;&#x90A3;&#x4E48;dli_saddr&#x8FD4;&#x56DE;&#x7684;&#x503C;&#x4E0E;&#x4F20;&#x5165;&#x7684;addr&#x503C;&#x4E00;&#x6837;&#x3002;</p>
<p>SUSv3&#x5E76;&#x6CA1;&#x6709;&#x89C4;&#x5B9A;dladdr()&#xFF0C;&#x6240;&#x6709;UNIX&#x5B9E;&#x73B0;&#x4E5F;&#x90FD;&#x6CA1;&#x6709;&#x63D0;&#x4F9B;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x3002;</p>
<h3 id="&#x5728;&#x4E3B;&#x7A0B;&#x5E8F;&#x4E2D;&#x8BBF;&#x95EE;&#x7B26;&#x53F7;"><a href="#&#x5728;&#x4E3B;&#x7A0B;&#x5E8F;&#x4E2D;&#x8BBF;&#x95EE;&#x7B26;&#x53F7;" class="headerlink" title="&#x5728;&#x4E3B;&#x7A0B;&#x5E8F;&#x4E2D;&#x8BBF;&#x95EE;&#x7B26;&#x53F7;"></a>&#x5728;&#x4E3B;&#x7A0B;&#x5E8F;&#x4E2D;&#x8BBF;&#x95EE;&#x7B26;&#x53F7;</h3><p>&#x5047;&#x8BBE;&#x4F7F;&#x7528;dlopen()&#x52A8;&#x6001;&#x52A0;&#x8F7D;&#x4E86;&#x4E00;&#x4E2A;&#x5171;&#x4EAB;&#x5E93;&#xFF0C;&#x7136;&#x540E;&#x4F7F;&#x7528;dlsym()&#x83B7;&#x53D6;&#x4E86;&#x5171;&#x4EAB;&#x5E93;&#x4E2D;x()&#x51FD;&#x6570;&#x7684;&#x5730;&#x5740;&#xFF0C;&#x63A5;&#x7740;&#x8C03;&#x7528;x()&#x3002;&#x5982;&#x679C;&#x5728;x()&#x4E2D;&#x8C03;&#x7528;&#x4E86;&#x51FD;&#x6570;y()&#xFF0C;&#x90A3;&#x4E48;&#x901A;&#x5E38;&#x4F1A;&#x5728;&#x7A0B;&#x5E8F;&#x52A0;&#x8F7D;&#x7684;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x5171;&#x4EAB;&#x5E93;&#x4E2D;&#x641C;&#x7D22;y()&#x3002;</p>
<p>&#x6709;&#x4E9B;&#x65F6;&#x5019;&#x9700;&#x8981;&#x8BA9;x()&#x8C03;&#x7528;&#x4E3B;&#x7A0B;&#x5E8F;&#x4E2D;&#x7684;y()&#x5B9E;&#x73B0;&#xFF08;&#x7C7B;&#x4F3C;&#x4E8E;&#x56DE;&#x8C03;&#x673A;&#x5236;&#xFF09;&#x3002;&#x4E3A;&#x4E86;&#x8FBE;&#x5230;&#x8FD9;&#x4E2A;&#x76EE;&#x7684;&#x5C31;&#x5FC5;&#x987B;&#x8981;&#x4F7F;&#x4E3B;&#x7A0B;&#x5E8F;&#x4E2D;&#x7684;&#x7B26;&#x53F7;&#xFF08;&#x5168;&#x5C40;&#x4F5C;&#x7528;&#x57DF;&#xFF09;&#x5BF9;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x53EF;&#x7528;&#xFF0C;&#x5373;&#x5728;&#x94FE;&#x63A5;&#x7A0B;&#x5E8F;&#x65F6;&#x4F7F;&#x7528;&#x2212; &#x2212;export&#x2212;dynamic&#x94FE;&#x63A5;&#x5668;&#x9009;&#x9879;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ gcc -Wl,--export-dynamic main.c<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>&#x6216;&#x8005;&#x53EF;&#x4EE5;&#x7F16;&#x5199;&#x4E0B;&#x9762;&#x8FD9;&#x4E2A;&#x7B49;&#x4EF7;&#x7684;&#x547D;&#x4EE4;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ gcc -export-dynamic main.c<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>&#x4F7F;&#x7528;&#x8FD9;&#x4E9B;&#x9009;&#x9879;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x5C31;&#x80FD;&#x591F;&#x5141;&#x8BB8;&#x52A8;&#x6001;&#x52A0;&#x8F7D;&#x7684;&#x5E93;&#x8BBF;&#x95EE;&#x4E3B;&#x7A0B;&#x5E8F;&#x4E2D;&#x7684;&#x5168;&#x5C40;&#x7B26;&#x53F7;&#x3002;</p>
<p>gcc &#x2013;rdynamic&#x9009;&#x9879;&#x548C;gcc &#x2013;Wl&#x3001;&#x2013;E&#x9009;&#x9879;&#x7684;&#x542B;&#x4E49;&#xFF0C;&#x4EE5;&#x53CA;&#x2013;Wl&#x3001;&#x2212; &#x2212;export&#x2013;dynamic&#x662F;&#x4E00;&#x6837;&#x7684;&#x3002;</p>
<h2 id="&#x63A7;&#x5236;&#x7B26;&#x53F7;&#x7684;&#x53EF;&#x89C1;&#x6027;"><a href="#&#x63A7;&#x5236;&#x7B26;&#x53F7;&#x7684;&#x53EF;&#x89C1;&#x6027;" class="headerlink" title="&#x63A7;&#x5236;&#x7B26;&#x53F7;&#x7684;&#x53EF;&#x89C1;&#x6027;"></a>&#x63A7;&#x5236;&#x7B26;&#x53F7;&#x7684;&#x53EF;&#x89C1;&#x6027;</h2><p>&#x8BBE;&#x8BA1;&#x826F;&#x597D;&#x7684;&#x5171;&#x4EAB;&#x5E93;&#x5E94;&#x8BE5;&#x53EA;&#x516C;&#x5F00;&#x90A3;&#x4E9B;&#x6784;&#x6210;&#x5176;&#x58F0;&#x660E;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E8C;&#x8FDB;&#x5236;&#x63A5;&#x53E3;&#xFF08;ABI&#xFF09;&#x7684;&#x7B26;&#x53F7;&#xFF08;&#x51FD;&#x6570;&#x548C;&#x53D8;&#x91CF;&#xFF09;&#xFF0C;&#x5176;&#x539F;&#x56E0;&#x5982;&#x4E0B;&#x3002;</p>
<ul>
<li>&#x5982;&#x679C;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x8BBE;&#x8BA1;&#x4EBA;&#x5458;&#x4E0D;&#x5C0F;&#x5FC3;&#x5BFC;&#x51FA;&#x4E86;&#x672A;&#x8BE6;&#x7EC6;&#x8BF4;&#x660E;&#x7684;&#x63A5;&#x53E3;&#xFF0C;&#x90A3;&#x4E48;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x5E93;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x4F5C;&#x8005;&#x53EF;&#x80FD;&#x4F1A;&#x9009;&#x62E9;&#x4F7F;&#x7528;&#x8FD9;&#x4E9B;&#x63A5;&#x53E3;&#x3002;&#x8FD9;&#x6837;&#x5728;&#x5C06;&#x6765;&#x5347;&#x7EA7;&#x5171;&#x4EAB;&#x5E93;&#x65F6;&#x53EF;&#x80FD;&#x4F1A;&#x5E26;&#x6765;&#x517C;&#x5BB9;&#x6027;&#x95EE;&#x9898;&#x3002;&#x5E93;&#x7684;&#x5F00;&#x53D1;&#x4EBA;&#x5458;&#x8BA4;&#x4E3A;&#x53EF;&#x4EE5;&#x4FEE;&#x6539;&#x6216;&#x5220;&#x9664;&#x90A3;&#x4E9B;&#x4E0D;&#x5C5E;&#x4E8E;&#x6587;&#x6863;&#x4E2D;&#x8BB0;&#x5F55;&#x7684;ABI&#x4E2D;&#x7684;&#x63A5;&#x53E3;&#xFF0C;&#x800C;&#x5E93;&#x7684;&#x7528;&#x6237;&#x5219;&#x5E0C;&#x671B;&#x7EE7;&#x7EED;&#x4F7F;&#x7528;&#x540D;&#x79F0;&#x4E0E;&#x4ED6;&#x4EEC;&#x5F53;&#x524D;&#x6B63;&#x5728;&#x4F7F;&#x7528;&#x7684;&#x63A5;&#x53E3;&#x540D;&#x79F0;&#x4E00;&#x6837;&#x7684;&#x63A5;&#x53E3;&#xFF08;&#x540C;&#x65F6;&#x8BED;&#x4E49;&#x4FDD;&#x6301;&#x4E0D;&#x53D8;&#xFF09;&#x3002;</li>
<li>&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x7B26;&#x53F7;&#x89E3;&#x6790;&#x9636;&#x6BB5;&#xFF0C;&#x7531;&#x5171;&#x4EAB;&#x5E93;&#x5BFC;&#x51FA;&#x7684;&#x6240;&#x6709;&#x7B26;&#x53F7;&#x53EF;&#x80FD;&#x4F1A;&#x4F18;&#x5148;&#x4E8E;&#x5176;&#x4ED6;&#x5171;&#x4EAB;&#x5E93;&#x63D0;&#x4F9B;&#x7684;&#x76F8;&#x5173;&#x5B9A;&#x4E49;&#xFF08;&#x53C2;&#x89C1;41.12&#x8282;&#xFF09;&#x3002;</li>
<li>&#x5BFC;&#x51FA;&#x975E;&#x5FC5;&#x9700;&#x7684;&#x7B26;&#x53F7;&#x4F1A;&#x589E;&#x52A0;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x9700;&#x52A0;&#x8F7D;&#x7684;&#x52A8;&#x6001;&#x7B26;&#x53F7;&#x8868;&#x7684;&#x5927;&#x5C0F;&#x3002;</li>
</ul>
<p>&#x5F53;&#x5E93;&#x7684;&#x8BBE;&#x8BA1;&#x4EBA;&#x5458;&#x786E;&#x4FDD;&#x53EA;&#x5BFC;&#x51FA;&#x90A3;&#x4E9B;&#x5E93;&#x7684;&#x58F0;&#x660E;&#x7684;ABI&#x6240;&#x9700;&#x7684;&#x7B26;&#x53F7;&#x5C31;&#x80FD;&#x4F7F;&#x4E0A;&#x8FF0;&#x95EE;&#x9898;&#x53D1;&#x751F;&#x7684;&#x53EF;&#x80FD;&#x6027;&#x964D;&#x5230;&#x6700;&#x4F4E;&#x6216;&#x907F;&#x514D;&#x4E0A;&#x8FF0;&#x95EE;&#x9898;&#x7684;&#x53D1;&#x751F;&#x3002;&#x4E0B;&#x5217;&#x6280;&#x672F;&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x63A7;&#x5236;&#x7B26;&#x53F7;&#x7684;&#x5BFC;&#x51FA;&#x3002;</p>
<ol>
<li>&#x5728;C&#x7A0B;&#x5E8F;&#x4E2D;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;static&#x5173;&#x952E;&#x8BCD;&#x4F7F;&#x5F97;&#x4E00;&#x4E2A;&#x7B26;&#x53F7;&#x79C1;&#x6709;&#x4E8E;&#x4E00;&#x4E2A;&#x6E90;&#x4EE3;&#x7801;&#x6A21;&#x5757;&#xFF0C;&#x4ECE;&#x800C;&#x4F7F;&#x5F97;&#x5B83;&#x65E0;&#x6CD5;&#x88AB;&#x5176;&#x4ED6;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x7ED1;&#x5B9A;&#x3002;<br>&#x9664;&#x4E86;&#x4F7F;&#x4E00;&#x4E2A;&#x7B26;&#x53F7;&#x79C1;&#x6709;&#x4E8E;&#x6E90;&#x4EE3;&#x7801;&#x6A21;&#x5757;&#x4E4B;&#x5916;&#xFF0C;static&#x5173;&#x952E;&#x8BCD;&#x8FD8;&#x80FD;&#x8FBE;&#x5230;&#x4E00;&#x4E2A;&#x76F8;&#x53CD;&#x7684;&#x6548;&#x679C;&#x3002;&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x7B26;&#x53F7;&#x88AB;&#x6807;&#x8BB0;&#x4E3A;static&#xFF0C;&#x90A3;&#x4E48;&#x5728;&#x540C;&#x4E00;&#x6E90;&#x6587;&#x4EF6;&#x4E2D;&#x5BF9;&#x8BE5;&#x7B26;&#x53F7;&#x7684;&#x6240;&#x6709;&#x5F15;&#x7528;&#x4F1A;&#x88AB;&#x7ED1;&#x5B9A;&#x5230;&#x8BE5;&#x7B26;&#x53F7;&#x7684;&#x5B9A;&#x4E49;&#x4E0A;&#xFF0C;&#x5176;&#x7ED3;&#x679C;&#x662F;&#x8FD9;&#x4E9B;&#x5F15;&#x7528;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x4E0D;&#x4F1A;&#x88AB;&#x5173;&#x8054;&#x5230;&#x5176;&#x4ED6;&#x5171;&#x4EAB;&#x5E93;&#x4E2D;&#x7684;&#x76F8;&#x5E94;&#x5B9A;&#x4E49;&#x4E0A;&#x3002;static&#x5173;&#x952E;&#x8BCD;&#x7684;&#x8FD9;&#x79CD;&#x6548;&#x679C;&#x7C7B;&#x4F3C;&#x4E8E;&#x94FE;&#x63A5;&#x5668;&#x9009;&#x9879;&#xFF0C;&#x4F46;&#x5DEE;&#x522B;&#x5728;&#x4E8E;static&#x5173;&#x952E;&#x8BCD;&#x53EA;&#x5F71;&#x54CD;&#x5355;&#x4E2A;&#x6E90;&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x5355;&#x4E2A;&#x7B26;&#x53F7;&#x3002;</li>
<li>GNU C&#x7F16;&#x8BD1;&#x5668;gcc&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x7279;&#x6709;&#x7684;&#x7279;&#x6027;&#x58F0;&#x660E;&#xFF0C;&#x5B83;&#x6267;&#x884C;&#x4E0E;static&#x5173;&#x952E;&#x8BCD;&#x7C7B;&#x4F3C;&#x7684;&#x4EFB;&#x52A1;&#x3002;<pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">void</span>
<span class="token function">__attribute__</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">visibility</span><span class="token punctuation">(</span><span class="token string">&quot;hidden&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
 <span class="token comment" spellcheck="true">//Code</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
static&#x5173;&#x952E;&#x8BCD;&#x5C06;&#x4E00;&#x4E2A;&#x7B26;&#x53F7;&#x7684;&#x53EF;&#x89C1;&#x6027;&#x9650;&#x5236;&#x5728;&#x5355;&#x4E2A;&#x6E90;&#x4EE3;&#x7801;&#x6587;&#x4EF6;&#x4E2D;&#xFF0C;&#x800C;hidden&#x7279;&#x6027;&#x4F7F;&#x5F97;&#x4E00;&#x4E2A;&#x7B26;&#x53F7;&#x5BF9;&#x6784;&#x6210;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x6240;&#x6709;&#x6E90;&#x4EE3;&#x7801;&#x6587;&#x4EF6;&#x90FD;&#x53EF;&#x89C1;&#xFF0C;&#x4F46;&#x5BF9;&#x5E93;&#x4E4B;&#x5916;&#x7684;&#x6587;&#x4EF6;&#x4E0D;&#x53EF;&#x89C1;&#x3002;<br>&#x4E0E;static&#x5173;&#x952E;&#x8BCD;&#x4E00;&#x6837;&#xFF0C;hidden&#x7279;&#x6027;&#x4E5F;&#x80FD;&#x8FBE;&#x5230;&#x4E00;&#x4E2A;&#x76F8;&#x53CD;&#x7684;&#x6548;&#x679C;&#xFF0C;&#x5373;&#x9632;&#x6B62;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x53D1;&#x751F;&#x7B26;&#x53F7;&#x63D2;&#x5165;&#x3002;</li>
<li>&#x7248;&#x672C;&#x811A;&#x672C;&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x7CBE;&#x786E;&#x63A7;&#x5236;&#x7B26;&#x53F7;&#x7684;&#x53EF;&#x89C1;&#x6027;&#x4EE5;&#x53CA;&#x9009;&#x62E9;&#x5C06;&#x4E00;&#x4E2A;&#x5F15;&#x7528;&#x7ED1;&#x5B9A;&#x5230;&#x7B26;&#x53F7;&#x7684;&#x54EA;&#x4E2A;&#x7248;&#x672C;&#x3002;</li>
<li>&#x5F53;&#x52A8;&#x6001;&#x52A0;&#x8F7D;&#x4E00;&#x4E2A;&#x5171;&#x4EAB;&#x5E93;&#x65F6;&#xFF0C;dlopen()&#x63A5;&#x6536;&#x7684;RTLD_GLOBAL&#x6807;&#x8BB0;&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x6307;&#x5B9A;&#x8FD9;&#x4E2A;&#x5E93;&#x4E2D;&#x5B9A;&#x4E49;&#x7684;&#x7B26;&#x53F7;&#x5E94;&#x8BE5;&#x7528;&#x4E8E;&#x540E;&#x7EED;&#x52A0;&#x8F7D;&#x7684;&#x5E93;&#x4E2D;&#x7684;&#x7ED1;&#x5B9A;&#x64CD;&#x4F5C;&#xFF0C;&#x2013; &#x2013;export&#x2013;dynamic&#x94FE;&#x63A5;&#x5668;&#x9009;&#x9879;&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x4F7F;&#x4E3B;&#x7A0B;&#x5E8F;&#x7684;&#x5168;&#x5C40;&#x7B26;&#x53F7;&#x5BF9;&#x52A8;&#x6001;&#x52A0;&#x8F7D;&#x7684;&#x5E93;&#x53EF;&#x7528;&#x3002;</li>
</ol>
<h2 id="&#x94FE;&#x63A5;&#x5668;&#x7248;&#x672C;&#x811A;&#x672C;"><a href="#&#x94FE;&#x63A5;&#x5668;&#x7248;&#x672C;&#x811A;&#x672C;" class="headerlink" title="&#x94FE;&#x63A5;&#x5668;&#x7248;&#x672C;&#x811A;&#x672C;"></a>&#x94FE;&#x63A5;&#x5668;&#x7248;&#x672C;&#x811A;&#x672C;</h2><p>&#x7248;&#x672C;&#x811A;&#x672C;&#x662F;&#x4E00;&#x4E2A;&#x5305;&#x542B;&#x94FE;&#x63A5;&#x5668;ld&#x6267;&#x884C;&#x7684;&#x6307;&#x4EE4;&#x7684;&#x6587;&#x672C;&#x6587;&#x4EF6;&#x3002;&#x8981;&#x4F7F;&#x7528;&#x7248;&#x672C;&#x811A;&#x672C;&#x5FC5;&#x987B;&#x8981;&#x6307;&#x5B9A;&#x2013; &#x2013;version&#x2013;script&#x94FE;&#x63A5;&#x5668;&#x9009;&#x9879;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c">$ gcc <span class="token operator">-</span>Wl<span class="token punctuation">,</span><span class="token operator">--</span>version<span class="token operator">-</span>script<span class="token punctuation">,</span>myscriptfile<span class="token punctuation">.</span>map <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>&#x7248;&#x672C;&#x811A;&#x672C;&#x7684;&#x540E;&#x7F00;&#x901A;&#x5E38;&#xFF08;&#x4F46;&#x4E0D;&#x7EDF;&#x4E00;&#xFF09;&#x662F;.map&#x3002;</p>
<h3 id="&#x4F7F;&#x7528;&#x7248;&#x672C;&#x811A;&#x672C;&#x63A7;&#x5236;&#x7B26;&#x53F7;&#x7684;&#x53EF;&#x89C1;&#x6027;"><a href="#&#x4F7F;&#x7528;&#x7248;&#x672C;&#x811A;&#x672C;&#x63A7;&#x5236;&#x7B26;&#x53F7;&#x7684;&#x53EF;&#x89C1;&#x6027;" class="headerlink" title="&#x4F7F;&#x7528;&#x7248;&#x672C;&#x811A;&#x672C;&#x63A7;&#x5236;&#x7B26;&#x53F7;&#x7684;&#x53EF;&#x89C1;&#x6027;"></a>&#x4F7F;&#x7528;&#x7248;&#x672C;&#x811A;&#x672C;&#x63A7;&#x5236;&#x7B26;&#x53F7;&#x7684;&#x53EF;&#x89C1;&#x6027;</h3><p>&#x7248;&#x672C;&#x811A;&#x672C;&#x7684;&#x4E00;&#x4E2A;&#x7528;&#x9014;&#x662F;&#x63A7;&#x5236;&#x90A3;&#x4E9B;&#x53EF;&#x80FD;&#x4F1A;&#x5728;&#x65E0;&#x610F;&#x4E2D;&#x53D8;&#x6210;&#x5168;&#x5C40;&#x53EF;&#x89C1;&#xFF08;&#x5373;&#x5BF9;&#x4E0E;&#x8BE5;&#x5E93;&#x8FDB;&#x884C;&#x94FE;&#x63A5;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x53EF;&#x89C1;&#xFF09;&#x7684;&#x7B26;&#x53F7;&#x7684;&#x53EF;&#x89C1;&#x6027;&#x3002;&#x4E3E;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x4F8B;&#x5B50;&#xFF0C;&#x5047;&#x8BBE;&#x9700;&#x8981;&#x4ECE;&#x4E09;&#x4E2A;&#x6E90;&#x6587;&#x4EF6;vis_comm.c&#x3001;vis_f1.c&#x4EE5;&#x53CA; vis_f2.c&#x4E2D;&#x6784;&#x5EFA;&#x4E00;&#x4E2A;&#x5171;&#x4EAB;&#x5E93;&#xFF0C;&#x8FD9;&#x4E09;&#x4E2A;&#x6E90;&#x6587;&#x4EF6;&#x5206;&#x522B;&#x5B9A;&#x4E49;&#x4E86;&#x51FD;&#x6570;vis_comm()&#x3001;vis_f1()&#x4EE5;&#x53CA; vis_f2()&#x3002;vis_comm()&#x51FD;&#x6570;&#x7531;vis_f1() &#x548C; vis_f2()&#x8C03;&#x7528;&#xFF0C;&#x4F46;&#x4E0D;&#x60F3;&#x88AB;&#x4E0E;&#x8BE5;&#x5E93;&#x8FDB;&#x884C;&#x94FE;&#x63A5;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x76F4;&#x63A5;&#x4F7F;&#x7528;&#x3002;&#x518D;&#x5047;&#x8BBE;&#x4F7F;&#x7528;&#x5E38;&#x89C4;&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x6784;&#x5EFA;&#x5171;&#x4EAB;&#x5E93;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c">$ gcc <span class="token operator">-</span>g <span class="token operator">-</span>c <span class="token operator">-</span>fPIC <span class="token operator">-</span>Wall vis_comm<span class="token punctuation">.</span>c vis_f1<span class="token punctuation">.</span>c vis_f2<span class="token punctuation">.</span>c
$ gcc <span class="token operator">-</span>g <span class="token operator">-</span>shared <span class="token operator">-</span>o vis<span class="token punctuation">.</span>so vis_comm<span class="token punctuation">.</span>o vis_f1<span class="token punctuation">.</span>o vis_f2<span class="token punctuation">.</span>o<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x5982;&#x679C;&#x4F7F;&#x7528;&#x4E0B;&#x9762;&#x7684;readelf&#x547D;&#x4EE4;&#x6765;&#x5217;&#x51FA;&#x8BE5;&#x5E93;&#x5BFC;&#x51FA;&#x52A8;&#x6001;&#x7B26;&#x53F7;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x4F1A;&#x770B;&#x5230;&#x4E0B;&#x9762;&#x7684;&#x8F93;&#x51FA;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ readelf --syms --use-dynamic vis.so <span class="token operator">|</span> <span class="token function">grep</span> vis_
    30 12: 00000790   59    FUNC GLOBAL DEFAULT 10 vis_f1
    25 13: 000007d0   73    FUNC GLOBAL DEFAULT 10 vis_f2
    27 16: 00000770   20    FUNC GLOBAL DEFAULT 10 vis_comm<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x8FD9;&#x4E2A;&#x5171;&#x4EAB;&#x5E93;&#x5BFC;&#x51FA;&#x4E86;&#x4E09;&#x4E2A;&#x7B26;&#x53F7;&#xFF1A;vis_comm()&#x3001;vis_f1()&#x4EE5;&#x53CA;vis_f2()&#xFF0C;&#x4F46;&#x8FD9;&#x91CC;&#x9700;&#x8981;&#x786E;&#x4FDD;&#x8FD9;&#x4E2A;&#x5E93;&#x53EA;&#x5BFC;&#x51FA;vis_f1()&#x548C;vis_f2()&#x7B26;&#x53F7;&#x3002;&#x8FD9;&#x79CD;&#x6548;&#x679C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4E0B;&#x9762;&#x7684;&#x7248;&#x672C;&#x811A;&#x672C;&#x6765;&#x5B9E;&#x73B0;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">cat</span> vis.map
VER_1<span class="token punctuation">{</span>
    global:
        vis_f1<span class="token punctuation">;</span>
        vis_f2<span class="token punctuation">;</span>
    local:
        *<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x6807;&#x8BC6;&#x7B26;VER_1&#x662F;&#x4E00;&#x79CD;&#x7248;&#x672C;&#x6807;&#x7B7E;&#x3002;&#x5728;42.3.2&#x8282;&#x5BF9;&#x7B26;&#x53F7;&#x7248;&#x672C;&#x5316;&#x7684;&#x8BA8;&#x8BBA;&#x4E2D;&#x5C06;&#x4F1A;&#x770B;&#x5230;&#x4E00;&#x4E2A;&#x7248;&#x672C;&#x811A;&#x672C;&#x53EF;&#x4EE5;&#x5305;&#x542B;&#x591A;&#x4E2A;&#x7248;&#x672C;&#x8282;&#x70B9;&#xFF0C;&#x6BCF;&#x4E2A;&#x7248;&#x672C;&#x8282;&#x70B9;&#x4EE5;&#x62EC;&#x53F7;&#xFF08;{}&#xFF09;&#x7EC4;&#x7EC7;&#x8D77;&#x6765;&#x5E76;&#x4E14;&#x5728;&#x62EC;&#x53F7;&#x524D;&#x9762;&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x552F;&#x4E00;&#x7684;&#x7248;&#x672C;&#x6807;&#x7B7E;&#x3002;&#x5982;&#x679C;&#x4F7F;&#x7528;&#x7248;&#x672C;&#x811A;&#x672C;&#x53EA;&#x662F;&#x4E3A;&#x4E86;&#x63A7;&#x5236;&#x7B26;&#x53F7;&#x7684;&#x53EF;&#x89C1;&#x6027;&#xFF0C;&#x90A3;&#x4E48;&#x7248;&#x672C;&#x6807;&#x7B7E;&#x662F;&#x591A;&#x4F59;&#x7684;&#xFF0C;&#x4F46;&#x8001;&#x7248;&#x672C;&#x7684;ld&#x4ECD;&#x7136;&#x9700;&#x8981;&#x7528;&#x5230;&#x8FD9;&#x4E2A;&#x6807;&#x7B7E;&#x3002;ld&#x7684;&#x73B0;&#x4EE3;&#x7248;&#x672C;&#x5141;&#x8BB8;&#x7701;&#x7565;&#x7248;&#x672C;&#x6807;&#x7B7E;&#xFF0C;&#x5982;&#x679C;&#x7701;&#x7565;&#x4E86;&#x7248;&#x672C;&#x6807;&#x7B7E;&#x7684;&#x8BDD;&#x5C31;&#x8BA4;&#x4E3A;&#x7248;&#x672C;&#x8282;&#x70B9;&#x62E5;&#x6709;&#x4E00;&#x4E2A;&#x533F;&#x540D;&#x7248;&#x672C;&#x6807;&#x7B7E;&#x5E76;&#x4E14;&#x5728;&#x8FD9;&#x4E2A;&#x811A;&#x672C;&#x4E2D;&#x4E0D;&#x80FD;&#x5B58;&#x5728;&#x5176;&#x4ED6;&#x7248;&#x672C;&#x8282;&#x70B9;&#x3002;</p>
<p>&#x5728;&#x7248;&#x672C;&#x8282;&#x70B9;&#x4E2D;&#xFF0C;&#x5173;&#x952E;&#x8BCD;global&#x6807;&#x8BB0;&#x51FA;&#x4E86;&#x4EE5;&#x5206;&#x53F7;&#x5206;&#x9694;&#x7684;&#x5BF9;&#x5E93;&#x4E4B;&#x5916;&#x7684;&#x7A0B;&#x5E8F;&#x53EF;&#x89C1;&#x7684;&#x7B26;&#x53F7;&#x5217;&#x8868;&#x7684;&#x8D77;&#x59CB;&#x4F4D;&#x7F6E;&#xFF0C;&#x5173;&#x952E;&#x8BCD;local&#x6807;&#x8BB0;&#x51FA;&#x4E86;&#x4EE5;&#x5206;&#x53F7;&#x5206;&#x9694;&#x7684;&#x5BF9;&#x5E93;&#x4E4B;&#x5916;&#x7684;&#x7A0B;&#x5E8F;&#x9690;&#x85CF;&#x7684;&#x7B26;&#x53F7;&#x5217;&#x8868;&#x7684;&#x8D77;&#x59CB;&#x4F4D;&#x7F6E;&#x3002;&#x4E0A;&#x9762;&#x7684;&#x661F;&#x53F7;&#xFF08;<em>&#xFF09;&#x8BF4;&#x660E;&#x5728;&#x7B26;&#x53F7;&#x89C4;&#x8303;&#x4E2D;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x63A9;&#x7801;&#x6A21;&#x5F0F;&#xFF0C;&#x6240;&#x4F7F;&#x7528;&#x7684;&#x63A9;&#x7801;&#x5B57;&#x7B26;&#x4E0E;shell&#x6587;&#x4EF6;&#x540D;&#x5339;&#x914D;&#x4E2D;&#x4F7F;&#x7528;&#x7684;&#x63A9;&#x7801;&#x5B57;&#x7B26;&#x662F;&#x4E00;&#x6837;&#x7684;&#x2014;&#x2014;&#x5982;</em>&#x548C;?&#x3002;&#xFF08;&#x66F4;&#x591A;&#x7EC6;&#x8282;&#x8BF7;&#x53C2;&#x8003;glob(7)&#x624B;&#x518C;&#x3002;&#xFF09;&#x5728;&#x672C;&#x4F8B;&#x4E2D;&#xFF0C;local&#x89C4;&#x8303;&#x4E2D;&#x7684;&#x661F;&#x53F7;&#x8868;&#x793A;&#x9664;&#x4E86;&#x5728;global&#x6BB5;&#x4E2D;&#x663E;&#x5F0F;&#x58F0;&#x660E;&#x7684;&#x7B26;&#x53F7;&#x4E4B;&#x5916;&#x7684;&#x6240;&#x6709;&#x7B26;&#x53F7;&#x90FD;&#x5BF9;&#x5916;&#x9690;&#x85CF;&#x3002;&#x5982;&#x679C;&#x4E0D;&#x8FD9;&#x6837;&#x58F0;&#x660E;&#xFF0C;&#x90A3;&#x4E48;vis_comm()&#x4ECD;&#x7136;&#x662F;&#x53EF;&#x89C1;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#x5728;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;C&#x5168;&#x5C40;&#x7B26;&#x53F7;&#x5BF9;&#x5171;&#x4EAB;&#x5E93;&#x4E4B;&#x5916;&#x7684;&#x7A0B;&#x5E8F;&#x662F;&#x53EF;&#x89C1;&#x7684;&#x3002;</p>
<p>&#x63A5;&#x7740;&#x53EF;&#x4EE5;&#x50CF;&#x4E0B;&#x9762;&#x8FD9;&#x6837;&#x4F7F;&#x7528;&#x7248;&#x672C;&#x811A;&#x672C;&#x6765;&#x6784;&#x5EFA;&#x5171;&#x4EAB;&#x5E93;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ gcc -g -c -fPIC -Wall vis_comm.c vis_f1.c vis_f2.c
$ gcc -g -shared -o vis.so vis_comm.o vis_f1.o vis_f2.o -Wl,--version-script,vis.map<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x518D;&#x6B21;&#x4F7F;&#x7528;readelf&#x53EF;&#x4EE5;&#x770B;&#x51FA;vis_comm()&#x4E0D;&#x518D;&#x5BF9;&#x5916;&#x53EF;&#x89C1;&#x4E86;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ readelf --syns --use-dynamic vis.so <span class="token operator">|</span> <span class="token function">grep</span> vis_
    25 0:  00000730   73    FUNC GLOBAL DEFAULT 11 vis_f2
    29 16: 000006f0   59    FUNC GLOBAL DEFAULT 11 vis_f1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="&#x7B26;&#x53F7;&#x7248;&#x672C;&#x5316;"><a href="#&#x7B26;&#x53F7;&#x7248;&#x672C;&#x5316;" class="headerlink" title="&#x7B26;&#x53F7;&#x7248;&#x672C;&#x5316;"></a>&#x7B26;&#x53F7;&#x7248;&#x672C;&#x5316;</h3><p>&#x7B26;&#x53F7;&#x7248;&#x672C;&#x5316;&#x5141;&#x8BB8;&#x4E00;&#x4E2A;&#x5171;&#x4EAB;&#x5E93;&#x63D0;&#x4F9B;&#x540C;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x7684;&#x591A;&#x4E2A;&#x7248;&#x672C;&#x3002;&#x6BCF;&#x4E2A;&#x7A0B;&#x5E8F;&#x4F1A;&#x4F7F;&#x7528;&#x5B83;&#x4E0E;&#x5171;&#x4EAB;&#x5E93;&#x8FDB;&#x884C;&#xFF08;&#x9759;&#x6001;&#xFF09;&#x94FE;&#x63A5;&#x65F6;&#x51FD;&#x6570;&#x7684;&#x5F53;&#x524D;&#x7248;&#x672C;&#x3002;&#x8FD9;&#x79CD;&#x5904;&#x7406;&#x65B9;&#x5F0F;&#x7684;&#x7ED3;&#x679C;&#x662F;&#x53EF;&#x4EE5;&#x5BF9;&#x5171;&#x4EAB;&#x5E93;&#x8FDB;&#x884C;&#x4E0D;&#x517C;&#x5BB9;&#x7684;&#x6539;&#x52A8;&#x800C;&#x65E0;&#x9700;&#x63D0;&#x5347;&#x5E93;&#x7684;&#x4E3B;&#x8981;&#x7248;&#x672C;&#x53F7;&#x3002;&#x4ECE;&#x6781;&#x7AEF;&#x7684;&#x89D2;&#x5EA6;&#x6765;&#x8BB2;&#xFF0C;&#x7B26;&#x53F7;&#x7248;&#x672C;&#x5316;&#x53EF;&#x4EE5;&#x53D6;&#x4EE3;&#x4F20;&#x7EDF;&#x7684;&#x5171;&#x4EAB;&#x5E93;&#x4E3B;&#x8981;&#x548C;&#x6B21;&#x8981;&#x7248;&#x672C;&#x5316;&#x6A21;&#x578B;&#x3002;glibc&#x4ECE;2.1&#x5F00;&#x59CB;&#x4F7F;&#x7528;&#x4E86;&#x8FD9;&#x79CD;&#x7B26;&#x53F7;&#x7248;&#x672C;&#x5316;&#x6280;&#x672F;&#xFF0C;&#x56E0;&#x6B64;glibc 2.0&#x4EE5;&#x53CA;&#x4E4B;&#x524D;&#x7684;&#x6240;&#x6709;&#x7248;&#x672C;&#x90FD;&#x662F;&#x901A;&#x8FC7;&#x5355;&#x4E2A;&#x4E3B;&#x8981;&#x5E93;&#x7248;&#x672C;&#xFF08;libc.so.6&#xFF09;&#x6765;&#x652F;&#x6301;&#x7684;&#x3002;</p>
<p>&#x4E0B;&#x9762;&#x901A;&#x8FC7;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x4F8B;&#x5B50;&#x6765;&#x5C55;&#x793A;&#x7B26;&#x53F7;&#x7248;&#x672C;&#x5316;&#x7684;&#x7528;&#x9014;&#x3002;&#x9996;&#x5148;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x7248;&#x672C;&#x811A;&#x672C;&#x6765;&#x521B;&#x5EFA;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x7248;&#x672C;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">cat</span> sv_lib_v1.c
<span class="token comment" spellcheck="true">#include&lt;stdio.h&gt;</span>

void xyz<span class="token punctuation">(</span>void<span class="token punctuation">)</span><span class="token punctuation">{</span>printf<span class="token punctuation">(</span><span class="token string">&quot;v1 xyz\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
$ <span class="token function">cat</span> sv_v1.map
VER_1<span class="token punctuation">{</span>
    global: xyz<span class="token punctuation">;</span>
    local: *<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
$ gcc -g -c -fPIC -Wall sv_lib_v1.c
$ gcc -g -shared -o libsv.so sv_lib_v1.o -Wl,--version-script,sv_v1.map<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x5728;&#x8FD9;&#x4E2A;&#x9636;&#x6BB5;&#xFF0C;&#x7248;&#x672C;&#x811A;&#x672C;sv_v1.map&#x53EA;&#x7528;&#x6765;&#x63A7;&#x5236;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x7B26;&#x53F7;&#x7684;&#x53EF;&#x89C1;&#x6027;&#xFF0C;&#x5373;&#x53EA;&#x5BFC;&#x51FA;xyz()&#xFF0C;&#x540C;&#x65F6;&#x9690;&#x85CF;&#x5176;&#x4ED6;&#x6240;&#x6709;&#x7B26;&#x53F7;&#xFF08;&#x5728;&#x8FD9;&#x4E2A;&#x7B80;&#x77ED;&#x7684;&#x4F8B;&#x5B50;&#x4E2D;&#x6CA1;&#x6709;&#x5176;&#x4ED6;&#x7B26;&#x53F7;&#x4E86;&#xFF09;&#x3002;&#x63A5;&#x7740;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x7A0B;&#x5E8F;pl&#x6765;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x5E93;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">cat</span> sv_prog.c
<span class="token comment" spellcheck="true">#include&lt;stdio.h&gt;</span>

int main<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    void xyz<span class="token punctuation">(</span>void<span class="token punctuation">)</span><span class="token punctuation">;</span>
    xyz<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> 0<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
$ gcc -g -o p1 sv_prog.c libsv.so<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x8FD0;&#x884C;&#x8FD9;&#x4E2A;&#x7A0B;&#x5E8F;&#x4E4B;&#x540E;&#x5C31;&#x80FD;&#x770B;&#x5230;&#x9884;&#x671F;&#x7684;&#x7ED3;&#x679C;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ LD_LIBRARY_PATH<span class="token operator">=</span>. ./p1
v1 xyz<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x73B0;&#x5728;&#x5047;&#x8BBE;&#x9700;&#x8981;&#x4FEE;&#x6539;&#x5E93;&#x4E2D;xyz()&#x7684;&#x5B9A;&#x4E49;&#xFF0C;&#x4F46;&#x540C;&#x65F6;&#x4ECD;&#x7136;&#x9700;&#x8981;&#x786E;&#x4FDD;&#x7A0B;&#x5E8F;pl&#x7EE7;&#x7EED;&#x4F7F;&#x7528;&#x8001;&#x7248;&#x672C;&#x7684;&#x51FD;&#x6570;&#x3002;&#x4E3A;&#x5B8C;&#x6210;&#x8FD9;&#x4E2A;&#x4EFB;&#x52A1;&#xFF0C;&#x5FC5;&#x987B;&#x8981;&#x5728;&#x5E93;&#x4E2D;&#x5B9A;&#x4E49;&#x4E24;&#x4E2A;&#x7248;&#x672C;&#x7684;xyz()&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">cat</span> sv_lib_v2.c
<span class="token comment" spellcheck="true">#include&lt;stdio.h&gt;</span>

__asm__<span class="token punctuation">(</span><span class="token string">&quot;.symver xyz_old,xyz@VER_1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
__asm__<span class="token punctuation">(</span><span class="token string">&quot;.symver xyz_new,xyz@@VER_2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

void xyz_old<span class="token punctuation">(</span>void<span class="token punctuation">)</span><span class="token punctuation">{</span>printf<span class="token punctuation">(</span><span class="token string">&quot;v1 xyz\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
void xyz_new<span class="token punctuation">(</span>void<span class="token punctuation">)</span><span class="token punctuation">{</span>printf<span class="token punctuation">(</span><span class="token string">&quot;v2 xyz\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>

void pqr<span class="token punctuation">(</span>void<span class="token punctuation">)</span><span class="token punctuation">{</span>printf<span class="token punctuation">(</span><span class="token string">&quot;v2 pqr\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x8FD9;&#x91CC;&#x4E24;&#x4E2A;&#x7248;&#x672C;&#x7684;xyz()&#x662F;&#x901A;&#x8FC7;&#x51FD;&#x6570;xyz_old()&#x548C;xyz_new()&#x6765;&#x5B9E;&#x73B0;&#x7684;&#x3002;xyz_old()&#x51FD;&#x6570;&#x5BF9;&#x5E94;&#x4E8E;&#x539F;&#x6765;&#x7684;xyz()&#x5B9A;&#x4E49;&#xFF0C;pl&#x7A0B;&#x5E8F;&#x5E94;&#x8BE5;&#x7EE7;&#x7EED;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x3002;xyz_new()&#x51FD;&#x6570;&#x63D0;&#x4F9B;&#x4E86;&#x4E0E;&#x5E93;&#x7684;&#x65B0;&#x7248;&#x672C;&#x8FDB;&#x884C;&#x94FE;&#x63A5;&#x7684;&#x7A0B;&#x5E8F;&#x6240;&#x4F7F;&#x7528;&#x7684;xyz()&#x7684;&#x5B9A;&#x4E49;&#x3002;</p>
<p>&#x4FEE;&#x6539;&#x8FC7;&#x7684;&#x7248;&#x672C;&#x811A;&#x672C;&#xFF08;&#x7A0D;&#x540E;&#x7ED9;&#x51FA;&#xFF09;&#x4E2D;&#x7684;&#x4E24;&#x4E2A;.symver&#x6C47;&#x7F16;&#x5668;&#x6307;&#x4EE4;&#x5C06;&#x8FD9;&#x4E24;&#x4E2A;&#x51FD;&#x6570;&#x7ED1;&#x5B9A;&#x5230;&#x4E86;&#x4E24;&#x4E2A;&#x4E0D;&#x540C;&#x7684;&#x7248;&#x672C;&#x6807;&#x7B7E;&#x4E0A;&#xFF0C;&#x4E0B;&#x9762;&#x5C06;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x811A;&#x672C;&#x6765;&#x521B;&#x5EFA;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x65B0;&#x7248;&#x672C;&#x3002;&#x7B2C;&#x4E00;&#x4E2A;&#x6307;&#x4EE4;&#x6307;&#x793A;&#x4E0E;&#x7248;&#x672C;&#x6807;&#x7B7E;VER_1&#x8FDB;&#x884C;&#x94FE;&#x63A5;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#xFF08;&#x5373;&#x7A0B;&#x5E8F;pl&#xFF09;&#x6240;&#x4F7F;&#x7528;&#x7684;xyz()&#x7684;&#x5B9E;&#x73B0;&#x662F;xyz_old()&#xFF0C;&#x4E0E;&#x7248;&#x672C;&#x6807;&#x7B7E;VER_2&#x8FDB;&#x884C;&#x94FE;&#x63A5;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x6240;&#x4F7F;&#x7528;&#x7684;xyz()&#x7684;&#x5B9E;&#x73B0;&#x662F;xyz_new()&#x3002;</p>
<p>&#x7B2C;&#x4E8C;&#x4E2A;.symver&#x6307;&#x4EE4;&#x4F7F;&#x7528;@@&#xFF08;&#x4E0D;&#x662F;@&#xFF09;&#x6765;&#x6307;&#x793A;&#x5F53;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E0E;&#x8FD9;&#x4E2A;&#x5171;&#x4EAB;&#x5E93;&#x8FDB;&#x884C;&#x9759;&#x6001;&#x94FE;&#x63A5;&#x65F6;&#x5E94;&#x8BE5;&#x4F7F;&#x7528;&#x7684;xyz()&#x7684;&#x9ED8;&#x8BA4;&#x5B9A;&#x4E49;&#x3002;&#x4E00;&#x4E2A;&#x7B26;&#x53F7;&#x7684;.symver&#x6307;&#x4EE4;&#x4E2D;&#x5E94;&#x8BE5;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x6307;&#x4EE4;&#x4F7F;&#x7528;@@&#x6807;&#x8BB0;&#x3002;</p>
<p>&#x4E0B;&#x9762;&#x662F;&#x4E0E;&#x4FEE;&#x6539;&#x8FC7;&#x4E4B;&#x540E;&#x7684;&#x5E93;&#x5BF9;&#x5E94;&#x7684;&#x7248;&#x672C;&#x811A;&#x672C;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">cat</span> sv_v2.map
VER_1<span class="token punctuation">{</span>
    global: xyz<span class="token punctuation">;</span>
    local: *<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

VER_2<span class="token punctuation">{</span>
    global: pqr<span class="token punctuation">;</span>
<span class="token punctuation">}</span>VER_1<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x8FD9;&#x4E2A;&#x7248;&#x672C;&#x811A;&#x672C;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x65B0;&#x7248;&#x672C;&#x6807;&#x7B7E;VER_2&#xFF0C;&#x5B83;&#x4F9D;&#x8D56;&#x4E8E;&#x6807;&#x7B7E;VER_1&#x3002;&#x8FD9;&#x79CD;&#x4F9D;&#x8D56;&#x5173;&#x7CFB;&#x662F;&#x901A;&#x8FC7;&#x4E0B;&#x9762;&#x8FD9;&#x884C;&#x8FDB;&#x884C;&#x6807;&#x8BB0;&#x7684;&#x3002;<br><code>}VER_1;</code><br>&#x7248;&#x672C;&#x6807;&#x8BB0;&#x4F9D;&#x8D56;&#x8868;&#x660E;&#x4E86;&#x76F8;&#x90BB;&#x4E24;&#x4E2A;&#x5E93;&#x7248;&#x672C;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x7CFB;&#x3002;&#x4ECE;&#x8BED;&#x4E49;&#x4E0A;&#x6765;&#x8BB2;&#xFF0C;Linux&#x4E0A;&#x7684;&#x7248;&#x672C;&#x6807;&#x7B7E;&#x4F9D;&#x8D56;&#x7684;&#x552F;&#x4E00;&#x6548;&#x679C;&#x662F;&#x7248;&#x672C;&#x8282;&#x70B9;&#x53EF;&#x4EE5;&#x4ECE;&#x5B83;&#x6240;&#x4F9D;&#x8D56;&#x7684;&#x7248;&#x672C;&#x8282;&#x70B9;&#x4E2D;&#x7EE7;&#x627F;global&#x548C;local&#x89C4;&#x8303;&#x3002;</p>
<p>&#x4F9D;&#x8D56;&#x53EF;&#x4EE5;&#x4E32;&#x8054;&#x8D77;&#x6765;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x53EF;&#x4EE5;&#x5B9A;&#x4E49;&#x53E6;&#x4E00;&#x4E2A;&#x4F9D;&#x8D56;&#x4E8E;VER_2&#x7684;&#x7248;&#x672C;&#x8282;&#x70B9;VER_3&#x5E76;&#x4EE5;&#x6B64;&#x7C7B;&#x63A8;&#x5730;&#x5B9A;&#x4E49;&#x5176;&#x4ED6;&#x7248;&#x672C;&#x8282;&#x70B9;&#x3002;</p>
<p>&#x7248;&#x672C;&#x6807;&#x7B7E;&#x540D;&#x672C;&#x8EAB;&#x662F;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x610F;&#x4E49;&#x7684;&#xFF0C;&#x5B83;&#x4EEC;&#x76F8;&#x4E92;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x7CFB;&#x662F;&#x901A;&#x8FC7;&#x5236;&#x5B9A;&#x7684;&#x7248;&#x672C;&#x4F9D;&#x8D56;&#x6765;&#x786E;&#x5B9A;&#x7684;&#xFF0C;&#x56E0;&#x6B64;&#x8FD9;&#x91CC;&#x9009;&#x62E9;&#x540D;&#x79F0;VER_1&#x548C;VER_2&#x4EC5;&#x4EC5;&#x4E3A;&#x4E86;&#x6697;&#x793A;&#x5B83;&#x4EEC;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x7CFB;&#x3002;&#x4E3A;&#x4E86;&#x4FBF;&#x4E8E;&#x7EF4;&#x62A4;&#xFF0C;&#x5EFA;&#x8BAE;&#x5728;&#x7248;&#x672C;&#x6807;&#x7B7E;&#x540D;&#x4E2D;&#x5305;&#x542B;&#x5305;&#x540D;&#x548C;&#x4E00;&#x4E2A;&#x7248;&#x672C;&#x53F7;&#x3002;&#x5982;glibc&#x4F1A;&#x4F7F;&#x7528;&#x540D;&#x4E3A;GLIBC_2.0&#x548C;GLIBC_2.1&#x4E4B;&#x7C7B;&#x7684;&#x7248;&#x672C;&#x6807;&#x7B7E;&#x540D;&#x3002;</p>
<p>VER_2&#x7248;&#x672C;&#x6807;&#x7B7E;&#x8FD8;&#x6307;&#x5B9A;&#x4E86;&#x5C06;&#x5E93;&#x4E2D;&#x7684;pqr()&#x51FD;&#x6570;&#x5BFC;&#x51FA;&#x5E76;&#x7ED1;&#x5B9A;&#x5230;VER_2&#x7248;&#x672C;&#x6807;&#x7B7E;&#x3002;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x901A;&#x8FC7;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x6765;&#x58F0;&#x660E;pqr()&#xFF0C;&#x90A3;&#x4E48;VER_2&#x7248;&#x672C;&#x6807;&#x7B7E;&#x4ECE;VER_1&#x7248;&#x672C;&#x6807;&#x7B7E;&#x7EE7;&#x627F;&#x800C;&#x6765;&#x7684;local&#x89C4;&#x8303;&#x5C06;&#x4F1A;&#x4F7F;pqr()&#x5BF9;&#x5916;&#x4E0D;&#x53EF;&#x89C1;&#x3002;&#x8FD8;&#x9700;&#x6CE8;&#x610F;&#x7684;&#x662F;&#x5982;&#x679C;&#x7701;&#x7565;&#x4E86;local&#x89C4;&#x8303;&#xFF0C;&#x90A3;&#x4E48;&#x5E93;&#x4E2D;&#x7684;xyz_old()&#x548C;xyz_new()&#x7B26;&#x53F7;&#x4E5F;&#x4F1A;&#x88AB;&#x5BFC;&#x51FA;&#xFF08;&#x8FD9;&#x901A;&#x5E38;&#x4E0D;&#x662F;&#x671F;&#x671B;&#x53D1;&#x751F;&#x7684;&#x4E8B;&#x60C5;&#xFF09;&#x3002;</p>
<p>&#x73B0;&#x5728;&#x6309;&#x7167;&#x4EE5;&#x5F80;&#x65B9;&#x5F0F;&#x6784;&#x5EFA;&#x5E93;&#x7684;&#x65B0;&#x7248;&#x672C;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ gcc -g -c -fPIC -Wall sv_lib_v2.c
$ gcc -g -shared -o libsv.so sv_lib_v1.o -Wl,--version-script,sv_v2.map<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x73B0;&#x5728;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x7A0B;&#x5E8F;p2&#xFF0C;&#x5B83;&#x4F7F;&#x7528;&#x4E86;xyz()&#x7684;&#x65B0;&#x5B9A;&#x4E49;&#xFF0C;&#x540C;&#x65F6;&#x7A0B;&#x5E8F;p1&#x4F7F;&#x7528;&#x4E86;&#x65E7;&#x7248;&#x7684;xyz()&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ gcc -g -o p2 sv_prog.c libsv.so
$ LD_LIBRARY_PATH<span class="token operator">=</span>. ./p2
v2 xyz
$ LD_LIBRARY_PATH<span class="token operator">=</span>. ./p1
v1 xyz<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x7684;&#x7248;&#x672C;&#x6807;&#x7B7E;&#x4F9D;&#x8D56;&#x662F;&#x5728;&#x9759;&#x6001;&#x94FE;&#x63A5;&#x65F6;&#x8FDB;&#x884C;&#x8BB0;&#x5F55;&#x7684;&#x3002;&#x4F7F;&#x7528;objdump &#x2013;t&#x53EF;&#x4EE5;&#x6253;&#x5370;&#x51FA;&#x6BCF;&#x4E2A;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x7684;&#x7B26;&#x53F7;&#x8868;&#xFF0C;&#x4ECE;&#x800C;&#x80FD;&#x591F;&#x663E;&#x793A;&#x51FA;&#x4E24;&#x4E2A;&#x7A0B;&#x5E8F;&#x4E2D;&#x4E0D;&#x540C;&#x7684;&#x7248;&#x672C;&#x6807;&#x7B7E;&#x4F9D;&#x8D56;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ objdump -t p1 <span class="token operator">|</span> <span class="token function">grep</span> xyz
08048380     F *UND*   0000002e    xyz@@VER_1
$ objdump -t p2 <span class="token operator">|</span> <span class="token function">grep</span> xyz
080483a0     F *UND*   0000002e    xyz@@VER_1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x8FD8;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;readelf &#x2013;s&#x83B7;&#x53D6;&#x7C7B;&#x4F3C;&#x7684;&#x4FE1;&#x606F;&#x3002;</p>
<h2 id="&#x521D;&#x59CB;&#x5316;&#x548C;&#x7EC8;&#x6B62;&#x51FD;&#x6570;"><a href="#&#x521D;&#x59CB;&#x5316;&#x548C;&#x7EC8;&#x6B62;&#x51FD;&#x6570;" class="headerlink" title="&#x521D;&#x59CB;&#x5316;&#x548C;&#x7EC8;&#x6B62;&#x51FD;&#x6570;"></a>&#x521D;&#x59CB;&#x5316;&#x548C;&#x7EC8;&#x6B62;&#x51FD;&#x6570;</h2><p>&#x53EF;&#x4EE5;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x5728;&#x5171;&#x4EAB;&#x5E93;&#x88AB;&#x52A0;&#x8F7D;&#x548C;&#x5378;&#x8F7D;&#x65F6;&#x81EA;&#x52A8;&#x6267;&#x884C;&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x8FD9;&#x6837;&#x5728;&#x4F7F;&#x7528;&#x5171;&#x4EAB;&#x5E93;&#x65F6;&#x5C31;&#x80FD;&#x591F;&#x5B8C;&#x6210;&#x4E00;&#x4E9B;&#x521D;&#x59CB;&#x5316;&#x548C;&#x7EC8;&#x6B62;&#x5DE5;&#x4F5C;&#x4E86;&#x3002;&#x4E0D;&#x7BA1;&#x5E93;&#x662F;&#x81EA;&#x52A8;&#x88AB;&#x52A0;&#x8F7D;&#x8FD8;&#x662F;&#x4F7F;&#x7528;dlopen&#x63A5;&#x53E3;&#x663E;&#x5F0F;&#x52A0;&#x8F7D;&#x7684;&#xFF0C;&#x521D;&#x59CB;&#x5316;&#x51FD;&#x6570;&#x548C;&#x7EC8;&#x6B62;&#x51FD;&#x6570;&#x90FD;&#x4F1A;&#x88AB;&#x6267;&#x884C;&#x3002;</p>
<p>&#x521D;&#x59CB;&#x5316;&#x548C;&#x7EC8;&#x6B62;&#x51FD;&#x6570;&#x662F;&#x4F7F;&#x7528;gcc&#x7684;constructor&#x548C;destructor&#x7279;&#x6027;&#x6765;&#x5B9A;&#x4E49;&#x7684;&#x3002;&#x5728;&#x5E93;&#x88AB;&#x52A0;&#x8F7D;&#x65F6;&#x9700;&#x8981;&#x6267;&#x884C;&#x7684;&#x6240;&#x6709;&#x51FD;&#x6570;&#x90FD;&#x5E94;&#x8BE5;&#x5B9A;&#x4E49;&#x6210;&#x4E0B;&#x9762;&#x7684;&#x5F62;&#x5F0F;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">void __attribute__ <span class="token variable"><span class="token punctuation">((</span>constructor<span class="token punctuation">))</span></span> some_name_load<span class="token punctuation">(</span>void<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    //&#x521D;&#x59CB;&#x5316;&#x4EE3;&#x7801;
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x7C7B;&#x4F3C;&#x5730;&#xFF0C;&#x5378;&#x8F7D;&#x51FD;&#x6570;&#x7684;&#x5F62;&#x5F0F;&#x5982;&#x4E0B;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">void __attribute__ <span class="token variable"><span class="token punctuation">((</span>destructor<span class="token punctuation">))</span></span> some_name_unload<span class="token punctuation">(</span>void<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    //&#x7EC8;&#x6B62;&#x4EE3;&#x7801;
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x8BFB;&#x8005;&#x53EF;&#x4EE5;&#x6839;&#x636E;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x5176;&#x4ED6;&#x540D;&#x5B57;&#x66FF;&#x6362;&#x51FD;&#x6570;&#x540D;some_name_load()&#x548C;some_name_unload()&#x3002;</p>
<p>&#x4F7F;&#x7528;gcc&#x7684;constructor&#x548C;destructor&#x7279;&#x6027;&#x8FD8;&#x80FD;&#x521B;&#x5EFA;&#x4E3B;&#x7A0B;&#x5E8F;&#x7684;&#x521D;&#x59CB;&#x5316;&#x51FD;&#x6570;&#x548C;&#x7EC8;&#x6B62;&#x51FD;&#x6570;&#x3002;</p>
<p><strong>_init()&#x548C;_fini()&#x51FD;&#x6570;</strong><br>&#x7528;&#x6765;&#x5B8C;&#x6210;&#x5171;&#x4EAB;&#x5E93;&#x7684;&#x521D;&#x59CB;&#x5316;&#x548C;&#x7EC8;&#x6B62;&#x5DE5;&#x4F5C;&#x7684;&#x4E00;&#x9879;&#x8F83;&#x65E9;&#x7684;&#x6280;&#x672F;&#x662F;&#x5728;&#x5E93;&#x4E2D;&#x521B;&#x5EFA;&#x4E24;&#x4E2A;&#x51FD;&#x6570;_init()&#x548C;_fini()&#x3002;&#x5F53;&#x5E93;&#x9996;&#x6B21;&#x88AB;&#x8FDB;&#x7A0B;&#x52A0;&#x8F7D;&#x65F6;&#x4F1A;&#x6267;&#x884C;void _init(void)&#x4E2D;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x5F53;&#x5E93;&#x88AB;&#x5378;&#x8F7D;&#x65F6;&#x4F1A;&#x6267;&#x884C;void _fini(void)&#x51FD;&#x6570;&#x4E2D;&#x7684;&#x4EE3;&#x7801;&#x3002;</p>
<p>&#x5982;&#x679C;&#x521B;&#x5EFA;&#x4E86;_init()&#x548C;_fini()&#x51FD;&#x6570;&#xFF0C;&#x90A3;&#x4E48;&#x5728;&#x6784;&#x5EFA;&#x5171;&#x4EAB;&#x5E93;&#x65F6;&#x5FC5;&#x987B;&#x8981;&#x6307;&#x5B9A;gcc &#x2013;nostartfiles&#x9009;&#x9879;&#x4EE5;&#x9632;&#x6B62;&#x94FE;&#x63A5;&#x5668;&#x52A0;&#x5165;&#x8FD9;&#x4E9B;&#x51FD;&#x6570;&#x7684;&#x9ED8;&#x8BA4;&#x5B9E;&#x73B0;&#x3002;&#xFF08;&#x5982;&#x679C;&#x9700;&#x8981;&#x7684;&#x8BDD;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x2013;Wl,&#x2013;init&#x548C;&#x2013;Wl,&#x2013;fini&#x94FE;&#x63A5;&#x5668;&#x9009;&#x9879;&#x6765;&#x6307;&#x5B9A;&#x51FD;&#x6570;&#x7684;&#x540D;&#x79F0;&#x3002;&#xFF09;</p>
<p>&#x6709;&#x4E86;gcc&#x7684;constructor&#x548C;destructor&#x7279;&#x6027;&#x4E4B;&#x540E;&#x5DF2;&#x7ECF;&#x4E0D;&#x5EFA;&#x8BAE;&#x4F7F;&#x7528;_init()&#x548C;_fini()&#x51FD;&#x6570;&#x4E86;&#xFF0C;&#x56E0;&#x4E3A;gcc&#x7684;constructor&#x548C;destructor&#x7279;&#x6027;&#x5141;&#x8BB8;&#x5B9A;&#x4E49;&#x591A;&#x4E2A;&#x521D;&#x59CB;&#x5316;&#x548C;&#x7EC8;&#x6B62;&#x51FD;&#x6570;&#x3002;</p>
<h2 id="&#x9884;&#x52A0;&#x8F7D;&#x5171;&#x4EAB;&#x5E93;"><a href="#&#x9884;&#x52A0;&#x8F7D;&#x5171;&#x4EAB;&#x5E93;" class="headerlink" title="&#x9884;&#x52A0;&#x8F7D;&#x5171;&#x4EAB;&#x5E93;"></a>&#x9884;&#x52A0;&#x8F7D;&#x5171;&#x4EAB;&#x5E93;</h2><p>&#x51FA;&#x4E8E;&#x6D4B;&#x8BD5;&#x7684;&#x76EE;&#x7684;&#xFF0C;&#x6709;&#x4E9B;&#x65F6;&#x5019;&#x53EF;&#x4EE5;&#x6709;&#x9009;&#x62E9;&#x5730;&#x8986;&#x76D6;&#x4E00;&#x4E9B;&#x6B63;&#x5E38;&#x60C5;&#x51B5;&#x4E0B;&#x4F1A;&#x88AB;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x6309;&#x7167;41.11&#x8282;&#x4E2D;&#x4ECB;&#x7ECD;&#x7684;&#x89C4;&#x5219;&#x627E;&#x51FA;&#x7684;&#x51FD;&#x6570;&#xFF08;&#x4EE5;&#x53CA;&#x5176;&#x4ED6;&#x7B26;&#x53F7;&#xFF09;&#x3002;&#x8981;&#x5B8C;&#x6210;&#x8FD9;&#x4E2A;&#x4EFB;&#x52A1;&#x53EF;&#x4EE5;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x73AF;&#x5883;&#x53D8;&#x91CF;LD_PRELOAD&#xFF0C;&#x5176;&#x503C;&#x7531;&#x5728;&#x52A0;&#x8F7D;&#x5176;&#x4ED6;&#x5171;&#x4EAB;&#x5E93;&#x4E4B;&#x524D;&#x9700;&#x52A0;&#x8F7D;&#x7684;&#x5171;&#x4EAB;&#x5E93;&#x540D;&#x79F0;&#x6784;&#x6210;&#xFF0C;&#x5176;&#x4E2D;&#x5171;&#x4EAB;&#x5E93;&#x540D;&#x79F0;&#x4E4B;&#x95F4;&#x7528;&#x7A7A;&#x683C;&#x6216;&#x5192;&#x53F7;&#x5206;&#x9694;&#x3002;&#x7531;&#x4E8E;&#x9996;&#x5148;&#x4F1A;&#x52A0;&#x8F7D;&#x8FD9;&#x4E9B;&#x5171;&#x4EAB;&#x5E93;&#xFF0C;&#x56E0;&#x6B64;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x81EA;&#x52A8;&#x4F1A;&#x4F7F;&#x7528;&#x8FD9;&#x4E9B;&#x5E93;&#x4E2D;&#x5B9A;&#x4E49;&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x4ECE;&#x800C;&#x8986;&#x76D6;&#x90A3;&#x4E9B;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x5728;&#x5176;&#x4ED6;&#x60C5;&#x51B5;&#x4E0B;&#x4F1A;&#x641C;&#x7D22;&#x7684;&#x540C;&#x540D;&#x51FD;&#x6570;&#x3002;&#x5982;&#x5047;&#x8BBE;&#x6709;&#x4E00;&#x4E2A;&#x7A0B;&#x5E8F;&#x8C03;&#x7528;&#x4E86;&#x51FD;&#x6570;x1()&#x548C;x2()&#xFF0C;&#x5E76;&#x4E14;&#x8FD9;&#x4E24;&#x4E2A;&#x51FD;&#x6570;&#x5728;libdemo&#x5E93;&#x4E2D;&#x8FDB;&#x884C;&#x4E86;&#x5B9A;&#x4E49;&#x3002;&#x8FD9;&#x6837;&#x5F53;&#x8FD0;&#x884C;&#x8FD9;&#x4E2A;&#x7A0B;&#x5E8F;&#x65F6;&#x4F1A;&#x770B;&#x5230;&#x4E0B;&#x9762;&#x8FD9;&#x6837;&#x7684;&#x8F93;&#x51FA;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ ./prog
Called mod1-x1 DEMO
Called mod2-x2 DEMO<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#xFF08;&#x5728;&#x672C;&#x4F8B;&#x4E2D;&#x5047;&#x8BBE;&#x5171;&#x4EAB;&#x5E93;&#x4F4D;&#x4E8E;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x6807;&#x51C6;&#x76EE;&#x5F55;&#x4E2D;&#xFF0C;&#x56E0;&#x6B64;&#x65E0;&#x9700;&#x4F7F;&#x7528;LD_LIBRARY_PATH&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x3002;&#xFF09;</p>
<p>&#x63A5;&#x7740;&#x9700;&#x8981;&#x8986;&#x76D6;&#x51FD;&#x6570;x1()&#xFF0C;&#x8FD9;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x521B;&#x5EFA;&#x53E6;&#x4E00;&#x4E2A;&#x5305;&#x542B;&#x4E86;&#x4E0D;&#x540C;&#x7684;x1()&#x5B9A;&#x4E49;&#x7684;&#x5171;&#x4EAB;&#x5E93;libalt.so&#x6765;&#x5B8C;&#x6210;&#x3002;&#x5728;&#x8FD0;&#x884C;&#x8FD9;&#x4E2A;&#x7A0B;&#x5E8F;&#x65F6;&#x9884;&#x52A0;&#x8F7D;&#x8FD9;&#x4E2A;&#x5E93;&#x4F1A;&#x5F97;&#x5230;&#x4E0B;&#x9762;&#x7684;&#x8F93;&#x51FA;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ LD_PRELOAD<span class="token operator">=</span>libalt.xo ./prog
Called mod1-x1 ALT
Called mod2-x2 DEMO<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x4ECE;&#x4E0A;&#x9762;&#x7684;&#x8F93;&#x51FA;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#x7A0B;&#x5E8F;&#x8C03;&#x7528;&#x4E86;libalt.so&#x4E2D;&#x5B9A;&#x4E49;&#x7684;x1()&#xFF0C;&#x4F46;libalt.so&#x5E76;&#x6CA1;&#x6709;&#x5B9A;&#x4E49;x2()&#xFF0C;&#x56E0;&#x6B64;&#x5BF9;x2()&#x7684;&#x8C03;&#x7528;&#x4ECD;&#x7136;&#x4F1A;&#x8C03;&#x7528;libdemo.so&#x4E2D;&#x5B9A;&#x4E49;&#x7684;x2()&#x51FD;&#x6570;&#x3002;</p>
<p>LD_PRELOAD&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x63A7;&#x5236;&#x7740;&#x8FDB;&#x7A0B;&#x7EA7;&#x522B;&#x7684;&#x9884;&#x52A0;&#x8F7D;&#x884C;&#x4E3A;&#x3002;&#x6216;&#x8005;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;/etc/ld.so.preload&#x6587;&#x4EF6;&#x6765;&#x5728;&#x7CFB;&#x7EDF;&#x5C42;&#x9762;&#x5B8C;&#x6210;&#x540C;&#x6837;&#x7684;&#x4EFB;&#x52A1;&#xFF0C;&#x8BE5;&#x6587;&#x4EF6;&#x5217;&#x51FA;&#x4E86;&#x4EE5;&#x7A7A;&#x683C;&#x5206;&#x9694;&#x7684;&#x5E93;&#x5217;&#x8868;&#x3002;&#xFF08;LD_PRELOAD&#x6307;&#x5B9A;&#x7684;&#x5E93;&#x5C06;&#x5728;&#x52A0;&#x8F7D;/etc/ld.so.preload&#x6307;&#x5B9A;&#x7684;&#x5E93;&#x4E4B;&#x524D;&#x52A0;&#x8F7D;&#x3002;&#xFF09;</p>
<p>&#x51FA;&#x4E8E;&#x5B89;&#x5168;&#x539F;&#x56E0;&#xFF0C;set-user-ID&#x548C;set-group-ID&#x7A0B;&#x5E8F;&#x5FFD;&#x7565;&#x4E86;LD_PRELOAD&#x3002;</p>
<h2 id="&#x76D1;&#x63A7;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#xFF1A;LD-DEBUG"><a href="#&#x76D1;&#x63A7;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#xFF1A;LD-DEBUG" class="headerlink" title="&#x76D1;&#x63A7;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#xFF1A;LD_DEBUG"></a>&#x76D1;&#x63A7;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#xFF1A;LD_DEBUG</h2><p>&#x6709;&#x4E9B;&#x65F6;&#x5019;&#x9700;&#x8981;&#x76D1;&#x63A7;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x7684;&#x64CD;&#x4F5C;&#x4EE5;&#x5F04;&#x6E05;&#x695A;&#x5B83;&#x5728;&#x641C;&#x7D22;&#x54EA;&#x4E9B;&#x5E93;&#xFF0C;&#x8FD9;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;LD_DEBUG&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x6765;&#x5B8C;&#x6210;&#x3002;&#x901A;&#x8FC7;&#x5C06;&#x8FD9;&#x4E2A;&#x53D8;&#x91CF;&#x8BBE;&#x7F6E;&#x4E3A;&#x4E00;&#x4E2A;&#xFF08;&#x6216;&#x591A;&#x4E2A;&#xFF09;&#x6807;&#x51C6;&#x5173;&#x952E;&#x8BCD;&#x53EF;&#x4EE5;&#x4ECE;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x4E2D;&#x5F97;&#x5230;&#x5404;&#x79CD;&#x8DDF;&#x8E2A;&#x4FE1;&#x606F;&#x3002;</p>
<p>&#x5982;&#x679C;&#x5C06;help&#x8D4B;&#x7ED9;LD_DEBUG&#xFF0C;&#x90A3;&#x4E48;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x4F1A;&#x8F93;&#x51FA;&#x6709;&#x5173;LD_DEBUG&#x7684;&#x5E2E;&#x52A9;&#x4FE1;&#x606F;&#xFF0C;&#x800C;&#x6307;&#x5B9A;&#x7684;&#x547D;&#x4EE4;&#x4E0D;&#x4F1A;&#x88AB;&#x6267;&#x884C;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ LD_DEBUG<span class="token operator">=</span>help <span class="token function">date</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre><code>Valid options for the LD_DEBUG environment variable are:

  libs        display library search paths
  reloc       display relocation processing
  files       display progress for input file
  symbols     display symbol table processing
  bindings    display information about symbol binding
  versions    display version dependencies
  scopes      display scope information
  all         all previous options combined
  statistics  display relocation statistics
  unused      determined unused DSOs
  help        display this help message and exit

To direct the debugging output into a file instead of standard output
a filename can be specified using the LD_DEBUG_OUTPUT environment variable.</code></pre><p>&#x8981;&#x5C06;&#x8C03;&#x8BD5;&#x4FE1;&#x606F;&#x8F93;&#x51FA;&#x5230;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x4E2D;&#x800C;&#x4E0D;&#x662F;&#x6807;&#x51C6;&#x8F93;&#x51FA;&#x4E2D;&#xFF0C;&#x5219;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;LD_DEBUG_OUTPUT&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x6307;&#x5B9A;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x540D;&#x3002;</p>
<p>&#x5F53;&#x8BF7;&#x6C42;&#x4E0E;&#x8DDF;&#x8E2A;&#x5E93;&#x641C;&#x7D22;&#x76F8;&#x5173;&#x7684;&#x4FE1;&#x606F;&#x65F6;&#x4F1A;&#x4EA7;&#x751F;&#x5F88;&#x591A;&#x8F93;&#x51FA;&#xFF0C;&#x4E0B;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x5BF9;&#x8F93;&#x51FA;&#x8FDB;&#x884C;&#x4E86;&#x5220;&#x51CF;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">LD_DEBUG<span class="token operator">=</span>libs <span class="token function">date</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre><code>      8032:    find library=libc.so.6 [0]; searching
      8032:     search cache=/etc/ld.so.cache
      8032:      trying file=/lib/x86_64-linux-gnu/libc.so.6
      8032:    
      8032:    
      8032:    calling init: /lib/x86_64-linux-gnu/libc.so.6
      8032:    
      8032:    
      8032:    initialize program: date
      8032:    
      8032:    
      8032:    transferring control: date
      8032:    
Sun Feb 16 13:27:05 CST 2020</code></pre><p>&#x6BCF;&#x4E00;&#x884C;&#x5F00;&#x5934;&#x5904;&#x7684;10687&#x662F;&#x6307;&#x6240;&#x8DDF;&#x8E2A;&#x7684;&#x8FDB;&#x7A0B;&#x7684;&#x8FDB;&#x7A0B;ID&#xFF0C;&#x5F53;&#x76D1;&#x63A7;&#x591A;&#x4E2A;&#x8FDB;&#x7A0B;&#xFF08;&#x5982;&#x7236;&#x8FDB;&#x7A0B;&#x548C;&#x5B50;&#x8FDB;&#x7A0B;&#xFF09;&#x65F6;&#x4F1A;&#x7528;&#x5230;&#x8FD9;&#x4E2A;&#x503C;&#x3002;</p>
<p>&#x5728;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;LD_DEBUG&#x7684;&#x8F93;&#x51FA;&#x4F1A;&#x88AB;&#x5199;&#x5230;&#x6807;&#x51C6;&#x9519;&#x8BEF;&#x4E0A;&#xFF0C;&#x4F46;&#x53EF;&#x4EE5;&#x5C06;&#x4E00;&#x4E2A;&#x8DEF;&#x5F84;&#x540D;&#x8D4B;&#x7ED9;&#x73AF;&#x5883;&#x53D8;&#x91CF;LD_DEBUG_OUTPUT&#x6765;&#x5C06;&#x8F93;&#x51FA;&#x91CD;&#x5B9A;&#x5411;&#x5230;&#x5176;&#x4ED6;&#x5730;&#x65B9;&#x3002;</p>
<p>&#x5982;&#x679C;&#x9700;&#x8981;&#x7684;&#x8BDD;&#x53EF;&#x4EE5;&#x7ED9;LD_DEBUG&#x8D4B;&#x591A;&#x4E2A;&#x9009;&#x9879;&#xFF0C;&#x5404;&#x4E2A;&#x9009;&#x9879;&#x4E4B;&#x95F4;&#x7528;&#x9017;&#x53F7;&#x5206;&#x9694;&#xFF08;&#x4E0D;&#x80FD;&#x51FA;&#x73B0;&#x7A7A;&#x683C;&#xFF09;&#x3002;symbols&#x9009;&#x9879;&#xFF08;&#x8DDF;&#x8E2A;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x7684;&#x7B26;&#x53F7;&#x89E3;&#x6790;&#xFF09;&#x7684;&#x8F93;&#x51FA;&#x7279;&#x522B;&#x591A;&#x3002;</p>
<p>LD_DEBUG&#x5BF9;&#x4E8E;&#x7531;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5668;&#x9690;&#x5F0F;&#x52A0;&#x8F7D;&#x7684;&#x5E93;&#x548C;&#x4F7F;&#x7528;dlopen()&#x52A8;&#x6001;&#x52A0;&#x8F7D;&#x7684;&#x5E93;&#x90FD;&#x6709;&#x6548;&#x3002;</p>
<p>&#x51FA;&#x4E8E;&#x5B89;&#x5168;&#x7684;&#x539F;&#x56E0;&#xFF0C;&#x5728;set-user-ID&#x548C;set-setgroup-ID&#x7A0B;&#x5E8F;&#x4E2D;&#x5C06;&#x4F1A;&#x5FFD;&#x7565;LD_DEBUG&#xFF08;&#x81EA;glibc 2.2.5&#x8D77;&#xFF09;&#x3002;</p>
<h1 id="&#x8FDB;&#x7A0B;&#x95F4;&#x901A;&#x4FE1;&#x7B80;&#x4ECB;"><a href="#&#x8FDB;&#x7A0B;&#x95F4;&#x901A;&#x4FE1;&#x7B80;&#x4ECB;" class="headerlink" title="&#x8FDB;&#x7A0B;&#x95F4;&#x901A;&#x4FE1;&#x7B80;&#x4ECB;"></a>&#x8FDB;&#x7A0B;&#x95F4;&#x901A;&#x4FE1;&#x7B80;&#x4ECB;</h1><h2 id="IPC&#x5DE5;&#x5177;&#x5206;&#x7C7B;"><a href="#IPC&#x5DE5;&#x5177;&#x5206;&#x7C7B;" class="headerlink" title="IPC&#x5DE5;&#x5177;&#x5206;&#x7C7B;"></a>IPC&#x5DE5;&#x5177;&#x5206;&#x7C7B;</h2><div class="amp-img-wrapper"><amp-img src="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1581831064221.png?x-oss-process=image/resize,m_lfit,h_450" width="379" height="450" layout="responsive"></amp-img></div>
<p>&#x4E0A;&#x56FE;&#x603B;&#x7ED3;&#x4E86;UNIX&#x7CFB;&#x7EDF;&#x4E0A;&#x5404;&#x79CD;&#x901A;&#x4FE1;&#x548C;&#x540C;&#x6B65;&#x5DE5;&#x5177;&#xFF0C;&#x5E76;&#x6839;&#x636E;&#x529F;&#x80FD;&#x5C06;&#x5B83;&#x4EEC;&#x5206;&#x6210;&#x4E86;&#x4E09;&#x7C7B;&#x3002;</p>
<ul>
<li>&#x901A;&#x4FE1;&#xFF1A;&#x8FD9;&#x4E9B;&#x5DE5;&#x5177;&#x5173;&#x6CE8;&#x8FDB;&#x7A0B;&#x4E4B;&#x95F4;&#x7684;&#x6570;&#x636E;&#x4EA4;&#x6362;&#x3002;</li>
<li>&#x540C;&#x6B65;&#xFF1A;&#x8FD9;&#x4E9B;&#x8FDB;&#x7A0B;&#x5173;&#x6CE8;&#x8FDB;&#x7A0B;&#x548C;&#x7EBF;&#x7A0B;&#x64CD;&#x4F5C;&#x4E4B;&#x95F4;&#x7684;&#x540C;&#x6B65;&#x3002;</li>
<li>&#x4FE1;&#x53F7;&#xFF1A;&#x5C3D;&#x7BA1;&#x4FE1;&#x53F7;&#x7684;&#x4E3B;&#x8981;&#x4F5C;&#x7528;&#x5E76;&#x4E0D;&#x5728;&#x6B64;&#xFF0C;&#x4F46;&#x5728;&#x7279;&#x5B9A;&#x573A;&#x666F;&#x4E0B;&#x4ECD;&#x7136;&#x53EF;&#x4EE5;&#x5C06;&#x5B83;&#x4F5C;&#x4E3A;&#x4E00;&#x79CD;&#x540C;&#x6B65;&#x6280;&#x672F;&#x3002;&#x66F4;&#x7F55;&#x89C1;&#x7684;&#x662F;&#x4FE1;&#x53F7;&#x8FD8;&#x53EF;&#x4EE5;&#x4F5C;&#x4E3A;&#x4E00;&#x79CD;&#x901A;&#x4FE1;&#x6280;&#x672F;&#xFF1A;&#x4FE1;&#x53F7;&#x7F16;&#x53F7;&#x672C;&#x8EAB;&#x662F;&#x4E00;&#x79CD;&#x5F62;&#x5F0F;&#x7684;&#x4FE1;&#x606F;&#xFF0C;&#x5E76;&#x4E14;&#x53EF;&#x4EE5;&#x5728;&#x5B9E;&#x65F6;&#x4FE1;&#x53F7;&#x4E0A;&#x7ED1;&#x5B9A;&#x6570;&#x636E;&#xFF08;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#x6216;&#x6307;&#x9488;&#xFF09;&#x3002;</li>
</ul>
<p>&#x5C3D;&#x7BA1;&#x5176;&#x4E2D;&#x4E00;&#x4E9B;&#x5DE5;&#x5177;&#x5173;&#x6CE8;&#x7684;&#x662F;&#x540C;&#x6B65;&#xFF0C;&#x4F46;&#x901A;&#x7528;&#x672F;&#x8BED;&#x8FDB;&#x7A0B;&#x95F4;&#x901A;&#x4FE1;&#xFF08;IPC&#xFF09;&#x901A;&#x5E38;&#x6307;&#x4EE3;&#x6240;&#x6709;&#x8FD9;&#x4E9B;&#x5DE5;&#x5177;&#x3002;</p>
<p>&#x901A;&#x5E38;&#x51E0;&#x4E2A;&#x5DE5;&#x5177;&#x4F1A;&#x63D0;&#x4F9B;&#x7C7B;&#x4F3C;&#x7684;IPC&#x529F;&#x80FD;&#xFF0C;&#x4E4B;&#x6240;&#x4EE5;&#x4F1A;&#x8FD9;&#x6837;&#x662F;&#x51FA;&#x4E8E;&#x4E0B;&#x5217;&#x539F;&#x56E0;&#x3002;</p>
<ul>
<li>&#x4E0D;&#x540C;&#x7684;&#x5DE5;&#x5177;&#x5728;&#x4E0D;&#x540C;&#x7684;UNIX&#x5B9E;&#x73B0;&#x4E0A;&#x5404;&#x81EA;&#x8FDB;&#x884C;&#x6F14;&#x5316;&#xFF0C;&#x968F;&#x540E;&#x88AB;&#x79FB;&#x690D;&#x5230;&#x4E86;&#x5176;&#x4ED6;UNIX&#x7CFB;&#x7EDF;&#x4E0A;&#x3002;&#x5982;FIFO&#x9996;&#x5148;&#x662F;&#x5728;System V&#x4E0A;&#x5B9E;&#x73B0;&#x7684;&#xFF0C;&#x800C;&#xFF08;&#x6D41;&#xFF09;socket&#x662F;&#x9996;&#x5148;&#x662F;&#x5728;BSD&#x4E0A;&#x5B9E;&#x73B0;&#x7684;&#x3002;</li>
<li>&#x65B0;&#x5DE5;&#x5177;&#x88AB;&#x5F00;&#x53D1;&#x51FA;&#x6765;&#x7528;&#x4E8E;&#x5F25;&#x8865;&#x4E4B;&#x524D;&#x7C7B;&#x4F3C;&#x7684;&#x5DE5;&#x5177;&#x5B58;&#x5728;&#x7684;&#x4E0D;&#x8DB3;&#x3002;&#x5982;POSIX IPC&#x5DE5;&#x5177;&#xFF08;&#x6D88;&#x606F;&#x961F;&#x5217;&#x3001;&#x4FE1;&#x53F7;&#x91CF;&#x4EE5;&#x53CA;&#x5171;&#x4EAB;&#x5185;&#x5B58;&#xFF09;&#x662F;&#x5BF9;&#x8F83;&#x65E9;&#x7684;System V IPC&#x5DE5;&#x5177;&#x7684;&#x6539;&#x8FDB;&#x3002;</li>
</ul>
<p>&#x88AB;&#x5206;&#x6210;&#x4E00;&#x7EC4;&#x7684;&#x5DE5;&#x5177;&#x5728;&#x4E00;&#x4E9B;&#x573A;&#x666F;&#x4E2D;&#x4F1A;&#x63D0;&#x4F9B;&#x5B8C;&#x5168;&#x4E0D;&#x540C;&#x7684;&#x529F;&#x80FD;&#x3002;&#x5982;&#x6D41;socket&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x5728;&#x7F51;&#x7EDC;&#x4E0A;&#x901A;&#x4FE1;&#xFF0C;&#x800C;FIFO&#x5219;&#x53EA;&#x80FD;&#x7528;&#x6765;&#x5728;&#x540C;&#x4E00;&#x673A;&#x5668;&#x4E0A;&#x7684;&#x8FDB;&#x7A0B;&#x95F4;&#x8FDB;&#x884C;&#x901A;&#x4FE1;&#x3002;</p>
<h2 id="&#x901A;&#x4FE1;&#x5DE5;&#x5177;"><a href="#&#x901A;&#x4FE1;&#x5DE5;&#x5177;" class="headerlink" title="&#x901A;&#x4FE1;&#x5DE5;&#x5177;"></a>&#x901A;&#x4FE1;&#x5DE5;&#x5177;</h2><p>&#x53EF;&#x4EE5;&#x5C06;&#x901A;&#x4FE1;&#x5DE5;&#x5177;&#x5206;&#x6210;&#x4E24;&#x7C7B;&#x3002;</p>
<ul>
<li>&#x6570;&#x636E;&#x4F20;&#x8F93;&#x5DE5;&#x5177;&#xFF1A;&#x533A;&#x5206;&#x8FD9;&#x4E9B;&#x5DE5;&#x5177;&#x7684;&#x5173;&#x952E;&#x56E0;&#x7D20;&#x662F;&#x5199;&#x5165;&#x548C;&#x8BFB;&#x53D6;&#x7684;&#x6982;&#x5FF5;&#x3002;&#x4E3A;&#x4E86;&#x8FDB;&#x884C;&#x901A;&#x4FE1;&#xFF0C;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x5C06;&#x6570;&#x636E;&#x5199;&#x5165;&#x5230;IPC&#x5DE5;&#x5177;&#x4E2D;&#xFF0C;&#x53E6;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x4ECE;&#x4E2D;&#x8BFB;&#x53D6;&#x6570;&#x636E;&#x3002;&#x8FD9;&#x4E9B;&#x5DE5;&#x5177;&#x8981;&#x6C42;&#x5728;&#x7528;&#x6237;&#x5185;&#x5B58;&#x548C;&#x5185;&#x6838;&#x5185;&#x5B58;&#x4E4B;&#x95F4;&#x8FDB;&#x884C;&#x4E24;&#x6B21;&#x6570;&#x636E;&#x4F20;&#x8F93;&#xFF1A;&#x4E00;&#x6B21;&#x4F20;&#x8F93;&#x662F;&#x5728;&#x5199;&#x5165;&#x7684;&#x65F6;&#x5019;&#x4ECE;&#x7528;&#x6237;&#x5185;&#x5B58;&#x5230;&#x5185;&#x6838;&#x5185;&#x5B58;&#xFF0C;&#x53E6;&#x4E00;&#x6B21;&#x4F20;&#x8F93;&#x662F;&#x5728;&#x8BFB;&#x53D6;&#x7684;&#x65F6;&#x5019;&#x4ECE;&#x5185;&#x6838;&#x5185;&#x5B58;&#x5230;&#x7528;&#x6237;&#x5185;&#x5B58;&#x3002;</li>
<li>&#x5171;&#x4EAB;&#x5185;&#x5B58;&#xFF1A;&#x5171;&#x4EAB;&#x5185;&#x5B58;&#x5141;&#x8BB8;&#x8FDB;&#x7A0B;&#x901A;&#x8FC7;&#x5C06;&#x6570;&#x636E;&#x653E;&#x5230;&#x7531;&#x8FDB;&#x7A0B;&#x95F4;&#x5171;&#x4EAB;&#x7684;&#x4E00;&#x5757;&#x5185;&#x5B58;&#x4E2D;&#x4EE5;&#x5B8C;&#x6210;&#x4FE1;&#x606F;&#x7684;&#x4EA4;&#x6362;&#x3002;&#xFF08;&#x5185;&#x6838;&#x901A;&#x8FC7;&#x5C06;&#x6BCF;&#x4E2A;&#x8FDB;&#x7A0B;&#x4E2D;&#x7684;&#x9875;&#x8868;&#x6761;&#x76EE;&#x6307;&#x5411;&#x540C;&#x4E00;&#x4E2A;RAM&#x5206;&#x9875;&#x6765;&#x5B9E;&#x73B0;&#x8FD9;&#x4E00;&#x529F;&#x80FD;&#xFF0C;&#x5982;&#x56FE;49-2&#x6240;&#x793A;&#x3002;&#xFF09;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5C06;&#x6570;&#x636E;&#x653E;&#x5230;&#x5171;&#x4EAB;&#x5185;&#x5B58;&#x5757;&#x4E2D;&#x4F7F;&#x5F97;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x8BFB;&#x53D6;&#x8FD9;&#x4E9B;&#x6570;&#x636E;&#x3002;&#x7531;&#x4E8E;&#x901A;&#x4FE1;&#x65E0;&#x9700;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x4EE5;&#x53CA;&#x7528;&#x6237;&#x5185;&#x5B58;&#x548C;&#x5185;&#x6838;&#x5185;&#x5B58;&#x4E4B;&#x95F4;&#x7684;&#x6570;&#x636E;&#x4F20;&#x8F93;&#xFF0C;&#x56E0;&#x6B64;&#x5171;&#x4EAB;&#x5185;&#x5B58;&#x7684;&#x901F;&#x5EA6;&#x975E;&#x5E38;&#x5FEB;&#x3002;</li>
</ul>
<h3 id="&#x6570;&#x636E;&#x4F20;&#x8F93;"><a href="#&#x6570;&#x636E;&#x4F20;&#x8F93;" class="headerlink" title="&#x6570;&#x636E;&#x4F20;&#x8F93;"></a>&#x6570;&#x636E;&#x4F20;&#x8F93;</h3><p>&#x53EF;&#x4EE5;&#x8FDB;&#x4E00;&#x6B65;&#x5C06;&#x6570;&#x636E;&#x4F20;&#x8F93;&#x5DE5;&#x5177;&#x5206;&#x6210;&#x4E0B;&#x5217;&#x7C7B;&#x522B;&#x3002;</p>
<ul>
<li>&#x5B57;&#x8282;&#x6D41;&#xFF1A;&#x901A;&#x8FC7;&#x7BA1;&#x9053;&#x3001;FIFO&#x4EE5;&#x53CA;&#x6570;&#x636E;&#x62A5;socket&#x4EA4;&#x6362;&#x7684;&#x6570;&#x636E;&#x662F;&#x4E00;&#x4E2A;&#x65E0;&#x5206;&#x9694;&#x7B26;&#x7684;&#x5B57;&#x8282;&#x6D41;&#x3002;&#x6BCF;&#x4E2A;&#x8BFB;&#x53D6;&#x64CD;&#x4F5C;&#x53EF;&#x80FD;&#x4F1A;&#x4ECE;IPC&#x5DE5;&#x5177;&#x4E2D;&#x8BFB;&#x53D6;&#x4EFB;&#x610F;&#x6570;&#x91CF;&#x7684;&#x5B57;&#x8282;&#xFF0C;&#x4E0D;&#x7BA1;&#x5199;&#x8005;&#x5199;&#x5165;&#x7684;&#x5757;&#x7684;&#x5927;&#x5C0F;&#x662F;&#x4EC0;&#x4E48;&#x3002;&#x8FD9;&#x4E2A;&#x6A21;&#x578B;&#x53C2;&#x8003;&#x4E86;&#x4F20;&#x7EDF;&#x7684;UNIX&#x201C;&#x6587;&#x4EF6;&#x662F;&#x4E00;&#x4E2A;&#x5B57;&#x8282;&#x5E8F;&#x5217;&#x201D;&#x6A21;&#x578B;&#x3002;</li>
<li>&#x6D88;&#x606F;&#xFF1A;&#x901A;&#x8FC7;System V&#x6D88;&#x606F;&#x961F;&#x5217;&#x3001;POSIX&#x6D88;&#x606F;&#x961F;&#x5217;&#x4EE5;&#x53CA;&#x6570;&#x636E;&#x62A5;socket&#x4EA4;&#x6362;&#x7684;&#x6570;&#x636E;&#x662F;&#x4EE5;&#x5206;&#x9694;&#x7B26;&#x5206;&#x9694;&#x7684;&#x6D88;&#x606F;&#x3002;&#x6BCF;&#x4E2A;&#x8BFB;&#x53D6;&#x64CD;&#x4F5C;&#x8BFB;&#x53D6;&#x7531;&#x5199;&#x8005;&#x5199;&#x5165;&#x7684;&#x4E00;&#x6574;&#x6761;&#x6D88;&#x606F;&#xFF0C;&#x65E0;&#x6CD5;&#x53EA;&#x8BFB;&#x53D6;&#x90E8;&#x5206;&#x6D88;&#x606F;&#xFF0C;&#x800C;&#x628A;&#x5269;&#x4F59;&#x90E8;&#x5206;&#x7559;&#x5728;IPC&#x5DE5;&#x5177;&#x4E2D;&#xFF0C;&#x4E5F;&#x65E0;&#x6CD5;&#x5728;&#x4E00;&#x4E2A;&#x8BFB;&#x53D6;&#x64CD;&#x4F5C;&#x4E2D;&#x8BFB;&#x53D6;&#x591A;&#x6761;&#x6D88;&#x606F;&#x3002;</li>
<li>&#x4F2A;&#x7EC8;&#x7AEF;&#xFF1A;&#x4F2A;&#x7EC8;&#x7AEF;&#x662F;&#x4E00;&#x79CD;&#x5728;&#x7279;&#x6B8A;&#x60C5;&#x51B5;&#x4E0B;&#x4F7F;&#x7528;&#x7684;&#x901A;&#x4FE1;&#x5DE5;&#x5177;&#xFF0C;&#x5728;64&#x7AE0;&#x5C06;&#x4F1A;&#x4ECB;&#x7ECD;&#x6709;&#x5173;&#x4F2A;&#x7EC8;&#x7AEF;&#x7684;&#x8BE6;&#x7EC6;&#x4FE1;&#x606F;&#x3002;</li>
</ul>
<p>&#x6570;&#x636E;&#x4F20;&#x8F93;&#x5DE5;&#x5177;&#x548C;&#x5171;&#x4EAB;&#x5185;&#x5B58;&#x4E4B;&#x95F4;&#x7684;&#x5DEE;&#x522B;&#x5305;&#x62EC;&#x4EE5;&#x4E0B;&#x51E0;&#x4E2A;&#x65B9;&#x9762;&#x3002;</p>
<ul>
<li>&#x5C3D;&#x7BA1;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x4F20;&#x8F93;&#x5DE5;&#x5177;&#x53EF;&#x80FD;&#x4F1A;&#x6709;&#x591A;&#x4E2A;&#x8BFB;&#x53D6;&#x8005;&#xFF0C;&#x4F46;&#x8BFB;&#x53D6;&#x64CD;&#x4F5C;&#x662F;&#x5177;&#x6709;&#x7834;&#x574F;&#x6027;&#x7684;&#x3002;&#x8BFB;&#x53D6;&#x64CD;&#x4F5C;&#x4F1A;&#x6D88;&#x8017;&#x6570;&#x636E;&#xFF0C;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x5C06;&#x65E0;&#x6CD5;&#x83B7;&#x53D6;&#x6240;&#x6D88;&#x8017;&#x7684;&#x6570;&#x636E;&#x3002;<br>&#x5728;socket&#x4E2D;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;MSG_PEEK&#x6807;&#x8BB0;&#x6765;&#x6267;&#x884C;&#x975E;&#x7834;&#x574F;&#x6027;&#x8BFB;&#x53D6;&#x3002;UDP&#xFF08;Internet domain datagram&#xFF09;socket&#x5141;&#x8BB8;&#x5C06;&#x4E00;&#x6761;&#x6D88;&#x606F;&#x5E7F;&#x64AD;&#x6216;&#x7EC4;&#x64AD;&#x5230;&#x591A;&#x4E2A;&#x63A5;&#x6536;&#x8005;&#x5904;&#x3002;</li>
<li>&#x8BFB;&#x53D6;&#x8005;&#x548C;&#x5199;&#x8005;&#x8FDB;&#x7A0B;&#x4E4B;&#x95F4;&#x7684;&#x540C;&#x6B65;&#x662F;&#x539F;&#x5B50;&#x7684;&#x3002;&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x8BFB;&#x53D6;&#x8005;&#x8BD5;&#x56FE;&#x4ECE;&#x4E00;&#x4E2A;&#x5F53;&#x524D;&#x4E0D;&#x5305;&#x542B;&#x6570;&#x636E;&#x7684;&#x6570;&#x636E;&#x4F20;&#x8F93;&#x5DE5;&#x5177;&#x4E2D;&#x8BFB;&#x53D6;&#x6570;&#x636E;&#xFF0C;&#x90A3;&#x4E48;&#x5728;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#x8BFB;&#x53D6;&#x64CD;&#x4F5C;&#x4F1A;&#x88AB;&#x963B;&#x585E;&#x76F4;&#x81F3;&#x4E00;&#x4E9B;&#x8FDB;&#x7A0B;&#x5411;&#x8BE5;&#x5DE5;&#x5177;&#x5199;&#x5165;&#x4E86;&#x6570;&#x636E;&#x3002;</li>
</ul>
<h3 id="&#x5171;&#x4EAB;&#x5185;&#x5B58;"><a href="#&#x5171;&#x4EAB;&#x5185;&#x5B58;" class="headerlink" title="&#x5171;&#x4EAB;&#x5185;&#x5B58;"></a>&#x5171;&#x4EAB;&#x5185;&#x5B58;</h3><p>&#x5927;&#x591A;&#x6570;&#x73B0;&#x4EE3;UNIX&#x7CFB;&#x7EDF;&#x63D0;&#x4F9B;&#x4E86;&#x4E09;&#x79CD;&#x5F62;&#x5F0F;&#x7684;&#x5171;&#x4EAB;&#x5185;&#x5B58;&#xFF1A;System V&#x5171;&#x4EAB;&#x5185;&#x5B58;&#x3001;POSIX&#x5171;&#x4EAB;&#x5185;&#x5B58;&#x4EE5;&#x53CA;&#x5185;&#x5B58;&#x6620;&#x5C04;&#x3002;&#x5728;&#x540E;&#x9762;&#x4ECB;&#x7ECD;&#x8FD9;&#x4E9B;&#x5DE5;&#x5177;&#x7684;&#x7AE0;&#x8282;&#x4E2D;&#x5C06;&#x4F1A;&#x63CF;&#x8FF0;&#x5B83;&#x4EEC;&#x4E4B;&#x95F4;&#x7684;&#x5DEE;&#x522B;&#x3002;</p>
<p>&#x4E0B;&#x9762;&#x662F;&#x4F7F;&#x7528;&#x5171;&#x4EAB;&#x5185;&#x5B58;&#x65F6;&#x7684;&#x6CE8;&#x610F;&#x70B9;&#x3002;  </p>
<ul>
<li>&#x5C3D;&#x7BA1;&#x5171;&#x4EAB;&#x5185;&#x5B58;&#x7684;&#x901A;&#x4FE1;&#x901F;&#x5EA6;&#x66F4;&#x5FEB;&#xFF0C;&#x4F46;&#x901F;&#x5EA6;&#x4E0A;&#x7684;&#x4F18;&#x52BF;&#x662F;&#x7528;&#x6765;&#x5F25;&#x8865;&#x9700;&#x8981;&#x5BF9;&#x5728;&#x5171;&#x4EAB;&#x5185;&#x5B58;&#x4E0A;&#x53D1;&#x751F;&#x7684;&#x64CD;&#x4F5C;&#x8FDB;&#x884C;&#x540C;&#x6B65;&#x7684;&#x4E0D;&#x8DB3;&#x7684;&#x3002;&#x5982;&#x5F53;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x6B63;&#x5728;&#x66F4;&#x65B0;&#x5171;&#x4EAB;&#x5185;&#x5B58;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x65F6;&#xFF0C;&#x53E6;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x5C31;&#x4E0D;&#x5E94;&#x8BE5;&#x8BD5;&#x56FE;&#x8BFB;&#x53D6;&#x8FD9;&#x4E2A;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x3002;&#x5728;&#x5171;&#x4EAB;&#x5185;&#x5B58;&#x4E2D;&#xFF0C;&#x4FE1;&#x53F7;&#x91CF;&#x901A;&#x5E38;&#x7528;&#x6765;&#x4F5C;&#x4E3A;&#x540C;&#x6B65;&#x65B9;&#x6CD5;&#x3002;</li>
<li>&#x653E;&#x5165;&#x5171;&#x4EAB;&#x5185;&#x5B58;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x5BF9;&#x6240;&#x6709;&#x5171;&#x4EAB;&#x8FD9;&#x5757;&#x5185;&#x5B58;&#x7684;&#x8FDB;&#x7A0B;&#x53EF;&#x89C1;&#x3002;&#xFF08;&#x8FD9;&#x4E0E;&#x4E0A;&#x9762;&#x6570;&#x636E;&#x4F20;&#x8F93;&#x5DE5;&#x5177;&#x4E2D;&#x4ECB;&#x7ECD;&#x7684;&#x7834;&#x574F;&#x6027;&#x8BFB;&#x53D6;&#x8BED;&#x4E49;&#x4E0D;&#x540C;&#x3002;&#xFF09;</li>
</ul>
<h2 id="&#x540C;&#x6B65;&#x5DE5;&#x5177;"><a href="#&#x540C;&#x6B65;&#x5DE5;&#x5177;" class="headerlink" title="&#x540C;&#x6B65;&#x5DE5;&#x5177;"></a>&#x540C;&#x6B65;&#x5DE5;&#x5177;</h2><p>&#x901A;&#x8FC7;&#x540C;&#x6B65;&#x53EF;&#x4EE5;&#x9632;&#x6B62;&#x8FDB;&#x7A0B;&#x6267;&#x884C;&#x8BF8;&#x5982;&#x540C;&#x65F6;&#x66F4;&#x65B0;&#x4E00;&#x5757;&#x5171;&#x4EAB;&#x5185;&#x5B58;&#x6216;&#x540C;&#x65F6;&#x66F4;&#x65B0;&#x6587;&#x4EF6;&#x7684;&#x540C;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x5757;&#x4E4B;&#x7C7B;&#x7684;&#x64CD;&#x4F5C;&#x3002;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x540C;&#x6B65;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x79CD;&#x540C;&#x65F6;&#x66F4;&#x65B0;&#x7684;&#x64CD;&#x4F5C;&#x53EF;&#x80FD;&#x4F1A;&#x5BFC;&#x81F4;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4EA7;&#x751F;&#x9519;&#x8BEF;&#x7684;&#x7ED3;&#x679C;&#x3002;</p>
<p>UNIX&#x7CFB;&#x7EDF;&#x63D0;&#x4F9B;&#x4E86;&#x4E0B;&#x5217;&#x540C;&#x6B65;&#x5DE5;&#x5177;&#x3002;</p>
<ul>
<li>&#x4FE1;&#x53F7;&#x91CF;&#xFF1A;&#x4E00;&#x4E2A;&#x4FE1;&#x53F7;&#x91CF;&#x662F;&#x4E00;&#x4E2A;&#x7531;&#x5185;&#x6838;&#x7EF4;&#x62A4;&#x7684;&#x6574;&#x6570;&#xFF0C;&#x5176;&#x503C;&#x6C38;&#x8FDC;&#x4E0D;&#x4F1A;&#x5C0F;&#x4E8E;0&#x3002;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x589E;&#x52A0;&#x6216;&#x51CF;&#x5C0F;&#x4E00;&#x4E2A;&#x4FE1;&#x53F7;&#x91CF;&#x7684;&#x503C;&#x3002;&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x8BD5;&#x56FE;&#x5C06;&#x4FE1;&#x53F7;&#x91CF;&#x7684;&#x503C;&#x51CF;&#x5C0F;&#x5230;&#x5C0F;&#x4E8E;0&#xFF0C;&#x90A3;&#x4E48;&#x5185;&#x6838;&#x4F1A;&#x963B;&#x585E;&#x8BE5;&#x64CD;&#x4F5C;&#x76F4;&#x81F3;&#x4FE1;&#x53F7;&#x91CF;&#x7684;&#x503C;&#x589E;&#x957F;&#x5230;&#x5141;&#x8BB8;&#x6267;&#x884C;&#x8BE5;&#x64CD;&#x4F5C;&#x7684;&#x7A0B;&#x5EA6;&#x3002;&#xFF08;&#x6216;&#x8005;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x8981;&#x6C42;&#x6267;&#x884C;&#x4E00;&#x4E2A;&#x975E;&#x963B;&#x585E;&#x64CD;&#x4F5C;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x4E0D;&#x4F1A;&#x53D1;&#x751F;&#x963B;&#x585E;&#xFF0C;&#x5185;&#x6838;&#x4F1A;&#x8BA9;&#x8BE5;&#x64CD;&#x4F5C;&#x7ACB;&#x5373;&#x8FD4;&#x56DE;&#x5E76;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x6807;&#x793A;&#x65E0;&#x6CD5;&#x7ACB;&#x5373;&#x6267;&#x884C;&#x8BE5;&#x64CD;&#x4F5C;&#x7684;&#x9519;&#x8BEF;&#x3002;&#xFF09;&#x4FE1;&#x53F7;&#x91CF;&#x7684;&#x542B;&#x4E49;&#x662F;&#x7531;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x6765;&#x786E;&#x5B9A;&#x7684;&#x3002;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x51CF;&#x5C0F;&#x4E00;&#x4E2A;&#x4FE1;&#x53F7;&#x91CF;&#xFF08;&#x5982;&#x4ECE;1&#x5230;0&#xFF09;&#x662F;&#x4E3A;&#x4E86;&#x9884;&#x7EA6;&#x5BF9;&#x67D0;&#x4E9B;&#x5171;&#x4EAB;&#x8D44;&#x6E90;&#x7684;&#x72EC;&#x5360;&#x8BBF;&#x95EE;&#xFF0C;&#x5728;&#x5B8C;&#x6210;&#x4E86;&#x8D44;&#x6E90;&#x7684;&#x4F7F;&#x7528;&#x4E4B;&#x540E;&#x53EF;&#x4EE5;&#x589E;&#x52A0;&#x4FE1;&#x53F7;&#x91CF;&#x6765;&#x91CA;&#x653E;&#x5171;&#x4EAB;&#x8D44;&#x6E90;&#x4EE5;&#x4F9B;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x4F7F;&#x7528;&#x3002;&#x6700;&#x5E38;&#x7528;&#x7684;&#x4FE1;&#x53F7;&#x91CF;&#x662F;&#x4E8C;&#x5143;&#x4FE1;&#x53F7;&#x91CF;&#x2014;&#x2014;&#x4E00;&#x4E2A;&#x503C;&#x53EA;&#x80FD;&#x662F;0&#x6216;1&#x7684;&#x4FE1;&#x53F7;&#x91CF;&#xFF0C;&#x4F46;&#x5904;&#x7406;&#x4E00;&#x7C7B;&#x5171;&#x4EAB;&#x8D44;&#x6E90;&#x62E5;&#x6709;&#x591A;&#x4E2A;&#x5B9E;&#x4F8B;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x6700;&#x5927;&#x503C;&#x7B49;&#x4E8E;&#x5171;&#x4EAB;&#x8D44;&#x6E90;&#x6570;&#x91CF;&#x7684;&#x4FE1;&#x53F7;&#x91CF;&#x3002;Linux&#x65E2;&#x63D0;&#x4F9B;&#x4E86;System V&#x4FE1;&#x53F7;&#x91CF;&#xFF0C;&#x53C8;&#x63D0;&#x4F9B;&#x4E86;POSIX&#x4FE1;&#x53F7;&#x91CF;&#xFF0C;&#x5B83;&#x4EEC;&#x7684;&#x529F;&#x80FD;&#x662F;&#x7C7B;&#x4F3C;&#x7684;&#x3002;</li>
<li>&#x6587;&#x4EF6;&#x9501;&#xFF1A;&#x6587;&#x4EF6;&#x9501;&#x662F;&#x8BBE;&#x8BA1;&#x7528;&#x6765;&#x534F;&#x8C03;&#x64CD;&#x4F5C;&#x540C;&#x4E00;&#x6587;&#x4EF6;&#x7684;&#x591A;&#x4E2A;&#x8FDB;&#x7A0B;&#x7684;&#x52A8;&#x4F5C;&#x7684;&#x4E00;&#x79CD;&#x540C;&#x6B65;&#x65B9;&#x6CD5;&#x3002;&#x5B83;&#x4E5F;&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x534F;&#x8C03;&#x5BF9;&#x5176;&#x4ED6;&#x5171;&#x4EAB;&#x8D44;&#x6E90;&#x7684;&#x8BBF;&#x95EE;&#x3002;&#x6587;&#x4EF6;&#x9501;&#x5206;&#x4E3A;&#x4E24;&#x7C7B;&#xFF1A;&#x8BFB;&#xFF08;&#x5171;&#x4EAB;&#xFF09;&#x9501;&#x548C;&#x5199;&#xFF08;&#x4E92;&#x65A5;&#xFF09;&#x9501;&#x3002;&#x4EFB;&#x610F;&#x8FDB;&#x7A0B;&#x90FD;&#x53EF;&#x4EE5;&#x6301;&#x6709;&#x540C;&#x4E00;&#x6587;&#x4EF6;&#xFF08;&#x6216;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x7684;&#x67D0;&#x6BB5;&#x533A;&#x57DF;&#xFF09;&#x7684;&#x8BFB;&#x9501;&#xFF0C;&#x4F46;&#x5F53;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x6301;&#x6709;&#x4E86;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#xFF08;&#x6216;&#x6587;&#x4EF6;&#x533A;&#x57DF;&#xFF09;&#x7684;&#x5199;&#x9501;&#x4E4B;&#x540E;&#xFF0C;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x5C06;&#x65E0;&#x6CD5;&#x83B7;&#x53D6;&#x8BE5;&#x6587;&#x4EF6;&#xFF08;&#x6216;&#x6587;&#x4EF6;&#x533A;&#x57DF;&#xFF09;&#x4E0A;&#x7684;&#x8BFB;&#x9501;&#x548C;&#x5199;&#x9501;&#x3002;Linux&#x901A;&#x8FC7;flock()&#x548C;fcntl()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x6765;&#x63D0;&#x4F9B;&#x6587;&#x4EF6;&#x52A0;&#x9501;&#x5DE5;&#x5177;&#x3002;flock()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x79CD;&#x7B80;&#x5355;&#x7684;&#x52A0;&#x9501;&#x673A;&#x5236;&#xFF0C;&#x5141;&#x8BB8;&#x8FDB;&#x7A0B;&#x5C06;&#x4E00;&#x4E2A;&#x5171;&#x4EAB;&#x6216;&#x4E92;&#x65A5;&#x9501;&#x52A0;&#x5230;&#x6574;&#x4E2A;&#x6587;&#x4EF6;&#x4E0A;&#x3002;&#x7531;&#x4E8E;&#x529F;&#x80FD;&#x6709;&#x9650;&#xFF0C;&#x73B0;&#x5728;&#x5DF2;&#x7ECF;&#x5F88;&#x5C11;&#x4F7F;&#x7528;flock()&#x8FD9;&#x4E2A;&#x52A0;&#x9501;&#x5DE5;&#x5177;&#x4E86;&#x3002;fcntl()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x63D0;&#x4F9B;&#x4E86;&#x8BB0;&#x5F55;&#x52A0;&#x9501;&#xFF0C;&#x5141;&#x8BB8;&#x8FDB;&#x7A0B;&#x5728;&#x540C;&#x4E00;&#x6587;&#x4EF6;&#x7684;&#x4E0D;&#x540C;&#x533A;&#x57DF;&#x4E0A;&#x52A0;&#x4E0A;&#x591A;&#x4E2A;&#x8BFB;&#x9501;&#x548C;&#x5199;&#x9501;&#x3002;</li>
<li>&#x4E92;&#x65A5;&#x4F53;&#x548C;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#xFF1A;&#x8FD9;&#x4E9B;&#x540C;&#x6B65;&#x5DE5;&#x5177;&#x901A;&#x5E38;&#x7528;&#x4E8E;POSIX&#x7EBF;&#x7A0B;&#x3002;</li>
</ul>
<p>&#x4E00;&#x4E9B;UNIX&#x5B9E;&#x73B0;&#xFF0C;&#x5305;&#x62EC;&#x5B89;&#x88C5;&#x4E86;&#x80FD;&#x63D0;&#x4F9B;NPTL&#x7EBF;&#x7A0B;&#x5B9E;&#x73B0;&#x7684;glibc&#x7684;Linux&#x7CFB;&#x7EDF;&#xFF0C;&#x5141;&#x8BB8;&#x5728;&#x8FDB;&#x7A0B;&#x95F4;&#x5171;&#x4EAB;&#x4E92;&#x65A5;&#x4F53;&#x548C;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#x3002;SUSv3&#x5141;&#x8BB8;&#x4F46;&#x5E76;&#x4E0D;&#x8981;&#x6C42;&#x5B9E;&#x73B0;&#x652F;&#x6301;&#x8FDB;&#x7A0B;&#x95F4;&#x5171;&#x4EAB;&#x7684;&#x4E92;&#x65A5;&#x4F53;&#x548C;&#x6761;&#x4EF6;&#x53D8;&#x91CF;&#x3002;&#x6240;&#x6709;UNIX&#x7CFB;&#x7EDF;&#x90FD;&#x6CA1;&#x6709;&#x63D0;&#x4F9B;&#x8FD9;&#x4E2A;&#x529F;&#x80FD;&#xFF0C;&#x56E0;&#x6B64;&#x5F88;&#x5C11;&#x4F7F;&#x7528;&#x5B83;&#x4EEC;&#x6765;&#x8FDB;&#x884C;&#x8FDB;&#x7A0B;&#x540C;&#x6B65;&#x3002;</p>
<p>&#x5728;&#x6267;&#x884C;&#x8FDB;&#x7A0B;&#x95F4;&#x540C;&#x6B65;&#x65F6;&#x901A;&#x5E38;&#x9700;&#x8981;&#x6839;&#x636E;&#x529F;&#x80FD;&#x9700;&#x6C42;&#x6765;&#x9009;&#x62E9;&#x5DE5;&#x5177;&#x3002;&#x5F53;&#x534F;&#x8C03;&#x5BF9;&#x6587;&#x4EF6;&#x7684;&#x8BBF;&#x95EE;&#x65F6;&#x6587;&#x4EF6;&#x8BB0;&#x5F55;&#x52A0;&#x9501;&#x901A;&#x5E38;&#x662F;&#x6700;&#x4F73;&#x7684;&#x9009;&#x62E9;&#xFF0C;&#x800C;&#x5BF9;&#x4E8E;&#x534F;&#x8C03;&#x5BF9;&#x5176;&#x4ED6;&#x5171;&#x4EAB;&#x8D44;&#x6E90;&#x7684;&#x8BBF;&#x95EE;&#x6765;&#x8BB2;&#xFF0C;&#x4FE1;&#x53F7;&#x91CF;&#x901A;&#x5E38;&#x662F;&#x66F4;&#x4F73;&#x7684;&#x9009;&#x62E9;&#x3002;</p>
<p>&#x901A;&#x4FE1;&#x5DE5;&#x5177;&#x4E5F;&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x8FDB;&#x884C;&#x540C;&#x6B65;&#x3002;&#x5982;&#x5728;44.3&#x8282;&#x4E2D;&#x4F7F;&#x7528;&#x4E86;&#x4E00;&#x4E2A;&#x7BA1;&#x9053;&#x6765;&#x540C;&#x6B65;&#x7236;&#x8FDB;&#x7A0B;&#x4E0E;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x52A8;&#x4F5C;&#x3002;&#x4E00;&#x822C;&#x6765;&#x8BB2;&#xFF0C;&#x6240;&#x6709;&#x6570;&#x636E;&#x4F20;&#x8F93;&#x5DE5;&#x5177;&#x90FD;&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x540C;&#x6B65;&#xFF0C;&#x53EA;&#x662F;&#x540C;&#x6B65;&#x64CD;&#x4F5C;&#x662F;&#x901A;&#x8FC7;&#x5728;&#x5DE5;&#x5177;&#x4E2D;&#x4EA4;&#x6362;&#x6D88;&#x606F;&#x6765;&#x5B8C;&#x6210;&#x7684;&#x3002;</p>
<p>&#x81EA;&#x5185;&#x6838;2.6.22&#x8D77;&#xFF0C;Linux&#x901A;&#x8FC7;eventfd()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x989D;&#x5916;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x79CD;&#x975E;&#x6807;&#x51C6;&#x7684;&#x540C;&#x6B65;&#x673A;&#x5236;&#x3002;&#x8FD9;&#x4E2A;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x521B;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A;eventfd&#x5BF9;&#x8C61;&#xFF0C;&#x8BE5;&#x5BF9;&#x8C61;&#x62E5;&#x6709;&#x4E00;&#x4E2A;&#x76F8;&#x5173;&#x7684;&#x7531;&#x5185;&#x6838;&#x7EF4;&#x62A4;&#x7684;8&#x5B57;&#x8282;&#x65E0;&#x7B26;&#x53F7;&#x6574;&#x6570;&#xFF0C;&#x5B83;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x6307;&#x5411;&#x8BE5;&#x5BF9;&#x8C61;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x3002;&#x5411;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x4E2D;&#x5199;&#x5165;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#x5C06;&#x4F1A;&#x628A;&#x8BE5;&#x6574;&#x6570;&#x52A0;&#x5230;&#x5BF9;&#x8C61;&#x503C;&#x4E0A;&#x3002;&#x5F53;&#x5BF9;&#x8C61;&#x503C;&#x4E3A;0&#x65F6;&#x5BF9;&#x8BE5;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x7684;read()&#x64CD;&#x4F5C;&#x5C06;&#x4F1A;&#x88AB;&#x963B;&#x585E;&#x3002;&#x5982;&#x679C;&#x5BF9;&#x8C61;&#x7684;&#x503C;&#x975E;&#x96F6;&#xFF0C;&#x90A3;&#x4E48;read()&#x4F1A;&#x8FD4;&#x56DE;&#x8BE5;&#x503C;&#x5E76;&#x5C06;&#x5BF9;&#x8C61;&#x503C;&#x91CD;&#x7F6E;&#x4E3A;0&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;poll()&#x3001;select()&#x4EE5;&#x53CA;epoll&#x6765;&#x6D4B;&#x8BD5;&#x5BF9;&#x8C61;&#x503C;&#x662F;&#x5426;&#x4E3A;&#x975E;&#x96F6;&#xFF0C;&#x5982;&#x679C;&#x662F;&#x975E;&#x96F6;&#x7684;&#x8BDD;&#x5C31;&#x8868;&#x793A;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x53EF;&#x8BFB;&#x3002;&#x4F7F;&#x7528;eventfd&#x5BF9;&#x8C61;&#x8FDB;&#x884C;&#x540C;&#x6B65;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5FC5;&#x987B;&#x8981;&#x9996;&#x5148;&#x4F7F;&#x7528;eventfd()&#x521B;&#x5EFA;&#x8BE5;&#x5BF9;&#x8C61;&#xFF0C;&#x7136;&#x540E;&#x8C03;&#x7528;fork()&#x521B;&#x5EFA;&#x7EE7;&#x627F;&#x6307;&#x5411;&#x8BE5;&#x5BF9;&#x8C61;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x7684;&#x76F8;&#x5173;&#x8FDB;&#x7A0B;&#x3002;&#x66F4;&#x591A;&#x7EC6;&#x8282;&#x4FE1;&#x606F;&#x53EF;&#x53C2;&#x8003;eventfd(2)&#x624B;&#x518C;&#x3002;</p>
<h3 id="IPC&#x5DE5;&#x5177;&#x6BD4;&#x8F83;"><a href="#IPC&#x5DE5;&#x5177;&#x6BD4;&#x8F83;" class="headerlink" title="IPC&#x5DE5;&#x5177;&#x6BD4;&#x8F83;"></a>IPC&#x5DE5;&#x5177;&#x6BD4;&#x8F83;</h3><p>&#x5728;&#x9700;&#x8981;&#x4F7F;&#x7528;IPC&#x65F6;&#x4F1A;&#x53D1;&#x73B0;&#x6709;&#x5F88;&#x591A;&#x9009;&#x62E9;&#xFF0C;&#x8BFB;&#x8005;&#x5728;&#x4E00;&#x5F00;&#x59CB;&#x53EF;&#x80FD;&#x4F1A;&#x5BF9;&#x8FD9;&#x4E9B;&#x9009;&#x62E9;&#x611F;&#x5230;&#x8FF7;&#x60D1;&#x3002;&#x5728;&#x540E;&#x9762;&#x4ECB;&#x7ECD;&#x5404;&#x4E2A;IPC&#x5DE5;&#x5177;&#x7684;&#x7AE0;&#x8282;&#x4E2D;&#x5C06;&#x4F1A;&#x628A;&#x6BCF;&#x4E2A;&#x5DE5;&#x5177;&#x4E0E;&#x5176;&#x4ED6;&#x7C7B;&#x4F3C;&#x7684;&#x5DE5;&#x5177;&#x8FDB;&#x884C;&#x6BD4;&#x8F83;&#x3002;&#x4E0B;&#x9762;&#x4ECB;&#x7ECD;&#x5728;&#x786E;&#x5B9A;&#x9009;&#x62E9;&#x4F55;&#x79CD;IPC&#x5DE5;&#x5177;&#x65F6;&#x901A;&#x5E38;&#x9700;&#x8981;&#x8003;&#x8651;&#x7684;&#x4E8B;&#x9879;&#x3002;</p>
<p>IPC&#x5BF9;&#x8C61;&#x6807;&#x8BC6;&#x548C;&#x6253;&#x5F00;&#x5BF9;&#x8C61;&#x7684;&#x53E5;&#x67C4;<br>&#x8981;&#x8BBF;&#x95EE;&#x4E00;&#x4E2A;IPC&#x5BF9;&#x8C61;&#xFF0C;&#x8FDB;&#x7A0B;&#x5FC5;&#x987B;&#x8981;&#x901A;&#x8FC7;&#x67D0;&#x79CD;&#x65B9;&#x5F0F;&#x6765;&#x6807;&#x8BC6;&#x51FA;&#x8BE5;&#x5BF9;&#x8C61;&#xFF0C;&#x4E00;&#x65E6;&#x5C06;&#x5BF9;&#x8C61;&#x201C;&#x6253;&#x5F00;&#x201D;&#x4E4B;&#x540E;&#xFF0C;&#x8FDB;&#x7A0B;&#x5FC5;&#x987B;&#x8981;&#x4F7F;&#x7528;&#x67D0;&#x79CD;&#x53E5;&#x67C4;&#x6765;&#x5F15;&#x7528;&#x8BE5;&#x6253;&#x5F00;&#x7740;&#x7684;&#x5BF9;&#x8C61;&#x3002;&#x8868;43-1&#x5BF9;&#x5404;&#x79CD;&#x7C7B;&#x578B;&#x7684;IPC&#x5DE5;&#x5177;&#x7684;&#x5C5E;&#x6027;&#x8FDB;&#x884C;&#x4E86;&#x603B;&#x7ED3;&#x3002;</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th align="left">&#x5DE5; &#x5177; &#x7C7B; &#x578B;</th>
<th align="left">&#x7528;&#x4E8E;&#x8BC6;&#x522B;&#x5BF9;&#x8C61;&#x7684;&#x540D;&#x79F0;</th>
<th align="left">&#x7528;&#x4E8E;&#x5728;&#x7A0B;&#x5E8F;&#x4E2D;&#x5F15;&#x7528;&#x5BF9;&#x8C61;&#x7684;&#x53E5;&#x67C4;</th>
</tr>
</thead>
<tbody><tr>
<td align="left">&#x7BA1;&#x9053;<br>FIFO</td>
<td align="left">&#x6CA1;&#x6709;&#x540D;&#x79F0;<br>&#x8DEF;&#x5F84;&#x540D;<br></td>
<td align="left">&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;<br>&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;</td>
</tr>
<tr>
<td align="left">UNIX domain socket<br>Internet domain socket<br></td>
<td align="left">&#x8DEF;&#x5F84;&#x540D;<br>IP&#x5730;&#x5740;+&#x7AEF;&#x53E3;&#x53F7;</td>
<td align="left">&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;<br>&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;</td>
</tr>
<tr>
<td align="left">System V&#x6D88;&#x606F;&#x961F;&#x5217;<br>System V&#x4FE1;&#x53F7;&#x91CF;<br>System V&#x5171;&#x4EAB;&#x5185;&#x5B58;</td>
<td align="left">System V IPC&#x952E;<br>System V IPC&#x952E;<br>System V IPC&#x952E;</td>
<td align="left">System V IPC&#x6807;&#x8BC6;&#x7B26;<br>System V IPC&#x6807;&#x8BC6;&#x7B26;<br>System V IPC&#x6807;&#x8BC6;&#x7B26;</td>
</tr>
<tr>
<td align="left">POSIX&#x6D88;&#x606F;&#x961F;&#x5217;<br>POSIX&#x547D;&#x540D;&#x4FE1;&#x53F7;&#x91CF;<br>POSIX&#x65E0;&#x540D;&#x4FE1;&#x53F7;&#x91CF;<br>POSIX&#x5171;&#x4EAB;&#x5185;&#x5B58;</td>
<td align="left">POSIX IPC&#x8DEF;&#x5F84;&#x540D;<br>POSIX IPC&#x8DEF;&#x5F84;&#x540D;<br>&#x6CA1;&#x6709;&#x540D;&#x79F0;<br>POSIX IPC&#x8DEF;&#x5F84;&#x540D;</td>
<td align="left">mqd_t (&#x6D88;&#x606F;&#x961F;&#x5217;&#x63CF;&#x8FF0;&#x7B26;)<br>sem_t * (&#x4FE1;&#x53F7;&#x91CF;&#x6307;&#x9488;)<br>sem_t * (&#x4FE1;&#x53F7;&#x91CF;&#x6307;&#x9488;)<br>&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;</td>
</tr>
<tr>
<td align="left">&#x533F;&#x540D;&#x6620;&#x5C04;<br>&#x5185;&#x5B58;&#x6620;&#x5C04;&#x6587;&#x4EF6;</td>
<td align="left">&#x6CA1;&#x6709;&#x540D;&#x79F0;<br>&#x8DEF;&#x5F84;&#x540D;</td>
<td align="left">&#x65E0;<br>&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;</td>
</tr>
<tr>
<td align="left">flock()&#x6587;&#x4EF6;&#x9501;<br>fcntl()&#x6587;&#x4EF6;&#x9501;</td>
<td align="left">&#x8DEF;&#x5F84;&#x540D;<br>&#x8DEF;&#x5F84;&#x540D;</td>
<td align="left">&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;<br>&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;<br></td>
</tr>
</tbody></table></div>
<h3 id="&#x529F;&#x80FD;"><a href="#&#x529F;&#x80FD;" class="headerlink" title="&#x529F;&#x80FD;"></a>&#x529F;&#x80FD;</h3><p>&#x5404;&#x79CD;IPC&#x5DE5;&#x5177;&#x5728;&#x529F;&#x80FD;&#x4E0A;&#x662F;&#x5B58;&#x5728;&#x5DEE;&#x5F02;&#x7684;&#xFF0C;&#x56E0;&#x6B64;&#x5728;&#x786E;&#x5B9A;&#x4F7F;&#x7528;&#x4F55;&#x79CD;&#x5DE5;&#x5177;&#x65F6;&#x9700;&#x8981;&#x8003;&#x8651;&#x8FD9;&#x4E9B;&#x5DEE;&#x5F02;&#x3002;&#x4E0B;&#x9762;&#x9996;&#x5148;&#x5BF9;&#x6570;&#x636E;&#x4F20;&#x8F93;&#x5DE5;&#x5177;&#x76D2;&#x5171;&#x4EAB;&#x5185;&#x5B58;&#x4E4B;&#x95F4;&#x7684;&#x5DEE;&#x5F02;&#x8FDB;&#x884C;&#x603B;&#x7ED3;&#x3002;</p>
<ul>
<li>&#x6570;&#x636E;&#x4F20;&#x8F93;&#x5DE5;&#x5177;&#x63D0;&#x4F9B;&#x4E86;&#x8BFB;&#x53D6;&#x548C;&#x5199;&#x5165;&#x64CD;&#x4F5C;&#xFF0C;&#x4F20;&#x8F93;&#x7684;&#x6570;&#x636E;&#x53EA;&#x4F9B;&#x4E00;&#x4E2A;&#x8BFB;&#x8005;&#x8FDB;&#x7A0B;&#x6D88;&#x8017;&#x3002;&#x5185;&#x6838;&#x4F1A;&#x81EA;&#x52A8;&#x5904;&#x7406;&#x8BFB;&#x8005;&#x548C;&#x5199;&#x8005;&#x4E4B;&#x95F4;&#x7684;&#x6D41;&#x63A7;&#x4EE5;&#x53CA;&#x540C;&#x6B65;&#xFF08;&#x8FD9;&#x6837;&#x5F53;&#x8BFB;&#x8005;&#x8BD5;&#x56FE;&#x4ECE;&#x5F53;&#x524D;&#x4E3A;&#x7A7A;&#x7684;&#x5DE5;&#x5177;&#x4E2D;&#x8BFB;&#x53D6;&#x6570;&#x636E;&#x65F6;&#x5C06;&#x4F1A;&#x963B;&#x585E;&#xFF09;&#x3002;&#x5728;&#x5F88;&#x591A;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x8BBE;&#x8BA1;&#x4E2D;&#xFF0C;&#x8FD9;&#x4E2A;&#x6A21;&#x578B;&#x90FD;&#x8868;&#x73B0;&#x5F97;&#x5F88;&#x597D;&#x3002;</li>
<li>&#x5176;&#x4ED6;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x8BBE;&#x8BA1;&#x5219;&#x66F4;&#x9002;&#x5408;&#x91C7;&#x7528;&#x5171;&#x4EAB;&#x5185;&#x5B58;&#x7684;&#x65B9;&#x5F0F;&#x3002;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x901A;&#x8FC7;&#x5171;&#x4EAB;&#x5185;&#x5B58;&#x80FD;&#x591F;&#x4F7F;&#x6570;&#x636E;&#x5BF9;&#x5171;&#x4EAB;&#x540C;&#x4E00;&#x5185;&#x5B58;&#x533A;&#x57DF;&#x7684;&#x6240;&#x6709;&#x8FDB;&#x7A0B;&#x53EF;&#x89C1;&#x3002;&#x901A;&#x4FE1;&#x201C;&#x64CD;&#x4F5C;&#x201D;&#x662F;&#x6BD4;</li>
<li>&#x8F83;&#x7B80;&#x5355;&#x7684;&#x2014;&#x2014;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x50CF;&#x8BBF;&#x95EE;&#x81EA;&#x5DF1;&#x7684;&#x865A;&#x62DF;&#x5730;&#x5740;&#x7A7A;&#x95F4;&#x4E2D;&#x7684;&#x5185;&#x5B58;&#x90A3;&#x6837;&#x8BBF;&#x95EE;&#x5171;&#x4EAB;&#x5185;&#x5B58;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x3002;&#x53E6;&#x4E00;&#x4E2A;&#x65B9;&#x9762;&#xFF0C;&#x540C;&#x6B65;&#x5904;&#x7406;&#xFF08;&#x53EF;&#x80FD;&#x8FD8;&#x4F1A;&#x6709;&#x6D41;&#x63A7;&#xFF09;&#x4F1A;&#x589E;&#x52A0;&#x5171;&#x4EAB;&#x5185;&#x5B58;&#x8BBE;&#x8BA1;&#x7684;&#x590D;&#x6742;&#x6027;&#x3002;&#x5728;&#x9700;&#x8981;&#x7EF4;&#x62A4;&#x5171;&#x4EAB;&#x72B6;&#x6001;&#xFF08;&#x5982;&#x5171;&#x4EAB;&#x6570;&#x636E;&#x7ED3;&#x6784;&#xFF09;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E2D;&#xFF0C;&#x8FD9;&#x4E2A;&#x6A21;&#x578B;&#x8868;&#x73B0;&#x5F97;&#x5F88;&#x597D;&#x3002;</li>
</ul>
<p><strong>&#x5173;&#x4E8E;&#x5404;&#x79CD;&#x6570;&#x636E;&#x4F20;&#x8F93;&#x5DE5;&#x5177;&#xFF0C;&#x4E0B;&#x9762;&#x51E0;&#x70B9;&#x662F;&#x503C;&#x5F97;&#x6CE8;&#x610F;&#x7684;&#x3002;</strong></p>
<ul>
<li>&#x4E00;&#x4E9B;&#x6570;&#x636E;&#x4F20;&#x8F93;&#x5DE5;&#x5177;&#x4EE5;&#x5B57;&#x8282;&#x6D41;&#x7684;&#x5F62;&#x5F0F;&#x4F20;&#x8F93;&#x6570;&#x636E;&#xFF08;&#x7BA1;&#x9053;&#x3001;FIFO&#x4EE5;&#x53CA;&#x6D41;socket&#xFF09;&#xFF0C;&#x53E6;&#x4E00;&#x4E9B;&#x5219;&#x662F;&#x9762;&#x5411;&#x6D88;&#x606F;&#x7684;&#xFF08;&#x6D88;&#x606F;&#x961F;&#x5217;&#x548C;&#x6570;&#x636E;&#x62A5;socket&#xFF09;&#x3002;&#x5230;&#x5E95;&#x9009;&#x62E9;&#x4F55;&#x79CD;&#x65B9;&#x6CD5;&#x5219;&#x9700;&#x8981;&#x4F9D;&#x8D56;&#x4E8E;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x3002;&#xFF08;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E5F;&#x53EF;&#x4EE5;&#x5728;&#x4E00;&#x4E2A;&#x5B57;&#x8282;&#x6D41;&#x5DE5;&#x5177;&#x4E0A;&#x5E94;&#x7528;&#x9762;&#x5411;&#x6D88;&#x606F;&#x7684;&#x6A21;&#x578B;&#xFF0C;&#x8FD9;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4F7F;&#x7528;&#x5206;&#x9694;&#x5B57;&#x7B26;&#x3001;&#x56FA;&#x5B9A;&#x957F;&#x5EA6;&#x7684;&#x6D88;&#x606F;&#xFF0C;&#x6216;&#x5BF9;&#x6574;&#x6761;&#x6D88;&#x606F;&#x957F;&#x5EA6;&#x8FDB;&#x884C;&#x7F16;&#x7801;&#x7684;&#x6D88;&#x606F;&#x5934;&#x6765;&#x5B9E;&#x73B0;&#xFF0C;&#x5177;&#x4F53;&#x53EF;&#x53C2;&#x8003;44.8&#x8282;&#xFF09;&#x3002;</li>
<li>&#x4E0E;&#x5176;&#x4ED6;&#x6570;&#x636E;&#x4F20;&#x8F93;&#x5DE5;&#x5177;&#x76F8;&#x6BD4;&#xFF0C;System V&#x548C;POSIX&#x6D88;&#x606F;&#x961F;&#x5217;&#x7279;&#x6709;&#x7684;&#x4E00;&#x4E2A;&#x7279;&#x6027;&#x662F;&#x5B83;&#x4EEC;&#x80FD;&#x591F;&#x7ED9;&#x6D88;&#x606F;&#x8D4B;&#x4E00;&#x4E2A;&#x6570;&#x503C;&#x7C7B;&#x578B;&#x6216;&#x4F18;&#x5148;&#x7EA7;&#xFF0C;&#x8FD9;&#x6837;&#x9012;&#x9001;&#x6D88;&#x606F;&#x7684;&#x987A;&#x5E8F;&#x5C31;&#x53EF;&#x4EE5;&#x4E0E;&#x53D1;&#x9001;&#x6D88;&#x606F;&#x7684;&#x987A;&#x5E8F;&#x4E0D;&#x540C;&#x4E86;&#x3002;</li>
<li>&#x7BA1;&#x9053;&#x3001;FIFO&#x4EE5;&#x53CA;socket&#x662F;&#x4F7F;&#x7528;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x6765;&#x5B9E;&#x73B0;&#x7684;&#x3002;&#x8FD9;&#x4E9B;IPC&#x5DE5;&#x5177;&#x90FD;&#x652F;&#x6301;&#x7B2C;63&#x7AE0;&#x4E2D;&#x4ECB;&#x7ECD;&#x7684;&#x4E00;&#x7EC4;I/O&#x6A21;&#x578B;&#xFF1A;I/O&#x591A;&#x8DEF;&#x590D;&#x7528;&#xFF08;select()&#x548C;poll()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF09;&#x3001;&#x4FE1;&#x53F7;&#x9A71;&#x52A8;&#x7684;I/O&#x3001;&#x4EE5;&#x53CA;Linux&#x7279;&#x6709;&#x7684;epoll API&#x3002;&#x8FD9;&#x4E9B;&#x6280;&#x672F;&#x7684;&#x4E3B;&#x8981;&#x4F18;&#x52BF;&#x5728;&#x4E8E;&#x5B83;&#x4EEC;&#x5141;&#x8BB8;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x540C;&#x65F6;&#x76D1;&#x63A7;&#x591A;&#x4E2A;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x4EE5;&#x5224;&#x65AD;&#x662F;&#x5426;&#x53EF;&#x4EE5;&#x5728;&#x67D0;&#x4E9B;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x4E0A;&#x6267;&#x884C;I/O&#x64CD;&#x4F5C;&#x3002;&#x4E0E;&#x4E4B;&#x76F8;&#x6BD4;&#xFF0C;System V&#x6D88;&#x606F;&#x961F;&#x5217;&#x6CA1;&#x6709;&#x4F7F;&#x7528;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#xFF0C;&#x56E0;&#x6B64;&#x5E76;&#x4E0D;&#x652F;&#x6301;&#x8FD9;&#x4E9B;&#x6280;&#x672F;&#x3002;<br>&#x5728;Linux&#x4E0A;&#xFF0C;POSIX&#x6D88;&#x606F;&#x961F;&#x5217;&#x4E5F;&#x662F;&#x4F7F;&#x7528;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x6765;&#x5B9E;&#x73B0;&#x7684;&#xFF0C;&#x56E0;&#x6B64;&#x4E5F;&#x652F;&#x6301;&#x4E0A;&#x9762;&#x4ECB;&#x7ECD;&#x7684;&#x5404;&#x79CD;I/O&#x6280;&#x672F;&#x3002;&#x4F46;SUSv3&#x5E76;&#x6CA1;&#x6709;&#x89C4;&#x5B9A;&#x8FD9;&#x79CD;&#x884C;&#x4E3A;&#xFF0C;&#x56E0;&#x6B64;&#x5728;&#x5927;&#x591A;&#x6570;&#x5B9E;&#x73B0;&#x4E0A;&#x5E76;&#x4E0D;&#x652F;&#x6301;&#x8FD9;&#x4E9B;&#x6280;&#x672F;&#x3002;</li>
<li>POSIX&#x6D88;&#x606F;&#x961F;&#x5217;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x901A;&#x77E5;&#x5DE5;&#x5177;&#xFF0C;&#x5F53;&#x4E00;&#x6761;&#x6D88;&#x606F;&#x8FDB;&#x5165;&#x4E86;&#x4E00;&#x4E2A;&#x4E4B;&#x524D;&#x4E3A;&#x7A7A;&#x7684;&#x961F;&#x5217;&#x4E2D;&#x65F6;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5B83;&#x6765;&#x5411;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;&#x4FE1;&#x53F7;&#x6216;&#x5B9E;&#x4F8B;&#x5316;&#x4E00;&#x4E2A;&#x65B0;&#x7EBF;&#x7A0B;&#x3002;</li>
<li>UNIX domain socket&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x7279;&#x6027;&#x5141;&#x8BB8;&#x5728;&#x8FDB;&#x7A0B;&#x95F4;&#x4F20;&#x9012;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x3002;&#x8FD9;&#x6837;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x5C31;&#x80FD;&#x591F;&#x6253;&#x5F00;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x5E76;&#x4F7F;&#x4E4B;&#x5BF9;&#x53E6;&#x4E00;&#x4E2A;&#x672C;&#x6765;&#x65E0;&#x6CD5;&#x8BBF;&#x95EE;&#x8BE5;&#x6587;&#x4EF6;&#x7684;&#x8FDB;&#x7A0B;&#x53EF;&#x7528;&#xFF0C;&#x5728;61.13.3&#x8282;&#x4E2D;&#x5C06;&#x4F1A;&#x5BF9;&#x6B64;&#x7279;&#x6027;&#x8FDB;&#x884C;&#x7B80;&#x8981;&#x4ECB;&#x7ECD;&#x3002;</li>
<li>UDP&#xFF08;Internet domain datagram&#xFF09;socket&#x5141;&#x8BB8;&#x4E00;&#x4E2A;&#x53D1;&#x9001;&#x8005;&#x5411;&#x591A;&#x4E2A;&#x63A5;&#x6536;&#x8005;&#x5E7F;&#x64AD;&#x6216;&#x7EC4;&#x64AD;&#x4E00;&#x6761;&#x6D88;&#x606F;&#x3002;</li>
</ul>
<p><strong>&#x5173;&#x4E8E;&#x8FDB;&#x7A0B;&#x540C;&#x6B65;&#x5DE5;&#x5177;&#xFF0C;&#x4E0B;&#x9762;&#x51E0;&#x70B9;&#x662F;&#x503C;&#x5F97;&#x6CE8;&#x610F;&#x7684;&#x3002;</strong></p>
<ul>
<li>&#x4F7F;&#x7528;fcntl()&#x52A0;&#x4E0A;&#x7684;&#x8BB0;&#x5F55;&#x9501;&#x7531;&#x52A0;&#x9501;&#x7684;&#x8FDB;&#x7A0B;&#x62E5;&#x6709;&#x3002;&#x5185;&#x6838;&#x4F7F;&#x7528;&#x8FD9;&#x79CD;&#x6240;&#x6709;&#x6743;&#x5C5E;&#x6027;&#x6765;&#x68C0;&#x6D4B;&#x6B7B;&#x9501;&#xFF08;&#x4E24;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x8FDB;&#x7A0B;&#x6301;&#x6709;&#x7684;&#x9501;&#x4F1A;&#x963B;&#x585E;&#x5BF9;&#x65B9;&#x540E;&#x7EED;&#x7684;&#x52A0;&#x9501;&#x8BF7;&#x6C42;&#x7684;&#x573A;&#x666F;&#xFF09;&#x3002;&#x5982;&#x679C;&#x53D1;&#x751F;&#x4E86;&#x6B7B;&#x9501;&#xFF0C;&#x90A3;&#x4E48;&#x5185;&#x6838;&#x4F1A;&#x62D2;&#x7EDD;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7684;&#x52A0;&#x9501;&#x8BF7;&#x6C42;&#xFF0C;&#x56E0;&#x6B64;&#x4F1A;&#x5728;fcntl()&#x8C03;&#x7528;&#x4E2D;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#x6807;&#x793A;&#x51FA;&#x6B7B;&#x9501;&#x7684;&#x53D1;&#x751F;&#x3002;System V&#x548C;POSIX&#x4FE1;&#x53F7;&#x91CF;&#x5E76;&#x6CA1;&#x6709;&#x6240;&#x6709;&#x6743;&#x5C5E;&#x6027;&#xFF0C;&#x56E0;&#x6B64;&#x5185;&#x6838;&#x4E0D;&#x4F1A;&#x4E3A;&#x4FE1;&#x53F7;&#x91CF;&#x8FDB;&#x884C;&#x6B7B;&#x9501;&#x68C0;&#x6D4B;&#x3002;</li>
<li>&#x5F53;&#x4F7F;&#x7528;fcntl()&#x83B7;&#x5F97;&#x8BB0;&#x5F55;&#x9501;&#x7684;&#x8FDB;&#x7A0B;&#x7EC8;&#x6B62;&#x4E4B;&#x540E;&#x4F1A;&#x81EA;&#x52A8;&#x91CA;&#x653E;&#x8BE5;&#x8BB0;&#x5F55;&#x9501;&#x3002;System V&#x4FE1;&#x53F7;&#x91CF;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x7C7B;&#x4F3C;&#x7684;&#x7279;&#x6027;&#xFF0C;&#x5373;&#x201C;&#x64A4;&#x9500;&#x201D;&#x7279;&#x6027;&#xFF0C;&#x4F46;&#x8FD9;&#x4E2A;&#x7279;&#x6027;&#x4EC5;&#x5728;&#x90E8;&#x5206;&#x573A;&#x666F;&#x4E2D;&#x53EF;&#x9760;&#xFF08;&#x53C2;&#x89C1;47.8&#x8282;&#xFF09;&#x3002;POSIX&#x4FE1;&#x53F7;&#x91CF;&#x5E76;&#x6CA1;&#x6709;&#x63D0;&#x4F9B;&#x7C7B;&#x4F3C;&#x7684;&#x7279;&#x6027;&#x3002;</li>
</ul>
<h3 id="&#x7F51;&#x7EDC;&#x901A;&#x4FE1;"><a href="#&#x7F51;&#x7EDC;&#x901A;&#x4FE1;" class="headerlink" title="&#x7F51;&#x7EDC;&#x901A;&#x4FE1;"></a>&#x7F51;&#x7EDC;&#x901A;&#x4FE1;</h3><p>&#x5728;&#x56FE;43-1&#x4E2D;&#x7ED9;&#x51FA;&#x6240;&#x6709;IPC&#x65B9;&#x6CD5;&#x4E2D;&#xFF0C;&#x53EA;&#x6709;socket&#x5141;&#x8BB8;&#x8FDB;&#x7A0B;&#x901A;&#x8FC7;&#x7F51;&#x7EDC;&#x6765;&#x901A;&#x4FE1;&#x3002;socket&#x4E00;&#x822C;&#x7528;&#x4E8E;&#x4E24;&#x4E2A;&#x57DF;&#x4E2D;&#xFF1A;&#x4E00;&#x4E2A;&#x662F;UNIX domain&#xFF0C;&#x5B83;&#x5141;&#x8BB8;&#x4F4D;&#x4E8E;&#x540C;&#x4E00;&#x7CFB;&#x7EDF;&#x4E0A;&#x7684;&#x8FDB;&#x7A0B;&#x8FDB;&#x884C;&#x901A;&#x4FE1;&#xFF1B;&#x53E6;&#x4E00;&#x4E2A;&#x662F;Internet domain&#xFF0C;&#x5B83;&#x5141;&#x8BB8;&#x4F4D;&#x4E8E;&#x901A;&#x8FC7;TCP/IP&#x7F51;&#x7EDC;&#x8FDB;&#x884C;&#x8FDE;&#x63A5;&#x7684;&#x4E0D;&#x540C;&#x4E3B;&#x673A;&#x4E0A;&#x7684;&#x8FDB;&#x7A0B;&#x8FDB;&#x884C;&#x901A;&#x4FE1;&#x3002;&#x901A;&#x5E38;&#xFF0C;&#x5C06;&#x4E00;&#x4E2A;&#x4F7F;&#x7528;UNIX domain socket&#x8FDB;&#x884C;&#x901A;&#x4FE1;&#x7684;&#x7A0B;&#x5E8F;&#x8F6C;&#x6362;&#x6210;&#x4E00;&#x4E2A;&#x4F7F;&#x7528;Internet domain socket&#x8FDB;&#x884C;&#x901A;&#x4FE1;&#x7684;&#x7A0B;&#x5E8F;&#x53EA;&#x9700;&#x8981;&#x505A;&#x51FA;&#x5FAE;&#x5C0F;&#x7684;&#x6539;&#x52A8;&#xFF0C;&#x8FD9;&#x6837;&#x53EA;&#x9700;&#x8981;&#x5BF9;&#x4F7F;&#x7528;UNIX domain socket&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x505A;&#x8F83;&#x5C0F;&#x7684;&#x6539;&#x52A8;&#x5C31;&#x53EF;&#x4EE5;&#x5C06;&#x5B83;&#x5E94;&#x7528;&#x4E8E;&#x7F51;&#x7EDC;&#x573A;&#x666F;&#x3002;</p>
<h3 id="&#x53EF;&#x79FB;&#x690D;&#x6027;"><a href="#&#x53EF;&#x79FB;&#x690D;&#x6027;" class="headerlink" title="&#x53EF;&#x79FB;&#x690D;&#x6027;"></a>&#x53EF;&#x79FB;&#x690D;&#x6027;</h3><p>&#x73B0;&#x4EE3;UNIX&#x5B9E;&#x73B0;&#x652F;&#x6301;&#x56FE;43-1&#x4E2D;&#x7684;&#x5927;&#x90E8;&#x5206;IPC&#x5DE5;&#x5177;&#xFF0C;&#x4F46;POSIX IPC&#x5DE5;&#x5177;&#xFF08;&#x6D88;&#x606F;&#x961F;&#x5217;&#x3001;&#x4FE1;&#x53F7;&#x91CF;&#x4EE5;&#x53CA;&#x5171;&#x4EAB;&#x5185;&#x5B58;&#xFF09;&#x7684;&#x666E;&#x53CA;&#x7A0B;&#x5EA6;&#x8FDC;&#x8FDC;&#x4E0D;&#x5982;System V IPC&#xFF0C;&#x7279;&#x522B;&#x662F;&#x5728;&#x8F83;&#x65E9;&#x7684;UNIX&#x7CFB;&#x7EDF;&#x4E0A;&#x3002;&#xFF08;&#x53EA;&#x6709;&#x7248;&#x672C;&#x4E3A;2.6.x&#x7684;Linux&#x5185;&#x6838;&#x7CFB;&#x5217;&#x624D;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;POSIX&#x6D88;&#x606F;&#x961F;&#x5217;&#x7684;&#x5B9E;&#x73B0;&#x4EE5;&#x53CA;&#x5BF9;POSIX&#x4FE1;&#x53F7;&#x91CF;&#x7684;&#x5B8C;&#x5168;&#x652F;&#x6301;&#x3002;&#xFF09;&#x56E0;&#x6B64;&#xFF0C;&#x4ECE;&#x53EF;&#x79FB;&#x690D;&#x6027;&#x7684;&#x89D2;&#x5EA6;&#x6765;&#x770B;&#xFF0C;System V IPC&#x8981;&#x4F18;&#x4E8E;POSIX IPC&#x3002;</p>
<h3 id="System-V-IPC&#x8BBE;&#x8BA1;&#x95EE;&#x9898;"><a href="#System-V-IPC&#x8BBE;&#x8BA1;&#x95EE;&#x9898;" class="headerlink" title="System V IPC&#x8BBE;&#x8BA1;&#x95EE;&#x9898;"></a>System V IPC&#x8BBE;&#x8BA1;&#x95EE;&#x9898;</h3><p>System V IPC&#x5DE5;&#x5177;&#x88AB;&#x8BBE;&#x8BA1;&#x6210;&#x72EC;&#x7ACB;&#x4E8E;&#x4F20;&#x7EDF;&#x7684;UNIX I/O&#x6A21;&#x578B;&#xFF0C;&#x5176;&#x7ED3;&#x679C;&#x662F;&#x5176;&#x4E2D;&#x4E00;&#x4E9B;&#x7279;&#x6027;&#x4F7F;&#x5F97;&#x5B83;&#x7684;&#x7F16;&#x7A0B;&#x63A5;&#x53E3;&#x7684;&#x7528;&#x6CD5;&#x66F4;&#x52A0;&#x590D;&#x6742;&#x3002;&#x76F8;&#x5E94;&#x7684;POSIX IPC&#x5DE5;&#x5177;&#x88AB;&#x8BBE;&#x8BA1;&#x7528;&#x6765;&#x89E3;&#x51B3;&#x8FD9;&#x4E9B;&#x95EE;&#x9898;&#xFF0C;&#x7279;&#x522B;&#x662F;&#x4E0B;&#x9762;&#x51E0;&#x70B9;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x3002;</p>
<ul>
<li>System V IPC&#x5DE5;&#x5177;&#x662F;&#x65E0;&#x8FDE;&#x63A5;&#x7684;&#xFF0C;&#x5B83;&#x4EEC;&#x6CA1;&#x6709;&#x63D0;&#x4F9B;&#x5F15;&#x7528;&#x4E00;&#x4E2A;&#x6253;&#x5F00;&#x7684;IPC&#x5BF9;&#x8C61;&#x7684;&#x53E5;&#x67C4;&#xFF08;&#x7C7B;&#x4F3C;&#x4E8E;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#xFF09;&#x7684;&#x6982;&#x5FF5;&#x3002;&#x5728;&#x540E;&#x9762;&#x7684;&#x7AE0;&#x8282;&#x4E2D;&#x6709;&#x65F6;&#x5019;&#x4F1A;&#x5C06;&#x201C;&#x6253;&#x5F00;&#x201D;&#x4E00;&#x4E2A;System V IPC&#x5BF9;&#x8C61;&#xFF0C;&#x4F46;&#x8FD9;&#x4EC5;&#x4EC5;&#x662F;&#x63CF;&#x8FF0;&#x8FDB;&#x7A0B;&#x83B7;&#x53D6;&#x4E00;&#x4E2A;&#x5F15;&#x7528;&#x8BE5;&#x5BF9;&#x8C61;&#x7684;&#x53E5;&#x67C4;&#x7684;&#x7B80;&#x4FBF;&#x65B9;&#x5F0F;&#x3002;&#x5185;&#x6838;&#x4E0D;&#x4F1A;&#x8BB0;&#x5F55;&#x8FDB;&#x7A0B;&#x5DF2;&#x7ECF;&#x201C;&#x6253;&#x5F00;&#x201D;&#x4E86;&#x8BE5;&#x5BF9;&#x8C61;&#xFF08;&#x4E0E;&#x5176;&#x4ED6;IPC&#x5BF9;&#x8C61;&#x4E0D;&#x540C;&#xFF09;&#x3002;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x5185;&#x6838;&#x65E0;&#x6CD5;&#x7EF4;&#x62A4;&#x5F53;&#x524D;&#x4F7F;&#x7528;&#x8BE5;&#x5BF9;&#x8C61;&#x7684;&#x8FDB;&#x7A0B;&#x7684;&#x5F15;&#x7528;&#x8BA1;&#x6570;&#xFF0C;&#x5176;&#x7ED3;&#x679C;&#x662F;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x989D;&#x5916;&#x7684;&#x4EE3;&#x7801;&#x6765;&#x77E5;&#x9053;&#x4F55;&#x65F6;&#x53EF;&#x4EE5;&#x5B89;&#x5168;&#x5730;&#x5220;&#x9664;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x3002;</li>
<li>System V IPC&#x5DE5;&#x5177;&#x7684;&#x7F16;&#x7A0B;&#x63A5;&#x53E3;&#x4E0E;&#x4F20;&#x7EDF;&#x7684;UNIX I/O&#x6A21;&#x578B;&#x662F;&#x4E0D;&#x4E00;&#x81F4;&#x7684;&#xFF08;&#x5B83;&#x4EEC;&#x4F7F;&#x7528;&#x6574;&#x6570;&#x952E;&#x503C;&#x548C;IPC&#x6807;&#x8BC6;&#x7B26;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x8DEF;&#x5F84;&#x540D;&#x548C;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#xFF09;&#xFF0C;&#x5E76;&#x4E14;&#x8FD9;&#x4E2A;&#x7F16;&#x7A0B;&#x63A5;&#x53E3;&#x4E5F;&#x8FC7;&#x4E8E;&#x590D;&#x6742;&#x4E86;&#x3002;&#x8FD9;&#x4E00;&#x70B9;&#x5728;System V&#x4FE1;&#x53F7;&#x91CF;&#x4E0A;&#x8868;&#x73B0;&#x5F97;&#x7279;&#x522B;&#x660E;&#x663E;&#x3002;</li>
</ul>
<p>&#x76F8;&#x53CD;&#xFF0C;&#x5185;&#x6838;&#x4F1A;&#x4E3A;POSIX IPC&#x5BF9;&#x8C61;&#x8BB0;&#x5F55;&#x6253;&#x5F00;&#x7684;&#x5F15;&#x7528;&#x6570;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x7B80;&#x5316;&#x4E86;&#x4F55;&#x65F6;&#x5220;&#x9664;&#x5BF9;&#x8C61;&#x7684;&#x51B3;&#x7B56;&#x3002;&#x6B64;&#x5916;&#xFF0C;POSIX IPC&#x63D0;&#x4F9B;&#x7684;&#x63A5;&#x53E3;&#x66F4;&#x52A0;&#x7B80;&#x5355;&#x5E76;&#x4E14;&#x4E0E;&#x4F20;&#x7EDF;&#x7684;UNIX&#x6A21;&#x578B;&#x4E5F;&#x66F4;&#x52A0;&#x4E00;&#x81F4;&#x3002;</p>
<h3 id="&#x53EF;&#x8BBF;&#x95EE;&#x6027;"><a href="#&#x53EF;&#x8BBF;&#x95EE;&#x6027;" class="headerlink" title="&#x53EF;&#x8BBF;&#x95EE;&#x6027;"></a>&#x53EF;&#x8BBF;&#x95EE;&#x6027;</h3><p>&#x8868;43-2&#x4E2D;&#x7684;&#x7B2C;&#x4E8C;&#x5217;&#x603B;&#x7ED3;&#x4E86;&#x5404;&#x79CD;IPC&#x5DE5;&#x5177;&#x7684;&#x4E00;&#x4E2A;&#x91CD;&#x8981;&#x7279;&#x6027;&#xFF1A;&#x6743;&#x9650;&#x6A21;&#x578B;&#x63A7;&#x5236;&#x7740;&#x54EA;&#x4E9B;&#x8FDB;&#x7A0B;&#x80FD;&#x591F;&#x8BBF;&#x95EE;&#x5BF9;&#x8C61;&#x3002;&#x4E0B;&#x9762;&#x4ECB;&#x7ECD;&#x5404;&#x79CD;&#x6A21;&#x578B;&#x7684;&#x7EC6;&#x8282;&#x4FE1;&#x606F;&#x3002;</p>
<p>&#x5BF9;&#x4E8E;&#x4E00;&#x4E9B;IPC&#x5DE5;&#x5177;&#xFF08;&#x5982;FIFO&#x548C;socket&#xFF09;&#xFF0C;&#x5BF9;&#x8C61;&#x540D;&#x4F4D;&#x4E8E;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x4E2D;&#xFF0C;&#x53EF;&#x8BBF;&#x95EE;&#x6027;&#x662F;&#x6839;&#x636E;&#x76F8;&#x5173;&#x7684;&#x6587;&#x4EF6;&#x6743;&#x9650;&#x63A9;&#x7801;&#xFF08;&#x6307;&#x5B9A;&#x4E86;&#x6240;&#x6709;&#x8005;&#x3001;&#x7EC4;&#x548C;&#x5176;&#x4ED6;&#x7528;&#x6237;&#x7684;&#x6743;&#x9650;&#xFF09;&#x6765;&#x786E;&#x5B9A;&#x7684;&#xFF08;&#x53C2;&#x89C1;15.4&#x8282;&#xFF09;&#x3002;&#x867D;&#x7136;System V IPC&#x5BF9;&#x8C61;&#x5E76;&#x4E0D;&#x4F4D;&#x4E8E;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x4E2D;&#xFF0C;&#x4F46;&#x6BCF;&#x4E2A;&#x5BF9;&#x8C61;&#x62E5;&#x6709;&#x4E00;&#x4E2A;&#x76F8;&#x5173;&#x7684;&#x6743;&#x9650;&#x63A9;&#x7801;&#xFF0C;&#x5176;&#x8BED;&#x4E49;&#x4E0E;&#x6587;&#x4EF6;&#x7684;&#x6743;&#x9650;&#x63A9;&#x7801;&#x7C7B;&#x4F3C;&#x3002;<br>&#x4E00;&#x4E9B;IPC&#x5DE5;&#x5177;&#xFF08;&#x7BA1;&#x9053;&#x3001;&#x533F;&#x540D;&#x5185;&#x5B58;&#x6620;&#x5C04;&#xFF09;&#x88AB;&#x6807;&#x8BB0;&#x6210;&#x53EA;&#x5141;&#x8BB8;&#x76F8;&#x5173;&#x8FDB;&#x7A0B;&#x8BBF;&#x95EE;&#x3002;&#x8FD9;&#x91CC;&#x201C;&#x76F8;&#x5173;&#x201D;&#x6307;&#x901A;&#x8FC7;fork()&#x5173;&#x8054;&#x7684;&#x3002;&#x4E3A;&#x4E86;&#x4F7F;&#x4E24;&#x4E2A;&#x8FDB;&#x7A0B;&#x80FD;&#x591F;&#x8BBF;&#x95EE;&#x540C;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#xFF0C;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x5FC5;&#x987B;&#x8981;&#x521B;&#x5EFA;&#x8BE5;&#x5BF9;&#x8C61;&#xFF0C;&#x7136;&#x540E;&#x8C03;&#x7528;fork()&#x3002;&#x800C;fork()&#x8C03;&#x7528;&#x7684;&#x7ED3;&#x679C;&#x5C31;&#x662F;&#x5B50;&#x8FDB;&#x7A0B;&#x4F1A;&#x7EE7;&#x627F;&#x5F15;&#x7528;&#x8BE5;&#x5BF9;&#x8C61;&#x7684;&#x4E00;&#x4E2A;&#x53E5;&#x67C4;&#xFF0C;&#x8FD9;&#x6837;&#x4E24;&#x4E2A;&#x8FDB;&#x7A0B;&#x5C31;&#x80FD;&#x591F;&#x5171;&#x4EAB;&#x5BF9;&#x8C61;&#x4E86;&#x3002;<br>POSIX&#x7684;&#x672A;&#x547D;&#x540D;&#x4FE1;&#x53F7;&#x91CF;&#x7684;&#x53EF;&#x8BBF;&#x95EE;&#x6027;&#x662F;&#x901A;&#x8FC7;&#x5305;&#x542B;&#x8BE5;&#x4FE1;&#x53F7;&#x91CF;&#x7684;&#x5171;&#x4EAB;&#x5185;&#x5B58;&#x533A;&#x57DF;&#x7684;&#x53EF;&#x8BBF;&#x95EE;&#x6027;&#x6765;&#x786E;&#x5B9A;&#x7684;&#x3002;<br>&#x4E3A;&#x4E86;&#x7ED9;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x52A0;&#x9501;&#xFF0C;&#x8FDB;&#x7A0B;&#x5FC5;&#x987B;&#x8981;&#x62E5;&#x6709;&#x4E00;&#x4E2A;&#x5F15;&#x7528;&#x8BE5;&#x6587;&#x4EF6;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#xFF08;&#x5373;&#x5728;&#x5B9E;&#x8DF5;&#x4E2D;&#x5B83;&#x5FC5;&#x987B;&#x8981;&#x62E5;&#x6709;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x7684;&#x6743;&#x9650;&#xFF09;&#x3002;<br>&#x5BF9;Internet domain socket&#x7684;&#x8BBF;&#x95EE;&#xFF08;&#x5373;&#x8FDE;&#x63A5;&#x6216;&#x53D1;&#x9001;&#x6570;&#x636E;&#x62A5;&#xFF09;&#x6CA1;&#x6709;&#x9650;&#x5236;&#x3002;&#x5982;&#x679C;&#x6709;&#x9700;&#x8981;&#x7684;&#x8BDD;&#xFF0C;&#x5FC5;&#x987B;&#x8981;&#x5728;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E2D;&#x5B9E;&#x73B0;&#x8BBF;&#x95EE;&#x63A7;&#x5236;&#x3002;</p>
<p><strong>&#x8868;43-2&#xFF1A;&#x5404;&#x79CD;IPC&#x5DE5;&#x5177;&#x7684;&#x53EF;&#x8BBF;&#x95EE;&#x6027;&#x548C;&#x6301;&#x4E45;&#x6027;</strong></p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th align="left">&#x5DE5; &#x5177; &#x7C7B; &#x578B;</th>
<th align="center">&#x53EF; &#x8BBF; &#x95EE; &#x6027;</th>
<th align="center">&#x6301;&#x3000;&#x4E45;&#x3000;&#x6027;</th>
</tr>
</thead>
<tbody><tr>
<td align="left">&#x7BA1;&#x9053;<br>FIFO</td>
<td align="center">&#x4EC5;&#x5141;&#x8BB8;&#x76F8;&#x5173;&#x8FDB;&#x7A0B;<br>&#x6743;&#x9650;&#x63A9;&#x7801;<br></td>
<td align="center">&#x8FDB;&#x7A0B;<br>&#x8FDB;&#x7A0B;</td>
</tr>
<tr>
<td align="left">UNIX domain socket<br>Internet domain socket</td>
<td align="center">&#x6743;&#x9650;&#x63A9;&#x7801;<br>&#x4EFB;&#x610F;&#x8FDB;&#x7A0B;<br></td>
<td align="center">&#x8FDB;&#x7A0B;<br>&#x8FDB;&#x7A0B;</td>
</tr>
<tr>
<td align="left">System V&#x6D88;&#x606F;&#x961F;&#x5217;<br>System V&#x4FE1;&#x53F7;&#x91CF;<br>System V&#x5171;&#x4EAB;&#x5185;&#x5B58;</td>
<td align="center">&#x6743;&#x9650;&#x63A9;&#x7801;<br>&#x6743;&#x9650;&#x63A9;&#x7801;<br>&#x6743;&#x9650;&#x63A9;&#x7801;</td>
<td align="center">&#x5185;&#x6838;<br>&#x5185;&#x6838;<br>&#x5185;&#x6838;</td>
</tr>
<tr>
<td align="left">POSIX&#x6D88;&#x606F;&#x961F;&#x5217;<br>POSIX&#x547D;&#x540D;&#x4FE1;&#x53F7;&#x91CF;<br>POSIX&#x65E0;&#x540D;&#x4FE1;&#x53F7;&#x91CF;<br>POSIX&#x5171;&#x4EAB;&#x5185;&#x5B58;</td>
<td align="center">&#x6743;&#x9650;&#x63A9;&#x7801;<br>&#x6743;&#x9650;&#x63A9;&#x7801;<br>&#x76F8;&#x5E94;&#x5185;&#x5B58;&#x7684;&#x6743;&#x9650;<br>&#x6743;&#x9650;&#x63A9;&#x7801;</td>
<td align="center">&#x5185;&#x6838;<br>&#x5185;&#x6838;<br>&#x4F9D;&#x60C5;&#x51B5;&#x800C;&#x5B9A;<br>&#x5185;&#x6838;</td>
</tr>
<tr>
<td align="left">&#x533F;&#x540D;&#x6620;&#x5C04;<br>&#x5185;&#x5B58;&#x6620;&#x5C04;&#x6587;&#x4EF6;</td>
<td align="center">&#x4EC5;&#x5141;&#x8BB8;&#x76F8;&#x5173;&#x8FDB;&#x7A0B;<br>&#x6743;&#x9650;&#x63A9;&#x7801;</td>
<td align="center">&#x8FDB;&#x7A0B;<br>&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;<br></td>
</tr>
<tr>
<td align="left">flock()&#x6587;&#x4EF6;&#x9501;<br>fcntl()&#x6587;&#x4EF6;&#x9501;<br></td>
<td align="center">&#x6587;&#x4EF6;&#x7684;open()&#x64CD;&#x4F5C;<br>&#x6587;&#x4EF6;&#x7684;open()&#x64CD;&#x4F5C;</td>
<td align="center">&#x8FDB;&#x7A0B;<br>&#x8FDB;&#x7A0B;</td>
</tr>
</tbody></table></div>
<h3 id="&#x6301;&#x4E45;&#x6027;"><a href="#&#x6301;&#x4E45;&#x6027;" class="headerlink" title="&#x6301;&#x4E45;&#x6027;"></a>&#x6301;&#x4E45;&#x6027;</h3><p>&#x672F;&#x8BED;&#x6301;&#x4E45;&#x6027;&#x662F;&#x6307;&#x4E00;&#x4E2A;IPC&#x5DE5;&#x5177;&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;&#x3002;&#xFF08;&#x53C2;&#x89C1;&#x8868;43-2&#x4E2D;&#x7684;&#x7B2C;&#x4E09;&#x5217;&#x3002;&#xFF09;&#x6301;&#x4E45;&#x6027;&#x6709;&#x4E09;&#x79CD;&#x3002;</p>
<ul>
<li>&#x8FDB;&#x7A0B;&#x6301;&#x4E45;&#x6027;&#xFF1A;&#x53EA;&#x8981;&#x5B58;&#x5728;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x6301;&#x6709;&#x8FDB;&#x7A0B;&#x6301;&#x4E45;&#x7684;IPC&#x5BF9;&#x8C61;&#xFF0C;&#x90A3;&#x4E48;&#x8BE5;&#x5BF9;&#x8C61;&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;&#x5C31;&#x4E0D;&#x4F1A;&#x7EC8;&#x6B62;&#x3002;&#x5982;&#x679C;&#x6240;&#x6709;&#x8FDB;&#x7A0B;&#x90FD;&#x5173;&#x95ED;&#x4E86;&#x5BF9;&#x8C61;&#xFF0C;&#x90A3;&#x4E48;&#x4E0E;&#x8BE5;&#x5BF9;&#x8C61;&#x7684;&#x6240;&#x6709;&#x5185;&#x6838;&#x8D44;&#x6E90;&#x90FD;&#x4F1A;&#x88AB;&#x91CA;&#x653E;&#xFF0C;&#x6240;&#x6709;&#x672A;&#x8BFB;&#x53D6;&#x7684;&#x6570;&#x636E;&#x4F1A;&#x88AB;&#x9500;&#x6BC1;&#x3002;&#x7BA1;&#x9053;&#x3001;FIFO&#x4EE5;&#x53CA;socket&#x662F;&#x8FDB;&#x7A0B;&#x6301;&#x4E45;&#x7684;IPC&#x5DE5;&#x5177;&#x3002;<br>FIFO&#x7684;&#x6570;&#x636E;&#x6301;&#x4E45;&#x6027;&#x4E0E;&#x5176;&#x540D;&#x79F0;&#x7684;&#x6301;&#x4E45;&#x6027;&#x662F;&#x4E0D;&#x540C;&#x7684;&#x3002;FIFO&#x5728;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x4E2D;&#x62E5;&#x6709;&#x4E00;&#x4E2A;&#x540D;&#x79F0;&#xFF0C;&#x5F53;&#x6240;&#x6709;&#x5F15;&#x7528;FIFO&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x90FD;&#x88AB;&#x5173;&#x95ED;&#x4E4B;&#x540E;&#x8BE5;&#x540D;&#x79F0;&#x4E5F;&#x662F;&#x6301;&#x4E45;&#x7684;&#x3002;</li>
<li>&#x5185;&#x6838;&#x6301;&#x4E45;&#x6027;&#xFF1A;&#x53EA;&#x6709;&#x5F53;&#x663E;&#x5F0F;&#x5730;&#x5220;&#x9664;&#x5185;&#x6838;&#x6301;&#x4E45;&#x7684;IPC&#x5BF9;&#x8C61;&#x6216;&#x7CFB;&#x7EDF;&#x5173;&#x95ED;&#x65F6;&#xFF0C;&#x8BE5;&#x5BF9;&#x8C61;&#x624D;&#x4F1A;&#x9500;&#x6BC1;&#x3002;&#x8FD9;&#x79CD;&#x5BF9;&#x8C61;&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;&#x4E0E;&#x662F;&#x5426;&#x6709;&#x8FDB;&#x7A0B;&#x6253;&#x5F00;&#x8BE5;&#x5BF9;&#x8C61;&#x65E0;&#x5173;&#x3002;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#xFF0C;&#x5411;&#x5176;&#x4E2D;&#x5199;&#x5165;&#x6570;&#x636E;&#xFF0C;&#x7136;&#x540E;&#x5173;&#x95ED;&#x8BE5;&#x5BF9;&#x8C61;&#xFF08;&#x6216;&#x7EC8;&#x6B62;&#xFF09;&#x3002;&#x5728;&#x540E;&#x9762;&#x67D0;&#x4E2A;&#x65F6;&#x523B;&#xFF0C;&#x53E6;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x6253;&#x5F00;&#x8BE5;&#x5BF9;&#x8C61;&#xFF0C;&#x7136;&#x540E;&#x4ECE;&#x4E2D;&#x8BFB;&#x53D6;&#x6570;&#x636E;&#x3002;&#x5177;&#x5907;&#x5185;&#x6838;&#x6301;&#x4E45;&#x6027;&#x7684;&#x5DE5;&#x5177;&#x5305;&#x62EC;System V IPC&#x548C;POSIX IPC&#x3002;&#x5728;&#x540E;&#x9762;&#x7AE0;&#x8282;&#x4E2D;&#x7528;&#x6765;&#x63CF;&#x8FF0;&#x8FD9;&#x4E9B;&#x5DE5;&#x5177;&#x7684;&#x793A;&#x4F8B;&#x7A0B;&#x5E8F;&#x4E2D;&#x5C06;&#x4F1A;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x5C5E;&#x6027;&#xFF1A;&#x5BF9;&#x4E8E;&#x6BCF;&#x79CD;&#x5DE5;&#x5177;&#x90FD;&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x5355;&#x72EC;&#x7684;&#x7A0B;&#x5E8F;&#xFF0C;&#x5728;&#x7A0B;&#x5E8F;&#x4E2D;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#xFF0C;&#x7136;&#x540E;&#x5220;&#x9664;&#x8BE5;&#x5BF9;&#x8C61;&#xFF0C;&#x5E76;&#x6267;&#x884C;&#x901A;&#x4FE1;&#x6216;&#x540C;&#x6B65;&#x64CD;&#x4F5C;&#x3002;</li>
<li>&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x6301;&#x4E45;&#x6027;&#xFF1A;&#x5177;&#x5907;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x6301;&#x4E45;&#x6027;&#x7684;IPC&#x5BF9;&#x8C61;&#x4F1A;&#x5728;&#x7CFB;&#x7EDF;&#x91CD;&#x542F;&#x7684;&#x65F6;&#x5019;&#x4FDD;&#x6301;&#x5176;&#x4E2D;&#x7684;&#x4FE1;&#x606F;&#xFF0C;&#x8FD9;&#x79CD;&#x5BF9;&#x8C61;&#x4E00;&#x76F4;&#x5B58;&#x5728;&#x76F4;&#x81F3;&#x88AB;&#x663E;&#x5F0F;&#x5730;&#x5220;&#x9664;&#x3002;&#x552F;&#x4E00;&#x4E00;&#x79CD;&#x5177;&#x5907;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x6301;&#x4E45;&#x6027;&#x7684;IPC&#x5BF9;&#x8C61;&#x662F;&#x57FA;&#x4E8E;&#x5185;&#x5B58;&#x6620;&#x5C04;&#x6587;&#x4EF6;&#x7684;&#x5171;&#x4EAB;&#x5185;&#x5B58;&#x3002;</li>
</ul>
<h3 id="&#x6027;&#x80FD;"><a href="#&#x6027;&#x80FD;" class="headerlink" title="&#x6027;&#x80FD;"></a>&#x6027;&#x80FD;</h3><p>&#x5728;&#x4E00;&#x4E9B;&#x573A;&#x666F;&#x4E2D;&#xFF0C;&#x4E0D;&#x540C;IPC&#x5DE5;&#x5177;&#x7684;&#x6027;&#x80FD;&#x53EF;&#x80FD;&#x5B58;&#x5728;&#x663E;&#x8457;&#x7684;&#x5DEE;&#x5F02;&#x3002;&#x4F46;&#x5728;&#x540E;&#x9762;&#x7684;&#x7AE0;&#x8282;&#x4E2D;&#x4E00;&#x822C;&#x4E0D;&#x4F1A;&#x5BF9;&#x5B83;&#x4EEC;&#x7684;&#x6027;&#x80FD;&#x8FDB;&#x884C;&#x6BD4;&#x8F83;&#xFF0C;&#x5176;&#x539F;&#x56E0;&#x5982;&#x4E0B;&#x3002;</p>
<ul>
<li>&#x5728;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x6574;&#x4F53;&#x6027;&#x80FD;&#x4E2D;&#xFF0C;IPC&#x5DE5;&#x5177;&#x7684;&#x6027;&#x80FD;&#x7684;&#x5F71;&#x54CD;&#x56E0;&#x7D20;&#x53EF;&#x80FD;&#x4E0D;&#x662F;&#x5F88;&#x5927;&#xFF0C;&#x5E76;&#x4E14;&#x786E;&#x5B9A;&#x9009;&#x62E9;&#x4F55;&#x79CD;IPC&#x5DE5;&#x5177;&#x53EF;&#x80FD;&#x5E76;&#x4E0D;&#x4EC5;&#x4EC5;&#x9700;&#x8981;&#x8003;&#x8651;&#x5176;&#x6027;&#x80FD;&#x56E0;&#x7D20;&#x3002;</li>
<li>&#x5404;&#x79CD;IPC&#x5DE5;&#x5177;&#x5728;&#x4E0D;&#x540C;UNIX&#x5B9E;&#x73B0;&#x6216;Linux&#x7684;&#x4E0D;&#x540C;&#x5185;&#x6838;&#x4E2D;&#x7684;&#x6027;&#x80FD;&#x53EF;&#x80FD;&#x662F;&#x4E0D;&#x540C;&#x7684;&#x3002;</li>
<li>&#x6700;&#x91CD;&#x8981;&#x7684;&#x662F;&#xFF0C;IPC&#x5DE5;&#x5177;&#x7684;&#x6027;&#x80FD;&#x53EF;&#x80FD;&#x4F1A;&#x53D7;&#x5230;&#x4F7F;&#x7528;&#x65B9;&#x5F0F;&#x548C;&#x73AF;&#x5883;&#x7684;&#x5F71;&#x54CD;&#x3002;&#x76F8;&#x5173;&#x7684;&#x56E0;&#x7D20;&#x5305;&#x62EC;&#x6BCF;&#x4E2A;IPC&#x64CD;&#x4F5C;&#x4EA4;&#x6362;&#x7684;&#x6570;&#x636E;&#x5355;&#x5143;&#x7684;&#x5927;&#x5C0F;&#x3001;IPC&#x5DE5;&#x5177;&#x4E2D;&#x672A;&#x8BFB;&#x6570;&#x636E;&#x91CF;&#x53EF;&#x80FD;&#x5F88;&#x5927;&#x3001;&#x6BCF;&#x4E2A;&#x6570;&#x636E;&#x5355;&#x5143;&#x7684;&#x4EA4;&#x6362;&#x662F;&#x5426;&#x9700;&#x8981;&#x8FDB;&#x884C;&#x8FDB;&#x7A0B;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;&#x3001;&#x4EE5;&#x53CA;&#x7CFB;&#x7EDF;&#x4E0A;&#x7684;&#x5176;&#x4ED6;&#x8D1F;&#x8F7D;&#x3002;</li>
</ul>
<p>&#x5982;&#x679C;IPC&#x6027;&#x80FD;&#x662F;&#x81F3;&#x5173;&#x7D27;&#x8981;&#x7684;&#xFF0C;&#x5E76;&#x4E14;&#x4E0D;&#x5B58;&#x5728;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5728;&#x4E0E;&#x76EE;&#x6807;&#x7CFB;&#x7EDF;&#x5339;&#x914D;&#x7684;&#x73AF;&#x5883;&#x4E2D;&#x8FD0;&#x884C;&#x7684;&#x6027;&#x80FD;&#x57FA;&#x51C6;&#xFF0C;&#x90A3;&#x4E48;&#x6700;&#x597D;&#x7F16;&#x5199;&#x4E00;&#x4E2A;&#x62BD;&#x8C61;&#x8F6F;&#x4EF6;&#x5C42;&#x6765;&#x5411;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x9690;&#x85CF;IPC&#x5DE5;&#x5177;&#x7684;&#x7EC6;&#x8282;&#xFF0C;&#x7136;&#x540E;&#x5728;&#x62BD;&#x8C61;&#x5C42;&#x4E0B;&#x4F7F;&#x7528;&#x4E0D;&#x540C;&#x7684;IPC&#x5DE5;&#x5177;&#x6765;&#x6D4B;&#x8BD5;&#x6027;&#x80FD;&#x3002;</p>
<h1 id="&#x7BA1;&#x9053;&#x548C;FIFO"><a href="#&#x7BA1;&#x9053;&#x548C;FIFO" class="headerlink" title="&#x7BA1;&#x9053;&#x548C;FIFO"></a>&#x7BA1;&#x9053;&#x548C;FIFO</h1><p>&#x672C;&#x7AE0;&#x4ECB;&#x7ECD;&#x7BA1;&#x9053;&#x548C;FIFO&#x3002;&#x7BA1;&#x9053;&#x662F;UNIX&#x7CFB;&#x7EDF;&#x4E0A;&#x6700;&#x53E4;&#x8001;&#x7684;IPC&#x65B9;&#x6CD5;&#xFF0C;&#x5B83;&#x5728;20&#x4E16;&#x7EAA;70&#x5E74;&#x4EE3;&#x65E9;&#x671F;UNIX&#x7684;&#x7B2C;&#x4E09;&#x4E2A;&#x7248;&#x672C;&#x4E0A;&#x5C31;&#x51FA;&#x73B0;&#x4E86;&#x3002;&#x7BA1;&#x9053;&#x4E3A;&#x4E00;&#x4E2A;&#x5E38;&#x89C1;&#x9700;&#x6C42;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x4F18;&#x96C5;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#xFF1A;&#x7ED9;&#x5B9A;&#x4E24;&#x4E2A;&#x8FD0;&#x884C;&#x4E0D;&#x540C;&#x7A0B;&#x5E8F;&#xFF08;&#x547D;&#x4EE4;&#xFF09;&#x7684;&#x8FDB;&#x7A0B;&#xFF0C;&#x5728;shell&#x4E2D;&#x5982;&#x4F55;&#x8BA9;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7684;&#x8F93;&#x51FA;&#x4F5C;&#x4E3A;&#x53E6;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7684;&#x8F93;&#x5165;&#x5462;&#xFF1F;&#x7BA1;&#x9053;&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x5728;&#x76F8;&#x5173;&#x8FDB;&#x7A0B;&#x4E4B;&#x95F4;&#x4F20;&#x9012;&#x6570;&#x636E;&#xFF08;&#x8BFB;&#x8005;&#x9605;&#x8BFB;&#x5B8C;&#x540E;&#x9762;&#x7684;&#x51E0;&#x9875;&#x4E4B;&#x540E;&#x5C31;&#x80FD;&#x591F;&#x7406;&#x89E3;&#x201C;&#x76F8;&#x5173;&#x201D;&#x7684;&#x542B;&#x4E49;&#x4E86;&#xFF09;&#x3002;FIFO&#x662F;&#x7BA1;&#x9053;&#x6982;&#x5FF5;&#x7684;&#x4E00;&#x4E2A;&#x53D8;&#x4F53;&#xFF0C;&#x5B83;&#x4EEC;&#x4E4B;&#x95F4;&#x7684;&#x4E00;&#x4E2A;&#x91CD;&#x8981;&#x5DEE;&#x522B;&#x5728;&#x4E8E;FIFO&#x53EF;&#x4EE5;&#x7528;&#x4E8E;&#x4EFB;&#x610F;&#x8FDB;&#x7A0B;&#x95F4;&#x7684;&#x901A;&#x4FE1;&#x3002;</p>
<h2 id="&#x6982;&#x8FF0;-4"><a href="#&#x6982;&#x8FF0;-4" class="headerlink" title="&#x6982;&#x8FF0;"></a>&#x6982;&#x8FF0;</h2><p>&#x6BCF;&#x4E2A;shell&#x7528;&#x6237;&#x90FD;&#x5BF9;&#x5728;&#x547D;&#x4EE4;&#x4E2D;&#x4F7F;&#x7528;&#x7BA1;&#x9053;&#x6BD4;&#x8F83;&#x719F;&#x6089;&#xFF0C;&#x5982;&#x4E0B;&#x9762;&#x8FD9;&#x4E2A;&#x7EDF;&#x8BA1;&#x4E00;&#x4E2A;&#x76EE;&#x5F55;&#x4E2D;&#x6587;&#x4EF6;&#x7684;&#x6570;&#x76EE;&#x7684;&#x547D;&#x4EE4;&#x6240;&#x793A;&#x3002;</p>
<pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">ls</span> <span class="token operator">|</span> ws -l<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>&#x4E3A;&#x6267;&#x884C;&#x4E0A;&#x9762;&#x7684;&#x547D;&#x4EE4;&#xFF0C;shell&#x521B;&#x5EFA;&#x4E86;&#x4E24;&#x4E2A;&#x8FDB;&#x7A0B;&#x6765;&#x5206;&#x522B;&#x6267;&#x884C;ls&#x548C;wc&#x3002;&#xFF08;&#x8FD9;&#x662F;&#x901A;&#x8FC7;&#x4F7F;&#x7528;fork()&#x548C;exec()&#x6765;&#x5B8C;&#x6210;&#x7684;&#xFF09;,&#x4E0B;&#x56FE;&#x5C55;&#x793A;&#x4E86;&#x8FD9;&#x4E24;&#x4E2A;&#x8FDB;&#x7A0B;&#x662F;&#x5982;&#x4F55;&#x4F7F;&#x7528;&#x7BA1;&#x9053;&#x7684;&#x3002;<br></p><div class="amp-img-wrapper"><amp-img src="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1581833882666.png?x-oss-process=image/resize,m_lfit,h_450" width="815" height="186" layout="responsive"></amp-img></div><br>&#x9664;&#x4E86;&#x8BF4;&#x660E;&#x7BA1;&#x9053;&#x7684;&#x7528;&#x6CD5;&#x4E4B;&#x5916;&#xFF0C;&#x56FE;44-1&#x7684;&#x53E6;&#x5916;&#x4E00;&#x4E2A;&#x76EE;&#x7684;&#x662F;&#x9610;&#x660E;&#x7BA1;&#x9053;&#x8FD9;&#x4E2A;&#x540D;&#x79F0;&#x7684;&#x7531;&#x6765;&#x3002;&#x53EF;&#x4EE5;&#x5C06;&#x7BA1;&#x9053;&#x770B;&#x6210;&#x662F;&#x4E00;&#x7EC4;&#x94C5;&#x7BA1;&#xFF0C;&#x5B83;&#x5141;&#x8BB8;&#x6570;&#x636E;&#x4ECE;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x6D41;&#x5411;&#x53E6;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x3002;
<p>&#x5728;&#x56FE;44-1&#x4E2D;&#x6709;&#x4E00;&#x70B9;&#x503C;&#x5F97;&#x6CE8;&#x610F;&#x7684;&#x662F;&#x4E24;&#x4E2A;&#x8FDB;&#x7A0B;&#x90FD;&#x8FDE;&#x63A5;&#x5230;&#x4E86;&#x7BA1;&#x9053;&#x4E0A;&#xFF0C;&#x8FD9;&#x6837;&#x5199;&#x5165;&#x8FDB;&#x7A0B;&#xFF08;ls&#xFF09;&#x5C31;&#x5C06;&#x5176;&#x6807;&#x51C6;&#x8F93;&#x51FA;&#xFF08;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x4E3A;1&#xFF09;&#x8FDE;&#x63A5;&#x5230;&#x4E86;&#x7BA1;&#x9053;&#x7684;&#x5199;&#x5165;&#x7AEF;&#xFF0C;&#x8BFB;&#x53D6;&#x8FDB;&#x7A0B;&#xFF08;wc&#xFF09;&#x5C31;&#x5C06;&#x5176;&#x6807;&#x51C6;&#x8F93;&#x5165;&#xFF08;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x4E3A;0&#xFF09;&#x8FDE;&#x63A5;&#x5230;&#x7BA1;&#x9053;&#x7684;&#x8BFB;&#x53D6;&#x7AEF;&#x3002;&#x5B9E;&#x9645;&#x4E0A;&#xFF0C;&#x8FD9;&#x4E24;&#x4E2A;&#x8FDB;&#x7A0B;&#x5E76;&#x4E0D;&#x77E5;&#x9053;&#x7BA1;&#x9053;&#x7684;&#x5B58;&#x5728;&#xFF0C;&#x5B83;&#x4EEC;&#x53EA;&#x662F;&#x4ECE;&#x6807;&#x51C6;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x4E2D;&#x8BFB;&#x53D6;&#x6570;&#x636E;&#x548C;&#x5199;&#x5165;&#x6570;&#x636E;&#x3002;shell&#x5FC5;&#x987B;&#x8981;&#x5B8C;&#x6210;&#x76F8;&#x5173;&#x7684;&#x5DE5;&#x4F5C;&#x3002;</p>
<h3 id="&#x4E00;&#x4E2A;&#x7BA1;&#x9053;&#x662F;&#x4E00;&#x4E2A;&#x5B57;&#x8282;&#x6D41;"><a href="#&#x4E00;&#x4E2A;&#x7BA1;&#x9053;&#x662F;&#x4E00;&#x4E2A;&#x5B57;&#x8282;&#x6D41;" class="headerlink" title="&#x4E00;&#x4E2A;&#x7BA1;&#x9053;&#x662F;&#x4E00;&#x4E2A;&#x5B57;&#x8282;&#x6D41;"></a>&#x4E00;&#x4E2A;&#x7BA1;&#x9053;&#x662F;&#x4E00;&#x4E2A;&#x5B57;&#x8282;&#x6D41;</h3><p>&#x5F53;&#x8BB2;&#x5230;&#x7BA1;&#x9053;&#x662F;&#x4E00;&#x4E2A;&#x5B57;&#x8282;&#x6D41;&#x65F6;&#x610F;&#x5473;&#x7740;&#x5728;&#x4F7F;&#x7528;&#x7BA1;&#x9053;&#x65F6;&#x662F;&#x4E0D;&#x5B58;&#x5728;&#x6D88;&#x606F;&#x6216;&#x6D88;&#x606F;&#x8FB9;&#x754C;&#x7684;&#x6982;&#x5FF5;&#x7684;&#x3002;&#x4ECE;&#x7BA1;&#x9053;&#x4E2D;&#x8BFB;&#x53D6;&#x6570;&#x636E;&#x7684;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x8BFB;&#x53D6;&#x4EFB;&#x610F;&#x5927;&#x5C0F;&#x7684;&#x6570;&#x636E;&#x5757;&#xFF0C;&#x800C;&#x4E0D;&#x7BA1;&#x5199;&#x5165;&#x8FDB;&#x7A0B;&#x5199;&#x5165;&#x7BA1;&#x9053;&#x7684;&#x6570;&#x636E;&#x5757;&#x7684;&#x5927;&#x5C0F;&#x662F;&#x4EC0;&#x4E48;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x901A;&#x8FC7;&#x7BA1;&#x9053;&#x4F20;&#x9012;&#x7684;&#x6570;&#x636E;&#x662F;&#x987A;&#x5E8F;&#x7684;&#x2014;&#x2014;&#x4ECE;&#x7BA1;&#x9053;&#x4E2D;&#x8BFB;&#x53D6;&#x51FA;&#x6765;&#x7684;&#x5B57;&#x8282;&#x7684;&#x987A;&#x5E8F;&#x4E0E;&#x5B83;&#x4EEC;&#x88AB;&#x5199;&#x5165;&#x7BA1;&#x9053;&#x7684;&#x987A;&#x5E8F;&#x662F;&#x5B8C;&#x5168;&#x4E00;&#x6837;&#x7684;&#x3002;&#x5728;&#x7BA1;&#x9053;&#x4E2D;&#x65E0;&#x6CD5;&#x4F7F;&#x7528;lseek()&#x6765;&#x968F;&#x673A;&#x5730;&#x8BBF;&#x95EE;&#x6570;&#x636E;&#x3002;</p>
<p>&#x5982;&#x679C;&#x9700;&#x8981;&#x5728;&#x7BA1;&#x9053;&#x4E2D;&#x5B9E;&#x73B0;&#x79BB;&#x6563;&#x6D88;&#x606F;&#x7684;&#x6982;&#x5FF5;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x5FC5;&#x987B;&#x8981;&#x5728;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E2D;&#x5B8C;&#x6210;&#x8FD9;&#x4E9B;&#x5DE5;&#x4F5C;&#x3002;&#x867D;&#x7136;&#x8FD9;&#x662F;&#x53EF;&#x884C;&#x7684;&#xFF0C;&#x4F46;&#x5982;&#x679C;&#x78B0;&#x5230;&#x8FD9;&#x79CD;&#x9700;&#x6C42;&#x7684;&#x8BDD;&#x6700;&#x597D;&#x4F7F;&#x7528;&#x5176;&#x4ED6;IPC&#x673A;&#x5236;&#xFF0C;&#x5982;&#x6D88;&#x606F;&#x961F;&#x5217;&#x548C;&#x6570;&#x636E;&#x62A5;socket&#x3002;</p>
<h3 id="&#x4ECE;&#x7BA1;&#x9053;&#x4E2D;&#x8BFB;&#x53D6;&#x6570;&#x636E;"><a href="#&#x4ECE;&#x7BA1;&#x9053;&#x4E2D;&#x8BFB;&#x53D6;&#x6570;&#x636E;" class="headerlink" title="&#x4ECE;&#x7BA1;&#x9053;&#x4E2D;&#x8BFB;&#x53D6;&#x6570;&#x636E;"></a>&#x4ECE;&#x7BA1;&#x9053;&#x4E2D;&#x8BFB;&#x53D6;&#x6570;&#x636E;</h3><p>&#x8BD5;&#x56FE;&#x4ECE;&#x4E00;&#x4E2A;&#x5F53;&#x524D;&#x4E3A;&#x7A7A;&#x7684;&#x7BA1;&#x9053;&#x4E2D;&#x8BFB;&#x53D6;&#x6570;&#x636E;&#x5C06;&#x4F1A;&#x88AB;&#x963B;&#x585E;&#x76F4;&#x5230;&#x81F3;&#x5C11;&#x6709;&#x4E00;&#x4E2A;&#x5B57;&#x8282;&#x88AB;&#x5199;&#x5165;&#x5230;&#x7BA1;&#x9053;&#x4E2D;&#x4E3A;&#x6B62;&#x3002;&#x5982;&#x679C;&#x7BA1;&#x9053;&#x7684;&#x5199;&#x5165;&#x7AEF;&#x88AB;&#x5173;&#x95ED;&#x4E86;&#xFF0C;&#x90A3;&#x4E48;&#x4ECE;&#x7BA1;&#x9053;&#x4E2D;&#x8BFB;&#x53D6;&#x6570;&#x636E;&#x7684;&#x8FDB;&#x7A0B;&#x5728;&#x8BFB;&#x5B8C;&#x7BA1;&#x9053;&#x4E2D;&#x5269;&#x4F59;&#x7684;&#x6240;&#x6709;&#x6570;&#x636E;&#x4E4B;&#x540E;&#x5C06;&#x4F1A;&#x770B;&#x5230;&#x6587;&#x4EF6;&#x7ED3;&#x675F;&#xFF08;&#x5373;read()&#x8FD4;&#x56DE;0&#xFF09;&#x3002;</p>
<h3 id="&#x7BA1;&#x9053;&#x662F;&#x5355;&#x5411;&#x7684;"><a href="#&#x7BA1;&#x9053;&#x662F;&#x5355;&#x5411;&#x7684;" class="headerlink" title="&#x7BA1;&#x9053;&#x662F;&#x5355;&#x5411;&#x7684;"></a>&#x7BA1;&#x9053;&#x662F;&#x5355;&#x5411;&#x7684;</h3><p>&#x5728;&#x7BA1;&#x9053;&#x4E2D;&#x6570;&#x636E;&#x7684;&#x4F20;&#x9012;&#x65B9;&#x5411;&#x662F;&#x5355;&#x5411;&#x7684;&#x3002;&#x7BA1;&#x9053;&#x7684;&#x4E00;&#x6BB5;&#x7528;&#x4E8E;&#x5199;&#x5165;&#xFF0C;&#x53E6;&#x4E00;&#x7AEF;&#x5219;&#x7528;&#x4E8E;&#x8BFB;&#x53D6;&#x3002;</p>
<p>&#x5728;&#x5176;&#x4ED6;&#x4E00;&#x4E9B;UNIX&#x5B9E;&#x73B0;&#x4E0A;&#x2014;&#x2014;&#x7279;&#x522B;&#x662F;&#x90A3;&#x4E9B;&#x4ECE;System V Release 4&#x6F14;&#x5316;&#x800C;&#x6765;&#x7684;&#x7CFB;&#x7EDF;&#x2014;&#x2014;&#x7BA1;&#x9053;&#x662F;&#x53CC;&#x5411;&#x7684;&#xFF08;&#x6240;&#x8C13;&#x7684;&#x6D41;&#x7BA1;&#x9053;&#xFF09;&#x3002;&#x53CC;&#x5411;&#x7BA1;&#x9053;&#x5E76;&#x6CA1;&#x6709;&#x5728;&#x4EFB;&#x4F55;UNIX&#x6807;&#x51C6;&#x4E2D;&#x8FDB;&#x884C;&#x89C4;&#x5B9A;&#xFF0C;&#x56E0;&#x6B64;&#x5373;&#x4F7F;&#x5728;&#x63D0;&#x4F9B;&#x4E86;&#x53CC;&#x5411;&#x7BA1;&#x9053;&#x7684;&#x5B9E;&#x73B0;&#x4E0A;&#x6700;&#x597D;&#x4E5F;&#x907F;&#x514D;&#x4F9D;&#x8D56;&#x8FD9;&#x79CD;&#x8BED;&#x4E49;&#x3002;&#x4F5C;&#x4E3A;&#x66FF;&#x4EE3;&#x65B9;&#x6848;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;UNIX domain&#x6D41;socket&#x5BF9;&#xFF08;&#x901A;&#x8FC7;&#x4F7F;&#x7528;57.5&#x8282;&#x4E2D;&#x4ECB;&#x7ECD;&#x7684;socketpair()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x6765;&#x521B;&#x5EFA;&#xFF09;&#xFF0C;&#x5B83;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x79CD;&#x6807;&#x51C6;&#x7684;&#x53CC;&#x5411;&#x901A;&#x4FE1;&#x673A;&#x5236;&#xFF0C;&#x5E76;&#x4E14;&#x5176;&#x8BED;&#x4E49;&#x4E0E;&#x6D41;&#x7BA1;&#x9053;&#x662F;&#x7B49;&#x4EF7;&#x7684;&#x3002;</p>
<h3 id="&#x53EF;&#x4EE5;&#x786E;&#x4FDD;&#x5199;&#x5165;&#x4E0D;&#x8D85;&#x8FC7;PIPE-BUF&#x5B57;&#x8282;&#x7684;&#x64CD;&#x4F5C;&#x662F;&#x539F;&#x5B50;&#x7684;"><a href="#&#x53EF;&#x4EE5;&#x786E;&#x4FDD;&#x5199;&#x5165;&#x4E0D;&#x8D85;&#x8FC7;PIPE-BUF&#x5B57;&#x8282;&#x7684;&#x64CD;&#x4F5C;&#x662F;&#x539F;&#x5B50;&#x7684;" class="headerlink" title="&#x53EF;&#x4EE5;&#x786E;&#x4FDD;&#x5199;&#x5165;&#x4E0D;&#x8D85;&#x8FC7;PIPE_BUF&#x5B57;&#x8282;&#x7684;&#x64CD;&#x4F5C;&#x662F;&#x539F;&#x5B50;&#x7684;"></a>&#x53EF;&#x4EE5;&#x786E;&#x4FDD;&#x5199;&#x5165;&#x4E0D;&#x8D85;&#x8FC7;PIPE_BUF&#x5B57;&#x8282;&#x7684;&#x64CD;&#x4F5C;&#x662F;&#x539F;&#x5B50;&#x7684;</h3><p>&#x5982;&#x679C;&#x591A;&#x4E2A;&#x8FDB;&#x7A0B;&#x5199;&#x5165;&#x540C;&#x4E00;&#x4E2A;&#x7BA1;&#x9053;&#xFF0C;&#x90A3;&#x4E48;&#x5982;&#x679C;&#x5B83;&#x4EEC;&#x5728;&#x4E00;&#x4E2A;&#x65F6;&#x523B;&#x5199;&#x5165;&#x7684;&#x6570;&#x636E;&#x91CF;&#x4E0D;&#x8D85;&#x8FC7;PIPE_BUF&#x5B57;&#x8282;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x53EF;&#x4EE5;&#x786E;&#x4FDD;&#x5199;&#x5165;&#x7684;&#x6570;&#x636E;&#x4E0D;&#x4F1A;&#x53D1;&#x751F;&#x76F8;&#x4E92;&#x6DF7;&#x5408;&#x7684;&#x60C5;&#x51B5;&#x3002;</p>
<p>SUSv3&#x8981;&#x6C42;PIPE_BUF&#x81F3;&#x5C11;&#x4E3A;_POSIX_PIPE_BUF&#xFF08;512&#xFF09;&#x3002;&#x4E00;&#x4E2A;&#x5B9E;&#x73B0;&#x5E94;&#x8BE5;&#x5B9A;&#x4E49;PIPE_BUF&#xFF08;&#x5728;&lt;limits.h&gt;&#x4E2D;&#xFF09;&#x5E76;/&#x6216;&#x5141;&#x8BB8;&#x8C03;&#x7528;fpathconf(fd,_PC_PIPE_BUF)&#x6765;&#x8FD4;&#x56DE;&#x539F;&#x5B50;&#x5199;&#x5165;&#x64CD;&#x4F5C;&#x7684;&#x5B9E;&#x9645;&#x4E0A;&#x9650;&#x3002;&#x4E0D;&#x540C;UNIX&#x5B9E;&#x73B0;&#x4E0A;&#x7684;PIPE_BUF&#x4E0D;&#x540C;&#xFF0C;&#x5982;&#x5728;FreeBSD 6.0&#x5176;&#x503C;&#x4E3A;512&#x5B57;&#x8282;&#xFF0C;&#x5728;Tru64 5.1&#x4E0A;&#x5176;&#x503C;&#x4E3A;4096&#x5B57;&#x8282;&#xFF0C;&#x5728;Solaris 8&#x4E0A;&#x5176;&#x503C;&#x4E3A;5120&#x5B57;&#x8282;&#x3002;&#x5728;Linux&#x4E0A;&#xFF0C;PIPE_BUF&#x7684;&#x503C;&#x4E3A;4096&#x3002;</p>
<p>&#x5F53;&#x5199;&#x5165;&#x7BA1;&#x9053;&#x7684;&#x6570;&#x636E;&#x5757;&#x7684;&#x5927;&#x5C0F;&#x8D85;&#x8FC7;&#x4E86;PIPE_BUF&#x5B57;&#x8282;&#xFF0C;&#x90A3;&#x4E48;&#x5185;&#x6838;&#x53EF;&#x80FD;&#x4F1A;&#x5C06;&#x6570;&#x636E;&#x5206;&#x5272;&#x6210;&#x51E0;&#x4E2A;&#x8F83;&#x5C0F;&#x7684;&#x7247;&#x6BB5;&#x6765;&#x4F20;&#x8F93;&#xFF0C;&#x5728;&#x8BFB;&#x8005;&#x4ECE;&#x7BA1;&#x9053;&#x4E2D;&#x6D88;&#x8017;&#x6570;&#x636E;&#x65F6;&#x518D;&#x9644;&#x52A0;&#x4E0A;&#x540E;&#x7EED;&#x7684;&#x6570;&#x636E;&#x3002;&#xFF08;write()&#x8C03;&#x7528;&#x4F1A;&#x963B;&#x585E;&#x76F4;&#x5230;&#x6240;&#x6709;&#x6570;&#x636E;&#x88AB;&#x5199;&#x5165;&#x5230;&#x7BA1;&#x9053;&#x4E3A;&#x6B62;&#x3002;&#xFF09;&#x5F53;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x5411;&#x7BA1;&#x9053;&#x5199;&#x5165;&#x6570;&#x636E;&#x65F6;&#xFF08;&#x901A;&#x5E38;&#x7684;&#x60C5;&#x51B5;&#xFF09;&#xFF0C;PIPE_BUF&#x7684;&#x53D6;&#x503C;&#x5C31;&#x6CA1;&#x6709;&#x5173;&#x7CFB;&#x4E86;&#x3002;&#x4F46;&#x5982;&#x679C;&#x6709;&#x591A;&#x4E2A;&#x5199;&#x5165;&#x8FDB;&#x7A0B;&#xFF0C;&#x90A3;&#x4E48;&#x5927;&#x6570;&#x636E;&#x5757;&#x7684;&#x5199;&#x5165;&#x53EF;&#x80FD;&#x4F1A;&#x88AB;&#x5206;&#x89E3;&#x6210;&#x4EFB;&#x610F;&#x5927;&#x5C0F;&#x7684;&#x6BB5;&#xFF08;&#x53EF;&#x80FD;&#x4F1A;&#x5C0F;&#x4E8E;PIPE_BUF&#x5B57;&#x8282;&#xFF09;&#xFF0C;&#x5E76;&#x4E14;&#x53EF;&#x80FD;&#x4F1A;&#x51FA;&#x73B0;&#x4E0E;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x5199;&#x5165;&#x7684;&#x6570;&#x636E;&#x4EA4;&#x53C9;&#x7684;&#x73B0;&#x8C61;&#x3002;</p>
<p>&#x53EA;&#x6709;&#x5728;&#x6570;&#x636E;&#x88AB;&#x4F20;&#x8F93;&#x5230;&#x7BA1;&#x9053;&#x7684;&#x65F6;&#x5019;PIPE_BUF&#x9650;&#x5236;&#x624D;&#x4F1A;&#x8D77;&#x4F5C;&#x7528;&#x3002;&#x5F53;&#x5199;&#x5165;&#x7684;&#x6570;&#x636E;&#x8FBE;&#x5230;PIPE_BUF&#x5B57;&#x8282;&#x65F6;&#xFF0C;write()&#x4F1A;&#x5728;&#x5FC5;&#x8981;&#x7684;&#x65F6;&#x5019;&#x963B;&#x585E;&#x76F4;&#x5230;&#x7BA1;&#x9053;&#x4E2D;&#x7684;&#x53EF;&#x7528;&#x7A7A;&#x95F4;&#x8DB3;&#x4EE5;&#x539F;&#x5B50;&#x5730;&#x5B8C;&#x6210;&#x64CD;&#x4F5C;&#x3002;&#x5982;&#x679C;&#x5199;&#x5165;&#x7684;&#x6570;&#x636E;&#x5927;&#x4E8E;PIPE_BUF&#x5B57;&#x8282;&#xFF0C;&#x90A3;&#x4E48;write()&#x4F1A;&#x5C3D;&#x53EF;&#x80FD;&#x5730;&#x591A;&#x4F20;&#x8F93;&#x6570;&#x636E;&#x4EE5;&#x5145;&#x6EE1;&#x6574;&#x4E2A;&#x7BA1;&#x9053;&#xFF0C;&#x7136;&#x540E;&#x963B;&#x585E;&#x76F4;&#x5230;&#x4E00;&#x4E9B;&#x8BFB;&#x53D6;&#x8FDB;&#x7A0B;&#x4ECE;&#x7BA1;&#x9053;&#x4E2D;&#x79FB;&#x9664;&#x4E86;&#x6570;&#x636E;&#x3002;&#x5982;&#x679C;&#x6B64;&#x7C7B;&#x963B;&#x585E;&#x7684;write()&#x88AB;&#x4E00;&#x4E2A;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x4E2D;&#x65AD;&#x4E86;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x4E2A;&#x8C03;&#x7528;&#x4F1A;&#x88AB;&#x89E3;&#x9664;&#x963B;&#x585E;&#x5E76;&#x8FD4;&#x56DE;&#x6210;&#x529F;&#x4F20;&#x8F93;&#x5230;&#x7BA1;&#x9053;&#x4E2D;&#x7684;&#x5B57;&#x8282;&#x6570;&#xFF0C;&#x8FD9;&#x4E2A;&#x5B57;&#x8282;&#x6570;&#x4F1A;&#x5C11;&#x4E8E;&#x8BF7;&#x6C42;&#x5199;&#x5165;&#x7684;&#x5B57;&#x8282;&#x6570;&#xFF08;&#x6240;&#x8C13;&#x7684;&#x90E8;&#x5206;&#x5199;&#x5165;&#xFF09;&#x3002;</p>
<p>&#x5728;Linux 2.2&#x4E0A;&#xFF0C;&#x5411;&#x7BA1;&#x9053;&#x5199;&#x5165;&#x4EFB;&#x610F;&#x6570;&#x91CF;&#x7684;&#x6570;&#x636E;&#x90FD;&#x662F;&#x539F;&#x5B50;&#x7684;&#xFF0C;&#x9664;&#x975E;&#x5199;&#x5165;&#x64CD;&#x4F5C;&#x88AB;&#x4E00;&#x4E2A;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x4E2D;&#x65AD;&#x4E86;&#x3002;&#x5728;Linux 2.4&#x4EE5;&#x53CA;&#x540E;&#x7EED;&#x7684;&#x7248;&#x672C;&#x4E0A;&#xFF0C;&#x5199;&#x5165;&#x6570;&#x636E;&#x91CF;&#x5927;&#x4E8E;PIPE_BUF&#x5B57;&#x8282;&#x7684;&#x6240;&#x6709;&#x64CD;&#x4F5C;&#x90FD;&#x53EF;&#x80FD;&#x4F1A;&#x4E0E;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x7684;&#x5199;&#x5165;&#x64CD;&#x4F5C;&#x53D1;&#x751F;&#x4EA4;&#x53C9;&#x3002;&#xFF08;&#x5728;&#x7248;&#x672C;&#x53F7;&#x4E3A;2.2&#x548C;2.4&#x7684;&#x5185;&#x6838;&#x4E2D;&#xFF0C;&#x5B9E;&#x73B0;&#x7BA1;&#x9053;&#x7684;&#x5185;&#x6838;&#x4EE3;&#x7801;&#x5B58;&#x5728;&#x5F88;&#x5927;&#x7684;&#x5DEE;&#x5F02;&#x3002;&#xFF09;</p>
<h3 id="&#x7BA1;&#x9053;&#x7684;&#x5BB9;&#x91CF;&#x662F;&#x6709;&#x9650;&#x7684;"><a href="#&#x7BA1;&#x9053;&#x7684;&#x5BB9;&#x91CF;&#x662F;&#x6709;&#x9650;&#x7684;" class="headerlink" title="&#x7BA1;&#x9053;&#x7684;&#x5BB9;&#x91CF;&#x662F;&#x6709;&#x9650;&#x7684;"></a>&#x7BA1;&#x9053;&#x7684;&#x5BB9;&#x91CF;&#x662F;&#x6709;&#x9650;&#x7684;</h3><p>&#x7BA1;&#x9053;&#x5176;&#x5B9E;&#x662F;&#x4E00;&#x4E2A;&#x5728;&#x5185;&#x6838;&#x5185;&#x5B58;&#x4E2D;&#x7EF4;&#x62A4;&#x7684;&#x7F13;&#x51B2;&#x5668;&#xFF0C;&#x8FD9;&#x4E2A;&#x7F13;&#x51B2;&#x5668;&#x7684;&#x5B58;&#x50A8;&#x80FD;&#x529B;&#x662F;&#x6709;&#x9650;&#x7684;&#x3002;&#x4E00;&#x65E6;&#x7BA1;&#x9053;&#x88AB;&#x586B;&#x6EE1;&#x4E4B;&#x540E;&#xFF0C;&#x540E;&#x7EED;&#x5411;&#x8BE5;&#x7BA1;&#x9053;&#x7684;&#x5199;&#x5165;&#x64CD;&#x4F5C;&#x5C31;&#x4F1A;&#x88AB;&#x963B;&#x585E;&#x76F4;&#x5230;&#x8BFB;&#x8005;&#x4ECE;&#x7BA1;&#x9053;&#x4E2D;&#x79FB;&#x9664;&#x4E86;&#x4E00;&#x4E9B;&#x6570;&#x636E;&#x4E3A;&#x6B62;&#x3002;</p>
<p>SUSv3&#x5E76;&#x6CA1;&#x6709;&#x89C4;&#x5B9A;&#x7BA1;&#x9053;&#x7684;&#x5B58;&#x50A8;&#x80FD;&#x529B;&#x3002;&#x5728;&#x65E9;&#x4E8E;2.6.11&#x7684;Linux&#x5185;&#x6838;&#x4E2D;&#xFF0C;&#x7BA1;&#x9053;&#x7684;&#x5B58;&#x50A8;&#x80FD;&#x529B;&#x4E0E;&#x7CFB;&#x7EDF;&#x9875;&#x9762;&#x7684;&#x5927;&#x5C0F;&#x662F;&#x4E00;&#x81F4;&#x7684;&#xFF08;&#x5982;&#x5728;x86-32&#x4E0A;&#x662F;4096&#x5B57;&#x8282;&#xFF09;&#xFF0C;&#x800C;&#x4ECE;Linux 2.6.11&#x8D77;&#xFF0C;&#x7BA1;&#x9053;&#x7684;&#x5B58;&#x50A8;&#x80FD;&#x529B;&#x662F;65,536&#x5B57;&#x8282;&#x3002;&#x5176;&#x4ED6;UNIX&#x5B9E;&#x73B0;&#x4E0A;&#x7684;&#x7BA1;&#x9053;&#x7684;&#x5B58;&#x50A8;&#x80FD;&#x529B;&#x53EF;&#x80FD;&#x662F;&#x4E0D;&#x540C;&#x7684;&#x3002;</p>
<p>&#x4E00;&#x822C;&#x6765;&#x8BB2;&#xFF0C;&#x4E00;&#x4E2A;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x65E0;&#x9700;&#x77E5;&#x9053;&#x7BA1;&#x9053;&#x7684;&#x5B9E;&#x9645;&#x5B58;&#x50A8;&#x80FD;&#x529B;&#x3002;&#x5982;&#x679C;&#x9700;&#x8981;&#x9632;&#x6B62;&#x5199;&#x8005;&#x8FDB;&#x7A0B;&#x963B;&#x585E;&#xFF0C;&#x90A3;&#x4E48;&#x4ECE;&#x7BA1;&#x9053;&#x4E2D;&#x8BFB;&#x53D6;&#x6570;&#x636E;&#x7684;&#x8FDB;&#x7A0B;&#x5E94;&#x8BE5;&#x88AB;&#x8BBE;&#x8BA1;&#x6210;&#x4EE5;&#x5C3D;&#x53EF;&#x80FD;&#x5FEB;&#x7684;&#x901F;&#x5EA6;&#x4ECE;&#x7BA1;&#x9053;&#x4E2D;&#x8BFB;&#x53D6;&#x6570;&#x636E;&#x3002;</p>
<p>&#x4ECE;&#x7406;&#x8BBA;&#x4E0A;&#x6765;&#x8BB2;&#xFF0C;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x7406;&#x7531;&#x53EF;&#x4EE5;&#x652F;&#x6301;&#x5B58;&#x50A8;&#x80FD;&#x529B;&#x8F83;&#x5C0F;&#x7684;&#x7BA1;&#x9053;&#x65E0;&#x6CD5;&#x6B63;&#x5E38;&#x5DE5;&#x4F5C;&#x8FD9;&#x4E2A;&#x7ED3;&#x8BBA;&#xFF0C;&#x54EA;&#x6015;&#x7BA1;&#x9053;&#x7684;&#x5B58;&#x50A8;&#x80FD;&#x529B;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x5B57;&#x8282;&#x3002;&#x4F7F;&#x7528;&#x8F83;&#x5927;&#x7684;&#x7F13;&#x51B2;&#x5668;&#x7684;&#x539F;&#x56E0;&#x662F;&#x6548;&#x7387;&#xFF1A;&#x6BCF;&#x5F53;&#x5199;&#x8005;&#x5145;&#x6EE1;&#x7BA1;&#x9053;&#x65F6;&#xFF0C;&#x5185;&#x6838;&#x5FC5;&#x987B;&#x8981;&#x6267;&#x884C;&#x4E00;&#x4E2A;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;&#x4EE5;&#x5141;&#x8BB8;&#x8BFB;&#x8005;&#x88AB;&#x8C03;&#x5EA6;&#x6765;&#x6D88;&#x8017;&#x7BA1;&#x9053;&#x4E2D;&#x7684;&#x4E00;&#x4E9B;&#x6570;&#x636E;&#x3002;&#x4F7F;&#x7528;&#x8F83;&#x5927;&#x7684;&#x7F13;&#x51B2;&#x5668;&#x610F;&#x5473;&#x7740;&#x9700;&#x6267;&#x884C;&#x7684;&#x4E0A;&#x4E0B;&#x6587;&#x5207;&#x6362;&#x6B21;&#x6570;&#x66F4;&#x5C11;&#x3002;</p>
<p>&#x4ECE;Linux 2.6.35&#x5F00;&#x59CB;&#x5C31;&#x53EF;&#x4EE5;&#x4FEE;&#x6539;&#x4E00;&#x4E2A;&#x7BA1;&#x9053;&#x7684;&#x5B58;&#x50A8;&#x80FD;&#x529B;&#x4E86;&#x3002;Linux&#x7279;&#x6709;&#x7684;fcntl(fd, F_SETPIPE_SZ, size)&#x8C03;&#x7528;&#x4F1A;&#x5C06;fd&#x5F15;&#x7528;&#x7684;&#x7BA1;&#x9053;&#x7684;&#x5B58;&#x50A8;&#x80FD;&#x529B;&#x4FEE;&#x6539;&#x4E3A;&#x81F3;&#x5C11;size&#x5B57;&#x8282;&#x3002;&#x975E;&#x7279;&#x6743;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x5C06;&#x7BA1;&#x9053;&#x7684;&#x5B58;&#x50A8;&#x80FD;&#x529B;&#x4FEE;&#x6539;&#x4E3A;&#x8303;&#x56F4;&#x5728;&#x7CFB;&#x7EDF;&#x7684;&#x9875;&#x9762;&#x5927;&#x5C0F;&#x5230;/proc/sys/fs/pipe-max-size&#x4E2D;&#x89C4;&#x5B9A;&#x7684;&#x503C;&#x4E4B;&#x5185;&#x7684;&#x4EFB;&#x4F55;&#x4E00;&#x4E2A;&#x503C;&#x3002;pipe-max-size&#x7684;&#x9ED8;&#x8BA4;&#x503C;&#x662F;1048576&#x5B57;&#x8282;&#x3002;&#x7279;&#x6743;&#xFF08;CAP_SYS_RESOURCE&#xFF09;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x8986;&#x76D6;&#x8FD9;&#x4E2A;&#x9650;&#x5236;&#x3002;&#x5728;&#x4E3A;&#x7BA1;&#x9053;&#x5206;&#x914D;&#x7A7A;&#x95F4;&#x65F6;&#xFF0C;&#x5185;&#x6838;&#x53EF;&#x80FD;&#x4F1A;&#x5C06;size&#x63D0;&#x5347;&#x4E3A;&#x5BF9;&#x5B9E;&#x73B0;&#x6765;&#x8BB2;&#x66F4;&#x52A0;&#x4FBF;&#x6377;&#x7684;&#x67D0;&#x4E2A;&#x503C;&#x3002;fcntl(fd, F_GETPIPE_SZ)&#x8C03;&#x7528;&#x8FD4;&#x56DE;&#x4E3A;&#x7BA1;&#x9053;&#x5206;&#x914D;&#x7684;&#x5B9E;&#x9645;&#x5927;&#x5C0F;&#x3002;</p>
<h2 id="&#x521B;&#x5EFA;&#x548C;&#x4F7F;&#x7528;&#x7BA1;&#x9053;"><a href="#&#x521B;&#x5EFA;&#x548C;&#x4F7F;&#x7528;&#x7BA1;&#x9053;" class="headerlink" title="&#x521B;&#x5EFA;&#x548C;&#x4F7F;&#x7528;&#x7BA1;&#x9053;"></a>&#x521B;&#x5EFA;&#x548C;&#x4F7F;&#x7528;&#x7BA1;&#x9053;</h2><p>pipe()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x7BA1;&#x9053;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;unistd.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">pipe</span><span class="token punctuation">(</span><span class="token keyword">int</span> filedes<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x6210;&#x529F;&#x7684;pipe()&#x8C03;&#x7528;&#x4F1A;&#x5728;&#x6570;&#x7EC4;filedes&#x4E2D;&#x8FD4;&#x56DE;&#x4E24;&#x4E2A;&#x6253;&#x5F00;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#xFF1A;&#x4E00;&#x4E2A;&#x8868;&#x793A;&#x7BA1;&#x9053;&#x7684;&#x8BFB;&#x53D6;&#x7AEF;&#xFF08;filedes[0]&#xFF09;&#xFF0C;&#x53E6;&#x4E00;&#x4E2A;&#x8868;&#x793A;&#x7BA1;&#x9053;&#x7684;&#x5199;&#x5165;&#x7AEF;&#xFF08;filedes[1]&#xFF09;&#x3002;</p>
<p>&#x4E0E;&#x6240;&#x6709;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x4E00;&#x6837;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;read()&#x548C;write()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x6765;&#x5728;&#x7BA1;&#x9053;&#x4E0A;&#x6267;&#x884C;I/O&#x3002;&#x4E00;&#x65E6;&#x5411;&#x7BA1;&#x9053;&#x7684;&#x5199;&#x5165;&#x7AEF;&#x5199;&#x5165;&#x6570;&#x636E;&#x4E4B;&#x540E;&#x7ACB;&#x5373;&#x5C31;&#x80FD;&#x4ECE;&#x7BA1;&#x9053;&#x7684;&#x8BFB;&#x53D6;&#x7AEF;&#x8BFB;&#x53D6;&#x6570;&#x636E;&#x3002;&#x7BA1;&#x9053;&#x4E0A;&#x7684;read()&#x8C03;&#x7528;&#x4F1A;&#x8BFB;&#x53D6;&#x7684;&#x6570;&#x636E;&#x91CF;&#x4E3A;&#x6240;&#x8BF7;&#x6C42;&#x7684;&#x5B57;&#x8282;&#x6570;&#x4E0E;&#x7BA1;&#x9053;&#x4E2D;&#x5F53;&#x524D;&#x5B58;&#x5728;&#x7684;&#x5B57;&#x8282;&#x6570;&#x4E24;&#x8005;&#x4E4B;&#x95F4;&#x8F83;&#x5C0F;&#x7684;&#x90A3;&#x4E2A;&#xFF08;&#x4F46;&#x5F53;&#x7BA1;&#x9053;&#x4E3A;&#x7A7A;&#x65F6;&#x963B;&#x585E;&#xFF09;&#x3002;</p>
<p>&#x4E5F;&#x53EF;&#x4EE5;&#x5728;&#x7BA1;&#x9053;&#x4E0A;&#x4F7F;&#x7528;stdio&#x51FD;&#x6570;&#xFF08;printf()&#x3001;scanf()&#x7B49;&#xFF09;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x9996;&#x5148;&#x4F7F;&#x7528;fdopen()&#x83B7;&#x53D6;&#x4E00;&#x4E2A;&#x4E0E;filedes&#x4E2D;&#x7684;&#x67D0;&#x4E2A;&#x63CF;&#x8FF0;&#x7B26;&#x5BF9;&#x5E94;&#x7684;&#x6587;&#x4EF6;&#x6D41;&#x5373;&#x53EF;&#x3002;&#x4F46;&#x5728;&#x8FD9;&#x6837;&#x505A;&#x7684;&#x65F6;&#x5019;&#x9700;&#x8981;&#x6E05;&#x695A;&#x5728;44.6&#x8282;&#x4E2D;&#x4ECB;&#x7ECD;&#x7684;stdio&#x7F13;&#x51B2;&#x95EE;&#x9898;&#x3002;</p>
<p>ioctl(fd, FIONREAD, &amp;cnt)&#x8C03;&#x7528;&#x8FD4;&#x56DE;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;fd&#x6240;&#x5F15;&#x7528;&#x7684;&#x7BA1;&#x9053;&#x6216;FIFO&#x4E2D;&#x672A;&#x8BFB;&#x53D6;&#x7684;&#x5B57;&#x8282;&#x6570;&#x3002;&#x5176;&#x4ED6;&#x4E00;&#x4E9B;&#x5B9E;&#x73B0;&#x4E5F;&#x63D0;&#x4F9B;&#x4E86;&#x8FD9;&#x4E2A;&#x7279;&#x6027;&#xFF0C;&#x4F46;SUSv3&#x5E76;&#x6CA1;&#x6709;&#x5BF9;&#x6B64;&#x8FDB;&#x884C;&#x89C4;&#x5B9A;&#x3002;</p>
<p>&#x5728;&#x5355;&#x4E2A;&#x8FDB;&#x7A0B;&#x4E2D;&#x7BA1;&#x9053;&#x7684;&#x7528;&#x9014;&#x4E0D;&#x591A;&#x3002;&#x4E00;&#x822C;&#x6765;&#x8BB2;&#x90FD;&#x662F;&#x4F7F;&#x7528;&#x7BA1;&#x9053;&#x8BA9;&#x4E24;&#x4E2A;&#x8FDB;&#x7A0B;&#x8FDB;&#x884C;&#x901A;&#x4FE1;&#x3002;&#x4E3A;&#x4E86;&#x8BA9;&#x4E24;&#x4E2A;&#x8FDB;&#x7A0B;&#x901A;&#x8FC7;&#x7BA1;&#x9053;&#x8FDB;&#x884C;&#x8FDE;&#x63A5;&#xFF0C;&#x5728;&#x8C03;&#x7528;&#x5B8C;pipe()&#x4E4B;&#x540E;&#x53EF;&#x4EE5;&#x8C03;&#x7528;fork()&#x3002;&#x5728;fork()&#x671F;&#x95F4;&#xFF0C;&#x5B50;&#x8FDB;&#x7A0B;&#x4F1A;&#x7EE7;&#x627F;&#x7236;&#x8FDB;&#x7A0B;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x7684;&#x526F;&#x672C;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x4F1A;&#x51FA;&#x73B0;&#x56FE;44-3&#x4E2D;&#x5DE6;&#x8FB9;&#x90A3;&#x6837;&#x7684;&#x60C5;&#x5F62;&#x3002;<br></p><div class="amp-img-wrapper"><amp-img src="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1581834755246.png?x-oss-process=image/resize,m_lfit,h_450" width="892" height="450" layout="responsive"></amp-img></div><br>&#x867D;&#x7136;&#x7236;&#x8FDB;&#x7A0B;&#x548C;&#x5B50;&#x8FDB;&#x7A0B;&#x90FD;&#x53EF;&#x4EE5;&#x4ECE;&#x7BA1;&#x9053;&#x4E2D;&#x8BFB;&#x53D6;&#x548C;&#x5199;&#x5165;&#x6570;&#x636E;&#xFF0C;&#x4F46;&#x8FD9;&#x79CD;&#x505A;&#x6CD5;&#x5E76;&#x4E0D;&#x5E38;&#x89C1;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x5728;fork()&#x8C03;&#x7528;&#x4E4B;&#x540E;&#xFF0C;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x5E94;&#x8BE5;&#x7ACB;&#x5373;&#x5173;&#x95ED;&#x7BA1;&#x9053;&#x7684;&#x5199;&#x5165;&#x7AEF;&#x7684;&#x63CF;&#x8FF0;&#x7B26;&#xFF0C;&#x53E6;&#x4E00;&#x4E2A;&#x5219;&#x5E94;&#x8BE5;&#x5173;&#x95ED;&#x8BFB;&#x53D6;&#x7AEF;&#x7684;&#x63CF;&#x8FF0;&#x7B26;&#x3002;&#x5982;&#xFF0C;&#x5982;&#x679C;&#x7236;&#x8FDB;&#x7A0B;&#x9700;&#x8981;&#x5411;&#x5B50;&#x8FDB;&#x7A0B;&#x4F20;&#x8F93;&#x6570;&#x636E;&#xFF0C;&#x90A3;&#x4E48;&#x5B83;&#x5C31;&#x4F1A;&#x5173;&#x95ED;&#x7BA1;&#x9053;&#x7684;&#x8BFB;&#x53D6;&#x7AEF;&#x7684;&#x63CF;&#x8FF0;&#x7B26;filedes[0]&#xFF0C;&#x800C;&#x5B50;&#x8FDB;&#x7A0B;&#x5C31;&#x4F1A;&#x5173;&#x95ED;&#x7BA1;&#x9053;&#x7684;&#x5199;&#x5165;&#x7AEF;&#x7684;&#x63CF;&#x8FF0;&#x7B26;filedes[1]&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x51FA;&#x73B0;&#x4E86;&#x56FE;44-3&#x4E2D;&#x53F3;&#x8FB9;&#x90A3;&#x6837;&#x7684;&#x60C5;&#x5F62;&#x3002;<br><div class="amp-img-wrapper"><amp-img src="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1581834852124.png?x-oss-process=image/resize,m_lfit,h_450" width="647" height="450" layout="responsive"></amp-img></div><br>&#x8BA9;&#x7236;&#x8FDB;&#x7A0B;&#x548C;&#x5B50;&#x8FDB;&#x7A0B;&#x90FD;&#x80FD;&#x591F;&#x4ECE;&#x540C;&#x4E00;&#x4E2A;&#x7BA1;&#x9053;&#x4E2D;&#x8BFB;&#x53D6;&#x548C;&#x5199;&#x5165;&#x6570;&#x636E;&#x8FD9;&#x79CD;&#x505A;&#x6CD5;&#x5E76;&#x4E0D;&#x5E38;&#x89C1;&#x7684;&#x4E00;&#x4E2A;&#x539F;&#x56E0;&#x662F;&#x5982;&#x679C;&#x4E24;&#x4E2A;&#x8FDB;&#x7A0B;&#x540C;&#x65F6;&#x8BD5;&#x56FE;&#x4ECE;&#x7BA1;&#x9053;&#x4E2D;&#x8BFB;&#x53D6;&#x6570;&#x636E;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x65E0;&#x6CD5;&#x786E;&#x5B9A;&#x54EA;&#x4E2A;&#x8FDB;&#x7A0B;&#x4F1A;&#x9996;&#x5148;&#x8BFB;&#x53D6;&#x6210;&#x529F;&#x2014;&#x2014;&#x4E24;&#x4E2A;&#x8FDB;&#x7A0B;&#x7ADE;&#x4E89;&#x6570;&#x636E;&#x4E86;&#x3002;&#x8981;&#x9632;&#x6B62;&#x8FD9;&#x79CD;&#x7ADE;&#x4E89;&#x60C5;&#x51B5;&#x7684;&#x51FA;&#x73B0;&#x5C31;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x67D0;&#x79CD;&#x540C;&#x6B65;&#x673A;&#x5236;&#x3002;&#x4F46;&#x5982;&#x679C;&#x9700;&#x8981;&#x53CC;&#x5411;&#x901A;&#x4FE1;&#x5219;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4E00;&#x79CD;&#x66F4;&#x52A0;&#x7B80;&#x5355;&#x7684;&#x65B9;&#x6CD5;&#xFF1A;&#x521B;&#x5EFA;&#x4E24;&#x4E2A;&#x7BA1;&#x9053;&#xFF0C;&#x5728;&#x4E24;&#x4E2A;&#x8FDB;&#x7A0B;&#x4E4B;&#x95F4;&#x53D1;&#x9001;&#x6570;&#x636E;&#x7684;&#x4E24;&#x4E2A;&#x65B9;&#x5411;&#x4E0A;&#x5404;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x3002;&#xFF08;&#x5982;&#x679C;&#x4F7F;&#x7528;&#x8FD9;&#x79CD;&#x6280;&#x672F;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x9700;&#x8981;&#x8003;&#x8651;&#x6B7B;&#x9501;&#x7684;&#x95EE;&#x9898;&#x4E86;&#xFF0C;&#x56E0;&#x4E3A;&#x5982;&#x679C;&#x4E24;&#x4E2A;&#x8FDB;&#x7A0B;&#x90FD;&#x8BD5;&#x56FE;&#x4ECE;&#x7A7A;&#x7BA1;&#x9053;&#x4E2D;&#x8BFB;&#x53D6;&#x6570;&#x636E;&#x6216;&#x5C1D;&#x8BD5;&#x5411;&#x5DF2;&#x6EE1;&#x7684;&#x7BA1;&#x9053;&#x4E2D;&#x5199;&#x5165;&#x6570;&#x636E;&#x5C31;&#x53EF;&#x80FD;&#x4F1A;&#x53D1;&#x751F;&#x6B7B;&#x9501;&#x3002;&#xFF09;
<p>&#x867D;&#x7136;&#x53EF;&#x4EE5;&#x6709;&#x591A;&#x4E2A;&#x8FDB;&#x7A0B;&#x5411;&#x5355;&#x4E2A;&#x7BA1;&#x9053;&#x4E2D;&#x5199;&#x5165;&#x6570;&#x636E;&#xFF0C;&#x4F46;&#x901A;&#x5E38;&#x53EA;&#x5B58;&#x5728;&#x4E00;&#x4E2A;&#x5199;&#x8005;&#x3002;&#x76F8;&#x53CD;&#xFF0C;&#x5728;&#x6709;&#x4E9B;&#x60C5;&#x51B5;&#x4E0B;&#x8BA9;FIFO&#x62E5;&#x6709;&#x591A;&#x4E2A;&#x5199;&#x8005;&#x662F;&#x6BD4;&#x8F83;&#x6709;&#x7528;&#x7684;&#x3002;</p>
<p>&#x4ECE;2.6.27&#x5185;&#x6838;&#x5F00;&#x59CB;&#xFF0C;Linux&#x652F;&#x6301;&#x4E00;&#x4E2A;&#x5168;&#x65B0;&#x7684;&#x975E;&#x6807;&#x51C6;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;pipe2()&#x3002;&#x8FD9;&#x4E2A;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x6267;&#x884C;&#x7684;&#x4EFB;&#x52A1;&#x4E0E;pipe()&#x4E00;&#x6837;&#xFF0C;&#x4F46;&#x652F;&#x6301;&#x989D;&#x5916;&#x7684;&#x53C2;&#x6570;flags&#xFF0C;&#x8FD9;&#x4E2A;&#x53C2;&#x6570;&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x4FEE;&#x6539;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x7684;&#x884C;&#x4E3A;&#x3002;&#x8FD9;&#x4E2A;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x652F;&#x6301;&#x4E24;&#x4E2A;&#x6807;&#x8BB0;&#xFF0C;&#x4E00;&#x4E2A;&#x662F;O_CLOEXEC&#xFF0C;&#x5B83;&#x4F1A;&#x5BFC;&#x81F4;&#x5185;&#x6838;&#x4E3A;&#x4E24;&#x4E2A;&#x65B0;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x542F;&#x7528;close-on-exec&#x6807;&#x8BB0;&#xFF08;FD_CLOEXEC&#xFF09;&#x3002;&#x8FD9;&#x4E2A;&#x6807;&#x8BB0;&#x4E4B;&#x6240;&#x4EE5;&#x6709;&#x7528;&#x7684;&#x539F;&#x56E0;&#x4E0E;&#x5728;4.3.1&#x8282;&#x4E2D;&#x4ECB;&#x7ECD;&#x7684;open() O_CLOEXEC&#x6807;&#x8BB0;&#x6709;&#x7528;&#x7684;&#x539F;&#x56E0;&#x4E00;&#x6837;&#x3002;&#x53E6;&#x4E00;&#x4E2A;&#x662F;O_NONBLOCK&#x6807;&#x8BB0;&#xFF0C;&#x5B83;&#x4F1A;&#x5BFC;&#x81F4;&#x5185;&#x6838;&#x5C06;&#x5E95;&#x5C42;&#x7684;&#x6253;&#x5F00;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x6807;&#x8BB0;&#x4E3A;&#x975E;&#x963B;&#x585E;&#xFF0C;&#x8FD9;&#x6837;&#x540E;&#x7EED;&#x7684;I/O&#x64CD;&#x4F5C;&#x4F1A;&#x662F;&#x975E;&#x963B;&#x585E;&#x7684;&#x3002;&#x8FD9;&#x6837;&#x5C31;&#x80FD;&#x591F;&#x5728;&#x4E0D;&#x8C03;&#x7528;fcntl()&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x8FBE;&#x5230;&#x540C;&#x6837;&#x7684;&#x6548;&#x679C;&#x4E86;&#x3002;</p>
<h3 id="&#x7BA1;&#x9053;&#x5141;&#x8BB8;&#x76F8;&#x5173;&#x8FDB;&#x7A0B;&#x95F4;&#x7684;&#x901A;&#x4FE1;"><a href="#&#x7BA1;&#x9053;&#x5141;&#x8BB8;&#x76F8;&#x5173;&#x8FDB;&#x7A0B;&#x95F4;&#x7684;&#x901A;&#x4FE1;" class="headerlink" title="&#x7BA1;&#x9053;&#x5141;&#x8BB8;&#x76F8;&#x5173;&#x8FDB;&#x7A0B;&#x95F4;&#x7684;&#x901A;&#x4FE1;"></a>&#x7BA1;&#x9053;&#x5141;&#x8BB8;&#x76F8;&#x5173;&#x8FDB;&#x7A0B;&#x95F4;&#x7684;&#x901A;&#x4FE1;</h3><p>&#x76EE;&#x524D;&#x4E3A;&#x6B62;&#x672C;&#x7AE0;&#x5DF2;&#x7ECF;&#x4ECB;&#x7ECD;&#x4E86;&#x5982;&#x4F55;&#x4F7F;&#x7528;&#x7BA1;&#x9053;&#x6765;&#x8BA9;&#x7236;&#x8FDB;&#x7A0B;&#x548C;&#x5B50;&#x8FDB;&#x7A0B;&#x4E4B;&#x95F4;&#x8FDB;&#x884C;&#x901A;&#x4FE1;&#xFF0C;&#x5176;&#x5B9E;&#x7BA1;&#x9053;&#x53EF;&#x4EE5;&#x7528;&#x4E8E;&#x4EFB;&#x610F;&#x4E24;&#x4E2A;&#xFF08;&#x6216;&#x66F4;&#x591A;&#xFF09;&#x76F8;&#x5173;&#x8FDB;&#x7A0B;&#x4E4B;&#x95F4;&#x7684;&#x901A;&#x4FE1;&#xFF0C;&#x53EA;&#x8981;&#x5728;&#x521B;&#x5EFA;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;&#x7CFB;&#x5217;fork()&#x8C03;&#x7528;&#x4E4B;&#x524D;&#x901A;&#x8FC7;&#x4E00;&#x4E2A;&#x5171;&#x540C;&#x7684;&#x7956;&#x5148;&#x8FDB;&#x7A0B;&#x521B;&#x5EFA;&#x7BA1;&#x9053;&#x5373;&#x53EF;&#x3002;&#xFF08;&#x8FD9;&#x5C31;&#x662F;&#x672C;&#x7AE0;&#x5F00;&#x5934;&#x90E8;&#x5206;&#x6240;&#x8BB2;&#x7684;&#x201C;&#x76F8;&#x5173;&#x8FDB;&#x7A0B;&#x201D;&#x7684;&#x542B;&#x4E49;&#x3002;&#xFF09;&#x5982;&#x7BA1;&#x9053;&#x53EF;&#x7528;&#x4E8E;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x548C;&#x5176;&#x5B59;&#x5B50;&#x8FDB;&#x7A0B;&#x4E4B;&#x95F4;&#x7684;&#x901A;&#x4FE1;&#x3002;&#x7B2C;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x521B;&#x5EFA;&#x7BA1;&#x9053;&#xFF0C;&#x7136;&#x540E;&#x521B;&#x5EFA;&#x5B50;&#x8FDB;&#x7A0B;&#xFF0C;&#x63A5;&#x7740;&#x5B50;&#x8FDB;&#x7A0B;&#x518D;&#x521B;&#x5EFA;&#x7B2C;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7684;&#x5B59;&#x5B50;&#x8FDB;&#x7A0B;&#x3002;&#x7BA1;&#x9053;&#x901A;&#x5E38;&#x7528;&#x4E8E;&#x4E24;&#x4E2A;&#x5144;&#x5F1F;&#x8FDB;&#x7A0B;&#x4E4B;&#x95F4;&#x7684;&#x901A;&#x4FE1;&#x2014;&#x2014;&#x5B83;&#x4EEC;&#x7684;&#x7236;&#x8FDB;&#x7A0B;&#x521B;&#x5EFA;&#x4E86;&#x7BA1;&#x9053;&#xFF0C;&#x7136;&#x540E;&#x521B;&#x5EFA;&#x4E24;&#x4E2A;&#x5B50;&#x8FDB;&#x7A0B;&#x3002;&#x8FD9;&#x5C31;&#x662F;&#x5728;&#x6784;&#x5EFA;&#x7BA1;&#x9053;&#x7EBF;&#x65F6;shell&#x6240;&#x505A;&#x7684;&#x5DE5;&#x4F5C;&#x3002;</p>
<p>&#x7BA1;&#x9053;&#x53EA;&#x80FD;&#x7528;&#x4E8E;&#x76F8;&#x5173;&#x8FDB;&#x7A0B;&#x4E4B;&#x95F4;&#x7684;&#x901A;&#x4FE1;&#x8FD9;&#x4E2A;&#x8BF4;&#x6CD5;&#x5B58;&#x5728;&#x4E00;&#x79CD;&#x4F8B;&#x5916;&#x60C5;&#x51B5;&#x3002;&#x901A;&#x8FC7;UNIX domain socket&#x4F20;&#x9012;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x4F7F;&#x5F97;&#x5C06;&#x7BA1;&#x9053;&#x7684;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x4F20;&#x9012;&#x7ED9;&#x4E00;&#x4E2A;&#x975E;&#x76F8;&#x5173;&#x8FDB;&#x7A0B;&#x6210;&#x4E3A;&#x53EF;&#x80FD;&#x3002;</p>
<h3 id="&#x5173;&#x95ED;&#x672A;&#x4F7F;&#x7528;&#x7BA1;&#x9053;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;"><a href="#&#x5173;&#x95ED;&#x672A;&#x4F7F;&#x7528;&#x7BA1;&#x9053;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;" class="headerlink" title="&#x5173;&#x95ED;&#x672A;&#x4F7F;&#x7528;&#x7BA1;&#x9053;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;"></a>&#x5173;&#x95ED;&#x672A;&#x4F7F;&#x7528;&#x7BA1;&#x9053;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;</h3><p>&#x5173;&#x95ED;&#x672A;&#x4F7F;&#x7528;&#x7BA1;&#x9053;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x4E0D;&#x4EC5;&#x4EC5;&#x662F;&#x4E3A;&#x4E86;&#x786E;&#x4FDD;&#x8FDB;&#x7A0B;&#x4E0D;&#x4F1A;&#x8017;&#x5C3D;&#x5176;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x7684;&#x9650;&#x5236;&#x2014;&#x2014;&#x8FD9;&#x5BF9;&#x4E8E;&#x6B63;&#x786E;&#x4F7F;&#x7528;&#x7BA1;&#x9053;&#x662F;&#x975E;&#x5E38;&#x91CD;&#x8981;&#x7684;&#x3002;&#x4E0B;&#x9762;&#x4ECB;&#x7ECD;&#x4E3A;&#x4F55;&#x5FC5;&#x987B;&#x8981;&#x5173;&#x95ED;&#x7BA1;&#x9053;&#x7684;&#x8BFB;&#x53D6;&#x7AEF;&#x548C;&#x5199;&#x5165;&#x7AEF;&#x7684;&#x672A;&#x4F7F;&#x7528;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x3002;</p>
<p>&#x4ECE;&#x7BA1;&#x9053;&#x4E2D;&#x8BFB;&#x53D6;&#x6570;&#x636E;&#x7684;&#x8FDB;&#x7A0B;&#x4F1A;&#x5173;&#x95ED;&#x5176;&#x6301;&#x6709;&#x7684;&#x7BA1;&#x9053;&#x7684;&#x5199;&#x5165;&#x63CF;&#x8FF0;&#x7B26;&#xFF0C;&#x8FD9;&#x6837;&#x5F53;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x5B8C;&#x6210;&#x8F93;&#x51FA;&#x5E76;&#x5173;&#x95ED;&#x5176;&#x5199;&#x5165;&#x63CF;&#x8FF0;&#x7B26;&#x4E4B;&#x540E;&#xFF0C;&#x8BFB;&#x8005;&#x5C31;&#x80FD;&#x591F;&#x770B;&#x5230;&#x6587;&#x4EF6;&#x7ED3;&#x675F;&#xFF08;&#x5728;&#x8BFB;&#x5B8C;&#x7BA1;&#x9053;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x4E4B;&#x540E;&#xFF09;&#x3002;</p>
<p>&#x5982;&#x679C;&#x8BFB;&#x53D6;&#x8FDB;&#x7A0B;&#x6CA1;&#x6709;&#x5173;&#x95ED;&#x7BA1;&#x9053;&#x7684;&#x5199;&#x5165;&#x7AEF;&#xFF0C;&#x90A3;&#x4E48;&#x5728;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x5173;&#x95ED;&#x4E86;&#x5199;&#x5165;&#x63CF;&#x8FF0;&#x7B26;&#x4E4B;&#x540E;&#xFF0C;&#x8BFB;&#x8005;&#x4E5F;&#x4E0D;&#x4F1A;&#x770B;&#x5230;&#x6587;&#x4EF6;&#x7ED3;&#x675F;&#xFF0C;&#x5373;&#x4F7F;&#x5B83;&#x8BFB;&#x5B8C;&#x4E86;&#x7BA1;&#x9053;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x6570;&#x636E;&#x3002;&#x76F8;&#x53CD;&#xFF0C;read()&#x5C06;&#x4F1A;&#x963B;&#x585E;&#x4EE5;&#x7B49;&#x5F85;&#x6570;&#x636E;&#xFF0C;&#x8FD9;&#x662F;&#x56E0;&#x4E3A;&#x5185;&#x6838;&#x77E5;&#x9053;&#x81F3;&#x5C11;&#x8FD8;&#x5B58;&#x5728;&#x4E00;&#x4E2A;&#x7BA1;&#x9053;&#x7684;&#x5199;&#x5165;&#x63CF;&#x8FF0;&#x7B26;&#x6253;&#x5F00;&#x7740;&#xFF0C;&#x5373;&#x8BFB;&#x53D6;&#x8FDB;&#x7A0B;&#x81EA;&#x5DF1;&#x6253;&#x5F00;&#x4E86;&#x8FD9;&#x4E2A;&#x63CF;&#x8FF0;&#x7B26;&#x3002;&#x4ECE;&#x7406;&#x8BBA;&#x4E0A;&#x6765;&#x8BB2;&#xFF0C;&#x8FD9;&#x4E2A;&#x8FDB;&#x7A0B;&#x4ECD;&#x7136;&#x53EF;&#x4EE5;&#x5411;&#x7BA1;&#x9053;&#x5199;&#x5165;&#x6570;&#x636E;&#xFF0C;&#x5373;&#x4F7F;&#x5B83;&#x5DF2;&#x7ECF;&#x88AB;&#x8BFB;&#x53D6;&#x64CD;&#x4F5C;&#x963B;&#x585E;&#x4E86;&#x3002;&#x5982;read()&#x53EF;&#x80FD;hiu&#x88AB;&#x4E00;&#x4E2A;&#x5411;&#x7BA1;&#x9053;&#x5199;&#x5165;&#x6570;&#x636E;&#x7684;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x4E2D;&#x65AD;&#x3002;&#xFF08;&#x8FD9;&#x662F;&#x73B0;&#x5B9E;&#x4E16;&#x754C;&#x4E2D;&#x7684;&#x4E00;&#x79CD;&#x573A;&#x666F;&#xFF0C;&#x8BFB;&#x8005;&#x5728;63.5.2&#x8282;&#x4E2D;&#x5C06;&#x4F1A;&#x770B;&#x5230;&#x3002;&#xFF09;</p>
<p>&#x5199;&#x5165;&#x8FDB;&#x7A0B;&#x5173;&#x95ED;&#x5176;&#x6301;&#x6709;&#x7684;&#x7BA1;&#x9053;&#x7684;&#x8BFB;&#x53D6;&#x63CF;&#x8FF0;&#x7B26;&#x662F;&#x51FA;&#x4E8E;&#x4E0D;&#x540C;&#x7684;&#x539F;&#x56E0;&#x3002;&#x5F53;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x8BD5;&#x56FE;&#x5411;&#x4E00;&#x4E2A;&#x7BA1;&#x9053;&#x4E2D;&#x5199;&#x5165;&#x6570;&#x636E;&#x4F46;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x8FDB;&#x7A0B;&#x62E5;&#x6709;&#x8BE5;&#x7BA1;&#x9053;&#x7684;&#x6253;&#x5F00;&#x7740;&#x7684;&#x8BFB;&#x53D6;&#x63CF;&#x8FF0;&#x7B26;&#x65F6;&#xFF0C;&#x5185;&#x6838;&#x4F1A;&#x5411;&#x5199;&#x5165;&#x8FDB;&#x7A0B;&#x53D1;&#x9001;&#x4E00;&#x4E2A;SIGPIPE&#x4FE1;&#x53F7;&#x3002;&#x5728;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x8FD9;&#x4E2A;&#x4FE1;&#x53F7;&#x4F1A;&#x6740;&#x6B7B;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x3002;&#x4F46;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x6355;&#x83B7;&#x6216;&#x5FFD;&#x7565;&#x8BE5;&#x4FE1;&#x53F7;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x4F1A;&#x5BFC;&#x81F4;&#x7BA1;&#x9053;&#x4E0A;&#x7684;write()&#x64CD;&#x4F5C;&#x56E0;EPIPE&#x9519;&#x8BEF;&#xFF08;&#x5DF2;&#x635F;&#x574F;&#x7684;&#x7BA1;&#x9053;&#xFF09;&#x800C;&#x5931;&#x8D25;&#x3002;&#x6536;&#x5230;SIGPIPE&#x4FE1;&#x53F7;&#x6216;&#x5F97;&#x5230;EPIPE&#x9519;&#x8BEF;&#x5BF9;&#x4E8E;&#x6807;&#x793A;&#x51FA;&#x7BA1;&#x9053;&#x7684;&#x72B6;&#x6001;&#x662F;&#x6709;&#x7528;&#x7684;&#xFF0C;&#x8FD9;&#x5C31;&#x662F;&#x4E3A;&#x4F55;&#x9700;&#x8981;&#x5173;&#x95ED;&#x7BA1;&#x9053;&#x7684;&#x672A;&#x4F7F;&#x7528;&#x8BFB;&#x53D6;&#x63CF;&#x8FF0;&#x7B26;&#x7684;&#x539F;&#x56E0;&#x3002;</p>
<p>&#x6CE8;&#x610F;&#xFF1A;&#x5BF9;&#x88AB;SIGPIPE&#x5904;&#x7406;&#x5668;&#x4E2D;&#x65AD;&#x7684;write()&#x7684;&#x5904;&#x7406;&#x662F;&#x7279;&#x6B8A;&#x7684;&#x3002;&#x901A;&#x5E38;&#xFF0C;&#x5F53;write()&#xFF08;&#x6216;&#x5176;&#x4ED6;&#x201C;&#x6162;&#x201D;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF09;&#x88AB;&#x4E00;&#x4E2A;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#x5668;&#x4E2D;&#x65AD;&#x65F6;&#xFF0C;&#x8FD9;&#x4E2A;&#x8C03;&#x7528;&#x4F1A;&#x6839;&#x636E;&#x662F;&#x5426;&#x4F7F;&#x7528;sigaction() SA_RESTART&#x6807;&#x8BB0;&#x5B89;&#x88C5;&#x4E86;&#x5904;&#x7406;&#x5668;&#x800C;&#x81EA;&#x52A8;&#x91CD;&#x542F;&#x6216;&#x56E0;EINTR&#x9519;&#x8BEF;&#x800C;&#x5931;&#x8D25;&#xFF08;&#x53C2;&#x89C1;21.5&#x8282;&#xFF09;&#x3002;&#x5BF9;SIGPIPE&#x7684;&#x5904;&#x7406;&#x4E0D;&#x540C;&#x662F;&#x56E0;&#x4E3A;&#x81EA;&#x52A8;&#x91CD;&#x542F;write()&#x6216;&#x7B80;&#x5355;&#x6807;&#x793A;&#x51FA;write()&#x88AB;&#x4E00;&#x4E2A;&#x5904;&#x7406;&#x5668;&#x4E2D;&#x65AD;&#x4E86;&#x662F;&#x6BEB;&#x65E0;&#x610F;&#x4E49;&#x7684;&#xFF08;&#x610F;&#x5473;&#x7740;&#x9700;&#x8981;&#x624B;&#x5DE5;&#x91CD;&#x542F;write()&#xFF09;&#x3002;&#x4E0D;&#x7BA1;&#x662F;&#x4F55;&#x79CD;&#x5904;&#x7406;&#x65B9;&#x5F0F;&#xFF0C;&#x540E;&#x7EED;&#x7684;write()&#x90FD;&#x4E0D;&#x4F1A;&#x6210;&#x529F;&#xFF0C;&#x56E0;&#x4E3A;&#x7BA1;&#x9053;&#x4ECD;&#x7136;&#x5904;&#x4E8E;&#x88AB;&#x635F;&#x574F;&#x7684;&#x72B6;&#x6001;&#x3002;</p>
<p>&#x5982;&#x679C;&#x5199;&#x5165;&#x8FDB;&#x7A0B;&#x6CA1;&#x6709;&#x5173;&#x95ED;&#x7BA1;&#x9053;&#x7684;&#x8BFB;&#x53D6;&#x7AEF;&#xFF0C;&#x90A3;&#x4E48;&#x5373;&#x4F7F;&#x5728;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x5DF2;&#x7ECF;&#x5173;&#x95ED;&#x4E86;&#x7BA1;&#x9053;&#x7684;&#x8BFB;&#x53D6;&#x7AEF;&#x4E4B;&#x540E;&#x5199;&#x5165;&#x8FDB;&#x7A0B;&#x4ECD;&#x7136;&#x80FD;&#x591F;&#x5411;&#x7BA1;&#x9053;&#x5199;&#x5165;&#x6570;&#x636E;&#xFF0C;&#x6700;&#x540E;&#x5199;&#x5165;&#x8FDB;&#x7A0B;&#x4F1A;&#x5C06;&#x6570;&#x636E;&#x5145;&#x6EE1;&#x6574;&#x4E2A;&#x7BA1;&#x9053;&#xFF0C;&#x540E;&#x7EED;&#x7684;&#x5199;&#x5165;&#x8BF7;&#x6C42;&#x4F1A;&#x88AB;&#x6C38;&#x8FDC;&#x963B;&#x585E;&#x3002;</p>
<p>&#x5173;&#x95ED;&#x672A;&#x4F7F;&#x7528;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x7684;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x539F;&#x56E0;&#x662F;&#x53EA;&#x6709;&#x5F53;&#x6240;&#x6709;&#x8FDB;&#x7A0B;&#x4E2D;&#x6240;&#x6709;&#x5F15;&#x7528;&#x4E00;&#x4E2A;&#x7BA1;&#x9053;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x88AB;&#x5173;&#x95ED;&#x4E4B;&#x540E;&#x624D;&#x4F1A;&#x9500;&#x6BC1;&#x8BE5;&#x7BA1;&#x9053;&#x4EE5;&#x53CA;&#x91CA;&#x653E;&#x8BE5;&#x7BA1;&#x9053;&#x5360;&#x7528;&#x7684;&#x8D44;&#x6E90;&#x4EE5;&#x4F9B;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x590D;&#x7528;&#x3002;&#x6B64;&#x65F6;&#xFF0C;&#x7BA1;&#x9053;&#x4E2D;&#x6240;&#x6709;&#x672A;&#x8BFB;&#x53D6;&#x7684;&#x6570;&#x636E;&#x90FD;&#x4F1A;&#x4E22;&#x5931;&#x3002;</p>
<h2 id="&#x5C06;&#x7BA1;&#x9053;&#x4F5C;&#x4E3A;&#x4E00;&#x79CD;&#x8FDB;&#x7A0B;&#x540C;&#x6B65;&#x7684;&#x65B9;&#x6CD5;"><a href="#&#x5C06;&#x7BA1;&#x9053;&#x4F5C;&#x4E3A;&#x4E00;&#x79CD;&#x8FDB;&#x7A0B;&#x540C;&#x6B65;&#x7684;&#x65B9;&#x6CD5;" class="headerlink" title="&#x5C06;&#x7BA1;&#x9053;&#x4F5C;&#x4E3A;&#x4E00;&#x79CD;&#x8FDB;&#x7A0B;&#x540C;&#x6B65;&#x7684;&#x65B9;&#x6CD5;"></a>&#x5C06;&#x7BA1;&#x9053;&#x4F5C;&#x4E3A;&#x4E00;&#x79CD;&#x8FDB;&#x7A0B;&#x540C;&#x6B65;&#x7684;&#x65B9;&#x6CD5;</h2><p>&#x5982;&#x7A0B;&#x5E8F;&#x6E05;&#x5355;&#x7ED9;&#x51FA;&#x7684;&#x9AA8;&#x67B6;&#x7A0B;&#x5E8F;&#x6240;&#x793A;&#x3002;&#x8FD9;&#x4E2A;&#x7A0B;&#x5E8F;&#x521B;&#x5EFA;&#x4E86;&#x591A;&#x4E2A;&#x5B50;&#x8FDB;&#x7A0B;&#xFF08;&#x6BCF;&#x4E2A;&#x547D;&#x4EE4;&#x884C;&#x53C2;&#x6570;&#x5BF9;&#x5E94;&#x4E00;&#x4E2A;&#x5B50;&#x8FDB;&#x7A0B;&#xFF09;&#xFF0C;&#x6BCF;&#x4E2A;&#x5B50;&#x8FDB;&#x7A0B;&#x90FD;&#x5B8C;&#x6210;&#x67D0;&#x4E2A;&#x52A8;&#x4F5C;&#xFF0C;&#x5728;&#x672C;&#x4F8B;&#x4E2D;&#x5219;&#x662F;&#x7761;&#x7720;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;&#x3002;&#x7236;&#x8FDB;&#x7A0B;&#x7B49;&#x5F85;&#x76F4;&#x5230;&#x6240;&#x6709;&#x5B50;&#x8FDB;&#x7A0B;&#x5B8C;&#x6210;&#x4E86;&#x81EA;&#x5DF1;&#x7684;&#x52A8;&#x4F5C;&#x4E3A;&#x6B62;&#x3002;</p>
<p>&#x4E3A;&#x4E86;&#x6267;&#x884C;&#x540C;&#x6B65;&#xFF0C;&#x7236;&#x8FDB;&#x7A0B;&#x5728;&#x521B;&#x5EFA;&#x5B50;&#x8FDB;&#x7A0B;&#x2461;&#x4E4B;&#x524D;&#x6784;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A;&#x7BA1;&#x9053;&#x2460;&#x3002;&#x6BCF;&#x4E2A;&#x5B50;&#x8FDB;&#x7A0B;&#x4F1A;&#x7EE7;&#x627F;&#x7BA1;&#x9053;&#x7684;&#x5199;&#x5165;&#x7AEF;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x5E76;&#x5728;&#x5B8C;&#x6210;&#x52A8;&#x4F5C;&#x4E4B;&#x540E;&#x5173;&#x95ED;&#x8FD9;&#x4E9B;&#x63CF;&#x8FF0;&#x7B26;&#x2462;&#x3002;&#x5F53;&#x6240;&#x6709;&#x5B50;&#x8FDB;&#x7A0B;&#x90FD;&#x5173;&#x95ED;&#x4E86;&#x7BA1;&#x9053;&#x7684;&#x5199;&#x5165;&#x7AEF;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x4E4B;&#x540E;&#xFF0C;&#x7236;&#x8FDB;&#x7A0B;&#x5728;&#x7BA1;&#x9053;&#x4E0A;&#x7684;read()&#x2464;&#x5C31;&#x4F1A;&#x7ED3;&#x675F;&#x5E76;&#x8FD4;&#x56DE;&#x6587;&#x4EF6;&#x7ED3;&#x675F;&#xFF08;0&#xFF09;&#x3002;&#x8FD9;&#x65F6;&#xFF0C;&#x7236;&#x8FDB;&#x7A0B;&#x5C31;&#x80FD;&#x591F;&#x505A;&#x5176;&#x4ED6;&#x5DE5;&#x4F5C;&#x4E86;&#x3002;&#xFF08;&#x6CE8;&#x610F;&#x5728;&#x7236;&#x8FDB;&#x7A0B;&#x4E2D;&#x5173;&#x95ED;&#x7BA1;&#x9053;&#x7684;&#x672A;&#x4F7F;&#x7528;&#x5199;&#x5165;&#x7AEF;&#x2463;&#x5BF9;&#x4E8E;&#x8FD9;&#x9879;&#x6280;&#x672F;&#x7684;&#x6B63;&#x5E38;&#x8FD0;&#x8F6C;&#x662F;&#x81F3;&#x5173;&#x91CD;&#x8981;&#x7684;&#xFF0C;&#x5426;&#x5219;&#x7236;&#x8FDB;&#x7A0B;&#x5728;&#x8BD5;&#x56FE;&#x4ECE;&#x7BA1;&#x9053;&#x4E2D;&#x8BFB;&#x53D6;&#x6570;&#x636E;&#x65F6;&#x4F1A;&#x88AB;&#x6C38;&#x8FDC;&#x963B;&#x585E;&#x3002;&#xFF09;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&quot;curr_time.h&quot;</span>                      </span><span class="token comment" spellcheck="true">/* Declaration of currTime() */</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&quot;tlpi_hdr.h&quot;</span></span>

<span class="token keyword">int</span>
<span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> pfd<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                             <span class="token comment" spellcheck="true">/* Process synchronization pipe */</span>
    <span class="token keyword">int</span> j<span class="token punctuation">,</span> dummy<span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>argc <span class="token operator">&lt;</span> <span class="token number">2</span> <span class="token operator">||</span> <span class="token function">strcmp</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;--help&quot;</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token function">usageErr</span><span class="token punctuation">(</span><span class="token string">&quot;%s sleep-time...\n&quot;</span><span class="token punctuation">,</span> argv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">setbuf</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                   <span class="token comment" spellcheck="true">/* Make stdout unbuffered, since we
                                               terminate child with _exit() */</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%s  Parent started\n&quot;</span><span class="token punctuation">,</span> <span class="token function">currTime</span><span class="token punctuation">(</span><span class="token string">&quot;%T&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">pipe</span><span class="token punctuation">(</span>pfd<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token function">errExit</span><span class="token punctuation">(</span><span class="token string">&quot;pipe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> argc<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>
            <span class="token function">errExit</span><span class="token punctuation">(</span><span class="token string">&quot;fork %d&quot;</span><span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">case</span> <span class="token number">0</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true">/* Child */</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">close</span><span class="token punctuation">(</span>pfd<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">/* Read end is unused */</span>
                <span class="token function">errExit</span><span class="token punctuation">(</span><span class="token string">&quot;close&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment" spellcheck="true">/* Child does some work, and lets parent know it&apos;s done */</span>

            <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token function">getInt</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> GN_NONNEG<span class="token punctuation">,</span> <span class="token string">&quot;sleep-time&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            <span class="token comment" spellcheck="true">/* Simulate processing */</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%s  Child %d (PID=%ld) closing pipe\n&quot;</span><span class="token punctuation">,</span>
                    <span class="token function">currTime</span><span class="token punctuation">(</span><span class="token string">&quot;%T&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> j<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span> <span class="token function">getpid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">close</span><span class="token punctuation">(</span>pfd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
                <span class="token function">errExit</span><span class="token punctuation">(</span><span class="token string">&quot;close&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment" spellcheck="true">/* Child now carries on to do other things... */</span>

            <span class="token function">_exit</span><span class="token punctuation">(</span>EXIT_SUCCESS<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true">/* Parent loops to create next child */</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">/* Parent comes here; close write end of pipe so we can see EOF */</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">close</span><span class="token punctuation">(</span>pfd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>                <span class="token comment" spellcheck="true">/* Write end is unused */</span>
        <span class="token function">errExit</span><span class="token punctuation">(</span><span class="token string">&quot;close&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">/* Parent may do other work, then synchronizes with children */</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">read</span><span class="token punctuation">(</span>pfd<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>dummy<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token function">fatal</span><span class="token punctuation">(</span><span class="token string">&quot;parent didn&apos;t get EOF&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%s  Parent ready to go\n&quot;</span><span class="token punctuation">,</span> <span class="token function">currTime</span><span class="token punctuation">(</span><span class="token string">&quot;%T&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">/* Parent can now carry on to do other things... */</span>

    <span class="token function">exit</span><span class="token punctuation">(</span>EXIT_SUCCESS<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-bash"><code class="language-bash">$ ./pipe_sync 4 2 6<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre><code>08:22:16 Parent started
08:22:18 Child 2 (PID=2445) closing pipe
08:22:20 Child 1 (PID=2444) closing pipe
08:22:22 Child 3 (PID=2446) closing pipe
08:22:18 Parent ready to go</code></pre><p>&#x4E0E;&#x524D;&#x9762;&#x4F7F;&#x7528;&#x4FE1;&#x53F7;&#x6765;&#x540C;&#x6B65;&#x76F8;&#x6BD4;&#xFF0C;&#x4F7F;&#x7528;&#x7BA1;&#x9053;&#x540C;&#x6B65;&#x5177;&#x5907;&#x4E00;&#x4E2A;&#x4F18;&#x52BF;&#xFF1A;&#x5B83;&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x534F;&#x8C03;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7684;&#x52A8;&#x4F5C;&#x4F7F;&#x4E4B;&#x4E0E;&#x591A;&#x4E2A;&#x5176;&#x4ED6;&#xFF08;&#x76F8;&#x5173;&#xFF09;&#x8FDB;&#x7A0B;&#x5339;&#x914D;&#x3002;&#x800C;&#x591A;&#x4E2A;&#xFF08;&#x6807;&#x51C6;&#xFF09;&#x4FE1;&#x53F7;&#x65E0;&#x6CD5;&#x6392;&#x961F;&#x7684;&#x4E8B;&#x5B9E;&#x4F7F;&#x5F97;&#x4FE1;&#x53F7;&#x4E0D;&#x9002;&#x7528;&#x4E8E;&#x8FD9;&#x79CD;&#x60C5;&#x5F62;&#x3002;&#xFF08;&#x76F8;&#x53CD;&#xFF0C;&#x4FE1;&#x53F7;&#x7684;&#x4F18;&#x52BF;&#x662F;&#x5B83;&#x53EF;&#x4EE5;&#x88AB;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x5E7F;&#x64AD;&#x5230;&#x8FDB;&#x7A0B;&#x7EC4;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x6210;&#x5458;&#x5904;&#x3002;&#xFF09;</p>
<p>&#x5176;&#x4ED6;&#x540C;&#x6B65;&#x7ED3;&#x6784;&#x4E5F;&#x662F;&#x53EF;&#x884C;&#x7684;&#xFF08;&#x5982;&#x4F7F;&#x7528;&#x591A;&#x4E2A;&#x7BA1;&#x9053;&#xFF09;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x8FD8;&#x53EF;&#x4EE5;&#x5BF9;&#x8FD9;&#x9879;&#x6280;&#x672F;&#x8FDB;&#x884C;&#x6269;&#x5C55;&#xFF0C;&#x5373;&#x4E0D;&#x5173;&#x95ED;&#x7BA1;&#x9053;&#xFF0C;&#x6BCF;&#x4E2A;&#x5B50;&#x8FDB;&#x7A0B;&#x5411;&#x7BA1;&#x9053;&#x5199;&#x5165;&#x4E00;&#x6761;&#x5305;&#x542B;&#x5176;&#x8FDB;&#x7A0B;ID&#x548C;&#x4E00;&#x4E9B;&#x72B6;&#x6001;&#x4FE1;&#x606F;&#x7684;&#x6D88;&#x606F;&#x3002;&#x6216;&#x8005;&#x6BCF;&#x4E2A;&#x5B50;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x5411;&#x7BA1;&#x9053;&#x5199;&#x5165;&#x4E00;&#x4E2A;&#x5B57;&#x8282;&#x3002;&#x7236;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x8BA1;&#x6570;&#x548C;&#x5206;&#x6790;&#x8FD9;&#x4E9B;&#x6D88;&#x606F;&#x3002;&#x8FD9;&#x79CD;&#x65B9;&#x6CD5;&#x8003;&#x8651;&#x5230;&#x4E86;&#x5B50;&#x8FDB;&#x7A0B;&#x610F;&#x5916;&#x7EC8;&#x6B62;&#x800C;&#x4E0D;&#x662F;&#x663E;&#x5F0F;&#x5730;&#x5173;&#x95ED;&#x7BA1;&#x9053;&#x7684;&#x60C5;&#x5F62;&#x3002;</p>
<h2 id="&#x4F7F;&#x7528;&#x7BA1;&#x9053;&#x8FDE;&#x63A5;&#x8FC7;&#x6EE4;&#x5668;"><a href="#&#x4F7F;&#x7528;&#x7BA1;&#x9053;&#x8FDE;&#x63A5;&#x8FC7;&#x6EE4;&#x5668;" class="headerlink" title="&#x4F7F;&#x7528;&#x7BA1;&#x9053;&#x8FDE;&#x63A5;&#x8FC7;&#x6EE4;&#x5668;"></a>&#x4F7F;&#x7528;&#x7BA1;&#x9053;&#x8FDE;&#x63A5;&#x8FC7;&#x6EE4;&#x5668;</h2><p>TODO.</p>
<h1 id="&#x5185;&#x5B58;&#x6620;&#x5C04;"><a href="#&#x5185;&#x5B58;&#x6620;&#x5C04;" class="headerlink" title="&#x5185;&#x5B58;&#x6620;&#x5C04;"></a>&#x5185;&#x5B58;&#x6620;&#x5C04;</h1><p>TODO.</p>
<h1 id="&#x865A;&#x62DF;&#x5185;&#x5B58;&#x64CD;&#x4F5C;"><a href="#&#x865A;&#x62DF;&#x5185;&#x5B58;&#x64CD;&#x4F5C;" class="headerlink" title="&#x865A;&#x62DF;&#x5185;&#x5B58;&#x64CD;&#x4F5C;"></a>&#x865A;&#x62DF;&#x5185;&#x5B58;&#x64CD;&#x4F5C;</h1><p>TODO.</p>
<h1 id="SOCKET&#xFF1A;&#x4ECB;&#x7ECD;"><a href="#SOCKET&#xFF1A;&#x4ECB;&#x7ECD;" class="headerlink" title="SOCKET&#xFF1A;&#x4ECB;&#x7ECD;"></a>SOCKET&#xFF1A;&#x4ECB;&#x7ECD;</h1><p>socket&#x662F;&#x4E00;&#x79CD;IPC&#x65B9;&#x6CD5;&#xFF0C;&#x5B83;&#x5141;&#x8BB8;&#x4F4D;&#x4E8E;&#x540C;&#x4E00;&#x4E3B;&#x673A;&#xFF08;&#x8BA1;&#x7B97;&#x673A;&#xFF09;&#x6216;&#x4F7F;&#x7528;&#x7F51;&#x7EDC;&#x8FDE;&#x63A5;&#x8D77;&#x6765;&#x7684;&#x4E0D;&#x540C;&#x4E3B;&#x673A;&#x4E0A;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E4B;&#x95F4;&#x4EA4;&#x6362;&#x6570;&#x636E;&#x3002;&#x7B2C;&#x4E00;&#x4E2A;&#x88AB;&#x5E7F;&#x6CDB;&#x63A5;&#x53D7;&#x7684;socket API&#x5B9E;&#x73B0;&#x4E8E;1983&#x5E74;&#xFF0C;&#x51FA;&#x73B0;&#x5728;&#x4E86;4.2BSD&#x4E2D;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x8FD9;&#x7EC4;API&#x5DF2;&#x7ECF;&#x88AB;&#x79FB;&#x690D;&#x5230;&#x4E86;&#x6240;&#x6709;UNIX&#x5B9E;&#x73B0;&#x4EE5;&#x53CA;&#x5176;&#x4ED6;&#x5927;&#x591A;&#x6570;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x4E0A;&#x4E86;&#x3002;</p>
<p>socket API&#x662F;&#x5728;POSIX.1g&#x4E2D;&#x8FDB;&#x884C;&#x6B63;&#x5F0F;&#x89C4;&#x5B9A;&#x7684;&#xFF0C;&#x5B83;&#x4F5C;&#x4E3A;&#x6807;&#x51C6;&#x8349;&#x6848;&#x5728;&#x7ECF;&#x5386;&#x4E86;10&#x5E74;&#x4E4B;&#x540E;&#x4E8E;2000&#x5E74;&#x88AB;&#x6B63;&#x5F0F;&#x8BA4;&#x53EF;&#x3002;&#x73B0;&#x5728;&#x5B83;&#x5DF2;&#x7ECF;&#x88AB;SUSv3&#x6240;&#x53D6;&#x4EE3;&#x4E86;&#x3002;</p>
<h2 id="&#x6982;&#x8FF0;-5"><a href="#&#x6982;&#x8FF0;-5" class="headerlink" title="&#x6982;&#x8FF0;"></a>&#x6982;&#x8FF0;</h2><p>&#x5728;&#x4E00;&#x4E2A;&#x5178;&#x578B;&#x7684;&#x5BA2;&#x6237;&#x7AEF;/&#x670D;&#x52A1;&#x5668;&#x573A;&#x666F;&#x4E2D;&#xFF0C;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4F7F;&#x7528;socket&#x8FDB;&#x884C;&#x901A;&#x4FE1;&#x7684;&#x65B9;&#x5F0F;&#x5982;&#x4E0B;&#x3002;</p>
<ul>
<li>&#x5404;&#x4E2A;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;socket&#x3002;socket&#x662F;&#x4E00;&#x4E2A;&#x5141;&#x8BB8;&#x901A;&#x4FE1;&#x7684;&#x201C;&#x8BBE;&#x5907;&#x201D;&#xFF0C;&#x4E24;&#x4E2A;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x90FD;&#x9700;&#x8981;&#x7528;&#x5230;&#x5B83;&#x3002;</li>
<li>&#x670D;&#x52A1;&#x5668;&#x5C06;&#x81EA;&#x5DF1;&#x7684;socket&#x7ED1;&#x5B9A;&#x5230;&#x4E00;&#x4E2A;&#x4F17;&#x6240;&#x5468;&#x77E5;&#x7684;&#x5730;&#x5740;&#xFF08;&#x540D;&#x79F0;&#xFF09;&#x4E0A;&#x4F7F;&#x5F97;&#x5BA2;&#x6237;&#x7AEF;&#x80FD;&#x591F;&#x5B9A;&#x4F4D;&#x5230;&#x5B83;&#x7684;&#x4F4D;&#x7F6E;&#x3002;</li>
</ul>
<p>&#x4F7F;&#x7528;socket()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x80FD;&#x591F;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;socket&#xFF0C;&#x5B83;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x7528;&#x6765;&#x5728;&#x540E;&#x7EED;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x4E2D;&#x5F15;&#x7528;&#x8BE5;socket&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c">fd <span class="token operator">=</span> <span class="token function">socket</span><span class="token punctuation">(</span>domain<span class="token punctuation">,</span>type<span class="token punctuation">,</span>protocol<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>protocol&#x53C2;&#x6570;&#x603B;&#x662F;&#x88AB;&#x6307;&#x5B9A;&#x4E3A;0&#x3002;</p>
<h3 id="&#x901A;&#x4FE1;domain"><a href="#&#x901A;&#x4FE1;domain" class="headerlink" title="&#x901A;&#x4FE1;domain"></a>&#x901A;&#x4FE1;domain</h3><p>socket&#x5B58;&#x5728;&#x4E8E;&#x4E00;&#x4E2A;&#x901A;&#x4FE1;domain&#x4E2D;&#xFF0C;&#x5B83;&#x786E;&#x5B9A;&#xFF1A;</p>
<ul>
<li>&#x8BC6;&#x522B;&#x51FA;&#x4E00;&#x4E2A;socket&#x7684;&#x65B9;&#x6CD5;&#xFF08;&#x5373;socket&#x201C;&#x5730;&#x5740;&#x201D;&#x7684;&#x683C;&#x5F0F;&#xFF09;&#xFF1B;</li>
<li>&#x901A;&#x4FE1;&#x8303;&#x56F4;&#xFF08;&#x5373;&#x662F;&#x5728;&#x4F4D;&#x4E8E;&#x540C;&#x4E00;&#x4E3B;&#x673A;&#x4E0A;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E4B;&#x95F4;&#x8FD8;&#x662F;&#x5728;&#x4F4D;&#x4E8E;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x7F51;&#x7EDC;&#x8FDE;&#x63A5;&#x8D77;&#x6765;&#x7684;&#x4E0D;&#x540C;&#x4E3B;&#x673A;&#x4E0A;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E4B;&#x95F4;&#xFF09;&#x3002;</li>
</ul>
<p><strong>&#x73B0;&#x4EE3;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x81F3;&#x5C11;&#x652F;&#x6301;&#x4E0B;&#x5217;domain:</strong></p>
<ul>
<li>UNIX (AF_UNIX) domain&#x5141;&#x8BB8;&#x5728;&#x540C;&#x4E00;&#x4E3B;&#x673A;&#x4E0A;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E4B;&#x95F4;&#x8FDB;&#x884C;&#x901A;&#x4FE1;&#x3002;&#xFF08;POSIX.1g&#x4F7F;&#x7528;&#x540D;&#x79F0;AF_LOCAL&#x4F5C;&#x4E3A;AF_UNIX&#x7684;&#x540C;&#x4E49;&#x8BCD;&#xFF0C;&#x4F46;SUSv3&#x5E76;&#x6CA1;&#x6709;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x540D;&#x79F0;&#x3002;&#xFF09;</li>
<li>IPv4 (AF_INET) domain&#x5141;&#x8BB8;&#x5728;&#x4F7F;&#x7528;&#x56E0;&#x7279;&#x7F51;&#x534F;&#x8BAE;&#x7B2C;4&#x7248;&#xFF08;IPv4&#xFF09;&#x7F51;&#x7EDC;&#x8FDE;&#x63A5;&#x8D77;&#x6765;&#x7684;&#x4E3B;&#x673A;&#x4E0A;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E4B;&#x95F4;&#x8FDB;&#x884C;&#x901A;&#x4FE1;&#x3002;</li>
<li>IPv6 (AF_INET6) domain&#x5141;&#x8BB8;&#x5728;&#x4F7F;&#x7528;&#x56E0;&#x7279;&#x7F51;&#x534F;&#x8BAE;&#x7B2C;6&#x7248;&#xFF08;IPv6&#xFF09;&#x7F51;&#x7EDC;&#x8FDE;&#x63A5;&#x8D77;&#x6765;&#x7684;&#x4E3B;&#x673A;&#x4E0A;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E4B;&#x95F4;&#x8FDB;&#x884C;&#x901A;&#x4FE1;&#x3002;&#x5C3D;&#x7BA1;IPv6&#x88AB;&#x8BBE;&#x8BA1;&#x6210;&#x4E86;IPv4&#x63A5;&#x4EFB;&#x8005;&#xFF0C;&#x4F46;&#x76EE;&#x524D;&#x540E;&#x4E00;&#x79CD;&#x534F;&#x8BAE;&#x4ECD;&#x7136;&#x662F;&#x4F7F;&#x7528;&#x6700;&#x5E7F;&#x7684;&#x534F;&#x8BAE;&#x3002;</li>
</ul>
<p>&#x5728;&#x4E00;&#x4E9B;&#x4EE3;&#x7801;&#x4E2D;&#x8BFB;&#x8005;&#x53EF;&#x80FD;&#x4F1A;&#x770B;&#x5230;&#x540D;&#x79F0;&#x8BF8;&#x5982;PF_UNIX&#x800C;&#x4E0D;&#x662F;AF_UNIX&#x7684;&#x5E38;&#x91CF;&#x3002;&#x5728;&#x8FD9;&#x79CD;&#x4E0A;&#x4E0B;&#x6587;&#x4E2D;&#xFF0C;AF&#x8868;&#x793A;&#x201C;&#x5730;&#x5740;&#x65CF;&#xFF08;address family&#xFF09;&#x201D;&#xFF0C;PF&#x8868;&#x793A;&#x201C;&#x534F;&#x8BAE;&#x65CF;&#xFF08;protocol family&#xFF09;&#x201D;&#x3002;&#x5728;&#x4E00;&#x5F00;&#x59CB;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x8BBE;&#x8BA1;&#x4EBA;&#x5458;&#x76F8;&#x4FE1;&#x5355;&#x4E2A;&#x534F;&#x8BAE;&#x65CF;&#x53EF;&#x4EE5;&#x652F;&#x6301;&#x591A;&#x4E2A;&#x5730;&#x5740;&#x65CF;&#x3002;&#x4F46;&#x5728;&#x5B9E;&#x8DF5;&#x4E2D;&#xFF0C;&#x6CA1;&#x6709;&#x54EA;&#x4E00;&#x4E2A;&#x534F;&#x8BAE;&#x65CF;&#x80FD;&#x591F;&#x652F;&#x6301;&#x591A;&#x4E2A;&#x5DF2;&#x7ECF;&#x88AB;&#x5B9A;&#x4E49;&#x7684;&#x5730;&#x5740;&#x65CF;&#xFF0C;&#x5E76;&#x4E14;&#x6240;&#x6709;&#x65E2;&#x6709;&#x5B9E;&#x73B0;&#x90FD;&#x5C06;PF_&#x5E38;&#x91CF;&#x5B9A;&#x4E49;&#x6210;&#x5BF9;&#x5E94;&#x7684;AF_&#x5E38;&#x91CF;&#x7684;&#x540C;&#x4E49;&#x8BCD;&#x3002;&#xFF08;SUSv3&#x89C4;&#x5B9A;&#x4E86;AF_&#x5E38;&#x91CF;&#xFF0C;&#x4F46;&#x6CA1;&#x6709;&#x89C4;&#x5B9A;PF_&#x5E38;&#x91CF;&#x3002;&#xFF09;&#x5728;&#x672C;&#x4E66;&#x4E2D;&#x4F1A;&#x4E00;&#x76F4;&#x4F7F;&#x7528;AF_&#x5E38;&#x91CF;&#x3002;</p>
<p><strong>socket domain</strong></p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th align="left">Domain</th>
<th align="center">&#x6267;&#x884C;&#x7684;&#x901A;&#x4FE1;</th>
<th align="center">&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x95F4;&#x7684;&#x901A;&#x4FE1;</th>
<th align="center">&#x5730;&#x5740;&#x683C;&#x5F0F;</th>
<th align="center">&#x5730;&#x5740;&#x7ED3;&#x6784;</th>
</tr>
</thead>
<tbody><tr>
<td align="left">AF_UNIX</td>
<td align="center">&#x5185;&#x6838;&#x4E2D;</td>
<td align="center">&#x540C;&#x4E00;&#x4E3B;&#x673A;</td>
<td align="center">&#x8DEF;&#x5F84;&#x540D;</td>
<td align="center">sockaddr_un</td>
</tr>
<tr>
<td align="left">AF_INET</td>
<td align="center">&#x901A;&#x8FC7;IPv4</td>
<td align="center">&#x901A;&#x8FC7;IPv4&#x7F51;&#x7EDC;&#x8FDE;&#x63A5;&#x8D77;&#x6765;&#x7684;&#x4E3B;&#x673A;</td>
<td align="center">32&#x4F4D;IPv4&#x5730;&#x5740;+16&#x4F4D;&#x7AEF;&#x53E3;&#x53F7;</td>
<td align="center">sockaddr_in</td>
</tr>
<tr>
<td align="left">AF_INET6</td>
<td align="center">&#x901A;&#x8FC7;IPv6</td>
<td align="center">&#x901A;&#x8FC7;IPv6&#x7F51;&#x7EDC;&#x8FDE;&#x63A5;&#x8D77;&#x6765;&#x7684;&#x4E3B;&#x673A;</td>
<td align="center">128&#x4F4D;IPv6&#x5730;&#x5740;+16&#x4F4D;&#x7AEF;&#x53E3;&#x53F7;</td>
<td align="center">sockaddr_in6</td>
</tr>
</tbody></table></div>
<h3 id="socket&#x7C7B;&#x578B;"><a href="#socket&#x7C7B;&#x578B;" class="headerlink" title="socket&#x7C7B;&#x578B;"></a>socket&#x7C7B;&#x578B;</h3><p>&#x6BCF;&#x4E2A;socket&#x5B9E;&#x73B0;&#x90FD;&#x81F3;&#x5C11;&#x63D0;&#x4F9B;&#x4E86;&#x4E24;&#x79CD;socket&#xFF1A;&#x6D41;&#x548C;&#x6570;&#x636E;&#x62A5;&#x3002;&#x8FD9;&#x4E24;&#x79CD;socket&#x7C7B;&#x578B;&#x5728;UNIX&#x548C;Internet domain&#x4E2D;&#x90FD;&#x5F97;&#x5230;&#x4E86;&#x652F;&#x6301;&#x3002;</p>
<p><strong>socket&#x7C7B;&#x578B;&#x53CA;&#x5176;&#x5C5E;&#x6027;</strong></p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th align="left">&#x5C5E;&#x6027;</th>
<th align="center">&#x6D41;</th>
<th align="center">&#x6570;&#x636E;&#x62A5;</th>
</tr>
</thead>
<tbody><tr>
<td align="left">&#x53EF;&#x9760;&#x5730;&#x9012;&#x9001;&#xFF1F;</td>
<td align="center">&#x662F;</td>
<td align="center">&#x5426;</td>
</tr>
<tr>
<td align="left">&#x6D88;&#x606F;&#x8FB9;&#x754C;&#x4FDD;&#x7559;&#xFF1F;</td>
<td align="center">&#x5426;</td>
<td align="center">&#x662F;</td>
</tr>
<tr>
<td align="left">&#x9762;&#x5411;&#x8FDE;&#x63A5;&#xFF1F;</td>
<td align="center">&#x662F;</td>
<td align="center">&#x5426;</td>
</tr>
</tbody></table></div>
<p>&#x6D41;socket&#xFF08;SOCK_STREAM&#xFF09;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x53EF;&#x9760;&#x7684;&#x53CC;&#x5411;&#x7684;&#x5B57;&#x8282;&#x6D41;&#x901A;&#x4FE1;&#x4FE1;&#x9053;&#x3002;&#x5728;&#x8FD9;&#x6BB5;&#x63CF;&#x8FF0;&#x4E2D;&#x7684;&#x672F;&#x8BED;&#x7684;&#x542B;&#x4E49;&#x5982;&#x4E0B;&#x3002;</p>
<ul>
<li>&#x53EF;&#x9760;&#x7684;&#xFF1A;&#x8868;&#x793A;&#x53EF;&#x4EE5;&#x4FDD;&#x8BC1;&#x53D1;&#x9001;&#x8005;&#x4F20;&#x8F93;&#x7684;&#x6570;&#x636E;&#x4F1A;&#x5B8C;&#x6574;&#x65E0;&#x7F3A;&#x5730;&#x5230;&#x8FBE;&#x63A5;&#x6536;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#xFF08;&#x5047;&#x8BBE;&#x7F51;&#x7EDC;&#x94FE;&#x63A5;&#x548C;&#x63A5;&#x6536;&#x8005;&#x90FD;&#x4E0D;&#x4F1A;&#x5D29;&#x6E83;&#xFF09;&#x6216;&#x6536;&#x5230;&#x4E00;&#x4E2A;&#x4F20;&#x8F93;&#x5931;&#x8D25;&#x7684;&#x901A;&#x77E5;&#x3002;</li>
<li>&#x53CC;&#x5411;&#x7684;&#xFF1A;&#x8868;&#x793A;&#x6570;&#x636E;&#x53EF;&#x4EE5;&#x5728;&#x4E24;&#x4E2A;socket&#x4E4B;&#x95F4;&#x7684;&#x4EFB;&#x610F;&#x65B9;&#x5411;&#x4E0A;&#x4F20;&#x8F93;&#x3002;</li>
<li>&#x5B57;&#x8282;&#x6D41;&#xFF1A;&#x8868;&#x793A;&#x4E0E;&#x7BA1;&#x9053;&#x4E00;&#x6837;&#x4E0D;&#x5B58;&#x5728;&#x6D88;&#x606F;&#x8FB9;&#x754C;&#x7684;&#x6982;&#x5FF5;&#x3002;</li>
</ul>
<p>&#x4E00;&#x4E2A;&#x6D41;socket&#x7C7B;&#x4F3C;&#x4E8E;&#x4F7F;&#x7528;&#x4E00;&#x5BF9;&#x5141;&#x8BB8;&#x5728;&#x4E24;&#x4E2A;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E4B;&#x95F4;&#x8FDB;&#x884C;&#x53CC;&#x5411;&#x901A;&#x4FE1;&#x7684;&#x7BA1;&#x9053;&#xFF0C;&#x5B83;&#x4EEC;&#x4E4B;&#x95F4;&#x7684;&#x5DEE;&#x522B;&#x5728;&#x4E8E;&#xFF08;Internet domain&#xFF09;socket&#x5141;&#x8BB8;&#x5728;&#x7F51;&#x7EDC;&#x4E0A;&#x8FDB;&#x884C;&#x901A;&#x4FE1;&#x3002;</p>
<p>&#x6D41;socket&#x7684;&#x6B63;&#x5E38;&#x5DE5;&#x4F5C;&#x9700;&#x8981;&#x4E00;&#x5BF9;&#x76F8;&#x4E92;&#x8FDE;&#x63A5;&#x7684;socket&#xFF0C;&#x56E0;&#x6B64;&#x6D41;socket&#x901A;&#x5E38;&#x88AB;&#x79F0;&#x4E3A;&#x9762;&#x5411;&#x8FDE;&#x63A5;&#x7684;&#x3002;&#x672F;&#x8BED;&#x201C;&#x5BF9;&#x7B49;socket&#x201D;&#x662F;&#x6307;&#x8FDE;&#x63A5;&#x53E6;&#x4E00;&#x7AEF;&#x7684;socket&#xFF0C;&#x201C;&#x5BF9;&#x7B49;&#x5730;&#x5740;&#x201D;&#x8868;&#x793A;&#x8BE5;socket&#x7684;&#x5730;&#x5740;&#xFF0C;&#x201C;&#x5BF9;&#x7B49;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x201D;&#x8868;&#x793A;&#x5229;&#x7528;&#x8FD9;&#x4E2A;&#x5BF9;&#x7B49;socket&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x3002;&#x6709;&#x4E9B;&#x65F6;&#x5019;&#xFF0C;&#x672F;&#x8BED;&#x201C;&#x8FDC;&#x7A0B;&#x201D;&#xFF08;&#x6216;&#x5916;&#x90E8;&#xFF09;&#x662F;&#x4F5C;&#x4E3A;&#x5BF9;&#x7B49;&#x7684;&#x540C;&#x4E49;&#x8BCD;&#x4F7F;&#x7528;&#x3002;&#x7C7B;&#x4F3C;&#x5730;&#xFF0C;&#x6709;&#x4E9B;&#x65F6;&#x5019;&#x672F;&#x8BED;&#x201C;&#x672C;&#x5730;&#x201D;&#x88AB;&#x7528;&#x6765;&#x6307;&#x8FDE;&#x63A5;&#x7684;&#x8FD9;&#x4E00;&#x7AEF;&#x4E0A;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x3001;socket&#x6216;&#x5730;&#x5740;&#x3002;&#x4E00;&#x4E2A;&#x6D41;socket&#x53EA;&#x80FD;&#x4E0E;&#x4E00;&#x4E2A;&#x5BF9;&#x7B49;socket&#x8FDB;&#x884C;&#x8FDE;&#x63A5;&#x3002;</p>
<p>&#x6570;&#x636E;&#x62A5;socket&#xFF08;SOCK_DGRAM&#xFF09;&#x5141;&#x8BB8;&#x6570;&#x636E;&#x4EE5;&#x88AB;&#x79F0;&#x4E3A;&#x6570;&#x636E;&#x62A5;&#x7684;&#x6D88;&#x606F;&#x7684;&#x5F62;&#x5F0F;&#x8FDB;&#x884C;&#x4EA4;&#x6362;&#x3002;&#x5728;&#x6570;&#x636E;&#x62A5;socket&#x4E2D;&#xFF0C;&#x6D88;&#x606F;&#x8FB9;&#x754C;&#x5F97;&#x5230;&#x4E86;&#x4FDD;&#x7559;&#xFF0C;&#x4F46;&#x6570;&#x636E;&#x4F20;&#x8F93;&#x662F;&#x4E0D;&#x53EF;&#x9760;&#x7684;&#x3002;&#x6D88;&#x606F;&#x7684;&#x5230;&#x8FBE;&#x53EF;&#x80FD;&#x662F;&#x65E0;&#x5E8F;&#x7684;&#x3001;&#x91CD;&#x590D;&#x7684;&#x6216;&#x8005;&#x6839;&#x672C;&#x5C31;&#x65E0;&#x6CD5;&#x5230;&#x8FBE;&#x3002;</p>
<p>&#x6570;&#x636E;&#x62A5;socket&#x662F;&#x66F4;&#x4E00;&#x822C;&#x7684;&#x65E0;&#x8FDE;&#x63A5;socket&#x6982;&#x5FF5;&#x7684;&#x4E00;&#x4E2A;&#x793A;&#x4F8B;&#x3002;&#x4E0E;&#x6D41;socket&#x4E0D;&#x540C;&#xFF0C;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x62A5;socket&#x5728;&#x4F7F;&#x7528;&#x65F6;&#x65E0;&#x9700;&#x4E0E;&#x53E6;&#x4E00;&#x4E2A;socket&#x8FDE;&#x63A5;&#x3002;</p>
<p>&#x5728;Internet domain&#x4E2D;&#xFF0C;&#x6570;&#x636E;&#x62A5;socket&#x4F7F;&#x7528;&#x4E86;&#x7528;&#x6237;&#x6570;&#x636E;&#x62A5;&#x534F;&#x8BAE;&#xFF08;UDP&#xFF09;&#xFF0C;&#x800C;&#x6D41;socket&#x5219;&#xFF08;&#x901A;&#x5E38;&#xFF09;&#x4F7F;&#x7528;&#x4E86;&#x4F20;&#x8F93;&#x63A7;&#x5236;&#x534F;&#x8BAE;&#xFF08;TCP&#xFF09;&#x3002;&#x4E00;&#x822C;&#x6765;&#x8BB2;&#xFF0C;&#x5728;&#x79F0;&#x547C;&#x8FD9;&#x4E24;&#x79CD;socket&#x65F6;&#x4E0D;&#x4F1A;&#x4F7F;&#x7528;&#x672F;&#x8BED;&#x201C;Internet domain&#x6570;&#x636E;&#x62A5;socket&#x201D;&#x548C;&#x201C;Internet domain&#x6D41;socket&#x201D;&#xFF0C;&#x800C;&#x662F;&#x5206;&#x522B;&#x4F7F;&#x7528;&#x672F;&#x8BED;&#x201C;UDP socket&#x201D;&#x548C;&#x201C;TCP socket&#x201D;&#x3002;</p>
<h3 id="socket&#x7CFB;&#x7EDF;&#x8C03;&#x7528;"><a href="#socket&#x7CFB;&#x7EDF;&#x8C03;&#x7528;" class="headerlink" title="socket&#x7CFB;&#x7EDF;&#x8C03;&#x7528;"></a>socket&#x7CFB;&#x7EDF;&#x8C03;&#x7528;</h3><p>&#x5173;&#x952E;&#x7684;socket&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5305;&#x62EC;&#x4EE5;&#x4E0B;&#x51E0;&#x79CD;&#x3002;</p>
<ul>
<li>socket()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;socket&#x3002;</li>
<li>bind()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5C06;&#x4E00;&#x4E2A;socket&#x7ED1;&#x5B9A;&#x5230;&#x4E00;&#x4E2A;&#x5730;&#x5740;&#x4E0A;&#x3002;&#x901A;&#x5E38;&#xFF0C;&#x670D;&#x52A1;&#x5668;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x8C03;&#x7528;&#x6765;&#x5C06;&#x5176;socket&#x7ED1;&#x5B9A;&#x5230;&#x4E00;&#x4E2A;&#x4F17;&#x6240;&#x5468;&#x77E5;&#x7684;&#x5730;&#x5740;&#x4E0A;&#x4F7F;&#x5F97;&#x5BA2;&#x6237;&#x7AEF;&#x80FD;&#x591F;&#x5B9A;&#x4F4D;&#x5230;&#x8BE5;socket&#x4E0A;&#x3002;</li>
<li>listen()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5141;&#x8BB8;&#x4E00;&#x4E2A;&#x6D41;socket&#x63A5;&#x53D7;&#x6765;&#x81EA;&#x5176;&#x4ED6;socket&#x7684;&#x63A5;&#x5165;&#x8FDE;&#x63A5;&#x3002;</li>
<li>accept()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5728;&#x4E00;&#x4E2A;&#x76D1;&#x542C;&#x6D41;socket&#x4E0A;&#x63A5;&#x53D7;&#x6765;&#x81EA;&#x4E00;&#x4E2A;&#x5BF9;&#x7B49;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x8FDE;&#x63A5;&#xFF0C;&#x5E76;&#x53EF;&#x9009;&#x5730;&#x8FD4;&#x56DE;&#x5BF9;&#x7B49;socket&#x7684;&#x5730;&#x5740;&#x3002;</li>
<li>connect()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5EFA;&#x7ACB;&#x4E0E;&#x53E6;&#x4E00;&#x4E2A;socket&#x4E4B;&#x95F4;&#x7684;&#x8FDE;&#x63A5;&#x3002;</li>
</ul>
<p>&#x5728;&#x5927;&#x591A;&#x6570;Linux&#x67B6;&#x6784;&#x4E0A;&#xFF08;&#x9664;&#x4E86;Alpha&#x548C;IA-64&#xFF09;&#xFF0C;&#x6240;&#x6709;&#x8FD9;&#x4E9B;socket&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5B9E;&#x9645;&#x4E0A;&#x88AB;&#x5B9E;&#x73B0;&#x6210;&#x4E86;&#x901A;&#x8FC7;&#x5355;&#x4E2A;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;socketcall()&#x8FDB;&#x884C;&#x591A;&#x8DEF;&#x590D;&#x7528;&#x7684;&#x5E93;&#x51FD;&#x6570;&#x3002;&#xFF08;&#x8FD9;&#x662F;Linux socket&#x5B9E;&#x73B0;&#x7684;&#x6700;&#x521D;&#x7684;&#x5F00;&#x53D1;&#x5DE5;&#x4F5C;&#xFF0C;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x5355;&#x72EC;&#x7684;&#x9879;&#x76EE;&#x7684;&#x4EA7;&#x7269;&#x3002;&#xFF09;&#x4F46;&#x5728;&#x672C;&#x4E66;&#x4E2D;&#x5C06;&#x6240;&#x6709;&#x8FD9;&#x4E9B;&#x51FD;&#x6570;&#x90FD;&#x79F0;&#x4E3A;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x4EEC;&#x5728;&#x6700;&#x521D;&#x7684;BSD&#x5B9E;&#x73B0;&#x4EE5;&#x53CA;&#x5176;&#x4ED6;&#x5F88;&#x591A;&#x540C;&#x65F6;&#x4EE3;&#x7684;UNIX&#x5B9E;&#x73B0;&#x4E0A;&#x662F;&#x88AB;&#x5B9E;&#x73B0;&#x6210;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x7684;&#x3002;</p>
<p>socket I/O&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4F20;&#x7EDF;&#x7684;read()&#x548C;write()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x6216;&#x4F7F;&#x7528;&#x4E00;&#x7EC4;socket&#x7279;&#x6709;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF08;&#x5982;send()&#x3001;recv()&#x3001;sendto()&#x4EE5;&#x53CA;recvfrom()&#xFF09;&#x6765;&#x5B8C;&#x6210;&#x3002;&#x5728;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x8FD9;&#x4E9B;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5728;I/O&#x64CD;&#x4F5C;&#x65E0;&#x6CD5;&#x88AB;&#x7ACB;&#x5373;&#x5B8C;&#x6210;&#x65F6;&#x4F1A;&#x963B;&#x585E;&#x3002;&#x901A;&#x8FC7;&#x4F7F;&#x7528;fcntl() F_SETFL&#x64CD;&#x4F5C;&#x6765;&#x542F;&#x7528;O_NONBLOCK&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x72B6;&#x6001;&#x6807;&#x8BB0;&#x53EF;&#x4EE5;&#x6267;&#x884C;&#x975E;&#x963B;&#x585E;I/O&#x3002;</p>
<p>&#x5728;Linux&#x4E0A;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8C03;&#x7528;ioctl(fd, FIONREAD, &amp;cnt)&#x6765;&#x83B7;&#x53D6;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;fd&#x5F15;&#x7528;&#x7684;&#x6D41;socket&#x4E2D;&#x53EF;&#x7528;&#x7684;&#x672A;&#x8BFB;&#x5B57;&#x8282;&#x6570;&#x3002;&#x5BF9;&#x4E8E;&#x6570;&#x636E;&#x62A5;socket&#x6765;&#x8BB2;&#xFF0C;&#x8FD9;&#x4E2A;&#x64CD;&#x4F5C;&#x4F1A;&#x8FD4;&#x56DE;&#x4E0B;&#x4E00;&#x4E2A;&#x672A;&#x8BFB;&#x6570;&#x636E;&#x62A5;&#x4E2D;&#x7684;&#x5B57;&#x8282;&#x6570;&#xFF08;&#x5982;&#x679C;&#x4E0B;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x62A5;&#x7684;&#x957F;&#x5EA6;&#x4E3A;&#x96F6;&#x7684;&#x8BDD;&#x5C31;&#x8FD4;&#x56DE;&#x96F6;&#xFF09;&#x6216;&#x5728;&#x6CA1;&#x6709;&#x672A;&#x51B3;&#x6570;&#x636E;&#x62A5;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x8FD4;&#x56DE;0&#x3002;&#x8FD9;&#x79CD;&#x7279;&#x6027;&#x6CA1;&#x6709;&#x5728;SUSv3&#x4E2D;&#x4E88;&#x4EE5;&#x89C4;&#x5B9A;&#x3002;</p>
<h2 id="&#x521B;&#x5EFA;&#x4E00;&#x4E2A;socket&#xFF1A;socket"><a href="#&#x521B;&#x5EFA;&#x4E00;&#x4E2A;socket&#xFF1A;socket" class="headerlink" title="&#x521B;&#x5EFA;&#x4E00;&#x4E2A;socket&#xFF1A;socket()"></a>&#x521B;&#x5EFA;&#x4E00;&#x4E2A;socket&#xFF1A;socket()</h2><p>socket()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;socket&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;sys/socket.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">socket</span><span class="token punctuation">(</span><span class="token keyword">int</span> domain<span class="token punctuation">,</span> <span class="token keyword">int</span> type<span class="token punctuation">,</span> <span class="token keyword">int</span> protocol<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>domain&#x53C2;&#x6570;&#x6307;&#x5B9A;&#x4E86;socket&#x7684;&#x901A;&#x4FE1;domain&#x3002;type&#x53C2;&#x6570;&#x6307;&#x5B9A;&#x4E86;socket&#x7C7B;&#x578B;&#x3002;&#x8FD9;&#x4E2A;&#x53C2;&#x6570;&#x901A;&#x5E38;&#x5728;&#x521B;&#x5EFA;&#x6D41;socket&#x65F6;&#x4F1A;&#x88AB;&#x6307;&#x5B9A;&#x4E3A;SOCK_STREAM&#xFF0C;&#x800C;&#x5728;&#x521B;&#x5EFA;&#x6570;&#x636E;&#x62A5;socket&#x65F6;&#x4F1A;&#x88AB;&#x6307;&#x5B9A;&#x4E3A;SOCK_DGRAM&#x3002;</p>
<p>protocol&#x53C2;&#x6570;&#x5728;&#x672C;&#x4E66;&#x63CF;&#x8FF0;&#x7684;socket&#x7C7B;&#x578B;&#x4E2D;&#x603B;&#x4F1A;&#x88AB;&#x6307;&#x5B9A;&#x4E3A;0&#x3002;&#x5728;&#x4E00;&#x4E9B;socket&#x7C7B;&#x578B;&#x4E2D;&#x4F1A;&#x4F7F;&#x7528;&#x975E;&#x96F6;&#x7684;protocol&#x503C;&#xFF0C;&#x4F46;&#x672C;&#x4E66;&#x5E76;&#x6CA1;&#x6709;&#x5BF9;&#x8FD9;&#x4E9B;socket&#x7C7B;&#x578B;&#x8FDB;&#x884C;&#x63CF;&#x8FF0;&#x3002;&#x5982;&#x5728;&#x88F8;socket&#xFF08;SOCK_RAW&#xFF09;&#x4E2D;&#x4F1A;&#x5C06;protocol&#x6307;&#x5B9A;&#x4E3A;IPPROTO_RAW&#x3002;</p>
<p>socket()&#x5728;&#x6210;&#x529F;&#x65F6;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x5F15;&#x7528;&#x5728;&#x540E;&#x7EED;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x4E2D;&#x4F1A;&#x7528;&#x5230;&#x7684;&#x65B0;&#x521B;&#x5EFA;&#x7684;socket&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x3002;</p>
<p>&#x4ECE;&#x5185;&#x6838;2.6.27&#x5F00;&#x59CB;&#xFF0C;Linux&#x4E3A;type&#x53C2;&#x6570;&#x63D0;&#x4F9B;&#x4E86;&#x7B2C;&#x4E8C;&#x79CD;&#x7528;&#x9014;&#xFF0C;&#x5373;&#x5141;&#x8BB8;&#x4E24;&#x4E2A;&#x975E;&#x6807;&#x51C6;&#x7684;&#x6807;&#x8BB0;&#x4E0E;socket&#x7C7B;&#x578B;&#x53D6;OR&#x3002;SOCK_CLOEXEC&#x6807;&#x8BB0;&#x4F1A;&#x5BFC;&#x81F4;&#x5185;&#x6838;&#x4E3A;&#x65B0;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x542F;&#x7528;close-on-exec&#x6807;&#x8BB0;&#xFF08;FD_CLOEXEC&#xFF09;&#x3002;&#x8FD9;&#x4E2A;&#x6807;&#x8BB0;&#x4E4B;&#x6240;&#x4EE5;&#x6709;&#x7528;&#x7684;&#x539F;&#x56E0;&#x4E0E;open() O_CLOEXEC&#x6807;&#x8BB0;&#x6709;&#x7528;&#x7684;&#x539F;&#x56E0;&#x662F;&#x4E00;&#x6837;&#x7684;&#x3002;SOCK_NONBLOCK&#x6807;&#x8BB0;&#x5BFC;&#x81F4;&#x5185;&#x6838;&#x5728;&#x5E95;&#x5C42;&#x6253;&#x5F00;&#x7740;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x4E0A;&#x8BBE;&#x7F6E;O_NONBLOCK&#x6807;&#x8BB0;&#xFF0C;&#x8FD9;&#x6837;&#x540E;&#x9762;&#x5728;&#x8BE5;socket&#x4E0A;&#x53D1;&#x751F;&#x7684;I/O&#x64CD;&#x4F5C;&#x5C31;&#x53D8;&#x6210;&#x975E;&#x963B;&#x585E;&#x4E86;&#xFF0C;&#x4ECE;&#x800C;&#x65E0;&#x9700;&#x901A;&#x8FC7;&#x8C03;&#x7528;fcntl()&#x6765;&#x53D6;&#x5F97;&#x540C;&#x6837;&#x7684;&#x7ED3;&#x679C;&#x3002;</p>
<h2 id="&#x5C06;socket&#x7ED1;&#x5B9A;&#x5230;&#x5730;&#x5740;&#xFF1A;bind"><a href="#&#x5C06;socket&#x7ED1;&#x5B9A;&#x5230;&#x5730;&#x5740;&#xFF1A;bind" class="headerlink" title="&#x5C06;socket&#x7ED1;&#x5B9A;&#x5230;&#x5730;&#x5740;&#xFF1A;bind()"></a>&#x5C06;socket&#x7ED1;&#x5B9A;&#x5230;&#x5730;&#x5740;&#xFF1A;bind()</h2><p>bind()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5C06;&#x4E00;&#x4E2A;socket&#x7ED1;&#x5B9A;&#x5230;&#x4E00;&#x4E2A;&#x5730;&#x5740;&#x4E0A;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;sys/socket.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">int</span> sockfd<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">struct</span> sockaddr <span class="token operator">*</span>addr<span class="token punctuation">,</span> socklen_t addrlen<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>sockfd&#x53C2;&#x6570;&#x662F;&#x5728;&#x4E0A;&#x4E00;&#x4E2A;socket()&#x8C03;&#x7528;&#x4E2D;&#x83B7;&#x5F97;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x3002;addr&#x53C2;&#x6570;&#x662F;&#x4E00;&#x4E2A;&#x6307;&#x9488;&#xFF0C;&#x5B83;&#x6307;&#x5411;&#x4E86;&#x4E00;&#x4E2A;&#x6307;&#x5B9A;&#x8BE5;socket&#x7ED1;&#x5B9A;&#x5230;&#x7684;&#x5730;&#x5740;&#x7684;&#x7ED3;&#x6784;&#x3002;&#x4F20;&#x5165;&#x8FD9;&#x4E2A;&#x53C2;&#x6570;&#x7684;&#x7ED3;&#x6784;&#x7684;&#x7C7B;&#x578B;&#x53D6;&#x51B3;&#x4E8E;socket domain&#x3002;addrlen&#x53C2;&#x6570;&#x6307;&#x5B9A;&#x4E86;&#x5730;&#x5740;&#x7ED3;&#x6784;&#x7684;&#x5927;&#x5C0F;&#x3002;addrlen&#x53C2;&#x6570;&#x4F7F;&#x7528;&#x7684;socklen_t&#x6570;&#x636E;&#x7C7B;&#x578B;&#x5728;SUSv3&#x88AB;&#x89C4;&#x5B9A;&#x4E3A;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#x7C7B;&#x578B;&#x3002;</p>
<p>&#x4E00;&#x822C;&#x6765;&#x8BB2;&#xFF0C;&#x4F1A;&#x5C06;&#x4E00;&#x4E2A;&#x670D;&#x52A1;&#x5668;&#x7684;socket&#x7ED1;&#x5B9A;&#x5230;&#x4E00;&#x4E2A;&#x4F17;&#x6240;&#x5468;&#x77E5;&#x7684;&#x5730;&#x5740;&#x2014;&#x2014;&#x5373;&#x4E00;&#x4E2A;&#x56FA;&#x5B9A;&#x7684;&#x4E0E;&#x670D;&#x52A1;&#x5668;&#x8FDB;&#x884C;&#x901A;&#x4FE1;&#x7684;&#x5BA2;&#x6237;&#x7AEF;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x63D0;&#x524D;&#x5C31;&#x77E5;&#x9053;&#x7684;&#x5730;&#x5740;&#x3002;</p>
<p>&#x9664;&#x4E86;&#x5C06;&#x4E00;&#x4E2A;&#x670D;&#x52A1;&#x5668;&#x7684;socket&#x7ED1;&#x5B9A;&#x5230;&#x4E00;&#x4E2A;&#x4F17;&#x6240;&#x5468;&#x77E5;&#x7684;&#x5730;&#x5740;&#x4E4B;&#x5916;&#x8FD8;&#x5B58;&#x5728;&#x5176;&#x4ED6;&#x505A;&#x6CD5;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x5BF9;&#x4E8E;&#x4E00;&#x4E2A;Internet domain socket&#x6765;&#x8BB2;&#xFF0C;&#x670D;&#x52A1;&#x5668;&#x53EF;&#x4EE5;&#x4E0D;&#x8C03;&#x7528;bind()&#x800C;&#x76F4;&#x63A5;&#x8C03;&#x7528;listen()&#xFF0C;&#x8FD9;&#x5C06;&#x4F1A;&#x5BFC;&#x81F4;&#x5185;&#x6838;&#x4E3A;&#x8BE5;socket&#x9009;&#x62E9;&#x4E00;&#x4E2A;&#x4E34;&#x65F6;&#x7AEF;&#x53E3;&#x3002;&#x4E4B;&#x540E;&#x670D;&#x52A1;&#x5668;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;getsockname()&#x6765;&#x83B7;&#x53D6;socket&#x7684;&#x5730;&#x5740;&#x3002;&#x5728;&#x8FD9;&#x79CD;&#x573A;&#x666F;&#x4E2D;&#xFF0C;&#x670D;&#x52A1;&#x5668;&#x5FC5;&#x987B;&#x8981;&#x53D1;&#x5E03;&#x5176;&#x5730;&#x5740;&#x4F7F;&#x5F97;&#x5BA2;&#x6237;&#x7AEF;&#x80FD;&#x591F;&#x77E5;&#x9053;&#x5982;&#x4F55;&#x5B9A;&#x4F4D;&#x5230;&#x670D;&#x52A1;&#x5668;&#x7684;socket&#x3002;&#x8FD9;&#x79CD;&#x53D1;&#x5E03;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5411;&#x4E00;&#x4E2A;&#x4E2D;&#x5FC3;&#x76EE;&#x5F55;&#x670D;&#x52A1;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x6CE8;&#x518C;&#x670D;&#x52A1;&#x5668;&#x7684;&#x5730;&#x5740;&#x6765;&#x5B8C;&#x6210;&#xFF0C;&#x4E4B;&#x540E;&#x5BA2;&#x6237;&#x7AEF;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8FD9;&#x4E2A;&#x670D;&#x52A1;&#x6765;&#x83B7;&#x53D6;&#x670D;&#x52A1;&#x5668;&#x7684;&#x5730;&#x5740;&#x3002;&#xFF08;&#x5982;Sun RPC&#x4F7F;&#x7528;&#x4E86;&#x81EA;&#x5DF1;&#x7684;portmapper&#x670D;&#x52A1;&#x5668;&#x6765;&#x89E3;&#x51B3;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x3002;&#xFF09;&#x5F53;&#x7136;&#xFF0C;&#x76EE;&#x5F55;&#x670D;&#x52A1;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;socket&#x5FC5;&#x987B;&#x8981;&#x4F4D;&#x4E8E;&#x4E00;&#x4E2A;&#x4F17;&#x6240;&#x5468;&#x77E5;&#x7684;&#x5730;&#x5740;&#x4E0A;&#x3002;</p>
<h2 id="&#x901A;&#x7528;socket&#x5730;&#x5740;&#x7ED3;&#x6784;&#xFF1A;struct-sockaddr"><a href="#&#x901A;&#x7528;socket&#x5730;&#x5740;&#x7ED3;&#x6784;&#xFF1A;struct-sockaddr" class="headerlink" title="&#x901A;&#x7528;socket&#x5730;&#x5740;&#x7ED3;&#x6784;&#xFF1A;struct sockaddr"></a>&#x901A;&#x7528;socket&#x5730;&#x5740;&#x7ED3;&#x6784;&#xFF1A;struct sockaddr</h2><p>&#x4F20;&#x5165;bind()&#x7684;addr&#x548C;addrlen&#x53C2;&#x6570;&#x6BD4;&#x8F83;&#x590D;&#x6742;&#xFF0C;&#x6709;&#x5FC5;&#x8981;&#x5BF9;&#x5176;&#x505A;&#x8FDB;&#x4E00;&#x6B65;&#x89E3;&#x91CA;&#x3002;&#x4ECE;&#x8868;56-1&#x4E2D;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#x6BCF;&#x79CD;socket domain&#x90FD;&#x4F7F;&#x7528;&#x4E86;&#x4E0D;&#x540C;&#x7684;&#x5730;&#x5740;&#x683C;&#x5F0F;&#x3002;&#x5982;UNIX domain socket&#x4F7F;&#x7528;&#x8DEF;&#x5F84;&#x540D;&#xFF0C;&#x800C;Internet domain socket&#x4F7F;&#x7528;&#x4E86;IP&#x5730;&#x5740;&#x548C;&#x7AEF;&#x53E3;&#x53F7;&#x3002;&#x5BF9;&#x4E8E;&#x5404;&#x79CD;socket domain&#x90FD;&#x9700;&#x8981;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x4E0D;&#x540C;&#x7684;&#x7ED3;&#x6784;&#x7C7B;&#x578B;&#x6765;&#x5B58;&#x50A8;socket&#x5730;&#x5740;&#x3002;&#x7136;&#x800C;&#x7531;&#x4E8E;&#x8BF8;&#x5982;bind()&#x4E4B;&#x7C7B;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x9002;&#x7528;&#x4E8E;&#x6240;&#x6709;socket domain&#xFF0C;&#x56E0;&#x6B64;&#x5B83;&#x4EEC;&#x5FC5;&#x987B;&#x8981;&#x80FD;&#x591F;&#x63A5;&#x53D7;&#x4EFB;&#x610F;&#x7C7B;&#x578B;&#x7684;&#x5730;&#x5740;&#x7ED3;&#x6784;&#x3002;&#x4E3A;&#x652F;&#x6301;&#x8FD9;&#x79CD;&#x884C;&#x4E3A;&#xFF0C;socket API&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x4E2A;&#x901A;&#x7528;&#x7684;&#x5730;&#x5740;&#x7ED3;&#x6784;struct sockaddr&#x3002;&#x8FD9;&#x4E2A;&#x7C7B;&#x578B;&#x7684;&#x552F;&#x4E00;&#x7528;&#x9014;&#x662F;&#x5C06;&#x5404;&#x79CD;domain&#x7279;&#x5B9A;&#x7684;&#x5730;&#x5740;&#x7ED3;&#x6784;&#x8F6C;&#x6362;&#x6210;&#x5355;&#x4E2A;&#x7C7B;&#x578B;&#x4EE5;&#x4F9B;socket&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x4E2D;&#x7684;&#x5404;&#x4E2A;&#x53C2;&#x6570;&#x4F7F;&#x7528;&#x3002;sockaddr&#x7ED3;&#x6784;&#x901A;&#x5E38;&#x88AB;&#x5B9A;&#x4E49;&#x6210;&#x5982;&#x4E0B;&#x6240;&#x793A;&#x7684;&#x7ED3;&#x6784;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">struct</span> sockaddr <span class="token punctuation">{</span>
&#x3000;&#x3000;<span class="token keyword">unsigned</span> <span class="token keyword">short</span> sa_family<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* address family, AF_xxx */</span>
&#x3000;&#x3000;<span class="token keyword">char</span> sa_data<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* 14 bytes of protocol address */</span>&#x3000;&#x3000;
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x8FD9;&#x4E2A;&#x7ED3;&#x6784;&#x662F;&#x6240;&#x6709;domain&#x7279;&#x5B9A;&#x7684;&#x5730;&#x5740;&#x7ED3;&#x6784;&#x7684;&#x6A21;&#x677F;&#xFF0C;&#x5176;&#x4E2D;&#x6BCF;&#x4E2A;&#x5730;&#x5740;&#x7ED3;&#x6784;&#x5747;&#x4EE5;&#x4E0E;sockaddr&#x7ED3;&#x6784;&#x4E2D;sa_family&#x5B57;&#x6BB5;&#x5BF9;&#x5E94;&#x7684;family&#x5B57;&#x6BB5;&#x6253;&#x5934;&#x3002;&#xFF08;sa_family_t&#x6570;&#x636E;&#x7C7B;&#x578B;&#x5728;SUSv3&#x4E2D;&#x88AB;&#x89C4;&#x5B9A;&#x6210;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#x7C7B;&#x578B;&#x3002;&#xFF09;&#x901A;&#x8FC7;family&#x5B57;&#x6BB5;&#x7684;&#x503C;&#x8DB3;&#x4EE5;&#x786E;&#x5B9A;&#x5B58;&#x50A8;&#x5728;&#x8FD9;&#x4E2A;&#x7ED3;&#x6784;&#x7684;&#x5269;&#x4F59;&#x90E8;&#x5206;&#x4E2D;&#x7684;&#x5730;&#x5740;&#x7684;&#x5927;&#x5C0F;&#x548C;&#x683C;&#x5F0F;&#x4E86;&#x3002;</p>
<p>&#x4E00;&#x4E9B;UNIX&#x5B9E;&#x73B0;&#x8FD8;&#x5728;sockaddr&#x7ED3;&#x6784;&#x4E2D;&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x4E2A;&#x989D;&#x5916;&#x7684;&#x5B57;&#x6BB5;sa_len&#xFF0C;&#x5B83;&#x6307;&#x5B9A;&#x4E86;&#x8FD9;&#x4E2A;&#x7ED3;&#x6784;&#x7684;&#x603B;&#x5927;&#x5C0F;&#x3002;SUSv3&#x5E76;&#x6CA1;&#x6709;&#x8981;&#x6C42;&#x8FD9;&#x4E2A;&#x5B57;&#x6BB5;&#xFF0C;&#x5728;socket API&#x7684;Linux&#x5B9E;&#x73B0;&#x4E2D;&#x4E5F;&#x4E0D;&#x5B58;&#x5728;&#x8FD9;&#x4E2A;&#x5B57;&#x6BB5;&#x3002;</p>
<p>&#x5982;&#x679C;&#x5B9A;&#x4E49;&#x4E86;_GNU_SOURCE&#x7279;&#x6027;&#x6D4B;&#x8BD5;&#x5B8F;&#xFF0C;&#x90A3;&#x4E48;glibc&#x5C06;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;gcc&#x6269;&#x5C55;&#x5728;&lt;sys/socket.h&gt;&#x4E2D;&#x5B9A;&#x4E49;&#x5404;&#x4E2A;socket&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x7684;&#x539F;&#x578B;&#xFF0C;&#x4ECE;&#x800C;&#x5C31;&#x65E0;&#x9700;&#x8FDB;&#x884C;(struct sockaddr *)&#x8F6C;&#x6362;&#x4E86;&#xFF0C;&#x4F46;&#x4F9D;&#x8D56;&#x8FD9;&#x4E2A;&#x7279;&#x6027;&#x662F;&#x4E0D;&#x53EF;&#x79FB;&#x690D;&#x7684;&#xFF08;&#x5728;&#x5176;&#x4ED6;&#x7CFB;&#x7EDF;&#x4E0A;&#x5C06;&#x4F1A;&#x5BFC;&#x81F4;&#x7F16;&#x8BD1;&#x8B66;&#x544A;&#xFF09;&#x3002;</p>
<h2 id="&#x6D41;socket"><a href="#&#x6D41;socket" class="headerlink" title="&#x6D41;socket"></a>&#x6D41;socket</h2><p>&#x6D41;socket&#x7684;&#x8FD0;&#x4F5C;&#x4E0E;&#x7535;&#x8BDD;&#x7CFB;&#x7EDF;&#x7C7B;&#x4F3C;&#x3002;</p>
<p>1&#xFF0E; socket()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5C06;&#x4F1A;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;socket&#xFF0C;&#x8FD9;&#x7B49;&#x4EF7;&#x4E8E;&#x5B89;&#x88C5;&#x4E00;&#x4E2A;&#x7535;&#x8BDD;&#x3002;&#x4E3A;&#x4F7F;&#x4E24;&#x4E2A;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x80FD;&#x591F;&#x901A;&#x4FE1;&#xFF0C;&#x6BCF;&#x4E2A;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x90FD;&#x5FC5;&#x987B;&#x8981;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;socket&#x3002;</p>
<p>2&#xFF0E; &#x901A;&#x8FC7;&#x4E00;&#x4E2A;&#x6D41;socket&#x901A;&#x4FE1;&#x7C7B;&#x4F3C;&#x4E8E;&#x4E00;&#x4E2A;&#x7535;&#x8BDD;&#x547C;&#x53EB;&#x3002;&#x4E00;&#x4E2A;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5728;&#x8FDB;&#x884C;&#x901A;&#x4FE1;&#x4E4B;&#x524D;&#x5FC5;&#x987B;&#x8981;&#x5C06;&#x5176;socket&#x8FDE;&#x63A5;&#x5230;&#x53E6;&#x4E00;&#x4E2A;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;socket&#x4E0A;&#x3002;&#x4E24;&#x4E2A;socket&#x7684;&#x8FDE;&#x63A5;&#x8FC7;&#x7A0B;&#x5982;&#x4E0B;&#x3002;<br>(a)&#x4E00;&#x4E2A;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x8C03;&#x7528;bind()&#x4EE5;&#x5C06;socket&#x7ED1;&#x5B9A;&#x5230;&#x4E00;&#x4E2A;&#x4F17;&#x6240;&#x5468;&#x77E5;&#x7684;&#x5730;&#x5740;&#x4E0A;&#xFF0C;&#x7136;&#x540E;&#x8C03;&#x7528;listen()&#x901A;&#x77E5;&#x5185;&#x6838;&#x5B83;&#x63A5;&#x53D7;&#x63A5;&#x5165;&#x8FDE;&#x63A5;&#x7684;&#x610F;&#x613F;&#x3002;&#x8FD9;&#x4E00;&#x6B65;&#x7C7B;&#x4F3C;&#x4E8E;&#x5DF2;&#x7ECF;&#x6709;&#x4E86;&#x4E00;&#x4E2A;&#x4E3A;&#x4F17;&#x4EBA;&#x6240;&#x77E5;&#x7684;&#x7535;&#x8BDD;&#x53F7;&#x7801;&#x5E76;&#x786E;&#x4FDD;&#x6253;&#x5F00;&#x4E86;&#x7535;&#x8BDD;&#xFF0C;&#x8FD9;&#x6837;&#x4EBA;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x6253;&#x8FDB;&#x7535;&#x8BDD;&#x4E86;&#x3002;<br>(b)&#x5176;&#x4ED6;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x901A;&#x8FC7;&#x8C03;&#x7528;connect()&#x5EFA;&#x7ACB;&#x8FDE;&#x63A5;&#xFF0C;&#x540C;&#x65F6;&#x6307;&#x5B9A;&#x9700;&#x8FDE;&#x63A5;&#x7684;socket&#x7684;&#x5730;&#x5740;&#x3002;&#x8FD9;&#x7C7B;&#x4F3C;&#x4E8E;&#x62E8;&#x67D0;&#x4EBA;&#x7684;&#x7535;&#x8BDD;&#x53F7;&#x7801;&#x3002;<br>(c)&#x8C03;&#x7528;listen()&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4F7F;&#x7528;accept()&#x63A5;&#x53D7;&#x8FDE;&#x63A5;&#x3002;&#x8FD9;&#x7C7B;&#x4F3C;&#x4E8E;&#x5728;&#x7535;&#x8BDD;&#x54CD;&#x8D77;&#x65F6;&#x62FF;&#x8D77;&#x7535;&#x8BDD;&#x3002;&#x5982;&#x679C;&#x5728;&#x5BF9;&#x7B49;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x8C03;&#x7528;connect()&#x4E4B;&#x524D;&#x6267;&#x884C;&#x4E86;accept()&#xFF0C;&#x90A3;&#x4E48;accept()&#x5C31;&#x4F1A;&#x963B;&#x585E;&#xFF08;&#x201C;&#x7B49;&#x5F85;&#x7535;&#x8BDD;&#x201D;&#xFF09;&#x3002;</p>
<p>3&#xFF0E; &#x4E00;&#x65E6;&#x5EFA;&#x7ACB;&#x4E86;&#x4E00;&#x4E2A;&#x8FDE;&#x63A5;&#x4E4B;&#x540E;&#x5C31;&#x53EF;&#x4EE5;&#x5728;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E4B;&#x95F4;&#xFF08;&#x7C7B;&#x4F3C;&#x4E8E;&#x4E24;&#x8DEF;&#x7535;&#x8BDD;&#x4F1A;&#x8BDD;&#xFF09;&#x8FDB;&#x884C;&#x53CC;&#x5411;&#x6570;&#x636E;&#x4F20;&#x8F93;&#x76F4;&#x5230;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x4F7F;&#x7528;close()&#x5173;&#x95ED;&#x8FDE;&#x63A5;&#x4E3A;&#x6B62;&#x3002;&#x901A;&#x4FE1;&#x662F;&#x901A;&#x8FC7;&#x4F20;&#x7EDF;&#x7684;read()&#x548C;write()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x6216;&#x901A;&#x8FC7;&#x4E00;&#x4E9B;&#x63D0;&#x4F9B;&#x4E86;&#x989D;&#x5916;&#x529F;&#x80FD;&#x7684;socket&#x7279;&#x5B9A;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF08;&#x5982;send()&#x548C;recv()&#xFF09;&#x6765;&#x5B8C;&#x6210;&#x7684;&#x3002;<br></p><div class="amp-img-wrapper"><amp-img src="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1581843858579.png?x-oss-process=image/resize,m_lfit,h_450" width="398" height="450" layout="responsive"></amp-img></div>
<h3 id="&#x4E3B;&#x52A8;&#x548C;&#x88AB;&#x52A8;socket"><a href="#&#x4E3B;&#x52A8;&#x548C;&#x88AB;&#x52A8;socket" class="headerlink" title="&#x4E3B;&#x52A8;&#x548C;&#x88AB;&#x52A8;socket"></a>&#x4E3B;&#x52A8;&#x548C;&#x88AB;&#x52A8;socket</h3><p>&#x6D41;socket&#x901A;&#x5E38;&#x53EF;&#x4EE5;&#x5206;&#x4E3A;&#x4E3B;&#x52A8;&#x548C;&#x88AB;&#x52A8;&#x4E24;&#x79CD;&#x3002;</p>
<ul>
<li>&#x5728;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x4F7F;&#x7528;socket()&#x521B;&#x5EFA;&#x7684;socket&#x662F;&#x4E3B;&#x52A8;&#x7684;&#x3002;&#x4E00;&#x4E2A;&#x4E3B;&#x52A8;&#x7684;socket&#x53EF;&#x7528;&#x5728;connect()&#x8C03;&#x7528;&#x4E2D;&#x6765;&#x5EFA;&#x7ACB;&#x4E00;&#x4E2A;&#x5230;&#x4E00;&#x4E2A;&#x88AB;&#x52A8;socket&#x7684;&#x8FDE;&#x63A5;&#x3002;&#x8FD9;&#x79CD;&#x884C;&#x4E3A;&#x88AB;&#x79F0;&#x4E3A;&#x6267;&#x884C;&#x4E00;&#x4E2A;&#x4E3B;&#x52A8;&#x7684;&#x6253;&#x5F00;&#x3002;</li>
<li>&#x4E00;&#x4E2A;&#x88AB;&#x52A8;socket&#xFF08;&#x4E5F;&#x88AB;&#x79F0;&#x4E3A;&#x76D1;&#x542C;socket&#xFF09;&#x662F;&#x4E00;&#x4E2A;&#x901A;&#x8FC7;&#x8C03;&#x7528;listen()&#x4EE5;&#x88AB;&#x6807;&#x8BB0;&#x6210;&#x5141;&#x8BB8;&#x63A5;&#x5165;&#x8FDE;&#x63A5;&#x7684;socket&#x3002;&#x63A5;&#x53D7;&#x4E00;&#x4E2A;&#x63A5;&#x5165;&#x8FDE;&#x63A5;&#x901A;&#x5E38;&#x88AB;&#x79F0;&#x4E3A;&#x6267;&#x884C;&#x4E00;&#x4E2A;&#x88AB;&#x52A8;&#x7684;&#x6253;&#x5F00;&#x3002;</li>
</ul>
<p>&#x5728;&#x5927;&#x591A;&#x6570;&#x4F7F;&#x7528;&#x6D41;socket&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E2D;&#xFF0C;&#x670D;&#x52A1;&#x5668;&#x4F1A;&#x6267;&#x884C;&#x88AB;&#x52A8;&#x5F0F;&#x6253;&#x5F00;&#xFF0C;&#x800C;&#x5BA2;&#x6237;&#x7AEF;&#x4F1A;&#x6267;&#x884C;&#x4E3B;&#x52A8;&#x5F0F;&#x6253;&#x5F00;&#x3002;&#x5728;&#x540E;&#x9762;&#x7684;&#x5C0F;&#x8282;&#x4E2D;&#x5C06;&#x4F1A;&#x5047;&#x8BBE;&#x8FD9;&#x79CD;&#x573A;&#x666F;&#xFF0C;&#x56E0;&#x6B64;&#x4E0D;&#x4F1A;&#x518D;&#x8BF4;&#x201C;&#x6267;&#x884C;&#x4E3B;&#x52A8;socket&#x6253;&#x5F00;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x201D;&#xFF0C;&#x800C;&#x662F;&#x76F4;&#x63A5;&#x8BF4;&#x201C;&#x5BA2;&#x6237;&#x7AEF;&#x201D;&#x3002;&#x7C7B;&#x4F3C;&#x5730;&#xFF0C;&#x201C;&#x670D;&#x52A1;&#x5668;&#x201D;&#x7B49;&#x4EF7;&#x4E8E;&#x201C;&#x6267;&#x884C;&#x88AB;&#x52A8;socket&#x6253;&#x5F00;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x201D;&#x3002;</p>
<h3 id="&#x76D1;&#x542C;&#x63A5;&#x5165;&#x8FDE;&#x63A5;&#xFF1A;listen"><a href="#&#x76D1;&#x542C;&#x63A5;&#x5165;&#x8FDE;&#x63A5;&#xFF1A;listen" class="headerlink" title="&#x76D1;&#x542C;&#x63A5;&#x5165;&#x8FDE;&#x63A5;&#xFF1A;listen()"></a>&#x76D1;&#x542C;&#x63A5;&#x5165;&#x8FDE;&#x63A5;&#xFF1A;listen()</h3><p>listen()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5C06;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;sockfd&#x5F15;&#x7528;&#x7684;&#x6D41;socket&#x6807;&#x8BB0;&#x4E3A;&#x88AB;&#x52A8;&#x3002;&#x8FD9;&#x4E2A;socket&#x540E;&#x9762;&#x4F1A;&#x88AB;&#x7528;&#x6765;&#x63A5;&#x53D7;&#x6765;&#x81EA;&#x5176;&#x4ED6;&#xFF08;&#x4E3B;&#x52A8;&#x7684;&#xFF09;socket&#x7684;&#x8FDE;&#x63A5;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;sys/socket.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">listen</span><span class="token punctuation">(</span><span class="token keyword">int</span> sockfd<span class="token punctuation">,</span> <span class="token keyword">int</span> backlog<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>&#x65E0;&#x6CD5;&#x5728;&#x4E00;&#x4E2A;&#x5DF2;&#x8FDE;&#x63A5;&#x7684;socket&#xFF08;&#x5373;&#x5DF2;&#x7ECF;&#x6210;&#x529F;&#x6267;&#x884C;connect()&#x7684;socket&#x6216;&#x7531;accept()&#x8C03;&#x7528;&#x8FD4;&#x56DE;&#x7684;socket&#xFF09;&#x4E0A;&#x6267;&#x884C;listen()&#x3002;</p>
<p>&#x8981;&#x7406;&#x89E3;backlog&#x53C2;&#x6570;&#x7684;&#x7528;&#x9014;&#x9996;&#x5148;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x5230;&#x5BA2;&#x6237;&#x7AEF;&#x53EF;&#x80FD;&#x4F1A;&#x5728;&#x670D;&#x52A1;&#x5668;&#x8C03;&#x7528;accept()&#x4E4B;&#x524D;&#x8C03;&#x7528;connect()&#x3002;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x662F;&#x6709;&#x53EF;&#x80FD;&#x4F1A;&#x53D1;&#x751F;&#x7684;&#xFF0C;&#x5982;&#x670D;&#x52A1;&#x5668;&#x53EF;&#x80FD;&#x6B63;&#x5FD9;&#x4E8E;&#x5904;&#x7406;&#x5176;&#x4ED6;&#x5BA2;&#x6237;&#x7AEF;&#x3002;&#x8FD9;&#x5C06;&#x4F1A;&#x4EA7;&#x751F;&#x4E00;&#x4E2A;&#x672A;&#x51B3;&#x7684;&#x8FDE;&#x63A5;&#x3002;<br></p><div class="amp-img-wrapper"><amp-img src="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1581844149493.png?x-oss-process=image/resize,m_lfit,h_450" width="556" height="450" layout="responsive"></amp-img></div><br>&#x5185;&#x6838;&#x5FC5;&#x987B;&#x8981;&#x8BB0;&#x5F55;&#x6240;&#x6709;&#x672A;&#x51B3;&#x7684;&#x8FDE;&#x63A5;&#x8BF7;&#x6C42;&#x7684;&#x76F8;&#x5173;&#x4FE1;&#x606F;&#xFF0C;&#x8FD9;&#x6837;&#x540E;&#x7EED;&#x7684;accept()&#x5C31;&#x80FD;&#x591F;&#x5904;&#x7406;&#x8FD9;&#x4E9B;&#x8BF7;&#x6C42;&#x4E86;&#x3002;backlog&#x53C2;&#x6570;&#x5141;&#x8BB8;&#x9650;&#x5236;&#x8FD9;&#x79CD;&#x672A;&#x51B3;&#x8FDE;&#x63A5;&#x7684;&#x6570;&#x91CF;&#x3002;&#x5728;&#x8FD9;&#x4E2A;&#x9650;&#x5236;&#x4E4B;&#x5185;&#x7684;&#x8FDE;&#x63A5;&#x8BF7;&#x6C42;&#x4F1A;&#x7ACB;&#x5373;&#x6210;&#x529F;&#x3002;&#xFF08;&#x5BF9;&#x4E8E;TCP socket&#x6765;&#x8BB2;&#x4E8B;&#x60C5;&#x5C31;&#x7A0D;&#x5FAE;&#x6709;&#x70B9;&#x590D;&#x6742;&#x4E86;&#x3002;&#xFF09;&#x4E4B;&#x5916;&#x7684;&#x8FDE;&#x63A5;&#x8BF7;&#x6C42;&#x5C31;&#x4F1A;&#x963B;&#x585E;&#x76F4;&#x5230;&#x4E00;&#x4E2A;&#x672A;&#x51B3;&#x7684;&#x8FDE;&#x63A5;&#x88AB;&#x63A5;&#x53D7;&#xFF08;&#x901A;&#x8FC7;accept()&#xFF09;&#xFF0C;&#x5E76;&#x4ECE;&#x672A;&#x51B3;&#x8FDE;&#x63A5;&#x961F;&#x5217;&#x5220;&#x9664;&#x4E3A;&#x6B62;&#x3002;
<p>SUSv3&#x5141;&#x8BB8;&#x4E00;&#x4E2A;&#x5B9E;&#x73B0;&#x4E3A;backlog&#x7684;&#x53EF;&#x53D6;&#x503C;&#x89C4;&#x5B9A;&#x4E00;&#x4E2A;&#x4E0A;&#x9650;&#x5E76;&#x5141;&#x8BB8;&#x4E00;&#x4E2A;&#x5B9E;&#x73B0;&#x9759;&#x9ED8;&#x5730;&#x5C06;backlog&#x503C;&#x5411;&#x4E0B;&#x820D;&#x5165;&#x5230;&#x8FD9;&#x4E2A;&#x9650;&#x5236;&#x503C;&#x3002;SUSv3&#x89C4;&#x5B9A;&#x5B9E;&#x73B0;&#x5E94;&#x8BE5;&#x901A;&#x8FC7;&#x5728;&lt;sys/socket.h&gt;&#x4E2D;&#x5B9A;&#x4E49;SOMAXCONN&#x5E38;&#x91CF;&#x6765;&#x53D1;&#x5E03;&#x8FD9;&#x4E2A;&#x9650;&#x5236;&#x3002;&#x5728;Linux&#x4E0A;&#xFF0C;&#x8FD9;&#x4E2A;&#x5E38;&#x91CF;&#x7684;&#x503C;&#x88AB;&#x5B9A;&#x4E49;&#x6210;&#x4E86;128&#x3002;&#x4F46;&#x4ECE;&#x5185;&#x6838;2.4.25&#x8D77;&#xFF0C;Linux&#x5141;&#x8BB8;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x901A;&#x8FC7;Linux&#x7279;&#x6709;&#x7684;/proc/sys/net/core/somaxconn&#x6587;&#x4EF6;&#x6765;&#x8C03;&#x6574;&#x8FD9;&#x4E2A;&#x9650;&#x5236;&#x3002;&#xFF08;&#x5728;&#x65E9;&#x671F;&#x7684;&#x5185;&#x6838;&#x7248;&#x672C;&#x4E2D;&#xFF0C;SOMAXCONN&#x9650;&#x5236;&#x662F;&#x4E0D;&#x53EF;&#x53D8;&#x7684;&#x3002;&#xFF09;</p>
<p>&#x5728;&#x6700;&#x521D;&#x7684;BSD socket&#x5B9E;&#x73B0;&#x4E2D;&#xFF0C;backlog&#x7684;&#x4E0A;&#x9650;&#x662F;5&#xFF0C;&#x5E76;&#x4E14;&#x5728;&#x8F83;&#x65E9;&#x7684;&#x4EE3;&#x7801;&#x4E2D;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x8FD9;&#x4E2A;&#x6570;&#x503C;&#x3002;&#x6240;&#x6709;&#x73B0;&#x4EE3;&#x5B9E;&#x73B0;&#x5141;&#x8BB8;&#x4E3A;backlog&#x6307;&#x5B9A;&#x66F4;&#x9AD8;&#x7684;&#x503C;&#xFF0C;&#x8FD9;&#x5BF9;&#x4E8E;&#x4F7F;&#x7528;TCP socket&#x670D;&#x52A1;&#x5927;&#x91CF;&#x5BA2;&#x6237;&#x7684;&#x7F51;&#x7EDC;&#x670D;&#x52A1;&#x5668;&#x6765;&#x8BB2;&#x662F;&#x6709;&#x5FC5;&#x8981;&#x7684;&#x3002;</p>
<h3 id="&#x63A5;&#x53D7;&#x8FDE;&#x63A5;&#xFF1A;accept"><a href="#&#x63A5;&#x53D7;&#x8FDE;&#x63A5;&#xFF1A;accept" class="headerlink" title="&#x63A5;&#x53D7;&#x8FDE;&#x63A5;&#xFF1A;accept()"></a>&#x63A5;&#x53D7;&#x8FDE;&#x63A5;&#xFF1A;accept()</h3><p>&#x7406;&#x89E3;accept()&#x7684;&#x5173;&#x952E;&#x70B9;&#x662F;&#x5B83;&#x4F1A;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;socket&#xFF0C;&#x5E76;&#x4E14;&#x6B63;&#x662F;&#x8FD9;&#x4E2A;&#x65B0;socket&#x4F1A;&#x4E0E;&#x6267;&#x884C;connect()&#x7684;&#x5BF9;&#x7B49;socket&#x8FDB;&#x884C;&#x8FDE;&#x63A5;&#x3002;accept()&#x8C03;&#x7528;&#x8FD4;&#x56DE;&#x7684;&#x51FD;&#x6570;&#x7ED3;&#x679C;&#x662F;&#x5DF2;&#x8FDE;&#x63A5;&#x7684;socket&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x3002;&#x76D1;&#x542C;socket&#xFF08;sockfd&#xFF09;&#x4F1A;&#x4FDD;&#x6301;&#x6253;&#x5F00;&#x72B6;&#x6001;&#xFF0C;&#x5E76;&#x4E14;&#x53EF;&#x4EE5;&#x88AB;&#x7528;&#x6765;&#x63A5;&#x53D7;&#x540E;&#x7EED;&#x7684;&#x8FDE;&#x63A5;&#x3002;&#x4E00;&#x4E2A;&#x5178;&#x578B;&#x7684;&#x670D;&#x52A1;&#x5668;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4F1A;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x76D1;&#x542C;socket&#xFF0C;&#x5C06;&#x5176;&#x7ED1;&#x5B9A;&#x5230;&#x4E00;&#x4E2A;&#x4F17;&#x6240;&#x5468;&#x77E5;&#x7684;&#x5730;&#x5740;&#x4E0A;&#xFF0C;&#x7136;&#x540E;&#x901A;&#x8FC7;&#x63A5;&#x53D7;&#x8BE5;socket&#x4E0A;&#x7684;&#x8FDE;&#x63A5;&#x6765;&#x5904;&#x7406;&#x6240;&#x6709;&#x5BA2;&#x6237;&#x7AEF;&#x7684;&#x8BF7;&#x6C42;&#x3002;</p>
<p>&#x4F20;&#x5165;accept()&#x7684;&#x5269;&#x4F59;&#x53C2;&#x6570;&#x4F1A;&#x8FD4;&#x56DE;&#x5BF9;&#x7AEF;socket&#x7684;&#x5730;&#x5740;&#x3002;addr&#x53C2;&#x6570;&#x6307;&#x5411;&#x4E86;&#x4E00;&#x4E2A;&#x7528;&#x6765;&#x8FD4;&#x56DE;socket&#x5730;&#x5740;&#x7684;&#x7ED3;&#x6784;&#x3002;&#x8FD9;&#x4E2A;&#x53C2;&#x6570;&#x7684;&#x7C7B;&#x578B;&#x53D6;&#x51B3;&#x4E8E;socket domain&#xFF08;&#x4E0E;bind()&#x4E00;&#x6837;&#xFF09;&#x3002;</p>
<p>addrlen&#x53C2;&#x6570;&#x662F;&#x4E00;&#x4E2A;&#x503C;-&#x7ED3;&#x679C;&#x53C2;&#x6570;&#x3002;&#x5B83;&#x6307;&#x5411;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#xFF0C;&#x5728;&#x8C03;&#x7528;&#x88AB;&#x6267;&#x884C;&#x4E4B;&#x524D;&#x5FC5;&#x987B;&#x8981;&#x5C06;&#x8FD9;&#x4E2A;&#x6574;&#x6570;&#x521D;&#x59CB;&#x5316;&#x4E3A;addr&#x6307;&#x5411;&#x7684;&#x7F13;&#x51B2;&#x533A;&#x7684;&#x5927;&#x5C0F;&#xFF0C;&#x8FD9;&#x6837;&#x5185;&#x6838;&#x5C31;&#x77E5;&#x9053;&#x6709;&#x591A;&#x5C11;&#x7A7A;&#x95F4;&#x53EF;&#x7528;&#x4E8E;&#x8FD4;&#x56DE;socket&#x5730;&#x5740;&#x4E86;&#x3002;&#x5F53;accept()&#x8FD4;&#x56DE;&#x4E4B;&#x540E;&#xFF0C;&#x8FD9;&#x4E2A;&#x6574;&#x6570;&#x4F1A;&#x88AB;&#x8BBE;&#x7F6E;&#x6210;&#x5B9E;&#x9645;&#x88AB;&#x590D;&#x5236;&#x8FDB;&#x7F13;&#x51B2;&#x533A;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x7684;&#x5B57;&#x8282;&#x6570;&#x3002;</p>
<p>&#x5982;&#x679C;&#x4E0D;&#x5173;&#x5FC3;&#x5BF9;&#x7B49;socket&#x7684;&#x5730;&#x5740;&#xFF0C;&#x90A3;&#x4E48;&#x53EF;&#x4EE5;&#x5C06;addr&#x548C;addrlen&#x5206;&#x522B;&#x6307;&#x5B9A;&#x4E3A;NULL&#x548C;0&#x3002;</p>
<p>&#x4ECE;&#x5185;&#x6838;2.6.28&#x5F00;&#x59CB;&#xFF0C;Linux&#x652F;&#x6301;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x975E;&#x6807;&#x51C6;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;accept4()&#x3002;&#x8FD9;&#x4E2A;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x6267;&#x884C;&#x7684;&#x4EFB;&#x52A1;&#x4E0E;accept()&#x76F8;&#x540C;&#xFF0C;&#x4F46;&#x652F;&#x6301;&#x4E00;&#x4E2A;&#x989D;&#x5916;&#x7684;&#x53C2;&#x6570;flags&#xFF0C;&#x800C;&#x8FD9;&#x4E2A;&#x53C2;&#x6570;&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x6539;&#x53D8;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x7684;&#x884C;&#x4E3A;&#x3002;&#x76EE;&#x524D;&#x7CFB;&#x7EDF;&#x652F;&#x6301;&#x4E24;&#x4E2A;&#x6807;&#x8BB0;&#xFF1A;SOCK_CLOEXEC&#x548C;SOCK_NONBLOCK&#x3002;SOCK_CLOEXEC&#x6807;&#x8BB0;&#x5BFC;&#x81F4;&#x5185;&#x6838;&#x5728;&#x8C03;&#x7528;&#x8FD4;&#x56DE;&#x7684;&#x65B0;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x4E0A;&#x542F;&#x7528;close-on-exec&#x6807;&#x8BB0;&#xFF08;FD_CLOEXEC&#xFF09;&#x3002;&#x8FD9;&#x4E2A;&#x6807;&#x8BB0;&#x4E4B;&#x6240;&#x4EE5;&#x6709;&#x7528;&#x7684;&#x539F;&#x56E0;&#x4E0E;4.3.1&#x8282;&#x4E2D;&#x63CF;&#x8FF0;&#x7684;open() O_CLOEXEC&#x6807;&#x8BB0;&#x6709;&#x7528;&#x7684;&#x539F;&#x56E0;&#x662F;&#x4E00;&#x6837;&#x7684;&#x3002;SOCK_NONBLOCK&#x6807;&#x8BB0;&#x5BFC;&#x81F4;&#x5185;&#x6838;&#x5728;&#x5E95;&#x5C42;&#x6253;&#x5F00;&#x7740;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x4E0A;&#x542F;&#x7528;O_NONBLOCK&#x6807;&#x8BB0;&#xFF0C;&#x8FD9;&#x6837;&#x5728;&#x8BE5;socket&#x4E0A;&#x53D1;&#x751F;&#x7684;&#x540E;&#x7EED;I/O&#x64CD;&#x4F5C;&#x5C06;&#x4F1A;&#x53D8;&#x6210;&#x975E;&#x963B;&#x585E;&#x4E86;&#xFF0C;&#x4ECE;&#x800C;&#x65E0;&#x9700;&#x901A;&#x8FC7;&#x8C03;&#x7528;fcntl()&#x6765;&#x53D6;&#x5F97;&#x540C;&#x6837;&#x7684;&#x7ED3;&#x679C;&#x3002;</p>
<h3 id="&#x8FDE;&#x63A5;&#x5230;&#x5BF9;&#x7B49;socket&#xFF1A;connect"><a href="#&#x8FDE;&#x63A5;&#x5230;&#x5BF9;&#x7B49;socket&#xFF1A;connect" class="headerlink" title="&#x8FDE;&#x63A5;&#x5230;&#x5BF9;&#x7B49;socket&#xFF1A;connect()"></a>&#x8FDE;&#x63A5;&#x5230;&#x5BF9;&#x7B49;socket&#xFF1A;connect()</h3><p>connect()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5C06;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;sockfd&#x5F15;&#x7528;&#x7684;&#x4E3B;&#x52A8;socket&#x8FDE;&#x63A5;&#x5230;&#x5730;&#x5740;&#x901A;&#x8FC7;addr&#x548C;addrlen&#x6307;&#x5B9A;&#x7684;&#x76D1;&#x542C;socket&#x4E0A;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;sys/socket.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token keyword">int</span> sockfd<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">struct</span> sockaddr <span class="token operator">*</span>addr<span class="token punctuation">,</span> socklen_t addrlen<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>addr&#x548C;addrlen&#x53C2;&#x6570;&#x7684;&#x6307;&#x5B9A;&#x65B9;&#x5F0F;&#x4E0E;bind()&#x8C03;&#x7528;&#x4E2D;&#x5BF9;&#x5E94;&#x53C2;&#x6570;&#x7684;&#x6307;&#x5B9A;&#x65B9;&#x5F0F;&#x76F8;&#x540C;&#x3002;</p>
<p>&#x5982;&#x679C;connect()&#x5931;&#x8D25;&#x5E76;&#x4E14;&#x5E0C;&#x671B;&#x91CD;&#x65B0;&#x8FDB;&#x884C;&#x8FDE;&#x63A5;&#xFF0C;&#x90A3;&#x4E48;SUSv3&#x89C4;&#x5B9A;&#x5B8C;&#x6210;&#x8FD9;&#x4E2A;&#x4EFB;&#x52A1;&#x7684;&#x53EF;&#x79FB;&#x690D;&#x7684;&#x65B9;&#x6CD5;&#x662F;&#x5173;&#x95ED;&#x8FD9;&#x4E2A;socket&#xFF0C;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;socket&#xFF0C;&#x5728;&#x8BE5;&#x65B0;socket&#x4E0A;&#x91CD;&#x65B0;&#x8FDB;&#x884C;&#x8FDE;&#x63A5;&#x3002;</p>
<h3 id="&#x6D41;socket-I-O"><a href="#&#x6D41;socket-I-O" class="headerlink" title="&#x6D41;socket I/O"></a>&#x6D41;socket I/O</h3><p>&#x4E00;&#x5BF9;&#x8FDE;&#x63A5;&#x7684;&#x6D41;socket&#x5728;&#x4E24;&#x4E2A;&#x7AEF;&#x70B9;&#x4E4B;&#x95F4;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x53CC;&#x5411;&#x901A;&#x4FE1;&#x4FE1;&#x9053;&#x3002;&#x8FDE;&#x63A5;&#x6D41;socket&#x4E0A;I/O&#x7684;&#x8BED;&#x4E49;&#x4E0E;&#x7BA1;&#x9053;&#x4E0A;I/O&#x7684;&#x8BED;&#x4E49;&#x7C7B;&#x4F3C;&#x3002;</p>
<p>&#x8981;&#x6267;&#x884C;I/O&#x9700;&#x8981;&#x4F7F;&#x7528;read()&#x548C;write()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF08;&#x6216;&#x5728;61.3&#x8282;&#x4E2D;&#x63CF;&#x8FF0;&#x7684;socket&#x7279;&#x6709;&#x7684;send()&#x548C;recv()&#x8C03;&#x7528;&#xFF09;&#x3002;&#x7531;&#x4E8E;socket&#x662F;&#x53CC;&#x5411;&#x7684;&#xFF0C;&#x56E0;&#x6B64;&#x5728;&#x8FDE;&#x63A5;&#x7684;&#x4E24;&#x7AEF;&#x90FD;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x8FD9;&#x4E24;&#x4E2A;&#x8C03;&#x7528;&#x3002;<br>&#x4E00;&#x4E2A;socket&#x53EF;&#x4EE5;&#x4F7F;&#x7528;close()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x6765;&#x5173;&#x95ED;&#x6216;&#x5728;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7EC8;&#x6B62;&#x4E4B;&#x540E;&#x5173;&#x95ED;&#x3002;&#x4E4B;&#x540E;&#x5F53;&#x5BF9;&#x7B49;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x8BD5;&#x56FE;&#x4ECE;&#x8FDE;&#x63A5;&#x7684;&#x53E6;&#x4E00;&#x7AEF;&#x8BFB;&#x53D6;&#x6570;&#x636E;&#x65F6;&#x5C06;&#x4F1A;&#x6536;&#x5230;&#x6587;&#x4EF6;&#x7ED3;&#x675F;&#xFF08;&#x5F53;&#x6240;&#x6709;&#x7F13;&#x51B2;&#x6570;&#x636E;&#x90FD;&#x88AB;&#x8BFB;&#x53D6;&#x4E4B;&#x540E;&#xFF09;&#x3002;&#x5982;&#x679C;&#x5BF9;&#x7B49;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x8BD5;&#x56FE;&#x5411;&#x5176;socket&#x5199;&#x5165;&#x6570;&#x636E;&#xFF0C;&#x90A3;&#x4E48;&#x5B83;&#x5C31;&#x4F1A;&#x6536;&#x5230;&#x4E00;&#x4E2A;SIGPIPE&#x4FE1;&#x53F7;&#xFF0C;&#x5E76;&#x4E14;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x4F1A;&#x8FD4;&#x56DE;EPIPE&#x9519;&#x8BEF;&#x5904;&#x7406;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x7684;&#x5E38;&#x89C1;&#x65B9;&#x5F0F;&#x662F;&#x5FFD;&#x7565;SIGPIPE&#x4FE1;&#x53F7;&#x5E76;&#x901A;&#x8FC7;EPIPE&#x9519;&#x8BEF;&#x627E;&#x51FA;&#x88AB;&#x5173;&#x95ED;&#x7684;&#x8FDE;&#x63A5;&#x3002;</p>
<h3 id="&#x8FDE;&#x63A5;&#x7EC8;&#x6B62;&#xFF1A;close"><a href="#&#x8FDE;&#x63A5;&#x7EC8;&#x6B62;&#xFF1A;close" class="headerlink" title="&#x8FDE;&#x63A5;&#x7EC8;&#x6B62;&#xFF1A;close()"></a>&#x8FDE;&#x63A5;&#x7EC8;&#x6B62;&#xFF1A;close()</h3><p>&#x7EC8;&#x6B62;&#x4E00;&#x4E2A;&#x6D41;socket&#x8FDE;&#x63A5;&#x7684;&#x5E38;&#x89C1;&#x65B9;&#x5F0F;&#x662F;&#x8C03;&#x7528;close()&#x3002;&#x5982;&#x679C;&#x591A;&#x4E2A;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x5F15;&#x7528;&#x4E86;&#x540C;&#x4E00;&#x4E2A;socket&#xFF0C;&#x90A3;&#x4E48;&#x5F53;&#x6240;&#x6709;&#x63CF;&#x8FF0;&#x7B26;&#x88AB;&#x5173;&#x95ED;&#x4E4B;&#x540E;&#x8FDE;&#x63A5;&#x5C31;&#x4F1A;&#x7EC8;&#x6B62;&#x3002;</p>
<p>&#x5047;&#x8BBE;&#x5728;&#x5173;&#x95ED;&#x4E00;&#x4E2A;&#x8FDE;&#x63A5;&#x4E4B;&#x540E;&#xFF0C;&#x5BF9;&#x7B49;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5D29;&#x6E83;&#x6216;&#x6CA1;&#x6709;&#x8BFB;&#x53D6;&#x6216;&#x9519;&#x8BEF;&#x5904;&#x7406;&#x4E86;&#x4E4B;&#x524D;&#x53D1;&#x9001;&#x7ED9;&#x5B83;&#x7684;&#x6570;&#x636E;&#x3002;&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#x5C31;&#x65E0;&#x6CD5;&#x77E5;&#x9053;&#x5DF2;&#x7ECF;&#x53D1;&#x751F;&#x4E86;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#x3002;&#x5982;&#x679C;&#x9700;&#x8981;&#x786E;&#x4FDD;&#x6570;&#x636E;&#x88AB;&#x6210;&#x529F;&#x5730;&#x8BFB;&#x53D6;&#x548C;&#x5904;&#x7406;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x5FC5;&#x987B;&#x8981;&#x5728;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E2D;&#x6784;&#x5EFA;&#x67D0;&#x79CD;&#x786E;&#x8BA4;&#x534F;&#x8BAE;&#x3002;&#x8FD9;&#x901A;&#x5E38;&#x7531;&#x4E00;&#x4E2A;&#x4ECE;&#x5BF9;&#x7B49;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4F20;&#x8FC7;&#x6765;&#x7684;&#x663E;&#x5F0F;&#x7684;&#x786E;&#x8BA4;&#x6D88;&#x606F;&#x6784;&#x6210;&#x3002;</p>
<p>shutdown()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF0C;&#x5B83;&#x4E3A;&#x5982;&#x4F55;&#x5173;&#x95ED;&#x4E00;&#x4E2A;&#x6D41;socket&#x8FDE;&#x63A5;&#x63D0;&#x4F9B;&#x4E86;&#x66F4;&#x52A0;&#x7CBE;&#x7EC6;&#x7684;&#x63A7;&#x5236;&#x3002;</p>
<h2 id="&#x6570;&#x636E;&#x62A5;socket"><a href="#&#x6570;&#x636E;&#x62A5;socket" class="headerlink" title="&#x6570;&#x636E;&#x62A5;socket"></a>&#x6570;&#x636E;&#x62A5;socket</h2><p>&#x6570;&#x636E;&#x62A5;socket&#x7684;&#x8FD0;&#x4F5C;&#x7C7B;&#x4F3C;&#x4E8E;&#x90AE;&#x653F;&#x7CFB;&#x7EDF;&#x3002;</p>
<p>1&#xFF0E; socket()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x7B49;&#x4EF7;&#x4E8E;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x90AE;&#x7BB1;&#x3002;&#xFF08;&#x8FD9;&#x91CC;&#x5047;&#x8BBE;&#x4E00;&#x4E2A;&#x7CFB;&#x7EDF;&#x4E0E;&#x4E00;&#x4E9B;&#x56FD;&#x5BB6;&#x7684;&#x519C;&#x6751;&#x4E2D;&#x7684;&#x90AE;&#x653F;&#x670D;&#x52A1;&#x7C7B;&#x4F3C;&#xFF0C;&#x53D6;&#x4FE1;&#x548C;&#x9001;&#x4FE1;&#x90FD;&#x662F;&#x5728;&#x90AE;&#x7BB1;&#x4E2D;&#x53D1;&#x751F;&#x7684;&#x3002;&#xFF09;&#x6240;&#x6709;&#x9700;&#x8981;&#x53D1;&#x9001;&#x548C;&#x63A5;&#x6536;&#x6570;&#x636E;&#x62A5;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x90FD;&#x9700;&#x8981;&#x4F7F;&#x7528;socket()&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x62A5;socket&#x3002;</p>
<p>2&#xFF0E; &#x4E3A;&#x5141;&#x8BB8;&#x53E6;&#x4E00;&#x4E2A;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x53D1;&#x9001;&#x5176;&#x6570;&#x636E;&#x62A5;&#xFF08;&#x4FE1;&#xFF09;&#xFF0C;&#x4E00;&#x4E2A;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x9700;&#x8981;&#x4F7F;&#x7528;bind()&#x5C06;&#x5176;socket&#x7ED1;&#x5B9A;&#x5230;&#x4E00;&#x4E2A;&#x4F17;&#x6240;&#x5468;&#x77E5;&#x7684;&#x5730;&#x5740;&#x4E0A;&#x3002;&#x4E00;&#x822C;&#x6765;&#x8BB2;&#xFF0C;&#x4E00;&#x4E2A;&#x670D;&#x52A1;&#x5668;&#x4F1A;&#x5C06;&#x5176;socket&#x7ED1;&#x5B9A;&#x5230;&#x4E00;&#x4E2A;&#x4F17;&#x6240;&#x5468;&#x77E5;&#x7684;&#x5730;&#x5740;&#x4E0A;&#xFF0C;&#x800C;&#x4E00;&#x4E2A;&#x5BA2;&#x6237;&#x7AEF;&#x4F1A;&#x901A;&#x8FC7;&#x5411;&#x8BE5;&#x5730;&#x5740;&#x53D1;&#x9001;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x62A5;&#x6765;&#x53D1;&#x8D77;&#x901A;&#x4FE1;&#x3002;&#xFF08;&#x5728;&#x4E00;&#x4E9B;domain&#x4E2D;&#x2014;&#x2014;&#x7279;&#x522B;&#x662F;UNIX domain&#x2014;&#x2014;&#x5BA2;&#x6237;&#x7AEF;&#x5982;&#x679C;&#x60F3;&#x8981;&#x63A5;&#x53D7;&#x670D;&#x52A1;&#x5668;&#x53D1;&#x9001;&#x6765;&#x7684;&#x6570;&#x636E;&#x62A5;&#x7684;&#x8BDD;&#x53EF;&#x80FD;&#x8FD8;&#x9700;&#x8981;&#x4F7F;&#x7528;bind()&#x5C06;&#x4E00;&#x4E2A;&#x5730;&#x5740;&#x8D4B;&#x7ED9;&#x5176;socket&#x3002;&#xFF09;</p>
<p>3&#xFF0E; &#x8981;&#x53D1;&#x9001;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x62A5;&#xFF0C;&#x4E00;&#x4E2A;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x9700;&#x8981;&#x8C03;&#x7528;sendto()&#xFF0C;&#x5B83;&#x63A5;&#x6536;&#x7684;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x662F;&#x6570;&#x636E;&#x62A5;&#x53D1;&#x9001;&#x5230;&#x7684;socket&#x7684;&#x5730;&#x5740;&#x3002;&#x8FD9;&#x7C7B;&#x4F3C;&#x4E8E;&#x5C06;&#x6536;&#x4FE1;&#x4EBA;&#x7684;&#x5730;&#x5740;&#x5199;&#x5230;&#x4FE1;&#x4EF6;&#x4E0A;&#x5E76;&#x6295;&#x9012;&#x8FD9;&#x5C01;&#x4FE1;&#x3002;</p>
<p>4&#xFF0E; &#x4E3A;&#x63A5;&#x6536;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x62A5;&#xFF0C;&#x4E00;&#x4E2A;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x9700;&#x8981;&#x8C03;&#x7528;recvfrom()&#xFF0C;&#x5B83;&#x5728;&#x6CA1;&#x6709;&#x6570;&#x636E;&#x62A5;&#x5230;&#x8FBE;&#x65F6;&#x4F1A;&#x963B;&#x585E;&#x3002;&#x7531;&#x4E8E;recvfrom()&#x5141;&#x8BB8;&#x83B7;&#x53D6;&#x53D1;&#x9001;&#x8005;&#x7684;&#x5730;&#x5740;&#xFF0C;&#x56E0;&#x6B64;&#x53EF;&#x4EE5;&#x5728;&#x9700;&#x8981;&#x7684;&#x65F6;&#x5019;&#x53D1;&#x9001;&#x4E00;&#x4E2A;&#x54CD;&#x5E94;&#x3002;&#xFF08;&#x8FD9;&#x5728;&#x53D1;&#x9001;&#x8005;&#x7684;socket&#x6CA1;&#x6709;&#x7ED1;&#x5B9A;&#x5230;&#x4E00;&#x4E2A;&#x4F17;&#x6240;&#x5468;&#x77E5;&#x7684;&#x5730;&#x5740;&#x4E0A;&#x65F6;&#x662F;&#x6709;&#x7528;&#x7684;&#xFF0C;&#x5BA2;&#x6237;&#x7AEF;&#x901A;&#x5E38;&#x662F;&#x4F1A;&#x78B0;&#x5230;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x3002;&#xFF09;&#x8FD9;&#x91CC;&#x5BF9;&#x8FD9;&#x4E2A;&#x6BD4;&#x55BB;&#x505A;&#x4E86;&#x4E00;&#x70B9;&#x5EF6;&#x4F38;&#xFF0C;&#x56E0;&#x4E3A;&#x5DF2;&#x6295;&#x9012;&#x7684;&#x4FE1;&#x4EF6;&#x4E0A;&#x662F;&#x65E0;&#x9700;&#x6807;&#x8BB0;&#x4E0A;&#x53D1;&#x9001;&#x8005;&#x7684;&#x5730;&#x5740;&#x7684;&#x3002;</p>
<p>5&#xFF0E; &#x5F53;&#x4E0D;&#x518D;&#x9700;&#x8981;socket&#x65F6;&#xFF0C;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x9700;&#x8981;&#x4F7F;&#x7528;close()&#x5173;&#x95ED;socket&#x3002;</p>
<p>&#x4E0E;&#x90AE;&#x653F;&#x7CFB;&#x7EDF;&#x4E00;&#x6837;&#xFF0C;&#x5F53;&#x4ECE;&#x4E00;&#x4E2A;&#x5730;&#x5740;&#x5411;&#x53E6;&#x4E00;&#x4E2A;&#x5730;&#x5740;&#x53D1;&#x9001;&#x591A;&#x4E2A;&#x6570;&#x636E;&#x62A5;&#xFF08;&#x4FE1;&#xFF09;&#x65F6;&#x662F;&#x65E0;&#x6CD5;&#x4FDD;&#x8BC1;&#x5B83;&#x4EEC;&#x6309;&#x7167;&#x88AB;&#x53D1;&#x9001;&#x7684;&#x987A;&#x5E8F;&#x5230;&#x8FBE;&#x7684;&#xFF0C;&#x751A;&#x81F3;&#x8FD8;&#x65E0;&#x6CD5;&#x4FDD;&#x8BC1;&#x5B83;&#x4EEC;&#x90FD;&#x80FD;&#x591F;&#x5230;&#x8FBE;&#x3002;&#x6570;&#x636E;&#x62A5;&#x8FD8;&#x65B0;&#x589E;&#x4E86;&#x90AE;&#x653F;&#x7CFB;&#x7EDF;&#x6240;&#x4E0D;&#x5177;&#x5907;&#x7684;&#x4E00;&#x4E2A;&#x7279;&#x70B9;&#xFF1A;&#x7531;&#x4E8E;&#x5E95;&#x5C42;&#x7684;&#x8054;&#x7F51;&#x534F;&#x8BAE;&#x6709;&#x65F6;&#x5019;&#x4F1A;&#x91CD;&#x65B0;&#x4F20;&#x8F93;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x5305;&#xFF0C;&#x56E0;&#x6B64;&#x540C;&#x6837;&#x7684;&#x6570;&#x636E;&#x5305;&#x53EF;&#x80FD;&#x4F1A;&#x591A;&#x6B21;&#x5230;&#x8FBE;&#x3002;<br></p><div class="amp-img-wrapper"><amp-img src="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1581844702702.png?x-oss-process=image/resize,m_lfit,h_450" width="625" height="450" layout="responsive"></amp-img></div>
<h3 id="&#x4EA4;&#x6362;&#x6570;&#x636E;&#x62A5;&#xFF1A;recvfrom&#x548C;sendto"><a href="#&#x4EA4;&#x6362;&#x6570;&#x636E;&#x62A5;&#xFF1A;recvfrom&#x548C;sendto" class="headerlink" title="&#x4EA4;&#x6362;&#x6570;&#x636E;&#x62A5;&#xFF1A;recvfrom&#x548C;sendto()"></a>&#x4EA4;&#x6362;&#x6570;&#x636E;&#x62A5;&#xFF1A;recvfrom&#x548C;sendto()</h3><p>recvfrom()&#x548C;sendto()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x5728;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x62A5;socket&#x4E0A;&#x63A5;&#x6536;&#x548C;&#x53D1;&#x9001;&#x6570;&#x636E;&#x62A5;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;sys/socket.h&gt;</span></span>

ssize_t <span class="token function">sendto</span><span class="token punctuation">(</span><span class="token keyword">int</span> sockfd<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">void</span> <span class="token operator">*</span>buf<span class="token punctuation">,</span> size_t len<span class="token punctuation">,</span> <span class="token keyword">int</span> flags<span class="token punctuation">,</span><span class="token keyword">const</span> <span class="token keyword">struct</span> sockaddr <span class="token operator">*</span>dest_addr<span class="token punctuation">,</span> socklen_t addrlen<span class="token punctuation">)</span><span class="token punctuation">;</span>
ssize_t <span class="token function">recvfrom</span><span class="token punctuation">(</span><span class="token keyword">int</span> sockfd<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token operator">*</span>buf<span class="token punctuation">,</span> size_t len<span class="token punctuation">,</span> <span class="token keyword">int</span> flags<span class="token punctuation">,</span><span class="token keyword">struct</span> sockaddr <span class="token operator">*</span>src_addr<span class="token punctuation">,</span> socklen_t <span class="token operator">*</span>addrlen<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x8FD9;&#x4E24;&#x4E2A;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x548C;&#x524D;&#x4E09;&#x4E2A;&#x53C2;&#x6570;&#x4E0E;read()&#x548C;write()&#x4E2D;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x548C;&#x76F8;&#x5E94;&#x53C2;&#x6570;&#x662F;&#x4E00;&#x6837;&#x7684;&#x3002;</p>
<p>&#x7B2C;&#x56DB;&#x4E2A;&#x53C2;&#x6570;flags&#x662F;&#x4E00;&#x4E2A;&#x4F4D;&#x63A9;&#x7801;&#xFF0C;&#x5B83;&#x63A7;&#x5236;&#x7740;&#x4E86;socket&#x7279;&#x5B9A;&#x7684;I/O&#x7279;&#x6027;&#x3002;</p>
<p>src_addr&#x548C;addrlen&#x53C2;&#x6570;&#x88AB;&#x7528;&#x6765;&#x83B7;&#x53D6;&#x6216;&#x6307;&#x5B9A;&#x4E0E;&#x4E4B;&#x901A;&#x4FE1;&#x7684;&#x5BF9;&#x7B49;socket&#x7684;&#x5730;&#x5740;&#x3002;</p>
<p>&#x5BF9;&#x4E8E;recvfrom()&#x6765;&#x8BB2;&#xFF0C;src_addr&#x548C;addrlen&#x53C2;&#x6570;&#x4F1A;&#x8FD4;&#x56DE;&#x7528;&#x6765;&#x53D1;&#x9001;&#x6570;&#x636E;&#x62A5;&#x7684;&#x8FDC;&#x7A0B;socket&#x7684;&#x5730;&#x5740;&#x3002;&#xFF08;&#x8FD9;&#x4E9B;&#x53C2;&#x6570;&#x7C7B;&#x4F3C;&#x4E8E;accept()&#x4E2D;&#x7684;addr&#x548C;addrlen&#x53C2;&#x6570;&#xFF0C;&#x5B83;&#x4EEC;&#x8FD4;&#x56DE;&#x5DF2;&#x8FDE;&#x63A5;&#x7684;&#x5BF9;&#x7B49;socket&#x7684;&#x5730;&#x5740;&#x3002;&#xFF09;src_addr&#x53C2;&#x6570;&#x662F;&#x4E00;&#x4E2A;&#x6307;&#x9488;&#xFF0C;&#x5B83;&#x6307;&#x5411;&#x4E86;&#x4E00;&#x4E2A;&#x4E0E;&#x901A;&#x4FE1;domain&#x5339;&#x914D;&#x7684;&#x5730;&#x5740;&#x7ED3;&#x6784;&#x3002;&#x4E0E;accept()&#x4E00;&#x6837;&#xFF0C;addrlen&#x662F;&#x4E00;&#x4E2A;&#x503C;-&#x7ED3;&#x679C;&#x53C2;&#x6570;&#x3002;&#x5728;&#x8C03;&#x7528;&#x4E4B;&#x524D;&#x5E94;&#x8BE5;&#x5C06;addrlen&#x521D;&#x59CB;&#x5316;&#x4E3A;src_addr&#x6307;&#x5411;&#x7684;&#x7ED3;&#x6784;&#x7684;&#x5927;&#x5C0F;&#xFF1B;&#x5728;&#x8FD4;&#x56DE;&#x4E4B;&#x540E;&#xFF0C;&#x5B83;&#x5305;&#x542B;&#x4E86;&#x5B9E;&#x9645;&#x5199;&#x5165;&#x8FD9;&#x4E2A;&#x7ED3;&#x6784;&#x7684;&#x5B57;&#x8282;&#x6570;&#x3002;</p>
<p>&#x5982;&#x679C;&#x4E0D;&#x5173;&#x5FC3;&#x53D1;&#x9001;&#x8005;&#x7684;&#x5730;&#x5740;&#xFF0C;&#x90A3;&#x4E48;&#x53EF;&#x4EE5;&#x5C06;src_addr&#x548C;addrlen&#x90FD;&#x6307;&#x5B9A;&#x4E3A;NULL&#x3002;&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;recvfrom()&#x7B49;&#x4EF7;&#x4E8E;&#x4F7F;&#x7528;recv()&#x6765;&#x63A5;&#x6536;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x62A5;&#x3002;&#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;read()&#x6765;&#x8BFB;&#x53D6;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x62A5;&#xFF0C;&#x8FD9;&#x7B49;&#x4EF7;&#x4E8E;&#x5728;&#x4F7F;&#x7528;recv()&#x65F6;&#x5C06;flags&#x53C2;&#x6570;&#x6307;&#x5B9A;&#x4E3A;0&#x3002;</p>
<p>&#x4E0D;&#x7BA1;length&#x7684;&#x53C2;&#x6570;&#x503C;&#x662F;&#x4EC0;&#x4E48;&#xFF0C;recvfrom()&#x53EA;&#x4F1A;&#x4ECE;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x62A5;socket&#x4E2D;&#x8BFB;&#x53D6;&#x4E00;&#x6761;&#x6D88;&#x606F;&#x3002;&#x5982;&#x679C;&#x6D88;&#x606F;&#x7684;&#x5927;&#x5C0F;&#x8D85;&#x8FC7;&#x4E86;length&#x5B57;&#x8282;&#xFF0C;&#x90A3;&#x4E48;&#x6D88;&#x606F;&#x4F1A;&#x88AB;&#x9759;&#x9ED8;&#x5730;&#x622A;&#x65AD;&#x4E3A;length&#x5B57;&#x8282;&#x3002;</p>
<p>&#x5982;&#x679C;&#x4F7F;&#x7528;&#x4E86;recvmsg()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF0C;&#x90A3;&#x4E48;&#x901A;&#x8FC7;&#x8FD4;&#x56DE;&#x7684;msghdr&#x7ED3;&#x6784;&#x4E2D;&#x7684;msg_flags&#x5B57;&#x6BB5;&#x4E2D;&#x7684;MSG_TRUNC&#x6807;&#x8BB0;&#x6765;&#x627E;&#x51FA;&#x88AB;&#x622A;&#x65AD;&#x7684;&#x6570;&#x636E;&#x62A5;&#xFF0C;&#x5177;&#x4F53;&#x7EC6;&#x8282;&#x8BF7;&#x53C2;&#x8003;recvmsg(2)&#x624B;&#x518C;&#x3002;</p>
<p>&#x5BF9;&#x4E8E;sendto()&#x6765;&#x8BB2;&#xFF0C;dest_addr&#x548C;addrlen&#x53C2;&#x6570;&#x6307;&#x5B9A;&#x4E86;&#x6570;&#x636E;&#x62A5;&#x53D1;&#x9001;&#x5230;&#x7684;socket&#x3002;&#x8FD9;&#x4E9B;&#x53C2;&#x6570;&#x7684;&#x4F7F;&#x7528;&#x65B9;&#x5F0F;&#x4E0E;connect()&#x4E2D;&#x76F8;&#x5E94;&#x53C2;&#x6570;&#x7684;&#x4F7F;&#x7528;&#x65B9;&#x5F0F;&#x662F;&#x4E00;&#x6837;&#x7684;&#x3002;dest_addr&#x53C2;&#x6570;&#x662F;&#x4E00;&#x4E2A;&#x4E0E;&#x901A;&#x4FE1;domain&#x5339;&#x914D;&#x7684;&#x5730;&#x5740;&#x7ED3;&#x6784;&#xFF0C;&#x5B83;&#x4F1A;&#x88AB;&#x521D;&#x59CB;&#x5316;&#x6210;&#x76EE;&#x6807;socket&#x7684;&#x5730;&#x5740;&#x3002;addrlen&#x53C2;&#x6570;&#x6307;&#x5B9A;&#x4E86;addr&#x7684;&#x5927;&#x5C0F;&#x3002;</p>
<p>&#x5728;Linux&#x4E0A;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;sendto()&#x53D1;&#x9001;&#x957F;&#x5EA6;&#x4E3A;0&#x7684;&#x6570;&#x636E;&#x62A5;&#xFF0C;&#x4F46;&#x4E0D;&#x662F;&#x6240;&#x6709;&#x7684;UNIX&#x5B9E;&#x73B0;&#x90FD;&#x5141;&#x8BB8;&#x8FD9;&#x6837;&#x505A;&#x7684;&#x3002;</p>
<h3 id="&#x5728;&#x6570;&#x636E;&#x62A5;socket&#x4E0A;&#x4F7F;&#x7528;connect"><a href="#&#x5728;&#x6570;&#x636E;&#x62A5;socket&#x4E0A;&#x4F7F;&#x7528;connect" class="headerlink" title="&#x5728;&#x6570;&#x636E;&#x62A5;socket&#x4E0A;&#x4F7F;&#x7528;connect()"></a>&#x5728;&#x6570;&#x636E;&#x62A5;socket&#x4E0A;&#x4F7F;&#x7528;connect()</h3><p>&#x5C3D;&#x7BA1;&#x6570;&#x636E;&#x62A5;socket&#x662F;&#x65E0;&#x8FDE;&#x63A5;&#x7684;&#xFF0C;&#x4F46;&#x5728;&#x6570;&#x636E;&#x62A5;socket&#x4E0A;&#x5E94;&#x7528;connect()&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#x4ECD;&#x7136;&#x662F;&#x8D77;&#x4F5C;&#x7528;&#x7684;&#x3002;&#x5728;&#x6570;&#x636E;&#x62A5;socket&#x4E0A;&#x8C03;&#x7528;connect()&#x4F1A;&#x5BFC;&#x81F4;&#x5185;&#x6838;&#x8BB0;&#x5F55;&#x8FD9;&#x4E2A;socket&#x7684;&#x5BF9;&#x7B49;socket&#x7684;&#x5730;&#x5740;&#x3002;&#x672F;&#x8BED;&#x5DF2;&#x8FDE;&#x63A5;&#x7684;&#x6570;&#x636E;&#x62A5;socket&#x5C31;&#x662F;&#x6307;&#x6B64;&#x79CD;socket&#x3002;&#x672F;&#x8BED;&#x975E;&#x8FDE;&#x63A5;&#x7684;&#x6570;&#x636E;&#x62A5;socket&#x662F;&#x6307;&#x90A3;&#x4E9B;&#x6CA1;&#x6709;&#x8C03;&#x7528;connect()&#x7684;&#x6570;&#x636E;&#x62A5;socket&#xFF08;&#x5373;&#x65B0;&#x6570;&#x636E;&#x62A5;socket&#x7684;&#x9ED8;&#x8BA4;&#x884C;&#x4E3A;&#xFF09;&#x3002;</p>
<p>&#x5F53;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x62A5;socket&#x5DF2;&#x8FDE;&#x63A5;&#x4E4B;&#x540E;&#xFF1A;</p>
<ul>
<li>&#x6570;&#x636E;&#x62A5;&#x7684;&#x53D1;&#x9001;&#x53EF;&#x5728;socket&#x4E0A;&#x4F7F;&#x7528;write()&#xFF08;&#x6216;send()&#xFF09;&#x6765;&#x5B8C;&#x6210;&#x5E76;&#x4E14;&#x4F1A;&#x81EA;&#x52A8;&#x88AB;&#x53D1;&#x9001;&#x5230;&#x540C;&#x6837;&#x7684;&#x5BF9;&#x7B49;socket&#x4E0A;&#x3002;&#x4E0E;sendto()&#x4E00;&#x6837;&#xFF0C;&#x6BCF;&#x4E2A;write()&#x8C03;&#x7528;&#x4F1A;&#x53D1;&#x9001;&#x4E00;&#x4E2A;&#x72EC;&#x7ACB;&#x7684;&#x6570;&#x636E;&#x62A5;&#xFF1B;</li>
<li>&#x5728;&#x8FD9;&#x4E2A;socket&#x4E0A;&#x53EA;&#x80FD;&#x8BFB;&#x53D6;&#x7531;&#x5BF9;&#x7B49;socket&#x53D1;&#x9001;&#x7684;&#x6570;&#x636E;&#x62A5;&#x3002;</li>
</ul>
<p>&#x6CE8;&#x610F;connect()&#x7684;&#x4F5C;&#x7528;&#x5BF9;&#x6570;&#x636E;&#x62A5;socket&#x662F;&#x4E0D;&#x5BF9;&#x79F0;&#x7684;&#x3002;&#x4E0A;&#x9762;&#x7684;&#x8BBA;&#x65AD;&#x53EA;&#x9002;&#x7528;&#x4E8E;&#x8C03;&#x7528;&#x4E86;connect()&#x6570;&#x636E;&#x62A5;socket&#xFF0C;&#x5E76;&#x4E0D;&#x9002;&#x7528;&#x4E8E;&#x5B83;&#x8FDE;&#x63A5;&#x7684;&#x8FDC;&#x7A0B;socket&#xFF08;&#x9664;&#x975E;&#x5BF9;&#x7B49;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5728;&#x5176;socket&#x4E0A;&#x4E5F;&#x8C03;&#x7528;&#x4E86;connect()&#xFF09;&#x3002;</p>
<p>&#x901A;&#x8FC7;&#x518D;&#x53D1;&#x8D77;&#x4E00;&#x4E2A;connect()&#x8C03;&#x7528;&#x53EF;&#x4EE5;&#x4FEE;&#x6539;&#x4E00;&#x4E2A;&#x5DF2;&#x8FDE;&#x63A5;&#x7684;&#x6570;&#x636E;&#x62A5;socket&#x7684;&#x5BF9;&#x7B49;socket&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x901A;&#x8FC7;&#x6307;&#x5B9A;&#x4E00;&#x4E2A;&#x5730;&#x5740;&#x65CF;&#xFF08;&#x5982;UNIX domain&#x4E2D;&#x7684;sun_family&#x5B57;&#x6BB5;&#xFF09;&#x4E3A;AF_UNSPEC&#x7684;&#x5730;&#x5740;&#x7ED3;&#x6784;&#x8FD8;&#x53EF;&#x4EE5;&#x89E3;&#x9664;&#x5BF9;&#x7B49;&#x5173;&#x8054;&#x5173;&#x7CFB;&#x3002;&#x4F46;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#xFF0C;&#x5176;&#x4ED6;&#x5F88;&#x591A;UNIX&#x5B9E;&#x73B0;&#x5E76;&#x4E0D;&#x652F;&#x6301;&#x5C06;AF_UNSPEC&#x7528;&#x4E8E;&#x8FD9;&#x79CD;&#x7528;&#x9014;&#x3002;</p>
<p>SUSv3&#x5728;&#x89E3;&#x9664;&#x5BF9;&#x7B49;&#x5173;&#x7CFB;&#x65B9;&#x9762;&#x7684;&#x8BBA;&#x65AD;&#x662F;&#x6BD4;&#x8F83;&#x6A21;&#x7CCA;&#x7684;&#xFF0C;&#x5B83;&#x53EA;&#x662F;&#x58F0;&#x79F0;&#x901A;&#x8FC7;&#x8C03;&#x7528;&#x4E00;&#x4E2A;&#x6307;&#x5B9A;&#x4E86;&#x201C;&#x7A7A;&#x5730;&#x5740;&#x201D;&#x7684;connect()&#x8C03;&#x7528;&#x53EF;&#x4EE5;&#x91CD;&#x7F6E;&#x4E00;&#x4E2A;&#x8FDE;&#x63A5;&#xFF0C;&#x5E76;&#x6CA1;&#x6709;&#x5B9A;&#x4E49;&#x90A3;&#x6837;&#x4E00;&#x4E2A;&#x672F;&#x8BED;&#x3002;SUSv4&#x5219;&#x660E;&#x786E;&#x89C4;&#x5B9A;&#x4E86;&#x9700;&#x8981;&#x4F7F;&#x7528;AF_UNSPEC&#x3002;</p>
<p>&#x4E3A;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x62A5;socket&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x5BF9;&#x7B49;socket&#xFF0C;&#x8FD9;&#x79CD;&#x505A;&#x6CD5;&#x7684;&#x4E00;&#x4E2A;&#x660E;&#x663E;&#x4F18;&#x52BF;&#x662F;&#x5728;&#x8BE5;socket&#x4E0A;&#x4F20;&#x8F93;&#x6570;&#x636E;&#x65F6;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x66F4;&#x7B80;&#x5355;&#x7684;I/O&#x7CFB;&#x7EDF;&#x8C03;&#x7528;&#xFF0C;&#x5373;&#x65E0;&#x9700;&#x4F7F;&#x7528;&#x6307;&#x5B9A;&#x4E86;dest_addr&#x548C;addrlen&#x53C2;&#x6570;&#x7684;sendto()&#xFF0C;&#x800C;&#x53EA;&#x9700;&#x8981;&#x4F7F;&#x7528;write()&#x5373;&#x53EF;&#x3002;&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x5BF9;&#x7B49;socket&#x4E3B;&#x8981;&#x5BF9;&#x90A3;&#x4E9B;&#x9700;&#x8981;&#x5411;&#x5355;&#x4E2A;&#x5BF9;&#x7B49;socket&#xFF08;&#x901A;&#x5E38;&#x662F;&#x67D0;&#x79CD;&#x6570;&#x636E;&#x62A5;&#x5BA2;&#x6237;&#x7AEF;&#xFF09;&#x53D1;&#x9001;&#x591A;&#x4E2A;&#x6570;&#x636E;&#x62A5;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x662F;&#x6BD4;&#x8F83;&#x6709;&#x7528;&#x7684;&#x3002;</p>
<p>&#x5728;&#x4E00;&#x4E9B;TCP/IP&#x5B9E;&#x8DF5;&#x4E2D;&#xFF0C;&#x5C06;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x62A5;socket&#x8FDE;&#x63A5;&#x5230;&#x4E00;&#x4E2A;&#x5BF9;&#x7B49;socket&#x80FD;&#x591F;&#x5E26;&#x6765;&#x6027;&#x80FD;&#x4E0A;&#x7684;&#x63D0;&#x5347;&#xFF08;([Stevens et al., 2004])&#x3002;&#x5728;Linux&#x4E0A;&#xFF0C;&#x8FDE;&#x63A5;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x62A5;socket&#x80FD;&#x5BF9;&#x6027;&#x80FD;&#x4EA7;&#x751F;&#x4E9B;&#x8BB8;&#x5DEE;&#x5F02;&#x3002;</p>
<h1 id="SOCKET&#xFF1A;UNIX-DOMAIN"><a href="#SOCKET&#xFF1A;UNIX-DOMAIN" class="headerlink" title="SOCKET&#xFF1A;UNIX DOMAIN"></a>SOCKET&#xFF1A;UNIX DOMAIN</h1><p>&#x672C;&#x7AE0;&#x5C06;&#x4ECB;&#x7ECD;&#x5141;&#x8BB8;&#x4F4D;&#x4E8E;&#x540C;&#x4E00;&#x4E3B;&#x673A;&#x7CFB;&#x7EDF;&#x4E0A;&#x7684;&#x8FDB;&#x7A0B;&#x4E4B;&#x95F4;&#x76F8;&#x4E92;&#x901A;&#x4FE1;&#x7684;UNIX domain socket&#x7684;&#x7528;&#x6CD5;&#xFF0C;&#x5305;&#x62EC;UNIX domain&#x4E2D;&#x6D41;socket&#x548C;&#x6570;&#x636E;&#x62A5;socket&#x7684;&#x4F7F;&#x7528;&#xFF0C;&#x5982;&#x4F55;&#x4F7F;&#x7528;&#x6587;&#x4EF6;&#x6743;&#x9650;&#x6765;&#x63A7;&#x5236;&#x5BF9;UNIX domain socket&#x7684;&#x8BBF;&#x95EE;&#xFF0C;&#x5982;&#x4F55;&#x4F7F;&#x7528;socketpair()&#x521B;&#x5EFA;&#x4E00;&#x5BF9;&#x76F8;&#x4E92;&#x8FDE;&#x63A5;&#x7684;UNIX domain socket&#xFF0C;&#x4EE5;&#x53CA;Linux&#x62BD;&#x8C61;socket&#x540D;&#x7A7A;&#x95F4;&#x3002;</p>
<h2 id="UNIX-domain-socket&#x5730;&#x5740;&#xFF1A;struct-sockaddr-un"><a href="#UNIX-domain-socket&#x5730;&#x5740;&#xFF1A;struct-sockaddr-un" class="headerlink" title="UNIX domain socket&#x5730;&#x5740;&#xFF1A;struct sockaddr_un"></a>UNIX domain socket&#x5730;&#x5740;&#xFF1A;struct sockaddr_un</h2><p>&#x5728;UNIX domain&#x4E2D;&#xFF0C;socket&#x5730;&#x5740;&#x4EE5;&#x8DEF;&#x5F84;&#x540D;&#x6765;&#x8868;&#x793A;&#xFF0C;domain&#x7279;&#x5B9A;&#x7684;socket&#x5730;&#x5740;&#x7ED3;&#x6784;&#x7684;&#x5B9A;&#x4E49;&#x5982;&#x4E0B;&#x6240;&#x793A;&#x3002;</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">struct</span> sockaddr_un<span class="token punctuation">{</span>
  sa_family_t sun_family<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* AF_LOCAL */</span>
  <span class="token keyword">char</span> sun_path<span class="token punctuation">[</span><span class="token number">108</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* null-terminated pathname */</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>ockaddr_un&#x7ED3;&#x6784;&#x4E2D;&#x5B57;&#x6BB5;&#x7684;sun_&#x524D;&#x7F00;&#x4E0E;Sun Microsystems&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x5173;&#x7CFB;&#xFF0C;&#x5B83;&#x662F;&#x6839;&#x636E;socket unix&#x800C;&#x6765;&#x7684;&#x3002;</p>
<p>SUSv3&#x5E76;&#x6CA1;&#x6709;&#x89C4;&#x5B9A;sun_path&#x5B57;&#x6BB5;&#x7684;&#x5927;&#x5C0F;&#x3002;&#x65E9;&#x671F;&#x7684;BSD&#x5B9E;&#x73B0;&#x4F7F;&#x7528;108&#x548C;104&#x5B57;&#x8282;&#xFF0C;&#x800C;&#x4E00;&#x4E2A;&#x7A0D;&#x5FAE;&#x73B0;&#x4EE3;&#x4E00;&#x70B9;&#x7684;&#x5B9E;&#x73B0;&#xFF08;HP-UX 11&#xFF09;&#x5219;&#x4F7F;&#x7528;&#x4E86;92&#x5B57;&#x8282;&#x3002;&#x53EF;&#x79FB;&#x690D;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5728;&#x7F16;&#x7801;&#x65F6;&#x5E94;&#x8BE5;&#x91C7;&#x7528;&#x6700;&#x4F4E;&#x503C;&#xFF0C;&#x5E76;&#x4E14;&#x5728;&#x5411;&#x8FD9;&#x4E2A;&#x5B57;&#x6BB5;&#x5199;&#x5165;&#x6570;&#x636E;&#x65F6;&#x4F7F;&#x7528;snprintf()&#x6216;strncpy()&#x4EE5;&#x907F;&#x514D;&#x7F13;&#x51B2;&#x533A;&#x6EA2;&#x51FA;&#x3002;</p>
<p>&#x4E3A;&#x5C06;&#x4E00;&#x4E2A;UNIX domain socket&#x7ED1;&#x5B9A;&#x5230;&#x4E00;&#x4E2A;&#x5730;&#x5740;&#x4E0A;&#xFF0C;&#x9700;&#x8981;&#x521D;&#x59CB;&#x5316;&#x4E00;&#x4E2A;sockaddr_un&#x7ED3;&#x6784;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x6307;&#x5411;&#x8FD9;&#x4E2A;&#x7ED3;&#x6784;&#x7684;&#x4E00;&#x4E2A;&#xFF08;&#x8F6C;&#x6362;&#xFF09;&#x6307;&#x9488;&#x4F5C;&#x4E3A;addr&#x53C2;&#x6570;&#x4F20;&#x5165;bind()&#x5E76;&#x5C06;addrlen&#x6307;&#x5B9A;&#x4E3A;&#x8FD9;&#x4E2A;&#x7ED3;&#x6784;&#x7684;&#x5927;&#x5C0F;.<br><strong>&#x7ED1;&#x5B9A;&#x4E00;&#x4E2A;UNIX domain socket:</strong></p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>SOCKNAME <span class="token operator">=</span> <span class="token string">&quot;/tmp/mysock&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> sfd<span class="token punctuation">;</span>
<span class="token keyword">struct</span> sockaddr_un addr<span class="token punctuation">;</span>
sfd <span class="token operator">=</span> <span class="token function">socket</span><span class="token punctuation">(</span>AF_UNIX<span class="token punctuation">,</span> SOCK_STREAM<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">if</span> <span class="token punctuation">(</span>sfd <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token function">errExit</span><span class="token punctuation">(</span><span class="token string">&quot;socket&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">/* Create socket */</span>
<span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>addr<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> sockaddr_un<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
addr<span class="token punctuation">.</span>sun_family <span class="token operator">=</span> AF_UNIX<span class="token punctuation">;</span>
<span class="token function">strncpy</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>sun_path<span class="token punctuation">,</span> SOCKNAME<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>sun_path<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">bind</span><span class="token punctuation">(</span>sfd<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">struct</span> sockaddr <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>addr<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> sockaddr_un<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token function">errExit</span><span class="token punctuation">(</span><span class="token string">&quot;bind&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x7A0B;&#x5E8F;&#x6E05;&#x5355;&#x4F7F;&#x7528;memset()&#x8C03;&#x7528;&#x6765;&#x786E;&#x4FDD;&#x7ED3;&#x6784;&#x4E2D;&#x6240;&#x6709;&#x5B57;&#x6BB5;&#x7684;&#x503C;&#x90FD;&#x4E3A;0&#x3002;&#xFF08;&#x540E;&#x9762;&#x7684;strncpy()&#x8C03;&#x7528;&#x5229;&#x7528;&#x8FD9;&#x4E00;&#x70B9;&#x5E76;&#x5C06;&#x5176;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x6307;&#x5B9A;&#x4E3A;sun_path&#x5B57;&#x6BB5;&#x7684;&#x5927;&#x5C0F;&#x51CF;&#x4E00;&#x6765;&#x786E;&#x4FDD;&#x8FD9;&#x4E2A;&#x5B57;&#x6BB5;&#x603B;&#x662F;&#x62E5;&#x6709;&#x4E00;&#x4E2A;&#x7ED3;&#x675F;&#x7684;null&#x5B57;&#x8282;&#x3002;&#xFF09;&#x4F7F;&#x7528;memset()&#x5C06;&#x6574;&#x4E2A;&#x7ED3;&#x6784;&#x6E05;&#x96F6;&#x800C;&#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x5B57;&#x6BB5;&#x4E00;&#x4E2A;&#x5B57;&#x6BB5;&#x5730;&#x8FDB;&#x884C;&#x521D;&#x59CB;&#x5316;&#x80FD;&#x591F;&#x786E;&#x4FDD;&#x4E00;&#x4E9B;&#x5B9E;&#x73B0;&#x63D0;&#x4F9B;&#x7684;&#x6240;&#x6709;&#x975E;&#x6807;&#x51C6;&#x5B57;&#x6BB5;&#x90FD;&#x4F1A;&#x88AB;&#x521D;&#x59CB;&#x5316;&#x4E3A;0&#x3002;</p>
<p>&#x4ECE;BSD&#x884D;&#x751F;&#x51FA;&#x6765;&#x7684;bzero()&#x51FD;&#x6570;&#x662F;&#x4E00;&#x4E2A;&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x53D6;&#x4EE3;memset()&#x5BF9;&#x4E00;&#x4E2A;&#x7ED3;&#x6784;&#x7684;&#x5185;&#x5BB9;&#x8FDB;&#x884C;&#x6E05;&#x96F6;&#x7684;&#x51FD;&#x6570;&#x3002;SUSv3&#x89C4;&#x5B9A;&#x4E86;bzero()&#x4EE5;&#x53CA;&#x76F8;&#x5173;&#x7684;bcopy()&#xFF08;&#x4E0E;memmove()&#x7C7B;&#x4F3C;&#xFF09;&#xFF0C;&#x4F46;&#x5C06;&#x8FD9;&#x4E24;&#x4E2A;&#x51FD;&#x6570;&#x6807;&#x8BB0;&#x6210;&#x4E86;LEGACY&#x5E76;&#x6307;&#x51FA;&#x9996;&#x9009;&#x4F7F;&#x7528;memset()&#x548C;memmove()&#x3002;SUSv4&#x5219;&#x5220;&#x9664;&#x4E86;&#x4E0E;bzero()&#x548C;bcopy()&#x6709;&#x5173;&#x7684;&#x89C4;&#x8303;&#x3002;</p>
<p>&#x5F53;&#x7528;&#x6765;&#x7ED1;&#x5B9A;UNIX domain socket&#x65F6;&#xFF0C;bind()&#x4F1A;&#x5728;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x4E2D;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x6761;&#x76EE;&#x3002;&#xFF08;&#x56E0;&#x6B64;&#x4F5C;&#x4E3A;socket&#x8DEF;&#x5F84;&#x540D;&#x7684;&#x4E00;&#x90E8;&#x5206;&#x7684;&#x76EE;&#x5F55;&#x9700;&#x8981;&#x53EF;&#x8BBF;&#x95EE;&#x548C;&#x53EF;&#x5199;&#x3002;&#xFF09;&#x6587;&#x4EF6;&#x7684;&#x6240;&#x6709;&#x6743;&#x5C06;&#x6839;&#x636E;&#x5E38;&#x89C4;&#x7684;&#x6587;&#x4EF6;&#x521B;&#x5EFA;&#x89C4;&#x5219;&#x6765;&#x786E;&#x5B9A;&#x3002;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x4F1A;&#x88AB;&#x6807;&#x8BB0;&#x4E3A;&#x4E00;&#x4E2A;socket&#x3002;&#x5F53;&#x5728;&#x8FD9;&#x4E2A;&#x8DEF;&#x5F84;&#x540D;&#x4E0A;&#x5E94;&#x7528;stat()&#x65F6;&#xFF0C;&#x5B83;&#x4F1A;&#x5728;stat&#x7ED3;&#x6784;&#x7684;st_mode&#x5B57;&#x6BB5;&#x4E2D;&#x7684;&#x6587;&#x4EF6;&#x7C7B;&#x578B;&#x90E8;&#x5206;&#x8FD4;&#x56DE;&#x503C;S_IFSOCK&#x3002;&#x5F53;&#x4F7F;&#x7528;ls &#x2013;l&#x5217;&#x51FA;&#x65F6;&#xFF0C;UNIX domain socket&#x5728;&#x7B2C;&#x4E00;&#x5217;&#x5C06;&#x4F1A;&#x663E;&#x793A;&#x7C7B;&#x578B;s&#xFF0C;&#x800C;ls &#x2013;F&#x5219;&#x4F1A;&#x5728;socket&#x8DEF;&#x5F84;&#x540D;&#x540E;&#x9762;&#x9644;&#x52A0;&#x4E0A;&#x4E00;&#x4E2A;&#x7B49;&#x53F7;&#xFF08;=&#xFF09;&#x3002;</p>
<p>&#x5C3D;&#x7BA1;UNIX domain socket&#x662F;&#x901A;&#x8FC7;&#x8DEF;&#x5F84;&#x540D;&#x6765;&#x6807;&#x8BC6;&#x7684;&#xFF0C;&#x4F46;&#x5728;&#x8FD9;&#x4E9B;socket&#x4E0A;&#x53D1;&#x751F;&#x7684;I/O&#x65E0;&#x987B;&#x5BF9;&#x5E95;&#x5C42;&#x8BBE;&#x5907;&#x8FDB;&#x884C;&#x64CD;&#x4F5C;&#x3002;</p>
<p>&#x6709;&#x5173;&#x7ED1;&#x5B9A;&#x4E00;&#x4E2A;UNIX domain socket&#x65B9;&#x9762;&#x8FD8;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x4EE5;&#x4E0B;&#x51E0;&#x70B9;&#x3002;</p>
<ul>
<li>&#x65E0;&#x6CD5;&#x5C06;&#x4E00;&#x4E2A;socket&#x7ED1;&#x5B9A;&#x5230;&#x4E00;&#x4E2A;&#x65E2;&#x6709;&#x8DEF;&#x5F84;&#x540D;&#x4E0A;&#xFF08;bind()&#x4F1A;&#x5931;&#x8D25;&#x5E76;&#x8FD4;&#x56DE;EADDRINUSE&#x9519;&#x8BEF;&#xFF09;&#x3002;</li>
<li>&#x901A;&#x5E38;&#x4F1A;&#x5C06;&#x4E00;&#x4E2A;socket&#x7ED1;&#x5B9A;&#x5230;&#x4E00;&#x4E2A;&#x7EDD;&#x5BF9;&#x8DEF;&#x5F84;&#x540D;&#x4E0A;&#xFF0C;&#x8FD9;&#x6837;&#x8FD9;&#x4E2A;socket&#x5C31;&#x4F1A;&#x4F4D;&#x4E8E;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x56FA;&#x5B9A;&#x5730;&#x5740;&#x5904;&#x3002;&#x5F53;&#x7136;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x76F8;&#x5BF9;&#x8DEF;&#x5F84;&#x540D;&#xFF0C;&#x4F46;&#x8FD9;&#x79CD;&#x505A;&#x6CD5;&#x5E76;&#x4E0D;&#x5E38;&#x89C1;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x8981;&#x6C42;&#x60F3;&#x8981;connect()&#x8FD9;&#x4E2A;- - socket&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x77E5;&#x9053;&#x6267;&#x884C;bind()&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x5F53;&#x524D;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;&#x3002;</li>
<li>&#x4E00;&#x4E2A;socket&#x53EA;&#x80FD;&#x7ED1;&#x5B9A;&#x5230;&#x4E00;&#x4E2A;&#x8DEF;&#x5F84;&#x540D;&#x4E0A;&#xFF0C;&#x76F8;&#x5E94;&#x5730;&#xFF0C;&#x4E00;&#x4E2A;&#x8DEF;&#x5F84;&#x540D;&#x53EA;&#x80FD;&#x88AB;&#x4E00;&#x4E2A;socket&#x7ED1;&#x5B9A;&#x3002;</li>
<li>&#x65E0;&#x6CD5;&#x4F7F;&#x7528;open()&#x6253;&#x5F00;&#x4E00;&#x4E2A;socket&#x3002;</li>
<li>&#x5F53;&#x4E0D;&#x518D;&#x9700;&#x8981;&#x4E00;&#x4E2A;socket&#x65F6;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;unlink()&#xFF08;&#x6216;remove()&#xFF09;&#x5220;&#x9664;&#x5176;&#x8DEF;&#x5F84;&#x540D;&#x6761;&#x76EE;&#xFF08;&#x901A;&#x5E38;&#x4E5F;&#x5E94;&#x8BE5;&#x8FD9;&#x6837;&#x505A;&#xFF09;&#x3002;</li>
</ul>
<p>&#x5728;&#x672C;&#x7AE0;&#x7ED9;&#x51FA;&#x7684;&#x5927;&#x591A;&#x6570;&#x793A;&#x4F8B;&#x7A0B;&#x5E8F;&#x4E2D;&#xFF0C;&#x5C06;&#x4F1A;&#x628A;UNIX domain socket&#x7ED1;&#x5B9A;&#x5230;/tmp&#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x4E00;&#x4E2A;&#x8DEF;&#x5F84;&#x540D;&#x4E0A;&#xFF0C;&#x56E0;&#x4E3A;&#x901A;&#x5E38;&#x8FD9;&#x4E2A;&#x76EE;&#x5F55;&#x5728;&#x6240;&#x6709;&#x7CFB;&#x7EDF;&#x4E0A;&#x90FD;&#x662F;&#x5B58;&#x5728;&#x5E76;&#x4E14;&#x53EF;&#x5199;&#x7684;&#x3002;&#x8FD9;&#x6837;&#x8BFB;&#x8005;&#x5C31;&#x80FD;&#x591F;&#x5F88;&#x5BB9;&#x6613;&#x5730;&#x8FD0;&#x884C;&#x8FD9;&#x4E9B;&#x7A0B;&#x5E8F;&#x800C;&#x65E0;&#x9700;&#x7F16;&#x8F91;&#x8FD9;&#x4E9B;socket&#x8DEF;&#x5F84;&#x540D;&#x4E86;&#x3002;&#x4F46;&#x9700;&#x8981;&#x77E5;&#x9053;&#x7684;&#x662F;&#x8FD9;&#x901A;&#x5E38;&#x4E0D;&#x662F;&#x4E00;&#x79CD;&#x4F18;&#x79C0;&#x7684;&#x8BBE;&#x8BA1;&#x6280;&#x672F;&#x3002;&#x6B63;&#x5982;&#x5728;38.7&#x8282;&#x4E2D;&#x6307;&#x51FA;&#x7684;&#x90A3;&#x6837;&#xFF0C;&#x5728;&#x8BF8;&#x5982;/tmp&#x6B64;&#x7C7B;&#x516C;&#x5171;&#x53EF;&#x5199;&#x7684;&#x76EE;&#x5F55;&#x4E2D;&#x521B;&#x5EFA;&#x6587;&#x4EF6;&#x53EF;&#x80FD;&#x4F1A;&#x5BFC;&#x81F4;&#x5404;&#x79CD;&#x5404;&#x6837;&#x7684;&#x5B89;&#x5168;&#x95EE;&#x9898;&#x3002;&#x4F8B;&#x5982;&#x5728;/tmp&#x4E2D;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x540D;&#x5B57;&#x4E0E;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;socket&#x7684;&#x8DEF;&#x5F84;&#x540D;&#x4E00;&#x6837;&#x7684;&#x8DEF;&#x5F84;&#x540D;&#x4E4B;&#x540E;&#x5C31;&#x80FD;&#x591F;&#x5B8C;&#x6210;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x62D2;&#x7EDD;&#x670D;&#x52A1;&#x653B;&#x51FB;&#x4E86;&#x3002;&#x73B0;&#x5B9E;&#x4E16;&#x754C;&#x4E2D;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5E94;&#x8BE5;&#x5C06;UNIX domain socket bind()&#x5230;&#x4E00;&#x4E2A;&#x91C7;&#x53D6;&#x4E86;&#x6070;&#x5F53;&#x7684;&#x5B89;&#x5168;&#x4FDD;&#x62A4;&#x63AA;&#x65BD;&#x7684;&#x76EE;&#x5F55;&#x4E2D;&#x7684;&#x7EDD;&#x5BF9;&#x8DEF;&#x5F84;&#x540D;&#x4E0A;&#x3002;</p>
<h2 id="UNIX-domain&#x4E2D;&#x7684;&#x6D41;socket"><a href="#UNIX-domain&#x4E2D;&#x7684;&#x6D41;socket" class="headerlink" title="UNIX domain&#x4E2D;&#x7684;&#x6D41;socket"></a>UNIX domain&#x4E2D;&#x7684;&#x6D41;socket</h2><p>TODO.</p>
<h2 id="UNIX-domain&#x4E2D;&#x7684;&#x6570;&#x636E;&#x62A5;socket"><a href="#UNIX-domain&#x4E2D;&#x7684;&#x6570;&#x636E;&#x62A5;socket" class="headerlink" title="UNIX domain&#x4E2D;&#x7684;&#x6570;&#x636E;&#x62A5;socket"></a>UNIX domain&#x4E2D;&#x7684;&#x6570;&#x636E;&#x62A5;socket</h2><p>TODO.</p>
<h2 id="UNIX-domain-socket&#x6743;&#x9650;"><a href="#UNIX-domain-socket&#x6743;&#x9650;" class="headerlink" title="UNIX domain socket&#x6743;&#x9650;"></a>UNIX domain socket&#x6743;&#x9650;</h2><p>TODO.</p>
<h2 id="&#x521B;&#x5EFA;&#x4E92;&#x8054;socket&#x5BF9;&#xFF1A;socketpair"><a href="#&#x521B;&#x5EFA;&#x4E92;&#x8054;socket&#x5BF9;&#xFF1A;socketpair" class="headerlink" title="&#x521B;&#x5EFA;&#x4E92;&#x8054;socket&#x5BF9;&#xFF1A;socketpair()"></a>&#x521B;&#x5EFA;&#x4E92;&#x8054;socket&#x5BF9;&#xFF1A;socketpair()</h2><p>TODO.</p>
<h2 id="Linux&#x62BD;&#x8C61;socket&#x540D;&#x7A7A;&#x95F4;"><a href="#Linux&#x62BD;&#x8C61;socket&#x540D;&#x7A7A;&#x95F4;" class="headerlink" title="Linux&#x62BD;&#x8C61;socket&#x540D;&#x7A7A;&#x95F4;"></a>Linux&#x62BD;&#x8C61;socket&#x540D;&#x7A7A;&#x95F4;</h2><p>TODO.</p>
<h1 id="SOCKET&#xFF1A;TCP-IP&#x7F51;&#x7EDC;&#x57FA;&#x7840;"><a href="#SOCKET&#xFF1A;TCP-IP&#x7F51;&#x7EDC;&#x57FA;&#x7840;" class="headerlink" title="SOCKET&#xFF1A;TCP/IP&#x7F51;&#x7EDC;&#x57FA;&#x7840;"></a>SOCKET&#xFF1A;TCP/IP&#x7F51;&#x7EDC;&#x57FA;&#x7840;</h1><h2 id="&#x4E92;&#x8054;&#x7F51;"><a href="#&#x4E92;&#x8054;&#x7F51;" class="headerlink" title="&#x4E92;&#x8054;&#x7F51;"></a>&#x4E92;&#x8054;&#x7F51;</h2><p>&#x4E92;&#x8054;&#x7F51;&#x7EDC;&#xFF08;internetwork&#xFF09;&#xFF0C;&#x6216;&#x66F4;&#x4E00;&#x822C;&#x5730;&#xFF0C;&#x4E92;&#x8054;&#x7F51;&#xFF08;internet&#xFF0C;&#x5C0F;&#x5199;&#x7684;i&#xFF09;&#xFF0C;&#x4F1A;&#x5C06;&#x4E0D;&#x540C;&#x7684;&#x8BA1;&#x7B97;&#x673A;&#x7F51;&#x7EDC;&#x8FDE;&#x63A5;&#x8D77;&#x6765;&#x5E76;&#x5141;&#x8BB8;&#x4F4D;&#x4E8E;&#x7F51;&#x7EDC;&#x4E2D;&#x7684;&#x4E3B;&#x673A;&#x76F8;&#x4E92;&#x4E4B;&#x95F4;&#x8FDB;&#x884C;&#x901A;&#x4FE1;&#x3002;&#x6362;&#x53E5;&#x8BDD;&#x8BF4;&#xFF0C;&#x4E00;&#x4E2A;&#x4E92;&#x8054;&#x7F51;&#x662F;&#x7531;&#x8BA1;&#x7B97;&#x673A;&#x7F51;&#x7EDC;&#x7EC4;&#x6210;&#x7684;&#x4E00;&#x4E2A;&#x7F51;&#x7EDC;&#x3002;&#x672F;&#x8BED;&#x5B50;&#x7F51;&#x7EDC;&#xFF0C;&#x6216;&#x5B50;&#x7F51;&#xFF0C;&#x7528;&#x6765;&#x6307;&#x7EC4;&#x6210;&#x56E0;&#x7279;&#x7F51;&#x7684;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x7F51;&#x7EDC;&#x3002;&#x4E92;&#x8054;&#x7F51;&#x7684;&#x76EE;&#x6807;&#x662F;&#x9690;&#x85CF;&#x4E0D;&#x540C;&#x7269;&#x7406;&#x7F51;&#x7EDC;&#x7684;&#x7EC6;&#x8282;&#x4EE5;&#x4FBF;&#x5411;&#x4E92;&#x8054;&#x7F51;&#x7EDC;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x4E3B;&#x673A;&#x5448;&#x73B0;&#x4E00;&#x4E2A;&#x7EDF;&#x4E00;&#x7684;&#x7F51;&#x7EDC;&#x67B6;&#x6784;&#xFF0C;&#x4F8B;&#x5982;&#xFF0C;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5355;&#x4E2A;&#x5730;&#x5740;&#x683C;&#x5F0F;&#x6765;&#x6807;&#x8BC6;&#x4E92;&#x8054;&#x7F51;&#x4E0A;&#x7684;&#x6240;&#x6709;&#x4E3B;&#x673A;&#x3002;</p>
<p>&#x5C3D;&#x7BA1;&#x5DF2;&#x7ECF;&#x8BBE;&#x8BA1;&#x51FA;&#x4E86;&#x591A;&#x79CD;&#x4E92;&#x8054;&#x7F51;&#x4E92;&#x8054;&#x534F;&#x8BAE;&#xFF0C;&#x4F46;TCP/IP&#x5DF2;&#x7ECF;&#x6210;&#x4E86;&#x4F7F;&#x7528;&#x4E3A;&#x6700;&#x5E7F;&#x6CDB;&#x7684;&#x534F;&#x8BAE;&#x5957;&#x4EF6;&#x4E86;&#xFF0C;&#x5B83;&#x751A;&#x81F3;&#x5DF2;&#x7ECF;&#x53D6;&#x4EE3;&#x4E86;&#x4E4B;&#x524D;&#x5728;&#x5C40;&#x57DF;&#x7F51;&#x548C;&#x5E7F;&#x57DF;&#x7F51;&#x4E2D;&#x5E38;&#x89C1;&#x7684;&#x79C1;&#x6709;&#x8054;&#x7F51;&#x534F;&#x8BAE;&#x4E86;&#x3002;&#x672F;&#x8BED;Internet&#xFF08;&#x5927;&#x5199;&#x7684;I&#xFF09;&#x88AB;&#x7528;&#x6765;&#x6307;&#x5C06;&#x5168;&#x7403;&#x6210;&#x5343;&#x4E0A;&#x4E07;&#x7684;&#x8BA1;&#x7B97;&#x673A;&#x8FDE;&#x63A5;&#x8D77;&#x6765;&#x7684;TCP/IP&#x4E92;&#x8054;&#x7F51;&#x3002;</p>
<p>&#x7B2C;&#x4E00;&#x4E2A;&#x88AB;&#x5E7F;&#x6CDB;&#x4F7F;&#x7528;&#x7684;TCP/IP&#x5B9E;&#x73B0;&#x51FA;&#x73B0;&#x5728;&#x4E86;1983&#x5E74;&#x7684;4.2BSD&#x4E2D;&#x3002;&#x4E00;&#x4E9B;TCP/IP&#x5B9E;&#x73B0;&#x662F;&#x76F4;&#x63A5;&#x4ECE;BSD&#x4EE3;&#x7801;&#x6F14;&#x5316;&#x800C;&#x6765;&#x7684;&#xFF0C;&#x5176;&#x4ED6;&#x7684;&#x5B9E;&#x73B0;&#xFF08;&#x5305;&#x62EC;Linux&#xFF09;&#x5219;&#x662F;&#x4ECE;&#x96F6;&#x5F00;&#x59CB;&#x7F16;&#x5199;&#x7684;&#xFF0C;&#x4F46;&#x5B83;&#x4EEC;&#x5728;&#x5B9A;&#x4E49;TCP/IP&#x7684;&#x64CD;&#x4F5C;&#x65F6;&#x5C06;BSD&#x4EE3;&#x7801;&#x7684;&#x64CD;&#x4F5C;&#x5F53;&#x6210;&#x4E86;&#x53C2;&#x8003;&#x6807;&#x51C6;&#x3002;</p>
<p>TCP/IP&#x662F;&#x4ECE;&#x7F8E;&#x56FD;&#x56FD;&#x9632;&#x90E8;&#x5148;&#x8FDB;&#x7814;&#x7A76;&#x9879;&#x76EE;&#x5C40;&#xFF08;Advanced Research Projects Agency&#xFF0C;ARPA&#xFF0C;&#x4E4B;&#x540E;&#x53C8;&#x88AB;&#x79F0;&#x4E3A;DARPA&#xFF0C;&#x5176;&#x4E2D;D&#x8868;&#x793A;Defense&#xFF09;&#x8D44;&#x52A9;&#x7684;&#x4E00;&#x4E2A;&#x9879;&#x76EE;&#x4E2D;&#x6210;&#x957F;&#x51FA;&#x6765;&#x7684;&#xFF0C;&#x8BE5;&#x9879;&#x76EE;&#x4E3B;&#x8981;&#x662F;&#x60F3;&#x8BBE;&#x8BA1;&#x51FA;&#x4E00;&#x4E2A;&#x8BA1;&#x7B97;&#x673A;&#x8054;&#x7F51;&#x67B6;&#x6784;&#x4EE5;&#x4F9B;&#x65E9;&#x671F;&#x7684;&#x5E7F;&#x57DF;&#x7F51;ARPANET&#x4F7F;&#x7528;&#x3002;&#x5728;20&#x4E16;&#x7EAA;70&#x5E74;&#x4EE3;&#xFF0C;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x534F;&#x8BAE;&#x65CF;&#x88AB;&#x8BBE;&#x8BA1;&#x51FA;&#x6765;&#x4F9B;ARPANET&#x4F7F;&#x7528;&#x3002;&#x51C6;&#x786E;&#x5730;&#x8BB2;&#xFF0C;&#x8FD9;&#x4E9B;&#x534F;&#x8BAE;&#x88AB;&#x79F0;&#x4E3A;DARPA&#x56E0;&#x7279;&#x7F51;&#x534F;&#x8BAE;&#x5957;&#x4EF6;&#xFF0C;&#x4F46;&#x5B83;&#x4EEC;&#x901A;&#x5E38;&#x88AB;&#x79F0;&#x4E3A;TCP/IP&#x534F;&#x8BAE;&#x5957;&#x4EF6;&#xFF0C;&#x6216;&#x8005;&#x7B80;&#x5355;&#x5730;&#x88AB;&#x79F0;&#x4E3A;TCP/IP&#x3002;</p>
<p>&#x7F51;&#x9875;<a href="https://www.isoc.org/internet/history/brief.shtml" target="_blank" rel="noopener">https://www.isoc.org/internet/history/brief.shtml</a> &#x63D0;&#x4F9B;&#x4E86;&#x4E0E;Internet&#x548C;TCP/IP&#x6709;&#x5173;&#x7684;&#x4E00;&#x6BB5;&#x7B80;&#x77ED;&#x7684;&#x5386;&#x53F2;&#x3002;</p>
<p>&#x4E00;&#x53F0;&#x8DEF;&#x7531;&#x5668;&#x62E5;&#x6709;&#x591A;&#x4E2A;&#x7F51;&#x7EDC;&#x63A5;&#x53E3;&#xFF0C;&#x6BCF;&#x4E2A;&#x63A5;&#x53E3;&#x90FD;&#x8FDE;&#x63A5;&#x5230;&#x4E00;&#x4E2A;&#x5B50;&#x7F51;&#x4E0A;&#x3002;&#x66F4;&#x901A;&#x7528;&#x7684;&#x672F;&#x8BED;&#x201C;&#x591A;&#x5BBF;&#x4E3B;&#x673A;&#x201D;&#x7528;&#x6765;&#x6307;&#x62E5;&#x6709;&#x591A;&#x4E2A;&#x7F51;&#x7EDC;&#x63A5;&#x53E3;&#x7684;&#x4EFB;&#x610F;&#x4E3B;&#x673A;&#x2014;&#x2014;&#x4E0D;&#x5FC5;&#x662F;&#x4E00;&#x53F0;&#x8DEF;&#x7531;&#x5668;&#x3002;&#xFF08;&#x53E6;&#x4E00;&#x79CD;&#x63CF;&#x8FF0;&#x8DEF;&#x7531;&#x5668;&#x7684;&#x65B9;&#x5F0F;&#x662F;&#x8BF4;&#x5B83;&#x662F;&#x5C06;&#x5305;&#x4ECE;&#x4E00;&#x4E2A;&#x5B50;&#x7F51;&#x8F6C;&#x53D1;&#x5230;&#x53E6;&#x4E00;&#x4E2A;&#x5B50;&#x7F51;&#x7684;&#x4E00;&#x53F0;&#x591A;&#x5BBF;&#x4E3B;&#x673A;&#x3002;&#xFF09;&#x4E00;&#x4E2A;&#x591A;&#x5BBF;&#x4E3B;&#x673A;&#x7684;&#x5404;&#x4E2A;&#x63A5;&#x53E3;&#x4E0A;&#x7684;&#x7F51;&#x7EDC;&#x5730;&#x5740;&#x662F;&#x4E0D;&#x540C;&#x7684;&#xFF08;&#x5373;&#x5176;&#x8FDE;&#x63A5;&#x7684;&#x5404;&#x4E2A;&#x5B50;&#x7F51;&#x7684;&#x5730;&#x5740;&#x662F;&#x4E0D;&#x540C;&#x7684;&#xFF09;&#x3002;</p>
<h2 id="&#x8054;&#x7F51;&#x534F;&#x8BAE;&#x548C;&#x5C42;"><a href="#&#x8054;&#x7F51;&#x534F;&#x8BAE;&#x548C;&#x5C42;" class="headerlink" title="&#x8054;&#x7F51;&#x534F;&#x8BAE;&#x548C;&#x5C42;"></a>&#x8054;&#x7F51;&#x534F;&#x8BAE;&#x548C;&#x5C42;</h2><p>&#x4E00;&#x4E2A;&#x8054;&#x7F51;&#x534F;&#x8BAE;&#x662F;&#x5B9A;&#x4E49;&#x5982;&#x4F55;&#x5728;&#x4E00;&#x4E2A;&#x7F51;&#x7EDC;&#x4E0A;&#x4F20;&#x8F93;&#x4FE1;&#x606F;&#x7684;&#x4E00;&#x7EC4;&#x89C4;&#x5219;&#x3002;&#x8054;&#x7F51;&#x534F;&#x8BAE;&#x901A;&#x5E38;&#x4F1A;&#x88AB;&#x7EC4;&#x7EC7;&#x6210;&#x4E00;&#x7CFB;&#x5217;&#x7684;&#x5C42;&#xFF0C;&#x5176;&#x4E2D;&#x6BCF;&#x4E00;&#x5C42;&#x90FD;&#x6784;&#x5EFA;&#x4E8E;&#x4E0B;&#x5C42;&#x4E4B;&#x4E0A;&#x5E76;&#x63D0;&#x4F9B;&#x7279;&#x6027;&#x4EE5;&#x4F9B;&#x4E0A;&#x5C42;&#x4F7F;&#x7528;&#x3002;</p>
<p>TCP/IP&#x534F;&#x8BAE;&#x5957;&#x4EF6;&#x662F;&#x4E00;&#x4E2A;&#x5206;&#x5C42;&#x8054;&#x7F51;&#x534F;&#x8BAE;&#xFF08;&#x56FE;58-2&#xFF09;&#xFF0C;&#x5B83;&#x5305;&#x62EC;&#x56E0;&#x7279;&#x7F51;&#x534F;&#x8BAE;&#xFF08;IP&#xFF09;&#x548C;&#x4F4D;&#x4E8E;&#x5176;&#x4E0A;&#x5C42;&#x7684;&#x5404;&#x4E2A;&#x534F;&#x8BAE;&#x5C42;&#x3002;&#xFF08;&#x5B9E;&#x73B0;&#x8FD9;&#x4E9B;&#x5C42;&#x7684;&#x4EE3;&#x7801;&#x901A;&#x5E38;&#x88AB;&#x79F0;&#x4E3A;&#x534F;&#x8BAE;&#x6808;&#x3002;&#xFF09;&#x540D;&#x5B57;TCP/IP&#x662F;&#x4ECE;&#x4F20;&#x8F93;&#x63A7;&#x5236;&#x534F;&#x8BAE;&#xFF08;TCP&#xFF09;&#x662F;&#x4F7F;&#x7528;&#x6700;&#x4E3A;&#x5E7F;&#x6CDB;&#x7684;&#x4F20;&#x8F93;&#x5C42;&#x534F;&#x8BAE;&#x8FD9;&#x6837;&#x4E00;&#x4E2A;&#x4E8B;&#x5B9E;&#x800C;&#x5F97;&#x51FA;&#x6765;&#x7684;&#x3002;</p>
<div class="amp-img-wrapper"><amp-img src="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1581850118330.png?x-oss-process=image/resize,m_lfit,h_450" width="443" height="450" layout="responsive"></amp-img></div><br>&#x5728;&#x56FE;58-2&#x4E2D;&#x7701;&#x7565;&#x4E86;&#x5176;&#x4ED6;&#x4E00;&#x4E9B;TCP/IP&#x534F;&#x8BAE;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x4EEC;&#x4E0E;&#x672C;&#x7AE0;&#x7684;&#x4E3B;&#x9898;&#x65E0;&#x5173;&#x3002;&#x5730;&#x5740;&#x89E3;&#x6790;&#x534F;&#x8BAE;&#xFF08;ARP&#xFF09;&#x5173;&#x6CE8;&#x7684;&#x662F;&#x5982;&#x4F55;&#x5C06;&#x56E0;&#x7279;&#x7F51;&#x5730;&#x5740;&#x6620;&#x5C04;&#x5230;&#x786C;&#x4EF6;&#xFF08;&#x5982;&#x4EE5;&#x592A;&#x7F51;&#xFF09;&#x5730;&#x5740;&#x3002;&#x56E0;&#x7279;&#x7F51;&#x63A7;&#x5236;&#x6D88;&#x606F;&#x534F;&#x8BAE;&#xFF08;ICMP&#xFF09;&#x7528;&#x6765;&#x5728;&#x7F51;&#x7EDC;&#x4E2D;&#x4F20;&#x8F93;&#x9519;&#x8BEF;&#x548C;&#x63A7;&#x5236;&#x4FE1;&#x606F;&#x3002;&#xFF08;ping&#x548C;traceroute&#x7A0B;&#x5E8F;&#x4F7F;&#x7528;&#x7684;&#x662F;ICMP&#x534F;&#x8BAE;&#xFF0C;&#x4EBA;&#x4EEC;&#x901A;&#x5E38;&#x4F7F;&#x7528;ping&#x6765;&#x68C0;&#x67E5;&#x4E00;&#x53F0;&#x7279;&#x5B9A;&#x7684;&#x4E3B;&#x673A;&#x662F;&#x5426;&#x5B58;&#x6D3B;&#x4EE5;&#x53CA;&#x662F;&#x5426;&#x5728;TCP/IP&#x7F51;&#x7EDC;&#x4E2D;&#x53EF;&#x89C1;&#xFF0C;&#x4F7F;&#x7528;traceroute&#x6765;&#x8DDF;&#x8E2A;&#x4E00;&#x4E2A;IP&#x5305;&#x5728;&#x7F51;&#x7EDC;&#x4E2D;&#x7684;&#x4F20;&#x8F93;&#x8DEF;&#x5F84;&#x3002;&#xFF09;&#x4E3B;&#x673A;&#x548C;&#x8DEF;&#x7531;&#x5668;&#x4F7F;&#x7528;&#x56E0;&#x7279;&#x7F51;&#x7EC4;&#x7BA1;&#x7406;&#x534F;&#x8BAE;&#xFF08;IGMP&#xFF09;&#x6765;&#x652F;&#x6301;IP&#x6570;&#x636E;&#x62A5;&#x7684;&#x591A;&#x64AD;&#x3002;
<p>&#x534F;&#x8BAE;&#x5206;&#x5C42;&#x5982;&#x6B64;&#x5F3A;&#x5927;&#x548C;&#x7075;&#x6D3B;&#x7684;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x539F;&#x56E0;&#x662F;&#x900F;&#x660E;&#x2014;&#x2014;&#x6BCF;&#x4E00;&#x4E2A;&#x534F;&#x8BAE;&#x5C42;&#x90FD;&#x5BF9;&#x4E0A;&#x5C42;&#x9690;&#x85CF;&#x4E0B;&#x5C42;&#x7684;&#x64CD;&#x4F5C;&#x548C;&#x590D;&#x6742;&#x6027;&#xFF0C;&#x5982;&#x4E00;&#x4E2A;&#x4F7F;&#x7528;TCP&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x53EA;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x6807;&#x51C6;&#x7684;socket API&#x5E76;&#x6E05;&#x695A;&#x81EA;&#x5DF1;&#x6B63;&#x5728;&#x4F7F;&#x7528;&#x4E00;&#x9879;&#x53EF;&#x9760;&#x7684;&#x5B57;&#x8282;&#x6D41;&#x4F20;&#x8F93;&#x670D;&#x52A1;&#xFF0C;&#x800C;&#x65E0;&#x9700;&#x7406;&#x89E3;TCP&#x64CD;&#x4F5C;&#x7684;&#x7EC6;&#x8282;&#x3002;&#xFF08;&#x5728;61.9&#x8282;&#x4E2D;&#x4ECB;&#x7ECD;socket&#x9009;&#x9879;&#x65F6;&#x5C06;&#x4F1A;&#x770B;&#x5230;&#x4E25;&#x683C;&#x5730;&#x8BB2;&#x8FD9;&#x4E00;&#x8BBA;&#x65AD;&#x5E76;&#x4E0D;&#x603B;&#x662F;&#x6B63;&#x786E;&#x7684;&#xFF0C;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5076;&#x5C14;&#x4E5F;&#x9700;&#x8981;&#x5F04;&#x6E05;&#x695A;&#x5E95;&#x5C42;&#x4F20;&#x8F93;&#x534F;&#x8BAE;&#x7684;&#x64CD;&#x4F5C;&#x7EC6;&#x8282;&#x3002;&#xFF09;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E5F;&#x65E0;&#x9700;&#x77E5;&#x9053;IP&#x548C;&#x6570;&#x636E;&#x94FE;&#x8DEF;&#x5C42;&#x7684;&#x64CD;&#x4F5C;&#x7EC6;&#x8282;&#x3002;&#x4ECE;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x89D2;&#x5EA6;&#x6765;&#x8BB2;&#xFF0C;&#x5B83;&#x5C31;&#x50CF;&#x662F;&#x901A;&#x8FC7;socket API&#x76F4;&#x63A5;&#x4E0E;&#x5176;&#x4ED6;&#x5C42;&#x8FDB;&#x884C;&#x901A;&#x4FE1;&#x4E86;&#xFF0C;&#x5982;&#x56FE;58-3&#x6240;&#x793A;&#xFF0C;&#x5176;&#x4E2D;&#x865A;&#x6A2A;&#x7EBF;&#x8868;&#x793A;&#x5BF9;&#x5E94;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E4B;&#x95F4;&#x7684;&#x865A;&#x62DF;&#x901A;&#x4FE1;&#x8DEF;&#x5F84;&#x4EE5;&#x53CA;&#x4E24;&#x4E2A;&#x4E3B;&#x673A;&#x4E0A;&#x7684;TCP&#x548C;IP&#x5B9E;&#x4F53;&#x3002;</p>
<div class="amp-img-wrapper"><amp-img src="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1581850153084.png?x-oss-process=image/resize,m_lfit,h_450" width="576" height="450" layout="responsive"></amp-img></div>
<h3 id="&#x5C01;&#x88C5;"><a href="#&#x5C01;&#x88C5;" class="headerlink" title="&#x5C01;&#x88C5;"></a>&#x5C01;&#x88C5;</h3><p>&#x5C01;&#x88C5;&#x662F;&#x5206;&#x5C42;&#x8054;&#x7F51;&#x534F;&#x8BAE;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x91CD;&#x8981;&#x7684;&#x539F;&#x5219;&#x3002;&#x56FE;58-4&#x7ED9;&#x51FA;&#x4E86;TCP/IP&#x534F;&#x8BAE;&#x5C42;&#x4E2D;&#x7684;&#x5C01;&#x88C5;&#x3002;&#x5C01;&#x88C5;&#x4E2D;&#x7684;&#x5173;&#x952E;&#x6982;&#x5FF5;&#x662F;&#x4F4E;&#x5C42;&#x4F1A;&#x5C06;&#x4ECE;&#x9AD8;&#x5C42;&#x5411;&#x4F4E;&#x5C42;&#x4F20;&#x9012;&#x7684;&#x4FE1;&#x606F;&#xFF08;&#x5982;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x6570;&#x636E;&#x3001;TCP&#x6BB5;&#x3001;IP&#x6570;&#x636E;&#x62A5;&#xFF09;&#x5F53;&#x6210;&#x4E0D;&#x900F;&#x660E;&#x7684;&#x6570;&#x636E;&#x6765;&#x5904;&#x7406;&#x3002;&#x6362;&#x53E5;&#x8BDD;&#x8BF4;&#xFF0C;&#x4F4E;&#x5C42;&#x4E0D;&#x4F1A;&#x5C1D;&#x8BD5;&#x5BF9;&#x9AD8;&#x5C42;&#x53D1;&#x9001;&#x8FC7;&#x6765;&#x7684;&#x4FE1;&#x606F;&#x8FDB;&#x884C;&#x89E3;&#x91CA;&#xFF0C;&#x800C;&#x53EA;&#x4F1A;&#x5C06;&#x8FD9;&#x4E9B;&#x4FE1;&#x606F;&#x653E;&#x5230;&#x4F4E;&#x5C42;&#x6240;&#x4F7F;&#x7528;&#x7684;&#x5305;&#x4E2D;&#x5E76;&#x5728;&#x5C06;&#x8FD9;&#x4E2A;&#x5305;&#x5411;&#x4E0B;&#x4F20;&#x9012;&#x5230;&#x4F4E;&#x5C42;&#x4E4B;&#x524D;&#x6DFB;&#x52A0;&#x81EA;&#x8EAB;&#x8FD9;&#x4E00;&#x5C42;&#x7684;&#x5934;&#x4FE1;&#x606F;&#x3002;&#x5F53;&#x6570;&#x636E;&#x4ECE;&#x4F4E;&#x5C42;&#x4F20;&#x9012;&#x5230;&#x9AD8;&#x5C42;&#x65F6;&#x5C06;&#x4F1A;&#x8FDB;&#x884C;&#x4E00;&#x4E2A;&#x9006;&#x5411;&#x7684;&#x89E3;&#x5305;&#x8FC7;&#x7A0B;&#x3002;<br></p><div class="amp-img-wrapper"><amp-img src="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1581850188783.png?x-oss-process=image/resize,m_lfit,h_450" width="540" height="450" layout="responsive"></amp-img></div>
<p>&#x5C01;&#x88C5;&#x7684;&#x6982;&#x5FF5;&#x8FD8;&#x5EF6;&#x4F38;&#x5230;&#x4E86;&#x6570;&#x636E;&#x94FE;&#x8DEF;&#x5C42;&#xFF0C;&#x5176;&#x4E2D;IP&#x6570;&#x636E;&#x62A5;&#x4F1A;&#x88AB;&#x5C01;&#x88C5;&#x8FDB;&#x7F51;&#x7EDC;&#x5E27;&#x4E2D;&#xFF0C;&#x4F46;&#x5728;&#x56FE;58-4&#x4E2D;&#x5E76;&#x6CA1;&#x6709;&#x663E;&#x793A;&#x51FA;&#x8FD9;&#x4E9B;&#x3002;&#x5C01;&#x88C5;&#x53EF;&#x80FD;&#x8FD8;&#x4F1A;&#x5EF6;&#x4F38;&#x5230;&#x5E94;&#x7528;&#x5C42;&#x4E2D;&#xFF0C;&#x5176;&#x4E2D;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x53EF;&#x80FD;&#x4F1A;&#x6309;&#x7167;&#x81EA;&#x5DF1;&#x7684;&#x65B9;&#x5F0F;&#x5BF9;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x6253;&#x5305;&#x3002;</p>
<h2 id="&#x6570;&#x636E;&#x94FE;&#x8DEF;&#x5C42;"><a href="#&#x6570;&#x636E;&#x94FE;&#x8DEF;&#x5C42;" class="headerlink" title="&#x6570;&#x636E;&#x94FE;&#x8DEF;&#x5C42;"></a>&#x6570;&#x636E;&#x94FE;&#x8DEF;&#x5C42;</h2><p>&#x56FE;58-2&#x4E2D;&#x7684;&#x6700;&#x4F4E;&#x5C42;&#x662F;&#x6570;&#x636E;&#x94FE;&#x8DEF;&#x5C42;&#xFF0C;&#x5B83;&#x7531;&#x8BBE;&#x5907;&#x9A71;&#x52A8;&#x548C;&#x5230;&#x5E95;&#x5C42;&#x7269;&#x7406;&#x5A92;&#x4ECB;&#xFF08;&#x5982;&#x7535;&#x8BDD;&#x7EBF;&#x3001;&#x540C;&#x8F74;&#x7535;&#x7F06;&#x3001;&#x6216;&#x5149;&#x7EA4;&#xFF09;&#x7684;&#x786C;&#x4EF6;&#x63A5;&#x53E3;&#xFF08;&#x7F51;&#x5361;&#xFF09;&#x6784;&#x6210;&#x3002;&#x6570;&#x636E;&#x94FE;&#x8DEF;&#x5C42;&#x5173;&#x6CE8;&#x7684;&#x662F;&#x5728;&#x4E00;&#x4E2A;&#x7F51;&#x7EDC;&#x7684;&#x7269;&#x7406;&#x94FE;&#x63A5;&#x4E0A;&#x4F20;&#x8F93;&#x6570;&#x636E;&#x3002;</p>
<p>&#x8981;&#x4F20;&#x8F93;&#x6570;&#x636E;&#xFF0C;&#x6570;&#x636E;&#x94FE;&#x8DEF;&#x5C42;&#x9700;&#x8981;&#x5C06;&#x7F51;&#x7EDC;&#x5C42;&#x4F20;&#x9012;&#x8FC7;&#x6765;&#x7684;&#x6570;&#x636E;&#x62A5;&#x5C01;&#x88C5;&#x8FDB;&#x88AB;&#x79F0;&#x4E3A;&#x5E27;&#x7684;&#x4E00;&#x4E2A;&#x4E00;&#x4E2A;&#x5355;&#x5143;&#x3002;&#x9664;&#x4E86;&#x9700;&#x8981;&#x4F20;&#x8F93;&#x7684;&#x6570;&#x636E;&#x4E4B;&#x5916;&#xFF0C;&#x6BCF;&#x4E2A;&#x5E27;&#x90FD;&#x4F1A;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x5934;&#xFF0C;&#x5982;&#x5934;&#x4E2D;&#x53EF;&#x80FD;&#x5305;&#x542B;&#x4E86;&#x76EE;&#x6807;&#x5730;&#x5740;&#x548C;&#x5E27;&#x7684;&#x5927;&#x5C0F;&#x3002;&#x6570;&#x636E;&#x94FE;&#x8DEF;&#x5C42;&#x5728;&#x7269;&#x7406;&#x94FE;&#x63A5;&#x4E0A;&#x4F20;&#x8F93;&#x5E27;&#x5E76;&#x5904;&#x7406;&#x6765;&#x81EA;&#x63A5;&#x6536;&#x8005;&#x7684;&#x786E;&#x8BA4;&#x3002;&#xFF08;&#x4E0D;&#x662F;&#x6240;&#x6709;&#x7684;&#x6570;&#x636E;&#x94FE;&#x8DEF;&#x5C42;&#x90FD;&#x4F7F;&#x7528;&#x786E;&#x8BA4;&#x3002;&#xFF09;&#x8FD9;&#x4E00;&#x5C42;&#x53EF;&#x80FD;&#x4F1A;&#x8FDB;&#x884C;&#x9519;&#x8BEF;&#x68C0;&#x6D4B;&#x3001;&#x91CD;&#x4F20;&#x4EE5;&#x53CA;&#x6D41;&#x91CF;&#x63A7;&#x5236;&#x3002;&#x4E00;&#x4E9B;&#x6570;&#x636E;&#x94FE;&#x8DEF;&#x5C42;&#x8FD8;&#x53EF;&#x80FD;&#x4F1A;&#x5C06;&#x5927;&#x7684;&#x7F51;&#x7EDC;&#x5305;&#x5206;&#x5272;&#x6210;&#x591A;&#x4E2A;&#x5E27;&#x5E76;&#x5728;&#x63A5;&#x6536;&#x8005;&#x7AEF;&#x5BF9;&#x8FD9;&#x4E9B;&#x5E27;&#x8FDB;&#x884C;&#x91CD;&#x7EC4;&#x3002;</p>
<p>&#x4ECE;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7F16;&#x7A0B;&#x7684;&#x89D2;&#x5EA6;&#x6765;&#x8BB2;&#x901A;&#x5E38;&#x53EF;&#x4EE5;&#x5FFD;&#x7565;&#x6570;&#x636E;&#x94FE;&#x8DEF;&#x5C42;&#xFF0C;&#x56E0;&#x4E3A;&#x6240;&#x6709;&#x7684;&#x901A;&#x4FE1;&#x7EC6;&#x8282;&#x90FD;&#x662F;&#x7531;&#x9A71;&#x52A8;&#x548C;&#x786C;&#x4EF6;&#x6765;&#x5904;&#x7406;&#x7684;&#x3002;</p>
<p>&#x5BF9;&#x4E8E;&#x6709;&#x5173;IP&#x7684;&#x8BA8;&#x8BBA;&#x6765;&#x8BB2;&#xFF0C;&#x6570;&#x636E;&#x94FE;&#x8DEF;&#x5C42;&#x4E2D;&#x6BD4;&#x8F83;&#x91CD;&#x8981;&#x7684;&#x4E00;&#x4E2A;&#x7279;&#x70B9;&#x662F;&#x6700;&#x5927;&#x4F20;&#x8F93;&#x5355;&#x5143;&#xFF08;MTU&#xFF09;&#x3002;&#x6570;&#x636E;&#x94FE;&#x8DEF;&#x5C42;&#x7684;MTU&#x662F;&#x8BE5;&#x5C42;&#x6240;&#x80FD;&#x4F20;&#x8F93;&#x7684;&#x5E27;&#x5927;&#x5C0F;&#x7684;&#x4E0A;&#x9650;&#x3002;&#x4E0D;&#x540C;&#x7684;&#x6570;&#x636E;&#x94FE;&#x8DEF;&#x5C42;&#x7684;MTU&#x662F;&#x4E0D;&#x540C;&#x7684;&#x3002;</p>
<p>&#x547D;&#x4EE4;netstat &#x2013;i&#x4F1A;&#x5217;&#x51FA;&#x7CFB;&#x7EDF;&#x4E2D;&#x7684;&#x7F51;&#x7EDC;&#x63A5;&#x53E3;&#xFF0C;&#x5305;&#x62EC;&#x5176;MTU&#x3002;</p>
<h2 id="&#x7F51;&#x7EDC;&#x5C42;&#xFF1A;IP"><a href="#&#x7F51;&#x7EDC;&#x5C42;&#xFF1A;IP" class="headerlink" title="&#x7F51;&#x7EDC;&#x5C42;&#xFF1A;IP"></a>&#x7F51;&#x7EDC;&#x5C42;&#xFF1A;IP</h2><p>&#x4F4D;&#x4E8E;&#x6570;&#x636E;&#x94FE;&#x8DEF;&#x5C42;&#x4E4B;&#x4E0A;&#x7684;&#x662F;&#x7F51;&#x7EDC;&#x5C42;&#xFF0C;&#x5B83;&#x5173;&#x6CE8;&#x7684;&#x662F;&#x5982;&#x4F55;&#x5C06;&#x5305;&#xFF08;&#x6570;&#x636E;&#xFF09;&#x4ECE;&#x6E90;&#x4E3B;&#x673A;&#x53D1;&#x9001;&#x5230;&#x76EE;&#x6807;&#x4E3B;&#x673A;&#x3002;&#x8FD9;&#x4E00;&#x5C42;&#x6267;&#x884C;&#x4E86;&#x5F88;&#x591A;&#x4EFB;&#x52A1;&#xFF0C;&#x5305;&#x62EC;&#x4EE5;&#x4E0B;&#x51E0;&#x4E2A;&#x3002;</p>
<ul>
<li>&#x5C06;&#x6570;&#x636E;&#x5206;&#x89E3;&#x6210;&#x8DB3;&#x591F;&#x5C0F;&#x7684;&#x7247;&#x6BB5;&#x4EE5;&#x4FBF;&#x6570;&#x636E;&#x94FE;&#x8DEF;&#x5C42;&#x8FDB;&#x884C;&#x4F20;&#x8F93;&#xFF08;&#x5982;&#x6709;&#x5FC5;&#x8981;&#x7684;&#x8BDD;&#xFF09;&#x3002;</li>
<li>&#x5728;&#x56E0;&#x7279;&#x7F51;&#x4E0A;&#x8DEF;&#x7531;&#x6570;&#x636E;&#x3002;</li>
<li>&#x4E3A;&#x4F20;&#x8F93;&#x5C42;&#x63D0;&#x4F9B;&#x670D;&#x52A1;&#x3002;</li>
</ul>
<p>&#x5728;TCP/IP&#x534F;&#x8BAE;&#x5957;&#x4EF6;&#x4E2D;&#xFF0C;&#x7F51;&#x7EDC;&#x5C42;&#x7684;&#x4E3B;&#x8981;&#x534F;&#x8BAE;&#x662F;IP&#x3002;&#x5728;4.2BSD&#x5B9E;&#x73B0;&#x4E2D;&#x51FA;&#x73B0;&#x7684;IP&#x7684;&#x7248;&#x672C;&#x662F;IP&#x7248;&#x672C;4&#xFF08;IPv4&#xFF09;&#x3002;&#x5728;20&#x4E16;&#x7EAA;90&#x5E74;&#x4EE3;&#x65E9;&#x671F;&#x8BBE;&#x8BA1;&#x51FA;&#x4E86;IP&#x7684;&#x4E00;&#x4E2A;&#x4FEE;&#x6B63;&#x7248;&#xFF1A;IP&#x7248;&#x672C;6&#xFF08;IPv6&#xFF09;&#x3002;&#x8FD9;&#x4E24;&#x4E2A;&#x7248;&#x672C;&#x4E4B;&#x95F4;&#x6700;&#x663E;&#x8457;&#x7684;&#x5DEE;&#x522B;&#x5728;&#x4E8E;IPv4&#x4F7F;&#x7528;32&#x4F4D;&#x5730;&#x5740;&#x6765;&#x6807;&#x8BC6;&#x5B50;&#x7F51;&#x548C;&#x4E3B;&#x673A;&#xFF0C;&#x800C;IPv6&#x5219;&#x4F7F;&#x7528;&#x4E86;128&#x4F4D;&#x7684;&#x5730;&#x5740;&#xFF0C;&#x4ECE;&#x800C;&#x80FD;&#x4E3A;&#x4E3B;&#x673A;&#x63D0;&#x4F9B;&#x66F4;&#x5927;&#x7684;&#x5730;&#x5740;&#x8303;&#x56F4;&#x3002;&#x867D;&#x7136;&#x76EE;&#x524D;&#x5728;&#x56E0;&#x7279;&#x7F51;&#x4E0A;IPv4&#x4ECD;&#x7136;&#x662F;&#x4F7F;&#x7528;&#x6700;&#x5E7F;&#x7684;IP&#x7248;&#x672C;&#xFF0C;&#x4F46;&#x5728;&#x5C06;&#x6765;&#x5B83;&#x4F1A;&#x88AB;IPv6&#x6240;&#x53D6;&#x4EE3;&#x3002;IPv4&#x548C;IPv6&#x90FD;&#x652F;&#x6301;&#x9AD8;&#x5C42;&#x7684;UDP&#x548C;TCP&#x4F20;&#x8F93;&#x5C42;&#x534F;&#x8BAE;&#xFF08;&#x4EE5;&#x53CA;&#x5F88;&#x591A;&#x5176;&#x4ED6;&#x534F;&#x8BAE;&#xFF09;&#x3002;</p>
<p>&#x5C3D;&#x7BA1;&#x4ECE;&#x7406;&#x8BBA;&#x4E0A;&#x6765;&#x8BB2;&#xFF0C;32&#x4F4D;&#x7684;&#x5730;&#x5740;&#x7A7A;&#x95F4;&#x63D0;&#x4F9B;&#x4E86;&#x6570;&#x4EE5;&#x4EBF;&#x8BA1;&#x7684;IPv4&#x7F51;&#x7EDC;&#x5730;&#x5740;&#xFF0C;&#x4F46;&#x5730;&#x5740;&#x7684;&#x7ED3;&#x6784;&#x548C;&#x5206;&#x914D;&#x653E;&#x7F6E;&#x51B3;&#x5B9A;&#x4E86;&#x5B9E;&#x9645;&#x53EF;&#x7528;&#x7684;&#x5730;&#x5740;&#x6570;&#x91CF;&#x8981;&#x5C11;&#x8BB8;&#x591A;&#x3002;IPv4&#x5730;&#x5740;&#x7A7A;&#x95F4;&#x7684;&#x67AF;&#x7AED;&#x662F;&#x521B;&#x9020;IPv6&#x4E3B;&#x8981;&#x539F;&#x56E0;&#x3002;</p>
<p>&#x6709;&#x5173;IPv6&#x7684;&#x7B80;&#x53F2;&#x53EF;&#x5728;<a href="https://www.laynetworks.com/IPv6.htm" target="_blank" rel="noopener">https://www.laynetworks.com/IPv6.htm</a> &#x5904;&#x627E;&#x5230;&#x3002;</p>
<p>IPv4&#x548C;IPv6&#x7684;&#x5B58;&#x5728;&#x5F15;&#x51FA;&#x4E86;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#x201C;IPv5&#x5462;&#xFF1F;&#x201D;&#x4E8B;&#x5B9E;&#x4E0A;&#x4ECE;&#x6765;&#x5C31;&#x6CA1;&#x6709;IPv5&#x8FD9;&#x79CD;&#x4E1C;&#x897F;&#x3002;&#x6BCF;&#x4E2A;IP&#x6570;&#x636E;&#x62A5;&#x5934;&#x90FD;&#x5305;&#x542B;&#x4E00;&#x4E2A;4&#x4F4D;&#x7684;&#x7248;&#x672C;&#x53F7;&#x5B57;&#x6BB5;&#xFF08;&#x5373;IPv4&#x6570;&#x636E;&#x62A5;&#x7684;&#x8FD9;&#x4E2A;&#x5B57;&#x6BB5;&#x503C;&#x603B;&#x662F;&#x6570;&#x5B57;4&#xFF09;&#xFF0C;&#x800C;&#x7248;&#x672C;&#x53F7;5&#x5219;&#x88AB;&#x6307;&#x6D3E;&#x7ED9;&#x4E86;&#x4E00;&#x4E2A;&#x8BD5;&#x9A8C;&#x534F;&#x8BAE;&#x56E0;&#x7279;&#x7F51;&#x6D41;&#x534F;&#x8BAE;Internet Stream Protocol&#x3002;&#xFF08;RFC 1819&#x63CF;&#x8FF0;&#x4E86;&#x8FD9;&#x4E2A;&#x534F;&#x8BAE;&#x7684;&#x7B2C;&#x4E8C;&#x7248;&#xFF0C;&#x7B80;&#x5199;&#x4E3A;ST-II&#x3002;&#xFF09;&#x5728;20&#x4E16;&#x7EAA;70&#x5E74;&#x4EE3;&#x6700;&#x521D;&#x6784;&#x60F3;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x8FD9;&#x4E2A;&#x9762;&#x5411;&#x8FDE;&#x63A5;&#x7684;&#x534F;&#x8BAE;&#x5C31;&#x88AB;&#x8BBE;&#x8BA1;&#x6210;&#x652F;&#x6301;&#x97F3;&#x9891;&#x548C;&#x89C6;&#x9891;&#x4F20;&#x8F93;&#x4EE5;&#x53CA;&#x5206;&#x5E03;&#x5F0F;&#x4EFF;&#x771F;&#x3002;&#x7531;&#x4E8E;IP&#x6570;&#x636E;&#x62A5;&#x7248;&#x672C;&#x53F7;5&#x5DF2;&#x7ECF;&#x88AB;&#x6307;&#x6D3E;&#x8FC7;&#x4E86;&#xFF0C;&#x56E0;&#x6B64;IPv4&#x7684;&#x5347;&#x7EA7;&#x7248;&#x5C31;&#x4F7F;&#x7528;&#x4E86;&#x7248;&#x672C;&#x53F7;6&#x3002;</p>
<p>&#x56FE;58-2&#x7ED9;&#x51FA;&#x4E86;&#x4E00;&#x4E2A;&#x88F8;socket&#xFF08;SOCK_RAW&#xFF09;&#xFF0C;&#x5B83;&#x5141;&#x8BB8;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x76F4;&#x63A5;&#x4E0E;IP&#x5C42;&#x8FDB;&#x884C;&#x901A;&#x4FE1;&#x3002;&#x8FD9;&#x91CC;&#x4E0D;&#x4F1A;&#x5BF9;&#x88F8;socket&#x7684;&#x4F7F;&#x7528;&#x8FDB;&#x884C;&#x63CF;&#x8FF0;&#xFF0C;&#x56E0;&#x4E3A;&#x5927;&#x591A;&#x6570;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4F1A;&#x4F7F;&#x7528;&#x57FA;&#x4E8E;&#x5176;&#x4E2D;&#x4E00;&#x79CD;&#x4F20;&#x8F93;&#x5C42;&#x534F;&#x8BAE;&#xFF08;TCP&#x6216;UDP&#xFF09;&#x4E4B;&#x4E0A;&#x7684;socket&#x3002;[Stevens et al., 2004]&#x7684;&#x7B2C;28&#x7AE0;&#x5BF9;&#x88F8;socket&#x8FDB;&#x884C;&#x4E86;&#x63CF;&#x8FF0;&#x3002;&#x6709;&#x5173;&#x88F8;socket&#x7684;&#x4F7F;&#x7528;&#x65B9;&#x9762;&#x7684;&#x4E00;&#x4E2A;&#x5BCC;&#x6709;&#x6559;&#x80B2;&#x610F;&#x4E49;&#x7684;&#x4F8B;&#x5B50;&#x662F;sendip&#x7A0B;&#x5E8F;&#xFF08;<a href="https://www.earth.li/projectpurple/progs/sendip.html" target="_blank" rel="noopener">https://www.earth.li/projectpurple/progs/sendip.html</a> &#xFF09;&#xFF0C;&#x5B83;&#x662F;&#x4E00;&#x4E2A;&#x547D;&#x4EE4;&#x884C;&#x9A71;&#x52A8;&#x7684;&#x5DE5;&#x5177;&#xFF0C;&#x5141;&#x8BB8;&#x4F7F;&#x7528;&#x4EFB;&#x610F;&#x5185;&#x5BB9;&#x6765;&#x6784;&#x5EFA;&#x548C;&#x4F20;&#x8F93;IP&#x6570;&#x636E;&#x62A5;&#xFF08;&#x5305;&#x62EC;&#x6784;&#x5EFA;UDP&#x6570;&#x636E;&#x62A5;&#x548C;TCP&#x6BB5;&#x7684;&#x9009;&#x9879;&#xFF09;&#x3002;</p>
<h3 id="IP&#x4F20;&#x8F93;&#x6570;&#x636E;&#x62A5;"><a href="#IP&#x4F20;&#x8F93;&#x6570;&#x636E;&#x62A5;" class="headerlink" title="IP&#x4F20;&#x8F93;&#x6570;&#x636E;&#x62A5;"></a>IP&#x4F20;&#x8F93;&#x6570;&#x636E;&#x62A5;</h3><p>IP&#x4EE5;&#x6570;&#x636E;&#x62A5;&#xFF08;&#x5305;&#xFF09;&#x7684;&#x5F62;&#x5F0F;&#x6765;&#x4F20;&#x8F93;&#x6570;&#x636E;&#x3002;&#x5728;&#x4E24;&#x4E2A;&#x4E3B;&#x673A;&#x4E4B;&#x95F4;&#x53D1;&#x9001;&#x7684;&#x6BCF;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x62A5;&#x90FD;&#x662F;&#x5728;&#x7F51;&#x7EDC;&#x4E0A;&#x72EC;&#x7ACB;&#x4F20;&#x8F93;&#x7684;&#xFF0C;&#x5B83;&#x4EEC;&#x7ECF;&#x8FC7;&#x7684;&#x8DEF;&#x5F84;&#x53EF;&#x80FD;&#x4F1A;&#x4E0D;&#x540C;&#x3002;&#x4E00;&#x4E2A;IP&#x6570;&#x636E;&#x62A5;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x5934;&#xFF0C;&#x5176;&#x5927;&#x5C0F;&#x8303;&#x56F4;&#x4E3A;20&#x5B57;&#x8282;&#x5230;60&#x5B57;&#x8282;&#x3002;&#x8FD9;&#x4E2A;&#x5934;&#x4E2D;&#x5305;&#x542B;&#x4E86;&#x76EE;&#x6807;&#x4E3B;&#x673A;&#x7684;&#x5730;&#x5740;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x53EF;&#x4EE5;&#x5728;&#x7F51;&#x7EDC;&#x4E0A;&#x5C06;&#x8FD9;&#x4E2A;&#x6570;&#x636E;&#x62A5;&#x8DEF;&#x7531;&#x5230;&#x76EE;&#x6807;&#x5730;&#x5740;&#x4E86;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x5B83;&#x8FD8;&#x5305;&#x542B;&#x4E86;&#x5305;&#x7684;&#x6E90;&#x5730;&#x5740;&#xFF0C;&#x8FD9;&#x6837;&#x63A5;&#x6536;&#x4E3B;&#x673A;&#x5C31;&#x77E5;&#x9053;&#x6570;&#x636E;&#x62A5;&#x7684;&#x6E90;&#x5934;&#x3002;</p>
<p>&#x53D1;&#x9001;&#x4E3B;&#x673A;&#x53EF;&#x4EE5;&#x4F2A;&#x9020;&#x4E00;&#x4E2A;&#x5305;&#x7684;&#x6E90;&#x5730;&#x5740;&#xFF0C;&#x8FD9;&#x4E5F;&#x662F;SYN&#x6D2A;&#x6CDB;&#x8FD9;&#x79CD;TCP&#x62D2;&#x7EDD;&#x670D;&#x52A1;&#x653B;&#x51FB;&#x7684;&#x57FA;&#x7840;&#x3002;[Lemon, 2002]&#x63CF;&#x8FF0;&#x4E86;&#x8FD9;&#x79CD;&#x653B;&#x51FB;&#x7684;&#x7EC6;&#x8282;&#x4EE5;&#x53CA;&#x73B0;&#x4EE3;TCP&#x5B9E;&#x73B0;&#x4E3A;&#x89E3;&#x51B3;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x6240;&#x91C7;&#x53D6;&#x7684;&#x63AA;&#x65BD;&#x3002;</p>
<p>&#x4E00;&#x4E2A;IP&#x5B9E;&#x73B0;&#x53EF;&#x80FD;&#x4F1A;&#x7ED9;&#x5B83;&#x6240;&#x652F;&#x6301;&#x7684;&#x6570;&#x636E;&#x62A5;&#x7684;&#x5927;&#x5C0F;&#x8BBE;&#x5B9A;&#x4E00;&#x4E2A;&#x4E0A;&#x9650;&#x3002;&#x6240;&#x6709;IP&#x5B9E;&#x73B0;&#x90FD;&#x5FC5;&#x987B;&#x505A;&#x5230;&#x6570;&#x636E;&#x62A5;&#x7684;&#x5927;&#x5C0F;&#x4E0A;&#x9650;&#x81F3;&#x5C11;&#x4E0E;&#x89C4;&#x5B9A;&#x7684;IP&#x6700;&#x5C0F;&#x91CD;&#x7EC4;&#x7F13;&#x51B2;&#x533A;&#x5927;&#x5C0F;&#xFF08;minimum reassembly buffer size&#xFF09;&#x4E00;&#x6837;&#x5927;&#x3002;&#x5728;IPv4&#x4E2D;&#xFF0C;&#x8FD9;&#x4E2A;&#x9650;&#x5236;&#x503C;&#x662F;576&#x5B57;&#x8282;&#xFF1B;&#x5728;IPv6&#x4E2D;&#xFF0C;&#x8FD9;&#x4E2A;&#x9650;&#x5236;&#x503C;&#x662F;1500&#x5B57;&#x8282;&#x3002;</p>
<h3 id="IP&#x662F;&#x65E0;&#x8FDE;&#x63A5;&#x548C;&#x4E0D;&#x53EF;&#x9760;&#x7684;"><a href="#IP&#x662F;&#x65E0;&#x8FDE;&#x63A5;&#x548C;&#x4E0D;&#x53EF;&#x9760;&#x7684;" class="headerlink" title="IP&#x662F;&#x65E0;&#x8FDE;&#x63A5;&#x548C;&#x4E0D;&#x53EF;&#x9760;&#x7684;"></a>IP&#x662F;&#x65E0;&#x8FDE;&#x63A5;&#x548C;&#x4E0D;&#x53EF;&#x9760;&#x7684;</h3><p>IP&#x662F;&#x4E00;&#x79CD;&#x65E0;&#x8FDE;&#x63A5;&#x534F;&#x8BAE;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x5E76;&#x6CA1;&#x6709;&#x5728;&#x76F8;&#x4E92;&#x8FDE;&#x63A5;&#x7684;&#x4E24;&#x4E2A;&#x4E3B;&#x673A;&#x4E4B;&#x95F4;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;&#x865A;&#x62DF;&#x7535;&#x8DEF;&#x3002;IP&#x4E5F;&#x662F;&#x4E00;&#x79CD;&#x4E0D;&#x53EF;&#x9760;&#x7684;&#x534F;&#x8BAE;&#xFF1A;&#x5B83;&#x5C3D;&#x6700;&#x5927;&#x53EF;&#x80FD;&#x5C06;&#x6570;&#x636E;&#x62A5;&#x4ECE;&#x53D1;&#x9001;&#x8005;&#x4F20;&#x8F93;&#x7ED9;&#x63A5;&#x6536;&#x8005;&#xFF0C;&#x4F46;&#x5E76;&#x4E0D;&#x4FDD;&#x8BC1;&#x5305;&#x5230;&#x8FBE;&#x7684;&#x987A;&#x5E8F;&#x4F1A;&#x4E0E;&#x5B83;&#x4EEC;&#x88AB;&#x4F20;&#x8F93;&#x7684;&#x987A;&#x5E8F;&#x4E00;&#x81F4;&#xFF0C;&#x4E5F;&#x4E0D;&#x4FDD;&#x8BC1;&#x5305;&#x662F;&#x5426;&#x91CD;&#x590D;&#xFF0C;&#x751A;&#x81F3;&#x90FD;&#x4E0D;&#x4FDD;&#x8BC1;&#x5305;&#x662F;&#x5426;&#x4F1A;&#x8FBE;&#x5230;&#x63A5;&#x6536;&#x8005;&#x3002;IP&#x4E5F;&#x6CA1;&#x6709;&#x63D0;&#x4F9B;&#x9519;&#x8BEF;&#x6062;&#x590D;&#xFF08;&#x5934;&#x4FE1;&#x606F;&#x9519;&#x8BEF;&#x7684;&#x5305;&#x4F1A;&#x88AB;&#x9759;&#x9ED8;&#x5730;&#x4E22;&#x5F03;&#xFF09;&#x3002;&#x53EF;&#x9760;&#x6027;&#x662F;&#x901A;&#x8FC7;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x53EF;&#x9760;&#x7684;&#x4F20;&#x8F93;&#x5C42;&#x534F;&#x8BAE;&#xFF08;&#x5982;TCP&#xFF09;&#x6216;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x672C;&#x8EAB;&#x6765;&#x4FDD;&#x8BC1;&#x7684;&#x3002;</p>
<p>IPv4&#x4E3A;IP&#x5934;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x6821;&#x9A8C;&#x548C;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x80FD;&#x591F;&#x68C0;&#x6D4B;&#x51FA;&#x5934;&#x4E2D;&#x7684;&#x9519;&#x8BEF;&#xFF0C;&#x4F46;&#x5E76;&#x6CA1;&#x6709;&#x4E3A;&#x5305;&#x4E2D;&#x6240;&#x4F20;&#x8F93;&#x7684;&#x6570;&#x636E;&#x63D0;&#x4F9B;&#x4EFB;&#x4F55;&#x9519;&#x8BEF;&#x68C0;&#x6D4B;&#x673A;&#x5236;&#x3002;IPv6&#x5E76;&#x6CA1;&#x6709;&#x4E3A;IP&#x5934;&#x63D0;&#x4F9B;&#x68C0;&#x9A8C;&#x548C;&#xFF0C;&#x5B83;&#x4F9D;&#x8D56;&#x9AD8;&#x5C42;&#x534F;&#x8BAE;&#x6765;&#x5B8C;&#x6210;&#x9519;&#x8BEF;&#x68C0;&#x6D4B;&#x548C;&#x53EF;&#x9760;&#x6027;&#x3002;&#xFF08;UDP&#x6821;&#x9A8C;&#x548C;&#x5728;IPv4&#x662F;&#x53EF;&#x9009;&#x7684;&#xFF0C;&#x4F46;&#x4E00;&#x822C;&#x6765;&#x8BB2;&#x90FD;&#x662F;&#x542F;&#x7528;&#x7684;&#xFF1B;UDP&#x6821;&#x9A8C;&#x548C;&#x5728;IPv6&#x662F;&#x5F3A;&#x5236;&#x7684;&#x3002;TCP&#x6821;&#x9A8C;&#x548C;&#x5728;IPv4&#x548C;IPv6&#x4E2D;&#x90FD;&#x662F;&#x5F3A;&#x5236;&#x7684;&#x3002;&#xFF09;</p>
<p>IP&#x6570;&#x636E;&#x62A5;&#x7684;&#x91CD;&#x590D;&#x662F;&#x53EF;&#x80FD;&#x53D1;&#x751F;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#x4E00;&#x4E9B;&#x6570;&#x636E;&#x94FE;&#x8DEF;&#x5C42;&#x91C7;&#x7528;&#x4E86;&#x4E00;&#x4E9B;&#x6280;&#x672F;&#x6765;&#x786E;&#x4FDD;&#x53EF;&#x9760;&#x6027;&#x4EE5;&#x53CA;IP&#x6570;&#x636E;&#x62A5;&#x53EF;&#x80FD;&#x4F1A;&#x4EE5;&#x96A7;&#x9053;&#x5F62;&#x5F0F;&#x7A7F;&#x8D8A;&#x4E00;&#x4E9B;&#x91C7;&#x7528;&#x4E86;&#x91CD;&#x4F20;&#x673A;&#x5236;&#x7684;&#x975E;TCP/IP&#x7F51;&#x7EDC;&#x3002;</p>
<h3 id="IP&#x53EF;&#x80FD;&#x4F1A;&#x5BF9;&#x6570;&#x636E;&#x62A5;&#x8FDB;&#x884C;&#x5206;&#x6BB5;"><a href="#IP&#x53EF;&#x80FD;&#x4F1A;&#x5BF9;&#x6570;&#x636E;&#x62A5;&#x8FDB;&#x884C;&#x5206;&#x6BB5;" class="headerlink" title="IP&#x53EF;&#x80FD;&#x4F1A;&#x5BF9;&#x6570;&#x636E;&#x62A5;&#x8FDB;&#x884C;&#x5206;&#x6BB5;"></a>IP&#x53EF;&#x80FD;&#x4F1A;&#x5BF9;&#x6570;&#x636E;&#x62A5;&#x8FDB;&#x884C;&#x5206;&#x6BB5;</h3><p>IPv4&#x6570;&#x636E;&#x62A5;&#x7684;&#x6700;&#x5927;&#x5927;&#x5C0F;&#x4E3A;65 535&#x5B57;&#x8282;&#x3002;&#x5728;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;IPv6&#x5141;&#x8BB8;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x62A5;&#x7684;&#x6700;&#x5927;&#x5927;&#x5C0F;&#x4E3A;65 575&#x5B57;&#x8282;&#xFF08;40&#x5B57;&#x8282;&#x7528;&#x4E8E;&#x5B58;&#x653E;&#x5934;&#x4FE1;&#x606F;&#xFF0C;65 535&#x5B57;&#x8282;&#x7528;&#x4E8E;&#x5B58;&#x653E;&#x6570;&#x636E;&#xFF09;&#xFF0C;&#x5E76;&#x4E14;&#x4E3A;&#x66F4;&#x5927;&#x7684;&#x6570;&#x636E;&#x62A5;&#xFF08;&#x6240;&#x8C13;&#x7684;jumbograms&#xFF09;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x9009;&#x9879;&#x3002;</p>
<p>&#x4E4B;&#x524D;&#x66FE;&#x7ECF;&#x63D0;&#x8FC7;&#x5927;&#x591A;&#x6570;&#x6570;&#x636E;&#x94FE;&#x8DEF;&#x5C42;&#x4F1A;&#x4E3A;&#x6570;&#x636E;&#x5E27;&#x7684;&#x5927;&#x5C0F;&#x8BBE;&#x5B9A;&#x4E00;&#x4E2A;&#x4E0A;&#x9650;&#xFF08;MTU&#xFF09;&#x3002;&#x5982;&#x5728;&#x5E38;&#x89C1;&#x7684;&#x4EE5;&#x592A;&#x7F51;&#x67B6;&#x6784;&#x4E2D;&#x8FD9;&#x4E2A;&#x4E0A;&#x9650;&#x503C;&#x662F;1500&#x5B57;&#x8282;&#xFF08;&#x6BD4;&#x4E00;&#x4E2A;IP&#x6570;&#x636E;&#x62A5;&#x7684;&#x6700;&#x5927;&#x5927;&#x5C0F;&#x8981;&#x5C0F;&#x5F97;&#x591A;&#xFF09;&#x3002;IP&#x8FD8;&#x5B9A;&#x4E49;&#x4E86;&#x8DEF;&#x5F84;MTU&#x7684;&#x6982;&#x5FF5;&#xFF0C;&#x5B83;&#x662F;&#x6E90;&#x4E3B;&#x673A;&#x5230;&#x76EE;&#x7684;&#x4E3B;&#x673A;&#x4E4B;&#x95F4;&#x8DEF;&#x7531;&#x4E0A;&#x7684;&#x6240;&#x6709;&#x6570;&#x636E;&#x94FE;&#x8DEF;&#x5C42;&#x7684;&#x6700;&#x5C0F;MTU&#x3002;&#xFF08;&#x5728;&#x5B9E;&#x8DF5;&#x4E2D;&#xFF0C;&#x4EE5;&#x592A;&#x7F51;MTU&#x901A;&#x5E38;&#x662F;&#x8DEF;&#x5F84;&#x4E2D;&#x6700;&#x5C0F;&#x7684;MTU&#x3002;&#xFF09;</p>
<p>&#x5F53;&#x4E00;&#x4E2A;IP&#x6570;&#x636E;&#x62A5;&#x7684;&#x5927;&#x5C0F;&#x5927;&#x4E8E;MTU&#x65F6;&#xFF0C;IP&#x4F1A;&#x5C06;&#x6570;&#x636E;&#x62A5;&#x5206;&#x6BB5;&#xFF08;&#x5206;&#x89E3;&#xFF09;&#x6210;&#x4E00;&#x4E2A;&#x4E2A;&#x5927;&#x5C0F;&#x9002;&#x5408;&#x5728;&#x7F51;&#x7EDC;&#x4E0A;&#x4F20;&#x8F93;&#x7684;&#x5355;&#x5143;&#x3002;&#x8FD9;&#x4E9B;&#x5206;&#x6BB5;&#x5728;&#x8FBE;&#x5230;&#x6700;&#x7EC8;&#x76EE;&#x7684;&#x5730;&#x4E4B;&#x540E;&#x4F1A;&#x88AB;&#x91CD;&#x7EC4;&#x6210;&#x539F;&#x59CB;&#x7684;&#x6570;&#x636E;&#x62A5;&#x3002;&#xFF08;&#x6BCF;&#x4E2A;IP&#x5206;&#x6BB5;&#x672C;&#x8EAB;&#x5C31;&#x662F;&#x5305;&#x542B;&#x4E86;&#x4E00;&#x4E2A;&#x504F;&#x79FB;&#x91CF;&#x5B57;&#x6BB5;&#x7684;IP&#x6570;&#x636E;&#x62A5;&#xFF0C;&#x8BE5;&#x5B57;&#x6BB5;&#x7ED9;&#x51FA;&#x4E86;&#x4E00;&#x4E2A;&#x8BE5;&#x5206;&#x6BB5;&#x5728;&#x539F;&#x59CB;&#x6570;&#x636E;&#x62A5;&#x4E2D;&#x7684;&#x4F4D;&#x7F6E;&#x3002;&#xFF09;</p>
<p>IP&#x5206;&#x6BB5;&#x7684;&#x53D1;&#x751F;&#x5BF9;&#x4E8E;&#x9AD8;&#x5C42;&#x534F;&#x8BAE;&#x5C42;&#x662F;&#x900F;&#x660E;&#x7684;&#xFF0C;&#x5E76;&#x4E14;&#x4E00;&#x822C;&#x6765;&#x8BB2;&#x4E5F;&#x5E76;&#x4E0D;&#x5E0C;&#x671B;&#x53D1;&#x751F;&#x8FD9;&#x79CD;&#x4E8B;&#x60C5;&#xFF08;[Kent &amp; Mogul, 1987]&#xFF09;&#x3002;&#x8FD9;&#x91CC;&#x7684;&#x95EE;&#x9898;&#x5728;&#x4E8E;&#x7531;&#x4E8E;IP&#x5E76;&#x4E0D;&#x8FDB;&#x884C;&#x91CD;&#x4F20;&#x5E76;&#x4E14;&#x53EA;&#x6709;&#x5728;&#x6240;&#x6709;&#x5206;&#x6BB5;&#x90FD;&#x8FBE;&#x5230;&#x76EE;&#x7684;&#x5730;&#x4E4B;&#x540E;&#x624D;&#x80FD;&#x5BF9;&#x6570;&#x636E;&#x62A5;&#x8FDB;&#x884C;&#x7EC4;&#x88C5;&#xFF0C;&#x56E0;&#x6B64;&#x5982;&#x679C;&#x5176;&#x4E2D;&#x4E00;&#x4E9B;&#x5206;&#x6BB5;&#x4E22;&#x5931;&#x6216;&#x5305;&#x542B;&#x4F20;&#x8F93;&#x9519;&#x8BEF;&#x7684;&#x8BDD;&#x5C31;&#x4F1A;&#x5BFC;&#x81F4;&#x6574;&#x4E2A;&#x6570;&#x636E;&#x62A5;&#x4E0D;&#x53EF;&#x7528;&#x3002;&#x5728;&#x4E00;&#x4E9B;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x8FD9;&#x4F1A;&#x5BFC;&#x81F4;&#x6781;&#x9AD8;&#x7684;&#x6570;&#x636E;&#x4E22;&#x5931;&#x7387;&#xFF08;&#x9002;&#x7528;&#x4E8E;&#x4E0D;&#x8FDB;&#x884C;&#x91CD;&#x4F20;&#x7684;&#x9AD8;&#x5C42;&#x534F;&#x8BAE;&#xFF0C;&#x5982;UDP&#xFF09;&#x6216;&#x964D;&#x4F4E;&#x4F20;&#x8F93;&#x901F;&#x7387;&#xFF08;&#x9002;&#x7528;&#x4E8E;&#x8FDB;&#x884C;&#x91CD;&#x4F20;&#x7684;&#x9AD8;&#x5C42;&#x534F;&#x8BAE;&#xFF0C;&#x5982;TCP&#xFF09;&#x3002;&#x73B0;&#x4EE3;TCP&#x5B9E;&#x73B0;&#x91C7;&#x7528;&#x4E86;&#x4E00;&#x4E9B;&#x7B97;&#x6CD5;&#xFF08;&#x8DEF;&#x5F84;MTU&#x53D1;&#x73B0;&#xFF09;&#x6765;&#x786E;&#x5B9A;&#x4E3B;&#x673A;&#x4E4B;&#x95F4;&#x7684;&#x4E00;&#x6761;&#x8DEF;&#x5F84;&#x7684;MTU&#xFF0C;&#x5E76;&#x6839;&#x636E;&#x8BE5;&#x503C;&#x5BF9;&#x4F20;&#x9012;&#x7ED9;IP&#x7684;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x5206;&#x89E3;&#xFF0C;&#x8FD9;&#x6837;IP&#x5C31;&#x4E0D;&#x4F1A;&#x78B0;&#x5230;&#x9700;&#x8981;&#x4F20;&#x8F93;&#x5927;&#x5C0F;&#x8D85;&#x8FC7;MTU&#x7684;&#x6570;&#x636E;&#x62A5;&#x7684;&#x60C5;&#x51B5;&#x4E86;&#x3002;UDP&#x5E76;&#x6CA1;&#x6709;&#x63D0;&#x4F9B;&#x8FD9;&#x79CD;&#x673A;&#x5236;&#x3002;</p>
<h2 id="IP&#x5730;&#x5740;"><a href="#IP&#x5730;&#x5740;" class="headerlink" title="IP&#x5730;&#x5740;"></a>IP&#x5730;&#x5740;</h2><p>&#x4E00;&#x4E2A;IP&#x5730;&#x5740;&#x5305;&#x542B;&#x4E24;&#x4E2A;&#x90E8;&#x5206;&#xFF1A;&#x4E00;&#x4E2A;&#x662F;&#x7F51;&#x7EDC;ID&#xFF0C;&#x5B83;&#x6307;&#x5B9A;&#x4E86;&#x4E3B;&#x673A;&#x6240;&#x5C5E;&#x7684;&#x7F51;&#x7EDC;&#xFF1B;&#x53E6;&#x4E00;&#x4E2A;&#x662F;&#x4E3B;&#x673A;ID&#xFF0C;&#x5B83;&#x6807;&#x8BC6;&#x51FA;&#x4E86;&#x4F4D;&#x4E8E;&#x8BE5;&#x7F51;&#x7EDC;&#x4E2D;&#x7684;&#x4E3B;&#x673A;&#x3002;</p>
<h3 id="IPv4&#x5730;&#x5740;"><a href="#IPv4&#x5730;&#x5740;" class="headerlink" title="IPv4&#x5730;&#x5740;"></a>IPv4&#x5730;&#x5740;</h3><p>&#x4E00;&#x4E2A;IPv4&#x5730;&#x5740;&#x5305;&#x542B;32&#x4F4D;&#x3002;&#x5F53;&#x4EE5;&#x4EBA;&#x7C7B;&#x53EF;&#x8BFB;&#x7684;&#x5F62;&#x5F0F;&#x6765;&#x8868;&#x793A;&#x65F6;&#xFF0C;&#x8FD9;&#x4E9B;&#x5730;&#x5740;&#x901A;&#x5E38;&#x7684;&#x4E66;&#x5199;&#x901A;&#x5E38;&#x91C7;&#x7528;&#x70B9;&#x5206;&#x5341;&#x8FDB;&#x5236;&#x6807;&#x8BB0;&#x6CD5;&#xFF0C;&#x5373;&#x5C06;&#x5730;&#x5740;&#x7684;4&#x4E2A;&#x5B57;&#x8282;&#x5199;&#x6210;&#x4E00;&#x4E2A;&#x5341;&#x8FDB;&#x5236;&#x6570;&#x5B57;&#xFF0C;&#x4E2D;&#x95F4;&#x4EE5;&#x70B9;&#x53F7;&#x9694;&#x5F00;&#xFF0C;&#x5982;204.152.189.116&#x3002;<br></p><div class="amp-img-wrapper"><amp-img src="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1581850515524.png?x-oss-process=image/resize,m_lfit,h_450" width="834" height="147" layout="responsive"></amp-img></div><br>&#x5F53;&#x4E00;&#x4E2A;&#x7EC4;&#x7EC7;&#x4E3A;&#x5176;&#x4E3B;&#x673A;&#x7533;&#x8BF7;&#x4E00;&#x7EC4;IPv4&#x5730;&#x5740;&#x65F6;&#xFF0C;&#x5B83;&#x4F1A;&#x6536;&#x5230;&#x4E00;&#x4E2A;32&#x4F4D;&#x7684;&#x7F51;&#x7EDC;&#x5730;&#x5740;&#x4EE5;&#x53CA;&#x4E00;&#x4E2A;&#x5BF9;&#x5E94;&#x7684;32&#x4F4D;&#x7684;&#x7F51;&#x7EDC;&#x63A9;&#x7801;&#x3002;&#x5728;&#x4E8C;&#x8FDB;&#x5236;&#x5F62;&#x5F0F;&#x4E2D;&#xFF0C;&#x8FD9;&#x4E2A;&#x63A9;&#x7801;&#x6700;&#x5DE6;&#x8FB9;&#x7684;&#x4F4D;&#x7531;1&#x6784;&#x6210;&#xFF0C;&#x63A9;&#x7801;&#x4E2D;&#x5269;&#x4F59;&#x7684;&#x4F4D;&#x7528;0&#x586B;&#x5145;&#x3002;&#x8FD9;&#x4E9B;1&#x8868;&#x793A;&#x5730;&#x5740;&#x4E2D;&#x54EA;&#x4E9B;&#x90E8;&#x5206;&#x5305;&#x542B;&#x4E86;&#x6240;&#x5206;&#x914D;&#x5230;&#x7684;&#x7F51;&#x7EDC;ID&#xFF0C;&#x800C;&#x8FD9;&#x4E9B;0&#x5219;&#x8868;&#x793A;&#x5730;&#x5740;&#x4E2D;&#x54EA;&#x4E9B;&#x90E8;&#x5206;&#x53EF;&#x4F9B;&#x7EC4;&#x7EC7;&#x7528;&#x6765;&#x4E3A;&#x7F51;&#x7EDC;&#x4E2D;&#x7684;&#x4E3B;&#x673A;&#x5206;&#x914D;&#x552F;&#x4E00;&#x7684;ID&#x3002;&#x63A9;&#x7801;&#x4E2D;&#x7F51;&#x7EDC;ID&#x90E8;&#x5206;&#x7684;&#x5927;&#x5C0F;&#x4F1A;&#x5728;&#x5206;&#x914D;&#x5730;&#x5740;&#x65F6;&#x786E;&#x5B9A;&#x3002;&#x7531;&#x4E8E;&#x7F51;&#x7EDC;ID&#x90E8;&#x5206;&#x603B;&#x662F;&#x5360;&#x636E;&#x7740;&#x63A9;&#x7801;&#x6700;&#x5DE6;&#x8FB9;&#x7684;&#x90E8;&#x5206;&#xFF0C;&#x56E0;&#x6B64;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4E0B;&#x9762;&#x7684;&#x6807;&#x8BB0;&#x6CD5;&#x6765;&#x6307;&#x5B9A;&#x5206;&#x914D;&#x7684;&#x5730;&#x5740;&#x8303;&#x56F4;&#x3002;<br><code>204.152.189.0/24</code><br>&#x8FD9;&#x91CC;&#x7684;/24&#x8868;&#x793A;&#x5206;&#x914D;&#x7684;&#x5730;&#x5740;&#x7684;&#x7F51;&#x7EDC;ID&#x7531;&#x6700;&#x5DE6;&#x8FB9;&#x7684;24&#x4F4D;&#x6784;&#x6210;&#xFF0C;&#x5269;&#x4F59;&#x7684;8&#x4F4D;&#x7528;&#x4E8E;&#x6307;&#x5B9A;&#x4E3B;&#x673A;ID&#x3002;&#x6216;&#x8005;&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#x4E5F;&#x53EF;&#x4EE5;&#x8BF4;&#x7F51;&#x7EDC;&#x63A9;&#x7801;&#x7684;&#x70B9;&#x5206;&#x5341;&#x8FDB;&#x5236;&#x6807;&#x8BB0;&#x662F;255.255.255.0&#x3002;
<p>&#x62E5;&#x6709;&#x8FD9;&#x4E2A;&#x5730;&#x5740;&#x7684;&#x7EC4;&#x7EC7;&#x53EF;&#x4EE5;&#x5C06;254&#x4E2A;&#x552F;&#x4E00;&#x7684;&#x56E0;&#x7279;&#x7F51;&#x5730;&#x5740;&#x5206;&#x914D;&#x7ED9;&#x5176;&#x8BA1;&#x7B97;&#x673A;&#x2014;&#x2014;204.152.189.1&#x5230;204.152.189.254&#x3002;&#x6709;&#x4E24;&#x4E2A;&#x5730;&#x5740;&#x662F;&#x65E0;&#x6CD5;&#x5206;&#x914D;&#x7ED9;&#x8BA1;&#x7B97;&#x673A;&#x7684;&#xFF0C;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x5730;&#x5740;&#x7684;&#x4E3B;&#x673A;ID&#x7684;&#x4F4D;&#x90FD;&#x662F;0&#xFF0C;&#x5B83;&#x7528;&#x6765;&#x6807;&#x8BC6;&#x7F51;&#x7EDC;&#x672C;&#x8EAB;&#xFF0C;&#x53E6;&#x4E00;&#x4E2A;&#x5730;&#x5740;&#x7684;&#x4E3B;&#x673A;ID&#x7684;&#x4F4D;&#x90FD;&#x662F;1&#x2014;&#x2014;&#x5728;&#x672C;&#x4F8B;&#x4E2D;&#x662F;204.152.189.255&#x2014;&#x2014;&#x5B83;&#x662F;&#x5B50;&#x7F51;&#x5E7F;&#x64AD;&#x5730;&#x5740;&#x3002;</p>
<p>&#x4E00;&#x4E9B;IPv4&#x5730;&#x5740;&#x62E5;&#x6709;&#x7279;&#x6B8A;&#x7684;&#x542B;&#x4E49;&#x3002;&#x7279;&#x6B8A;&#x5730;&#x5740;127.0.0.1&#x4E00;&#x822C;&#x88AB;&#x5B9A;&#x4E49;&#x4E3A;&#x56DE;&#x73AF;&#x5730;&#x5740;&#xFF0C;&#x5B83;&#x901A;&#x5E38;&#x4F1A;&#x88AB;&#x5206;&#x914D;&#x7ED9;&#x4E3B;&#x673A;&#x540D;localhost&#x3002;&#xFF08;&#x7F51;&#x7EDC;127.0.0.0/8&#x4E2D;&#x7684;&#x6240;&#x6709;&#x5730;&#x5740;&#x90FD;&#x53EF;&#x4EE5;&#x88AB;&#x6307;&#x5B9A;&#x4E3A;IPv4&#x56DE;&#x73AF;&#x5730;&#x5740;&#xFF0C;&#x4F46;&#x901A;&#x5E38;&#x4F1A;&#x9009;&#x62E9;127.0.0.1&#x3002;&#xFF09;&#x53D1;&#x9001;&#x5230;&#x8FD9;&#x4E2A;&#x5730;&#x5740;&#x7684;&#x6570;&#x636E;&#x62A5;&#x5B9E;&#x9645;&#x4E0A;&#x4E0D;&#x4F1A;&#x5230;&#x8FBE;&#x7F51;&#x7EDC;&#xFF0C;&#x5B83;&#x4F1A;&#x81EA;&#x52A8;&#x56DE;&#x73AF;&#x53D8;&#x6210;&#x53D1;&#x9001;&#x4E3B;&#x673A;&#x7684;&#x8F93;&#x5165;&#x3002;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x5730;&#x5740;&#x53EF;&#x4EE5;&#x4FBF;&#x6377;&#x5730;&#x5728;&#x540C;&#x4E00;&#x4E3B;&#x673A;&#x4E0A;&#x6D4B;&#x8BD5;&#x5BA2;&#x6237;&#x7AEF;&#x548C;&#x670D;&#x52A1;&#x5668;&#x7A0B;&#x5E8F;&#x3002;&#x5728;C&#x7A0B;&#x5E8F;&#x4E2D;&#x5B9A;&#x4E49;&#x4E86;&#x6574;&#x6570;&#x5E38;&#x91CF;INADDR_LOOPBACK&#x6765;&#x8868;&#x793A;&#x8FD9;&#x4E2A;&#x7A0B;&#x5E8F;&#x3002;</p>
<p>&#x5E38;&#x91CF;INADDR_ANY&#x5C31;&#x662F;&#x6240;&#x8C13;&#x7684;IPv4&#x901A;&#x914D;&#x5730;&#x5740;&#x3002;&#x901A;&#x914D;IP&#x5730;&#x5740;&#x5BF9;&#x4E8E;&#x5C06;Internet domain socket&#x7ED1;&#x5B9A;&#x5230;&#x591A;&#x5BBF;&#x4E3B;&#x673A;&#x4E0A;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x6765;&#x8BB2;&#x662F;&#x6BD4;&#x8F83;&#x6709;&#x7528;&#x7684;&#x3002;&#x5982;&#x679C;&#x4F4D;&#x4E8E;&#x4E00;&#x53F0;&#x591A;&#x5BBF;&#x4E3B;&#x673A;&#x4E0A;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x53EA;&#x5C06;socket&#x7ED1;&#x5B9A;&#x5230;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x4E3B;&#x673A;IP&#x5730;&#x5740;&#x4E0A;&#xFF0C;&#x90A3;&#x4E48;&#x8BE5;socket&#x5C31;&#x53EA;&#x80FD;&#x63A5;&#x6536;&#x53D1;&#x9001;&#x5230;&#x8BE5;IP&#x5730;&#x5740;&#x4E0A;&#x7684;UDP&#x6570;&#x636E;&#x62A5;&#x548C;TCP&#x8FDE;&#x63A5;&#x8BF7;&#x6C42;&#x3002;&#x4F46;&#x4E00;&#x822C;&#x6765;&#x8BB2;&#x90FD;&#x5E0C;&#x671B;&#x4F4D;&#x4E8E;&#x4E00;&#x53F0;&#x591A;&#x5BBF;&#x4E3B;&#x673A;&#x4E0A;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x80FD;&#x591F;&#x63A5;&#x6536;&#x6307;&#x5B9A;&#x4EFB;&#x610F;&#x4E00;&#x4E2A;&#x4E3B;&#x673A;IP&#x5730;&#x5740;&#x7684;&#x6570;&#x636E;&#x62A5;&#x548C;&#x8FDE;&#x63A5;&#x8BF7;&#x6C42;&#xFF0C;&#x800C;&#x5C06;socket&#x7ED1;&#x5B9A;&#x5230;&#x901A;&#x914D;IP&#x5730;&#x5740;&#x4E0A;&#x4F7F;&#x4E4B;&#x6210;&#x4E3A;&#x4E86;&#x53EF;&#x80FD;&#x3002;SUSv3&#x5E76;&#x6CA1;&#x6709;&#x4E3A;INADDR_ANY&#x89C4;&#x5B9A;&#x4E00;&#x4E2A;&#x7279;&#x5B9A;&#x7684;&#x503C;&#xFF0C;&#x4F46;&#x5927;&#x591A;&#x6570;&#x5B9E;&#x73B0;&#x5C06;&#x5176;&#x5B9A;&#x4E49;&#x6210;&#x4E86;0.0.0.0&#xFF08;&#x5168;&#x662F;0&#xFF09;&#x3002;</p>
<p>&#x4E00;&#x822C;&#x6765;&#x8BB2;&#xFF0C;IPv4&#x5730;&#x5740;&#x662F;&#x5212;&#x5206;&#x5B50;&#x7F51;&#x7684;&#x3002;&#x5212;&#x5206;&#x5B50;&#x7F51;&#x5C06;&#x4E00;&#x4E2A;IPv4&#x5730;&#x5740;&#x7684;&#x4E3B;&#x673A;ID&#x90E8;&#x5206;&#x5206;&#x6210;&#x4E24;&#x4E2A;&#x90E8;&#x5206;&#xFF1A;&#x4E00;&#x4E2A;&#x5B50;&#x7F51;ID&#x548C;&#x4E00;&#x4E2A;&#x4E3B;&#x673A;ID&#x3002;&#xFF08;&#x5982;&#x4F55;&#x5212;&#x5206;&#x4E3B;&#x673A;ID&#x7684;&#x4F4D;&#x5B8C;&#x5168;&#x662F;&#x7531;&#x7F51;&#x7EDC;&#x7BA1;&#x7406;&#x5458;&#x6765;&#x51B3;&#x5B9A;&#x7684;&#x3002;&#xFF09;&#x5B50;&#x7F51;&#x5212;&#x5206;&#x7684;&#x539F;&#x7406;&#x5728;&#x4E8E;&#x4E00;&#x4E2A;&#x7EC4;&#x7EC7;&#x901A;&#x5E38;&#x4E0D;&#x4F1A;&#x5C06;&#x5176;&#x6240;&#x6709;&#x4E3B;&#x673A;&#x63A5;&#x5230;&#x5355;&#x4E2A;&#x7F51;&#x7EDC;&#x4E2D;&#x3002;&#x76F8;&#x53CD;&#xFF0C;&#x7EC4;&#x7EC7;&#x53EF;&#x80FD;&#x4F1A;&#x5F00;&#x542F;&#x4E00;&#x7EC4;&#x5B50;&#x7F51;&#xFF08;&#x4E00;&#x4E2A;&#x201C;&#x5185;&#x90E8;&#x4E92;&#x8054;&#x7F51;&#x7EDC;&#x201D;&#xFF09;&#xFF0C;&#x6BCF;&#x4E2A;&#x5B50;&#x7F51;&#x4F7F;&#x7528;&#x7F51;&#x7EDC;ID&#x548C;&#x5B50;&#x7F51;ID&#x7EC4;&#x5408;&#x8D77;&#x6765;&#x6807;&#x8BC6;&#x3002;&#x8FD9;&#x79CD;&#x7EC4;&#x5408;&#x901A;&#x5E38;&#x88AB;&#x79F0;&#x4E3A;&#x6269;&#x5C55;&#x7F51;&#x7EDC;ID&#x3002;&#x5728;&#x4E00;&#x4E2A;&#x5B50;&#x7F51;&#x4E2D;&#xFF0C;&#x5B50;&#x7F51;&#x63A9;&#x7801;&#x6240;&#x626E;&#x6F14;&#x7684;&#x89D2;&#x8272;&#x4E0E;&#x4E4B;&#x524D;&#x63CF;&#x8FF0;&#x7684;&#x7F51;&#x7EDC;&#x63A9;&#x7801;&#x7684;&#x89D2;&#x8272;&#x662F;&#x4E00;&#x6837;&#x7684;&#xFF0C;&#x5E76;&#x4E14;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x7C7B;&#x4F3C;&#x7684;&#x6807;&#x8BB0;&#x6CD5;&#x6765;&#x8868;&#x793A;&#x5206;&#x914D;&#x7ED9;&#x4E00;&#x4E2A;&#x7279;&#x5B9A;&#x5B50;&#x7F51;&#x7684;&#x5730;&#x5740;&#x8303;&#x56F4;&#x3002;</p>
<div class="amp-img-wrapper"><amp-img src="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1581850635160.png?x-oss-process=image/resize,m_lfit,h_450" width="797" height="213" layout="responsive"></amp-img></div>
<p>&#x4F8B;&#x5982;&#x5047;&#x8BBE;&#x5206;&#x914D;&#x5230;&#x7684;&#x7F51;&#x7EDC;ID&#x662F;204.152.189.0/24&#xFF0C;&#x8FD9;&#x6837;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5C06;&#x4E3B;&#x673A;ID&#x7684;8&#x4F4D;&#x4E2D;&#x7684;4&#x4F4D;&#x5212;&#x5206;&#x6210;&#x5B50;&#x7F51;ID&#x5E76;&#x5C06;&#x5269;&#x4F59;&#x7684;4&#x4F4D;&#x5212;&#x5206;&#x6210;&#x4E3B;&#x673A;ID&#x6765;&#x5BF9;&#x8FD9;&#x4E2A;&#x5730;&#x5740;&#x8303;&#x56F4;&#x5212;&#x5206;&#x5B50;&#x7F51;&#x3002;&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5B50;&#x7F51;&#x63A9;&#x7801;&#x5C06;&#x7531;28&#x4E2A;&#x524D;&#x5BFC;1&#x540E;&#x9762;&#x8DDF;&#x7740;4&#x4E2A;0&#x6784;&#x6210;&#xFF0C;ID&#x4E3A;1&#x7684;&#x5B50;&#x7F51;&#x5C06;&#x4F1A;&#x88AB;&#x8868;&#x793A;&#x4E3A;204.152.189.16/28&#x3002;</p>
<h3 id="IPv6&#x5730;&#x5740;"><a href="#IPv6&#x5730;&#x5740;" class="headerlink" title="IPv6&#x5730;&#x5740;"></a>IPv6&#x5730;&#x5740;</h3><p>IPv6&#x5730;&#x5740;&#x7684;&#x539F;&#x7406;&#x4E0E;IPv4&#x5730;&#x5740;&#x662F;&#x7C7B;&#x4F3C;&#x7684;&#xFF0C;&#x5B83;&#x4EEC;&#x4E4B;&#x95F4;&#x5173;&#x952E;&#x7684;&#x5DEE;&#x522B;&#x5728;&#x4E8E;IPv6&#x5730;&#x5740;&#x7531;128&#x4F4D;&#x6784;&#x6210;&#xFF0C;&#x5176;&#x4E2D;&#x5730;&#x5740;&#x4E2D;&#x7684;&#x524D;&#x9762;&#x4E00;&#x4E9B;&#x4F4D;&#x662F;&#x4E00;&#x4E2A;&#x683C;&#x5F0F;&#x524D;&#x7F00;&#xFF0C;&#x8868;&#x793A;&#x5730;&#x5740;&#x7C7B;&#x578B;&#x3002;&#xFF08;&#x8FD9;&#x91CC;&#x4E0D;&#x4F1A;&#x6DF1;&#x5165;&#x4ECB;&#x7ECD;&#x8FD9;&#x4E9B;&#x5730;&#x5740;&#x7C7B;&#x578B;&#x7684;&#x7EC6;&#x8282;&#xFF0C;&#x7EC6;&#x8282;&#x4FE1;&#x606F;&#x53EF;&#x53C2;&#x8003;[Stevens et al., 2004]&#x7684;&#x9644;&#x5F55;A&#x548C;RFC 3513&#x3002;&#xFF09;</p>
<p>IPv6&#x5730;&#x5740;&#x901A;&#x5E38;&#x88AB;&#x4E66;&#x5199;&#x6210;&#x4E00;&#x7CFB;&#x5217;&#x7528;&#x5192;&#x53F7;&#x9694;&#x5F00;&#x7684;16&#x4F4D;&#x7684;&#x5341;&#x516D;&#x8FDB;&#x5236;&#x6570;&#x5B57;&#xFF0C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#x3002;<br><code>F000:0:0:0:0:0:A:1</code><br>IPv6&#x5730;&#x5740;&#x901A;&#x5E38;&#x5305;&#x542B;&#x4E00;&#x4E2A;0&#x5E8F;&#x5217;&#xFF0C;&#x5E76;&#x4E14;&#x4E3A;&#x4E86;&#x6807;&#x8BB0;&#x65B9;&#x4FBF;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4E24;&#x4E2A;&#x5206;&#x53F7;&#xFF08;::&#xFF09;&#x6765;&#x8868;&#x793A;&#x8FD9;&#x79CD;&#x5E8F;&#x5217;&#x3002;&#x56E0;&#x6B64;&#x4E0A;&#x9762;&#x7684;&#x5730;&#x5740;&#x53EF;&#x4EE5;&#x88AB;&#x91CD;&#x5199;&#x6210;&#xFF1A;<br><code>F000:A:1</code><br>&#x5728;IPv6&#x5730;&#x5740;&#x4E2D;&#x53EA;&#x80FD;&#x51FA;&#x73B0;&#x4E00;&#x4E2A;&#x53CC;&#x5192;&#x53F7;&#x6807;&#x8BB0;&#xFF0C;&#x51FA;&#x73B0;&#x591A;&#x6B21;&#x7684;&#x8BDD;&#x4F1A;&#x9020;&#x6210;&#x6DF7;&#x6DC6;&#x3002;</p>
<p>IPv6&#x4E5F;&#x50CF;IPv4&#x5730;&#x5740;&#x90A3;&#x6837;&#x63D0;&#x4F9B;&#x4E86;&#x73AF;&#x56DE;&#x5730;&#x5740;&#xFF08;127&#x4E2A;0&#x540E;&#x9762;&#x8DDF;&#x7740;&#x4E00;&#x4E2A;1&#xFF0C;&#x5373;::1&#xFF09;&#x548C;&#x901A;&#x914D;&#x5730;&#x5740;&#xFF08;&#x6240;&#x6709;&#x90FD;&#x4E3A;0&#xFF0C;&#x53EF;&#x4EE5;&#x4E66;&#x5199;&#x6210;0::0&#x6216;::&#xFF09;&#x3002;</p>
<p>&#x4E3A;&#x5141;&#x8BB8;IPv6&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E0E;&#x53EA;&#x652F;&#x6301;IPv4&#x7684;&#x4E3B;&#x673A;&#x8FDB;&#x884C;&#x901A;&#x4FE1;&#xFF0C;IPv6&#x63D0;&#x4F9B;&#x4E86;&#x6240;&#x8C13;&#x7684;IPv4&#x6620;&#x5C04;&#x7684;IPv6&#x5730;&#x5740;&#x3002;<br></p><div class="amp-img-wrapper"><amp-img src="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1581850769585.png?x-oss-process=image/resize,m_lfit,h_450" width="761" height="87" layout="responsive"></amp-img></div>
<p>&#x5728;&#x4E66;&#x5199;IPv4&#x6620;&#x5C04;&#x7684;IPv6&#x5730;&#x5740;&#x65F6;&#xFF0C;&#x5730;&#x5740;&#x7684;IPv4&#x90E8;&#x5206;&#xFF08;&#x5373;&#x6700;&#x540E;4&#x4E2A;&#x5B57;&#x8282;&#xFF09;&#x4F1A;&#x88AB;&#x4E66;&#x5199;&#x6210;IPv4&#x7684;&#x70B9;&#x5206;&#x5341;&#x8FDB;&#x5236;&#x6807;&#x8BB0;&#x3002;&#x56E0;&#x6B64;&#x4E0E;204.152.189.116&#x7B49;&#x4EF7;&#x7684;IPv4&#x6620;&#x5C04;&#x7684;IPv6&#x5730;&#x5740;&#x662F;::FFFF:204.152.189.116&#x3002;</p>
<h2 id="&#x4F20;&#x8F93;&#x5C42;"><a href="#&#x4F20;&#x8F93;&#x5C42;" class="headerlink" title="&#x4F20;&#x8F93;&#x5C42;"></a>&#x4F20;&#x8F93;&#x5C42;</h2><p>&#x5728;TCP/IP&#x5957;&#x4EF6;&#x4E2D;&#x4F7F;&#x7528;&#x5E7F;&#x6CDB;&#x7684;&#x4E24;&#x4E2A;&#x4F20;&#x8F93;&#x5C42;&#x534F;&#x8BAE;&#x5982;&#x4E0B;&#x3002;</p>
<ul>
<li>&#x7528;&#x6237;&#x6570;&#x636E;&#x62A5;&#x534F;&#x8BAE;&#xFF08;UDP&#xFF09;&#x662F;&#x6570;&#x636E;&#x62A5;socket&#x6240;&#x4F7F;&#x7528;&#x7684;&#x534F;&#x8BAE;&#x3002;</li>
<li>&#x4F20;&#x8F93;&#x63A7;&#x5236;&#x534F;&#x8BAE;&#xFF08;TCP&#xFF09;&#x662F;&#x6D41;socket&#x6240;&#x4F7F;&#x7528;&#x7684;&#x534F;&#x8BAE;&#x3002;</li>
</ul>
<h3 id="&#x7AEF;&#x53E3;&#x53F7;"><a href="#&#x7AEF;&#x53E3;&#x53F7;" class="headerlink" title="&#x7AEF;&#x53E3;&#x53F7;"></a>&#x7AEF;&#x53E3;&#x53F7;</h3><p>&#x4F20;&#x8F93;&#x5C42;&#x534F;&#x8BAE;&#x7684;&#x4EFB;&#x52A1;&#x662F;&#x5411;&#x4F4D;&#x4E8E;&#x4E0D;&#x540C;&#x4E3B;&#x673A;&#xFF08;&#x6216;&#x6709;&#x65F6;&#x5019;&#x4F4D;&#x4E8E;&#x540C;&#x4E00;&#x4E3B;&#x673A;&#xFF09;&#x4E0A;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x63D0;&#x4F9B;&#x7AEF;&#x5230;&#x7AEF;&#x7684;&#x901A;&#x4FE1;&#x670D;&#x52A1;&#x3002;&#x4E3A;&#x5B8C;&#x6210;&#x8FD9;&#x4E2A;&#x4EFB;&#x52A1;&#xFF0C;&#x4F20;&#x8F93;&#x5C42;&#x9700;&#x8981;&#x91C7;&#x7528;&#x4E00;&#x79CD;&#x65B9;&#x6CD5;&#x6765;&#x533A;&#x5206;&#x4E00;&#x4E2A;&#x4E3B;&#x673A;&#x4E0A;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x3002;&#x5728;TCP&#x548C;UDP&#x4E2D;&#xFF0C;&#x8FD9;&#x79CD;&#x533A;&#x5206;&#x5DE5;&#x4F5C;&#x662F;&#x901A;&#x8FC7;&#x4E00;&#x4E2A;16&#x4F4D;&#x7684;&#x7AEF;&#x53E3;&#x53F7;&#x6765;&#x5B8C;&#x6210;&#x7684;&#x3002;</p>
<p><strong>&#x4F17;&#x6240;&#x5468;&#x77E5;&#x7684;&#x3001;&#x6CE8;&#x518C;&#x7684;&#x4EE5;&#x53CA;&#x7279;&#x6743;&#x7AEF;&#x53E3;</strong><br>&#x6709;&#x4E9B;&#x4F17;&#x6240;&#x5468;&#x77E5;&#x7684;&#x7AEF;&#x53E3;&#x53F7;&#x5DF2;&#x7ECF;&#x88AB;&#x6C38;&#x4E45;&#x5730;&#x5206;&#x914D;&#x7ED9;&#x7279;&#x5B9A;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E86;&#xFF08;&#x4E5F;&#x79F0;&#x4E3A;&#x670D;&#x52A1;&#xFF09;&#x3002;&#x4F8B;&#x5982;ssh&#xFF08;&#x5B89;&#x5168;&#x7684;shell&#xFF09;daemon&#x4F7F;&#x7528;&#x4F17;&#x6240;&#x5468;&#x77E5;&#x7684;&#x7AEF;&#x53E3;22&#xFF0C;HTTP&#xFF08;Web&#x670D;&#x52A1;&#x5668;&#x548C;&#x6D4F;&#x89C8;&#x5668;&#x4E4B;&#x95F4;&#x901A;&#x4FE1;&#x65F6;&#x6240;&#x91C7;&#x7528;&#x7684;&#x534F;&#x8BAE;&#xFF09;&#x4F7F;&#x7528;&#x4F17;&#x6240;&#x5468;&#x77E5;&#x7684;&#x7AEF;&#x53E3;80&#x3002;&#x4F17;&#x6240;&#x5468;&#x77E5;&#x7684;&#x7AEF;&#x53E3;&#x7684;&#x7AEF;&#x53E3;&#x53F7;&#x4F4D;&#x4E8E;0&#xFF5E;1023&#x4E4B;&#x95F4;&#xFF0C;&#x5B83;&#x662F;&#x7531;&#x4E2D;&#x592E;&#x6388;&#x6743;&#x673A;&#x6784;&#x4E92;&#x8054;&#x7F51;&#x53F7;&#x7801;&#x5206;&#x914D;&#x5C40;&#xFF08;IANA, <a href="https://www.iana.org/" target="_blank" rel="noopener">https://www.iana.org/</a> &#xFF09;&#x6765;&#x5206;&#x914D;&#x7684;&#x3002;&#x4E00;&#x4E2A;&#x4F17;&#x6240;&#x5468;&#x77E5;&#x7684;&#x7AEF;&#x53E3;&#x53F7;&#x7684;&#x5206;&#x914D;&#x662F;&#x7531;&#x4E00;&#x4E2A;&#x88AB;&#x6838;&#x51C6;&#x7684;&#x7F51;&#x7EDC;&#x89C4;&#x8303;&#xFF08;&#x901A;&#x5E38;&#x4EE5;RFC&#x7684;&#x5F62;&#x5F0F;&#xFF09;&#x6765;&#x89C4;&#x5B9A;&#x7684;&#x3002;</p>
<p>IANA&#x8FD8;&#x8BB0;&#x5F55;&#x7740;&#x6CE8;&#x518C;&#x7AEF;&#x53E3;&#xFF0C;&#x5C06;&#x8FD9;&#x4E9B;&#x7AEF;&#x53E3;&#x5206;&#x914D;&#x7ED9;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5F00;&#x53D1;&#x4EBA;&#x5458;&#x7684;&#x8FC7;&#x7A0B;&#x5C31;&#x4E0D;&#x90A3;&#x4E48;&#x4E25;&#x683C;&#x4E86;&#xFF08;&#x8FD9;&#x4E5F;&#x610F;&#x5473;&#x7740;&#x4E00;&#x4E2A;&#x5B9E;&#x73B0;&#x65E0;&#x9700;&#x4FDD;&#x8BC1;&#x8FD9;&#x4E9B;&#x7AEF;&#x53E3;&#x662F;&#x5426;&#x771F;&#x6B63;&#x7528;&#x4E8E;&#x5B83;&#x4EEC;&#x6CE8;&#x518C;&#x65F6;&#x7533;&#x8BF7;&#x7684;&#x7528;&#x9014;&#xFF09;&#x3002;IANA&#x6CE8;&#x518C;&#x7684;&#x7AEF;&#x53E3;&#x8303;&#x56F4;&#x4E3A;1024&#xFF5E;41951&#x3002;&#xFF08;&#x4E0D;&#x662F;&#x6240;&#x6709;&#x4F4D;&#x4E8E;&#x8FD9;&#x4E2A;&#x8303;&#x56F4;&#x5185;&#x7684;&#x7AEF;&#x53E3;&#x90FD;&#x88AB;&#x6CE8;&#x518C;&#x4E86;&#x3002;&#xFF09;</p>
<p>IANA&#x4F17;&#x6240;&#x5468;&#x77E5;&#x7684;&#x66F4;&#x65B0;&#x5217;&#x8868;&#x548C;&#x6CE8;&#x518C;&#x7AEF;&#x53E3;&#x5206;&#x914D;&#x60C5;&#x51B5;&#x53EF;&#x4EE5;&#x5728;<a href="https://www.iana.org/assignments/port-numbers" target="_blank" rel="noopener">https://www.iana.org/assignments/port-numbers</a> &#x4E0A;&#x627E;&#x5230;&#x3002;</p>
<p>&#x5728;&#x5927;&#x591A;&#x6570;TCP/IP&#x5B9E;&#x73B0;&#xFF08;&#x5305;&#x62EC;Linux&#xFF09;&#x4E2D;&#xFF0C;&#x8303;&#x56F4;&#x5728;0&#x5230;1023&#x95F4;&#x7684;&#x7AEF;&#x53E3;&#x53F7;&#x4E5F;&#x662F;&#x7279;&#x6743;&#x7AEF;&#x53E3;&#xFF0C;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x53EA;&#x6709;&#x7279;&#x6743;&#xFF08;CAP_NET_BIND_SERVICE&#xFF09;&#x8FDB;&#x7A0B;&#x53EF;&#x4EE5;&#x7ED1;&#x5B9A;&#x5230;&#x8FD9;&#x4E9B;&#x7AEF;&#x53E3;&#x4E0A;&#xFF0C;&#x4ECE;&#x800C;&#x9632;&#x6B62;&#x4E86;&#x666E;&#x901A;&#x7528;&#x6237;&#x901A;&#x8FC7;&#x5B9E;&#x73B0;&#x6076;&#x610F;&#x7A0B;&#x5E8F;&#xFF08;&#x5982;&#x4F2A;&#x9020;ssh&#xFF09;&#x6765;&#x83B7;&#x53D6;&#x5BC6;&#x7801;&#x3002;&#xFF08;&#x6709;&#x4E9B;&#x65F6;&#x5019;&#xFF0C;&#x7279;&#x6743;&#x7AEF;&#x53E3;&#x4E5F;&#x88AB;&#x79F0;&#x4E3A;&#x4FDD;&#x7559;&#x7AEF;&#x53E3;&#x3002;&#xFF09;</p>
<p>&#x5C3D;&#x7BA1;&#x7AEF;&#x53E3;&#x53F7;&#x76F8;&#x540C;&#x7684;TCP&#x548C;UDP&#x7AEF;&#x53E3;&#x662F;&#x4E0D;&#x540C;&#x7684;&#x5B9E;&#x4F53;&#xFF0C;&#x4F46;&#x540C;&#x4E00;&#x4E2A;&#x4F17;&#x6240;&#x5468;&#x77E5;&#x7684;&#x7AEF;&#x53E3;&#x53F7;&#x901A;&#x5E38;&#x4F1A;&#x540C;&#x65F6;&#x88AB;&#x5206;&#x914D;&#x7ED9;&#x57FA;&#x4E8E;TCP&#x548C;UDP&#x7684;&#x670D;&#x52A1;&#xFF0C;&#x5373;&#x4F7F;&#x8BE5;&#x670D;&#x52A1;&#x901A;&#x5E38;&#x53EA;&#x63D0;&#x4F9B;&#x4E86;&#x5176;&#x4E2D;&#x4E00;&#x79CD;&#x534F;&#x8BAE;&#x670D;&#x52A1;&#x3002;&#x8FD9;&#x79CD;&#x60EF;&#x4F8B;&#x907F;&#x514D;&#x4E86;&#x7AEF;&#x53E3;&#x53F7;&#x5728;&#x4E24;&#x4E2A;&#x534F;&#x8BAE;&#x4E2D;&#x4EA7;&#x751F;&#x6DF7;&#x6DC6;&#x7684;&#x60C5;&#x51B5;&#x3002;</p>
<p><strong>&#x4E34;&#x65F6;&#x7AEF;&#x53E3;</strong><br>&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x6CA1;&#x6709;&#x9009;&#x62E9;&#x4E00;&#x4E2A;&#x7279;&#x5B9A;&#x7684;&#x7AEF;&#x53E3;&#xFF08;&#x5373;&#x5728;socket&#x672F;&#x8BED;&#x4E2D;&#xFF0C;&#x5B83;&#x6CA1;&#x6709;&#x8C03;&#x7528;bind()&#x5C06;&#x5176;socket&#x7ED1;&#x5B9A;&#x5230;&#x4E00;&#x4E2A;&#x7279;&#x5B9A;&#x7684;&#x7AEF;&#x53E3;&#x4E0A;&#xFF09;&#xFF0C;&#x90A3;&#x4E48;TCP&#x548C;UDP&#x4F1A;&#x4E3A;&#x8BE5;socket&#x5206;&#x914D;&#x4E00;&#x4E2A;&#x552F;&#x4E00;&#x7684;&#x4E34;&#x65F6;&#x7AEF;&#x53E3;&#xFF08;&#x5373;&#x5B58;&#x6D3B;&#x65F6;&#x95F4;&#x8F83;&#x77ED;&#xFF09;&#x3002;&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x2014;&#x2014;&#x901A;&#x5E38;&#x662F;&#x4E00;&#x4E2A;&#x5BA2;&#x6237;&#x7AEF;&#x2014;&#x2014;&#x5E76;&#x4E0D;&#x5173;&#x5FC3;&#x5B83;&#x6240;&#x4F7F;&#x7528;&#x7684;&#x7AEF;&#x53E3;&#x53F7;&#xFF0C;&#x4F46;&#x5206;&#x914D;&#x4E00;&#x4E2A;&#x7AEF;&#x53E3;&#x5BF9;&#x4E8E;&#x4F20;&#x8F93;&#x5C42;&#x534F;&#x8BAE;&#x6807;&#x8BC6;&#x901A;&#x4FE1;&#x7AEF;&#x70B9;&#x6765;&#x8BB2;&#x662F;&#x6709;&#x5FC5;&#x8981;&#x7684;&#x3002;&#x8FD9;&#x79CD;&#x505A;&#x6CD5;&#x7684;&#x53E6;&#x4E00;&#x4E2A;&#x7ED3;&#x679C;&#x662F;&#x4F4D;&#x4E8E;&#x901A;&#x4FE1;&#x4FE1;&#x9053;&#x53E6;&#x4E00;&#x7AEF;&#x7684;&#x5BF9;&#x7B49;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5C31;&#x77E5;&#x9053;&#x5982;&#x4F55;&#x4E0E;&#x8FD9;&#x4E2A;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x901A;&#x4FE1;&#x4E86;&#x3002;TCP&#x548C;UDP&#x5728;&#x5C06;socket&#x7ED1;&#x5B9A;&#x5230;&#x7AEF;&#x53E3;0&#x4E0A;&#x65F6;&#x4E5F;&#x4F1A;&#x5206;&#x914D;&#x4E00;&#x4E2A;&#x4E34;&#x65F6;&#x7AEF;&#x53E3;&#x53F7;&#x3002;</p>
<p>IANA&#x5C06;&#x4F4D;&#x4E8E;49152&#x5230;65535&#x4E4B;&#x95F4;&#x7684;&#x7AEF;&#x53E3;&#x79F0;&#x4E3A;&#x52A8;&#x6001;&#x6216;&#x79C1;&#x6709;&#x7AEF;&#x53E3;&#xFF0C;&#x8FD9;&#x8868;&#x793A;&#x8FD9;&#x4E9B;&#x7AEF;&#x53E3;&#x53EF;&#x4F9B;&#x672C;&#x5730;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4F7F;&#x7528;&#x6216;&#x4F5C;&#x4E3A;&#x4E34;&#x65F6;&#x7AEF;&#x53E3;&#x5206;&#x914D;&#x3002;&#x7136;&#x540E;&#x4E0D;&#x540C;&#x7684;&#x5B9E;&#x73B0;&#x53EF;&#x80FD;&#x4F1A;&#x5728;&#x4E0D;&#x540C;&#x7684;&#x8303;&#x56F4;&#x5185;&#x5206;&#x914D;&#x4E34;&#x65F6;&#x7AEF;&#x53E3;&#x3002;&#x5728;Linux&#x4E0A;&#xFF0C;&#x8FD9;&#x4E2A;&#x8303;&#x56F4;&#x662F;&#x7531;&#x5305;&#x542B;&#x5728;&#x6587;&#x4EF6;/proc/sys/net/ipv4/ip_local_port_range&#x4E2D;&#x7684;&#x4E24;&#x4E2A;&#x6570;&#x5B57;&#x6765;&#x5B9A;&#x4E49;&#x7684;&#xFF08;&#x53EF;&#x901A;&#x8FC7;&#x4FEE;&#x6539;&#x8FD9;&#x4E24;&#x4E2A;&#x6570;&#x5B57;&#x6765;&#x4FEE;&#x6539;&#x8303;&#x56F4;&#xFF09;&#x3002;</p>
<h3 id="&#x7528;&#x6237;&#x6570;&#x636E;&#x62A5;&#x534F;&#x8BAE;&#xFF08;UDP&#xFF09;"><a href="#&#x7528;&#x6237;&#x6570;&#x636E;&#x62A5;&#x534F;&#x8BAE;&#xFF08;UDP&#xFF09;" class="headerlink" title="&#x7528;&#x6237;&#x6570;&#x636E;&#x62A5;&#x534F;&#x8BAE;&#xFF08;UDP&#xFF09;"></a>&#x7528;&#x6237;&#x6570;&#x636E;&#x62A5;&#x534F;&#x8BAE;&#xFF08;UDP&#xFF09;</h3><p>UDP&#x4EC5;&#x4EC5;&#x5728;IP&#x4E4B;&#x4E0A;&#x6DFB;&#x52A0;&#x4E86;&#x4E24;&#x4E2A;&#x7279;&#x6027;&#xFF1A;&#x7AEF;&#x53E3;&#x53F7;&#x548C;&#x4E00;&#x4E2A;&#x8FDB;&#x884C;&#x68C0;&#x6D4B;&#x4F20;&#x8F93;&#x6570;&#x636E;&#x9519;&#x8BEF;&#x7684;&#x6570;&#x636E;&#x6821;&#x9A8C;&#x548C;&#x3002;</p>
<p>&#x4E0E;IP&#x4E00;&#x6837;&#xFF0C;UDP&#x4E5F;&#x662F;&#x65E0;&#x8FDE;&#x63A5;&#x7684;&#x3002;&#x7531;&#x4E8E;&#x5B83;&#x5E76;&#x6CA1;&#x6709;&#x5728;IP&#x4E4B;&#x4E0A;&#x589E;&#x52A0;&#x53EF;&#x9760;&#x6027;&#xFF0C;&#x56E0;&#x6B64;UDP&#x662F;&#x4E0D;&#x53EF;&#x9760;&#x7684;&#x3002;&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x57FA;&#x4E8E;UDP&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x9700;&#x8981;&#x786E;&#x4FDD;&#x53EF;&#x9760;&#x6027;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x9879;&#x529F;&#x80FD;&#x5C31;&#x5FC5;&#x987B;&#x8981;&#x5728;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E2D;&#x4E88;&#x4EE5;&#x5B9E;&#x73B0;&#x3002;&#x5982;&#x679C;&#x5254;&#x9664;&#x4E0D;&#x53EF;&#x9760;&#x8FD9;&#x4E2A;&#x7279;&#x70B9;&#x7684;&#x8BDD;&#xFF0C;&#x5728;&#x6709;&#x4E9B;&#x65F6;&#x5019;&#x53EF;&#x80FD;&#x503E;&#x5411;&#x4E8E;&#x4F7F;&#x7528;UDP&#x800C;&#x4E0D;&#x662F;TCP&#x3002;</p>
<p>UDP&#x548C;TCP&#x4F7F;&#x7528;&#x7684;&#x6821;&#x9A8C;&#x548C;&#x7684;&#x957F;&#x5EA6;&#x53EA;&#x6709;16&#x4F4D;&#x5E76;&#x4E14;&#x53EA;&#x662F;&#x7B80;&#x5355;&#x7684;&#x201C;&#x603B;&#x7ED3;&#x6027;&#x201D;&#x6821;&#x9A8C;&#x548C;&#xFF0C;&#x56E0;&#x6B64;&#x65E0;&#x6CD5;&#x68C0;&#x6D4B;&#x51FA;&#x7279;&#x5B9A;&#x7684;&#x9519;&#x8BEF;&#xFF0C;&#x5176;&#x7ED3;&#x679C;&#x662F;&#x65E0;&#x6CD5;&#x63D0;&#x4F9B;&#x8F83;&#x5F3A;&#x7684;&#x9519;&#x8BEF;&#x68C0;&#x6D4B;&#x673A;&#x5236;&#x3002;&#x7E41;&#x5FD9;&#x7684;&#x4E92;&#x8054;&#x7F51;&#x670D;&#x52A1;&#x5668;&#x901A;&#x5E38;&#x53EA;&#x80FD;&#x6BCF;&#x9694;&#x51E0;&#x5929;&#x770B;&#x4E00;&#x4E0B;&#x672A;&#x68C0;&#x6D4B;&#x51FA;&#x7684;&#x4F20;&#x8F93;&#x9519;&#x8BEF;&#x7684;&#x5E73;&#x5747;&#x60C5;&#x51B5;&#xFF08;[Stone &amp; Partridge, 2000]&#xFF09;&#x3002;&#x9700;&#x8981;&#x66F4;&#x591A;&#x786E;&#x4FDD;&#x6570;&#x636E;&#x5B8C;&#x6574;&#x6027;&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5B89;&#x5168;Sockets&#x5C42;&#xFF08;Secure Sockets Layer&#xFF0C;SSL&#xFF09;&#xFF0C;&#x5B83;&#x4E0D;&#x4EC5;&#x4EC5;&#x63D0;&#x4F9B;&#x4E86;&#x5B89;&#x5168;&#x7684;&#x901A;&#x4FE1;&#xFF0C;&#x800C;&#x4E14;&#x8FD8;&#x63D0;&#x4F9B;&#x66F4;&#x52A0;&#x4E25;&#x683C;&#x7684;&#x9519;&#x8BEF;&#x68C0;&#x6D4B;&#x8FC7;&#x7A0B;&#x3002;&#x6216;&#x8005;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E5F;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x81EA;&#x5DF1;&#x7684;&#x9519;&#x8BEF;&#x63A7;&#x5236;&#x673A;&#x5236;&#x3002;</p>
<p><strong>&#x9009;&#x62E9;&#x4E00;&#x4E2A;UDP&#x6570;&#x636E;&#x62A5;&#x5927;&#x5C0F;&#x4EE5;&#x907F;&#x514D;IP&#x5206;&#x6BB5;</strong><br>IP&#x5206;&#x6BB5;&#x673A;&#x5236;&#x5E76;&#x6307;&#x51FA;&#x8FC7;&#x901A;&#x5E38;&#x5E94;&#x8BE5;&#x5C3D;&#x53EF;&#x80FD;&#x5730;&#x907F;&#x514D;IP&#x5206;&#x6BB5;&#x3002;TCP&#x63D0;&#x4F9B;&#x4E86;&#x907F;&#x514D;IP&#x5206;&#x6BB5;&#x7684;&#x673A;&#x5236;&#xFF0C;&#x4F46;UDP&#x5E76;&#x6CA1;&#x6709;&#x63D0;&#x4F9B;&#x76F8;&#x5E94;&#x7684;&#x673A;&#x5236;&#x3002;&#x4F7F;&#x7528;UDP&#x65F6;&#x5982;&#x679C;&#x4F20;&#x8F93;&#x7684;&#x6570;&#x636E;&#x62A5;&#x7684;&#x5927;&#x5C0F;&#x8D85;&#x8FC7;&#x4E86;&#x672C;&#x5730;&#x6570;&#x636E;&#x94FE;&#x63A5;&#x7684;MTU&#xFF0C;&#x90A3;&#x4E48;&#x5F88;&#x5BB9;&#x6613;&#x5C31;&#x4F1A;&#x5BFC;&#x81F4;IP&#x5206;&#x6BB5;&#x3002;</p>
<p>&#x57FA;&#x4E8E;UDP&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x901A;&#x5E38;&#x4E0D;&#x4F1A;&#x77E5;&#x9053;&#x6E90;&#x4E3B;&#x673A;&#x548C;&#x76EE;&#x7684;&#x4E3B;&#x673A;&#x4E4B;&#x95F4;&#x7684;&#x8DEF;&#x5F84;&#x7684;MTU&#x3002;&#x4E00;&#x822C;&#x6765;&#x8BB2;&#xFF0C;&#x57FA;&#x4E8E;UDP&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4F1A;&#x91C7;&#x7528;&#x4FDD;&#x5B88;&#x7684;&#x65B9;&#x6CD5;&#x6765;&#x907F;&#x514D;IP&#x5206;&#x6BB5;&#xFF0C;&#x5373;&#x786E;&#x4FDD;&#x4F20;&#x8F93;&#x7684;IP&#x6570;&#x636E;&#x62A5;&#x7684;&#x5927;&#x5C0F;&#x5C0F;&#x4E8E;IPv4&#x7684;&#x7EC4;&#x88C5;&#x7F13;&#x51B2;&#x533A;&#x5927;&#x5C0F;&#x7684;&#x6700;&#x5C0F;&#x503C;576&#x5B57;&#x8282;&#x3002;&#xFF08;&#x8FD9;&#x4E2A;&#x503C;&#x5F88;&#x6709;&#x53EF;&#x80FD;&#x662F;&#x5C0F;&#x4E8E;&#x8DEF;&#x5F84;MTU&#x7684;&#x3002;&#xFF09;&#x5728;&#x8FD9;576&#x5B57;&#x8282;&#x4E2D;&#xFF0C;&#x6709;8&#x4E2A;&#x5B57;&#x8282;&#x662F;&#x7528;&#x4E8E;&#x5B58;&#x653E;UDP&#x5934;&#x7684;&#xFF0C;&#x53E6;&#x5916;&#x6700;&#x5C11;&#x9700;&#x8981;&#x4F7F;&#x7528;20&#x4E2A;&#x5B57;&#x8282;&#x6765;&#x5B58;&#x653E;IP&#x5934;&#xFF0C;&#x5269;&#x4E0B;&#x7684;548&#x5B57;&#x8282;&#x7528;&#x4E8E;&#x5B58;&#x653E;UDP&#x6570;&#x636E;&#x62A5;&#x672C;&#x8EAB;&#x3002;&#x5728;&#x5B9E;&#x8DF5;&#x4E2D;&#xFF0C;&#x5F88;&#x591A;&#x57FA;&#x4E8E;UDP&#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4F1A;&#x9009;&#x62E9;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x66F4;&#x5C0F;&#x7684;&#x503C;512&#x5B57;&#x8282;&#x6765;&#x5B58;&#x653E;&#x6570;&#x636E;&#x62A5;&#xFF08;[Stevens, 1994]&#xFF09;&#x3002;</p>
<h3 id="&#x4F20;&#x8F93;&#x63A7;&#x5236;&#x534F;&#x8BAE;&#xFF08;TCP&#xFF09;"><a href="#&#x4F20;&#x8F93;&#x63A7;&#x5236;&#x534F;&#x8BAE;&#xFF08;TCP&#xFF09;" class="headerlink" title="&#x4F20;&#x8F93;&#x63A7;&#x5236;&#x534F;&#x8BAE;&#xFF08;TCP&#xFF09;"></a>&#x4F20;&#x8F93;&#x63A7;&#x5236;&#x534F;&#x8BAE;&#xFF08;TCP&#xFF09;</h3><p>TCP&#x5728;&#x4E24;&#x4E2A;&#x7AEF;&#x70B9;&#xFF08;&#x5373;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#xFF09;&#x4E4B;&#x95F4;&#x63D0;&#x4F9B;&#x4E86;&#x53EF;&#x9760;&#x7684;&#x3001;&#x9762;&#x5411;&#x8FDE;&#x63A5;&#x7684;&#x3001;&#x53CC;&#x5411;&#x5B57;&#x8282;&#x6D41;&#x901A;&#x4FE1;&#x4FE1;&#x9053;&#x3002;&#x4E3A;&#x63D0;&#x4F9B;&#x8FD9;&#x4E9B;&#x7279;&#x6027;&#xFF0C;TCP&#x5FC5;&#x987B;&#x8981;&#x6267;&#x884C;&#x672C;&#x8282;&#x4E2D;&#x63CF;&#x8FF0;&#x7684;&#x4EFB;&#x52A1;&#x3002;&#xFF08;&#x6709;&#x5173;&#x6240;&#x6709;&#x8FD9;&#x4E9B;&#x7279;&#x6027;&#x7684;&#x8BE6;&#x7EC6;&#x63CF;&#x8FF0;&#x53EF;&#x4EE5;&#x5728;[Stevens, 1994]&#x4E2D;&#x627E;&#x5230;&#x3002;&#xFF09;</p>
<div class="amp-img-wrapper"><amp-img src="https://pagepig.oss-cn-hangzhou.aliyuncs.com/NeatReader-1581851017391.png?x-oss-process=image/resize,m_lfit,h_450" width="1003" height="383" layout="responsive"></amp-img></div>
<p>&#x8FD9;&#x91CC;&#x4F7F;&#x7528;&#x672F;&#x8BED;TCP&#x7AEF;&#x70B9;&#x6765;&#x8868;&#x793A;TCP&#x8FDE;&#x63A5;&#x4E00;&#x7AEF;&#x7684;&#x5185;&#x6838;&#x6240;&#x7EF4;&#x62A4;&#x7684;&#x4FE1;&#x606F;&#x3002;&#xFF08;&#x901A;&#x5E38;&#x4F1A;&#x8FDB;&#x4E00;&#x6B65;&#x5BF9;&#x8FD9;&#x4E2A;&#x672F;&#x8BED;&#x8FDB;&#x884C;&#x7F29;&#x5199;&#xFF0C;&#x5982;&#x4EC5;&#x4E66;&#x5199;&#x201C;&#x4E00;&#x4E2A;TCP&#x201D;&#x6765;&#x8868;&#x793A;&#x201C;&#x4E00;&#x4E2A;TCP&#x7AEF;&#x70B9;&#x201D;&#x6216;&#x201C;&#x5BA2;&#x6237;&#x7AEF;TCP&#x201D;&#x6765;&#x8868;&#x793A;&#x201C;&#x5BA2;&#x6237;&#x7AEF;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7EF4;&#x62A4;&#x7684;TCP&#x7AEF;&#x70B9;&#x3002;&#x201D;&#xFF09;&#x8FD9;&#x90E8;&#x5206;&#x4FE1;&#x606F;&#x5305;&#x62EC;&#x8FDE;&#x63A5;&#x8FD9;&#x4E00;&#x7AEF;&#x7684;&#x53D1;&#x9001;&#x548C;&#x63A5;&#x6536;&#x7F13;&#x51B2;&#x533A;&#x4EE5;&#x53CA;&#x7EF4;&#x62A4;&#x7684;&#x7528;&#x6765;&#x540C;&#x6B65;&#x4E24;&#x4E2A;&#x5DF2;&#x8FDE;&#x63A5;&#x7684;&#x7AEF;&#x70B9;&#x7684;&#x64CD;&#x4F5C;&#x7684;&#x72B6;&#x6001;&#x4FE1;&#x606F;&#x3002;&#x5728;&#x672C;&#x4E66;&#x4F59;&#x4E0B;&#x7684;&#x90E8;&#x5206;&#x4E2D;&#x5C06;&#x4F7F;&#x7528;&#x672F;&#x8BED;&#x63A5;&#x6536;TCP&#x548C;&#x53D1;&#x9001;TCP&#x6765;&#x8868;&#x793A;&#x4E00;&#x4E2A;&#x7528;&#x6765;&#x5728;&#x7279;&#x5B9A;&#x65B9;&#x5411;&#x4E0A;&#x4F20;&#x8F93;&#x6570;&#x636E;&#x7684;&#x6D41;socket&#x8FDE;&#x63A5;&#x4E24;&#x7AEF;&#x7684;&#x63A5;&#x6536;&#x548C;&#x53D1;&#x9001;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x3002;</p>
<p><strong>&#x8FDE;&#x63A5;&#x5EFA;&#x7ACB;</strong><br>&#x5728;&#x5F00;&#x59CB;&#x901A;&#x4FE1;&#x4E4B;&#x524D;&#xFF0C;TCP&#x9700;&#x8981;&#x5728;&#x4E24;&#x4E2A;&#x7AEF;&#x70B9;&#x4E4B;&#x95F4;&#x5EFA;&#x7ACB;&#x4E00;&#x4E2A;&#x901A;&#x4FE1;&#x4FE1;&#x9053;&#x3002;&#x5728;&#x8FDE;&#x63A5;&#x5EFA;&#x7ACB;&#x671F;&#x95F4;&#xFF0C;&#x53D1;&#x9001;&#x8005;&#x548C;&#x63A5;&#x6536;&#x8005;&#x9700;&#x8981;&#x4EA4;&#x6362;&#x9009;&#x9879;&#x6765;&#x534F;&#x5546;&#x901A;&#x4FE1;&#x7684;&#x53C2;&#x6570;&#x3002;</p>
<p><strong>&#x5C06;&#x6570;&#x636E;&#x6253;&#x5305;&#x6210;&#x6BB5;</strong><br>&#x6570;&#x636E;&#x4F1A;&#x88AB;&#x5206;&#x89E3;&#x6210;&#x6BB5;&#xFF0C;&#x6BCF;&#x4E00;&#x4E2A;&#x6BB5;&#x90FD;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x6821;&#x9A8C;&#x548C;&#xFF0C;&#x4ECE;&#x800C;&#x80FD;&#x591F;&#x68C0;&#x6D4B;&#x51FA;&#x7AEF;&#x5230;&#x7AEF;&#x7684;&#x4F20;&#x8F93;&#x9519;&#x8BEF;&#x3002;&#x6BCF;&#x4E00;&#x4E2A;&#x6BB5;&#x4F7F;&#x7528;&#x5355;&#x4E2A;IP&#x6570;&#x636E;&#x62A5;&#x6765;&#x4F20;&#x8F93;&#x3002;</p>
<p><strong>&#x786E;&#x8BA4;&#x3001;&#x91CD;&#x4F20;&#x4EE5;&#x53CA;&#x8D85;&#x65F6;</strong><br>&#x5F53;&#x4E00;&#x4E2A;TCP&#x6BB5;&#x65E0;&#x9519;&#x5730;&#x8FBE;&#x5230;&#x76EE;&#x7684;&#x5730;&#x65F6;&#xFF0C;&#x63A5;&#x6536;TCP&#x4F1A;&#x5411;&#x53D1;&#x9001;&#x8005;&#x53D1;&#x9001;&#x4E00;&#x4E2A;&#x786E;&#x8BA4;&#xFF0C;&#x901A;&#x77E5;&#x5B83;&#x6570;&#x636E;&#x53D1;&#x9001;&#x9012;&#x9001;&#x6210;&#x529F;&#x4E86;&#x3002;&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x6BB5;&#x5728;&#x5230;&#x8FBE;&#x65F6;&#x662F;&#x5B58;&#x5728;&#x9519;&#x8BEF;&#x7684;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x4E2A;&#x6BB5;&#x5C31;&#x4F1A;&#x88AB;&#x4E22;&#x5F03;&#xFF0C;&#x786E;&#x8BA4;&#x4FE1;&#x606F;&#x4E5F;&#x4E0D;&#x4F1A;&#x88AB;&#x53D1;&#x9001;&#x3002;&#x4E3A;&#x5904;&#x7406;&#x6BB5;&#x6C38;&#x8FDC;&#x4E0D;&#x5230;&#x8FBE;&#x6216;&#x88AB;&#x4E22;&#x5F03;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x53D1;&#x9001;&#x8005;&#x5728;&#x53D1;&#x9001;&#x6BCF;&#x4E00;&#x4E2A;&#x6BB5;&#x65F6;&#x4F1A;&#x5F00;&#x542F;&#x4E00;&#x4E2A;&#x5B9A;&#x65F6;&#x5668;&#x3002;&#x5982;&#x679C;&#x5728;&#x5B9A;&#x65F6;&#x5668;&#x8D85;&#x65F6;&#x4E4B;&#x524D;&#x6CA1;&#x6709;&#x6536;&#x5230;&#x786E;&#x8BA4;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x4F1A;&#x91CD;&#x4F20;&#x8FD9;&#x4E2A;&#x6BB5;&#x3002;</p>
<p>&#x7531;&#x4E8E;&#x6240;&#x4F7F;&#x7528;&#x7684;&#x7F51;&#x7EDC;&#x4EE5;&#x53CA;&#x5F53;&#x524D;&#x7684;&#x6D41;&#x91CF;&#x8D1F;&#x8F7D;&#x4F1A;&#x5F71;&#x54CD;&#x4F20;&#x8F93;&#x4E00;&#x4E2A;&#x6BB5;&#x548C;&#x63A5;&#x6536;&#x5176;&#x786E;&#x8BA4;&#x6240;&#x9700;&#x7684;&#x65F6;&#x95F4;&#xFF0C;&#x56E0;&#x6B64;TCP&#x91C7;&#x7528;&#x4E86;&#x4E00;&#x4E2A;&#x7B97;&#x6CD5;&#x6765;&#x52A8;&#x6001;&#x5730;&#x8C03;&#x6574;&#x91CD;&#x4F20;&#x8D85;&#x65F6;&#x65F6;&#x95F4;&#xFF08;RTO&#xFF09;&#x7684;&#x5927;&#x5C0F;&#x3002;</p>
<p>&#x63A5;&#x6536;TCP&#x53EF;&#x80FD;&#x4E0D;&#x4F1A;&#x7ACB;&#x5373;&#x53D1;&#x9001;&#x786E;&#x8BA4;&#xFF0C;&#x800C;&#x662F;&#x4F1A;&#x7B49;&#x5F85;&#x51E0;&#x6BEB;&#x79D2;&#x6765;&#x89C2;&#x5BDF;&#x4E00;&#x4E0B;&#x662F;&#x5426;&#x53EF;&#x4EE5;&#x5C06;&#x786E;&#x8BA4;&#x585E;&#x8FDB;&#x63A5;&#x6536;&#x8005;&#x8FD4;&#x56DE;&#x7ED9;&#x53D1;&#x9001;&#x8005;&#x7684;&#x54CD;&#x5E94;&#x4E2D;&#x3002;&#xFF08;&#x6BCF;&#x4E2A;TCP&#x6BB5;&#x90FD;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x786E;&#x8BA4;&#x5B57;&#x6BB5;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x80FD;&#x5C06;&#x786E;&#x8BA4;&#x585E;&#x8FDB;TCP&#x6BB5;&#x4E2D;&#x4E86;&#x3002;&#xFF09;&#x8FD9;&#x9879;&#x88AB;&#x79F0;&#x4E3A;&#x5EF6;&#x8FDF;ACK&#x7684;&#x6280;&#x672F;&#x7684;&#x76EE;&#x7684;&#x662F;&#x80FD;&#x5C11;&#x53D1;&#x9001;&#x4E00;&#x4E2A;TCP&#x6BB5;&#xFF0C;&#x4ECE;&#x800C;&#x964D;&#x4F4E;&#x7F51;&#x7EDC;&#x4E2D;&#x5305;&#x7684;&#x6570;&#x91CF;&#x4EE5;&#x53CA;&#x964D;&#x4F4E;&#x53D1;&#x9001;&#x548C;&#x63A5;&#x6536;&#x4E3B;&#x673A;&#x7684;&#x8D1F;&#x8F7D;&#x3002;</p>
<p><strong>&#x6392;&#x5E8F;</strong><br>&#x5728;TCP&#x8FDE;&#x63A5;&#x4E0A;&#x4F20;&#x8F93;&#x7684;&#x6BCF;&#x4E00;&#x4E2A;&#x5B57;&#x8282;&#x90FD;&#x4F1A;&#x5206;&#x914D;&#x5230;&#x4E00;&#x4E2A;&#x903B;&#x8F91;&#x5E8F;&#x53F7;&#x3002;&#x8FD9;&#x4E2A;&#x6570;&#x5B57;&#x6307;&#x51FA;&#x4E86;&#x8BE5;&#x5B57;&#x8282;&#x5728;&#x8FD9;&#x4E2A;&#x8FDE;&#x63A5;&#x7684;&#x6570;&#x636E;&#x6D41;&#x4E2D;&#x6240;&#x5904;&#x7684;&#x4F4D;&#x7F6E;&#x3002;&#xFF08;&#x8FD9;&#x4E2A;&#x8FDE;&#x63A5;&#x4E2D;&#x7684;&#x4E24;&#x4E2A;&#x6D41;&#x5404;&#x81EA;&#x90FD;&#x6709;&#x81EA;&#x5DF1;&#x7684;&#x5E8F;&#x53F7;&#x8BA1;&#x6570;&#x7CFB;&#x7EDF;&#x3002;&#xFF09;&#x5F53;&#x4F20;&#x8F93;&#x4E00;&#x4E2A;TCP&#x5206;&#x6BB5;&#x65F6;&#x4F1A;&#x5728;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x5B57;&#x6BB5;&#x4E2D;&#x5305;&#x542B;&#x8FD9;&#x4E2A;&#x6BB5;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x5B57;&#x8282;&#x7684;&#x5E8F;&#x53F7;&#x3002;</p>
<p>&#x5728;&#x6BCF;&#x4E00;&#x4E2A;&#x6BB5;&#x4E2D;&#x52A0;&#x4E0A;&#x4E00;&#x4E2A;&#x5E8F;&#x53F7;&#x6709;&#x51E0;&#x4E2A;&#x4F5C;&#x7528;&#x3002;</p>
<ul>
<li>&#x8FD9;&#x4E2A;&#x5E8F;&#x53F7;&#x4F7F;&#x5F97;TCP&#x5206;&#x6BB5;&#x80FD;&#x591F;&#x4EE5;&#x6B63;&#x786E;&#x7684;&#x987A;&#x5E8F;&#x5728;&#x76EE;&#x7684;&#x5730;&#x8FDB;&#x884C;&#x7EC4;&#x88C5;&#xFF0C;&#x7136;&#x540E;&#x4EE5;&#x5B57;&#x8282;&#x6D41;&#x7684;&#x5F62;&#x5F0F;&#x4F20;&#x9012;&#x7ED9;&#x5E94;&#x7528;&#x5C42;&#x3002;&#xFF08;&#x5728;&#x4EFB;&#x610F;&#x4E00;&#x4E2A;&#x65F6;&#x523B;&#xFF0C;&#x5728;&#x53D1;&#x9001;&#x8005;&#x548C;&#x63A5;&#x6536;&#x8005;&#x4E4B;&#x95F4;&#x53EF;&#x80FD;&#x5B58;&#x5728;&#x591A;&#x4E2A;&#x6B63;&#x5728;&#x4F20;&#x8F93;&#x7684;TCP&#x5206;&#x6BB5;&#xFF0C;&#x8FD9;&#x4E9B;&#x5206;&#x6BB5;&#x7684;&#x5230;&#x8FBE;&#x987A;&#x5E8F;&#x53EF;&#x80FD;&#x4E0E;&#x88AB;&#x53D1;&#x9001;&#x7684;&#x987A;&#x5E8F;&#x53EF;&#x80FD;&#x662F;&#x4E0D;&#x540C;&#x7684;&#x3002;&#xFF09;</li>
<li>&#x7531;&#x63A5;&#x6536;&#x8005;&#x8FD4;&#x56DE;&#x7ED9;&#x53D1;&#x9001;&#x8005;&#x7684;&#x786E;&#x8BA4;&#x6D88;&#x606F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5E8F;&#x53F7;&#x6765;&#x6807;&#x8BC6;&#x51FA;&#x6536;&#x5230;&#x4E86;&#x54EA;&#x4E2A;TCP&#x5206;&#x6BB5;&#x3002;</li>
<li>&#x63A5;&#x6536;&#x8005;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5E8F;&#x53F7;&#x6765;&#x79FB;&#x9664;&#x91CD;&#x590D;&#x7684;&#x5206;&#x6BB5;&#x3002;&#x53D1;&#x751F;&#x91CD;&#x590D;&#x7684;&#x539F;&#x56E0;&#x53EF;&#x80FD;&#x662F;&#x56E0;&#x4E3A;IP&#x6570;&#x636E;&#x6BB5;&#x91CD;&#x590D;&#xFF0C;&#x4E5F;&#x53EF;&#x80FD;&#x662F;&#x56E0;&#x4E3A;TCP&#x81EA;&#x5DF1;&#x7684;&#x91CD;&#x4F20;&#x7B97;&#x6CD5;&#x4F1A;&#x5728;&#x4E00;&#x4E2A;&#x6BB5;&#x7684;&#x786E;&#x8BA4;&#x4E22;&#x5931;&#x6216;&#x6CA1;&#x6709;&#x6309;&#x65F6;&#x6536;&#x5230;&#x65F6;&#x91CD;&#x4F20;&#x4E00;&#x4E2A;&#x6210;&#x529F;&#x9012;&#x9001;&#x51FA;&#x53BB;&#x7684;&#x6BB5;&#x3002;</li>
</ul>
<p>&#x4E00;&#x4E2A;&#x6D41;&#x7684;&#x521D;&#x59CB;&#x5E8F;&#x53F7;&#xFF08;ISN&#xFF09;&#x4E0D;&#x662F;&#x4ECE;0&#x5F00;&#x59CB;&#x7684;&#xFF0C;&#x76F8;&#x53CD;&#xFF0C;&#x5B83;&#x662F;&#x901A;&#x8FC7;&#x4E00;&#x4E2A;&#x7B97;&#x6CD5;&#x6765;&#x751F;&#x6210;&#x7684;&#xFF0C;&#x8BE5;&#x7B97;&#x6CD5;&#x4F1A;&#x9012;&#x589E;&#x5206;&#x914D;&#x7ED9;&#x540E;&#x7EED;TCP&#x8FDE;&#x63A5;&#x7684;ISN&#xFF08;&#x4E3A;&#x9632;&#x6B62;&#x51FA;&#x73B0;&#x524D;&#x4E00;&#x4E2A;&#x8FDE;&#x63A5;&#x4E2D;&#x7684;&#x5206;&#x6BB5;&#x4E0E;&#x8FD9;&#x4E2A;&#x8FDE;&#x63A5;&#x4E2D;&#x7684;&#x5206;&#x6BB5;&#x6DF7;&#x6DC6;&#x7684;&#x60C5;&#x51B5;&#xFF09;&#x3002;&#x8FD9;&#x4E2A;&#x7B97;&#x6CD5;&#x4E5F;&#x4F7F;&#x5F97;&#x731C;&#x6D4B;ISN&#x53D8;&#x5F97;&#x56F0;&#x96BE;&#x8D77;&#x6765;&#x3002;&#x5E8F;&#x53F7;&#x662F;&#x4E00;&#x4E2A;32&#x4F4D;&#x7684;&#x503C;&#xFF0C;&#x5F53;&#x5230;&#x8FBE;&#x6700;&#x5927;&#x53D6;&#x503C;&#x65F6;&#x4F1A;&#x56DE;&#x5230;0&#x3002;</p>
<p><strong>&#x6D41;&#x91CF;&#x63A7;&#x5236;</strong><br>&#x6D41;&#x91CF;&#x63A7;&#x5236;&#x9632;&#x6B62;&#x4E00;&#x4E2A;&#x5FEB;&#x901F;&#x7684;&#x53D1;&#x9001;&#x8005;&#x5C06;&#x4E00;&#x4E2A;&#x6162;&#x901F;&#x7684;&#x63A5;&#x6536;&#x8005;&#x538B;&#x57AE;&#x3002;&#x8981;&#x5B9E;&#x73B0;&#x6D41;&#x91CF;&#x63A7;&#x5236;&#xFF0C;&#x63A5;&#x6536;TCP&#x5C31;&#x5FC5;&#x987B;&#x8981;&#x4E3A;&#x8FDB;&#x5165;&#x7684;&#x6570;&#x636E;&#x7EF4;&#x62A4;&#x4E00;&#x4E2A;&#x7F13;&#x51B2;&#x533A;&#x3002;&#xFF08;&#x6BCF;&#x4E2A;TCP&#x5728;&#x8FDE;&#x63A5;&#x5EFA;&#x7ACB;&#x9636;&#x6BB5;&#x4F1A;&#x901A;&#x544A;&#x5176;&#x7F13;&#x51B2;&#x533A;&#x7684;&#x5927;&#x5C0F;&#x3002;&#xFF09;&#x5F53;&#x4ECE;&#x53D1;&#x9001;TCP&#x7AEF;&#x6536;&#x5230;&#x6570;&#x636E;&#x65F6;&#x4F1A;&#x5C06;&#x6570;&#x636E;&#x7D2F;&#x79EF;&#x5728;&#x8FD9;&#x4E2A;&#x7F13;&#x51B2;&#x533A;&#x4E2D;&#xFF0C;&#x5F53;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x8BFB;&#x53D6;&#x6570;&#x636E;&#x65F6;&#x4F1A;&#x4ECE;&#x7F13;&#x51B2;&#x533A;&#x4E2D;&#x5220;&#x9664;&#x6570;&#x636E;&#x3002;&#x5728;&#x6BCF;&#x4E2A;&#x786E;&#x8BA4;&#x4E2D;&#xFF0C;&#x63A5;&#x6536;&#x8005;&#x4F1A;&#x901A;&#x77E5;&#x53D1;&#x9001;&#x8005;&#x5176;&#x8FDB;&#x5165;&#x6570;&#x636E;&#x7F13;&#x51B2;&#x533A;&#x7684;&#x53EF;&#x7528;&#x7A7A;&#x95F4;&#xFF08;&#x5373;&#x53D1;&#x9001;&#x8005;&#x53EF;&#x4EE5;&#x53D1;&#x9001;&#x591A;&#x5C11;&#x5B57;&#x8282;&#xFF09;&#x3002;TCP&#x6D41;&#x91CF;&#x63A7;&#x5236;&#x7B97;&#x6CD5;&#x91C7;&#x7528;&#x4E86;&#x6240;&#x8C13;&#x7684;&#x6ED1;&#x52A8;&#x7A97;&#x53E3;&#x7B97;&#x6CD5;&#xFF0C;&#x5B83;&#x5141;&#x8BB8;&#x5305;&#x542B;&#x603B;&#x5171;N&#x5B57;&#x8282;&#xFF08;&#x63D0;&#x4F9B;&#x7684;&#x7A97;&#x53E3;&#x5927;&#x5C0F;&#xFF09;&#x7684;&#x672A;&#x786E;&#x8BA4;&#x6BB5;&#x540C;&#x65F6;&#x5728;&#x53D1;&#x9001;&#x8005;&#x548C;&#x63A5;&#x6536;&#x8005;&#x4E4B;&#x95F4;&#x4F20;&#x8F93;&#x3002;&#x5982;&#x679C;&#x63A5;&#x6536;TCP&#x7684;&#x8FDB;&#x5165;&#x6570;&#x636E;&#x7F13;&#x51B2;&#x533A;&#x5B8C;&#x5168;&#x88AB;&#x5145;&#x6EE1;&#x4E86;&#xFF0C;&#x90A3;&#x4E48;&#x7A97;&#x53E3;&#x5C31;&#x4F1A;&#x5173;&#x95ED;&#xFF0C;&#x53D1;&#x9001;TCP&#x5C31;&#x4F1A;&#x505C;&#x6B62;&#x4F20;&#x8F93;&#x6570;&#x636E;&#x3002;</p>
<p>&#x63A5;&#x6536;&#x8005;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;SO_RCVBUF socket&#x9009;&#x9879;&#x6765;&#x8986;&#x76D6;&#x8FDB;&#x5165;&#x6570;&#x636E;&#x7F13;&#x51B2;&#x533A;&#x7684;&#x9ED8;&#x8BA4;&#x5927;&#x5C0F;&#xFF08;&#x53C2;&#x89C1;socket(7)&#x624B;&#x518C;&#xFF09;&#x3002;</p>
<p><strong>&#x62E5;&#x585E;&#x63A7;&#x5236;&#xFF1A;&#x6162;&#x542F;&#x52A8;&#x548C;&#x62E5;&#x585E;&#x907F;&#x514D;&#x7B97;&#x6CD5;</strong><br>TCP&#x7684;&#x62E5;&#x585E;&#x63A7;&#x5236;&#x7B97;&#x6CD5;&#x88AB;&#x8BBE;&#x8BA1;&#x7528;&#x6765;&#x9632;&#x6B62;&#x5FEB;&#x901F;&#x7684;&#x53D1;&#x9001;&#x8005;&#x538B;&#x57AE;&#x6574;&#x4E2A;&#x7F51;&#x7EDC;&#x3002;&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x53D1;&#x9001;TCP&#x53D1;&#x9001;&#x5305;&#x7684;&#x901F;&#x5EA6;&#x8981;&#x5FEB;&#x4E8E;&#x4E00;&#x4E2A;&#x4E2D;&#x95F4;&#x8DEF;&#x7531;&#x5668;&#x8F6C;&#x53D1;&#x7684;&#x901F;&#x5EA6;&#xFF0C;&#x90A3;&#x4E48;&#x8BE5;&#x8DEF;&#x7531;&#x5668;&#x5C31;&#x4F1A;&#x5F00;&#x59CB;&#x4E22;&#x5F03;&#x5305;&#x3002;&#x8FD9;&#x5C06;&#x4F1A;&#x5BFC;&#x81F4;&#x8F83;&#x9AD8;&#x7684;&#x5305;&#x4E22;&#x5931;&#x7387;&#xFF0C;&#x5176;&#x7ED3;&#x679C;&#x662F;&#x5982;&#x679C;TCP&#x4FDD;&#x6301;&#x4EE5;&#x76F8;&#x540C;&#x7684;&#x901F;&#x5EA6;&#x53D1;&#x9001;&#x8FD9;&#x4E9B;&#x88AB;&#x4E22;&#x5F03;&#x7684;&#x5206;&#x6BB5;&#x7684;&#x8BDD;&#x5C31;&#x4F1A;&#x6781;&#x5927;&#x5730;&#x964D;&#x4F4E;&#x6027;&#x80FD;&#x3002;TCP&#x7684;&#x62E5;&#x585E;&#x63A7;&#x5236;&#x7B97;&#x6CD5;&#x5728;&#x4E0B;&#x5217;&#x4E24;&#x4E2A;&#x573A;&#x666F;&#x4E2D;&#x662F;&#x6BD4;&#x8F83;&#x91CD;&#x8981;&#x7684;&#x3002;</p>
<ul>
<li>&#x5728;&#x8FDE;&#x63A5;&#x5EFA;&#x7ACB;&#x4E4B;&#x540E;&#xFF1A;&#x6B64;&#x65F6;&#xFF08;&#x6216;&#x5F53;&#x4F20;&#x8F93;&#x5728;&#x4E00;&#x4E2A;&#x5DF2;&#x7ECF;&#x7A7A;&#x95F2;&#x4E86;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;&#x7684;&#x8FDE;&#x63A5;&#x4E0A;&#x6062;&#x590D;&#x65F6;&#xFF09;&#xFF0C;&#x53D1;&#x9001;&#x8005;&#x53EF;&#x4EE5;&#x7ACB;&#x5373;&#x5411;&#x7F51;&#x7EDC;&#x4E2D;&#x6CE8;&#x5165;&#x5C3D;&#x53EF;&#x80FD;&#x591A;&#x7684;&#x5206;&#x6BB5;&#xFF0C;&#x53EA;&#x8981;&#x63A5;&#x6536;&#x8005;&#x516C;&#x544A;&#x7684;&#x7A97;&#x53E3;&#x5927;&#x5C0F;&#x5141;&#x8BB8;&#x5373;&#x53EF;&#x3002;&#xFF08;&#x4E8B;&#x5B9E;&#x4E0A;&#xFF0C;&#x8FD9;&#x5C31;&#x662F;&#x65E9;&#x671F;&#x7684;TCP&#x5B9E;&#x73B0;&#x7684;&#x505A;&#x6CD5;&#x3002;&#xFF09;&#x8FD9;&#x91CC;&#x7684;&#x95EE;&#x9898;&#x5728;&#x4E8E;&#x5982;&#x679C;&#x7F51;&#x7EDC;&#x65E0;&#x6CD5;&#x5904;&#x7406;&#x8FD9;&#x79CD;&#x5206;&#x6BB5;&#x6D2A;&#x6CDB;&#xFF0C;&#x90A3;&#x4E48;&#x53D1;&#x9001;&#x8005;&#x4F1A;&#x5B58;&#x5728;&#x7ACB;&#x5373;&#x538B;&#x57AE;&#x6574;&#x4E2A;&#x7F51;&#x7EDC;&#x7684;&#x98CE;&#x9669;&#x3002;</li>
<li>&#x5F53;&#x62E5;&#x585E;&#x88AB;&#x68C0;&#x6D4B;&#x5230;&#x65F6;&#xFF1A;&#x5982;&#x679C;&#x53D1;&#x9001;TCP&#x68C0;&#x6D4B;&#x5230;&#x53D1;&#x751F;&#x4E86;&#x62E5;&#x585E;&#xFF0C;&#x90A3;&#x4E48;&#x5B83;&#x5C31;&#x5FC5;&#x987B;&#x8981;&#x964D;&#x4F4E;&#x5176;&#x4F20;&#x8F93;&#x901F;&#x7387;&#x3002;TCP&#x662F;&#x6839;&#x636E;&#x5206;&#x6BB5;&#x4E22;&#x5931;&#x6765;&#x68C0;&#x6D4B;&#x662F;&#x5426;&#x53D1;&#x751F;&#x4E86;&#x62E5;&#x585E;&#xFF0C;&#x56E0;&#x4E3A;&#x4F20;&#x8F93;&#x9519;&#x8BEF;&#x7387;&#x662F;&#x975E;&#x5E38;&#x4F4E;&#x7684;&#xFF0C;&#x5373;&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x5305;&#x4E22;&#x5931;&#x4E86;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x8BA4;&#x4E3A;&#x53D1;&#x751F;&#x4E86;&#x62E5;&#x585E;&#x3002;</li>
</ul>
<p>TCP&#x7684;&#x62E5;&#x585E;&#x63A7;&#x5236;&#x7B56;&#x7565;&#x7EC4;&#x5408;&#x91C7;&#x7528;&#x4E86;&#x4E24;&#x79CD;&#x7B97;&#x6CD5;&#xFF1A;&#x6162;&#x542F;&#x52A8;&#x548C;&#x62E5;&#x585E;&#x907F;&#x514D;&#x3002;</p>
<p>&#x6162;&#x542F;&#x52A8;&#x7B97;&#x6CD5;&#x4F1A;&#x4F7F;&#x53D1;&#x9001;TCP&#x5728;&#x4E00;&#x5F00;&#x59CB;&#x7684;&#x65F6;&#x5019;&#x4EE5;&#x4F4E;&#x901F;&#x4F20;&#x8F93;&#x5206;&#x6BB5;&#xFF0C;&#x4F46;&#x540C;&#x65F6;&#x5141;&#x8BB8;&#x5B83;&#x4EE5;&#x6307;&#x6570;&#x7EA7;&#x7684;&#x901F;&#x5EA6;&#x63D0;&#x9AD8;&#x5176;&#x901F;&#x7387;&#xFF0C;&#x53EA;&#x8981;&#x8FD9;&#x4E9B;&#x5206;&#x6BB5;&#x90FD;&#x5F97;&#x5230;&#x63A5;&#x6536;TCP&#x7684;&#x786E;&#x8BA4;&#x3002;&#x6162;&#x542F;&#x52A8;&#x80FD;&#x591F;&#x9632;&#x6B62;&#x4E00;&#x4E2A;&#x5FEB;&#x901F;&#x7684;TCP&#x53D1;&#x9001;&#x8005;&#x538B;&#x57AE;&#x6574;&#x4E2A;&#x7F51;&#x7EDC;&#x3002;&#x4F46;&#x5982;&#x679C;&#x4E0D;&#x52A0;&#x9650;&#x5236;&#x7684;&#x8BDD;&#xFF0C;&#x6162;&#x542F;&#x52A8;&#x5728;&#x4F20;&#x8F93;&#x901F;&#x7387;&#x4E0A;&#x7684;&#x6307;&#x6570;&#x7EA7;&#x589E;&#x957F;&#x610F;&#x5473;&#x7740;&#x53D1;&#x9001;&#x8005;&#x5728;&#x77ED;&#x65F6;&#x95F4;&#x5185;&#x5C31;&#x4F1A;&#x538B;&#x57AE;&#x6574;&#x4E2A;&#x7F51;&#x7EDC;&#x3002;TCP&#x7684;&#x62E5;&#x585E;&#x907F;&#x514D;&#x7B97;&#x6CD5;&#x7528;&#x6765;&#x9632;&#x6B62;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x7684;&#x53D1;&#x751F;&#xFF0C;&#x5B83;&#x4E3A;&#x901F;&#x7387;&#x7684;&#x589E;&#x957F;&#x5B89;&#x6392;&#x4E86;&#x4E00;&#x4E2A;&#x7BA1;&#x7406;&#x5B9E;&#x4F53;&#x3002;</p>
<p>&#x6709;&#x4E86;&#x62E5;&#x585E;&#x907F;&#x514D;&#x4E4B;&#x540E;&#xFF0C;&#x5728;&#x8FDE;&#x63A5;&#x521A;&#x5EFA;&#x7ACB;&#x65F6;&#xFF0C;&#x53D1;&#x9001;TCP&#x4F1A;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x8F83;&#x5C0F;&#x7684;&#x62E5;&#x585E;&#x7A97;&#x53E3;&#xFF0C;&#x5B83;&#x4F1A;&#x9650;&#x5236;&#x6240;&#x80FD;&#x4F20;&#x8F93;&#x7684;&#x672A;&#x786E;&#x8BA4;&#x7684;&#x6570;&#x636E;&#x6570;&#x91CF;&#x3002;&#x5F53;&#x53D1;&#x9001;&#x8005;&#x4ECE;&#x5BF9;&#x7B49;TCP&#x5904;&#x63A5;&#x6536;&#x5230;&#x786E;&#x8BA4;&#x65F6;&#xFF0C;&#x62E5;&#x585E;&#x7A97;&#x53E3;&#x5728;&#x4E00;&#x5F00;&#x59CB;&#x65F6;&#x4F1A;&#x5448;&#x73B0;&#x6307;&#x6570;&#x7EA7;&#x589E;&#x957F;&#x3002;&#x4F46;&#x4E00;&#x65E6;&#x62E5;&#x585E;&#x7A97;&#x53E3;&#x589E;&#x957F;&#x5230;&#x4E00;&#x4E2A;&#x88AB;&#x8BA4;&#x4E3A;&#x662F;&#x63A5;&#x8FD1;&#x7F51;&#x7EDC;&#x4F20;&#x8F93;&#x5BB9;&#x91CF;&#x7684;&#x9608;&#x503C;&#x65F6;&#xFF0C;&#x5176;&#x589E;&#x957F;&#x901F;&#x5EA6;&#x5C31;&#x4F1A;&#x53D8;&#x6210;&#x7EBF;&#x6027;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x6307;&#x6570;&#x7EA7;&#x7684;&#x3002;&#xFF08;&#x5BF9;&#x7F51;&#x7EDC;&#x5BB9;&#x91CF;&#x7684;&#x4F30;&#x7B97;&#x662F;&#x6839;&#x636E;&#x68C0;&#x6D4B;&#x5230;&#x62E5;&#x585E;&#x65F6;&#x7684;&#x4F20;&#x8F93;&#x901F;&#x7387;&#x6765;&#x8BA1;&#x7B97;&#x5F97;&#x51FA;&#x7684;&#x6216;&#x8005;&#x5728;&#x4E00;&#x5F00;&#x59CB;&#x5EFA;&#x7ACB;&#x8FDE;&#x63A5;&#x65F6;&#x8BBE;&#x5B9A;&#x4E3A;&#x4E00;&#x4E2A;&#x56FA;&#x5B9A;&#x503C;&#x3002;&#xFF09;&#x5728;&#x4EFB;&#x4F55;&#x65F6;&#x523B;&#xFF0C;&#x53D1;&#x9001;TCP&#x4F20;&#x8F93;&#x7684;&#x6570;&#x636E;&#x6570;&#x91CF;&#x8FD8;&#x4F1A;&#x53D7;&#x5230;&#x63A5;&#x6536;TCP&#x7684;&#x901A;&#x544A;&#x7A97;&#x53E3;&#x548C;&#x672C;&#x5730;&#x7684;TCP&#x53D1;&#x9001;&#x7F13;&#x51B2;&#x5668;&#x7684;&#x5927;&#x5C0F;&#x7684;&#x9650;&#x5236;&#x3002;</p>
<p>&#x6162;&#x542F;&#x52A8;&#x548C;&#x62E5;&#x585E;&#x907F;&#x514D;&#x7B97;&#x6CD5;&#x7EC4;&#x5408;&#x8D77;&#x6765;&#x4F7F;&#x5F97;&#x53D1;&#x9001;&#x8005;&#x53EF;&#x4EE5;&#x5FEB;&#x901F;&#x5730;&#x5C06;&#x4F20;&#x8F93;&#x901F;&#x5EA6;&#x63D0;&#x5347;&#x81F3;&#x7F51;&#x7EDC;&#x7684;&#x53EF;&#x7528;&#x5BB9;&#x91CF;&#xFF0C;&#x5E76;&#x4E14;&#x4E0D;&#x4F1A;&#x8D85;&#x51FA;&#x8BE5;&#x5BB9;&#x91CF;&#x3002;&#x8FD9;&#x4E9B;&#x7B97;&#x6CD5;&#x7684;&#x4F5C;&#x7528;&#x662F;&#x5141;&#x8BB8;&#x6570;&#x636E;&#x4F20;&#x8F93;&#x5FEB;&#x901F;&#x5730;&#x5230;&#x8FBE;&#x4E00;&#x4E2A;&#x5E73;&#x8861;&#x72B6;&#x6001;&#xFF0C;&#x5373;&#x53D1;&#x9001;&#x8005;&#x4F20;&#x8F93;&#x5305;&#x7684;&#x901F;&#x7387;&#x4E0E;&#x5B83;&#x4ECE;&#x63A5;&#x6536;&#x8005;&#x5904;&#x63A5;&#x6536;&#x786E;&#x8BA4;&#x7684;&#x901F;&#x7387;&#x4E00;&#x81F4;&#x3002;</p>
<h1 id="SOCKET&#xFF1A;Internet-Domain"><a href="#SOCKET&#xFF1A;Internet-Domain" class="headerlink" title="SOCKET&#xFF1A;Internet Domain"></a>SOCKET&#xFF1A;Internet Domain</h1><p>Internet domain&#x6D41;socket&#x662F;&#x57FA;&#x4E8E;TCP&#x4E4B;&#x4E0A;&#x7684;&#xFF0C;&#x5B83;&#x4EEC;&#x63D0;&#x4F9B;&#x4E86;&#x53EF;&#x9760;&#x7684;&#x53CC;&#x5411;&#x5B57;&#x8282;&#x6D41;&#x901A;&#x4FE1;&#x4FE1;&#x9053;&#x3002;</p>
<p>Internet domain&#x6570;&#x636E;&#x62A5;socket&#x662F;&#x57FA;&#x4E8E;UDP&#x4E4B;&#x4E0A;&#x7684;&#x3002;UDP socket&#x4E0E;&#x4E4B;&#x5728;UNIX domain&#x4E2D;&#x7684;&#x5BF9;&#x5E94;&#x5B9E;&#x4F53;&#x7C7B;&#x4F3C;&#xFF0C;&#x4F46;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x4E0B;&#x5217;&#x5DEE;&#x522B;&#x3002;</p>
<ul>
<li>UNIX domain&#x6570;&#x636E;&#x62A5;socket&#x662F;&#x53EF;&#x9760;&#x7684;&#xFF0C;&#x4F46;UDP socket&#x5219;&#x662F;&#x4E0D;&#x53EF;&#x9760;&#x7684;&#x2014;&#x2014;&#x6570;&#x636E;&#x62A5;&#x53EF;&#x80FD;&#x4F1A;&#x4E22;&#x5931;&#x3001;&#x91CD;&#x590D;&#x6216;&#x5230;&#x8FBE;&#x7684;&#x987A;&#x5E8F;&#x4E0E;&#x5B83;&#x4EEC;&#x88AB;&#x53D1;&#x9001;&#x7684;&#x987A;&#x5E8F;&#x4E0D;&#x540C;&#x3002;</li>
<li>&#x5728;&#x4E00;&#x4E2A;UNIX domain&#x6570;&#x636E;&#x62A5;socket&#x4E0A;&#x53D1;&#x9001;&#x6570;&#x636E;&#x4F1A;&#x5728;&#x63A5;&#x6536;socket&#x7684;&#x6570;&#x636E;&#x961F;&#x5217;&#x4E3A;&#x6EE1;&#x65F6;&#x963B;&#x585E;&#x3002;&#x4E0E;&#x4E4B;&#x4E0D;&#x540C;&#x7684;&#x662F;&#xFF0C;&#x4F7F;&#x7528;UDP&#x65F6;&#x5982;&#x679C;&#x8FDB;&#x5165;&#x7684;&#x6570;&#x636E;&#x62A5;&#x4F1A;&#x4F7F;&#x63A5;&#x6536;&#x8005;&#x7684;&#x961F;&#x5217;&#x6EA2;&#x51FA;&#xFF0C;&#x90A3;&#x4E48;&#x6570;&#x636E;&#x62A5;&#x5C31;&#x4F1A;&#x9759;&#x9ED8;&#x5730;&#x88AB;&#x4E22;&#x5F03;&#x3002;</li>
</ul>
<h2 id="&#x7F51;&#x7EDC;&#x5B57;&#x8282;&#x5E8F;"><a href="#&#x7F51;&#x7EDC;&#x5B57;&#x8282;&#x5E8F;" class="headerlink" title="&#x7F51;&#x7EDC;&#x5B57;&#x8282;&#x5E8F;"></a>&#x7F51;&#x7EDC;&#x5B57;&#x8282;&#x5E8F;</h2><p>IP&#x5730;&#x5740;&#x548C;&#x7AEF;&#x53E3;&#x53F7;&#x662F;&#x6574;&#x6570;&#x503C;&#x3002;&#x5728;&#x5C06;&#x8FD9;&#x4E9B;&#x503C;&#x5728;&#x7F51;&#x7EDC;&#x4E2D;&#x4F20;&#x9012;&#x65F6;&#x78B0;&#x5230;&#x7684;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#x662F;&#x4E0D;&#x540C;&#x7684;&#x786C;&#x4EF6;&#x7ED3;&#x6784;&#x4F1A;&#x4EE5;&#x4E0D;&#x540C;&#x7684;&#x987A;&#x5E8F;&#x6765;&#x5B58;&#x50A8;&#x4E00;&#x4E2A;&#x591A;&#x5B57;&#x8282;&#x6574;&#x6570;&#x7684;&#x5B57;&#x8282;&#x3002;&#x4ECE;&#x56FE;59-1&#x4E2D;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF0C;&#x5B58;&#x50A8;&#x6574;&#x6570;&#x65F6;&#x5148;&#x5B58;&#x50A8;&#xFF08;&#x5373;&#x5728;&#x6700;&#x5C0F;&#x5185;&#x5B58;&#x5730;&#x5740;&#x5904;&#xFF09;&#x6700;&#x9AD8;&#x6709;&#x6548;&#x4F4D;&#x7684;&#x88AB;&#x79F0;&#x4E3A;&#x5927;&#x7AEF;&#xFF0C;&#x90A3;&#x4E9B;&#x5148;&#x5B58;&#x50A8;&#x6700;&#x4F4E;&#x6709;&#x6548;&#x4F4D;&#x7684;&#x88AB;&#x79F0;&#x4E3A;&#x5C0F;&#x7AEF;&#x3002;&#xFF08;&#x8FD9;&#x4E24;&#x4E2A;&#x672F;&#x8BED;&#x51FA;&#x81EA;Jonathan Swift&#x5728;1726&#x5E74;&#x53D1;&#x8868;&#x7684;&#x8BBD;&#x523A;&#x5C0F;&#x8BF4;&#x300A;&#x683C;&#x5217;&#x4F5B;&#x6E38;&#x8BB0;&#x300B;&#xFF0C;&#x5728;&#x90A3;&#x7BC7;&#x5C0F;&#x8BF4;&#x4E2D;&#x8FD9;&#x4E24;&#x4E2A;&#x672F;&#x8BED;&#x6307;&#x5728;&#x53E6;&#x4E00;&#x7AEF;&#x6253;&#x5F00;&#x716E;&#x9E21;&#x86CB;&#x7684;&#x654C;&#x5BF9;&#x653F;&#x6CBB;&#x6D3E;&#x522B;&#x3002;&#xFF09;&#x5C0F;&#x7AEF;&#x67B6;&#x6784;&#x4E2D;&#x6700;&#x503C;</p>
<p>TODO.</p>
<h1 id="SOCKET&#xFF1A;&#x4F8B;&#x7A0B;"><a href="#SOCKET&#xFF1A;&#x4F8B;&#x7A0B;" class="headerlink" title="SOCKET&#xFF1A;&#x4F8B;&#x7A0B;"></a>SOCKET&#xFF1A;&#x4F8B;&#x7A0B;</h1><h3 id="&#x7B80;&#x5355;&#x7684;&#x670D;&#x52A1;&#x5668;"><a href="#&#x7B80;&#x5355;&#x7684;&#x670D;&#x52A1;&#x5668;" class="headerlink" title="&#x7B80;&#x5355;&#x7684;&#x670D;&#x52A1;&#x5668;"></a>&#x7B80;&#x5355;&#x7684;&#x670D;&#x52A1;&#x5668;</h3><p>&#x8FD9;&#x4E2A;&#x670D;&#x52A1;&#x5668;&#x6240;&#x505A;&#x7684;&#x5168;&#x90E8;&#x5DE5;&#x4F5C;&#x662F;&#x5728;&#x6D41;&#x5F0F;&#x8FDE;&#x63A5;&#x4E0A;&#x53D1;&#x9001;&#x5B57;&#x7B26;&#x4E32; &#x201C;Hello, World!\n&#x201D;&#x3002;<br><strong>server.c</strong></p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;errno.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;sys/types.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;netinet/in.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;arpa/inet.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;sys/socket.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;sys/wait.h&gt;</span></span>

<span class="token macro property">#<span class="token directive keyword">define</span> MYPORT 3490 </span><span class="token comment" spellcheck="true">/*&#x5B9A;&#x4E49;&#x7528;&#x6237;&#x8FDE;&#x63A5;&#x7AEF;&#x53E3;*/</span>
<span class="token macro property">#<span class="token directive keyword">define</span> BACKLOG 10 </span><span class="token comment" spellcheck="true">/*&#x591A;&#x5C11;&#x7B49;&#x5F85;&#x8FDE;&#x63A5;&#x63A7;&#x5236;*/</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> sockfd<span class="token punctuation">,</span> new_fd<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* listen on sock_fd, new connection on new_fd */</span>
    <span class="token keyword">struct</span> sockaddr_in my_addr<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* my address information */</span>
    <span class="token keyword">struct</span> sockaddr_in their_addr<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* connector&apos;s address information */</span>
    <span class="token keyword">int</span> sin_size<span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>sockfd <span class="token operator">=</span> <span class="token function">socket</span><span class="token punctuation">(</span>AF_INET<span class="token punctuation">,</span> SOCK_STREAM<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">&quot;socket&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    my_addr<span class="token punctuation">.</span>sin_family <span class="token operator">=</span> AF_INET<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* host byte order */</span>
    my_addr<span class="token punctuation">.</span>sin_port <span class="token operator">=</span> <span class="token function">htons</span><span class="token punctuation">(</span>MYPORT<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* short, network byte order */</span>
    my_addr<span class="token punctuation">.</span>sin_addr<span class="token punctuation">.</span>s_addr <span class="token operator">=</span> INADDR_ANY<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* auto-fill with my IP */</span>
    <span class="token function">bzero</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token punctuation">(</span>my_addr<span class="token punctuation">.</span>sin_zero<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>my_addr<span class="token punctuation">.</span>sin_zero<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* zero the rest of the struct */</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">bind</span><span class="token punctuation">(</span>sockfd<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">struct</span> sockaddr <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>my_addr<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> sockaddr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">&quot;bind&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">listen</span><span class="token punctuation">(</span>sockfd<span class="token punctuation">,</span> BACKLOG<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">&quot;listen&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">/* main accept() loop */</span>
        sin_size <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> sockaddr_in<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>new_fd <span class="token operator">=</span> <span class="token function">accept</span><span class="token punctuation">(</span>sockfd<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">struct</span> sockaddr <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>their_addr<span class="token punctuation">,</span> <span class="token operator">&amp;</span>sin_size<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">&quot;accept&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">continue</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;server: got connection from %s\n&quot;</span><span class="token punctuation">,</span> \
        <span class="token function">inet_ntoa</span><span class="token punctuation">(</span>their_addr<span class="token punctuation">.</span>sin_addr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">/* this is the child process */</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">send</span><span class="token punctuation">(</span>new_fd<span class="token punctuation">,</span> <span class="token string">&quot;Hello, world!\n&quot;</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">&quot;send&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token punctuation">}</span>

            <span class="token function">close</span><span class="token punctuation">(</span>new_fd<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token function">close</span><span class="token punctuation">(</span>new_fd<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* parent doesn&apos;t need this */</span>

        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">waitpid</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">,</span>WNOHANG<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* clean up child processes */</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>&#x5728;&#x4E00;&#x53F0;&#x673A;&#x5668;&#x4E0A;&#x8FD0;&#x884C;&#x8BE5;&#x7A0B;&#x5E8F;&#xFF1A;</p>
<pre class="line-numbers language-bash"><code class="language-bash">gcc server.c
./a.out<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>&#x7136;&#x540E;&#x5728;&#x53E6;&#x5916;&#x4E00;&#x673A;&#x5668;&#x4E0A;&#x767B;&#x9646;&#xFF1A;<br><strong>&#x6CE8;&#x610F;&#xFF01;</strong><br>&#x5982;&#x679C;&#x6CA1;&#x6709;telnet&#xFF0C;&#x53EF;&#x4EE5;&#x5982;&#x4E0B;&#x547D;&#x4EE4;&#x5B89;&#x88C5;&#xFF1A;<br><code>sudo apt-get install telnet</code></p>
<pre class="line-numbers language-bash"><code class="language-bash">telnet &#x4E3B;&#x673A;&#x540D; 3490<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>&#x6B64;&#x65F6;,&#x670D;&#x52A1;&#x5668;&#x663E;&#x793A;&#xFF1A;</p>
<pre><code>server: got connection from 192.168.43.231</code></pre><p>&#x5BA2;&#x6237;&#x7AEF;&#x663E;&#x793A;&#xFF1A;</p>
<pre><code>Trying 192.168.43.20...
Connected to deepin.
Escape character is &apos;^]&apos;.
Hello, world!
Connection closed by foreign host.</code></pre><h3 id="&#x7B80;&#x5355;&#x5BA2;&#x6237;&#x7AEF;"><a href="#&#x7B80;&#x5355;&#x5BA2;&#x6237;&#x7AEF;" class="headerlink" title="&#x7B80;&#x5355;&#x5BA2;&#x6237;&#x7AEF;"></a>&#x7B80;&#x5355;&#x5BA2;&#x6237;&#x7AEF;</h3><p>&#x8FD9;&#x4E2A;&#x7A0B;&#x5E8F;&#x7684;&#x6240;&#x6709;&#x5DE5;&#x4F5C;&#x662F;&#x901A;&#x8FC7; 3490 &#x7AEF;&#x53E3;&#x8FDE;&#x63A5;&#x5230;&#x547D;&#x4EE4;&#x884C;&#x4E2D;&#x6307;&#x5B9A;&#x7684;&#x4E3B;&#x673A;&#xFF0C;&#x7136;&#x540E;&#x5F97;&#x5230;&#x670D;&#x52A1;&#x5668;&#x53D1;&#x9001;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002;<br><strong>client.c</strong></p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;errno.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;sys/types.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;netinet/in.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;netdb.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;sys/socket.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;sys/wait.h&gt;</span></span>


<span class="token macro property">#<span class="token directive keyword">define</span> PORT 3490 </span><span class="token comment" spellcheck="true">/* &#x5BA2;&#x6237;&#x673A;&#x8FDE;&#x63A5;&#x8FDC;&#x7A0B;&#x4E3B;&#x673A;&#x7684;&#x7AEF;&#x53E3; */</span>
<span class="token macro property">#<span class="token directive keyword">define</span> MAXDATASIZE 100 </span><span class="token comment" spellcheck="true">/* &#x6BCF;&#x6B21;&#x53EF;&#x4EE5;&#x63A5;&#x6536;&#x7684;&#x6700;&#x5927;&#x5B57;&#x8282; */</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> sockfd<span class="token punctuation">,</span> numbytes<span class="token punctuation">;</span>
    <span class="token keyword">char</span> buf<span class="token punctuation">[</span>MAXDATASIZE<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">struct</span> sockaddr_in their_addr<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* connector&apos;s address information */</span>
    <span class="token keyword">struct</span> hostent <span class="token operator">*</span>he<span class="token punctuation">;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>ptr<span class="token punctuation">;</span>
    <span class="token keyword">struct</span> in_addr addr<span class="token punctuation">;</span>


    <span class="token keyword">if</span> <span class="token punctuation">(</span>argc <span class="token operator">!=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span><span class="token string">&quot;usage: Input client hostname or ip address\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    ptr <span class="token operator">=</span> argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>ptr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">&apos;1&apos;</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">inet_pton</span><span class="token punctuation">(</span>AF_INET<span class="token punctuation">,</span> ptr<span class="token punctuation">,</span> <span class="token operator">&amp;</span>addr<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;inet_pton error:%s\n&quot;</span><span class="token punctuation">,</span> <span class="token function">strerror</span><span class="token punctuation">(</span>errno<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">{</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
        he <span class="token operator">=</span> <span class="token function">gethostbyaddr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>addr<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>addr<span class="token punctuation">)</span><span class="token punctuation">,</span> AF_INET<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>he<span class="token operator">=</span><span class="token function">gethostbyname</span><span class="token punctuation">(</span>ptr<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">/* get the host info */</span>
        <span class="token function">herror</span><span class="token punctuation">(</span><span class="token string">&quot;gethostbyname&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>sockfd <span class="token operator">=</span> <span class="token function">socket</span><span class="token punctuation">(</span>AF_INET<span class="token punctuation">,</span> SOCK_STREAM<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">&quot;socket&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    their_addr<span class="token punctuation">.</span>sin_family <span class="token operator">=</span> AF_INET<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* host byte order */</span>
    their_addr<span class="token punctuation">.</span>sin_port <span class="token operator">=</span> <span class="token function">htons</span><span class="token punctuation">(</span>PORT<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* short, network byte order */</span>
    their_addr<span class="token punctuation">.</span>sin_addr <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">struct</span> in_addr <span class="token operator">*</span><span class="token punctuation">)</span>he<span class="token operator">-&gt;</span>h_addr_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">bzero</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token punctuation">(</span>their_addr<span class="token punctuation">.</span>sin_zero<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>their_addr<span class="token punctuation">.</span>sin_zero<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* zero the rest of the struct */</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">connect</span><span class="token punctuation">(</span>sockfd<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">struct</span> sockaddr <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>their_addr<span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> sockaddr<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">&quot;connect&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>numbytes<span class="token operator">=</span><span class="token function">recv</span><span class="token punctuation">(</span>sockfd<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> MAXDATASIZE<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">&quot;recv&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    buf<span class="token punctuation">[</span>numbytes<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&apos;\0&apos;</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Received: %s&quot;</span><span class="token punctuation">,</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">close</span><span class="token punctuation">(</span>sockfd<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-bash"><code class="language-bash">gcc client.c<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>&#x5728;A&#x7535;&#x8111;&#x4E0A;&#x8FD0;&#x884C;&#x670D;&#x52A1;&#x5668;&#xFF1A;</p>
<pre class="line-numbers language-bash"><code class="language-bash">./a.out<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>&#x5728;B&#x7535;&#x8111;&#x4E0A;&#x8FD0;&#x884C;&#x5BA2;&#x6237;&#x7AEF;&#xFF1A;</p>
<pre class="line-numbers language-bash"><code class="language-bash">./a.out A&#x4E3B;&#x673A;&#x540D;&#x6216;ip&#x5730;&#x5740;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>&#x8FD0;&#x884C;&#x540E;&#xFF0C;A&#x663E;&#x793A;:</p>
<pre><code>server: got connection from 192.168...</code></pre><p>B&#x663E;&#x793A;&#xFF1A;</p>
<pre><code>Received: Hello, world!</code></pre><h1 id="&#x7EC8;&#x7AEF;"><a href="#&#x7EC8;&#x7AEF;" class="headerlink" title="&#x7EC8;&#x7AEF;"></a>&#x7EC8;&#x7AEF;</h1><p>&#x5386;&#x53F2;&#x4E0A;&#xFF0C;&#x7528;&#x6237;&#x63A5;&#x5165;&#x4E00;&#x4E2A;UNIX&#x7CFB;&#x7EDF;&#x90FD;&#x662F;&#x901A;&#x8FC7;&#x4E32;&#x884C;&#x7EBF;&#xFF08;RS-232&#x8FDE;&#x63A5;&#xFF09;&#x8FDE;&#x63A5;&#x5230;&#x4E00;&#x4E2A;&#x7EC8;&#x7AEF;&#x4E0A;&#x7684;&#x3002;&#x7EC8;&#x7AEF;&#x7531;&#x9634;&#x6781;&#x5C04;&#x7EBF;&#x7BA1;&#xFF08;CRT&#xFF09;&#x7EC4;&#x6210;&#xFF0C;&#x80FD;&#x591F;&#x663E;&#x793A;&#x51FA;&#x5B57;&#x7B26;&#xFF0C;&#x800C;&#x4E14;&#x5728;&#x67D0;&#x4E9B;&#x60C5;&#x51B5;&#x4E0B;&#x53EF;&#x4EE5;&#x663E;&#x793A;&#x51FA;&#x57FA;&#x672C;&#x56FE;&#x5F62;&#x3002;&#x4E00;&#x822C;&#x6765;&#x8BF4;&#xFF0C;CRT&#x80FD;&#x63D0;&#x4F9B;&#x5355;&#x8272;24&#x884C;80&#x5217;&#x7684;&#x663E;&#x793A;&#x6548;&#x679C;&#x3002;&#x6309;&#x7167;&#x5F53;&#x4ECA;&#x7684;&#x6807;&#x51C6;&#xFF0C;&#x8FD9;&#x4E9B;CRT&#x4F53;&#x79EF;&#x5F88;&#x5C0F;&#x4E14;&#x6602;&#x8D35;&#x3002;&#x751A;&#x81F3;&#x5728;&#x66F4;&#x65E9;&#x7684;&#x65F6;&#x671F;&#xFF0C;&#x7EC8;&#x7AEF;&#x6709;&#x65F6;&#x5019;&#x8FD8;&#x662F;&#x786C;&#x62F7;&#x8D1D;&#x7535;&#x4F20;&#x8BBE;&#x5907;&#x3002;&#x4E32;&#x884C;&#x7EBF;&#x4E5F;&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x8FDE;&#x63A5;&#x5176;&#x4ED6;&#x7684;&#x8BBE;&#x5907;&#xFF0C;&#x6BD4;&#x5982;&#x6253;&#x5370;&#x673A;&#x548C;&#x7528;&#x6765;&#x5728;&#x8BA1;&#x7B97;&#x673A;&#x4E4B;&#x95F4;&#x4E92;&#x8FDE;&#x7684;&#x8C03;&#x5236;&#x89E3;&#x8C03;&#x5668;&#x3002;<br>&#x5728;&#x65E9;&#x671F;&#x7684;UNIX&#x7CFB;&#x7EDF;&#x4E0A;&#xFF0C;&#x8FDE;&#x63A5;&#x5230;&#x7CFB;&#x7EDF;&#x4E0A;&#x7684;&#x7EC8;&#x7AEF;&#x7531;&#x5B57;&#x7B26;&#x578B;&#x8BBE;&#x5907;&#x6765;&#x8868;&#x793A;&#xFF0C;&#x540D;&#x79F0;&#x4EE5;/dev/ttyn&#x7684;&#x5F62;&#x5F0F;&#x7ED9;&#x51FA;&#x3002;&#xFF08;&#x5728;Linux&#x4E0A;&#xFF0C;/dev/ttyn&#x8BBE;&#x5907;&#x662F;&#x7CFB;&#x7EDF;&#x4E0A;&#x7684;&#x865A;&#x62DF;&#x63A7;&#x5236;&#x53F0;&#x3002;&#xFF09;&#x6211;&#x4EEC;&#x5E38;&#x4F1A;&#x770B;&#x5230;tty&#xFF08;&#x6E90;&#x81EA;teletype&#xFF09;&#x4F5C;&#x4E3A;&#x7EC8;&#x7AEF;&#x7684;&#x7F29;&#x5199;&#x5F62;&#x5F0F;&#x3002;</p>
<p>&#x5C24;&#x5176;&#x662F;&#x5728;UNIX&#x7684;&#x65E9;&#x671F;&#x65F6;&#x4EE3;&#xFF0C;&#x7EC8;&#x7AEF;&#x8BBE;&#x5907;&#x5E76;&#x6CA1;&#x6709;&#x7EDF;&#x4E00;&#x7684;&#x6807;&#x51C6;&#x3002;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x4E0D;&#x540C;&#x7684;&#x5B57;&#x7B26;&#x5E8F;&#x5217;&#x9700;&#x8981;&#x6267;&#x884C;&#x7C7B;&#x4F3C;&#x79FB;&#x52A8;&#x5149;&#x6807;&#x5230;&#x4E00;&#x884C;&#x7684;&#x5F00;&#x5934;&#xFF0C;&#x6216;&#x8005;&#x79FB;&#x52A8;&#x5149;&#x6807;&#x5230;&#x5C4F;&#x5E55;&#x4E2D;&#x592E;&#x8FD9;&#x6837;&#x7684;&#x64CD;&#x4F5C;&#x3002;&#xFF08;&#x7EC8;&#x4E8E;&#x6709;&#x4E9B;&#x8BBE;&#x5907;&#x5546;&#x5B9E;&#x73B0;&#x4E86;&#x8FD9;&#x6837;&#x7684;&#x8F6C;&#x4E49;&#x5E8F;&#x5217;&#x2014;&#x2014;&#x4F8B;&#x5982;&#xFF0C;Digitals&#x7684;VT-100&#x6210;&#x4E3A;&#x4E86;&#x4E8B;&#x5B9E;&#x4E0A;&#x7684;&#x6807;&#x51C6;&#xFF0C;&#x6700;&#x7EC8;&#x6210;&#x4E3A;&#x4E86;ANSI&#x6807;&#x51C6;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x4F9D;&#x7136;&#x8FD8;&#x5B58;&#x5728;&#x7740;&#x5404;&#x79CD;&#x5404;&#x6837;&#x7684;&#x7EC8;&#x7AEF;&#x7C7B;&#x578B;&#x3002;&#xFF09;&#x7531;&#x4E8E;&#x7F3A;&#x4E4F;&#x7EDF;&#x4E00;&#x7684;&#x6807;&#x51C6;&#xFF0C;&#x8FD9;&#x5C31;&#x610F;&#x5473;&#x7740;&#x5F88;&#x96BE;&#x7F16;&#x5199;&#x53EF;&#x79FB;&#x690D;&#x7684;&#x7A0B;&#x5E8F;&#x6765;&#x5229;&#x7528;&#x7EC8;&#x7AEF;&#x7684;&#x7279;&#x6027;&#x3002;vi&#x7F16;&#x8F91;&#x5668;&#x662F;&#x65E9;&#x671F;&#x6709;&#x7740;&#x8FD9;&#x79CD;&#x53EF;&#x79FB;&#x690D;&#x6027;&#x9700;&#x6C42;&#x7684;&#x4F8B;&#x5B50;&#x3002;termcap&#x548C;terminfo&#x6570;&#x636E;&#x5E93;&#xFF08;&#x5728;[Strang et al., 1988]&#x4E2D;&#x6709;&#x63CF;&#x8FF0;&#xFF09;&#x4E2D;&#x7684;&#x5236;&#x8868;&#x64CD;&#x4F5C;&#x5E94;&#x8BE5;&#x5982;&#x4F55;&#x9488;&#x5BF9;&#x591A;&#x79CD;&#x7C7B;&#x578B;&#x7684;&#x7EC8;&#x7AEF;&#x6267;&#x884C;&#x5404;&#x5F0F;&#x5404;&#x6837;&#x7684;&#x5C4F;&#x5E55;&#x63A7;&#x5236;&#x64CD;&#x4F5C;&#x5462;&#xFF1F;curses&#x5E93;&#xFF08;[Strang, 1986]&#xFF09;&#x6B63;&#x662F;&#x4E3A;&#x4E86;&#x5E94;&#x5BF9;&#x8FD9;&#x79CD;&#x7F3A;&#x5931;&#x7684;&#x6807;&#x51C6;&#x5E94;&#x8FD0;&#x800C;&#x751F;&#x3002;</p>
<p>&#x5982;&#x4ECA;&#x4F20;&#x7EDF;&#x578B;&#x7EC8;&#x7AEF;&#x5DF2;&#x7ECF;&#x4E0D;&#x5E38;&#x89C1;&#x4E86;&#x3002;&#x73B0;&#x4EE3;UNIX&#x7CFB;&#x7EDF;&#x7684;&#x5E38;&#x7528;&#x63A5;&#x53E3;&#x662F;&#x9AD8;&#x6027;&#x80FD;&#x4F4D;&#x6620;&#x5C04;&#x56FE;&#x5F62;&#x663E;&#x793A;&#x5668;&#x4E0A;&#x7684; X Window &#x7A97;&#x53E3;&#x7BA1;&#x7406;&#x5668;&#x3002;&#xFF08;&#x8001;&#x5F0F;&#x7684;&#x7EC8;&#x7AEF;&#x6240;&#x63D0;&#x4F9B;&#x7684;&#x529F;&#x80FD;&#x5927;&#x81F4;&#x4E0A;&#x7B49;&#x540C;&#x4E8E;&#x4E00;&#x4E2A;&#x5355;&#x72EC;&#x7684;&#x7EC8;&#x7AEF;&#x7A97;&#x53E3;&#x2014;&#x2014;xterm&#x7EC8;&#x7AEF;&#x6216;&#x5176;&#x4ED6;&#x7C7B;&#x4F3C;&#x7684;&#x4EA7;&#x54C1;&#x2014;&#x2014;&#x8FD0;&#x884C;&#x5728;X Window&#x7CFB;&#x7EDF;&#x4E4B;&#x4E0A;&#x3002;&#x8FD9;&#x79CD;&#x7EC8;&#x7AEF;&#x7684;&#x7528;&#x6237;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x5355;&#x72EC;&#x7684;&#x9762;&#x5411;&#x7CFB;&#x7EDF;&#x7684;&#x201C;&#x7A97;&#x53E3;&#x201D;&#xFF0C;&#x8FD9;&#x4E00;&#x4E8B;&#x5B9E;&#x662F;&#x7531;&#x5F00;&#x53D1;&#x4F5C;&#x4E1A;&#x63A7;&#x5236;&#x8BBE;&#x65BD;&#x6240;&#x9A71;&#x52A8;&#x7684;&#x3002;&#xFF09;&#x540C;&#x6837;&#x7684;&#xFF0C;&#x5982;&#x4ECA;&#x8BB8;&#x591A;&#x76F4;&#x63A5;&#x8FDE;&#x63A5;&#x5230;&#x8BA1;&#x7B97;&#x673A;&#x4E0A;&#x7684;&#x8BBE;&#x5907;&#xFF08;&#x4F8B;&#x5982;&#x6253;&#x5370;&#x673A;&#xFF09;&#x90FD;&#x662F;&#x5E26;&#x6709;&#x7F51;&#x7EDC;&#x8FDE;&#x63A5;&#x7684;&#x667A;&#x80FD;&#x578B;&#x8BBE;&#x5907;&#x3002;</p>
<p>&#x4EE5;&#x4E0A;&#x6240;&#x8FF0;&#x90FD;&#x662F;&#x5728;&#x8BF4;&#x5982;&#x4ECA;&#x9762;&#x5411;&#x7EC8;&#x7AEF;&#x8BBE;&#x5907;&#x7684;&#x7F16;&#x7A0B;&#x5DF2;&#x7ECF;&#x4E0D;&#x50CF;&#x4EE5;&#x524D;&#x90A3;&#x4E48;&#x9891;&#x7E41;&#x4E86;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x672C;&#x7AE0;&#x628A;&#x91CD;&#x70B9;&#x653E;&#x5728;&#x7EC8;&#x7AEF;&#x7F16;&#x7A0B;&#x4E0A;&#xFF0C;&#x5C24;&#x5176;&#x662F;&#x4E0E;&#x8F6F;&#x4EF6;&#x7EC8;&#x7AEF;&#x6A21;&#x62DF;&#x5668;&#x76F8;&#x5173;&#x7684;&#x65B9;&#x9762;&#xFF08;&#x4F8B;&#x5982;xterm&#x53CA;&#x7C7B;&#x4F3C;&#x7684;&#x6A21;&#x62DF;&#x5668;&#xFF09;&#x3002;</p>
<h2 id="&#x6574;&#x4F53;&#x6982;&#x89C8;"><a href="#&#x6574;&#x4F53;&#x6982;&#x89C8;" class="headerlink" title="&#x6574;&#x4F53;&#x6982;&#x89C8;"></a>&#x6574;&#x4F53;&#x6982;&#x89C8;</h2><p>&#x4F20;&#x7EDF;&#x578B;&#x7EC8;&#x7AEF;&#x548C;&#x7EC8;&#x7AEF;&#x6A21;&#x62DF;&#x5668;&#x90FD;&#x9700;&#x8981;&#x540C;&#x7EC8;&#x7AEF;&#x9A71;&#x52A8;&#x7A0B;&#x5E8F;&#x76F8;&#x5173;&#x8054;&#xFF0C;&#x7531;&#x9A71;&#x52A8;&#x7A0B;&#x5E8F;&#x8D1F;&#x8D23;&#x5904;&#x7406;&#x8BBE;&#x5907;&#x4E0A;&#x7684;&#x8F93;&#x5165;&#x548C;&#x8F93;&#x51FA;&#x3002;</p>
<p>&#x5F53;&#x6267;&#x884C;&#x8F93;&#x5165;&#x65F6;&#xFF0C;&#x9A71;&#x52A8;&#x7A0B;&#x5E8F;&#x53EF;&#x4EE5;&#x5DE5;&#x4F5C;&#x5728;&#x4EE5;&#x4E0B;&#x4E24;&#x79CD;&#x6A21;&#x5F0F;&#x4E0B;&#x3002;</p>
<ul>
<li>&#x89C4;&#x8303;&#x6A21;&#x5F0F;&#xFF1A;&#x5728;&#x8FD9;&#x79CD;&#x6A21;&#x5F0F;&#x4E0B;&#xFF0C;&#x7EC8;&#x7AEF;&#x7684;&#x8F93;&#x5165;&#x662F;&#x6309;&#x884C;&#x6765;&#x5904;&#x7406;&#x7684;&#xFF0C;&#x800C;&#x4E14;&#x53EF;&#x8FDB;&#x884C;&#x884C;&#x7F16;&#x8F91;&#x64CD;&#x4F5C;&#x3002;&#x6BCF;&#x4E00;&#x884C;&#x90FD;&#x7531;&#x6362;&#x884C;&#x7B26;&#x6765;&#x7ED3;&#x675F;&#xFF0C;&#x5F53;&#x7528;&#x6237;&#x6309;&#x4E0B;&#x56DE;&#x8F66;&#x952E;&#x65F6;&#x53EF;&#x4EA7;&#x751F;&#x6362;&#x884C;&#x7B26;&#x3002;&#x5728;&#x7EC8;&#x7AEF;&#x4E0A;&#x6267;&#x884C;&#x7684;read()&#x8C03;&#x7528;&#x53EA;&#x4F1A;&#x5728;&#x4E00;&#x884C;&#x8F93;&#x5165;&#x5B8C;&#x6210;&#x4E4B;&#x540E;&#x624D;&#x4F1A;&#x8FD4;&#x56DE;&#xFF0C;&#x4E14;&#x6700;&#x591A;&#x53EA;&#x4F1A;&#x8FD4;&#x56DE;&#x4E00;&#x884C;&#x3002;&#xFF08;&#x5982;&#x679C;read()&#x8BF7;&#x6C42;&#x7684;&#x5B57;&#x8282;&#x6570;&#x5C11;&#x4E8E;&#x5F53;&#x524D;&#x884C;&#x4E2D;&#x7684;&#x53EF;&#x7528;&#x5B57;&#x8282;&#xFF0C;&#x90A3;&#x4E48;&#x5269;&#x4E0B;&#x7684;&#x5B57;&#x8282;&#x5728;&#x4E0B;&#x6B21; read()&#x8C03;&#x7528;&#x65F6;&#x53EF;&#x7528;&#x3002;&#xFF09;&#x8FD9;&#x662F;&#x9ED8;&#x8BA4;&#x7684;&#x8F93;&#x5165;&#x6A21;&#x5F0F;&#x3002;</li>
<li>&#x975E;&#x89C4;&#x8303;&#x6A21;&#x5F0F;&#xFF1A;&#x7EC8;&#x7AEF;&#x8F93;&#x5165;&#x4E0D;&#x4F1A;&#x88AB;&#x88C5;&#x914D;&#x6210;&#x884C;&#x3002;&#x50CF; vi&#x3001;more &#x548C; less &#x8FD9;&#x6837;&#x7684;&#x7A0B;&#x5E8F;&#x4F1A;&#x5C06;&#x7EC8;&#x7AEF;&#x7F6E;&#x4E8E;&#x975E;&#x89C4;&#x8303;&#x6A21;&#x5F0F;&#xFF0C;&#x8FD9;&#x6837;&#x4E0D;&#x9700;&#x8981;&#x7528;&#x6237;&#x6309;&#x4E0B;&#x56DE;&#x8F66;&#x952E;&#x5B83;&#x4EEC;&#x5C31;&#x80FD;&#x8BFB;&#x53D6;&#x5230;&#x5355;&#x4E2A;&#x7684;&#x5B57;&#x7B26;&#x4E86;&#x3002;</li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css">
			  		
			  		<!-- google Adsense -->
			  		
					
					
					
					
			    	
					
					<!-- google Adsense Matched content -->
			  		
			  	</div>
				
		  	</article>
		  	
		  	
		  	<!-- TAGS -->
		  	
		  	<div class="meta-content">
				
				<div class="widget">
				  	<h6 class="tag"><span class="fa fa-fw fa-tag"></span>TAGS</h6>
				  	<div class="article-tag">
						<ul class="article-tag-list">
							
					    		<li class="article-tag-list-item">
					    			<a class="article-tag-list-link" href="/tags/linux/">
					    				linux
					    			</a>
					    		</li>
							
						</ul>
					</div>
				</div>
				
			</div>
		  	
		  	
		  	<!-- Categories posts -->
		  	
		  	
		  	
		  	<!-- Detailed categories  posts -->
		  	
		  	
		  	
		  	<!-- Latests -->
		  	
			
		</div>
		
		
		<footer id="footer">
		
			
			
			
			
			<div class="copyright-tool">
				
				
				
				<div class="copyright-title">
					<span>
					&copy; 2020&nbsp;ALaDing
					</span>
				</div>
				
				<div class="copyright-license">
					<aside>
						Powered by <a href="https://hexo.io/">Hexo</a>. <a href="https://github.com/tea3/hexo-generator-amp">AMP-Theme</a> designed by <a href="https://github.com/tea3/">tea</a>.
					</aside>
				</div>
			</div>
			
		</footer>


  	<div id="totop"><a href="#"></a></div>


  </body>
</html>
